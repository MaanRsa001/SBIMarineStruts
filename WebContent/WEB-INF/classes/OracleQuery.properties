################################################################################################
################################################################################################

############### Kindly Add the query below the specific product / Menu / Master ################

################################################################################################
################################################################################################

#Common and List Page Queries
quotation.option=SELECT CODE, CODEDESC, CODEVALUE FROM TABLE(SELECT QUOTATIONDATA(?,?,?,?,?,?,?,?,?,?,?,?,?) FROM DUAL)
quotation.option.motor =  SELECT CODE, CODEDESC, CODEVALUE FROM TABLE(SELECT MOTOR_QUOTATION_DATA(?,?,?,?,?,?,?,?) FROM DUAL)
broker=SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?
customer.selection=SELECT UPPER(NVL(COMPANY_NAME,FIRST_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS,cust_name FROM PERSONAL_INFO WHERE LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?)) AND APPLICATION_ID \= '1' 
GET_OPENCUSTOMER_INFO = SELECT UPPER(NVL(COMPANY_NAME,FIRST_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, B.CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS,cust_name FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO B, OPEN_COVER_MASTER C WHERE A.OPEN_COVER_NO\=? AND B.CUSTOMER_ID \= C.CUSTOMER_ID AND C.PROPOSAL_NO \= A.PROPOSAL_NO AND C.AMEND_ID\=(SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO \= A.PROPOSAL_NO)    
report.transaction=SELECT A.TRANSACTION_ID,(SELECT COUNT (1) FROM WEBSERVICE_MARINE_QUOTE WHERE STATUS \= 'Q' AND TRANSACTION_ID \= A.TRANSACTION_ID AND OPENCOVER_POLICY_NUMBER \= A.OPENCOVER_POLICY_NUMBER) VALID_RECORDS, (SELECT COUNT (1) FROM XL_OPENCOVER_RAW WHERE TRANSACTION_ID \= A.TRANSACTION_ID AND OPENCOVER_POLICY_NUMBER \= A.OPENCOVER_POLICY_NUMBER) INVALID_RECORDS FROM XL_TRANSACTION_DETAILS A WHERE A.OPENCOVER_POLICY_NUMBER \= ?
report.declaration=SELECT PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(NVL (MD. PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) PREMIUM,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) = 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID=MPD.SETTLING_AGENT_ID AND (BRANCH_CODE=? or BRANCH_CODE='01')) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_POLICY_DETAILS MPD WHERE PM.OPEN_COVER_NO = ? AND PM.STATUS = 'Y' AND PM.REMARKS IN ('Normal', 'Admin') AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > ( SELECT SYSDATE FROM DUAL) AND PM.LOGIN_ID = ? AND PM.APPLICATION_ID = NVL(?,'1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO=PM.APPLICATION_NO AND MPD.QUOTE_NO=PM.QUOTE_NO ORDER BY PM.QUOTE_NO
report.declaration.transaction=SELECT PM.POLICY_NO,PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(NVL (MD. PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) PREMIUM,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID\=MPD.SETTLING_AGENT_ID AND (BRANCH_CODE\=? or branch_code\='01')) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_POLICY_DETAILS MPD, WEBSERVICE_MARINE_QUOTE WMQ WHERE PM.OPEN_COVER_NO \= ? AND PM.STATUS \= 'P' AND PM.REMARKS IN ('Normal', 'Admin') AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > ( SELECT SYSDATE FROM DUAL) AND PM.LOGIN_ID \= ? AND PM.APPLICATION_ID \= NVL(?,'1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO\=PM.APPLICATION_NO AND PM.QUOTE_NO\=WMQ.QUOTE_NO AND MPD.QUOTE_NO\=PM.QUOTE_NO AND WMQ.OPENCOVER_POLICY_NUMBER\=PM.OPEN_COVER_NO AND PM.POLICY_NO\=? ORDER BY PM.QUOTE_NO
report_declaration_policy=SELECT (A.POLICY_NO), NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, SUM (A.PREMIUM) PREMIUM, COUNT (A.POLICY_NO) POLICY_COUNT, OCM.MISSIPPI_OPENCOVER_NO OPENCOVER_NO, NVL (PI.COMPANY_NAME, PI.FIRST_NAME || ' ' || PI.LAST_NAME) OPENCOVER_CUST_NAME, OCM.AMEND_ID,A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO FROM POSITION_MASTER A,OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM, PERSONAL_INFO PI WHERE A.LOGIN_ID =? AND A.STATUS = 'P' AND NVL (A.OPEN_COVER_INT_STATUS, 0) IN ('LINKED') AND A.PRODUCT_ID = ? AND A.APPLICATION_ID = NVL(?,'1') AND A.OPEN_COVER_NO=OCPM.OPEN_COVER_NO AND OCPM.OPEN_COVER_NO = ? AND OCPM.PROPOSAL_NO = OCM.PROPOSAL_NO AND PI.CUSTOMER_ID = OCM.CUSTOMER_ID AND PI.STATUS = 'Y' AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO = ? AND OCPMS.PROPOSAL_NO = OCMS.PROPOSAL_NO AND TO_DATE (OCMS.EFFECTIVE_DATE, 'dd-MM-YYYY') <= TO_DATE (SYSDATE, 'dd-MM-YYYY')) GROUP BY A.POLICY_NO, A.LOGIN_ID, A.OPEN_COVER_NO,OCM.MISSIPPI_OPENCOVER_NO, NVL (PI.COMPANY_NAME, PI.FIRST_NAME || ' ' || PI.LAST_NAME), PI.COMPANY_NAME, OCM.AMEND_ID,A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO ORDER BY SUBSTR (A.POLICY_NO, 9, 16) DESC
copyquote.quoteNo=SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND QUOTE_NO = ? AND PM.PRODUCT_ID=? AND LM.LOGIN_ID=PM.LOGIN_ID
copyquote.policyNo=	SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND POLICY_NO = ?  AND PM.PRODUCT_ID=? AND LM.LOGIN_ID=PM.LOGIN_ID
copyquote.custName=SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO\=PM.APPLICATION_NO AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND UPPER(PI.FIRST_NAME) like UPPER('%'||?||'%') AND PM.PRODUCT_ID\=? AND LM.LOGIN_ID\=PM.LOGIN_ID
report.policy=select * from table(ISSUER_REPORTS(?,?,?,?,?,?,'broker'))
report.policyissuer=select * from table(ISSUER_REPORTS(?,?,?,?,?,?,'RSAIssuer'))   

executive=SELECT LED.AC_EXECUTIVE_ID FROM LOGIN_EXECUTIVE_DETAILS LED,BROKER_COMPANY_MASTER BCM WHERE LED.AC_EXECUTIVE_ID=BCM.AC_EXECUTIVE_ID AND BCM.AGENCY_CODE=?
executive_oc=Select Executive_Id From Open_Cover_Master Ocm Where Proposal_No =(Select Proposal_No From  Open_Cover_Position_Master Ocpm Where Ocpm.Proposal_No=Ocm.Proposal_No And Open_Cover_No=? and status='P') And Ocm.Amend_Id=(Select Max(Amend_Id) From Open_Cover_Master Oc Where Ocm.Proposal_No=Oc.Proposal_No)
lapsed.reason=SELECT CATEGORY_DETAIL_ID,DETAIL_NAME FROM CONSTANT_DETAIL WHERE BRANCH_CODE=? AND CATEGORY_ID = (SELECT CATEGORY_ID FROM CONSTANT_MASTER WHERE CATEGORY_NAME = 'LAPSED_QUOTE_REASON' AND BRANCH_CODE=?)
quote.detail=SELECT A.CUSTOMER_ID, A.QUOTE_NO,TO_CHAR (A.ENTRY_DATE, 'dd/MM/YYYY') QUOTE_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'dd/MM/YYYY') VALIDITY_DATE, NVL (B.FIRST_NAME, B.COMPANY_NAME) CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.QUOTE_NO = ? AND A.CUSTOMER_ID = B.CUSTOMER_ID
lapsed.update=UPDATE POSITION_MASTER SET STATUS \= 'D',EFFECTIVE_DATE \=(SELECT SYSDATE FROM DUAL),LAPSED_REMARKS \=?,LAPSED_DATE \= (SELECT SYSDATE FROM DUAL), LAPSED_UPDATED_BY \=? WHERE QUOTE_NO \=?
active.lapsed=UPDATE POSITION_MASTER SET ENTRY_DATE=(SELECT SYSDATE+8/24 FROM DUAL),EFFECTIVE_DATE=(SELECT ADD_MONTHS(SYSDATE,1)-1 FROM DUAL) WHERE QUOTE_NO=?
customer.opencover= SELECT UPPER (NVL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS, cust_name FROM PERSONAL_INFO PI,(SELECT REGEXP_SUBSTR (ADDITIONAL_INSURED, '[^,]+', 1, LEVEL) AS ADDITIONAL_INSURED FROM (SELECT CASE WHEN A.ADDITIONAL_INSURED IS NULL THEN TO_CHAR (A.CUSTOMER_ID) ELSE TO_CHAR (A.CUSTOMER_ID) || ',' || A.ADDITIONAL_INSURED END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO \= ? AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO \= A.MISSIPPI_OPENCOVER_NO)) CONNECT BY LEVEL <\= LENGTH (ADDITIONAL_INSURED) - LENGTH (REPLACE (ADDITIONAL_INSURED, ',', '')) + 1) AI WHERE PI.CUSTOMER_ID \= AI.ADDITIONAL_INSURED
customer.opencover.byname=SELECT UPPER (NVL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE , ' '), 'select', '') ADDRESS,cust_name FROM PERSONAL_INFO PI,(SELECT REGEXP_SUBSTR (ADDITIONAL_INSURED, '[^,]+', 1, LEVEL) AS ADDITIONAL_INSURED FROM (SELECT CASE WHEN A.ADDITIONAL_INSURED IS NULL THEN TO_CHAR (A.CUSTOMER_ID) ELSE TO_CHAR (A.CUSTOMER_ID) || ',' || A.ADDITIONAL_INSURED END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO \= ? AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO \= A.MISSIPPI_OPENCOVER_NO)) CONNECT BY LEVEL <\= LENGTH (ADDITIONAL_INSURED) - LENGTH (REPLACE (ADDITIONAL_INSURED, ',', '')) + 1) AI WHERE PI.CUSTOMER_ID \= AI.ADDITIONAL_INSURED AND UPPER(FIRST_NAME) LIKE UPPER(?) ORDER BY FIRST_NAME
customer.selection.common=SELECT UPPER(NVL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL ( ADDRESS2, ' ') || NVL ((EMIRATE), ' '), 'select', '' ) ADDRESS,cust_name FROM PERSONAL_INFO WHERE LOGIN_ID IN ( SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= ( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \=?)) AND APPLICATION_ID \='1'
customer.selection.byname=SELECT UPPER(FIRST_NAME) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL ( ADDRESS2, ' ') || NVL ((EMIRATE), ' '), 'select', '' ) ADDRESS,cust_name FROM PERSONAL_INFO WHERE LOGIN_ID IN ( SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= ( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \=?)) AND APPLICATION_ID \='1' AND UPPER(FIRST_NAME) LIKE UPPER(?) ORDER BY FIRST_NAME 
customer.selection.coreAppCode=AND MISSIPPI_CUSTOMER_CODE LIKE ? ORDER BY FIRST_NAME
customer.selection.mobileNo=AND MOBILE LIKE ? ORDER BY FIRST_NAME
customer.selection.email=AND EMAIL LIKE ? ORDER BY FIRST_NAME
report.searchByQuote=select * from table(search_list(?,?,?,?,?,?))
report.searchByPolicy=SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE,TO_CHAR (M.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM,A.INCEPTION_DATE,A.POLICY_NO,CASE WHEN A.STATUS\='Y' AND A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  \= 'N' THEN 'RA' ELSE A.STATUS END AS STATUS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND POLICY_NO LIKE ? ORDER BY QUOTE_NO DESC
report.searchByCustomer=select * from table(search_list(?,?,?,?,?,?))
search.issuer.brokerList=SELECT DISTINCT(A.LOGIN_ID) LOGIN_ID,D.USERNAME FROM POSITION_MASTER A,PERSONAL_INFO B,MARINE_DATA MD,BROKER_COMPANY_MASTER C, LOGIN_MASTER D WHERE A.PRODUCT_ID = ? AND (A.FREIGHT_STATUS NOT IN('F','B') OR A.FREIGHT_STATUS IS NULL) AND MD.APPLICATION_NO=A.APPLICATION_NO AND A.EFFECTIVE_DATE >= (  SELECT   SYSDATE FROM DUAL) AND A.APPLICATION_ID NOT IN (?,'1') AND C.AGENCY_CODE=D.OA_CODE AND C.BRANCH_CODE=? AND D.LOGIN_ID=A.LOGIN_ID
report.searchByQuoteOthers=SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE,TO_CHAR (M.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM,A.INCEPTION_DATE,A.POLICY_NO,CASE WHEN A.STATUS\='Y' AND A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  \= 'N' THEN 'RA' ELSE A.STATUS END AS STATUS,M.LC_NUMBER FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID NOT IN (?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND QUOTE_NO LIKE ? ORDER BY QUOTE_NO DESC
quotation.brokerloginId=SELECT LOGIN_ID FROM LOGIN_MASTER LM,BROKER_COMPANY_MASTER BCM WHERE LM.AGENCY_CODE\=BCM.AGENCY_CODE AND BCM.AGENCY_CODE\=?
GET_COUNT_LTSYSDATE=SELECT COUNT(*) FROM DUAL WHERE SYSDATE<TO_DATE(?,'DD-MM-YYYY')+1
GET_SMART_REPORT_LIST = select * from table(smart_report(''{0}'',''{1}'',''{2}'',''{3}'',''{4}'',''{5}'',''{6}'',''{7}'',''{8}'',''{9}''))
report.report=SELECT (CASE WHEN APPLICATION_ID \= '1' AND CUSTOMER_LOGIN_ID IS NOT NULL THEN (CUSTOMER_LOGIN_ID) ELSE LOGIN_ID END) || '(' || (SELECT USERTYPE FROM LOGIN_MASTER WHERE LOGIN_ID \= PI.LOGIN_ID) || ')' USERNAME, (CASE WHEN APPLICATION_ID \= '1' AND CUSTOMER_LOGIN_ID IS NOT NULL THEN (CUSTOMER_LOGIN_ID) ELSE LOGIN_ID END) FIRST_NAME FROM PERSONAL_INFO PI WHERE (LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?)) OR CUSTOMER_LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?))) AND LOGIN_ID \!\= 'NONE' AND APPLICATION_ID IN ('2', '3', '5') AND OA_CODE IS NOT NULL AND AGENCY_CODE IS NOT NULL ORDER BY APPLICATION_ID
travel.report.referral.unapprovedQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.referral.unapprovedCustomerName=AND  (LOWER(LTRIM(RTRIM(B.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(B.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.referral.unapprovedOrderBy=ORDER BY   a.quote_no DESC 
travel.report.referralQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.referral.CustomerName=AND  (LOWER(LTRIM(RTRIM(b.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(b.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.referral.approvedOrderBy=ORDER BY   a.quote_no DESC 
travel.report.referral.rejectQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.referral.rejectCustomerName=AND  (LOWER(LTRIM(RTRIM(B.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(B.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.referral.rejectOrderBy=ORDER BY a.quote_no DESC 
travel.report.rejectedQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.rejectedCustomerName=AND  (LOWER(LTRIM(RTRIM(B.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(B.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.rejectedOrderBy=ORDER BY A.QUOTE_NO DESC
travel.report.portfolioQuoteNo=AND  HPM.QUOTE_NO LIKE ? 
travel.report.portfolioPolicyNo=AND  HPM.POLICY_NO LIKE ?
travel.report.portfolioCustomerName=AND  (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.portfolioissuer=SELECT HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,TO_CHAR(HPM.EFFECTIVE_DATE,'DD/MM/YYYY') QUOTATION_DATE,NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,NULL CREDIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.STATUS = 'P' AND HPM.AMEND_ID='0' AND PI.CUSTOMER_ID = HPM.CUSTOMER_ID AND HPM.PRODUCT_ID = ? AND HPM.POLICY_NO LIKE ? AND PI.STATUS='Y' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) AND HPM.LOGIN_ID=LM.LOGIN_ID AND LM.OA_CODE = BCM.AGENCY_CODE
travel.report.portfolioOrderBy=ORDER BY HPM.EFFECTIVE_DATE DESC
travel.customer.selection=SELECT UPPER(NVL(COMPANY_NAME,FIRST_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') || NVL(ADDRESS1, ' ') || NVL(ADDRESS2, ' ') || NVL(EMIRATE , ' '), 'select', '') ADDRESS,PI.CUSTOMER_SOURCE FROM PERSONAL_INFO PI,LOGIN_MASTER LM1,LOGIN_MASTER LM2 WHERE PI.LOGIN_ID = LM1.LOGIN_ID AND LM1.OA_CODE=LM2.OA_CODE AND LM2.LOGIN_ID = ? AND pi.APPLICATION_ID = '1' AND PI.STATUS = 'Y' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
travel.customer.selectionCustomerId=AND  PI.CUSTOMER_ID LIKE ?
travel.customer.selectionCusCivilId=AND  PI.CUSTOMER_SOURCE LIKE ?
travel.customer.selectionMobileNo=AND  PI.MOBILE LIKE ? 
travel.customer.selectionCustomerName=AND  (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM( ? ))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.customer.selectionOrderBy=ORDER BY PI.FIRST_NAME 
travel.update.correction = UPDATE TRAVEL_DETAIL SET PASSENGER_NAME=?,GENDER=?,NATIONALITY=?,PASSANGER_LAST_NAME=?,PASSPORT_NO =?,PASSPORT_EXP_DATE=to_date(?,'DD/MM/YYYY') WHERE APPLICATION_NO=? AND SERIAL_NO=?
TRAVEL_CORRECTION_CHECK=select nvl(APPLICATION_NO,0) from Home_position_master where INCEPTION_DATE>SYSDATE AND quote_no=?
TRAVEL_GET_CUSTOMER_DETAILS = SELECT pi.TITLE,pi.CUSTOMER_ID, NVL(pi.FIRST_NAME,'') ||' '|| NVL(pi.LAST_NAME,'') CUS_NAME, pi.NATIONALITY, to_date(pi.DOB,'dd/mm/yyyy') DOB, pi.GENDER, pi.TELEPHONE, pi.MOBILE, pi.FAX, pi.EMAIL, pi.ADDRESS1,pi.ADDRESS2, pi.OCCUPATION,pi.POBOX, pi.COUNTRY, pi.EMIRATE FROM PERSONAL_INFO pi, HOME_POSITION_MASTER hpm WHERE pi.CUSTOMER_ID = hpm.CUSTOMER_ID and hpm.qUOTE_NO =? AND hpm.PRODUCT_ID = ? and pi.status='Y' AND pi.amend_id=(select max(amend_id) from PERSONAL_INFO where CUSTOMER_ID=PI.CUSTOMER_ID)
TRAVEL_GET_PASSENGER_DETAILS = SELECT A.PASSENGER_NAME,TO_CHAR(A.DOB,'DD/MM/YYYY') DOB,A.RELATION,A.NATIONALITY,A.GENDER,B.DETAIL_NAME,A.PASSPORT_NO,A.PASSPORT_EXP_DATE,A.PASSANGER_LAST_NAME FROM TRAVEL_DETAIL A,CONSTANT_DETAIL B WHERE B.CATEGORY_ID ='53'  AND A.RELATION=B.CATEGORY_DETAIL_ID AND B.BRANCH_CODE=? AND A.QUOTE_NO=?
TRAVEL_GET_CUSTOMER_POLICY_DETAILS = SELECT POLICY_NO, PREMIUM, TO_CHAR(EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,TO_CHAR(INCEPTION_DATE,'DD/MM/YYYY')  EFFECTIVE_DATE, POLICY_TERM, REMARKS, LAPSED_REMARKS, TO_CHAR(LAPSED_DATE,'DD/MM/YYYY') LAPSED_DATE, LAPSED_UPDATED_BY FROM HOME_POSITION_MASTER WHERE QUOTE_NO =?


#Login 
UPD_SESSION_END_TIME=UPDATE SESSION_MASTER SET END_TIME=SYSDATE WHERE SESSION_ID = ? AND LOGIN_ID = ? AND STATUS = ?
GET_SESSION_CNT=SELECT COUNT(*) FROM SESSION_MASTER WHERE SESSION_ID = ? AND LOGIN_ID = ? AND SYSDATE >= (END_TIME + ({0}/1440)) AND STATUS = ?
GET_CONSTANT_CNT=SELECT COUNT(*) FROM CONSTANT_DETAIL WHERE CATEGORY_ID='40' AND LOWER(DETAIL_NAME)=(SELECT LOWER(USERTYPE) FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND BRANCH_CODE=(SELECT NVL(BRANCH_CODE,'0') FROM LOGIN_MASTER WHERE LOGIN_ID=?)
INS_SESSION_DTL=INSERT INTO SESSION_MASTER(SESSION_ID,LOGIN_ID,START_TIME,END_TIME,STATUS,SYS_IP_ADDRESS)  VALUES(?,?,SYSDATE,SYSDATE,?,?)
UPD_SWAPED_PSW_ID=UPDATE LOGIN_MASTER SET  LPASS5 =  ?,  LPASS4 =  ?, LPASS3=  ?,LPASS2 =  ?,LPASS1 =  ?,PASSWORD =  ?, PASSDATE=SYSDATE+45 ,STATUS = ? WHERE LOGIN_ID = ?
UPD_SWAPED_PSW_USER=UPDATE LOGIN_MASTER SET LPASS5 = ? , LPASS4 = ?,LPASS3 = ? ,LPASS2 = ?,LPASS1 = ? ,PASSWORD = ? ,PASS_DT=SYSDATE, STATUS = ? WHERE USERNAME = ?
GET_BR_CODE_BYOACODE=SELECT NVL(BRANCH_CODE,'020') FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GET_BR_CODE_BYLOGINID=SELECT NVL(BRANCH_CODE,'020') FROM LOGIN_RSAUSER_DETAILS WHERE LOGIN_ID=?
GET_BR_DTLS=SELECT CURRENCY_ABBREVIATION,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,CURRENCY_ABBREVIATION,DECIMAL_PLACES,NVL(TAX,'0'),EMAIL FROM BRANCH_MASTER where BRANCH_CODE\=?
UPD_USER_SESSION = UPDATE SESSION_MASTER SET LOGIN_ID=?,START_TIME=systimestamp WHERE SESSION_ID = ? AND STATUS = ?
INS_B2CLOGIN_USER_DETAILS = INSERT INTO LOGIN_USER_DETAILS (USER_ID,OA_CODE,PRODUCT_ID,SCHEME_ID,COMPANY_ID,RELATIVE_USER_ID,AMEND_ID,INCEPTION_DATE,ENTRY_DATE,STATUS,LOGIN_ID,AGENCY_CODE) SELECT (SELECT MAX(USER_ID)+1 FROM LOGIN_USER_DETAILS),AGENCY_CODE,PRODUCT_ID,SCHEME_ID,COMPANY_ID,RELATIVE_USER_ID,AMEND_ID,SYSDATE,SYSDATE,STATUS,?,? FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=?

#Marine Insurance
quotation.title=SELECT TITLE_NAME FROM TITLE_MASTER WHERE BRANCH_CODE=? AND STATUS='Y' ORDER BY TITLE_NAME
report.portfolio=SELECT A.POLICY_NO, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0))PREMIUM, TO_CHAR (A.INCEPTION_DATE, ''DD/MM/YYYY'') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, ''0''), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE {0} A.STATUS \= ''P'' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ?  AND decode(?,''1'',''1'',a.application_id) \= NVL(?,''1'')  AND NVL(A.OPEN_COVER_NO,''0'') \= NVL(?,''0'') AND ORIGINAL_POLICY_NO IS NULL
report.lapsedquote=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.LAPSED_DATE, 'DD/MM/YYYY') LAPSED_DATE, TO_CHAR (ADD_MONTHS (A.ENTRY_DATE - 1, 1), 'DD/MM/YYYY') VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, C.PREMIUM, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME, (CASE WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Admin' THEN 'Rejected By Admin' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Normal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Referal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND C.REMARKS  \= 'Normal' THEN 'Rejected By Broker' ELSE 'Rejected By Admin' END) REJECT_DESC,A.LAPSED_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA C WHERE C.APPLICATION_NO  \= A.APPLICATION_NO AND A.LOGIN_ID \=? AND (A.STATUS IN ('D')) AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= NVL(?,'1')  AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0')
premium.quotation.insured_goods_info=SELECT CM.COMMODITY_ID, CM.COMMODITY_NAME, NVL(MRD.COMMODITY_EXCESS_PREMIUM,0) POLICY_EXCESS,MRD.POLICY_EXCESS_PERCENT POLICY_EXCESS_PERCENT, MRD.DESCRIPTION,MRD.EXCESS_DESCRIPTION EXCESS_DESCRIPTION , MRD.SUM_INSURED, NVL(MRD.RATE,0) RATE, NVL(MRD.WARRATE,0)WARRATE,(RATE+WARRATE) MARINE_WAR_RATE, DECODE(MRD.FRAGILE,'on','YES','off','NO') FRAGILE, MRD.PACKAGE_DESCRIPTION, MRD.SUPPLIER_NAME, MRD.INVOICE_NUMBER FROM MARINE_RESULT_DETAILS MRD, COMMODITYMASTER CM WHERE MRD.APPLICATION_NO \= ? AND CM.COMMODITY_ID \= MRD.COMMODITY_ID AND CM.BRANCH_CODE \= ? AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID \= CM.COMMODITY_ID AND BRANCH_CODE \= CM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'dd-MM-YYYY') <\= TO_DATE (SYSDATE, 'dd-MM-YYYY')) AND TO_DATE (CM.EFFECTIVE_DATE, 'dd-MM-YYYY') <\= TO_DATE (SYSDATE, 'dd-MM-YYYY') AND MRD.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=MRD.APPLICATION_NO) ORDER BY SNO 
premium.quotation.information=SELECT MT.TRANSPORT_DESCRIPTION,MD.MODE_OF_TRANSPORT, CM.COVER_NAME, CVM.CONVDESC, (CASE WHEN MD.EXTRA_COVER_ID \= 0 THEN 'NO' ELSE 'YES' END) WAR_SRCC, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN MD.TRANSIT_FROM || ',' || CNM.COUNTRY_NAME || ', WAREHOUSE' ELSE CNM.COUNTRY_NAME || ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN MD.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN MD.FINAL_DESTINATION || ',' || CN1.COUNTRY_NAME || ', WAREHOUSE' ELSE CN1.COUNTRY_NAME || ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= MD.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, MD.CURRENCY_NAME, CASE WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE \= 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \= 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') \!\= 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END SALES_TERM, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT, ( MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) / MD.EXCHANGE_RATE TOTAL_INSURED, MARINE_PREMIUM, NVL (MD.WAR_PREMIUM, 0) WAR_PREMIUM, REPLACE (NVL (MD.EXCESS_PREMIUM, 0), '-', '') ADDITIONAL_PREMIUM, NVL (MD.POLICY_FEE, '0') POLICY_ISSUNCE_FEE, NVL (MD.INSPECTION_FEE, '0') INSPECTION_FEE, NVL (MD.PREMIUM, '0') TOTAL_PREMIUM, ROUND((NVL (MD.PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0) + nvl(MD.POLICY_FEE,0) + nvl(MD.GOVT_TAX,0)+ nvl(MD.INSPECTION_FEE,0)),0) NET_PREMIUM, TO_CHAR (MD.INCEPTION_DATE, 'DD/MM/YYYY') POLICY_START_DATE, (SELECT FIRST_NAME FROM PERSONAL_INFO WHERE PM.CUSTOMER_ID \= CUSTOMER_ID) CUSTOMER_NAME, MD.EXCHANGE_RATE, (CASE WHEN (PM.STATUS IN ('Y', 'E') AND PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') THEN 'Y' ELSE 'N' END) STATUS, (CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN MD.REMARKS ELSE NULL END) REFERRAL_DESC, PM.QUOTE_NO QUOTE_NUMBER,MPD.BANK_NAME,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID \= MPD.SETTLING_AGENT_ID  and (branch_code\=? or branch_code\='01')) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION,MD.COVER_ID,PM.LOGIN_ID,REPLACE(PM.APPLICATION_ID,'1','') ISSUER,PM.DISCOUNT_PREMIUM,MD.ADMIN_REFERRAL_STATUS,(CASE WHEN NVL(MD.EXCESS_PREMIUM,0)<0 THEN '-' ELSE '+' END) EXCESS_SIGN,PM.CUSTOMER_ID, PM.ADMIN_REFERRAL_REMARKS, PM.ADMIN_REMARKS,PM.REMARKS,MD.CHANNEL_TYPE,NVL (MD.GOVT_TAX, 0) GOVT_TAX FROM MARINE_DATA MD, POSITION_MASTER PM, MARINE_POLICY_DETAILS MPD, MODE_OF_TRANSPORT MT, COVER_MASTER CM, (SELECT CYM.CONV_MEAN,CYM.CONVDESC,CYM.MODE_TRANSPORT_ID,CYM.BRANCH_CODE FROM CONVEYAN_MASTER CYM WHERE CYM.BRANCH_CODE\=? AND CYM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN \= CYM.CONV_MEAN AND BRANCH_CODE \= CYM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND MODE_TRANSPORT_ID\=CYM.MODE_TRANSPORT_ID) AND TO_DATE (CYM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) UNION ALL SELECT 0,'NONE',0,? FROM DUAL) CVM, COUNTRY_MASTER CNM, SALE_TERM_MASTER SM, TOLERANCE_MASTER TM WHERE MD.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.QUOTE_NO \= MPD.QUOTE_NO AND MPD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO \= MPD.QUOTE_NO) AND MT.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND MT.BRANCH_CODE \= ? AND CM.COVER_ID \= MD.COVER_ID AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= CM.COVER_ID AND BRANCH_CODE \= CM.BRANCH_CODE AND TO_DATE (EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE)) AND TO_DATE (CM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND CM.BRANCH_CODE \= MT.BRANCH_CODE AND CM.MODE_TRANSPORT_ID \= MD.MODE_OF_TRANSPORT AND CVM.CONV_MEAN \= MD.SEA_OPTIONS AND CVM.BRANCH_CODE \= MT.BRANCH_CODE AND CASE WHEN CVM.CONV_MEAN\='0' THEN MD.MODE_OF_TRANSPORT ELSE TO_CHAR(CVM.MODE_TRANSPORT_ID) END \= MD.MODE_OF_TRANSPORT AND CNM.COUNTRY_ID \= MD.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND TO_DATE (CNM.EFFECTIVE_DATE, 'DD-MM-YY') <\= TO_DATE(SYSDATE) AND SM.SALE_TERM_ID \= MD.SALE_TERM_ID AND SM.BRANCH_CODE \= MT.BRANCH_CODE AND TM.TOLERANCE_ID \= MD.TOLERANCE_ID AND TM.BRANCH_CODE \= MT.BRANCH_CODE AND PM.AMEND_ID\=MPD.AMEND_ID AND MD.AMEND_ID\=PM.AMEND_ID
quotation.branchInfo=SELECT CURRENCY_ABBREVIATION,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,CURRENCY_ABBREVIATION,DECIMAL_PLACES,NVL(TAX,'0'),EMAIL FROM BRANCH_MASTER WHERE BRANCH_CODE=?
GET_SALETERM_VALUE = select sale_term_value from sale_term_master where sale_term_id\=? and branch_code\=(select belonging_branch from branch_master where branch_code\=?) and status\='Y'
GET_SALETERM_VAL = select sale_term_value from sale_term_master where sale_term_id\=? and branch_code\=?
GET_TOLERANCE_PERCENT = SELECT TOLERANCE_VALUE FROM TOLERANCE_MASTER WHERE TOLERANCE_ID=? AND BRANCH_CODE=?

quotation.commodity.total=SELECT COUNT(1) TOTAL_COMMODITY, SUM(SUMINSURED) SUM_INSURED,RTRIM(XMLAGG(XMLELEMENT(E,COMMODITY_DESCRIPTION || ',')).EXTRACT('//text()'),',') COMMODITY_DESCRIPTION  FROM WEBSERVICE_MARINE_COMMODITY WHERE REFERENCE_NUMBER=?
commodity.update=UPDATE WEBSERVICE_MARINE_COMMODITY SET SUPPLIER_NAME=?,PACKAGE_DESCRIPTION=?,INVOICE_NUMBER=?,INVOICE_DATE=?,EXCESS_DESCRIPTION=? WHERE APPLICATION_NO=? AND COMMODITY_ID=?
quote.add=INSERT INTO WEBSERVICE_MARINE_QUOTE (BROKER_CODE, REFERENCE_NUMBER, TYPE, OPENCOVER_POLICY_NUMBER, CUSTOMER_NAME, PO_BOX, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGIN_CITY_NAME, DEST_CITY_NAME, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_PERCENT, CURRENCY, SETTLING_AGENT, POLICY_START_DATE, SAILING_DATE, VESSEL_NAME, LC_NUMBER, ISSUING_BANK, LC_DATE, PARTIAL_SHIPMENT, BL_AWB_NUMBER, BL_AWB_DATE, COVERAGES, SEA_COVERAGES, WSRCC, TOLERANCE, BRANCH_CODE, PRODUCT_ID, PACKAGE_TYPE, SALETERM_VALUE,ADDRESS1,ADDRESS2,EMAIL,CUSTOMER_ID,CUST_TITLE,CUST_CORE_APP_CODE,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, LOGIN_ID, ISSUER,SETTLING_AGENT_NAME,AC_EXECUTIVE_ID,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,CUST_AR_NO,VESSEL_ID,APPLICATION_NO, PROMOTIONAL_CODE, CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME, core_customer_name,CHANNEL_TYPE,EXCHANGE_RATE,VIA) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
quote.update=UPDATE WEBSERVICE_MARINE_QUOTE SET TYPE=?, CUSTOMER_NAME=?, PO_BOX=?, EMIRATE=?, MOBILE_NUMBER=?, MODE_OF_TRANSPORT=?, ORIGINATING_COUNTRY=?, DESTINATION_COUNTRY=?, ORIGINATING_COUNTRY_CITY=?, DESTINATION_COUNTRY_CITY=?, ORIGIN_CITY_NAME=?, DEST_CITY_NAME=?, ORIGINATING_WAREHOUSE_COVERAGE=?, DESTINATION_WAREHOUSE_COVERAGE=?, SALETERM_PERCENT=?, CURRENCY=?, SETTLING_AGENT=?, POLICY_START_DATE=TO_DATE(?,'DD/MM/YYYY'), SAILING_DATE=TO_DATE(?,'DD/MM/YYYY'), VESSEL_NAME=?, LC_NUMBER=?, ISSUING_BANK=?, LC_DATE=TO_DATE(?,'DD/MM/YYYY'), PARTIAL_SHIPMENT=?, BL_AWB_NUMBER=?, BL_AWB_DATE=TO_DATE(?,'DD/MM/YYYY'), COVERAGES=?, SEA_COVERAGES=?, WSRCC=?, TOLERANCE=?, PACKAGE_TYPE=?, SALETERM_VALUE=?,ADDRESS1=?,ADDRESS2=?,EMAIL=?,CUSTOMER_ID=?,CUST_TITLE=?,CUST_CORE_APP_CODE=?,CUST_CONTRACT_NO=?, CUST_FMS_CASE_NO=?, CUST_REFERENCE_NO=?,SETTLING_AGENT_NAME=?,SHIPMENT_EXPOSURE=?,EXPOSURE_CURRENCY=?,AC_EXECUTIVE_ID=?,CUST_AR_NO=?,VESSEL_ID=?,ISSUER=?,PROMOTIONAL_CODE=?, CONSIGNEE_DET=?, SPECIAL_TERM=?, ADD_CUST_NAME=?, core_customer_name=?,EXCHANGE_RATE=?,CHANNEL_TYPE=?,VIA=? WHERE APPLICATION_NO=?
quote.count=SELECT (CASE WHEN COUNT(1)>0 THEN 'M' ELSE 'F' END) FROM WEBSERVICE_MARINE_QUOTE WHERE APPLICATION_NO\=? OR QUOTE_NO\=?
quote.edit=SELECT BROKER_CODE, REFERENCE_NUMBER, TYPE, MOC_NUMBER, CUSTOMER_NAME, PO_BOX, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGIN_CITY_NAME, DEST_CITY_NAME, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_VALUE, CURRENCY, (CASE WHEN SETTLING_AGENT IS NULL AND LENGTH(TRIM(SETTLING_AGENT_NAME))>0 THEN '0' ELSE SETTLING_AGENT END) SETTLING_AGENT, TO_CHAR(POLICY_START_DATE,'DD/MM/YYYY') POLICY_START_DATE, TO_CHAR(SAILING_DATE,'DD/MM/YYYY') SAILING_DATE, VESSEL_NAME, DECODE(LC_NUMBER,'0','',LC_NUMBER) LC_NUMBER, ISSUING_BANK, TO_CHAR(LC_DATE,'DD/MM/YYYY') LC_DATE, PARTIAL_SHIPMENT, BL_AWB_NUMBER, TO_CHAR(BL_AWB_DATE,'DD/MM/YYYY') BL_AWB_DATE, QUOTE_NO, COVERAGES, SEA_COVERAGES, WSRCC, TOLERANCE, BRANCH_CODE, PRODUCT_ID, PACKAGE_TYPE, SALETERM_PERCENT,CUST_TITLE,CUST_CORE_APP_CODE,ADDRESS1,ADDRESS2,EMAIL,OPENCOVER_POLICY_NUMBER,APPLICATION_NO,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, LOGIN_ID, ISSUER, SETTLING_AGENT_NAME, AC_EXECUTIVE_ID,CUSTOMER_ID,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,CUST_AR_NO,VESSEL_ID, PROMOTIONAL_CODE, CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME,core_customer_name,CHANNEL_TYPE,EXCHANGE_RATE,VIA FROM WEBSERVICE_MARINE_QUOTE WHERE APPLICATION_NO=? OR QUOTE_NO=?
premium.update.policy.info=UPDATE WEBSERVICE_MARINE_QUOTE SET PDF_PRE_SHOW_STATUS=?, PDF_BANKER_STATUS=?, PDF_GENERATE_STATUS=?, PDF_BANKER_ASSURED_STATUS=?, PDF_CURRENCY_STATUS=?,PDF_STAMP_STATUS=?,NOTE_TYPE=?, PAYMENT_MODE=?, BASIS_VAL=?,CERT_CLAUSES_YN=?,DEBIT_CUST_ID=?,ENDT_PREM_YN=?,ENDT_CLAUSES_YN=?,PDF_EXCESS_STATUS=? WHERE APPLICATION_NO=?
premium.update.referral=UPDATE MARINE_DATA A SET ADMIN_REFERRAL_STATUS=?, REMARKS=? WHERE APPLICATION_NO=?
# AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_DATA WHERE APPLICATION_NO=A.APPLICATION_NO)
report.quoteregister.lapsed=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO PI WHERE A.LOGIN_ID\=? AND A.EFFECTIVE_DATE < (SELECT SYSDATE FROM DUAL) AND A.CUSTOMER_ID \= PI.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.STATUS \= 'Y' AND A.APPLICATION_ID \= '1' AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0')
report.quoteregister.existing = SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (A.PREMIUM, 0) + NVL (A.EXCESS_PREMIUM, 0)) PREMIUM, B.EMAIL FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.STATUS  \= 'Y' AND (A.REMARKS NOT IN ('Admin', 'Referal', 'NORMAL_EXCESS_PRICE')) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND NVL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0')
report.referral.unapproved= SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'Y')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0')
report.referral.approved= SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Admin') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'N')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0')
report.referral.reject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') AS QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A. APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0'), NVL (A.ADMIN_REMARKS,'') ADMIN_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'R' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0')    
premium.update.md=UPDATE MARINE_DATA A SET PREMIUM=?,EXCESS_PREMIUM=?,POLICY_FEE=?,GOVT_TAX=?,TOTAL_WAR_CHARGES=?,INSPECTION_FEE=? WHERE APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_DATA WHERE APPLICATION_NO=A.APPLICATION_NO)
premium.update.pm=UPDATE POSITION_MASTER A SET PREMIUM=?,EXCESS_PREMIUM=? WHERE APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO=A.APPLICATION_NO)
premium.getpolicy.info=SELECT PM.QUOTE_NO, TO_CHAR (PM.ENTRY_DATE, 'DD/MM/YYYY') QUOTE_DATE,TO_CHAR (PM.ENTRY_DATE, 'DD/MM/YYYY') POL_DATE,TO_CHAR (MD.INCEPTION_DATE, 'DD/MM/YYYY') COVER_START_DATE, (CASE WHEN PM.STATUS NOT IN('P','C','D') THEN '' ELSE PM.CREDIT_NOTE_NO END) CREDIT_NOTE_NO, (CASE WHEN PM.STATUS NOT IN('P','C','D') THEN '' ELSE PM.POLICY_NO END) POLICY_NO, (CASE WHEN PM.STATUS NOT IN('P','C','D') THEN '' ELSE PM.DEBIT_NOTE_NO END) DEBIT_NOTE_NO, MD.TOTAL_SUM_INSURED, NVL(PM.PREMIUM,0)+NVL(PM.EXCESS_PREMIUM,0) PREMIUM, (SELECT NVL (FIRST_NAME, COMPANY_NAME) || LAST_NAME FROM PERSONAL_INFO PI WHERE CUSTOMER_ID \= PM.CUSTOMER_ID AND PI.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID)) PROPOSER_NAME, PDF_PRE_SHOW_STATUS, PDF_BANKER_STATUS, PDF_BANKER_ASSURED_STATUS, PDF_CURRENCY_STATUS,PDF_EXCESS_STATUS,PDF_STAMP_STATUS,(CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN 'Y' ELSE 'N' END) STATUS,PM.LOGIN_ID,PM.CERT_CLAUSES_YN,PM.ENDT_PREM_YN,PM.ENDT_CLAUSES_YN,MD.EQUIVALENT_USD,(MD.EQUIVALENT_USD + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT FROM POSITION_MASTER PM, MARINE_DATA MD WHERE PM.APPLICATION_NO \= ? AND PM.APPLICATION_NO \= MD.APPLICATION_NO AND PM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_DATA WHERE APPLICATION_NO \= MD.APPLICATION_NO) AND PM.AMEND_ID\=MD.AMEND_ID
premium.custAccount=SELECT CUST_AR_NO FROM PERSONAL_INFO WHERE CUSTOMER_ID=(SELECT A.CUSTOMER_ID FROM POSITION_MASTER A WHERE A.APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO=A.APPLICATION_NO))
premium.clauses.update=UPDATE POSITION_MASTER A SET  PDF_MODIFY_CLAUSE\=?, PDF_MODIFY_WARRANTY\=?, PDF_MODIFY_EXCLUSION\=?, PDF_MODIFY_EXTRACLAUSES\=? WHERE APPLICATION_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO\=A.APPLICATION_NO)
warOption=SELECT NVL(WRSC_YN,'Y') FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?))     
brokerType=SELECT (CASE WHEN COUNT(*)>0 THEN 'GHQ' ELSE '' END) BROKER_TYPE FROM LOGIN_USER_DETAILS WHERE LOGIN_ID \= ? AND  OA_CODE IN (SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=133)
quotation.getvessel=SELECT VESSEL_ID,VESSEL_NAME,VESSEL_TYPE,VESSEL_CLASS,MANUFACTURE_YEAR FROM VESSEL_MASTER WHERE STATUS IN ('Y','R') AND UPPER(VESSEL_NAME) LIKE UPPER(?) ORDER BY VESSEL_NAME                    
loginId=SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE\=? AND USERTYPE\='Broker'
report.userlist=SELECT LOGIN_ID,USERNAME FROM LOGIN_MASTER WHERE OA_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND USERTYPE != 'Customer' AND USERTYPE != 'User' AND USERTYPE != 'Freight') AND USERTYPE != 'Freight' AND LOGIN_ID IN (SELECT DISTINCT (A.LOGIN_ID) FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.PRODUCT_ID = ? AND A.CUSTOMER_ID = B.CUSTOMER_ID AND B.STATUS = 'Y')
report.userlist.issuer=SELECT DISTINCT PM.LOGIN_ID LOGIN_ID,PM.LOGIN_ID FIRST_NAME,BCM.COMPANY_NAME USERNAME FROM POSITION_MASTER PM,LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE PM.APPLICATION_ID \= ? AND LM.LOGIN_ID\=PM.LOGIN_ID AND LM.OA_CODE\=BCM.AGENCY_CODE AND PM.STATUS in ('P','Y') AND PM.PRODUCT_ID \= ?
declaration.quote.info=SELECT PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(NVL (PM. PREMIUM, 0) + NVL (PM.EXCESS_PREMIUM, 0)) PREMIUM, PM.POLICY_NO, NVL(PM.CREDIT_NOTE_NO,0) CREDIT_NOTE_NO, NVL(PM.DEBIT_NOTE_NO,0) DEBIT_NOTE_NO FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD WHERE PM.QUOTE_NO IN (\:QUOTE_NOS) AND MD.APPLICATION_NO\=PM.APPLICATION_NO AND PI.CUSTOMER_ID\=PM.CUSTOMER_ID
declaration.update.quote= UPDATE POSITION_MASTER SET PDF_GENERATE_STATUS=?,PDF_STAMP_STATUS=?,debit_note_date=to_date(?,''dd/MM/yyyy''),POLICY_EFFECTIVE_DATE=to_date(?,''dd/MM/yyyy'')  WHERE QUOTE_NO IN ({0})
declaratiion_policy_individual=SELECT A.POLICY_NO||'/'||(ROWNUM) POLICY_NO, A.PREMIUM, TO_CHAR (A.INCEPTION_DATE, 'dd/mm/yyyy') AS QUOTE_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.QUOTE_NO, NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.LOGIN_ID IN (SELECT LOGIN_ID FROM POSITION_MASTER WHERE POLICY_NO \= ?) AND A.STATUS \= 'P' AND NVL (A.OPEN_COVER_INT_STATUS, 0) IN ('LINKED') AND A.POLICY_NO \= ? AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= 11 ORDER BY POLICY_NO
quotation.lcnoExist=SELECT CASE WHEN COUNT(LC_NUMBER)=0 THEN 'FALSE' ELSE 'TRUE' END AVAILABLE FROM WEBSERVICE_MARINE_QUOTE WHERE LC_NUMBER=? AND APPLICATION_NO!=?
quotation.invoiceExist=SELECT CASE WHEN COUNT(INVOICE_NUMBER)\=0 THEN 'FALSE' ELSE 'TRUE' END AVAILABLE FROM WEBSERVICE_MARINE_COMMODITY WHERE INVOICE_NUMBER\=?  AND APPLICATION_NO\!\=?
condition1=SELECT CLAUSES_ID CODE,CLAUSES_DESCRIPTION CODE_DESC FROM CLAUSES_MASTER WHERE COVER_ID=:cover AND CLAUSES_ID NOT IN(:id) AND EXTRA_COVER_ID=0 AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY CLAUSES_ID
condition2=SELECT CLAUSES_ID CODE,CLAUSES_DESCRIPTION CODE_DESC FROM CLAUSES_MASTER WHERE COVER_ID=:cover AND CLAUSES_ID NOT IN(:id) AND EXTRA_COVER_ID!=0 AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY CLAUSES_ID
condition3=SELECT EXCLUSION_ID CODE,EXCLUSION_DESCRIPTION CODE_DESC FROM EXCLUSION_MASTER WHERE EXCLUSION_ID NOT IN(:id) AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY EXCLUSION_ID
condition4=SELECT WARRANTY_ID CODE,WARRANTY_DESCRIPTION CODE_DESC FROM WARRANTY_MASTER WHERE WARRANTY_ID NOT IN(:id) AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY WARRANTY_ID
premium.clauses.add=UPDATE POSITION_MASTER SET  PDF_MODIFY_CLAUSE\=PDF_MODIFY_CLAUSE||?, PDF_MODIFY_WARRANTY\=PDF_MODIFY_WARRANTY||?, PDF_MODIFY_EXCLUSION\=PDF_MODIFY_EXCLUSION||?, PDF_MODIFY_EXTRACLAUSES\=PDF_MODIFY_EXTRACLAUSES||? WHERE QUOTE_NO\=?
report.customer= SELECT NVL (FIRST_NAME, COMPANY_NAME) CUSTOMER_NAME , EMAIL, MOBILE, MISSIPPI_CUSTOMER_CODE, REPLACE ( 'P.O.BOX.' || NVL (POBOX, ' ') ||','|| NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') ||','|| NVL (EMIRATE, ' '), 'select','') ADDRESS FROM PERSONAL_INFO WHERE LOGIN_ID \=? AND APPLICATION_ID\= 1 ORDER BY CUSTOMER_ID DESC 
arNoStatus=SELECT CUST_AR_NO FROM PERSONAL_INFO WHERE CUSTOMER_ID=?
opencover.customer=SELECT PI.CUST_AR_NO FROM OPEN_COVER_MASTER OCM,OPEN_COVER_POSITION_MASTER OCPM, PERSONAL_INFO PI WHERE OCPM.OPEN_COVER_NO=? AND PI.CUSTOMER_ID=OCM.CUSTOMER_ID AND OCPM.PROPOSAL_NO=OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX(OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO =OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCMS.PROPOSAL_NO AND TO_DATE(OCMS.EFFECTIVE_DATE,'dd-MM-YYYY') <= TO_DATE(SYSDATE,'dd-MM-YYYY'))
direct.status=Select decode(Count(*),0,'N','Y') direct_status from constant_detail cd Where cd.branch_code = ? and  Cd.remarks =(Select login_id from login_master lm Where agency_code = (Select Oa_Code From Login_Master Lm Where Lm.Login_Id In (Select Pm.Login_Id From Position_Master Pm Where Pm.Application_No=?)))
premium.basisValList=SELECT CATEGORY_DETAIL_ID, REMARKS FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=135 AND BRANCH_CODE\=? AND STATUS\='Y' ORDER BY CATEGORY_DETAIL_ID
report.searchByPortfolio=SELECT A.POLICY_NO, A.CUSTOMER_ID, A.PREMIUM, TO_CHAR (A.INCEPTION_DATE,'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, '0'), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,BCM.COMPANY_NAME FROM POSITION_MASTER A, PERSONAL_INFO B ,BROKER_COMPANY_MASTER BCM,LOGIN_MASTER LM WHERE A.LOGIN_ID=? AND LM.LOGIN_ID=A.LOGIN_ID AND LM.OA_CODE = BCM.AGENCY_CODE AND B.AMEND_ID = (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID ) AND A.STATUS = 'P' AND B.CUSTOMER_ID = A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID = ? AND A.APPLICATION_ID = NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') = NVL(?,'0') AND ORIGINAL_POLICY_NO IS NULL AND DECODE(?,'policyNo',A.POLICY_NO,'quoteNo',A.QUOTE_NO,'custName',UPPER(NVL (B.COMPANY_NAME, B.FIRST_NAME)),A.POLICY_NO) LIKE UPPER(?) ORDER BY TO_NUMBER(SUBSTR (A.POLICY_NO, 6, 6)) DESC,TO_NUMBER(REGEXP_SUBSTR(A.POLICY_NO,'[^-]+',1,2)) DESC
report.searchByQuoteExisting=SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (A.PREMIUM, 0) + NVL (A.EXCESS_PREMIUM, 0)) PREMIUM, B.EMAIL FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.STATUS  \= 'Y' AND (A.REMARKS NOT IN ('Admin', 'Referal', 'NORMAL_EXCESS_PRICE')) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND NVL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByQuoteLapsed=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO PI WHERE A.LOGIN_ID\=? AND A.EFFECTIVE_DATE < (SELECT SYSDATE FROM DUAL) AND A.CUSTOMER_ID \= PI.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.STATUS \= 'Y' AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByQuoteReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (ADD_MONTHS (A.ENTRY_DATE - 1, 1), 'DD/MM/YYYY') VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, C.PREMIUM, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME, (CASE WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Admin' THEN 'Rejected By Admin' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Normal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Referal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND C.REMARKS  \= 'Normal' THEN 'Rejected By Broker' ELSE 'Rejected By Admin' END) REJECT_DESC, A.LAPSED_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA C WHERE C.APPLICATION_NO  \= A.APPLICATION_NO AND A.LOGIN_ID \=? AND (A.STATUS IN ('D')) AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= '1' AND A.APPLICATION_ID  \= NVL(?,'1')  AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByReferralApproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Admin') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'N')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC 
report.searchByReferralUnapproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'Y')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC 
report.searchByReferralReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') AS QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A. APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0'), NVL(A.ADMIN_REMARKS,'') ADMIN_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'R' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByCustomerQuoteExisting=SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (A.PREMIUM, 0) + NVL (A.EXCESS_PREMIUM, 0)) PREMIUM, B.EMAIL FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.STATUS  \= 'Y' AND (A.REMARKS NOT IN ('Admin', 'Referal', 'NORMAL_EXCESS_PRICE')) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND NVL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
report.searchByCustomerQuoteLapsed=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (A.EFFECTIVE_DATE, 'DD/MM/YYYY') VALIDITY_DATE, NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO PI WHERE A.LOGIN_ID\=? AND A.EFFECTIVE_DATE < (SELECT SYSDATE FROM DUAL) AND A.CUSTOMER_ID \= PI.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.STATUS \= 'Y' AND A.APPLICATION_ID \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(PI.COMPANY_NAME) like upper(?) OR  UPPER(PI.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
report.searchByCustomerQuoteReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR (ADD_MONTHS (A.ENTRY_DATE - 1, 1), 'DD/MM/YYYY') VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, C.PREMIUM, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME, (CASE WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Admin' THEN 'Rejected By Admin' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Normal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Referal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND C.REMARKS  \= 'Normal' THEN 'Rejected By Broker' ELSE 'Rejected By Admin' END) REJECT_DESC, A.LAPSED_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA C WHERE C.APPLICATION_NO  \= A.APPLICATION_NO AND A.LOGIN_ID \=? AND (A.STATUS IN ('D')) AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= '1' AND A.APPLICATION_ID  \= NVL(?,'1')  AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
report.searchByCustomerReferralApproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Admin') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'N')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC 
report.searchByCustomerReferralUnapproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0') OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'Y')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATE FROM DUAL) AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC 
report.searchByCustomerReferralReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR (A.ENTRY_DATE, 'DD/MM/YYYY') AS QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A. APPLICATION_NO, B.COMPANY_NAME, NVL (MD.OPEN_COVER_NO, '0'), NVL(A.ADMIN_REMARKS,'') ADMIN_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'R' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') \= NVL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
VIEW_CLAUSES_OPTION = SELECT NVL(CLAUSES_YN,'N') FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?))
GET_RSABROKER_CODE = SELECT RSA_BROKER_CODE FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GET_CORECUSTOMER_CODE = SELECT MISSIPPI_CUSTOMER_CODE FROM PERSONAL_INFO PI WHERE CUSTOMER_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PI1 WHERE PI1.CUSTOMER_ID=PI.CUSTOMER_ID)
marine.exchangeLimit=SELECT ROUND(EM.EXCHANGE_RATE-(EM.EXCHANGE_RATE*(NVL(CM.EX_MINLMT,'1')/100)),2) MIN_LIMIT,ROUND(EM.EXCHANGE_RATE+(EM.EXCHANGE_RATE*(NVL(CM.EX_MAXLMT,'1')/100)),2) MAX_LIMIT  FROM CURRENCY_MASTER CM,EXCHANGE_MASTER EM WHERE CM.COUNTRY_ID\=(SELECT ORIGINATION_COUNTRY_ID FROM BRANCH_MASTER WHERE BRANCH_CODE\=?) AND CM.CURRENCY_ID\=? AND CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=CM.CURRENCY_ID AND CURRENCY_ID\=CM.CURRENCY_ID AND TRUNC(EFFECTIVE_DATE)<\=TRUNC(SYSDATE)) AND TRUNC(CM.EFFECTIVE_DATE)<\=TRUNC(SYSDATE) AND CM.CURRENCY_ID\=EM.CURRENCY_ID AND CM.COUNTRY_ID\=EM.COUNTRY_ID  AND EM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM EXCHANGE_MASTER WHERE CURRENCY_ID\=EM.CURRENCY_ID AND COUNTRY_ID\=EM.COUNTRY_ID AND TRUNC(EFFECTIVE_DATE)<\=TRUNC(SYSDATE)) AND TRUNC(EM.EFFECTIVE_DATE)<\=TRUNC(SYSDATE)
GET_OPENCOVER_DEBITTO = Select Debit_Note From Open_Cover_Master Ocm Where Ocm.Proposal_No=(Select Proposal_No From Open_Cover_Position_Master Ocpm Where Ocpm.Open_Cover_No= ? and ocpm.status='P') and amend_id=(select max(amend_id) from Open_Cover_Master oc Where ocm.proposal_no=oc.proposal_no)
GET_ENDT_SUMPREMIUM = Select sum(premium) premium From Marine_DaTa Md where md.application_no in (select application_no from position_master where (original_policy_no in (select original_policy_no from position_master where application_no=? and status in ('P','E')) or policy_no in (select original_policy_no from position_master where application_no=? and status in ('P','E'))) and amend_id <= (select amend_id from position_master p where p.application_no=?) and  status in ('P','E') or  application_no=?)
GET_SUM_INSURED_ENDT=SELECT   *  FROM   (SELECT  APPLICATION_NO,(round(NVL ( EQUIVALENT_USD, 0) + NVL (TOTAL_SALE_TERM_CHARGES, 0))) suminsured, LAG (round(NVL ( EQUIVALENT_USD, 0) + NVL (TOTAL_SALE_TERM_CHARGES, 0)), 1,0 ) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) AS suminsured_PREV FROM   MARINE_DATA_ENDT) WHERE   APPLICATION_NO = ?
GET_SUM_INSURED=select  ROUND ((  nvl(MD.EQUIVALENT_USD,0) + NVL (MD.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD.TOTAL_TOLERANCE_CHARGES, 0)),0 ) from marine_data md where application_no\=?
UPDATE_OPEN_COVER_UTILIZED_AMOUNT=UPDATE OPEN_COVER_MASTER SET UTILIZED_AMOUNT=NVL(UTILIZED_AMOUNT,0)+NVL(?,0) WHERE PROPOSAL_NO=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO=?)
validate.sum.insured=select case when nvl(UTILIZED_AMOUNT,0)+nvl(?,0) > nvl(CROSS_VOYAGE_TURNOVER,0) then 'false' else 'true' end STATUS from open_cover_master ocm,open_cover_position_master ocpm where ocm.proposal_no=ocpm.proposal_no and ocpm.open_cover_no=? and ocm.AMEND_ID=(select max(amend_id) from open_cover_master where proposal_no=ocm.proposal_no)
GET_POLICYEXCESS=SELECT SUBSTR({0},INSTR({1},''~'',1,4)+1,LENGTH({2})) FROM COMMODITYMASTER A WHERE A.BRANCH_CODE=? AND A.COMMODITY_ID=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE=A.BRANCH_CODE AND COMMODITY_ID=A.COMMODITY_ID)
GET_TRUNC=select nvl(trunc(?,?),0) from dual
GET_ROUND=select nvl(round(?,?),0) from dual
GET_GOVT_TAX=SELECT  NVL(GOVT_TAX, 0) GOVT_TAX FROM BROKER_MASTER WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
INSRT_MPD=INSERT INTO MARINE_POLICY_DETAILS(QUOTE_NO,CUSTOMER_ID,BL_AWB_NO,BL_AWB_DATE,SETTLING_AGENT_ID,CARRIER_NAME,LC_NUMBER,LC_DATE,BANK_NAME,PARTIAL_SHIPMENT_ALLOWED,SPECIAL_DISCOUNT,COMPANY_ID,AMEND_ID,ENTRY_DATE,INCEPTION_DATE,SETTLING_AGENT_NAME,STATUS,SAILING_DATE,PACKAGE_CODE,GHQ_CONTRACT_NO,GHQ_FMS_CASE_NO,GHQ_REFERENCE_NO, CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME)VALUES(?,?,?,to_date(''{0}'',''dd/mm/yyyy''),?,?,?,to_date(''{1}'',''dd/mm/yyyy''),?,?,?,?,?,SYSDATE,SYSDATE,?,''Y'',to_date(''{2}'',''dd/mm/yyyy''),?,?,?,?,?,?,?)
UPDATE_MPD=UPDATE MARINE_POLICY_DETAILS SET CUSTOMER_ID=?,BL_AWB_NO=?,BL_AWB_DATE=to_date(''{0}'',''dd/mm/yyyy''),SETTLING_AGENT_ID=?,CARRIER_NAME=?,LC_NUMBER=?,LC_DATE=to_date(''{1}'',''dd/mm/yyyy''),BANK_NAME=?,PARTIAL_SHIPMENT_ALLOWED=?,SPECIAL_DISCOUNT=?,COMPANY_ID=?,SETTLING_AGENT_NAME=?,SAILING_DATE=to_date(''{1}'',''dd/mm/yyyy''),PACKAGE_CODE=?,GHQ_CONTRACT_NO=?,GHQ_FMS_CASE_NO=?,GHQ_REFERENCE_NO=?,CONSIGNEE_DET=?,SPECIAL_TERM=?, ADD_CUST_NAME=? WHERE QUOTE_NO=? AND AMEND_ID=?
CLOSETRN_BLOCK=SELECT  CASE WHEN Trunc(CLO_DATE_CLOSED) >= TRUNC (SYSDATE) THEN TO_CHAR(SYSDATE,'DD-MM-YYYY HH24:MI:SS') ELSE TO_CHAR(CLO_MONTHEND_DT,'DD-MM-YYYY')||TO_CHAR(SYSDATE,' HH24:MI:SS')  END FROM T_TRN_CLOSING WHERE BRANCH_CODE = ?
GET_SYSDATECL=SELECT TO_CHAR(SYSDATE,'DD-MM-YYYY HH24:MI:SS') FROM DUAL
GET_DUBAI_TRADE=SELECT DECODE(REMARKS,NULL,'N','Y') DUBAI_TRADE_STATUS FROM CONSTANT_DETAIL WHERE REMARKS =(SELECT DISTINCT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND CATEGORY_ID=149 AND BRANCH_CODE=? AND STATUS='Y'
GET_PROMOTION=SELECT NVL(DISCOUNT_RATE,0) FROM PROMOTIONAL_RATE_MASTER PRM WHERE PROMOTIONAL_CODE=? AND BRANCH_CODE=? AND  STATUS='Y' AND TRUNC(SYSDATE) BETWEEN TRUNC(START_DATE) AND TRUNC(END_DATE)  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PROMOTIONAL_RATE_MASTER PRMM WHERE PRMM.PROMOTIONAL_CODE=PRM.PROMOTIONAL_CODE AND PRMM.BRANCH_CODE=PRM.BRANCH_CODE  AND STATUS = 'Y' AND TRUNC (SYSDATE) BETWEEN TRUNC (START_DATE) AND TRUNC (END_DATE))
UPD_PD_CODE=UPDATE  POSITION_MASTER SET PROMOTIONAL_CODE=?, PROMOTIONAL_DISCOUNT=? WHERE APPLICATION_NO=?
UPD_WSB_CODE=UPDATE WEBSERVICE_MARINE_QUOTE SET PROMOTIONAL_DISCOUNT=? WHERE APPLICATION_NO=?
GET_ENDT_CODE=select distinct(ENDT_TYPE_CATEGORY_ID) from endt_type_master where ENDT_TYPE_ID in ({0})
GET_BLONG_BRANCH=SELECT BELONGING_BRANCH FROM BRANCH_MASTER WHERE BRANCH_CODE=?
get_pd_ENDTYPE=select ENDT_TYPE from position_master where application_no=?
#REFERRAL VALIDATION
referral.deposit=select  DEPOSITDETAIL(?,?,?,?,?)from dual
referral.coverage=SELECT REFERAL_STATUS FROM COVER_MASTER WHERE COVER_ID\=? AND BRANCH_CODE\=?
referral.vessel=SELECT STATUS FROM VESSEL_MASTER WHERE VESSEL_ID=?
referral.policyDate.diff=SELECT TO_DATE(TO_CHAR(SYSDATE))-TO_DATE(?,'DD/MM/YYYY') FROM DUAL
referral.policyDate.openCoverDiff=SELECT TO_DATE(A.INCEPTION_DATE,'DD-MM-YYYY')-TO_DATE(?,'DD/MM/YYYY') FROM OPEN_COVER_POSITION_MASTER A WHERE A.OPEN_COVER_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER WHERE A.OPEN_COVER_NO=OPEN_COVER_NO)
referral.country=SELECT status  FROM country_master  WHERE  (country_id=? and amend_id = (SELECT   MAX (amend_id) FROM   country_master WHERE   country_id = ?)) or (country_id=? AND amend_id = (SELECT   MAX (amend_id) FROM   country_master  WHERE   country_id = ?))
referral.crossVoyageSI=SELECT NVL(SUM(MRD.SUMINSUREDLOCAL),0) FROM MARINE_DATA MD,POSITION_MASTER PM,MARINE_RESULT_DETAILS MRD,OPEN_COVER_POSITION_MASTER OCPM WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND MRD.APPLICATION_NO=MD.APPLICATION_NO AND MD.OPEN_COVER_NO=PM.OPEN_COVER_NO AND PM.STATUS='P' AND MD.STATUS='Y' AND MD.TRANSIT_FROM_COUNTRY_ID NOT IN(?) AND MD.FINAL_DESTINATION_COUNTRY_ID NOT IN(?) AND MD.OPEN_COVER_NO=? AND OCPM.OPEN_COVER_NO=PM.OPEN_COVER_NO
referral.crossVoyage=SELECT STATUS FROM COUNTRY_MASTER_DETAIL A WHERE COUNTRY_ID IN(:id) AND BELONGING_COUNTRY_ID=? AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID=A.COUNTRY_ID AND BELONGING_COUNTRY_ID=A.BELONGING_COUNTRY_ID)
referral.land=SELECT COUNT(*) FROM CONSTANT_DETAIL WHERE CATEGORY_ID=8 AND BRANCH_CODE=? AND CATEGORY_DETAIL_ID=? AND STATUS='Y'
referral.policyDate.backDate=SELECT NVL(BACK_DATE_ALLOWED,0) FROM LOGIN_USER_DETAILS WHERE AGENCY_CODE IN(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND PRODUCT_ID=?
referral.master=SELECT A.REFERAL_ID,A.STATUS FROM REFERAL_MASTER A WHERE A.BRANCH_CODE=? AND A.EFFECTIVE_START_DATE<(SELECT SYSDATE FROM DUAL) AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM REFERAL_MASTER WHERE BRANCH_CODE=A.BRANCH_CODE AND EFFECTIVE_START_DATE<(SELECT SYSDATE FROM DUAL)) ORDER BY REFERAL_ID
referral.suminsured=SELECT INSURANCE_END_LIMIT SUM_INSURED_LIMIT,MIN_PREMIUM_AMOUNT MIN_PREMIUM FROM LOGIN_USER_DETAILS  WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND PRODUCT_ID=?
referral.OCsuminsured=SELECT  (OCD.SUM_INSURED_LIMIT*OCD.EXCHANGE_RATE) SUM_INSURED_LIMIT,OCD.MODE_TRANSPORT_ID,OCD.EXCHANGE_ID,OCD.CURRENCY_ID,OCD.EXCHANGE_RATE,OCD.CURRENCY_NAME,OCD.AMEND_ID FROM OPEN_COVER_DETAIL OCD,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO =? AND OCPM.PROPOSAL_NO=OCD.PROPOSAL_NO AND OCD.AMEND_ID IN (SELECT MAX(OCDS.AMEND_ID) FROM OPEN_COVER_DETAIL OCDS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO =OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCDS.PROPOSAL_NO AND TO_DATE(OCDS.EFFECTIVE_DATE,'dd-MM-YYYY') <= TO_DATE(SYSDATE,'dd-MM-YYYY')) AND OCD.MODE_TRANSPORT_ID=?
referral.LCsuminsured=SELECT NVL(SUM(MRD.SUMINSUREDLOCAL+MD.TOTAL_SALE_TERM_CHARGES+MD.TOTAL_TOLERANCE_CHARGES),0) SUM_INSURED_LIMIT FROM MARINE_DATA MD,MARINE_RESULT_DETAILS MRD,POSITION_MASTER PM WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND MD.APPLICATION_NO=MRD.APPLICATION_NO AND MD.OPEN_COVER_NO=PM.OPEN_COVER_NO AND PM.STATUS='P' AND MD.STATUS='Y' AND MD.OPEN_LC_ID=? AND MD.OPEN_BANK_ID=? AND MD.OPEN_COVER_NO=?
referral.basisVal=SELECT A.SALE_TERM_VALUE,B.TOLERANCE_VALUE FROM SALE_TERM_MASTER A, TOLERANCE_MASTER B WHERE A.SALE_TERM_ID=? AND A.BRANCH_CODE=? AND B.TOLERANCE_ID=? AND B.BRANCH_CODE=A.BRANCH_CODE
referral.countryStartPlace=SELECT STARTING_PLACE FROM COUNTRY_MASTER_DETAIL A WHERE A.COUNTRY_ID=? AND A.BELONGING_COUNTRY_ID=? AND A.AMEND_ID=(SELECT MAX(B.AMEND_ID) FROM COUNTRY_MASTER_DETAIL B WHERE B.COUNTRY_ID=A.COUNTRY_ID AND B.BELONGING_COUNTRY_ID=A.BELONGING_COUNTRY_ID)
referral.countryEndPlace=SELECT ENDING_PLACE FROM COUNTRY_MASTER_DETAIL A WHERE A.COUNTRY_ID=? AND A.BELONGING_COUNTRY_ID=? AND A.AMEND_ID=(SELECT MAX(B.AMEND_ID) FROM COUNTRY_MASTER_DETAIL B WHERE B.COUNTRY_ID=A.COUNTRY_ID AND B.BELONGING_COUNTRY_ID=A.BELONGING_COUNTRY_ID)
marine.lc.master=SELECT BM.BANK_NAME,OPLM.LC_NUMBER,(OPLM.LC_AMOUNT*EM.EXCHANGE_RATE) LC_AMOUNT,OPLM.LC_DATE,CM.CURRENCY_NAME,OPLM.LC_CURRENCY_ID,EM.EXCHANGE_RATE,BM.BANK_ID FROM OPEN_COVER_LC_MASTER OPLM,OPEN_COVER_BANK_MASTER BM,CURRENCY_MASTER CM,EXCHANGE_MASTER EM WHERE OPLM.STATUS='Y' AND LC_ID=? AND OPLM.BANK_ID=? AND OPLM.BANK_ID=BM.BANK_ID AND CM.CURRENCY_ID=NVL(OPLM.LC_CURRENCY_ID,'0') AND OPEN_COVER_NO=? AND CM.AMEND_ID||'-'||CM.CURRENCY_ID IN (SELECT MAX(CMS.AMEND_ID)||'-'||CMS.CURRENCY_ID FROM CURRENCY_MASTER CMS WHERE TO_CHAR(CMS.EFFECTIVE_DATE,'dd-mm-YYYY') <= TO_CHAR(SYSDATE,'dd-mm-YYYY') GROUP BY CMS.CURRENCY_ID ) AND BM.AMEND_ID||'-'||BM.BANK_ID IN (SELECT MAX(OCBMS.AMEND_ID)||'-'||OCBMS.BANK_ID FROM OPEN_COVER_BANK_MASTER OCBMS WHERE TO_DATE(OCBMS.EFFECTIVE_DATE,'dd-mm-YYYY') <=TO_DATE(SYSDATE,'dd-mm-YYYY') GROUP BY OCBMS.BANK_ID) AND EM.AMEND_ID||'-'||EM.CURRENCY_ID IN (SELECT MAX(EMS.AMEND_ID)||'-'||EMS.CURRENCY_ID FROM EXCHANGE_MASTER EMS WHERE TO_CHAR(EMS.EFFECTIVE_DATE,'dd-mm-YYYY') <= TO_CHAR(SYSDATE,'dd-mm-YYYY') GROUP BY EMS.CURRENCY_ID ) AND EM.CURRENCY_ID=OPLM.LC_CURRENCY_ID ORDER BY OPLM.LC_ID
marine.oc.master=SELECT OCM.BROKER_ID,OCM.BROKER_USER_ID,OCM.POLICY_START_DATE,OCM.POLICY_END_DATE,OCM.PRODUCT_ID,OCM.CUSTOMER_ID,OCM.BRANCH_CODE,OCM.CROSS_VOYAGE_TURNOVER,OCM.CROSS_VOYAGE_SUMINSURED_LIMIT,OCM.BACK_DATE_DAYS,OCM.COMMISSION,OCM.NO_OF_INSURANCE_COMPANY,OCM.CROSS_VOYAGE_PERCENTAGE,OCM.RSA_SHARED_PERCENTAGE,OCM.CROSS_VOYAGE,OCM.EXPORT_MIN_PREMIUM_AMOUNT,OCM.FREE_TEXT_ALLOWED,OCM.AMEND_ID,OCM.BUSINESS_TYPE,OCM.MISSIPPI_OPENCOVER_NO FROM OPEN_COVER_MASTER OCM,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO =? AND OCPM.PROPOSAL_NO=OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX(OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO =OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCMS.PROPOSAL_NO AND TO_DATE(OCMS.EFFECTIVE_DATE,'dd-MM-YYYY') <= TO_DATE(SYSDATE,'dd-MM-YYYY'))
marine.commodity=SELECT MRD.APPLICATION_NO,MRD.COMMODITY_ID,MRD.SUM_INSURED,MRD.DESCRIPTION,MRD.FRAGILE,MRD.COMMODITY_TYPE_ID,MRD.COMMODITY_EXCESS_PREMIUM FROM MARINE_RESULT_DETAILS MRD WHERE MRD.APPLICATION_NO=? AND  STATUS='Y' AND MRD.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO=MRD.APPLICATION_NO AND STATUS=MRD.STATUS) ORDER by sno
marine.commodity.OCrate=SELECT NVL(OCCD.COMMODITY_BASE_RATE,0) FROM OPEN_COVER_COMMODITY_DETAIL OCCD,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO=? AND OCCD.PROPOSAL_NO=OCPM.PROPOSAL_NO AND OCCD.AMEND_ID IN (SELECT MAX(OCCDS.AMEND_ID) FROM OPEN_COVER_COMMODITY_DETAIL OCCDS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO=OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCCDS.PROPOSAL_NO AND TO_DATE(OCCDS.EFFECTIVE_DATE,'dd-MM-YYYY') <= TO_DATE(SYSDATE,'dd-MM-YYYY')) AND OCCD.COMMODITY_ID=? AND OCCD.COVER_ID=? AND NVL(OCCD.COVER_TYPE_ID,0) = DECODE(OCCD.COVER_TYPE_ID,0,0,?)
marine.loadValue.WTH=SELECT NVL(LOAD_VALUE,'0') FROM REFERAL_MASTER WHERE REFERAL_ID='17' AND BRANCH_CODE=?
marine.loadValue.LCL=SELECT NVL(LOAD_VALUE,'0') FROM REFERAL_MASTER WHERE REFERAL_ID='16' AND BRANCH_CODE=?
round=SELECT ROUND(?,NVL(RFACTOR,'0')) FROM CURRENCY_MASTER A WHERE CURRENCY_ID\=? AND COUNTRY_ID\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=A.CURRENCY_ID AND COUNTRY_ID\=A.COUNTRY_ID)
marine.appNo.max=SELECT APPLICATION_NO.NEXTVAL FROM DUAL
marine.update.premium.rate=UPDATE MARINE_RESULT_DETAILS SET RATE\=?,PREMIUM\=?,CURRENCY_ID\=?,EXCHANGE_ID\=?,CURRENCY_NAME\=?,EXCHANGE_RATE\=?,SALE_TERM_CHARGES\=?,WAR_CHARGES\=?,REFERRAL\=?,WARRATE\=?,SUMINSUREDLOCAL\=?,SEA_OPTION_LCL\=?,WAREHOUSE_WAREHOUSE\=?,TOLERANCE_CHARGES\=?,AGREED_STATUS\=?,COMMODITY_EXCESS_PREMIUM\=?,policy_excess_percent\=? WHERE  APPLICATION_NO\=? AND COMMODITY_ID\=? AND STATUS\=?
marine.data.count=SELECT COUNT(*) FROM MARINE_DATA WHERE APPLICATION_NO=? AND AMEND_ID=?
marine.currency.info=SELECT EM.EXCHANGE_ID, EM.EXCHANGE_RATE, EM.CURRENCY_ID, CM.CURRENCY_NAME FROM EXCHANGE_MASTER EM, CURRENCY_MASTER CM WHERE EM.CURRENCY_ID = ? AND EM.CURRENCY_ID = CM.CURRENCY_ID AND EM.STATUS = 'Y' AND CM.STATUS = 'Y' AND EM.COUNTRY_ID = ? AND EM.COUNTRY_ID=CM.COUNTRY_ID AND EM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM EXCHANGE_MASTER WHERE CURRENCY_ID = EM.CURRENCY_ID AND STATUS = 'Y' AND COUNTRY_ID = EM.COUNTRY_ID AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE)) AND CM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND STATUS = 'Y' AND COUNTRY_ID = CM.COUNTRY_ID AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE))
marine.executive.name=SELECT AC_EXECUTIVE_NAME FROM LOGIN_EXECUTIVE_DETAILS WHERE AC_EXECUTIVE_ID\=? AND STATUS\='Y'
marine.data.insert=INSERT INTO MARINE_DATA (APPLICATION_NO,MODE_OF_TRANSPORT,WAREHOUSE_TO_WAREHOUSE,TRANSIT_FROM,FINAL_DESTINATION, NO_OF_ITEMS,TOTAL_SUM_INSURED,CURRENCY_ID,EXCHANGE_ID,CURRENCY_NAME,EXCHANGE_RATE,SALE_TERM_ID,COVER_ID,EXTRA_COVER_ID,AC_EXECUTIVE_ID,AC_EXECUTIVE_NAME,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,REMARKS,STATUS,EQUIVALENT_USD,COMPANY_ID,PREMIUM,TRANSIT_FROM_CITY_ID,TRANSIT_FROM_COUNTRY_ID,FINAL_DESTINATION_CITY_ID,FINAL_DESTINATION_COUNTRY_ID,REFERRAL,TOTAL_SALE_TERM_CHARGES,TOTAL_WAR_CHARGES,SEA_OPTIONS,WARE_TO_WARE_FINAL_DEST,PRODUCT_ID,OPEN_COVER_NO,OPEN_BANK_ID,OPEN_LC_ID,OPEN_VESSEL_NAME,OPEN_VESSEL_OPTION,TOLERANCE_ID,TOTAL_TOLERANCE_CHARGES,PARTIAL_SHIPPING,PARTIAL_SUM_INSURED_AMOUNT,EXPOSURE_CURRENCY,OC_VESSEL_ID,POLICY_FEE, GOVT_TAX, EMERGENCY_FUND,EXCESS_PREMIUM,ADMIN_REFERRAL_STATUS,CHANNEL_TYPE,UWGRADE,VIA) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'dd-mm-yyyy hh24:mi:ss'),SYSDATE,SYSDATE,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
marine.data.update=UPDATE MARINE_DATA SET MODE_OF_TRANSPORT=?,WAREHOUSE_TO_WAREHOUSE=?,TRANSIT_FROM=?,FINAL_DESTINATION=?,NO_OF_ITEMS=?,TOTAL_SUM_INSURED=?,CURRENCY_ID=?,EXCHANGE_ID=?,CURRENCY_NAME=?,EXCHANGE_RATE=?,SALE_TERM_ID=?,COVER_ID=?,EXTRA_COVER_ID=?,AC_EXECUTIVE_ID=?,AC_EXECUTIVE_NAME=?,INCEPTION_DATE=TO_DATE(?,'dd-mm-yyyy hh24:mi:ss'),EXPIRY_DATE=SYSDATE,EFFECTIVE_DATE=SYSDATE,ENTRY_DATE=SYSDATE,EQUIVALENT_USD=?,COMPANY_ID=?,PREMIUM=?,TRANSIT_FROM_CITY_ID=?,TRANSIT_FROM_COUNTRY_ID=?,FINAL_DESTINATION_CITY_ID=?,FINAL_DESTINATION_COUNTRY_ID=?,REFERRAL=?,TOTAL_SALE_TERM_CHARGES=?,TOTAL_WAR_CHARGES=?,SEA_OPTIONS=?,WARE_TO_WARE_FINAL_DEST=?,PRODUCT_ID=?,OPEN_COVER_NO=?,OPEN_BANK_ID=?,OPEN_LC_ID=?,OPEN_VESSEL_NAME=?,OPEN_VESSEL_OPTION=?,TOLERANCE_ID=?,TOTAL_TOLERANCE_CHARGES=?,PARTIAL_SHIPPING=?,PARTIAL_SUM_INSURED_AMOUNT=?,EXPOSURE_CURRENCY=?,OC_VESSEL_ID=?,DEC_EXCESS_PREMIUM='',REMARKS=?,POLICY_FEE=?, GOVT_TAX=?, EMERGENCY_FUND=?,EXCESS_PREMIUM=?,ADMIN_REFERRAL_STATUS=?,CHANNEL_TYPE=?,UWGRADE=?,VIA=? WHERE APPLICATION_NO=? AND STATUS=? AND AMEND_ID=?
marine.update.linked.Status=UPDATE POSITION_MASTER A SET a.OPEN_COVER_INT_STATUS\='' WHERE A.APPLICATION_NO\=?
marine.tracking.count=SELECT COUNT(*) FROM TRACKING_MASTER WHERE APPLICATION_NO=? AND LOGIN_ID=? AND SESSION_ID=? AND STATUS='Y'
marine.tracking.insert=INSERT INTO TRACKING_MASTER (SERIAL_NO,SESSION_ID,LOGIN_ID,STAGE_ID,APPLICATION_NO,PRODUCT_ID,REMARKS,STATUS,START_TIME) VALUES((SELECT NVL(MAX(SERIAL_NO),'0')+1 FROM TRACKING_MASTER),?,?,?,?,?,?,?,SYSDATE)
marine.tracking.update=UPDATE TRACKING_MASTER SET STAGE_ID\=?,END_TIME\=SYSDATE WHERE APPLICATION_NO\=? AND STATUS\=? AND SESSION_ID\=? AND LOGIN_ID\=?
marine.customer.count=SELECT COUNT(*) FROM PERSONAL_INFO WHERE CUSTOMER_ID=?
marine.customer.insert=INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,MOBILE,EMAIL,ADDRESS1,ADDRESS2,POBOX,EMIRATE,STATUS,ENTRY_DATE,LOGIN_ID,MISSIPPI_CUSTOMER_CODE,CLIENT_CUSTOMER_ID,CUST_AR_NO,CUST_NAME) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?)
marine.customer.update=UPDATE PERSONAL_INFO SET APPLICATION_ID=?,TITLE=?,FIRST_NAME=?,LAST_NAME=?,MOBILE=?,EMAIL=?,ADDRESS1=?,ADDRESS2=?,POBOX=?,EMIRATE=?,STATUS=?,MISSIPPI_CUSTOMER_CODE=?,CLIENT_CUSTOMER_ID=?,CUST_AR_NO=?,CUST_NAME=? WHERE CUSTOMER_ID=?
marine.policy.fee=SELECT PERCENT POLICY_FEE_DEFAULT,'0' POLICY_FEE_PERCENT FROM CONSTANT_DETAIL  WHERE CATEGORY_DETAIL_ID=1 AND BRANCH_CODE=? AND CATEGORY_ID=131 AND STATUS='Y'
marine.policy.fee.oc=SELECT A.MIN_PREMIUM_ISSUANCE_FEE POLICY_FEE_DEFAULT,A.ISSUANCE_FEE POLICY_FEE_PERCENT,A.COMMISSION COMMISSION FROM OPEN_COVER_MASTER A  WHERE A.MISSIPPI_OPENCOVER_NO=? AND A.BRANCH_CODE=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO=A.MISSIPPI_OPENCOVER_NO)
marine.fee.broker=SELECT (CASE WHEN (POLICY_FEE_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'BROKER')) THEN NVL(POLICY_FEE,'0') ELSE 0 END) POLICY_FEE,(CASE WHEN (GOVT_TAX_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'BROKER')) THEN NVL(GOVT_TAX,'0') ELSE 0 END)GOVT_TAX,(CASE WHEN (EMERGENCY_FUND_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH'  OR UPPER(TAX_APPLICABLE) = 'BROKER')) THEN NVL(EMERGENCY_FUND,'0') ELSE 0 END)EMERGENCY_FUND,POLICY_FEE_STATUS FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND TO_DATE(EFFECTIVE_DATE,'dd-MM-YYYY') <=TO_DATE(SYSDATE) AND AMEND_ID||AGENCY_CODE IN(SELECT MAX(AMEND_ID)||AGENCY_CODE FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND TO_DATE(EFFECTIVE_DATE,'dd-MM-YYYY') <=TO_DATE(SYSDATE) GROUP BY AGENCY_CODE)
marine.fee.issuer=SELECT (CASE WHEN (POLICY_FEE_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'USER')) THEN NVL(POLICY_FEE,'0') ELSE 0 END) POLICY_FEE,(CASE WHEN (GOVT_TAX_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'USER')) THEN NVL(GOVT_TAX,'0') ELSE 0 END)GOVT_TAX,(CASE WHEN (EMERGENCY_FUND_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH'  OR UPPER(TAX_APPLICABLE) = 'USER')) THEN NVL(EMERGENCY_FUND,'0') ELSE 0 END)EMERGENCY_FUND,POLICY_FEE_STATUS FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND TO_DATE(EFFECTIVE_DATE,'dd-MM-YYYY') <=TO_DATE(SYSDATE,'dd-MM-YYYY') AND AMEND_ID||AGENCY_CODE IN(SELECT MAX(AMEND_ID)||AGENCY_CODE FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND TO_DATE(EFFECTIVE_DATE,'dd-MM-YYYY') <=TO_DATE(SYSDATE,'dd-MM-YYYY') GROUP BY AGENCY_CODE)
marine.quote.count=SELECT COUNT(1) FROM POSITION_MASTER WHERE QUOTE_NO=? AND AMEND_ID=?
marine.quoteNo.max=SELECT ONEOFF_QUOTE.NEXTVAL FROM DUAL
marine.quoteNo.max.oc=SELECT OPENCOVER_QUOTE.NEXTVAL FROM DUAL
marine.quote.insert=INSERT INTO POSITION_MASTER (PRODUCT_ID,LOGIN_ID,COMPANY_ID,APPLICATION_NO,AMEND_ID,QUOTE_NO,CUSTOMER_ID,APPLICATION_ID,STATUS,ENTRY_DATE,EFFECTIVE_DATE,EXCESS_PREMIUM,BUSINESS_TYPE,OPEN_COVER_NO,MISSIPPI_OPENCOVER_NO,REMARKS,PREMIUM) VALUES(?,?,?,?,?,?,?,?,?,SYSDATE,(SELECT ADD_MONTHS(SYSDATE,1)-1 FROM DUAL),?,?,?,?,?,?)
marine.quote.update=UPDATE POSITION_MASTER SET CUSTOMER_ID\=?,EXCESS_PREMIUM\=?,REMARKS\=?,PREMIUM\=?,APPLICATION_ID\=? WHERE APPLICATION_NO\=? AND QUOTE_NO\=? AND AMEND_ID\=?
GET_WAR_OPTION = SELECT EXTRA_COVER_ID FROM MARINE_DATA MD WHERE APPLICATION_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO=MD.APPLICATION_NO)

#COMMODITY INSERT/UPDATE
CAL_PROC_COMM=CALL MARINE_COMMODITY_INSERT(?,?,?)

#MASTER INFO
GET_LC_MASTER_INFO=SELECT BM.BANK_NAME,OPLM.LC_NUMBER,(OPLM.LC_AMOUNT*EM.EXCHANGE_RATE) LC_AMOUNT,OPLM.LC_DATE,CM.CURRENCY_NAME,OPLM.LC_CURRENCY_ID,EM.EXCHANGE_RATE,BM.BANK_ID FROM OPEN_COVER_LC_MASTER OPLM,OPEN_COVER_BANK_MASTER BM,CURRENCY_MASTER CM,EXCHANGE_MASTER EM WHERE OPLM.STATUS='Y' AND LC_ID=? AND OPLM.BANK_ID=? AND OPLM.BANK_ID=BM.BANK_ID AND CM.CURRENCY_ID=NVL(OPLM.LC_CURRENCY_ID,'0') AND OPEN_COVER_NO=? AND CM.AMEND_ID=(  SELECT   MAX (CMS.AMEND_ID) FROM   CURRENCY_MASTER CMS WHERE   To_Date (CMS.EFFECTIVE_DATE, 'dd-mm-YYYY') <= To_Date (SYSDATE, 'dd-mm-YYYY') and CMS.CURRENCY_ID=CM.CURRENCY_ID) AND BM.AMEND_ID||'-'||BM.BANK_ID IN (SELECT MAX(OCBMS.AMEND_ID)||'-'||OCBMS.BANK_ID FROM OPEN_COVER_BANK_MASTER OCBMS WHERE TO_DATE(OCBMS.EFFECTIVE_DATE,'dd-mm-YYYY') <=TO_DATE(SYSDATE,'dd-mm-YYYY') GROUP BY OCBMS.BANK_ID) AND EM.AMEND_ID||'-'||EM.CURRENCY_ID IN (SELECT MAX(EMS.AMEND_ID)||'-'||EMS.CURRENCY_ID FROM EXCHANGE_MASTER EMS WHERE TO_DATE(EMS.EFFECTIVE_DATE,'dd-mm-YYYY') <= TO_DATE(SYSDATE,'dd-mm-YYYY') GROUP BY EMS.CURRENCY_ID ) AND EM.CURRENCY_ID=OPLM.LC_CURRENCY_ID ORDER BY OPLM.LC_ID
GET_PREM_LOAD_DISC=SELECT LUD.PRODUCT_ID,NVL(LUD.COMMISSION,0)COMMISSION,NVL(LUD.LOADING_OF_PREMIUM,0)LOADING_OF_PREMIUM,NVL(LUD.DISCOUNT_OF_PREMIUM,0)DISCOUNT_OF_PREMIUM,NVL(LUD.MIN_PREMIUM_AMOUNT,0)MIN_PREMIUM_AMOUNT FROM LOGIN_MASTER LM,LOGIN_USER_DETAILS LUD WHERE LM.AGENCY_CODE=LUD.AGENCY_CODE AND LUD.LOGIN_ID=LM.LOGIN_ID AND LUD.AGENCY_CODE =(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND LUD.PRODUCT_ID='3'
GET_CONDITIONS=select CODE,CODEDESC,CODESTATUS FROM TABLE(SCHEDULE_CLAUSES(?,?,?,?)) WHERE CODEDESC IS NOT NULL ORDER BY TO_NUMBER(CODE)
GET_CONSTANT=SELECT CATEGORY_DETAIL_ID, DETAIL_NAME, REMARKS FROM CONSTANT_DETAIL WHERE BRANCH_CODE=? AND CATEGORY_ID=? AND STATUS='Y'

#CUSTOMER
GET_CUST_ID_MAX=SELECT CUSTOMER_NUMBER_SEQ.NEXTVAL FROM DUAL
GET_CUST_SEQ = select CUST_SEQ_CREATION(?,?) FROM DUAL

#MARINE_POLICY_DETAILS
CNT_MARINE_POLICY=SELECT COUNT(*) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO=? AND AMEND_ID=?
INS_MARINE_POLICY=INSERT INTO MARINE_POLICY_DETAILS(QUOTE_NO,CUSTOMER_ID,BL_AWB_NO,BL_AWB_DATE,SETTLING_AGENT_ID,CARRIER_NAME,LC_NUMBER,LC_DATE,BANK_NAME,PARTIAL_SHIPMENT_ALLOWED,SPECIAL_DISCOUNT,COMPANY_ID,AMEND_ID,ENTRY_DATE,INCEPTION_DATE,SETTLING_AGENT_NAME,STATUS,SAILING_DATE,PACKAGE_CODE,GHQ_CONTRACT_NO,GHQ_FMS_CASE_NO,GHQ_REFERENCE_NO)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,SYSDATE,?,'Y',to_date(?,'DD/MM/YYYY'),?,?,?,?)
UPD_MARINE_POLICY=UPDATE MARINE_POLICY_DETAILS SET CUSTOMER_ID=?,BL_AWB_NO=?,BL_AWB_DATE=?,SETTLING_AGENT_ID=?,CARRIER_NAME=?,LC_NUMBER=?,LC_DATE=?,BANK_NAME=?,PARTIAL_SHIPMENT_ALLOWED=?,SPECIAL_DISCOUNT=?,COMPANY_ID=?,SETTLING_AGENT_NAME=?,SAILING_DATE=?,PACKAGE_CODE=?,GHQ_CONTRACT_NO=?,GHQ_FMS_CASE_NO=?,GHQ_REFERENCE_NO=? WHERE QUOTE_NO=? AND AMEND_ID=?
CNT_MARINE_RESULT=SELECT COUNT(*) FROM MARINE_RESULT WHERE QUOTE_NO=? AND APPLICATION_NO=? AND AMEND_ID=?
INS_MARINE_RESULT=INSERT INTO MARINE_RESULT(APPLICATION_NO,QUOTE_NO,COMPANY_ID,AMEND_ID,CUSTOMER_ID,TOTAL_SUM_INSURED,PREMIUM,INSURANCE_FEE,NET_PREMIUM,SPECIAL_DISCOUNT,AMOUNT_PAYABLE,ENTRY_DATE) VALUES(?,?,?,?,?,?,?,?,?,?,?,SYSDATE)
UPD_MARINE_RESULT=UPDATE MARINE_RESULT SET TOTAL_SUM_INSURED=?,PREMIUM=?,INSURANCE_FEE=?,NET_PREMIUM=?,SPECIAL_DISCOUNT=?,AMOUNT_PAYABLE=?,CUSTOMER_ID=? WHERE QUOTE_NO=? AND APPLICATION_NO=? AND AMEND_ID=?

#RATE CALCULATION
rate.coveragevalue=SELECT COVERAGE_REFERAL FROM COMMODITYMASTER  WHERE COMMODITY_ID = ? AND BRANCH_CODE = ? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE =? AND COMMODITY_ID=?)
rate.coverreferral=SELECT COUNT(COMMODITY_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID = ? AND {0} IN ({1}) AND BRANCH_CODE = ?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE = ? AND COMMODITY_ID=?)
rate.commodityreferral=SELECT STATUS FROM COMMODITYMASTER WHERE  COMMODITY_ID = ? AND BRANCH_CODE = ? AND AMEND_ID= (SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE = ? AND COMMODITY_ID=?)
rate.coveragereferral=SELECT COUNT(*) FROM COMMODITYMASTER WHERE  COMMODITY_ID = ? AND COVERAGE_REFERAL IN(?) AND BRANCH_CODE = ? AND AMEND_ID= (SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE = ? AND COMMODITY_ID=?)
rate.basevalue=SELECT COVER_RATE FROM COVER_MASTER WHERE COVER_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT max(amend_id) from COVER_MASTER where cover_id=? AND BRANCH_CODE=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy')) AND STATUS='Y'
rate.fact1value=SELECT RATE FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED<=? AND  END_SUM_INSURED>=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED<=? AND  END_SUM_INSURED>=? AND BRANCH_CODE=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy') ) AND STATUS='Y'
rate.fact2value=SELECT MATERIAL_RATE FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_ID =? AND BRANCH_CODE=? and COVER_ID=? AND AMEND_ID=( SELECT MAX(AMEND_ID) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_ID=? AND BRANCH_CODE=? and COVER_ID=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy')) AND STATUS='Y'
##Orient Takaful change
rate.fact3value=SELECT GEO_RATE  FROM  COUNTRY_MASTER WHERE COUNTRY_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy') ) AND STATUS='Y'
rate.fact4value=SELECT CONV_RATE FROM CONVEYAN_MASTER WHERE SNO =? AND MODE_TRANSPORT_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE SNO =? AND MODE_TRANSPORT_ID =? AND BRANCH_CODE=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy')) AND STATUS='Y'
rate.fact5value=SELECT COMMODITY_RATE FROM COMMODITYMASTER WHERE COMMODITY_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE  COMMODITY_ID =? AND BRANCH_CODE=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy')) AND STATUS='Y'
rate.fact6value=select PERCENT from package_master where PACKAGE_ID=?  and BRANCH_CODE=? and MODE_TRANSPORT_ID=?
rate.wsrccvalue=SELECT WAR_RATE FROM WAR_RATE_MASTER WHERE MODE_TRANSPORT_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM WAR_RATE_MASTER WHERE MODE_TRANSPORT_ID=? AND BRANCH_CODE=? AND EFFECTIVE_DATE <= TO_DATE(?,'dd/MM/yyyy')) AND STATUS='Y'
rate.insertfactor=INSERT INTO COMMODITY_RATE_FACTOR(AMEND_ID, COMMODITY, COVER_RATE, SUM_INSURED_RATE, MATERIAL_RATE, GEO_RATE, CONV_RATE, COMMODITY_RATE, WAR_RATE,RATE,PACKAGE_RATE,APPLICATION_NO) vALUES((SELECT NVL((MAX(AMEND_ID)+1),'0') FROM COMMODITY_RATE_FACTOR WHERE COMMODITY=?),?,?,?,?,?,?,?,?,?,?,?)

rate.coverdesc=SELECT DISTINCT DESCRIPTION FROM COVER_MASTER WHERE COVER_ID=?
rate.selectcoverdesc=SELECT SUBSTR(?,INSTR(?,'~',1,4)+1,LENGTH(?)) FROM COMMODITYMASTER A WHERE A.BRANCH_CODE=? AND A.COMMODITY_ID=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE=A.BRANCH_CODE AND COMMODITY_ID=A.COMMODITY_ID)
rate.excessamt=SELECT NVL (A.EXCESS_AMOUNT, '0') EXCESS_AMOUNT,EXCESS_PERCENT  FROM OPEN_COVER_DEDUCTIBLE_MASTER A, OPEN_COVER_POSITION_MASTER B WHERE ? BETWEEN A.START_RANGE AND A.END_RANGE AND A.OPEN_COVER_PROPOSAL_NO = B.PROPOSAL_NO AND B.OPEN_COVER_NO = ? AND A.STATUS = 'Y' AND TO_DATE(A.effective_date,'dd-MM-YY') <= TO_DATE(SYSDATE,'dd-MM-YY') AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DEDUCTIBLE_MASTER WHERE TO_DATE(effective_date,'dd-MM-YY') <= TO_DATE(SYSDATE,'dd-MM-YY') AND OPEN_COVER_PROPOSAL_NO = A.OPEN_COVER_PROPOSAL_NO)
rate.selectdeductibles=SELECT NVL(DEDUCTIBLE,'0') FROM COMMODITY_EXCESS_PREMIUM WHERE ? BETWEEN START_SUM_INSURED AND END_SUM_INSURED AND STATUS='Y'
GET_OPENCOVER_EXCESS_DETAILS = select PROPOSAL_NO,COMMODITY_ID,COVER_ID,DISCOUNT_PERCENT,DISCOUNT_VALUE from OPEN_COVER_COMMODITY_DETAIL OCC where PROPOSAL_NO=(select PROPOSAL_NO from OPEN_COVER_POSITION_MASTER where OPEN_COVER_NO=?) and cover_id=? and commodity_id=? and  NVL(OCC.COVER_TYPE_ID,0) = DECODE(OCC.COVER_TYPE_ID,0,0,?) and amend_id=(select max(amend_id) from OPEN_COVER_COMMODITY_DETAIL oc where oc.proposal_no=occ.proposal_no)

#WAR RATE
GET_CONVEY_WARRATE=SELECT A.WAR_RATE FROM WAR_RATE_MASTER A WHERE A.MODE_TRANSPORT_ID =? AND A.BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM WAR_RATE_MASTER WHERE MODE_TRANSPORT_ID=A.MODE_TRANSPORT_ID  AND BRANCH_CODE=A.BRANCH_CODE) AND STATUS='Y'
GET_CONVEY_WARRATE_OC=SELECT SUBSTR(OCCMSS.WAR_RATE||'#',INSTR(OCCMSS.WAR_RATE||'#','~',INSTR(OCCMSS.WAR_RATE,?))+1,INSTR(OCCMSS.WAR_RATE||'#','#',INSTR(OCCMSS.WAR_RATE,?))-INSTR(OCCMSS.WAR_RATE||'#','~',INSTR(OCCMSS.WAR_RATE||'#',?))-1) FROM OPEN_COVER_COUNTRY_MASTER OCCMSS,OPEN_COVER_POSITION_MASTER OCPMSS WHERE OCPMSS.OPEN_COVER_NO=? AND OCPMSS.PROPOSAL_NO=OCCMSS.PROPOSAL_NO AND OCCMSS.AMEND_ID IN (SELECT MAX(OCCMS.AMEND_ID) FROM OPEN_COVER_COUNTRY_MASTER OCCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO=OCPMSS.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCCMS.PROPOSAL_NO AND TO_DATE(OCCMS.EFFECTIVE_DATE,'dd-MM-YYYY') <= TO_DATE(SYSDATE,'dd-MM-YYYY'))

#POLICY GENERATION
GET_CERT_NO=CALL GET_CERTIFNO(?,?,?)
GET_POLICY_GENERATE = SELECT Policy_Generate (?,?,?) FROM DUAL
GET_POL_NO=SELECT ?||'-' FROM BRANCH_MASTER A, CONSTANT_DETAIL B, CONSTANT_DETAIL C  WHERE A.BRANCH_CODE=? AND B.BRANCH_CODE=A.BRANCH_CODE AND C.BRANCH_CODE=A.BRANCH_CODE AND B.CATEGORY_ID=124 AND B.CATEGORY_DETAIL_ID=1 AND C.CATEGORY_ID=125 AND C.CATEGORY_DETAIL_ID=1
GET_PROD_PREFIX=SELECT RSACODE FROM PRODUCT_MASTER WHERE PRODUCT_ID=? AND BRANCH_CODE=?
GET_OC_NOTE_CNT=SELECT COUNT(1) FROM OPEN_COVER_MASTER A, OPEN_COVER_POSITION_MASTER B WHERE A.PROPOSAL_NO=B.PROPOSAL_NO AND B.OPEN_COVER_NO=? AND A.DEPOSIT_PREMIUM_YN='Y'
GET_OC_CKEY=SELECT CKEY FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO=?
GET_EXECUTIVE_ID=SELECT AC_EXECUTIVE_ID FROM MARINE_DATA MD WHERE APPLICATION_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO=MD.APPLICATION_NO)
GET_COREEXECUTIVE_ID = SELECT RSACODE FROM LOGIN_EXECUTIVE_DETAILS WHERE AC_EXECUTIVE_ID=?
GET_COMMISSION_PERCENT=SELECT NVL (COMMISSION, 0) FROM LOGIN_USER_DETAILS lud WHERE LUD.AGENCY_CODE = (SELECT   DECODE (USERTYPE, 'RSAIssuer', agency_code, oa_code) FROM LOGIN_MASTER WHERE LOGIN_ID = ?) AND PRODUCT_ID=? AND amend_id = (SELECT MAX (amend_id) FROM LOGIN_USER_DETAILS LUD1 WHERE LUD1.AGENCY_CODE = (SELECT   DECODE (USERTYPE, 'RSAIssuer', agency_code, oa_code) FROM LOGIN_MASTER WHERE LOGIN_ID = ?) AND LUD.PRODUCT_ID=LUD1.PRODUCT_ID)
GET_OC_COMMISSION_PERCENT=SELECT NVL(OCM.COMMISSION,0) FROM OPEN_COVER_MASTER OCM,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO\=? AND OCPM.PROPOSAL_NO\=OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX(OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO \=OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO\=OCMS.PROPOSAL_NO AND TO_DATE(OCMS.EFFECTIVE_DATE,'dd-MM-YYYY') <\= TO_DATE(SYSDATE,'dd-MM-YYYY'))
GET_COMMISSION_PERCENT_ISSUER_ONEOFF=SELECT ISSUER_COMMISSION_ONEOFF FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(select oa_code from login_master where login_id=?)
GET_COMMISSION_PERCENT_ISSUER_OPENCOVER=SELECT ISSUER_COMMISSION_OPENCOVER FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(select oa_code from login_master where login_id=?)
UPD_POLICY_INFO=UPDATE POSITION_MASTER SET POLICY_TERM='1 year',POLICY_NO=?,PDF_PRE_SHOW_STATUS=?,PDF_BANKER_STATUS=?,PDF_GENERATE_STATUS=?,PDF_BANKER_ASSURED_STATUS=?,PDF_CURRENCY_STATUS=?,OPEN_COVER_NO=?,NOTE_TYPE=?,PAYMENT_MODE=?,BASIS_VAL=?,DEBIT_CUST_ID=?,CERT_CLAUSES_YN=?,COMMISSION=?,TAX=?,ENDT_PREM_YN=?,ENDT_CLAUSES_YN=?,PDF_EXCESS_STATUS=?,PDF_STAMP_STATUS=?,DISCOUNT_PREMIUM=? WHERE  QUOTE_NO=? AND AMEND_ID=?
UPD_INCEPTION_DATE=UPDATE POSITION_MASTER SET INCEPTION_DATE=TO_DATE(?, 'DD-MM-YYYY HH24:MI:SS'),EXPIRY_DATE=TO_DATE(?, 'DD-MM-YYYY HH24:MI:SS') WHERE QUOTE_NO=?
UPD_WEBSERVICE_MARINE_QUOTE_POLICY_INFO=update webservice_marine_quote set POLICY_NO=?, status=? where QUOTE_NO=?
GET_EXECUTIVE_PERCENT = SELECT COMMISSION FROM LOGIN_EXECUTIVE_DETAILS LED WHERE AC_EXECUTIVE_ID=? AND TRUNC(EFFECTIVE_DATE) <= TRUNC(SYSDATE) AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM LOGIN_EXECUTIVE_DETAILS LED1 WHERE LED1.AC_EXECUTIVE_ID=LED.AC_EXECUTIVE_ID AND TRUNC(LED1.EFFECTIVE_DATE)=TRUNC(LED.EFFECTIVE_DATE))
GET_OPENCOVER_EXECUTIVE_PERCENT = SELECT COMMISSION FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?))
GET_ENDT_COMMISSION_PERCENT = Select nvl(discount_premium,0) from position_master pm Where policy_no\=(Select original_policy_no from position_master Where application_no\=?) 
GET_YEAR_POLICYNO=SELECT DATEPART(yy,getDate()) AS Year
GET_SUBBRANCH=select nullif(SUB_BRANCH,'') from login_master where loginId=?
UPD_POLICY_STS=UPDATE POSITION_MASTER SET DEBIT_NOTE_DATE = TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS'), MISSIPPI_TRANFER_DATE=TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS') ,INCEPTION_DATE=TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS'), CREDIT_NOTE_DATE=TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS'), EXPIRY_DATE=TO_DATE(?, 'DD/MM/YYYY HH24:MI:SS'),DEBIT_NOTE_NO=?, CREDIT_NOTE_NO=?, DEBIT_TO=?, CREDIT_TO=?, DEBIT_TO_ID=?, CREDIT_TO_ID=?, STATUS='P' WHERE QUOTE_NO=? AND AMEND_ID=?
GET_QUOTE_STATUS=SELECT STATUS,POLICY_NO,REMARKS,PREMIUM FROM POSITION_MASTER A WHERE QUOTE_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO\=A.QUOTE_NO)
CNT_POLICY_NO=SELECT COUNT(*) FROM POSITION_MASTER WHERE POLICY_NO\=? AND QUOTE_NO \!\=?
GET_LC_INFO=SELECT MD.OPEN_LC_ID,MD.OPEN_BANK_ID,POS.OPEN_COVER_NO FROM MARINE_DATA MD, POSITION_MASTER POS WHERE MD.APPLICATION_NO\=POS.APPLICATION_NO AND POS.QUOTE_NO\=?
GET_TOTAL_USED_SI=SELECT SUM(MRD.SUMINSUREDLOCAL+MD.TOTAL_SALE_TERM_CHARGES+MD.TOTAL_TOLERANCE_CHARGES) FROM MARINE_DATA MD,MARINE_RESULT_DETAILS MRD,POSITION_MASTER PM WHERE MD.APPLICATION_NO\=PM.APPLICATION_NO AND MD.APPLICATION_NO\=MRD.APPLICATION_NO AND MD.OPEN_COVER_NO\=PM.OPEN_COVER_NO AND PM.STATUS\='P' AND MD.STATUS\='Y' AND MD.OPEN_LC_ID\=? AND MD.OPEN_BANK_ID\=? AND MD.OPEN_COVER_NO\=? AND PM.QUOTE_NO\=?
GET_LC_BAL_AMT=SELECT LC_BALANCE_AMOUNT FROM OPEN_COVER_LC_MASTER WHERE LC_ID\=? AND BANK_ID\=? AND OPEN_COVER_NO\=?
UPD_LC_INFO=UPDATE OPEN_COVER_LC_MASTER SET LC_BALANCE_AMOUNT=? WHERE LC_ID=? AND BANK_ID=? AND OPEN_COVER_NO=?
GET_SYSDATE=SELECT CASE WHEN TRUNC(SYSDATE) BETWEEN TRUNC(TRN.CLO_DATE_OPENED) AND TRUNC(TRN.CLO_DATE_CLOSED) THEN TO_CHAR(SYSTIMESTAMP,'DD-MM-YYYY hh24\:mi\:ss') ELSE TO_CHAR(TRN.CLO_DATE_OPENED, 'DD-MM-YYYY hh24\:mi\:ss') END X FROM T_TRN_CLOSING TRN, PRODUCT_MASTER PM, POSITION_MASTER HPM WHERE PM.BRANCH_CODE \= TRN.BRANCH_CODE AND TRN.BRANCH_CODE \=? AND PM.PRODUCT_ID \= HPM.PRODUCT_ID AND TRN.PRODUCT_CORE_CODE \='1' AND HPM.QUOTE_NO \= ? AND HPM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO\=HPM.QUOTE_NO)
CNT_QUOTE=SELECT COUNT(*) FROM MARINE_DATA MD, MARINE_RESULT_DETAILS MRD, MARINE_RESULT MR, MARINE_POLICY_DETAILS MPD, POSITION_MASTER PM WHERE MD.APPLICATION_NO = PM.APPLICATION_NO AND NVL(MD.OPEN_COVER_NO,0) = NVL(PM.MISSIPPI_OPENCOVER_NO,0) AND MRD.APPLICATION_NO = PM.APPLICATION_NO AND NVL(MRD.OPEN_COVER_NO,0) = NVL(PM.MISSIPPI_OPENCOVER_NO,0) AND MR.APPLICATION_NO = PM.APPLICATION_NO AND MR.QUOTE_NO = PM.QUOTE_NO AND MR.CUSTOMER_ID = PM.CUSTOMER_ID AND MPD.QUOTE_NO = PM.QUOTE_NO AND MPD.CUSTOMER_ID = PM.CUSTOMER_ID AND PM.QUOTE_NO = ?
GET_COMMISSION=SELECT POS.QUOTE_NO,(((NVL(POS.PREMIUM,'0')-ROUND((NVL(MD.POLICY_FEE,'0')+NVL(MD.GOVT_TAX,'0')+NVL(MD.EMERGENCY_FUND,'0')),0))+NVL(POS.EXCESS_PREMIUM,'0'))*?/100) COMMISSION,(((NVL(POS.PREMIUM,'0')-ROUND((NVL(MD.POLICY_FEE,'0')+NVL(MD.GOVT_TAX,'0')+NVL(MD.EMERGENCY_FUND,'0')),0))+NVL(POS.EXCESS_PREMIUM,'0'))*?/100)TAX FROM POSITION_MASTER POS,MARINE_DATA MD WHERE POS.APPLICATION_NO=? AND MD.APPLICATION_NO=POS.APPLICATION_NO AND POS.AMEND_ID=(SELECT MAX(AMEND_ID)FROM POSITION_MASTER WHERE APPLICATION_NO=POS.APPLICATION_NO) AND MD.AMEND_ID=POS.AMEND_ID ORDER BY POS.QUOTE_NO
CAL_PROC_INTEG=CALL INTEGRATION_TYPE(?)
GET_NOTE_TYPE=SELECT NOTE_TYPE FROM POSITION_MASTER WHERE APPLICATION_NO=?
GET_PAYMENT_MODE=SELECT NVL(PAYMENT_MODE,'CA') FROM POSITION_MASTER WHERE APPLICATION_NO=?

GET_BRANCH_INFO=SELECT CURRENCY_ABBREVIATION CURR_NAME,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,DECIMAL_PLACES,NVL(TAX,'0') TAX,EMAIL FROM BRANCH_MASTER WHERE BRANCH_CODE\=?
GET_POLICY_INFO=SELECT BROKER_CODE, REFERENCE_NUMBER, TYPE, NVL(OPENCOVER_POLICY_NUMBER, 0), CUSTOMER_ID, CUSTOMER_NAME, ADDRESS1, ADDRESS2, PO_BOX, COUNTRY, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_PERCENT, CURRENCY, SETTLING_AGENT,TOTAL_SUM_INSURED, TO_CHAR(POLICY_START_DATE,'dd/MM/yyyy'), TO_CHAR(SAILING_DATE,'dd/MM/yyyy'), VESSEL_NAME, LC_NUMBER, ISSUING_BANK, TO_CHAR(LC_DATE,'dd/MM/yyyy'), PARTIAL_SHIPMENT, BL_AWB_NUMBER, TO_CHAR(BL_AWB_DATE,'dd/MM/yyyy'), QUOTE_NO, PREMIUM, POLICY_NO, REMARKS, STATUS, ENDORSEMENT, CLAUSES, WARRANTIES, EXCLUSION, TO_CHAR(RECEIVED_DATE,'dd/mm/yyyy'), RESPONSE_TIME, POLICY_FILE_PATH, APPLICATION_NO, COVERAGES, SEA_COVERAGES, WSRCC, PRODUCT_ID, TOLERANCE,PDF_PRE_SHOW_STATUS,PDF_BANKER_STATUS,PDF_GENERATE_STATUS,PDF_BANKER_ASSURED_STATUS,PDF_CURRENCY_STATUS, EMAIL, CLIENT_CUSTOMER_ID,ORIGIN_CITY_NAME,DEST_CITY_NAME,NOTE_TYPE, PAYMENT_MODE, BASIS_VAL, PACKAGE_TYPE, PDF_STAMP_STATUS,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, ISSUER, LOGIN_ID,CUST_TITLE,CUST_CORE_APP_CODE,SETTLING_AGENT_NAME,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,AC_EXECUTIVE_ID,ADMIN_REFERRAL_YN,ADMIN_REFERRAL_REMARKS,VESSEL_ID,CUST_AR_NO,CERT_CLAUSES_YN,NVL(ADDITIONAL_PREMIUM,0),DEBIT_CUST_ID,ENDT_PREM_YN,ENDT_CLAUSES_YN,PDF_EXCESS_STATUS,PROMOTIONAL_CODE,PROMOTIONAL_DISCOUNT, BRANCH_CODE,CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME, core_customer_name,CHANNEL_TYPE,EXCHANGE_RATE,ISSUER,VIA FROM WEBSERVICE_MARINE_QUOTE WHERE REFERENCE_NUMBER=?
GET_BROKER_INFO=SELECT A.LOGIN_ID,B.BRANCH_CODE,A.COMPANY_ID FROM LOGIN_MASTER A, BROKER_COMPANY_MASTER B WHERE A.AGENCY_CODE=? AND B.AGENCY_CODE=A.AGENCY_CODE
GET_COMM_INFO=SELECT A.COMMODITY_ID, B.COMMODITY_DESCRIPTION, B.SUMINSURED, A.COMMODITY_TYPE_ID, A.COMMODITY_EXCESS_PREMIUM, B.FRAGILE,B.SUPPLIER_NAME,B.PACKAGE_DESCRIPTION,B.INVOICE_NUMBER,A.COMMODITY_RATE,B.WSRCC_RATE,B.ENDORSEMENT FROM COMMODITYMASTER A, WEBSERVICE_MARINE_COMMODITY B WHERE B.REFERENCE_NUMBER=? AND A.COMMODITY_ID=B.COMMODITY_CODE AND A.BRANCH_CODE=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID=A.COMMODITY_ID AND BRANCH_CODE=A.BRANCH_CODE) ORDER BY COMMODITY_ID
GET_LOGIN_ID=SELECT LOGIN_ID FROM POSITION_MASTER A WHERE APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO=A.APPLICATION_NO)
GET_AMEND_ID=SELECT NVL(MAX(AMEND_ID),0) FROM POSITION_MASTER WHERE APPLICATION_NO=?
GET_POL_COM=SELECT DISCOUNT_PREMIUM FROM POSITION_MASTER A WHERE APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO=A.APPLICATION_NO)
GET_BANK_NAME=SELECT BANK_NAME FROM OPEN_COVER_BANK_MASTER WHERE BANK_ID=?
GET_PORTFOLIO_SEARCH_ISSUER=SELECT A.POLICY_NO, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0)) PREMIUM, TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= A.LOGIN_ID)) BROKER_NAME, TO_CHAR(MD.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, (SELECT OCM.CUSTOMER_ID FROM OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO \= A.OPEN_COVER_NO AND OCPM.PROPOSAL_NO \= OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO \= OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO \= OCMS.PROPOSAL_NO AND TO_DATE (OCMS.EFFECTIVE_DATE, 'dd-MM-YYYY') <\= TO_DATE (SYSDATE, 'dd-MM-YYYY'))) OC_CUST_ID FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT AGENCY_CODE FROM BROKER_COMPANY_MASTER WHERE BRANCH_CODE \= ?)) AND A.STATUS \= 'P' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.OPEN_COVER_NO \= NVL(?,'0') AND A.POLICY_NO LIKE UPPER (?) AND ORIGINAL_POLICY_NO IS NULL AND MD.APPLICATION_NO \= A.APPLICATION_NO 
GET_PORTFOLIO_ISSUER=SELECT A.POLICY_NO, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0)) PREMIUM, TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= A.LOGIN_ID)) BROKER_NAME, TO_CHAR(MD.INCEPTION_DATE,'DD/MM/YYYY') POLICY_START_DATE, (SELECT OCM.CUSTOMER_ID FROM OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO \= A.OPEN_COVER_NO AND OCPM.PROPOSAL_NO \= OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO \= OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO \= OCMS.PROPOSAL_NO AND TO_DATE (OCMS.EFFECTIVE_DATE, 'dd-MM-YYYY') <\= TO_DATE (SYSDATE, 'dd-MM-YYYY'))) OC_CUST_ID FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT AGENCY_CODE FROM BROKER_COMPANY_MASTER WHERE BRANCH_CODE \= ?)) AND A.STATUS \= 'P' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.POLICY_NO LIKE UPPER (?) AND ORIGINAL_POLICY_NO IS NULL AND MD.APPLICATION_NO \= A.APPLICATION_NO
GET_PORTFOLIO_OC=SELECT A.POLICY_NO, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0)) PREMIUM, TO_CHAR (A.INCEPTION_DATE, ''DD/MM/YYYY'') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, ''0''), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE {0} A.STATUS \= ''P'' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ? AND decode(?,''1'',''1'',a.application_id) \= NVL(?,''1'')   AND A.OPEN_COVER_NO LIKE ? AND ORIGINAL_POLICY_NO IS NULL
GET_OC_CUST_ID=SELECT OCM.CUSTOMER_ID FROM OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO = ? AND OCPM.PROPOSAL_NO = OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO = OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO = OCMS.PROPOSAL_NO AND TO_DATE (OCMS.EFFECTIVE_DATE, 'dd-MM-YYYY') <= TO_DATE (SYSDATE, 'dd-MM-YYYY'))
CNT_OC_DEPOSIT=SELECT COUNT(1) FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO=? AND A.DEPOSIT_PREMIUM_YN='Y'
GET_ENDT_INFO=SELECT A.APPLICATION_NO, A.QUOTE_NO, (CASE WHEN A.STATUS = 'R' THEN 'RR' WHEN ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS = 'N') OR (A.REMARKS IN ('Admin','Normal','Referal','NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS = 'Y') AND A.STATUS = 'E')  THEN 'RU'  WHEN (    A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS = 'N' AND A.STATUS = 'E') THEN 'RA' ELSE 'N' END) REF_STATUS,A.STATUS,A.ENDT_STATUS FROM   POSITION_MASTER A, MARINE_DATA MD WHERE MD.APPLICATION_NO = A.APPLICATION_NO AND A.LOGIN_ID = ? AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID = ? AND A.ORIGINAL_POLICY_NO = ? AND A.QUOTE_NO=(select max(QUOTE_NO) from POSITION_MASTER where  LOGIN_ID=a.LOGIN_ID AND NVL (OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') and PRODUCT_ID=A.PRODUCT_ID and ORIGINAL_POLICY_NO=A.ORIGINAL_POLICY_NO)
GET_PORTFOLIO_CANCELLED_OC=SELECT A.APPLICATION_NO, A.POLICY_NO, A.ENDT_STATUS, A.ENDT_TYPE, A.STATUS, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0))PREMIUM, TO_CHAR (A.INCEPTION_DATE, ''DD/MM/YYYY'') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, ''0''), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE {0} A.STATUS in (''{1}'') AND B.CUSTOMER_ID \= A.CUSTOMER_ID and b.amend_id\=(select max(amend_id) from PERSONAL_INFO p where p.CUSTOMER_ID\=b.CUSTOMER_ID) AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ? AND decode(?,''1'',''1'',a.application_id) \= NVL(?,''1'')   AND A.OPEN_COVER_NO LIKE ? AND ORIGINAL_POLICY_NO IS NOT NULL AND A.ENDT_TYPE\=''41''
GET_PORTFOLIO_CANCELLED=SELECT A.APPLICATION_NO, A.POLICY_NO, A.ENDT_STATUS, A.ENDT_TYPE, A.STATUS, A.CUSTOMER_ID, (NVL(A.PREMIUM,0)+NVL(A.EXCESS_PREMIUM,0))PREMIUM, TO_CHAR (A.INCEPTION_DATE, ''DD/MM/YYYY'') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, ''0''), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B,MARINE_DATA MD WHERE MD.APPLICATION_NO\=A.APPLICATION_NO AND {0} A.STATUS \= ''{1}'' AND B.CUSTOMER_ID \= A.CUSTOMER_ID and b.amend_id\=(select max(amend_id) from PERSONAL_INFO p where p.CUSTOMER_ID\=b.CUSTOMER_ID) AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ? AND decode(?,''1'',''1'',a.application_id) \= NVL(?,''1'')  AND NVL(A.OPEN_COVER_NO,''0'') \= NVL(?,''0'') AND ORIGINAL_POLICY_NO IS NOT NULL AND A.ENDT_TYPE\=''41''

UPD_WS_QUOTE_APPNO=UPDATE WEBSERVICE_MARINE_QUOTE SET APPLICATION_NO=? WHERE REFERENCE_NUMBER=?
UPD_WS_COMM_APPNO=UPDATE WEBSERVICE_MARINE_COMMODITY SET APPLICATION_NO=? WHERE REFERENCE_NUMBER=?
UPD_WS_QUOTE_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET APPLICATION_NO=?, QUOTE_NO=?, PREMIUM=(SELECT PREMIUM FROM POSITION_MASTER A WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=A.QUOTE_NO)), REMARKS=?, CUSTOMER_ID=?, STATUS=?, QUOTATION_DATE=(SELECT ENTRY_DATE FROM POSITION_MASTER A WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=A.QUOTE_NO)),ADDITIONAL_PREMIUM=(SELECT EXCESS_PREMIUM FROM POSITION_MASTER A WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=A.QUOTE_NO)) WHERE REFERENCE_NUMBER=?
UPD_WS_POLICY_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET POLICY_NO=?, POLICY_FILE_PATH=?, STATUS=? WHERE REFERENCE_NUMBER=?
UPD_WS_PRE_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET PREMIUM=?,ADDITIONAL_PREMIUM=?,WAR_PREMIUM=?,ISSUANCE_FEE=?,INSPECTION_FEE=? WHERE APPLICATION_NO=?
UPD_WS_DRAFT_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET DRAFT_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_WS_QUOTE_SCH_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET QUOTE_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_WS_DEBIT_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET DEBIT_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_WS_CREDIT_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET CREDIT_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_ADMIN_REF_INFO=UPDATE MARINE_DATA SET ADMIN_REFERRAL_STATUS=?, REMARKS=? WHERE APPLICATION_NO=?
UPD_POL_REMARKS=UPDATE POSITION_MASTER SET REMARKS='Normal' WHERE APPLICATION_NO=?
UPD_POLICY_DOC_INFO=UPDATE POSITION_MASTER SET PDF_PRE_SHOW_STATUS=?, PDF_BANKER_STATUS=?, PDF_GENERATE_STATUS=?, PDF_BANKER_ASSURED_STATUS=?, PDF_CURRENCY_STATUS=?,PDF_STAMP_STATUS=?,CERT_CLAUSES_YN=?,ENDT_PREM_YN=?,ENDT_CLAUSES_YN=?,PDF_EXCESS_STATUS=?,BASIS_VAL=? WHERE APPLICATION_NO=?
UPD_PM_APPR_STS=UPDATE POSITION_MASTER SET ADMIN_REFERRAL_REMARKS=?,DISCOUNT_PREMIUM=?,REMARKS='Admin',APPROVED_BY=(SELECT NVL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?) WHERE APPLICATION_NO=?
UPD_MD_APPR_STS=UPDATE POSITION_MASTER SET ADMIN_REFERRAL_REMARKS=?,DISCOUNT_PREMIUM=?,REMARKS='Admin',APPROVED_BY=(SELECT NVL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?) WHERE APPLICATION_NO=?
UPD_MRD_COMM_INFO=UPDATE MARINE_RESULT_DETAILS SET SUPPLIER_NAME=?,PACKAGE_DESCRIPTION=?,INVOICE_NUMBER=? WHERE APPLICATION_NO=? AND COMMODITY_ID=?
UPD_WS_ADMIN_REFERRAL=UPDATE WEBSERVICE_MARINE_QUOTE SET ADMIN_REFERRAL_YN=?, ADMIN_REFERRAL_REMARKS=? WHERE APPLICATION_NO=?
UPD_PM_ADMIN_APPR=UPDATE POSITION_MASTER SET STATUS=?, ADMIN_REFERRAL_REMARKS=?,DISCOUNT_PREMIUM=?,REMARKS='Admin',APPROVED_BY=(SELECT NVL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?) WHERE APPLICATION_NO=?
UPD_PM_ADMIN_REM=UPDATE POSITION_MASTER SET STATUS=?, REMARKS=? WHERE APPLICATION_NO=?
UPD_PM_ADMIN_REJ=UPDATE POSITION_MASTER SET ADMIN_REMARKS=?,STATUS='R',ENTRY_DATE=(SELECT SYSDATE FROM DUAL),APPROVED_BY=? WHERE APPLICATION_NO=?
UPD_MD_ADMIN_STS=UPDATE MARINE_DATA SET ADMIN_REFERRAL_STATUS=? WHERE APPLICATION_NO=?
CNT_QUOTE_REFERRAL=SELECT COUNT(1) FROM MARINE_DATA WHERE APPLICATION_NO=? AND REMARKS LIKE '%Referal'
CAL_PROC_UPD_COMM_RATE=CALL UPDATE_COMMODITY_RATE(?,?)
CAL_PROC_UPD_PREMIUM=CALL UPDATE_PREMIUM(?)
GET_DEPOSITPREMIUM_STATUS = Select Count(*) From Open_Cover_Master A, Open_Cover_Position_Master B  Where A.Proposal_No = B.Proposal_No And B.Open_Cover_No = ? And B.Status='P' And A.Deposit_Premium_Yn='Y' AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER A1 WHERE A1.Proposal_No=A.Proposal_No)

#ENDORSEMENT
GET_ENDT_TYPE=SELECT ENDT_TYPE_ID, ENDT_TYPE, ENDT_TYPE_DESC, ENDT_TYPE_CATEGORY_ID, ENDT_TYPE_CATEGORY FROM ENDT_TYPE_MASTER WHERE STATUS='Y' AND PRODUCT_ID=? ORDER BY ENDT_TYPE_ID,ENDT_TYPE_CATEGORY_ID
GET_END_LIST=SELECT A.POLICY_NO, A.CUSTOMER_ID, A.PREMIUM, TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, NVL (A.OPEN_COVER_NO, '0'), DEBIT_NOTE_NO, CREDIT_NOTE_NO,ENDT_TYPE,(CASE WHEN A.STATUS\='R' THEN 'Referal Reject' WHEN ((A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (A.REMARKS IN ('Admin', 'Normal' , 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y') AND A.STATUS \= 'E') THEN 'ReferalUnapproved' WHEN (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'N' AND A.STATUS \= 'E') THEN 'ReferalApproved' WHEN A.STATUS \= 'P' THEN 'Policy Converted'  WHEN A.STATUS \= 'E' THEN 'ExistingQuote' WHEN A.STATUS \= 'C' THEN 'Cancelled Policy' ELSE 'N' END) REF_STATUS,A.STATUS,A.APPLICATION_NO,A.ENDT_STATUS,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME,DECODE(A.OPEN_COVER_NO,'0','',A.OPEN_COVER_NO) FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE MD.APPLICATION_NO\=A.APPLICATION_NO AND A.LOGIN_ID\=? AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.ORIGINAL_POLICY_NO \= ? 
GET_POL_ENDT=SELECT ENDT_TYPE FROM POSITION_MASTER WHERE APPLICATION_NO\=?
GET_ENDT_LIST_ISSUER=SELECT DISTINCT A.POLICY_NO ,A.QUOTE_NO, A.CUSTOMER_ID ,A.PREMIUM, TO_CHAR (A.INCEPTION_DATE,'DD/MM/YYYY') QUOTATION_DATE ,NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME ,B.LAST_NAME ,A.LOGIN_ID ,A.QUOTE_NO ,A.EXCESS_PREMIUM ,B.COMPANY_NAME ,A.INCEPTION_DATE ,NVL (A.OPEN_COVER_NO, '0') ,A.DEBIT_NOTE_NO ,A.CREDIT_NOTE_NO ,A.AMEND_ID ,( SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A ,PERSONAL_INFO B WHERE A.LOGIN_ID= ? AND A.STATUS IN  ('P','E') and A.status = 'P' and A.product_id = a.product_id AND B.CUSTOMER_ID = A.CUSTOMER_ID AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID =? AND A.APPLICATION_ID = NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') LIKE ?||'%' AND A.POLICY_NO = CASE WHEN A.PRODUCT_ID = 3 THEN REGEXP_SUBSTR(A.POLICY_NO,'[^-]+',1,1) ELSE SUBSTR(A.POLICY_NO,1,DECODE(INSTR(A.POLICY_NO,'-',1,3)-1,-1,LENGTH( A.POLICY_NO),INSTR(A.POLICY_NO,'-',1,3)-1)) END AND A.ORIGINAL_POLICY_NO IS NULL
GET_ENDT_PRE_INFO= SELECT * FROM (SELECT ORIGINAL_POLICY_NO,QUOTE_NO,Round(PREMIUM + NVL (EXCESS_PREMIUM, 0) + NVL (GOVT_TAX, 0)) PREMIUM,Round(LAG (PREMIUM + NVL (EXCESS_PREMIUM, 0) + NVL (GOVT_TAX, 0),1,0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO)) AS PREMIUM_PREV,Round((  PREMIUM + NVL (EXCESS_PREMIUM, 0) + NVL (GOVT_TAX, 0))) - Round((LAG (PREMIUM + NVL (EXCESS_PREMIUM, 0)+ NVL (GOVT_TAX, 0),  1,0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO))) PREMIUM_DIFF,MARINE_PREMIUM MARINE_PREMIUM,LAG (MARINE_PREMIUM, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) AS MARINE_PREMIUM_PREV,(MARINE_PREMIUM) - LAG (MARINE_PREMIUM, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) MARINE_PREMIUM_DIFF,TOTAL_WAR_CHARGES WAR_PREMIUM,LAG (TOTAL_WAR_CHARGES, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) AS WAR_PREMIUM_PREV,TOTAL_WAR_CHARGES - LAG (TOTAL_WAR_CHARGES, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) WAR_PREMIUM_DIFF,EXCESS_PREMIUM, LAG (EXCESS_PREMIUM, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) AS EXCESS_PREMIUM_PREV,EXCESS_PREMIUM - LAG (EXCESS_PREMIUM, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) EXCESS_PREMIUM_DIFF, POLICY_FEE,LAG (POLICY_FEE, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) AS POLICY_FEE_PREV,POLICY_FEE - LAG (POLICY_FEE, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) POLICY_FEE_DIFF,GOVT_TAX,LAG (GOVT_TAX, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) AS GOVT_TAX_PREV,GOVT_TAX - LAG (GOVT_TAX, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) GOVT_TAX_DIFF FROM MARINE_DATA_ENDT) WHERE QUOTE_NO = ?
GET_COMM_RATE_INFO=SELECT MRD.COMMODITY_ID, MRD.RATE, MRD.WARRATE, MRD.WAREHOUSE_WAREHOUSE, '0', MRD.COMMODITY_EXCESS_PREMIUM,NVL (MRD.POLICY_EXCESS_PERCENT, 0) POLICY_EXCESS_PERCENT FROM MARINE_RESULT_DETAILS MRD WHERE MRD.APPLICATION_NO=(SELECT APPLICATION_NO FROM POSITION_MASTER WHERE PDF_MODIFY_CLAUSE IS NOT NULL AND UPPER(PDF_MODIFY_CLAUSE) != 'NOTHING' AND APPLICATION_NO=?)
GET_ENDT_SI_DIFF_REF=SELECT ? - ( MD2.EQUIVALENT_USD + NVL (MD2.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD2.TOTAL_TOLERANCE_CHARGES, 0)) SUMINSURED_DIFF FROM POSITION_MASTER PM1, POSITION_MASTER PM2, MARINE_DATA MD2 WHERE PM1.QUOTE_NO = ? AND PM1.ORIGINAL_POLICY_NO = NVL (PM2.ORIGINAL_POLICY_NO, PM2.POLICY_NO) AND PM1.AMEND_ID = PM2.AMEND_ID + 1 AND MD2.APPLICATION_NO = PM2.APPLICATION_NO AND PM2.AMEND_ID = MD2.AMEND_ID
GET_ENDT_SI_DIFF=SELECT ( MD1.EQUIVALENT_USD + NVL (MD1.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD1.TOTAL_TOLERANCE_CHARGES, 0)) - ( MD2.EQUIVALENT_USD + NVL (MD2.TOTAL_SALE_TERM_CHARGES, 0) + NVL (MD2.TOTAL_TOLERANCE_CHARGES, 0)) SUMINSURED_DIFF FROM POSITION_MASTER PM1, MARINE_DATA MD1, POSITION_MASTER PM2, MARINE_DATA MD2 WHERE PM1.QUOTE_NO = ? AND PM1.ORIGINAL_POLICY_NO = NVL (PM2.ORIGINAL_POLICY_NO, PM2.POLICY_NO) AND PM1.AMEND_ID = PM2.AMEND_ID + 1 AND MD1.APPLICATION_NO = PM1.APPLICATION_NO AND PM1.AMEND_ID = MD1.AMEND_ID AND MD2.APPLICATION_NO = PM2.APPLICATION_NO AND PM2.AMEND_ID = MD2.AMEND_ID
GET_QUOTE_ENDT_TYPE=SELECT RTRIM(XMLAGG(XMLELEMENT(E,ENDT_TYPE || ', ')).EXTRACT('//text()'),', ') ENDT_TYPE FROM ENDT_TYPE_MASTER WHERE ENDT_TYPE_ID IN (?)
GET_POL_ENDT_LIST=SELECT ENDT_TYPE FROM ENDT_TYPE_MASTER WHERE ENDT_TYPE_ID IN (?)
GET_ORIGINAL_POLNO=SELECT NVL(ORIGINAL_POLICY_NO, OPEN_COVER_NO) FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO=?
GET_ENDT_POL_INFO=SELECT A.POLICY_NO, TO_CHAR (A.INCEPTION_DATE, 'DD/MM/YYYY') QUOTATION_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE = (SELECT OA_CODE  FROM LOGIN_MASTER  WHERE LOGIN_ID = A.LOGIN_ID)) BROKER_NAME, DECODE (A.OPEN_COVER_NO, '0', '', A.OPEN_COVER_NO) OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE MD.APPLICATION_NO = A.APPLICATION_NO AND A.QUOTE_NO = ? AND B.CUSTOMER_ID = A.CUSTOMER_ID
GET_ENDT_POL=SELECT PM.CUSTOMER_ID,UPPER(PI.TITLE||' '||PI.FIRST_NAME) CUST_FIRST_NAME,PI.POBOX CUST_POBOX,UPPER(PI.COMPANY_NAME) CUST_COMPANY,UPPER(PI.LAST_NAME) CUST_LAST_NAME, UPPER(PI.ADDRESS1) CUST_ADDR1,UPPER(PI.ADDRESS2) CUST_ADDR2,PI.TELEPHONE CUST_TEL,UPPER(PI.COUNTRY) CUST_COUNTRY,UPPER(NVL(PI.CITY,PI.EMIRATE)) CUST_CITY, BM.BRANCH_CODE, BM.BRANCH_NAME, NVL (BM.ORIGINATION_COUNTRY_ID, 0) ORIGINATION_COUNTRY_ID, BM.CURRENCY_ABBREVIATION, NVL (BM.DECIMAL_PLACES, 0) DECIMAL_PLACES, BM.HEADER_IMG, BM.FOOTER_IMG, BM.SIGN_IMG, BM.STAMP, BM.CURRENCY_NAME, NVL (BM.CURRENCY_ACRONYM, ' ') CURRENCY_ACRONYM, BM.CURRENCY_DECIMAL_NAME, BM.CURRENCY_DECIMAL_DIGIT, BM.ADDRESS1, BM.REMARKS, CR.COVER_NAME, (CASE WHEN PM.PRODUCT_ID = '11' AND PM.PDF_BANKER_ASSURED_STATUS = 'YES' THEN FN_GET_CODE ('BNAME', MD.OPEN_BANK_ID, NULL, NULL) WHEN PM.PRODUCT_ID = '3' AND PM.PDF_BANKER_ASSURED_STATUS = 'YES' THEN MPD.BANK_NAME ELSE NULL END) ASSURED, PM.ORIGINAL_POLICY_NO, PI.FIRST_NAME CUST_NAME, PM.AMEND_ID ENDT_NO, TO_CHAR (PM.INCEPTION_DATE, 'dd-mm-yyyy') POLICY_DATE, EMD.PREV_SUMINSURED, EMD.SUMINSURED, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE = 'YES' THEN to_char(MD.TRANSIT_FROM) || ',' || FN_GET_CODE ('CNAME', to_char(MD.TRANSIT_FROM_COUNTRY_ID), NULL, NULL) ELSE FN_GET_CODE ('CNAME', to_char(MD.TRANSIT_FROM_COUNTRY_ID), NULL, NULL) END) || ' To ' || (CASE WHEN MD.WARE_TO_WARE_FINAL_DEST = 'YES' THEN to_char(MD.FINAL_DESTINATION) || ',' || FN_GET_CODE ('CNAME', to_char(MD.FINAL_DESTINATION_COUNTRY_ID), NULL, NULL) ELSE FN_GET_CODE ('CNAME', to_char(MD.FINAL_DESTINATION_COUNTRY_ID), NULL, NULL) END) VOYAGE, CASE WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') = '0' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') = 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) WHEN SM.SALE_TERM_VALUE = 0 AND NVL (TM.TOLERANCE_NAME, '0') != 'NONE' THEN REGEXP_SUBSTR (SM.SALE_TERM_NAME, '[^+]+', 1, 1) || '+' || TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') = 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NVL (TM.TOLERANCE_NAME, '0') != 'NONE' THEN SM.SALE_TERM_NAME || '+' || TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END BASIS_OF_VAL, CO.CONVDESC CONVEYANCE, CM.CURRENCY_NAME CURRENCY, (CASE WHEN PM.PRODUCT_ID = '11' THEN FN_GET_CODE ('LCNO', MD.OPEN_LC_ID, NULL, NULL) ELSE to_char(MPD.LC_NUMBER) END) LC_NUMBER, (CASE WHEN PM.PRODUCT_ID = '11' THEN FN_GET_CODE ('BNAME', MD.OPEN_BANK_ID, NULL, NULL) ELSE MPD.BANK_NAME END) BANK_NAME, MPD.BL_AWB_NO, DECODE (NVL (SAM.SETTLING_AGENT_ID, 0), 0, MPD.SETTLING_AGENT_NAME, SAM.SETTLING_AGENT_NAME) SETTLING_AGENT, MD.EXTRA_COVER_ID, TO_CHAR (MRD.WARRATE, '0.999999') WARRATE, TO_CHAR (MRD.RATE, '0.999999') RATE, EMD.TOTAL_PREMIUM PREMIUM, EMD.MARINE_PREMIUM, EMD.WAR_PREMIUM, EMD.TOTAL_MARINE_WAR TOTAL, EMD.PREV_MARINE_WAR_PREMIUM LESS_PREMIUM, EMD.FINAL_TOTAL_MARINE_WAR FINAL_TOTAL, EMD.EXCESS_PREMIUM, EMD.POLICY_FEE, EMD.NET_PREMIUM, (CASE WHEN MD.EXTRA_COVER_ID != 0 THEN 'Yes with Rate ' || TO_CHAR (MRD.WARRATE, '0.999999') || '%' ELSE NULL END) WSRCC, PM.PDF_STAMP_STATUS, PM.PRODUCT_ID,PM.ENDT_PREM_YN,PM.ENDT_CLAUSES_YN FROM POSITION_MASTER PM JOIN BRANCH_MASTER BM ON BM.BRANCH_CODE = ? JOIN (SELECT QUOTE_NO, POLICY_NO, APPLICATION_NO, EQUIVALENT_USD + NVL (TOTAL_SALE_TERM_CHARGES, 0) + NVL (TOTAL_TOLERANCE_CHARGES, 0) SUMINSURED, LAG ( EQUIVALENT_USD + NVL (TOTAL_SALE_TERM_CHARGES, 0) + NVL (TOTAL_TOLERANCE_CHARGES, 0), 1, 0 ) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) PREV_SUMINSURED, PREMIUM - NVL (TOTAL_WAR_CHARGES, 0) - NVL (POLICY_FEE, 0) MARINE_PREMIUM, NVL (TOTAL_WAR_CHARGES, 0) WAR_PREMIUM, NVL (EXCESS_PREMIUM, 0) EXCESS_PREMIUM, NVL (POLICY_FEE, 0) POLICY_FEE, PREMIUM - NVL (POLICY_FEE, 0) TOTAL_MARINE_WAR, PREMIUM + NVL (EXCESS_PREMIUM, 0)+NVL(GOVT_TAX,0) TOTAL_PREMIUM, LAG (PREMIUM - NVL (POLICY_FEE, 0) - NVL (EXCESS_PREMIUM, 0)-NVL(A.GOVT_TAX,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) PREV_MARINE_WAR_PREMIUM, (PREMIUM - NVL (POLICY_FEE, 0)) - LAG (PREMIUM - NVL (POLICY_FEE, 0) - NVL (EXCESS_PREMIUM, 0)-NVL(GOVT_TAX,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) FINAL_TOTAL_MARINE_WAR, (PREMIUM - NVL (POLICY_FEE, 0)) - LAG (PREMIUM - NVL (POLICY_FEE, 0) - NVL (EXCESS_PREMIUM, 0)-NVL(GOVT_TAX,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) + NVL (EXCESS_PREMIUM, 0) + NVL (POLICY_FEE, 0)+NVL(GOVT_TAX,0) NET_PREMIUM FROM MARINE_DATA_ENDT) EMD ON EMD.POLICY_NO = PM.POLICY_NO JOIN MARINE_DATA MD ON MD.APPLICATION_NO = PM.APPLICATION_NO AND PM.AMEND_ID = MD.AMEND_ID JOIN MARINE_POLICY_DETAILS MPD ON PM.QUOTE_NO = MPD.QUOTE_NO AND PM.AMEND_ID = MPD.AMEND_ID JOIN ( SELECT APPLICATION_NO, AMEND_ID, SUM (RATE) RATE, SUM (WARRATE) WARRATE FROM MARINE_RESULT_DETAILS GROUP BY APPLICATION_NO, AMEND_ID) MRD ON MRD.APPLICATION_NO = PM.APPLICATION_NO AND PM.AMEND_ID = MRD.AMEND_ID JOIN CURRENCY_MASTER CM ON MD.CURRENCY_ID = CM.CURRENCY_ID JOIN PERSONAL_INFO PI ON PI.CUSTOMER_ID = PM.CUSTOMER_ID JOIN SALE_TERM_MASTER SM ON SM.SALE_TERM_ID = MD.SALE_TERM_ID AND SM.BRANCH_CODE = BM.BELONGING_BRANCH JOIN TOLERANCE_MASTER TM ON TM.TOLERANCE_ID = MD.TOLERANCE_ID AND TM.BRANCH_CODE = BM.BELONGING_BRANCH JOIN COVER_MASTER CR ON CR.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT AND CR.COVER_ID = MD.COVER_ID AND CR.BRANCH_CODE = BM.BELONGING_BRANCH AND TRUNC (CR.EFFECTIVE_DATE) <= TRUNC (SYSDATE) LEFT OUTER JOIN CONVEYAN_MASTER CO ON CO.SNO = MD.SEA_OPTIONS AND CO.BRANCH_CODE = BM.BELONGING_BRANCH AND CO.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT LEFT OUTER JOIN SETTLING_AGENT_MASTER SAM ON SAM.SETTLING_AGENT_ID = MPD.SETTLING_AGENT_ID AND SAM.BELONGING_COUNTRY_ID = BM.ORIGINATION_COUNTRY_ID  WHERE PM.POLICY_NO = ? AND CM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID) AND PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND CR.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID = CR.COVER_ID AND BRANCH_CODE = CR.BRANCH_CODE AND TRUNC (EFFECTIVE_DATE) <= TRUNC (SYSDATE))
GET_POL_DEDUCT=SELECT MRD.COMMODITY_EXCESS_PREMIUM, MRD.DESCRIPTION, (SELECT CURRENCY_NAME FROM OPEN_COVER_DEDUCTIBLE_MASTER A, OPEN_COVER_POSITION_MASTER B WHERE NVL (SUMINSUREDLOCAL, 0) + NVL (SALE_TERM_CHARGES, 0) + NVL (TOLERANCE_CHARGES, 0) BETWEEN A.START_RANGE AND A.END_RANGE AND A.OPEN_COVER_PROPOSAL_NO = B.PROPOSAL_NO AND B.OPEN_COVER_NO = PM.OPEN_COVER_NO AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DEDUCTIBLE_MASTER WHERE OPEN_COVER_PROPOSAL_NO = A.OPEN_COVER_PROPOSAL_NO)) CURRENCY_NAME FROM MARINE_RESULT_DETAILS MRD, POSITION_MASTER PM WHERE MRD. APPLICATION_NO =PM.APPLICATION_NO AND PM.APPLICATION_NO=? AND COMMODITY_EXCESS_PREMIUM > 0
CNT_POL_ENDT=SELECT COUNT(1) FROM POSITION_MASTER WHERE APPLICATION_NO\=? AND ENDT_STATUS\='Y'
CNT_ENDT_FINANCIAL=SELECT COUNT(*) FROM ENDT_TYPE_MASTER WHERE ENDT_TYPE_CATEGORY_ID\=2 AND ENDT_TYPE_ID IN (?)
CNT_ENDT_POL_FEE=SELECT COUNT(*) FROM POSITION_MASTER WHERE APPLICATION_NO=? AND NVL(PREMIUM,0)+NVL(EXCESS_PREMIUM,0)!=0
CAL_UPD_ENDT_PRE=CALL ENDT_PREMIUM_CALCULATION(?)
DEL_ENDT_MD=DELETE FROM MARINE_DATA_ENDT WHERE APPLICATION_NO=?
DEL_ENDT_MRD=DELETE FROM MARINE_RESULT_DETAILS_ENDT WHERE APPLICATION_NO\=?
UPD_ENDT_STS=UPDATE POSITION_MASTER A SET A.ENDT_STATUS = 'N', A.POLICY_NO=NULL WHERE A.APPLICATION_NO = ?
UPD_ENDT_STS_REJ=UPDATE POSITION_MASTER A SET A.ENDT_STATUS \= 'Y' WHERE A.POLICY_NO \= ( SELECT PM1.POLICY_NO FROM POSITION_MASTER PM1,POSITION_MASTER PM2 WHERE PM2.APPLICATION_NO \= ? AND NVL(PM2.ORIGINAL_POLICY_NO ,PM2.POLICY_NO) \= NVL(PM1.ORIGINAL_POLICY_NO,PM1.POLICY_NO) AND PM1.AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE ENDT_STATUS\='N' AND STATUS\='P' AND NVL(ORIGINAL_POLICY_NO ,POLICY_NO)\=NVL(PM1.ORIGINAL_POLICY_NO ,PM1.POLICY_NO)))
UPD_ENDT_MD_FEE=UPDATE MARINE_DATA_ENDT SET POLICY_FEE=?,GOVT_TAX=? WHERE APPLICATION_NO=?
UPD_MD_FEE=UPDATE MARINE_DATA SET POLICY_FEE=?,GOVT_TAX=? WHERE APPLICATION_NO=?
UPD_PM_FEE=UPDATE POSITION_MASTER SET PREMIUM\=PREMIUM+?+? WHERE APPLICATION_NO\=?
GET_QUOTE_ISSUER=SELECT APPLICATION_ID FROM POSITION_MASTER WHERE APPLICATION_NO\=?
GET_OC_INFO=SELECT NVL(A.ORIGINAL_POLICY_NO,A.OPEN_COVER_NO) OPEN_COVER_NO, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \=C.BROKER_ID)) BROKER_NAME FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO B, OPEN_COVER_MASTER C WHERE A.OPEN_COVER_NO\=? AND B.CUSTOMER_ID \= C.CUSTOMER_ID AND C.PROPOSAL_NO\=A.PROPOSAL_NO AND C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=A.PROPOSAL_NO)
GET_COMMODITY_LIST_OC=SELECT COMMODITY_NAME_DESC FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?)
UPD_XL_OPENCOVER_RAW_UPLOAD=UPDATE xl_opencover_raw SET SR_NO\=?, INTEREST \= ?, CONVEYANCE \= (SELECT distinct(TRANSPORT_DESCRIPTION) FROM MODE_OF_TRANSPORT MOT WHERE MODE_TRANSPORT_ID \= ? AND status \= 'Y' AND MOT.BRANCH_CODE\=?), COVER \= (SELECT distinct(COVER_NAME) FROM COVER_MASTER WHERE COVER_ID \= ? AND STATUS \= 'Y' AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= ?)), VOYAGE_FROM \= ?, VOYAGE_TO \= ?, CURRENCY \= ?, INCOTERMS \= (SELECT DISTINCT REGEXP_SUBSTR (Sale_Term_name, '[^+]+', 1, 1) FROM sale_term_master WHERE Branch_code \= ? AND rsacode \= ?), BASIS_OF_VALUATION \=( select SALE_TERM_NAME||TOLERANCE_NAME NAME from (select rownum rn,SALE_TERM_ID,SALE_TERM_NAME from sale_term_master where SALE_TERM_ID\=? and branch_code\=? and status\='Y') left outer join (select rownum rn1,tolerance_id,decode(TOLERANCE_NAME,'NONE','','+'||TOLERANCE_NAME) TOLERANCE_NAME from tolerance_master where tolerance_id\=? and branch_code\=? and status\='Y') on rn\=rn1), PACKAGE_DESCRIPTION \= ?, COMMODITY_DESCRIPTION \= ?, WSRCC\=?, VALIDATION_ERROR\=?, VALIDATION_STATUS\='', PACKING_DETAILS\='' WHERE TRANSACTION_ID\=? AND SNO \=?
UPD_XL_OPENCOVER_ARC_UPLOAD=UPDATE xl_opencover_arc SET SR_NO\=?, INTEREST \= ?, CONVEYANCE \= (SELECT distinct(TRANSPORT_DESCRIPTION) FROM MODE_OF_TRANSPORT MOT WHERE MODE_TRANSPORT_ID \= ? AND status \= 'Y' AND MOT.BRANCH_CODE\=?), COVER \= (SELECT distinct(COVER_NAME) FROM COVER_MASTER WHERE COVER_ID \= ? AND STATUS \= 'Y' AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= ?)), VOYAGE_FROM \= ?, VOYAGE_TO \= ?, CURRENCY \= ?, INCOTERMS \= (SELECT DISTINCT REGEXP_SUBSTR (Sale_Term_name, '[^+]+', 1, 1) FROM sale_term_master WHERE Branch_code \= ? AND rsacode \= ?), BASIS_OF_VALUATION \=( select SALE_TERM_NAME||TOLERANCE_NAME NAME from (select rownum rn,SALE_TERM_ID,SALE_TERM_NAME from sale_term_master where SALE_TERM_ID\=? and branch_code\=? and status\='Y') left outer join (select rownum rn1,tolerance_id,decode(TOLERANCE_NAME,'NONE','','+'||TOLERANCE_NAME) TOLERANCE_NAME from tolerance_master where tolerance_id\=? and branch_code\=? and status\='Y') on rn\=rn1), PACKAGE_DESCRIPTION \= ?, COMMODITY_DESCRIPTION \= ?, WSRCC\=?, VALIDATION_ERROR\=?, VALIDATION_STATUS\='', PACKING_DETAILS\='' WHERE TRANSACTION_ID\=? AND SNO \=?
GET_WARYN_OPENCOVER=select WRSC_YN from OPEN_COVER_MASTER where PROPOSAL_NO=(select PROPOSAL_NO from OPEN_COVER_POSITION_MASTER where OPEN_COVER_NO=?)

#ADMIN BrokerManagement
GET_Broker_List=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.RSA_BROKER_CODE,DECODE(bcm.STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS,to_char(pi.ENTRY_DATE,'DD-MM-YYYY') cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi where bcm.agency_code=pi.agency_code and  bcm.branch_code in(?) and APPLICATION_ID=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) order by lower(bcm.COMPANY_NAME)
GET_Broker_Info=select pi.TITLE,pi.GENDER,pi.FIRST_NAME,pi.LAST_NAME,pi.NATIONALITY,(select NATIONALITY_NAME from COUNTRY_MASTER where amend_id||country_id in( select max(amend_id)||country_id from country_master group by country_id) and COUNTRY_ID=pi.nationality) nationalityName,to_char(pi.DOB,'dd/mm/yyyy') DOB,pi.TELEPHONE,pi.MOBILE,pi.FAX,pi.EMAIL,pi.ADDRESS1,pi.ADDRESS2,pi.OCCUPATION,pi.EMIRATE,pi.COUNTRY,(CASE WHEN to_char(pi.COUNTRY)='Y' then (select COUNTRY_NAME from country_master where (COUNTRY_NAME=pi.COUNTRY or COUNTRY_ID=pi.COUNTRY)) else pi.COUNTRY end) country_name, pi.POBOX,lm.company_name,lm.agency_code,pi.entry_date,lm.status,lm.ADDRESS3,lm.city,lm.BRANCH_CODE,lm.MISSIPPI_ID,lm.APPROVED_PREPARED_BY,lm.rsa_broker_code,log.login_id,lm.AC_EXECUTIVE_ID,PI.CUST_NAME,PI.CUST_AR_NO,log.LOGIN_ID,lm.customer_id,lm.ISSUER_COMMISSION_OPENCOVER, lm.ISSUER_COMMISSION_ONEOFF,LM.IMAGE_PATH from personal_info pi,broker_company_master lm,login_master log where log.agency_code=lm.agency_code and pi.agency_code=lm.agency_code and  pi.agency_code=? and lm.branch_code in(?)
GET_Commission_Data=select distinct(pm.product_name),lud.PRODUCT_ID,lud.COMMISSION,lud.INSURANCE_END_LIMIT,lud.SPECIAL_DISCOUNT,nvl(lm.REFERAL,'N') REFERAL,lud.status,nvl(lud.DISCOUNT_OF_PREMIUM,0) DISCOUNT_PREMIUM,lud.MIN_PREMIUM_AMOUNT,lud.BACK_DATE_ALLOWED,nvl(PRO_COMMISSION,'0'),to_char(PRO_START_DATE,'dd-mm-yyyy'),to_char(PRO_EXPIRY_DATE,'dd-mm-yyyy'),nvl(lud.LOADING_OF_PREMIUM,0) LOADING_PREMIUM,nvl(pay_receipt_status,'N') pay_receipt_status,nvl(receipt_status,'N') receipt_status,nvl(FREIGHT_DEBIT_OPTION,'Y') FREIGHT_DEBIT_OPTION ,nvl(PROVISION_FOR_PREMIUM,'N') PROVISION_FOR_PREMIUM, lm.referal REMARKS from login_master lm,login_user_details lud,product_master pm where lm.agency_code=lud.agency_code and lud.PRODUCT_ID=pm.product_id and  lud.agency_code=?
GET_ADMIN_Branch_Detail=select BRANCH_CODE,BRANCH_NAME from BRANCH_MASTER where status='Y'
GET_ADMIN_REF_Branch_Detail=SELECT BRANCH_CODE,BRANCH_NAME FROM  BRANCH_MASTER WHERE BRANCH_CODE IN (SELECT DISTINCT(REGEXP_SUBSTR(LC_LOGIN,'[^,]+',1,LEVEL)) LC_LOGIN FROM (SELECT ATTACHED_BRANCH LC_LOGIN FROM LOGIN_MASTER WHERE LOGIN_ID=?) B CONNECT BY LEVEL <= LENGTH(LC_LOGIN) - LENGTH(REPLACE(LC_LOGIN,',',''))+1 AND LC_LOGIN IS NOT NULL)
GET_ATTACHED_REGIONS=SELECT BRANCH_CODE, BRANCH_NAME FROM   branch_master WHERE   branch_code IN (SELECT * FROM   table(split_text_fn ((SELECT  decode(accesstype,'Super',NVL (branch_code,branch_code),branch_code) from login_master WHERE    login_id = ?),','))) ORDER BY   branch_name
GET_Branch_Detail=select BRANCH_CODE,BRANCH_NAME from BRANCH_MASTER where status='Y' and BRANCH_CODE in(?)
GET_Broker_Code=SELECT BROKER_CODE_SEQ.NEXTVAL FROM DUAL
GET_Emirates=select city_id,city_name  from city_master where country_id=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and status='Y' order by city_name
GET_Nationalities=select COUNTRY_ID,NATIONALITY_NAME from COUNTRY_MASTER where amend_id||country_id in( select max(amend_id)||country_id from country_master group by country_id) and NATIONALITY_NAME is not null order by NATIONALITY_NAME
GET_Titles=select TITLE_ID,TITLE_NAME from TITLE_MASTER where branch_code=(SELECT BELONGING_BRANCH FROM BRANCH_MASTER BM WHERE BRANCH_CODE=? AND BM.STATUS='Y' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM BRANCH_MASTER BM1 WHERE BM1.BRANCH_CODE=BM.BRANCH_CODE AND BM1.STATUS=BM.STATUS)) and status='Y' order by TITLE_NAME
GET_Executives=select distinct b.AC_EXECUTIVE_ID, b.AC_EXECUTIVE_NAME from LOGIN_EXECUTIVE_DETAILS b where b.status='Y'  and amend_id =(select max(a.amend_id)  from LOGIN_EXECUTIVE_DETAILS a where  a.AC_EXECUTIVE_ID=b.AC_EXECUTIVE_ID)order by b.AC_EXECUTIVE_NAME
INS_Broker_Det=insert into personal_info(customer_id,application_id,title,first_name,last_name,amend_id,nationality,dob,gender,telephone,mobile,fax,email,address1,address2,occupation,pobox,country,emirate,status,entry_date,agency_code,oa_code,CUST_NAME,CUST_AR_NO, LOGIN_ID)values(?,?,?,?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,?,?)
GET_Core_Customer=SELECT CIMSNO,(CASE WHEN CUSTCODE IS NULL OR CUSTGRP IS NULL OR CUSTTYPE IS NULL OR CUSTCLAS IS NULL THEN '' ELSE (CUSTCODE ||'-'|| CUSTGRP ||'-'|| CUSTTYPE ||'-'||CUSTCLAS) END) ARACC, CUSTTITL,CUSTNAME,CUSTADD1,CUSTADD2,CUSTADD3,CUSTADD4 FROM C_CUST@ECARGO_PROD WHERE lower(CUSTNAME) LIKE '%'||lower(?)||'%' AND BRCODE=?
UPD_broker_password=update login_master set password=?,STATUS='Y',PASSDATE=sysdate-1,PWD_COUNT=0 where agency_code=?
GET_Tax_Info=select nvl(POLICY_FEE_STATUS,'N') policy_feestatus,nvl(POLICY_FEE,'0') policy_fees,nvl(GOVT_TAX_STATUS,'N') gov_taxstatus,nvl(GOVT_TAX,'0') govt_tax,nvl(EMERGENCY_FUND_STATUS,'N') emergency_fundstatus,nvl(EMERGENCY_FUND,'0')emer_fund,to_char(EFFECTIVE_DATE,'dd/mm/yyyy') effec_date, TAX_APPLICABLE from BROKER_MASTER where BRANCH_CODE=? and AGENCY_CODE=? and status='Y' and AMEND_ID||AGENCY_CODE in(select max(nvl(AMEND_ID,'0'))||AGENCY_CODE from BROKER_MASTER where BRANCH_CODE=? and AGENCY_CODE=? and status='Y' group by AGENCY_CODE)
GET_Customer_Id=select nvl((max(current_no)+1),max(start_no)) from policyno_generate where type_id=3 and status='Y' and BRANCH_CODE=?
UPD_Customer_Id=update policyno_generate set CURRENT_NO=?, REMARKS=? where type_id=3 and status='Y' and BRANCH_CODE=?
INS_BCM_DET=insert into broker_company_master(AGENCY_CODE,COMPANY_NAME,CONTACT_PERSON,ADDRESS1,ADDRESS2,ADDRESS3,CITY,COUNTRY,PHONE,POBOX,FAX,EMIRATE,REMARKS,STATUS,CUSTOMER_ID,BRANCH_CODE,MISSIPPI_ID,APPROVED_PREPARED_BY,rsa_broker_code,AC_EXECUTIVE_ID, ISSUER_COMMISSION_ONEOFF, ISSUER_COMMISSION_OPENCOVER,IMAGE_PATH) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
GET_BRO_CODE=SELECT BROKER_CODE_SEQ.NEXTVAL FROM DUAL
GET_MAX_BRO_CODE=update policyno_generate set current_no=?,remarks=? where type_id=3 and status='Y' and BRANCH_CODE=?
GET_CUST_ID=select CUSTOMER_ID from broker_company_master where agency_code=? and branch_code=?
UPD_BROKER_DET=update  broker_company_master set COMPANY_NAME=?,CONTACT_PERSON=?,ADDRESS1=?,ADDRESS2=?,ADDRESS3=?,CITY=?,COUNTRY=?,PHONE=?,POBOX=?,FAX=?,EMIRATE=?,CUSTOMER_ID=?,BRANCH_CODE=?,MISSIPPI_ID=?,APPROVED_PREPARED_BY=?,RSA_BROKER_CODE=?,AC_EXECUTIVE_ID=?, ISSUER_COMMISSION_ONEOFF=?, ISSUER_COMMISSION_OPENCOVER=? ,IMAGE_PATH=? where agency_code=? and branch_code=?
UPD_PERSONAL_INFO=update personal_info set title=?,first_name=?,last_name=?,nationality=?,dob=to_date(?,'dd/mm/yyyy'),gender=?,telephone=?,mobile=?,fax=?,email=?,address1=?,address2=?,occupation=?,pobox=?,country=?,emirate=?,status=?,effective_date=to_date(?,'dd/mm/yyyy'),CUST_NAME=?,CUST_AR_NO=?  where application_id=? and agency_code=?
GET_MAXAMEND_ID=select max(AMEND_ID) from BROKER_MASTER where BRANCH_CODE=? and AGENCY_CODE=? and status='Y'
INS_TAX_DET=insert into BROKER_MASTER(AGENCY_CODE,BRANCH_CODE,POLICY_FEE_STATUS,GOVT_TAX_STATUS,EMERGENCY_FUND_STATUS, POLICY_FEE,GOVT_TAX,EMERGENCY_FUND,STATUS,REMARKS,AMEND_ID,TAX_APPLICABLE,ENTRY_DATE,EFFECTIVE_DATE)values(?,?,?,?,?,?,?,?,'Y',?,?,?,sysdate,to_date(?,'dd/mm/yyyy'))
UPD_TAX_DET = update BROKER_MASTER BM set POLICY_FEE_STATUS\=?, GOVT_TAX_STATUS\=?, EMERGENCY_FUND_STATUS\=?, POLICY_FEE\=?, GOVT_TAX\=?, EMERGENCY_FUND\=?, TAX_APPLICABLE\=?, EFFECTIVE_DATE\=to_date(?,'dd/mm/yyyy') where agency_code\=? and branch_code\=? and amend_id\=(select max(Amend_id) from BROKER_MASTER B Where BM.agency_code\=B.agency_code and BM.branch_code\=b.branch_code) 
GET_PRODUCT_DET=select TRIM(PRODUCT_ID) PRODUCT_ID,PRODUCT_NAME,COMPANY_ID from product_master where status='Y' and branch_code =( select belonging_branch from branch_master bm where branch_code=?  AND STATUS='Y' and amend_id=(select max(amend_id) from branch_master bm1 where bm1.branch_code=bm.branch_code and bm1.status=bm.status))
GET_REF_PRODUCT_DET= select TRIM(PRODUCT_ID) PRODUCT_ID,PRODUCT_NAME,COMPANY_ID from product_master where status='Y' and branch_code =( select belonging_branch from branch_master bm where branch_code=?  AND STATUS='Y' and amend_id=(select max(amend_id) from branch_master bm1 where bm1.branch_code=bm.branch_code and bm1.status=bm.status))
GET_COMP_DET=select bcm.COMPANY_NAME, pi.FIRST_NAME FROM BROKER_COMPANY_MASTER bcm,PERSONAL_INFO pi where pi.AGENCY_CODE=bcm.AGENCY_CODE and pi.AGENCY_CODE=?
GET_MAXUSER_ID=select max(USER_ID)+1 from LOGIN_USER_DETAILS
INS_PRODUCT_DET=insert into login_user_details(USER_ID,USER_NAME,LOGIN_ID,AGENCY_CODE,OA_CODE, PRODUCT_ID,COMPANY_ID,COMMISSION,INSURANCE_START_LIMIT, INSURANCE_END_LIMIT,DISCOUNT_OF_PREMIUM,RELATIVE_USER_ID,AMEND_ID, INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,REMARKS,STATUS, CUSTOMER_ID,MIN_PREMIUM_AMOUNT,BACK_DATE_ALLOWED,Pro_commission, pro_start_date,pro_expiry_date,LOADING_OF_PREMIUM, PROVISION_FOR_PREMIUM,FREIGHT_DEBIT_OPTION,PAY_RECEIPT_STATUS, RECEIPT_STATUS, open_cover_no, SPECIAL_DISCOUNT,SCHEME_ID) values(?,?,(select LOGIN_ID from login_master where AGENCY_CODE=?),?,?,?,?,?,?,?,?,?,?,sysdate,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
UPD_PRODUCT_DET=update login_user_details set COMMISSION=?,INSURANCE_END_LIMIT=?,STATUS=?,DISCOUNT_OF_PREMIUM=?,MIN_PREMIUM_AMOUNT=? ,BACK_DATE_ALLOWED=?,LOADING_OF_PREMIUM=?,pay_receipt_status=?,FREIGHT_DEBIT_OPTION=?,PROVISION_FOR_PREMIUM=?, RECEIPT_STATUS=?, open_cover_no=?, SPECIAL_DISCOUNT=? where AGENCY_CODE=? and product_id=?
UPD_PRODUCT_DET_LM=update login_master set referal=? where AGENCY_CODE=?
INS_LOGIN_DET=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,ACCESSTYPE,PASSDATE,BRANCH_CODE,COUNTRY_ID,CORE_LOGIN_ID, APP_ID, PWD_COUNT, USER_MAIL,ENTRY_DATE) values(?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate+45,?,?,?, '16', '0', ?,sysdate)
UPD_PERSONAL_LOGIN_ID=update personal_info set LOGIN_ID\=? where AGENCY_CODE\=? 
UPD_BROKER_STATUS_LM = update login_master set USERNAME=?, status=?, USER_MAIL=? where agency_code=?
UPD_BROKER_STATUS_BCM = update broker_company_master set status=? where agency_code=?
GET_MAIN_USER_INFO=SELECT lm.LOGIN_ID, lm.USERTYPE, lm.BRANCH_CODE, (select BRANCH_NAME from branch_master where STATUS='Y' and branch_code=lm.branch_code) BRANCH_NAME, lm.COUNTRY_ID, lm.MENU_ID FROM LOGIN_MASTER lm WHERE lm.LOGIN_ID=?
GET_BROKER_LIST_BY_NAME=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.RSA_BROKER_CODE,DECODE(bcm.STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS,to_char(pi.ENTRY_DATE,'DD-MM-YYYY') cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi where bcm.agency_code=pi.agency_code and  bcm.branch_code in(?) and APPLICATION_ID=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) AND lower(bcm.COMPANY_NAME) like '%'||lower(?)||'%'  order by lower(bcm.COMPANY_NAME)
GET_BROKER_LIST_BY_CODE=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.RSA_BROKER_CODE,DECODE(bcm.STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS,to_char(pi.ENTRY_DATE,'DD-MM-YYYY') cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi where bcm.agency_code\=pi.agency_code and  bcm.branch_code in(?) and APPLICATION_ID\=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) AND bcm.RSA_BROKER_CODE like '%'||?||'%'  order by lower(bcm.COMPANY_NAME)
BRANCH_BCODE_CNT = SELECT COUNT(*) FROM BROKER_COMPANY_MASTER WHERE RSA_BROKER_CODE=? AND BRANCH_CODE=?
BROKER_DELETE_LOGO = UPDATE BROKER_COMPANY_MASTER SET IMAGE_PATH='' WHERE AGENCY_CODE=?

##UnderWriter Management
INS_ISSUER_LOGIN_DET=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,ACCESSTYPE,PASSDATE,BRANCH_CODE,COUNTRY_ID,CORE_LOGIN_ID, APP_ID, PWD_COUNT, USER_MAIL,PRODUCT_ID,ENTRY_DATE,ATTACHED_BRANCH,INCEPTION_DATE) values(?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate+45,?,?,?, '16', '0', ?,?,SYSDATE,?,?)
GET_ISSUER_LIST =select username COMPANY_NAME,decode(USERTYPE,'RSAIssuer','Issuer') USERTYPE,login_id,to_char(ENTRY_DATE,'dd/mm/yyyy') CR_DATE,DECODE (status,'Y','Active','N','DeActive', 'D','Delete','L','Locked') status,ATTACHED_BRANCH from login_master where branch_code\=? and usertype\='RSAIssuer' 
GET_ISSUER_DETAIL =SELECT   broker_code,login_id,(SELECT   company_name FROM   broker_company_master bcm WHERE   bcm.AGENCY_CODE = broker_code) broker_name,lm.product_id,(select distinct(product_name) from product_master pm where pm.product_id=lm.product_id and branch_code=?) product_name,commission,TO_CHAR (START_DATE, 'DD/MM/YYYY') START_DATE,TO_CHAR (END_DATE, 'DD/MM/YYYY') END_DATE,TO_CHAR (START_DATE, 'dd'),TO_CHAR (START_DATE, 'MM'),TO_CHAR (START_DATE, 'YYYY'),TO_CHAR (END_DATE, 'dd'),TO_CHAR (END_DATE, 'MM'),TO_CHAR (END_DATE, 'YYYY'),status,TO_CHAR (CANCEL_DATE, 'dd'),TO_CHAR (CANCEL_DATE, 'MM'),TO_CHAR (CANCEL_DATE, 'YYYY'),type FROM LOGIN_RSAUSER_DETAILS lm WHERE  login_id = ? AND (amend_id || broker_code || product_id) IN (  SELECT   MAX (amend_id) || broker_code || product_id FROM   LOGIN_RSAUSER_DETAILS WHERE   login_id = ? GROUP BY   broker_code, product_id)ORDER BY   broker_Code, product_id
GET_INCLUDE_BROKER = SELECT broker_code,(select company_name from broker_company_master bcm where bcm.agency_code\=lm.broker_code) broker_name,product_id,(select distinct(product_name)from product_master pm where pm.product_id\=lm.product_id) product_name,TO_CHAR (START_DATE,'DD/MM/YYYY') START_DATE,TO_CHAR (END_DATE, 'DD/MM/YYYY') END_DATE,decode(status,'Y','ACTIVE','N','DEACTIVE') status FROM LOGIN_RSAUSER_DETAILS lm 
GET_EXCLUDE_BROKER = SELECT broker_code,(select company_name from broker_company_master bcm where bcm.agency_code=lm.broker_code) broker_name,product_id,(select distinct(product_name)from product_master pm where pm.product_id=lm.product_id) product_name,TO_CHAR (START_DATE,'DD/MM/YYYY') START_DATE,TO_CHAR (END_DATE, 'DD/MM/YYYY') END_DATE,decode(status,'Y','ACTIVE','N','DEACTIVE') status FROM LOGIN_RSAUSER_DETAILS lm WHERE TYPE=?
UPDATE_INCLUDE_BROKER =update LOGIN_RSAUSER_DETAILS set type=?,STATUS=? where BROKER_CODE =? and product_id =?
issuer.branch=select BRANCH_CODE CODE,BRANCH_NAME CODEDESC from rsa_branch_details  where branch_code in  (SELECT distinct(REGEXP_SUBSTR(RSA_BRANCH_CODE,'[^,]+',1,LEVEL)) lc_login FROM (select RSA_BRANCH_CODE from login_master where login_id\=?) B  CONNECT BY LEVEL <\= LENGTH(RSA_BRANCH_CODE) - LENGTH(REPLACE(RSA_BRANCH_CODE,',',''))+1) 
issuer.broker=select bcm.AGENCY_CODE CODE, bcm.COMPANY_NAME CODEDESC from broker_company_master bcm,login_master lm  where bcm.agency_code=lm.agency_code and upper(lm.usertype)=upper('Broker') and lm.branch_code=? and bcm.agency_code not in (select broker_code  from login_rsauser_details where login_id=? and branch_code=? and product_id=?)
GET_UW_DETLIST=select username,user_mail,login_id,CORE_LOGIN_ID,product_id,status,ATTACHED_BRANCH,to_char(INCEPTION_DATE,'dd/mm/yyyy') INCEPTION_DATE from login_master where branch_code=? and usertype='RSAIssuer' and login_id=?
ICLCU_BROKER=insert into LOGIN_RSAUSER_DETAILS (LOGIN_ID, BROKER_CODE, PRODUCT_ID,BRANCH_CODE, AMEND_ID, COMMISSION,ENTRY_DATE, START_DATE,END_DATE, STATUS) values (?,?,?,?,?,?,sysdate,sysdate,sysdate+365,?)

#USER MANAGEMENT
GET_USER_LIST = select nvl(per.first_name||''||per.last_name,per.company_name)company_name,log.usertype,log.LOGIN_ID,per.application_id,per.agency_code,DECODE(per.status,'Y','Active','N','DeActive','D','Delete','L','Locked') status,to_char(per.ENTRY_DATE,'DD-MM-YYYY') cr_date, (select distinct(USERNAME) from login_master where  AGENCY_CODE\=log.OA_CODE) brokerName from personal_info per,login_master log where log.usertype\=? and log.agency_code\=per.agency_code and log.login_id not in('NONE')
GET_USER_INFO= SELECT LOGIN_ID,PASSWORD,USERTYPE, STATUS, PWD_COUNT FROM LOGIN_MASTER WHERE  LOGIN_ID \= ? AND PASSWORD \= ? AND APP_ID \= ? AND STATUS in ('T','Y')
GET_BROKER_USER_DETAILS=select pi.TITLE,pi.GENDER,pi.FIRST_NAME,pi.LAST_NAME,(select NATIONALITY_NAME from COUNTRY_MASTER where amend_id||country_id in( select max(amend_id)||country_id from country_master group by country_id) and COUNTRY_ID=pi.nationality) nationality_name, pi.NATIONALITY, to_char(pi.DOB,'dd/mm/yyyy') DOB,pi.TELEPHONE,pi.MOBILE,pi.FAX,pi.EMAIL,pi.ADDRESS1,pi.ADDRESS2,pi.OCCUPATION,pi.EMIRATE,pi.COUNTRY,(select COUNTRY_NAME from country_master where COUNTRY_ID=pi.COUNTRY and AMEND_ID=(SELECT max(AMEND_ID) FROM country_master WHERE COUNTRY_ID=pi.COUNTRY)) country_name,pi.POBOX,lm.agency_code,pi.entry_date,pi.status,pi.city,lm.BRANCH_CODE,lm.login_id,(select COMPANY_NAME from broker_company_master where AGENCY_CODE=lm.OA_CODE) bname, lm.usertype, PI.CUST_NAME,PI.CUST_AR_NO,pi.customer_id, (select distinct(USERNAME) from login_master where  AGENCY_CODE=lm.OA_CODE)borganization, lm.OA_CODE from personal_info pi, login_master lm where pi.agency_code=lm.agency_code and pi.LOGIN_ID=lm.LOGIN_ID and  pi.agency_code=?
GET_OPENCOVER_CERTIFICAE=select distinct(ocpm.open_cover_no),ocpm.proposal_no,ocm.MISSIPPI_OPENCOVER_NO,ocpm.Customer_Schedule,ocpm.Customer_Debit,ocpm.Customer_CustomerDebit,nvl(pi.company_name,pi.first_name) name from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.broker_id in(select distinct LOGIN_ID from login_user_details where agency_code=?) and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no AND ocpm.amend_id = (SELECT   MIN (amend_id) FROM   open_cover_position_master oc WHERE NVL (oc.ORIGINAL_POLICY_NO, oc.OPEN_COVER_NO) = NVL (ocpm.ORIGINAL_POLICY_NO, ocpm.OPEN_COVER_NO)) and pi.customer_id=ocm.customer_id and pi.status='Y' and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no  group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
GET_USER_AGENCYCODE=select detail_name from constant_detail where CATEGORY_ID=37 and CATEGORY_DETAIL_ID=1 and status='Y' and branch_code=?
INS_USER_PERSONAL_INFO=insert into personal_info(customer_id,application_id,title,first_name,last_name,amend_id,nationality,dob,gender,telephone,mobile,fax,email,address1,address2,occupation,pobox,country,emirate,status,entry_date,login_id,AGENCY_CODE,OA_CODE,city,fd_code)values(?,?,?,?,?,?,?, to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,?,?)
INS_USER_LOGIN_MASTER=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,ACCESSTYPE,RIGHTS,LPASS1,LPASS2,LPASS3,PASSDATE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,REFERAL, APP_ID, PWD_COUNT, USER_MAIL, branch_code, COUNTRY_ID,ENTRY_DATE) values(?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,?,?,?,'16','0',?,?,?,sysdate)
UPD_USER_PERSONAL_INFO=update personal_info set title=?, first_name=?, last_name=?, nationality=?, dob=to_date(?,'dd/mm/yyyy'), gender=?, telephone=?, mobile=?, fax=?, email=?, address1=?, address2=?, occupation=?, pobox=?, country=?, emirate=?, status=?, city=? where agency_code=?
UPD_USER_LOGIN_MASTER=update login_master set USERNAME=?, STATUS=?, USER_MAIL=? where AGENCY_CODE=?
UPD_USER_AGENCYCODE=update constant_detail set detail_name=? where CATEGORY_ID=37 and CATEGORY_DETAIL_ID=1 and status='Y' and branch_code=?
GET_USER_COMMISSION=select pm.product_name uproductName, pm.product_id uproductId, lud.SPECIAL_DISCOUNT specialDis, lud.FREIGHT_DEBIT_OPTION freight, lud.INSURANCE_END_LIMIT insEndLimit, lud.pay_receipt_status receipt, lud.open_cover_no, decode(lud.login_id,null,'N','Y') product from PRODUCT_MASTER pm left outer join LOGIN_USER_DETAILS lud on PM.PRODUCT_ID = LUD.PRODUCT_ID and LUD.AGENCY_CODE = ? and LUD.OA_CODE = ? where PM.BRANCH_CODE = (SELECT BELONGING_BRANCH FROM BRANCH_MASTER WHERE BRANCH_CODE=?) AND PM.STATUS='Y'
GET_EXIST_PRODUCT_COUNT=select count(*) from LOGIN_USER_DETAILS where PRODUCT_ID\=? and AGENCY_CODE\=?

#CUSTOMER MANAGEMENT
GET_CUSTOMER_LIST=SELECT (FIRST_NAME || company_name) company_name, NVL (CUSTOMER_LOGIN_ID, ''), (select distinct(COMPANY_NAME) from BROKER_COMPANY_MASTER where agency_code=oa_code) broker_name, NVL (TO_CHAR (ENTRY_DATE, 'DD-MM-YYYY'), ' ') ENTRY_DATE,  NVL (agency_code, '0'), NVL (fd_code, '0') EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME, EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2, CUST_AR_NO, REPLACE ('P.O.BOX.' || NVL (POBOX, ' ') || NVL (ADDRESS1, ' ') || NVL (ADDRESS2, ' ') || NVL (EMIRATE, ' '), 'select', '') ADDRESS FROM PERSONAL_INFO PI WHERE APPLICATION_ID = '1' AND LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE
GET_CUSTOMER_INFO=select * from personal_info where customer_id=?
GET_OPEN_COVER_LIST_CUSTOMER=select distinct(a.proposal_no),nvl(a.open_cover_no,'0') open_cover_no, DECODE(a.STATUS,'Y','Quote','P','Policy') STATUS, nvl(a.open_cover_no,'0'),nvl(to_char(b.policy_start_date,'DD-MM-YYYY'),' ') pol_start_date,nvl(to_char(b.policy_end_date,'DD-MM-YYYY'),' ') pol_expire_date,nvl(first_name,company_name) name,RENEWAL_STATUS,b.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_master b,personal_info c where a.status\='Y' and a.original_policy_no is null and a.proposal_no \= b.proposal_no and b.amend_id \= (select max(amend_id) from open_cover_master b where b.proposal_no \= a.proposal_no) and a.proposal_no in (select proposal_no from open_cover_master where broker_id\=(select distinct LOGIN_ID from login_user_details where agency_code\=?)) and c.customer_id \=b.customer_id and b.customer_id\=?
GET_CORECUSTOMER_LIST=SELECT CUSTOMER_ID,FIRST_NAME,EMAIL,ADDRESS1||' ,'||ADDRESS2 ADDRESS,EMIRATE FROM PERSONAL_INFO WHERE  APPLICATION_ID = '1' AND MISSIPPI_CUSTOMER_CODE IS null
UPD_CORECUSTOMER_MISSIP=UPDATE PERSONAL_INFO SET MISSIPPI_CUSTOMER_CODE=? WHERE CUSTOMER_ID=?
#Open Cover
GET_OPENCOVER_LIST=select distinct(a.proposal_no),nvl(a.open_cover_no,'0'),nvl(to_char(b.policy_start_date,'DD-MM-YYYY'),' '),nvl(to_char(b.policy_end_date,'DD-MM-YYYY'),' '),nvl(first_name,company_name) name,RENEWAL_STATUS,b.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_master b,personal_info c where a.status\='Y' and a.original_policy_no is null and a.proposal_no \= b.proposal_no and b.amend_id \= (select max(amend_id) from open_cover_master b where b.proposal_no \= a.proposal_no) and a.proposal_no in (select proposal_no from open_cover_master where broker_id\=(select distinct LOGIN_ID from login_user_details where agency_code\=?)) and c.customer_id \=b.customer_id order by a.proposal_no desc

#Referal Cases
GET_OCLIST_PENDING=select to_char(a.entry_date,'YYYY-MM-DD') entery_date,count(a.entry_date) count_entery_date from position_master a,marine_data b, personal_info c where c.CUSTOMER_ID=a.CUSTOMER_ID and ((a.REMARKS in ('Referal') and b.ADMIN_REFERRAL_STATUS='N') or (a.REMARKS in ('Admin','Normal','NORMAL_EXCESS_PRICE') and b.ADMIN_REFERRAL_STATUS='Y')) and a.status in ('Y','E') and a.product_id in(?) and  a.application_no=b.application_no and a.FREIGHT_STATUS is null and a.login_id in(select login_id from login_master where
GET_HOMEOCLIST_PENDING=SELECT TO_CHAR(A.ENTRY_DATE,'YYYY-MM-DD') ENTERY_DATE,COUNT(A.ENTRY_DATE) COUNT_ENTERY_DATE FROM HOME_POSITION_MASTER A WHERE A.REMARKS\= 'Referal' AND A.STATUS IN ('Y','E') AND A.PRODUCT_ID\=? AND A.LOGIN_ID IN(SELECT LOGIN_ID FROM LOGIN_MASTER WHERE  
GET_OCLIST_APPROVED=select to_char(a.entry_date,'YYYY-MM-DD') entery_date,count(a.entry_date) count_entery_date,sum(nvl(a.premium,'0')+nvl(a.excess_premium,'0')) premium from position_master a,marine_data b, personal_info c where c.CUSTOMER_ID=a.CUSTOMER_ID and a.REMARKS in ('Admin','NORMAL_EXCESS_PRICE') and a.application_no=b.application_no and b.ADMIN_REFERRAL_STATUS='N' and a.product_id in (?) and a.status  in('Y','E')  and a.FREIGHT_STATUS is null and a.login_id in(select login_id from login_master where
GET_HOMEOCLIST_APPROVED=select to_char(a.entry_date,'YYYY-MM-DD') entery_date,count(a.entry_date) count_entery_date,sum(a.OVERALL_PREMIUM) PREMIUM  from home_position_master a where a.REMARKS='Admin' and a.status in('Y','E')  and a.product_id =? and a.login_id in(select login_id from login_master where
GET_OCLIST_REJECTED=select to_char(a.entry_date,'YYYY-MM-DD') entery_date,count(a.entry_date) count_entery_date from position_master a, personal_info c,marine_data b where c.CUSTOMER_ID\=a.CUSTOMER_ID and b.application_no\=a.application_no and a.status \= 'R' and a.product_id \=? and a.FREIGHT_STATUS is null and a.login_id in(select login_id from login_master where
GET_HOMEOCLIST_REJECTED=select to_char(a.entry_date,'YYYY-MM-DD') entery_date,count(a.EFFECTIVE_DATE) count_entery_date from home_position_master a where ADMIN_REFERRAL_STATUS='N' and a.status='R'  and a.product_id=?  and a.login_id in(select login_id from login_master where
GET_POLICIES_LIST=select pm.application_no,(select nvl(a.first_name,b.COMPANY_NAME) from personal_info a,broker_company_master b,login_master c where (a.login_id in(select login_id from login_master where oa_code in(select oa_code from login_master where login_id\=pm.login_id) and usertype\='Broker') or a.customer_login_id in(select login_id from login_master where oa_code in(select oa_code from login_master where login_id\=pm.login_id) and usertype\='Broker'))  and b.agency_code\=c.agency_code and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)))) broker_name,(select nvl(first_name,COMPANY_NAME) from personal_info where customer_id\=(select customer_id from position_master where application_no\=pm.application_no)) customer_name, pm.login_id,pm.quote_no,md.remarks,pm.application_id,PM.STATUS from position_master pm,marine_data md where to_char(pm.entry_date,'DD-MM-YYYY')\=? and pm.application_no\=md.application_no and pm.REMARKS in ('Admin','NORMAL_EXCESS_PRICE') and md.ADMIN_REFERRAL_STATUS\='N' and pm.product_id\=? and pm.status in('Y','E') and pm.FREIGHT_STATUS is null and pm.login_id in(select login_id from login_master where
GET_POLICIES_PENDING=select decode(pm.application_id,'1',pm.login_id,pm.application_id) quote_Created,pm.application_no,pm.login_id,pm.quote_no,md.remarks,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status, c.CUSTOMER_ID, c.CUST_NAME,d.COMPANY_NAME brokername from position_master pm,marine_data md, personal_info c, broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and to_char(pm.entry_date,'YYYY-MM-DD')=? and ((pm.REMARKS in ('Referal') and md.ADMIN_REFERRAL_STATUS='N') or (pm.REMARKS in ('Admin','Normal','NORMAL_EXCESS_PRICE') and md.ADMIN_REFERRAL_STATUS='Y')) and pm.status in ('Y','E') and pm.product_id in(?) and  pm.application_no=md.application_no and pm.FREIGHT_STATUS is null AND D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and pm.login_id in(select login_id from login_master where
GET_HOMEPOLICIES_PENDING=select distinct pm.application_no,pm.login_id,pm.quote_no,pm.remarks,pm.REFERRAL_DESCRIPTION,nvl(pm.SUMMARY_REMARKS,''),pm.scheme_id,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status,c.CUSTOMER_ID, nvl(c.FIRST_NAME,c.COMPANY_NAME) CUST_NAME,d.COMPANY_NAME brokername,pm.SCHEME_ID  from home_position_master pm, personal_info c,broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and to_char(pm.entry_date,'YYYY-MM-DD')=? and pm.product_id=? and pm.REMARKS='Referal'  and pm.status in('Y','E') and pm.login_id in(select login_id from login_master where
GET_POLICIES_APPROVED=select decode(pm.application_id,'1',pm.login_id,pm.application_id) quote_Created,pm.application_no,pm.login_id,pm.quote_no,md.remarks,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status, c.CUSTOMER_ID, c.CUST_NAME, d.COMPANY_NAME brokername from position_master pm,marine_data md, personal_info c,broker_company_master d  where c.CUSTOMER_ID=pm.CUSTOMER_ID and to_char(pm.entry_date,'YYYY-MM-DD')=? and pm.application_no=md.application_no and pm.REMARKS in ('Admin','NORMAL_EXCESS_PRICE') and md.ADMIN_REFERRAL_STATUS='N' and pm.product_id=? and pm.status in('Y','E') and pm.FREIGHT_STATUS is null AND D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and pm.login_id in(select login_id from login_master where
GET_HOMEPOLICIES_APPROVED=select distinct pm.application_no,pm.login_id,pm.quote_no,pm.remarks,pm.REFERRAL_DESCRIPTION,nvl(pm.SUMMARY_REMARKS,''),pm.scheme_id,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status,c.CUSTOMER_ID, nvl(c.FIRST_NAME,c.COMPANY_NAME) CUST_NAME,d.COMPANY_NAME brokername,pm.SCHEME_ID from home_position_master pm, personal_info c,broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and to_char(pm.entry_date,'YYYY-MM-DD')=? and pm.product_id=? and pm.REMARKS='Admin' and pm.status in ('Y','E') and pm.login_id in(select login_id from login_master where
GET_POLICIES_REJECTED=select decode(pm.application_id,'1',pm.login_id,pm.application_id) quote_Created,pm.application_no,pm.login_id,pm.quote_no,md.remarks,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status, c.CUSTOMER_ID,c.CUST_NAME, d.COMPANY_NAME brokername from position_master pm,marine_data md, personal_info c,broker_company_master d  where c.CUSTOMER_ID=pm.CUSTOMER_ID and to_char(pm.entry_date,'YYYY-MM-DD')=? and pm.application_no=md.application_no  and pm.product_id=? and pm.status='R' AND D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and pm.login_id in(select login_id from login_master where
GET_HOMEPOLICIES_REJECTED=select distinct pm.application_no,pm.login_id,pm.quote_no,PM.remarks,pm.REFERRAL_DESCRIPTION,nvl(pm.SUMMARY_REMARKS,''),pm.scheme_id,pm.application_id,DECODE(pm.STATUS,'E','Endt','Normal') status, c.CUSTOMER_ID,nvl(c.FIRST_NAME,c.COMPANY_NAME) CUST_NAME,d.COMPANY_NAME brokername,pm.SCHEME_ID  from home_position_master pm, personal_info c,broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and to_char(pm.entry_date,'YYYY-MM-DD')=? and pm.product_id=? and pm.ADMIN_REFERRAL_STATUS='N' and pm.status='R' and pm.login_id in(select login_id from login_master where
SUBSTRING_REFERAL_1=oa_code in(select agency_code from broker_company_master where branch_code in({0}))) and  (Select attached_uw from login_master Where login_id=?) like  '',%'' || b.UWGRADE || '',%'' group by TO_CHAR(a.entry_date,''YYYY-MM-DD'') order by TO_CHAR(a.entry_date,''YYYY-MM-DD'') desc
SUBSTRING_REFERAL_2= oa_code=? and (Select attached_uw from login_master Where login_id=?) like  '',%'' || b.UWGRADE || '',%'') group by TO_CHAR(a.entry_date,''YYYY-MM-DD'') order by TO_CHAR(a.entry_date,''YYYY-MM-DD'') desc
SUBSTRING_REFERAL_3= oa_code in(select agency_code from broker_company_master where branch_code in({0})))  group by  TO_CHAR(a.entry_date,''YYYY-MM-DD'') order by  TO_CHAR(a.entry_date,''YYYY-MM-DD'') desc
SUBSTRING_REFERAL_4= oa_code=? group by TO_CHAR(a.entry_date,'YYYY-MM-DD')  order by  TO_CHAR(a.entry_date,''YYYY-MM-DD'')  desc
SUBSTRING_REFERAL_5= oa_code in(select agency_code from broker_company_master where branch_code in({0}))) and  (Select attached_uw from login_master Where login_id\=?) like  '',%'' || md.UWGRADE || '',%''  order by quote_no desc  
SUBSTRING_REFERAL_6= oa_code\=? and (Select attached_uw from login_master Where login_id\=?) like  '',%'' || b.UWGRADE || '',%'')   order by quote_no desc 
SUBSTRING_REFERAL_7= oa_code in(select agency_code from broker_company_master where branch_code in({0})))   order by quote_no desc
SUBSTRING_REFERAL_8= oa_code\=?  order by quote_no desc  

#Open Cover
GET_QUOTE_REGISTER_LIST=select distinct(a.proposal_no),nvl(a.open_cover_no,'0'),nvl(to_char(b.policy_start_date,'DD/MM/YYYY'),' ') start_date,nvl(to_char(b.policy_end_date,'DD/MM/YYYY'),' ') end_date,nvl(first_name,company_name) cust_name,RENEWAL_STATUS,b.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_master b,personal_info c where a.status='Y' and a.original_policy_no is null and a.proposal_no = b.proposal_no and b.amend_id = (select max(amend_id) from open_cover_master b where b.proposal_no = a.proposal_no) and a.proposal_no in (select proposal_no from open_cover_master where broker_id=?) and c.customer_id =b.customer_id order by a.proposal_no desc
GET_PORTFOLIO_LIST=select to_char(a.entry_date,'DD/MM/YYYY')ENTRY_DATE,count(a.entry_date)as COU from position_master a,marine_data b,personal_info c where  a.entry_date between to_date(?,'DD/MM/YYYY') and to_date(?,'DD/MM/YYYY') and a.remarks in (?) and (b.ADMIN_REFERRAL_STATUS in(?) or b.ADMIN_REFERRAL_STATUS is null) and a.customer_id\=c.customer_id and a.application_no\=b.application_no  and  a.product_id in (11,3) and lower(a.status) in(?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)))  group by to_char(a.entry_date,'DD/MM/YYYY') order by to_char(a.entry_date,'DD/MM/YYYY') desc
GET_LCDETAIL_LIST=select A.OPEN_COVER_NO, A.BANK_ID,(SELECT DISTINCT(BANK_NAME) FROM OPEN_COVER_BANK_MASTER WHERE A.BANK_ID=BANK_ID AND STATUS='Y') bank_name, A.LC_NUMBER, TO_CHAR(A.LC_DATE,'DD/MM/YYYY') LC_DATE, A.LC_AMOUNT, TO_CHAR(A.ENTRY_DATE,'DD/MM/YYYY') ENTRY_DATE, TO_CHAR(A.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE, TO_CHAR(A.EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE, A.AMEND_ID, A.REMARKS, A.STATUS, A.LC_ID, A.LC_CURRENCY_ID, (select currency_name from currency_master where currency_id=A.LC_CURRENCY_ID and status='Y' and amend_id=(select max(amend_id) from currency_master where currency_id=A.LC_CURRENCY_ID and COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and status='Y')) currency_name from OPEN_COVER_LC_MASTER A where  A.OPEN_COVER_NO=? and A.LC_NUMBER not in ('None','NONE')
GET_UNDERWRITER_LIST=select login_id, username from login_master where usertype = 'RSAIssuer' and status = 'Y' and branch_code=?

#REPORTS
GET_COMMODITY_LIST=select commodity_name, commodity_id  from commoditymaster cm where cm.status in ('Y','R') and cm.branch_code=? and cm.amend_id||'-'||cm.commodity_id in(select max(amend_id)||'-'||commodity_id from commoditymaster where to_date(effective_date,'dd/mm/yyyy') <=to_date(SYSDATE,'dd/mm/yyyy') and status in ('Y','R') and branch_code=? group by commodity_id) order by cm.commodity_id
GET_TRANSPORT_MODE_LIST=select transport_description, mode_transport_id from mode_of_transport where status = 'Y' and branch_code=?
GET_COVER_LIST=select cover_id,cover_name,mode_transport_id from cover_master where status = 'Y' and branch_code=? and mode_transport_id in(select mode_transport_id from mode_of_transport where status = 'Y' and branch_code=?)

#LC Master New 
GET_LCNUMBER_OC_COUNT=select * from (select count(oclm.LC_NUMBER) lc_number_count,pi.login_id from BROKER_COMPANY_MASTER bcm,personal_info pi,OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm,OPEN_COVER_LC_MASTER oclm where bcm.agency_code=pi.agency_code and pi.APPLICATION_ID='2' and oclm.LC_NUMBER!='NONE' and ocm.broker_id=pi.login_id and ocm.proposal_no=ocpm.proposal_no and ocpm.STATUS not in('Y') and bcm.branch_code=? and oclm.open_cover_no=ocpm.open_cover_no and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no group by ocms.proposal_no) group by pi.login_id) a right outer join (select count(distinct(ocpm.open_cover_no)) open_cover_count, bcm.company_name,pi.login_id login_id_1 from BROKER_COMPANY_MASTER bcm,personal_info pi,OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm,OPEN_COVER_LC_MASTER oclm where bcm.agency_code=pi.agency_code and pi.APPLICATION_ID='2' and ocm.broker_id=pi.login_id and ocm.proposal_no=ocpm.proposal_no and ocpm.STATUS not in('Y') and bcm.branch_code=? and oclm.open_cover_no=ocpm.open_cover_no and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no group by ocms.proposal_no) group by bcm.company_name,pi.login_id ) b on a.login_id=b.login_id_1
GET_LCDETAILS_LIST=SELECT distinct(ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd/MM/YYYY') inception_date, TO_CHAR (ocpm.expiry_date, 'dd/MM/YYYY') expiry_date, NVL (pi.COMPANY_NAME, pi.first_name)||ocm.broker_id cust_name, ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, NVL (OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) FROM BROKER_COMPANY_MASTER bcm, personal_info pi, OPEN_COVER_MASTER ocm, OPEN_COVER_POSITION_MASTER ocpm, OPEN_COVER_LC_MASTER oclm WHERE ocm.broker_id IN (?) and oclm.LC_NUMBER!='NONE' and bcm.agency_code = pi.agency_code AND pi.APPLICATION_ID = '2' AND ocm.broker_id = pi.login_id AND ocm.proposal_no = ocpm.proposal_no AND ocpm.STATUS NOT IN ('Y') AND bcm.branch_code =? AND oclm.open_cover_no = ocpm.open_cover_no AND ocm.amend_id || '-' || ocm.proposal_no IN ( SELECT MAX (ocms.amend_id) || '-' || ocms.proposal_no FROM open_cover_master ocms, open_cover_position_master ocpms WHERE ocpms.proposal_no = ocms.proposal_no GROUP BY ocms.proposal_no)
GET_OCDETAILS_LIST=SELECT distinct(ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd/MM/YYYY') inception_date, TO_CHAR (ocpm.expiry_date, 'dd/MM/YYYY') expiry_date, NVL (pi.COMPANY_NAME, pi.first_name)||ocm.broker_id cust_name, ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, NVL (OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) FROM BROKER_COMPANY_MASTER bcm, personal_info pi, OPEN_COVER_MASTER ocm, OPEN_COVER_POSITION_MASTER ocpm, OPEN_COVER_LC_MASTER oclm WHERE ocm.broker_id IN (?) and bcm.agency_code = pi.agency_code AND pi.APPLICATION_ID = '2' AND ocm.broker_id = pi.login_id AND ocm.proposal_no = ocpm.proposal_no AND ocpm.STATUS NOT IN ('Y') AND bcm.branch_code = ? AND oclm.open_cover_no = ocpm.open_cover_no AND ocm.amend_id || '-' || ocm.proposal_no IN ( SELECT MAX (ocms.amend_id) || '-' || ocms.proposal_no FROM open_cover_master ocms, open_cover_position_master ocpms WHERE ocpms.proposal_no = ocms.proposal_no GROUP BY ocms.proposal_no) order by inception_date desc
GET_LCOC_DETAILS_LIST=select A.OPEN_COVER_NO,round(((SELECT EXCHANGE_RATE  FROM exchange_master em WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND em.country_id = (select country_id from branch_master where branch_code=?) AND amend_id = (SELECT MAX (amend_id) FROM exchange_master em1 WHERE currency_id = A.LC_CURRENCY_ID and em1.country_id=em.country_id))*A.LC_AMOUNT)-A.LC_BALANCE_AMOUNT) used_amt,round(((SELECT EXCHANGE_RATE  FROM exchange_master em WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND em.country_id = (select country_id from branch_master where branch_code=?) AND amend_id = (SELECT MAX (amend_id) FROM exchange_master em1 WHERE currency_id = A.LC_CURRENCY_ID and em1.country_id=em.country_id))*A.LC_AMOUNT)) ACTUAL_AMT, A.BANK_ID,(SELECT DISTINCT (BANK_NAME) FROM   OPEN_COVER_BANK_MASTER WHERE   A.BANK_ID = BANK_ID AND STATUS = 'Y') bank_name,A.LC_NUMBER,to_char(A.LC_DATE,'dd/mm/yyyy') LC_DATE,A.LC_AMOUNT,A.ENTRY_DATE,to_char(A.EXPIRY_DATE,'dd/mm/yyyy') EXPIRY_DATE,A.EFFECTIVE_DATE,A.AMEND_ID,A.REMARKS,A.STATUS,A.LC_ID,A.LC_CURRENCY_ID, A.LC_BALANCE_AMOUNT, (SELECT currency_name FROM currency_master cm WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND COUNTRY_ID = (SELECT   ORIGINATION_COUNTRY_ID FROM   BRANCH_MASTER WHERE   BRANCH_CODE =?)  AND amend_id = (SELECT MAX (amend_id) FROM currency_master cm1 WHERE currency_id = A.LC_CURRENCY_ID AND cm1.COUNTRY_ID =cm.COUNTRY_ID AND status = 'Y'))currency_name from OPEN_COVER_LC_MASTER A  where  A.OPEN_COVER_NO=? and A.LC_NUMBER not in ('None','NONE')
GET_Bank_List=select bank_id,bank_name,amend_id from open_cover_bank_master where amend_id||'-'||bank_id in (select max(amend_id)||'-'||bank_id from open_cover_bank_master where to_date(effective_date,'dd-mm-yyyy')<=to_date(SYSDATE,'dd-mm-yyyy') and status in('N','Y') and BELONGING_COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) group by bank_id) and BELONGING_COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and status='Y' and bank_id not in ('99999') order by bank_name
GET_SALE_LIST=select sale_term_id, sale_term_name from sale_term_master where status='Y' and BRANCH_CODE=? order by sale_term_name
GET_CURRENCY_LIST=select distinct(b.currency_id),b.currency_name,a.amend_id,a.effective_date,a.exchange_rate from exchange_master a, currency_master b where a.COUNTRY_ID=b.COUNTRY_ID and b.COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and a.currency_id=b.currency_id and a.amend_id||a.exchange_id||a.currency_id in(select max(amend_id)||exchange_id||currency_id from exchange_master where effective_date <=SYSDATE and status='Y' and COUNTRY_ID=b.COUNTRY_ID group by exchange_id,currency_id)  and a.effective_date <=SYSDATE and a.status='Y' and b.status='Y' and b.status='Y' and a.status='Y' order by currency_name
INS_LCNEW_VALUE=insert into open_cover_lc_master (lc_number,lc_amount,bank_id,AMEND_ID,LC_DATE,EFFECTIVE_DATE,ENTRY_DATE,Expiry_DATE,REMARKS,STATUS,open_cover_no,lc_id,lc_currency_id,LC_BALANCE_AMOUNT,LC_ACTUAL_AMOUNT,LC_SALE_TERM_ID) values(?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),SYSDATE,SYSDATE,TO_DATE(?,'DD/MM/YYYY'),?,?,?,(select nvl(max(lc_id),'0')+1 lc_id from open_cover_lc_master where open_cover_No=? and LC_ID!='99999'),?,?,?,?)
UPD_LCNEW_VALUE= update open_cover_lc_master set lc_amount=?,bank_id=?,AMEND_ID=?,LC_DATE=TO_DATE(?,'DD/MM/YYYY'),EXPIRY_DATE=TO_DATE(?,'DD/MM/YYYY'),EFFECTIVE_DATE=SYSDATE,ENTRY_DATE=SYSDATE,lc_currency_id=?,status=?,LC_BALANCE_AMOUNT=?,LC_ACTUAL_AMOUNT=?,LC_SALE_TERM_ID=? where open_cover_NO=? and lc_number=? and lc_id=?
GET_EXCHANGE_RATE=select nvl(exchange_rate,'0') from exchange_master where currency_id=? and status='Y' and COUNTRY_ID=? and amend_id=(select max(amend_id) from exchange_master where currency_id=? and status='Y' and COUNTRY_ID=?)
GET_COUNTRY_ID=select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE\=?
GET_LCINFO_LIST=select lc_number,lc_amount,bank_id, to_char(LC_DATE,'DD/MM/YYYY') LC_DATE, to_char(Expiry_DATE,'DD/MM/YYYY') Expiry_DATE, lc_id, lc_currency_id, LC_SALE_TERM_ID, status,LC_ACTUAL_AMOUNT from open_cover_lc_master where open_cover_No=? and lc_id=? and lc_number=?
DEL_LC_NUMBER=delete from OPEN_COVER_LC_MASTER where OPEN_COVER_NO\=? and lc_number\=? and LC_ID\=?
 

##Admin Management
GET_MENU_LIST=select A.CATEGORY_DETAIL_ID, A.DETAIL_NAME, A.REMARKS, A.STATUS, DECODE(STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS1, (select DETAIL_NAME from CONSTANT_DETAIL where A.PARENT_MENU= to_char(CATEGORY_DETAIL_ID) AND CATEGORY_ID='41' and BRANCH_CODE=A.BRANCH_CODE) PARENT_MENU_NAME, PARENT_MENU from CONSTANT_DETAIL A where CATEGORY_ID='41' and BRANCH_CODE=?
GET_UTYPE_LIST=select category_detail_id,detail_name from constant_detail where category_id=40 and status='Y' and branch_code=? and remarks=?
GET_ADMIN_LIST=select a.LOGIN_ID, a.USERNAME, a.USERID,userType, a.BRANCH_CODE, (select BRANCH_NAME from branch_master where a.BRANCH_CODE=BRANCH_CODE) branch_name , STATUS, DECODE(STATUS,'Y','Active','N','DeActive','D','Delete','L','Locked') STATUS1, TRIM(A.PRODUCT_ID) PRODUCT_ID, a.MENU_ID, a.BROKER_CODES, a.USER_MAIL,a.ATTACHED_UW ATTACHED_UW,a.ATTACHED_BRANCH ATTACHED_BRANCH from LOGIN_MASTER a where a.USERID in('2','4') and a.BRANCH_CODE=?
INS_NEW_MENU=INSERT INTO menu_master(menu_id, menu_NAME, menu_url, STATUS, RSACODE, BRANCH_CODE, PARENT_MENU) VALUES ((select max(menu_id)+1 from menu_master where BRANCH_CODE=?), ?, ?, ?, (select max(menu_ID)+1 from menu_master where BRANCH_CODE=?), ?, ?)
UPD_EXIST_MENU=UPDATE menu_master SET menu_NAME=?, menu_url=?, STATUS=?, PARENT_MENU=? WHERE menu_ID=? AND BRANCH_CODE=?
INS_NEW_ADMIN_USER=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION, ACCESSTYPE,PASSDATE,BRANCH_CODE,COUNTRY_ID,MENU_ID,PRODUCT_ID,broker_codes, APP_ID, PWD_COUNT, USER_MAIL,ATTACHED_UW,ATTACHED_BRANCH,ENTRY_DATE) values (?,?,?,?,'2',?,?,?,?,?,?,?,?,sysdate+45,?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE\=?),?,?,?,'16','0',?,?,?,get)
UPD_EXIST_ADMIN_USER=update login_master set USERNAME=?, USERTYPE=?, USERID=?, STATUS=?, PASSDATE=SYSDATE+45, MENU_ID=?, PRODUCT_ID=?, USER_MAIL=?, broker_codes=?,ATTACHED_UW=?,ATTACHED_BRANCH=? where LOGIN_ID=?
UPD_EXIST_ADMIN_USER_PWD=update login_master set USERNAME=?, PASSWORD=?, USERTYPE=? , USERID=?, STATUS=?, PASSDATE=SYSDATE+45, MENU_ID=?, PRODUCT_ID=?, USER_MAIL=?, broker_codes=?,ATTACHED_UW=?,ATTACHED_BRANCH=? where LOGIN_ID=?
GET_BRANCH_NAME=SELECT DISTINCT(BRANCH_NAME) FROM BRANCH_MASTER WHERE BRANCH_CODE\=?
GET_PRODUCT_LIST=select PRODUCT_ID,PRODUCT_NAME from product_master where PRODUCT_ID in (?)

#RatingEngine
Check_mode_of_transport=select distinct(RSACODE) from mode_of_transport where RSACODE=? and BRANCH_CODE=?
GET_TRANSPORT_MODE=select transport_description,RSACODE,DISPLAY_ORDER,MODE_TRANSPORT_ID,STATUS from mode_of_transport where branch_code=? and MODE_TRANSPORT_ID=?
UPDATE_MODE_OF_TRANSPORT=update MODE_OF_TRANSPORT set transport_description=?,DISPLAY_ORDER=?,RSACODE=?,STATUS=? where MODE_TRANSPORT_ID=? and BRANCH_CODE=?
INS_MODE_OF_TRANSPORT=insert into MODE_OF_TRANSPORT (SNO__,MODE_TRANSPORT_ID,TRANSPORT_DESCRIPTION,RSACODE,STATUS,DISPLAY_ORDER,BRANCH_CODE) values((select NVL(MAX(SNO__),0)+1 from MODE_OF_TRANSPORT),(SELECT NVL(MAX(MODE_TRANSPORT_ID),0)+1 from MODE_OF_TRANSPORT where BRANCH_CODE=?),?,?,?,?,?)
INS_ERROR_MASTER=insert into ERROR_MASTER values((select MAX(ERROR_ID)+1 from ERROR_MASTER),?,?,?,?,?)
GET_STATE_LIST=select STAGE_ID,STAGE_DESC from STAGE_MASTER where PRODUCT=?
INS_CONVEYAN_MASTER=INSERT INTO CONVEYAN_MASTER (SNO,CONV_MEAN,CONVCD,CONVDESC,CONV_RATE, MODE_TRANSPORT_ID,EFFECTIVE_DATE,AMEND_ID,BRANCH_CODE,CORE_APP_ID,REMARKS,STATUS) VALUES ((select MAX(SNO)+1 from CONVEYAN_MASTER),(select MAX(CONV_MEAN)+1 from CONVEYAN_MASTER where BRANCH_CODE=?),(select SUBSTR((select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT where MODE_TRANSPORT_ID=? and BRANCH_CODE=?),1,1) from dual),?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?)
GET_CONVEYAN_MASTER=select  CONV_MEAN,CONVDESC from CONVEYAN_MASTER where AMEND_ID||CONV_MEAN  in (select max(AMEND_ID)||CONV_MEAN from CONVEYAN_MASTER where branch_code = ?  group by CONV_MEAN ) AND branch_code = ? order by CONVDESC
EDIT_CONVEYAN_MASTER=SELECT SNO,CONVDESC,MODE_TRANSPORT_ID,CONV_RATE,REMARKS,CORE_APP_ID,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,STATUS FROM CONVEYAN_MASTER CM WHERE BRANCH_CODE=? AND CONV_MEAN=? AND MODE_TRANSPORT_ID=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER C WHERE   C.BRANCH_CODE=CM.BRANCH_CODE AND C.CONV_MEAN=CM.CONV_MEAN AND C.MODE_TRANSPORT_ID=CM.MODE_TRANSPORT_ID)
UPDATE_CONVEYAN_MASTER=INSERT INTO CONVEYAN_MASTER (SNO, CONV_MEAN, CONVCD,CONVDESC, CONV_RATE, MODE_TRANSPORT_ID,EFFECTIVE_DATE, AMEND_ID, BRANCH_CODE, CORE_APP_ID, REMARKS, STATUS) VALUES ((select MAX(SNO)+1 from CONVEYAN_MASTER),?,(select SUBSTR((select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT where MODE_TRANSPORT_ID=? and BRANCH_CODE=?),1,1) from dual),?,?,?,TO_DATE(?,'DD/MM/YYYY'),(select (MAX(AMEND_ID)+1)from CONVEYAN_MASTER where BRANCH_CODE=? and SNO=?),?,?,?,?)
#####(10-06-2016)#####INS_COUNTRY_MASTER=insert into country_master values((select MAX(SNO__)+1 from country_master),(select MAX(COUNTRY_ID)+1 from country_master),?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?)
INS_COUNTRY_MASTER = INSERT INTO country_master (SNO__,COUNTRY_ID,COUNTRY_NAME,COUNTRY_SHORT_NAME,STATUS,RSACODE,NATIONALITY_NAME,AMEND_ID,EFFECTIVE_DATE,GEO_RATE,REMARKS,BRANCH_CODE) VALUES((SELECT MAX(SNO__)+1 FROM country_master),(SELECT MAX(COUNTRY_ID)+1 FROM country_master),?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?)
EDIT_COUNTRY_MASTER=select E.COUNTRY_NAME,E.COUNTRY_SHORT_NAME,E.NATIONALITY_NAME,E.GEO_RATE,E.REMARKS,E.RSACODE,E.AMEND_ID,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,E.STATUS from COUNTRY_MASTER E where E.COUNTRY_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID=E.COUNTRY_ID)
UPDATE_COUNTRY_MASTER=insert into country_master (SNO__, COUNTRY_ID , COUNTRY_NAME , COUNTRY_SHORT_NAME,STATUS, RSACODE, NATIONALITY_NAME, AMEND_ID , EFFECTIVE_DATE, GEO_RATE, REMARKS, INT_PORT_CODE,BRANCH_CODE) values((select MAX(SNO__)+1 from country_master),?,?,?,?,?,?,(select MAX(AMEND_ID)+1 from COUNTRY_MASTER where COUNTRY_ID=?),TO_DATE(?,'DD/MM/YYYY'),?,?,(select distinct(INT_PORT_CODE) from COUNTRY_MASTER cm where COUNTRY_ID=? and cm.amend_id=((select MAX(AMEND_ID) from COUNTRY_MASTER c where cm.COUNTRY_ID=c.country_id))),?)
INS_BANK_MASTER=insert into OPEN_COVER_BANK_MASTER values((SELECT   MAX (to_number(BANK_ID)) + 1 FROM OPEN_COVER_BANK_MASTER Where Bank_id !='99999'),?,'','',TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?)
GET_BANK=SELECT BANK_ID,BANK_NAME FROM OPEN_COVER_BANK_MASTER 
Check_name_Bank=select count(BANK_NAME) from OPEN_COVER_BANK_MASTER where upper(BANK_NAME)=upper(?) and BELONGING_COUNTRY_ID=?
EDIT_BANK_MASTER=select BANK_NAME,BELONGING_COUNTRY_ID,REMARKS,RSACODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,STATUS from OPEN_COVER_BANK_MASTER E where BANK_ID=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE BANK_ID=E.BANK_ID) AND BELONGING_COUNTRY_ID=(SELECT BELONGING_BRANCH  from branch_master where branch_code=?)
UPDATE_BANK_MASTER=insert into OPEN_COVER_BANK_MASTER values(?,?,'','',TO_DATE(?,'DD/MM/YYYY'),(select MAX(AMEND_ID)+1 from OPEN_COVER_BANK_MASTER where BANK_ID=?),?,?,?,?)
GET_PACKAGE_LIST = SELECT PM.PACKAGE_ID, PM.PACKAGE_DESC, PM.PERCENTRATE, PM.MODE_TRANSPORT_ID, MT.TRANSPORT_DESCRIPTION MODE_TRANSPORT, (case PM.status when 'Y' then 'Active' when 'N' then 'DeActive' end) STATUS FROM PACKAGE_MASTER PM,MODE_OF_TRANSPORT MT  WHERE PM.BRANCH_CODE=? AND MT.MODE_TRANSPORT_ID=PM.MODE_TRANSPORT_ID
EDIT_PACKAGE_MASTER = SELECT PACKAGE_ID, PACKAGE_DESC, MODE_TRANSPORT_ID, PERCENTRATE, STATUS, REMARKS FROM PACKAGE_MASTER WHERE PACKAGE_ID= ? AND MODE_TRANSPORT_ID=? AND BRANCH_CODE=?
INS_PACKAGE_MASTER = INSERT INTO PACKAGE_MASTER(SNO,    PACKAGE_ID,    PACKAGE_DESC,    PERCENTRATE,    MODE_TRANSPORT_ID,    RSACODE,    BRANCH_CODE,    STATUS,    REMARKS) VALUES((SELECT NVL(MAX(SNO),0)+1 FROM PACKAGE_MASTER), (SELECT NVL(MAX(PACKAGE_ID),0)+1 FROM PACKAGE_MASTER WHERE MODE_TRANSPORT_ID=?), ?,?,?,'',?,?,?)
UPDATE_PACKAGE_MASTER = UPDATE PACKAGE_MASTER SET PACKAGE_DESC = ?, PERCENTRATE = ?, STATUS= ?, REMARKS = ? WHERE PACKAGE_ID=? AND MODE_TRANSPORT_ID = ? AND BRANCH_CODE=?
GET_BRANCH=select branch_code,BRANCH_NAME from branch_master where status='Y' order by BRANCH_NAME
GET_MATERIAL=SELECT MM.MATERIAL_ID,MM.MM.MATERIAL_DESC FROM MATERIAL_TYPE_MASTER MM WHERE BRANCH_CODE = ? AND MM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_DESC=MM.MATERIAL_DESC)
INS_MATERIAL_TYPE_MASTER=insert into MATERIAL_TYPE_MASTER values((select MAX(SNO)+1 from MATERIAL_TYPE_MASTER),(select MAX(MATERIAL_ID)+1 from MATERIAL_TYPE_MASTER where BRANCH_CODE=?),?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?)
EDIT_MATERIAL_TYPE_MASTER=SELECT   MM.MATERIAL_DESC, MM.MATERIAL_RATE, MM.MATERIAL_ID, MM.REMARKS, MM.CORE_APP_ID, TO_CHAR (MM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, MM.STATUS FROM   MATERIAL_TYPE_MASTER MM WHERE   MM.BRANCH_CODE \=? AND MATERIAL_ID \=? and mm.cover_id\=? AND MM.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MATERIAL_TYPE_MASTER WHERE   BRANCH_CODE \= MM.BRANCH_CODE AND MATERIAL_ID \= MM.MATERIAL_ID AND COVER_ID\=MM.COVER_ID) 
UPDATE_MATERIAL_TYPE_MASTER=insert into MATERIAL_TYPE_MASTER (  SNO,MATERIAL_ID ,COVER_ID, MATERIAL_DESC,MATERIAL_RATE,EFFECTIVE_DATE,AMEND_ID,BRANCH_CODE,CORE_APP_ID,STATUS, REMARKS ) values( ( select MAX(SNO)+1 from  MATERIAL_TYPE_MASTER where BRANCH_CODE=? ),?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),(select max(AMEND_ID)+1 from MATERIAL_TYPE_MASTER where BRANCH_CODE=? and MATERIAL_ID=? ),?,?,?,?)
INS_WAR_RATE_MASTER=insert into WAR_RATE_MASTER (SNO, WAR_ID, WAR_DESC, WAR_RATE, MODE_TRANSPORT_ID, EFFECTIVE_DATE, AMEND_ID, BRANCH_CODE, CORE_APP_ID,STATUS, REMARKS) values((select NVL(MAX(SNO),0)+1 from WAR_RATE_MASTER),( select NVL(MAX(WAR_ID),0)+1  from WAR_RATE_MASTER  where BRANCH_CODE=?),?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?)
GET_WAR_RATE=select WAR_ID,WAR_DESC from WAR_RATE_MASTER MM WHERE BRANCH_CODE = ? AND AMEND_ID =  (SELECT MAX(AMEND_ID) FROM WAR_RATE_MASTER MTM WHERE BRANCH_CODE = ? AND MTM.WAR_ID = MM.WAR_ID)
EDIT_WAR_RATE_MASTER=select MODE_TRANSPORT_ID,WAR_DESC,WAR_RATE,REMARKS,CORE_APP_ID,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,STATUS from WAR_RATE_MASTER  WW where BRANCH_CODE=? and WAR_ID=? AND AMEND_ID= ( SELECT MAX(AMEND_ID) FROM WAR_RATE_MASTER WR WHERE  WR.BRANCH_CODE=WW.BRANCH_CODE AND WR.WAR_ID=WW.WAR_ID)
UPDATE_WAR_RATE_MASTER=update WAR_RATE_MASTER w set WAR_DESC=?,MODE_TRANSPORT_ID=?,WAR_RATE=?,REMARKS=?,EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),CORE_APP_ID=?,STATUS=? where branch_code=? and WAR_ID=? and amend_id=(select max(amend_id) from war_rate_master where war_id=w.war_id)
GET_EXECUTIVE_MASTER = Select AC_EXECUTIVE_ID,Ac_Executive_Name,Lef.Oa_Code,Lef.Product_Id, Pm.Product_Name,To_Char(Lef.Effective_Date, 'DD/MM/YYYY')Effective_Date, Decode(Lef.Status,'Y','Active','N','DeActive')Status From Login_Executive_Details Lef,Product_Master Pm Where Lef.Product_Id=Pm.Product_Id and Pm.branch_code = ?  
EDIT_EXECUTIVE_MASTER=select AC_EXECUTIVE_NAME, OA_CODE, PRODUCT_ID, To_Char(Effective_Date, 'DD/MM/YYYY')EFFECTIVE_DATE, ENTRY_DATE,STATUS, REMARKS,COMMISSION,OPENCOVER_COMMISSION from LOGIN_EXECUTIVE_DETAILS LED where AC_EXECUTIVE_ID=?
COUNT_OTHERPARTYMASTER=select count(*)  from login_executive_details where OA_CODE\=?
UPDATE_INTO_EXECUTIVE_MASTER = update LOGIN_EXECUTIVE_DETAILS set AC_EXECUTIVE_NAME\=?,OA_CODE\=?,EFFECTIVE_DATE\=TO_DATE(?, 'DD/MM/YYYY'),STATUS\=?,REMARKS\=?,COMMISSION\=?,OPENCOVER_COMMISSION\=? where AC_EXECUTIVE_ID\=?
INSERT_INTO_EXECUTIVE_MASTER=Insert into LOGIN_EXECUTIVE_DETAILS(AC_EXECUTIVE_ID, AC_EXECUTIVE_NAME,OA_CODE, PRODUCT_ID, AMEND_ID,EFFECTIVE_DATE, ENTRY_DATE,STATUS, REMARKS, COMPANY_ID,COMMISSION,OPENCOVER_COMMISSION) Values((select max(AC_EXECUTIVE_ID)+1 from LOGIN_EXECUTIVE_DETAILS), ?, ?,3,0,TO_DATE(?,'DD/MM/YYYY'),Sysdate,?,?,'213',?,?)
GET_SALE_TERM=select stm.sale_term_id,stm.sale_term_name from sale_term_master stm where stm.branch_code=?
GET_TRANSPORT_LIST=select MODE_TRANSPORT_ID,TRANSPORT_DESCRIPTION,RSACODE,DECODE(STATUS,'Y','Active','N','DeActive') STATUS from MODE_OF_TRANSPORT where BRANCH_CODE=?
GET_TRANSPORT_LIST_BY_NAME=select MODE_TRANSPORT_ID,TRANSPORT_DESCRIPTION,RSACODE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from MODE_OF_TRANSPORT where BRANCH_CODE\=? and lower(TRANSPORT_DESCRIPTION) like lower(('%'||?||'%')) order by lower(TRANSPORT_DESCRIPTION)
GET_CONVEYAN_MASTER_LIST=select E.MODE_TRANSPORT_ID,MT.TRANSPORT_DESCRIPTION,E.CONV_MEAN,E.CONVDESC,E.CONV_RATE,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive','R','Referral')STATUS from CONVEYAN_MASTER E,mode_of_transport MT where E.BRANCH_CODE\=? and MT.BRANCH_CODE\= E.BRANCH_CODE and E.MODE_TRANSPORT_ID\=MT.MODE_TRANSPORT_ID AND E.branch_code\=MT.branch_code AND E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN\=E.CONV_MEAN and BRANCH_CODE\=E.BRANCH_CODE) 
GET_CONVEYAN_LIST_BY_NAME=select E.MODE_TRANSPORT_ID,E.CONV_MEAN,E.CONVDESC,E.CONV_RATE,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS from CONVEYAN_MASTER E where BRANCH_CODE\=? AND E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONVDESC\=E.CONVDESC )and lower(E.CONVDESC) like lower(('%'||?||'%')) 
GET_CONVEYAN_MODE_LIST=select E.MODE_TRANSPORT_ID,E.CONV_MEAN,E.CONVDESC,E.CONV_RATE,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS,AMEND_ID from CONVEYAN_MASTER E where BRANCH_CODE=? AND E.MODE_TRANSPORT_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONVDESC=E.CONVDESC)
Check_convey=select count(CORE_APP_ID) from CONVEYAN_MASTER where CORE_APP_ID=? and BRANCH_CODE=? and MODE_TRANSPORT_ID=?
GET_Country_List=select E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','Deactive','R','Refferal')STATUS  from COUNTRY_MASTER E WHERE BRANCH_CODE=? AND  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME) order by COUNTRY_NAME
GET_COUNTRY_LIST=select E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','Deactive','R','Refferal')STATUS  from COUNTRY_MASTER E WHERE BRANCH_CODE=? AND  E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID\=E.COUNTRY_ID) 
GET_COUNTRYLIST=select E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','Deactive','R','Refferal')STATUS  from COUNTRY_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME)
GET_COUNTRY_LIST_BY_NAME=select E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','Deactive','R','Refferal')STATUS  from COUNTRY_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME) and lower(E.COUNTRY_NAME) like lower(('%'||?||'%')) order by E.COUNTRY_NAME
Check_name_Country=select count(COUNTRY_NAME) from COUNTRY_MASTER where upper(COUNTRY_NAME)=upper(?)
Check_Country= select distinct(RSACODE) from COUNTRY_MASTER where RSACODE\=? 
GET_BANK_LIST=select E.BANK_ID,E.BANK_NAME,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS from OPEN_COVER_BANK_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME=E.BANK_NAME) order by BANK_NAME
GET_BANKLIST=select E.BANK_ID,E.BANK_NAME,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS from OPEN_COVER_BANK_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE BANK_ID=E.BANK_ID)
GET_BANK_LIST_BY_NAME=select E.BANK_ID,E.BANK_NAME,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS from OPEN_COVER_BANK_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME=E.BANK_NAME) and lower(E.BANK_NAME) like lower(('%'||?||'%')) order by E.BANK_NAME
Check_Bank= select distinct(RSACODE) from OPEN_COVER_BANK_MASTER where RSACODE=?
GET_MATERIAL_LIST_BY_NAME=SELECT E.MATERIAL_ID,E.MATERIAL_DESC,E.MATERIAL_RATE,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS FROM material_type_master E WHERE E.BRANCH_CODE=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM material_type_master WHERE MATERIAL_DESC=E.MATERIAL_DESC )and  lower(E.material_desc) like lower('%'||?||'%') order by E.material_desc
GET_MATERIAL_MASTER_LIST=SELECT   E.MATERIAL_ID, E.MATERIAL_DESC, E.MATERIAL_RATE, E.COVER_ID, (SELECT CM.COVER_NAME FROM COVER_MASTER CM WHERE CM.COVER_ID=E.COVER_ID AND CM.BRANCH_CODE=E.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER CM1 WHERE CM1.COVER_ID=CM.COVER_ID AND CM1.BRANCH_CODE=CM.BRANCH_CODE ) )COVER_NAME, TO_CHAR (E.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, DECODE (E.STATUS, 'Y', 'Active', 'N', 'DeActive') STATUS FROM   material_type_master E WHERE   E.BRANCH_CODE = ? AND E.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   material_type_master WHERE   MATERIAL_ID = E.MATERIAL_ID AND BRANCH_CODE = E.BRANCH_CODE and COVER_ID=E.COVER_ID)
Check_name_material=select count(MATERIAL_DESC) from MATERIAL_TYPE_MASTER where upper(MATERIAL_DESC)\=upper(?) and BRANCH_CODE\=?
Check_material=select count(CORE_APP_ID) from MATERIAL_TYPE_MASTER where CORE_APP_ID=? and BRANCH_CODE=?
GET_WARRATE_LIST=select w.branch_code,w.amend_id,w.war_id,w.war_desc,w.war_rate,to_char(w.effective_date,'DD/MM/YYYY') effective_date,decode(w.status,'Y','Active','N','DeActive')status, m.transport_description from WAR_RATE_MASTER w,MODE_OF_TRANSPORT m where m.mode_transport_id=w.mode_transport_id and m.branch_code=? and W.BRANCH_CODE=? and W.BRANCH_CODE=m.branch_code and amend_id=( select max(amend_id) from war_rate_master wr where  wr.mode_transport_id=w.mode_transport_id  and wr.branch_code=w.branch_code)
GET_WAR_LIST_BY_NAME=SELECT   E.WAR_ID,E.WAR_DESC,E.WAR_RATE,TO_CHAR (E.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,DECODE (E.STATUS,'Y','ACTIVE','N','DeActive')STATUS,M.TRANSPORT_DESCRIPTION FROM WAR_RATE_MASTER E, MODE_OF_TRANSPORT M  WHERE E.mode_transport_id=M.mode_transport_id and E.BRANCH_CODE = ? AND M.BRANCH_CODE=? AND E.AMEND_ID = (SELECT MAX (AMEND_ID) FROM WAR_RATE_MASTER WHERE WAR_DESC = E.WAR_DESC AND BRANCH_CODE=?) AND LOWER (E.WAR_DESC) LIKE LOWER ('%' || ? || '%') ORDER BY E.WAR_ID
GET_WAR_LIST_BY_DESC=SELECT   E.WAR_ID,E.WAR_DESC,E.WAR_RATE,TO_CHAR (E.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,DECODE (E.STATUS,'Y','ACTIVE','N','DeActive')STATUS,M.TRANSPORT_DESCRIPTION FROM WAR_RATE_MASTER E, MODE_OF_TRANSPORT M  WHERE E.mode_transport_id=M.mode_transport_id and E.BRANCH_CODE = ? AND M.BRANCH_CODE=? AND E.AMEND_ID = (SELECT MAX (AMEND_ID) FROM WAR_RATE_MASTER WHERE WAR_DESC = E.WAR_DESC AND BRANCH_CODE=?) AND LOWER (M.TRANSPORT_DESCRIPTION) LIKE LOWER ('%' || ? || '%') ORDER BY M.TRANSPORT_DESCRIPTION
Check_War= select distinct(CORE_APP_ID) from WAR_RATE_MASTER where CORE_APP_ID=? and branch_code=?
Check_Sale=select distinct(RSACODE) from SALE_TERM_MASTER where RSACODE=?
GET_SALETERM_LIST=select SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from SALE_TERM_MASTER where BRANCH_CODE=?
GET_SALETERM_LIST_BY_NAME=select SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from SALE_TERM_MASTER where BRANCH_CODE=? and lower(SALE_TERM_NAME) like lower(('%'||?||'%')) order by lower(SALE_TERM_NAME)
INS_SALETERM=insert into SALE_TERM_MASTER (SNO__,SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,RSACODE,REMARKS,STATUS,DISPLAY_ORDER,BRANCH_CODE,INT_CODE)values((select NVL( MAX(SNO__),0)+1 from SALE_TERM_MASTER),(select NVL(MAX(SALE_TERM_ID),0)+1 from SALE_TERM_MASTER where BRANCH_CODE=?),?,?,?,?,?,(select MAX(DISPLAY_ORDER)+1 from SALE_TERM_MASTER where BRANCH_CODE=?),?,(select NVL(MAX(SALE_TERM_ID),0)+1 from SALE_TERM_MASTER where BRANCH_CODE=?))
EDIT_SALETERM_MASTER=select SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,RSACODE,REMARKS,STATUS from SALE_TERM_MASTER where BRANCH_CODE=? and SALE_TERM_ID=?
UPDATE_SALETERM_MASTER=update SALE_TERM_MASTER set SALE_TERM_NAME=?,SALE_TERM_VALUE=?,RSACODE=?,STATUS=?,REMARKS=?,INT_CODE=? where BRANCH_CODE=? and SALE_TERM_ID=?
INS_TOLERANCE_MASTER=insert into TOLERANCE_MASTER (SNO__,TOLERANCE_ID,TOLERANCE_NAME,TOLERANCE_VALUE,RSACODE,REMARKS,STATUS,BRANCH_CODE,DISPLAY_ORDER) values((select MAX(SNO__)+1 from TOLERANCE_MASTER),(select MAX(TOLERANCE_ID)+1 from TOLERANCE_MASTER where BRANCH_CODE=?),?,?,?,?,?,?,(select MAX(DISPLAY_ORDER)+1 from TOLERANCE_MASTER where BRANCH_CODE=?))
EDIT_TOLERANCE_MASTER=select TOLERANCE_ID,TOLERANCE_NAME,TOLERANCE_VALUE,RSACODE,STATUS,REMARKS from TOLERANCE_MASTER where BRANCH_CODE=? and TOLERANCE_ID=?
Check_tole=select distinct(RSACODE) from TOLERANCE_MASTER where BRANCH_CODE=? and RSACODE=?
GET_TOLERANCE_LIST_BY_NAME=select TOLERANCE_ID,TOLERANCE_NAME,TOLERANCE_VALUE,RSACODE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from TOLERANCE_MASTER where BRANCH_CODE=? and lower(TOLERANCE_NAME) like lower(('%'||?||'%'))order by lower(TOLERANCE_NAME)
GET_TOLERANCE_MASTER_LIST=select TOLERANCE_ID,TOLERANCE_NAME,TOLERANCE_VALUE,RSACODE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from TOLERANCE_MASTER where BRANCH_CODE\=? 
Check_name_tole=select count(TOLERANCE_NAME) from TOLERANCE_MASTER where branch_code=? and upper(TOLERANCE_NAME)=upper(?)
UPDATE_TOLERANCE_MASTER=update TOLERANCE_MASTER set TOLERANCE_NAME=?,TOLERANCE_VALUE=?,RSACODE=?,REMARKS=?,STATUS=? where BRANCH_CODE=? and TOLERANCE_ID=?
GET_COMEX_LIST=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from COMMODITY_EXCESS_PREMIUM where AMEND_ID||SNO  in (select max(AMEND_ID)||(SNO) from COMMODITY_EXCESS_PREMIUM where branch_code \= ?  group by SNO ) AND branch_code \= ? order by SNO
GET_COMEXLIST=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from COMMODITY_EXCESS_PREMIUM where AMEND_ID||SNO  in (select max(AMEND_ID)||(SNO) from COMMODITY_EXCESS_PREMIUM where branch_code \= ?  group by SNO ) AND branch_code \= ? 
GET_COMEX_LIST_BY_NAME=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from COMMODITY_EXCESS_PREMIUM where BRANCH_CODE=? and lower(START_SUM_INSURED) like lower(('%'||?||'%'))order by lower(START_SUM_INSURED)
GET_COMEX_LIST_BY_VALUE=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from COMMODITY_EXCESS_PREMIUM where BRANCH_CODE\=? and lower(END_SUM_INSURED) like lower(('%'||?||'%'))order by lower(END_SUM_INSURED) 
Check_comEx=select distinct(SNO) from COMMODITY_EXCESS_PREMIUM where branch_code=? and SNO=?
INS_COMEX=insert into COMMODITY_EXCESS_PREMIUM (SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,AMEND_ID,EFFECTIVE_DATE,BRANCH_CODE,STATUS) values((select MAX(SNO)+1 from COMMODITY_EXCESS_PREMIUM  WHERE BRANCH_CODE=?),?,?,?,?,0,TO_DATE(?,'DD/MM/YYYY'),?,?)
UPDATE_COMEX=update COMMODITY_EXCESS_PREMIUM set DEDUCTIBLE=?,RATE=?,STATUS=?,EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY')  where SNO=? and AMEND_ID =(select max(AMEND_ID) from COMMODITY_EXCESS_PREMIUM where SNO=? and BRANCH_CODE=?) and BRANCH_CODE=?
EDIT_COMEX=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,STATUS from COMMODITY_EXCESS_PREMIUM a where a.BRANCH_CODE\=? and a.SNO\=? and AMEND_ID \=(select max(AMEND_ID) from COMMODITY_EXCESS_PREMIUM where BRANCH_CODE\=A.BRANCH_CODE and SNO\=a.sno ) 
Check_name_mode_of_transport=select count(TRANSPORT_DESCRIPTION) from MODE_OF_TRANSPORT where upper(TRANSPORT_DESCRIPTION)=upper(?) and branch_code=?
Check_name_convey=select count(CONVDESC) from CONVEYAN_MASTER where upper(CONVDESC)=upper(?) and BRANCH_CODE=?
Check_name_War=select count(MODE_TRANSPORT_ID) from WAR_RATE_MASTER where mode_transport_id=? and branch_code=?
GET_EXTRA_COVER_LIST=SELECT E.EXTRA_COVER_NAME,E.EXTRA_COVER_ID,E.REMARKS,E.RSACODE,DECODE(E.STATUS,'Y','Active','N','DeActive') STATUS ,M.TRANSPORT_DESCRIPTION FROM EXTRA_COVER_MASTER E,MODE_OF_TRANSPORT M WHERE M.MODE_TRANSPORT_ID=E.MODE_TRANSPORT_ID AND M.BRANCH_CODE=? AND E.BRANCH_CODE=?
GET_EXTRACOVER_LIST_BY_NAME=select E.EXTRA_COVER_NAME,EXTRA_COVER_ID,E.REMARKS,E.RSACODE,to_char(E.effective_date,'DD/MM/YYYY') EFFECTIVE_DATE,decode(E.status,'Y','Active','D','DeActive') STATUS ,m.transport_description from EXTRA_COVER_MASTER E,MODE_OF_TRANSPORT m where m.mode_transport_id=E.mode_transport_id and m.branch_code=? and E.BRANCH_CODE=? and lower(E.extra_cover_name) like lower(('%'||?||'%'))
Check_extraCover=select distinct(RSACODE) from Extra_cover_master where branch_code=? and RSACODE=?
INS_EXTRA_MASTER=insert into extra_cover_master(SNO__,BRANCH_CODE,MODE_TRANSPORT_ID,EXTRA_COVER_NAME,RSACODE,EXTRA_COVER_ID,REMARKS,STATUS) values((select max(SNO__)+1 from extra_cover_master),?,?,?,?,(select max(extra_cover_id)+1 from extra_cover_master where branch_code=?),?,?)
EDIT_EXTRA_COVER_MASTER=select EXTRA_COVER_NAME,EXTRA_COVER_ID,MODE_TRANSPORT_ID,REMARKS,RSACODE,STATUS from EXTRA_COVER_MASTER where BRANCH_CODE=? and EXTRA_COVER_ID=?
UPDATE_EXTRA_COVER_MASTER=update extra_cover_master set EXTRA_COVER_NAME=?,MODE_TRANSPORT_ID=?, REMARKS=?, RSACODE=? ,STATUS=? where BRANCH_CODE=? and EXTRA_COVER_ID=?
GET_CITY_LIST=SELECT CI.CITY_NAME,CI.CITY_ID,CI.COUNTRY_ID,CI.RSACODE,CI.REMARKS,decode(CI.status,'Y','Active','N','DeActive') STATUS,CO.COUNTRY_NAME FROM CITY_MASTER CI,COUNTRY_MASTER CO WHERE CI.COUNTRY_ID=CO.COUNTRY_ID and CO.BRANCH_CODE=?  And CO.amend_id=(select max(amend_id) from country_master cm where co.country_id=cm.country_id)
GET_CITY_LIST_BY_NAME=SELECT CI.CITY_NAME,CI.CITY_ID,CI.COUNTRY_ID,CI.RSACODE,CI.REMARKS,decode(CI.status,'Y','Active','D','DeActive') STATUS,CO.COUNTRY_NAME FROM CITY_MASTER CI,COUNTRY_MASTER CO WHERE CI.COUNTRY_ID\=CO.COUNTRY_ID AND lower(CITY_NAME) like lower(('%'||?||'%'))  
Check_city=select distinct(rsacode) from city_master where rsacode=? and country_id=?
Check_city_name=select count(city_name) from city_master where country_id=? and upper(city_name)=upper(?)
INS_CITI_MASTER=insert into city_master(SNO__,CITY_ID,CITY_NAME,COUNTRY_ID,RSACODE,REMARKS,STATUS) values((select max(sno__)+1 from city_master),(select max(city_id)+1 from city_master),?,?,?,?,?)
EDIT_CITY_MASTER=select city_name,country_id,remarks,status,rsacode,city_id from city_master where city_id=?
GET_VESSEL_LIST=select VESSEL_ID,VESSEL_NAME,VESSEL_CLASS,MANUFACTURE_YEAR,DECODE(STATUS,'Y','Active','N','DeActive','R','Referral')STATUS from VESSEL_MASTER  
GET_VESSEL_LIST_BY_NAME=select VESSEL_ID,VESSEL_NAME,VESSEL_CLASS,MANUFACTURE_YEAR,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from VESSEL_MASTER where lower(VESSEL_NAME) like lower('%'||?||'%') ORDER BY VESSEL_NAME
Check_name_Sale=select count(SALE_TERM_NAME) from SALE_TERM_MASTER where upper(SALE_TERM_NAME)=upper(?) and BRANCH_CODE=?
EDIT_VESSEL=select VESSEL_ID,VESSEL_NAME,VESSEL_CLASS,MANUFACTURE_YEAR,RSACODE,STATUS,VESSEL_TYPE,REMARKS,VESSEL_RATE from vessel_master where VESSEL_ID=?
INS_VESSEL=insert into vessel_master values((select MAX(SNO__)+1 from vessel_master),(select MAX(vessel_id)+1 from vessel_master),?,?,'','','','','','','','',?,?,?,'Y',(select MAX(DISPLAY_ORDER)+1 from vessel_master),1,?,?,?)
Check_name_vessel=select count(VESSEL_NAME) from vessel_master where lower(VESSEL_NAME)=lower(?)
Check_vessel=select distinct(RSACODE) from vessel_master where RSACODE=?
UPDATE_VESSEL=update VESSEL_MASTER set vessel_name=?,vessel_type=?,MANUFACTURE_YEAR=?,vessel_class=?,RSACODE=?,STATUS=?,remarks=?,VESSEL_RATE=? where VESSEL_ID=?
GET_WARRANTY_LIST=select WARRANTY_ID,WARRANTY_DESCRIPTION,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from WARRANTY_MASTER where BRANCH_CODE\=? 
GET_WARRANTY_LIST_NAME=select WARRANTY_ID,WARRANTY_DESCRIPTION,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from WARRANTY_MASTER where BRANCH_CODE=? and lower(WARRANTY_DESCRIPTION) like lower('%'||?||'%')
Check_Warranty=select count(RSACODE) from WARRANTY_MASTER where RSACODE=? and BRANCH_CODE=?
Check_name_warranty=select count(WARRANTY_DESCRIPTION) from WARRANTY_MASTER where upper(WARRANTY_DESCRIPTION)=upper(?) and BRANCH_CODE=?
INS_WARRANTY=INSERT INTO WARRANTY_MASTER (SNO__,WARRANTY_ID,WARRANTY_DESCRIPTION,RSACODE,REMARKS,STATUS,BRANCH_CODE,DISPLAY_ORDER,INT_CODE) VALUES((SELECT NVL(MAX(SNO__),0)+1 FROM WARRANTY_MASTER),(SELECT NVL(MAX(WARRANTY_ID),0)+1 FROM WARRANTY_MASTER WHERE BRANCH_CODE=?),?,?,?,?,?,(SELECT MAX(DISPLAY_ORDER)+1 FROM WARRANTY_MASTER WHERE BRANCH_CODE=?),'W'||?)
UPDATE_WARRANTY=update WARRANTY_MASTER set WARRANTY_DESCRIPTION=?,RSACODE=?,REMARKS=?,STATUS=?,INT_CODE='W'||? where WARRANTY_ID=? and BRANCH_CODE=?
EDIT_WARRANTY=select WARRANTY_ID,WARRANTY_DESCRIPTION,RSACODE,REMARKS,STATUS from WARRANTY_MASTER where BRANCH_CODE=? and WARRANTY_ID=?
GET_CONTANTMASTER_LIST = SELECT CATEGORY_ID,CATEGORY_NAME,DECODE(STATUS,'Y','Active','N','DeActive',STATUS)STATUS,RSACODE FROM CONSTANT_MASTER WHERE BRANCH_CODE=?
#####(13-06-2016)#####GET_CONSTANT_LIST=select CATEGORY_ID,CATEGORY_DETAIL_ID,DECODE(STATUS,'Y','Active','N','DeActive')STATUS,DETAIL_NAME from CONSTANT_DETAIL where BRANCH_CODE=? and CATEGORY_ID=?
GET_CONSTANT_LIST = SELECT CATEGORY_ID,CATEGORY_DETAIL_ID,(CASE STATUS WHEN  'Y' THEN  'Active' WHEN 'N' THEN 'DeActive' END)  STATUS,DETAIL_NAME FROM CONSTANT_DETAIL WHERE BRANCH_CODE=? AND CATEGORY_ID=?
GET_CONSTANT_LIST_NAME=select CATEGORY_ID,CATEGORY_DETAIL_ID,DECODE(STATUS,'Y','Active','N','DeActive')STATUS,DETAIL_NAME from CONSTANT_DETAIL where BRANCH_CODE=? and CATEGORY_ID=?
GET_CATEGORY=select CATEGORY_ID,CATEGORY_NAME from CONSTANT_MASTER where status='Y' and branch_code in(?) order by CATEGORY_NAME
INS_CONSTANT=Insert into CONSTANT_DETAIL(CATEGORY_ID, CATEGORY_DETAIL_ID, DETAIL_NAME, REMARKS, STATUS,RSACODE, PERCENT, BRANCH_CODE, PARENT_MENU) Values(?, (SELECT   MAX (CATEGORY_DETAIL_ID) + 1  FROM   CONSTANT_DETAIL WHERE  CATEGORY_ID=? and branch_code = ?), ?, ?, ?, ?, ?, ?, '')
Check_constant=select count(RSACODE) from CONSTANT_DETAIL where branch_code=? and RSACODE=?
Check_constant_name=select count(DETAIL_NAME) from CONSTANT_DETAIL where branch_code=? and upper(DETAIL_NAME)=upper(?)
EDIT_CONSTANT=select DETAIL_NAME,PERCENT,REMARKS,RSACODE,STATUS,CATEGORY_ID,CATEGORY_DETAIL_ID from CONSTANT_DETAIL where CATEGORY_ID=? and CATEGORY_DETAIL_ID=? and BRANCH_CODE=?
UPDATE_CONSTANT=update CONSTANT_DETAIL set DETAIL_NAME=?,PERCENT=?,REMARKS=?,RSACODE=?,STATUS=? where CATEGORY_DETAIL_ID=? and CATEGORY_ID=? and branch_code=?
Check_extra_name=select count(extra_cover_name) from EXTRA_COVER_MASTER where mode_transport_id=? and branch_code=? and lower(extra_cover_name)=lower(?)
UPDATE_CITY_MASTER=update city_master set city_name=?,country_id=?,rsacode=?,remarks=?,status=? where city_id=?
#####(10-06-2016)#####GET_COUNTRY_DETAIL=SELECT   C.COUNTRY_ID,C.SNO__,C.COUNTRY_NAME,C.WAR_RATE,C.STARTING_PLACE,C.ENDING_PLACE,DECODE (C.STATUS,'Y','Active','N','DeActive','R','Referral')STATUS FROM COUNTRY_MASTER_DETAIL C WHERE C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_NAME\=C.COUNTRY_NAME and BELONGING_COUNTRY_ID\=C.BELONGING_COUNTRY_ID)  AND C.BELONGING_COUNTRY_ID\=?
GET_COUNTRY_DETAIL = SELECT   C.COUNTRY_ID,C.SNO__,C.COUNTRY_NAME,C.WAR_RATE,C.STARTING_PLACE,C.ENDING_PLACE,(case c.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'  when 'R' then 'Refferal'  end) STATUS,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE FROM COUNTRY_MASTER_DETAIL C WHERE C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_NAME\=C.COUNTRY_NAME and BELONGING_COUNTRY_ID\=C.BELONGING_COUNTRY_ID) AND C.BELONGING_COUNTRY_ID\=?
GET_COUNTRY_DETAIL_NAME=SELECT   C.COUNTRY_ID,C.SNO__,C.COUNTRY_NAME,C.WAR_RATE,C.STARTING_PLACE,C.ENDING_PLACE,DECODE (C.STATUS,'Y','Active','N','DeActive','R','Referral')STATUS FROM COUNTRY_MASTER_DETAIL C WHERE C.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_NAME=C.COUNTRY_NAME and BELONGING_COUNTRY_ID=C.BELONGING_COUNTRY_ID) AND C.BELONGING_COUNTRY_ID=? AND lower(C.COUNTRY_NAME) like lower(('%'||?||'%'))
GET_Countries=select E.COUNTRY_ID,E.COUNTRY_NAME from COUNTRY_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME) and country_id=(select origination_country_id from branch_master where branch_code=?)
Check_countryDet_name=select count(COUNTRY_NAME) from COUNTRY_MASTER_DETAIL where upper(COUNTRY_NAME)=upper(?)
Check_countryDet=select count(RSACODE) from COUNTRY_MASTER_DETAIL where RSACODE=?
INS_COUNTRYDET=insert into COUNTRY_MASTER_DETAIL(SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,STARTING_PLACE, SP_WARRANTIES_CONDITIONS, ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS,RSACODE, NATIONALITY_NAME, AMEND_ID, EFFECTIVE_DATE, REMARKS,BELONGING_COUNTRY_ID,BRANCH_CODE) Values((select MAX(SNO__)+1 from COUNTRY_MASTER_DETAIL),?,(select COUNTRY_NAME from COUNTRY_MASTER where COUNTRY_ID=? AND BRANCH_CODE=?), ?, ?,?, ?, ?, ?, ?,?, ?, ?, TO_DATE(?, 'DD/MM/YYYY'), ?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),?)
EDIT_COUNTRY_DET=select SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,DECODE(STARTING_PLACE,'Any Port','1','Warehouse','2','Disabled','3')STARTING_PLACE, SP_WARRANTIES_CONDITIONS,DECODE(ENDING_PLACE,'Any Port','1','Warehouse','2','Disabled','3')ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS, RSACODE, NATIONALITY_NAME, TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE, REMARKS from COUNTRY_MASTER_DETAIL where COUNTRY_ID\=? and SNO__\=?
UPDATE_COUNTRYDET=insert into COUNTRY_MASTER_DETAIL(SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,STARTING_PLACE, SP_WARRANTIES_CONDITIONS, ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS,RSACODE, NATIONALITY_NAME, AMEND_ID, EFFECTIVE_DATE, REMARKS,BELONGING_COUNTRY_ID,BRANCH_CODE) Values((select MAX(SNO__)+1 from COUNTRY_MASTER_DETAIL),?, ?, ?, ?,?, ?, ?, ?, ?,?, ?, (select MAX(amend_id)+1 from COUNTRY_MASTER_DETAIL where SNO__\=?), TO_DATE(?, 'DD/MM/YYYY'), ?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE\=?),?)
GET_BASERATE_COVERAGE=SELECT CM.COVER_ID,CM.COVER_NAME FROM COVER_MASTER CM WHERE mode_transport_id = ? and CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE mode_transport_id = ? and COVER_ID=CM.COVER_ID AND BRANCH_CODE= ?) AND CM.BRANCH_CODE= ? order by CM.COVER_NAME
GET_BASERATE_CONVEY=SELECT CONV_MEAN,CONVDESC FROM CONVEYAN_MASTER CM WHERE MODE_TRANSPORT_ID=? AND BRANCH_CODE= ? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CM.CONV_MEAN=CONV_MEAN AND BRANCH_CODE= ? AND MODE_TRANSPORT_ID= ?) ORDER BY CONVDESC
GET_BASERATE_COUNTRY=SELECT CM.COUNTRY_ID,CM.COUNTRY_NAME FROM COUNTRY_MASTER CM WHERE CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID=CM.COUNTRY_ID)ORDER BY COUNTRY_NAME
GET_BASERATE_COMMODITY=SELECT CM.COMMODITY_ID,CM.COMMODITY_NAME FROM COMMODITYMASTER CM WHERE CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID=CM.COMMODITY_ID AND BRANCH_CODE=?)AND CM.BRANCH_CODE=? ORDER BY CM.COMMODITY_NAME
GET_AGENT_LIST= SELECT DISTINCT(SM.SETTLING_AGENT_NAME),SM.SETTLING_AGENT_ID,SM.RSACODE,CM.COUNTRY_NAME,DECODE(SM.STATUS,'Y','Active','N','DeActive') STATUS FROM SETTLING_AGENT_MASTER SM,CITY_MASTER CI,COUNTRY_MASTER CM WHERE CM.COUNTRY_ID=SM.COUNTRY_ID AND SM.BRANCH_CODE=?
GET_AGENT_BY_NAME=SELECT SM.SETTLING_AGENT_NAME,SM.SETTLING_AGENT_ID,SM.RSACODE,CM.COUNTRY_NAME,CI.CITY_NAME,DECODE(SM.STATUS,'Y','Active','N','DeActive') STATUS FROM SETTLING_AGENT_MASTER SM,CITY_MASTER CI,COUNTRY_MASTER CM WHERE CI.CITY_ID\=SM.CITY_ID AND CM.COUNTRY_ID\=SM.COUNTRY_ID AND BRANCH_CODE\=? AND lower(SM.SETTLING_AGENT_NAME) like lower('%'||?||'%') order by COUNTRY_NAME
GET_CITY_BY_COUNTRY=SELECT CITY_NAME,CITY_ID FROM CITY_MASTER WHERE COUNTRY_ID=?
Check_Agent=select distinct(RSACODE) from SETTLING_AGENT_MASTER where  (branch_code=? or branch_code='01') and RSACODE=?
INS_AGENT_MASTER=insert into SETTLING_AGENT_MASTER values((select max(SNO__)+1 from SETTLING_AGENT_MASTER WHERE branch_code = ? ),(select max(SETTLING_AGENT_ID)+1 from SETTLING_AGENT_MASTER where branch_code=?),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where branch_code=?),?,?)
EDIT_SETTLING_AGENT_MASTER=select SETTLING_AGENT_ID,SETTLING_AGENT_NAME,COUNTRY_ID,CITY_ID,SHORT_NAME,ADDRESS1,ADDRESS2,ADDRESS3,CITY_NAME,ZIP_CODE,TELEPHONE_NO,FAX_NO,MOBILE_NO,EMAIL,RSACODE,REMARKS,STATUS from SETTLING_AGENT_MASTER where (branch_code=?  or branch_code='01') and SETTLING_AGENT_ID=?
UPDATE_SETTLING_AGENT_MASTER=update SETTLING_AGENT_MASTER set SETTLING_AGENT_NAME=?,COUNTRY_ID=?,CITY_ID=?,SHORT_NAME=?,ADDRESS1=?,ADDRESS2=?,ADDRESS3=?,CITY_NAME=?,ZIP_CODE=?,TELEPHONE_NO=?,FAX_NO=?,MOBILE_NO=?,EMAIL=?,RSACODE=?,REMARKS=?,STATUS=? where branch_code=? and SETTLING_AGENT_ID=?
GET_COMMODITY_DETAIL=SELECT CM.COMMODITY_ID,CM.COMMODITY_NAME,CM.AMEND_ID,TO_CHAR(CM.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(CM.STATUS,'Y','Active','N','DeActive','R','Referral')STATUS FROM COMMODITYMASTER CM WHERE CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID AND BRANCH_CODE\=?)AND CM.BRANCH_CODE\=?    
GET_COMMODITY_DETAIL_NAME=SELECT CM.COMMODITY_ID,CM.COMMODITY_NAME,CM.AMEND_ID,TO_CHAR(CM.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,DECODE(CM.STATUS,'Y','Active','N','DeActive','R','Referral')STATUS FROM COMMODITYMASTER CM WHERE CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID=CM.COMMODITY_ID AND BRANCH_CODE=?)AND CM.BRANCH_CODE=? AND LOWER(CM.COMMODITY_NAME) LIKE LOWER(('%'||?||'%')) ORDER BY CM.COMMODITY_NAME
GET_COMMODITY_TYPE=select CATEGORY_DETAIL_ID,DETAIL_NAME from CONSTANT_DETAIL where CATEGORY_ID=42 and STATUS='Y' and branch_code=?
INS_COMMODITY_MASTER=Insert into COMMODITYMASTER (SNO__, COMMODITY_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL,ICC_A_SEA, ICC_B_SEA, ICC_C_SEA, ICC_C_NONDELIVERY, ICC_A_FROZEN_MEAT_SEA,ICC_A_FROZEN_FOOD_SEA, ICC_C_FROZEN_MEAT_SEA, ICC_C_FROZEN_FOOD_SEA, ICC_AIR_CARGO_AIR, ICC_AIR_CARGO_ALL_RISKS,ALL_RISKS_LAND_TRANSIT_LAND, LAND_TRANSIT_LAND, ALL_RISKS_PARCEL_POST_AIR, ALL_RISKS_SEA_AND_AIR, FRAGILE, COMMODITY_TYPE_ID, EXCLUSION_ID,  WARRANTY_ID, REMARKS, STATUS, RSACODE, EFFECTIVE_DATE,AMEND_ID, RAG, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM) Values((select MAX(SNO__)+1 from COMMODITYMASTER),(select MAX(COMMODITY_ID)+1 from COMMODITYMASTER),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?)
Check_commodity_name=select count(COMMODITY_NAME) from COMMODITYMASTER where UPPER(COMMODITY_NAME)=UPPER(?) and BRANCH_CODE=?
Check_commodity=select count(RSACODE) from COMMODITYMASTER where RSACODE\=? and BRANCH_CODE\=? 
EDIT_COMMODITY_MASTER=select SNO__, COMMODITY_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL,ICC_A_SEA,ICC_B_SEA,ICC_C_SEA,ICC_C_NONDELIVERY,ICC_A_FROZEN_MEAT_SEA,ICC_A_FROZEN_FOOD_SEA,ICC_C_FROZEN_MEAT_SEA,ICC_C_FROZEN_FOOD_SEA,ICC_AIR_CARGO_AIR,ICC_AIR_CARGO_ALL_RISKS,ALL_RISKS_LAND_TRANSIT_LAND,LAND_TRANSIT_LAND,ALL_RISKS_PARCEL_POST_AIR,ALL_RISKS_SEA_AND_AIR,FRAGILE, RAG, EXCLUSION_ID,WARRANTY_ID, REMARKS, STATUS, RSACODE, TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,AMEND_ID, COMMODITY_TYPE_ID, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM from COMMODITYMASTER where COMMODITY_ID=? and BRANCH_CODE=? and amend_id=(select max(amend_id) from COMMODITYMASTER where COMMODITY_ID=? and BRANCH_CODE=?)
UPDATE_COMMODITY_MASTER=Insert into COMMODITYMASTER (SNO__, COMMODITY_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL,ICC_A_SEA, ICC_B_SEA, ICC_C_SEA, ICC_C_NONDELIVERY, ICC_A_FROZEN_MEAT_SEA,ICC_A_FROZEN_FOOD_SEA, ICC_C_FROZEN_MEAT_SEA, ICC_C_FROZEN_FOOD_SEA, ICC_AIR_CARGO_AIR, ICC_AIR_CARGO_ALL_RISKS,ALL_RISKS_LAND_TRANSIT_LAND, LAND_TRANSIT_LAND, ALL_RISKS_PARCEL_POST_AIR, ALL_RISKS_SEA_AND_AIR,FRAGILE, COMMODITY_TYPE_ID, EXCLUSION_ID,  WARRANTY_ID, REMARKS, STATUS, RSACODE, EFFECTIVE_DATE,AMEND_ID, RAG, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM) Values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?)
Check_Date=select count(CM.EFFECTIVE_DATE) from COMMODITYMASTER CM where CM.EFFECTIVE_DATE<TO_DATE(?,'DD/MM/YYYY') and CM.commodity_name\=? and CM.branch_code\=? and CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID AND BRANCH_CODE\=?)
GET_CURRENCY_NAME=SELECT   CM.CURRENCY_ID, CM.CURRENCY_NAME, DECODE (CM.STATUS, 'Y', 'Active', 'N', 'DeActive') STATUS, CM.SHORT_NAME, CM.SUB_CURRENCY FROM   CURRENCY_MASTER CM WHERE  Cm.COUNTRY_ID =(SELECT DESTINATION_COUNTRY_ID FROM BRANCH_MASTER BM WHERE BM.BRANCH_CODE=?) AND CM.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER C WHERE   C.CURRENCY_ID = CM.CURRENCY_ID and CM.COUNTRY_ID=C.COUNTRY_ID)
GET_CURRENCY_NAME_LIST=select CM.CURRENCY_ID,CM.CURRENCY_NAME,DECODE(CM.STATUS,'Y','Active','N','DeActive')STATUS,CM.SHORT_NAME,CM.SUB_CURRENCY from CURRENCY_MASTER CM where CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=CM.CURRENCY_ID) and lower(CURRENCY_NAME) like lower(('%'||?||'%')) 
INS_CURRENCY_MASTER=insert into CURRENCY_MASTER (CURRENCY_ID, CURRENCY_NAME, AMEND_ID, INCEPTION_DATE, EXPIRY_DATE, EFFECTIVE_DATE, ENTRY_DATE, REMARKS, STATUS, RSACODE, SNO__, COUNTRY_ID, DISPLAY_ORDER, SHORT_NAME, RFACTOR, SUB_CURRENCY) values((select MAX(CURRENCY_ID)+1 from CURRENCY_MASTER),?,?,'','',TO_DATE(?,'DD/MM/YYYY'),'',?,?,?,(select MAX(SNO__)+1 from CURRENCY_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from CURRENCY_MASTER where country_id = (select country_id from branch_master where branch_code=?)),?,?,?)
UPDATE_CURRENCY_MASTER=insert into CURRENCY_MASTER (CURRENCY_ID, CURRENCY_NAME, AMEND_ID, INCEPTION_DATE, EXPIRY_DATE, EFFECTIVE_DATE, ENTRY_DATE, REMARKS, STATUS, RSACODE, SNO__, COUNTRY_ID, DISPLAY_ORDER, SHORT_NAME, RFACTOR, SUB_CURRENCY) values(?,?,?,'','',TO_DATE(?,'DD/MM/YYYY'),'',?,?,?,(select MAX(SNO__)+1 from CURRENCY_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from CURRENCY_MASTER where country_id = (select country_id from branch_master where branch_code=?)),?,?,?)
Check_currency_name=select count(CURRENCY_NAME) from CURRENCY_MASTER where upper(CURRENCY_NAME)=upper(?)
Check_currency=select count(RSACODE) from CURRENCY_MASTER where RSACODE=?
EDIT_CURRENCY_MASTER = SELECT   CURRENCY_NAME, AMEND_ID, TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, SHORT_NAME, RFACTOR, SUB_CURRENCY, REMARKS, RSACODE, STATUS, CURRENCY_ID FROM   CURRENCY_MASTER WHERE   CURRENCY_ID =? AND country_id = (SELECT   country_id FROM   branch_master WHERE   branch_code =?)
GET_EXCHANGE_MASTER=SELECT   DISTINCT (E.EXCHANGE_ID), E.EXCHANGE_RATE, CM.CURRENCY_NAME, DECODE (E.STATUS, 'Y', 'Active', 'N', 'DeActive') STATUS FROM   EXCHANGE_MASTER E, CURRENCY_MASTER CM WHERE       E.AMEND_ID \= (  SELECT   MAX (AMEND_ID) FROM   EXCHANGE_MASTER EM WHERE   EXCHANGE_ID \= E.EXCHANGE_ID and EM.country_id\=E.country_id ) AND CM.AMEND_ID \= (  SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER C WHERE   CURRENCY_ID \= CM.CURRENCY_ID and C.country_id\=CM.country_id ) AND CM.CURRENCY_ID \= E.CURRENCY_ID AND CM.COUNTRY_ID \= E.COUNTRY_ID AND cm.country_id \= (SELECT BELONGING_BRANCH FROM   branch_master WHERE   branch_code \=?)  
GET_EXCHANGE_MASTER_NAME=select distinct(E.EXCHANGE_ID),E.EXCHANGE_RATE,CM.CURRENCY_NAME,DECODE(E.STATUS,'Y','Active','N','DeActive')STATUS from EXCHANGE_MASTER E, CURRENCY_MASTER CM where E.AMEND_ID=(select MAX(AMEND_ID) from EXCHANGE_MASTER where EXCHANGE_ID=E.EXCHANGE_ID group by E.EXCHANGE_ID) and CM.CURRENCY_ID=E.CURRENCY_ID and lower(CM.CURRENCY_NAME) like lower(('%'||?||'%'))  order by E.exchange_id
GET_EXCHANGES=select CM.CURRENCY_ID, CM.CURRENCY_NAME FROM CURRENCY_MASTER CM where CM.AMEND_ID\=(select MAX(AMEND_ID) from CURRENCY_MASTER where CURRENCY_ID\=CM.CURRENCY_ID and COUNTRY_ID\=CM.COUNTRY_ID) and COUNTRY_ID\=(select country_id from branch_master where branch_code\=?) order by currency_name 
INS_EXCHANGE_MASTER=insert into EXCHANGE_MASTER values((select MAX(EXCHANGE_ID)+1 from EXCHANGE_MASTER),?,?,?,'','',TO_DATE(?,'DD/MM/YYYY'),'',?,?,?,(select MAX(SNO__)+1 from EXCHANGE_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from EXCHANGE_MASTER))
Check_exchange_name=select count(CURRENCY_ID) from EXCHANGE_MASTER where CURRENCY_ID=?
UPDATE_EXCHANGE_MASTER=insert into EXCHANGE_MASTER values(?,?,?,?,'','',TO_DATE(?,'DD/MM/YYYY'),'',?,?,?,(select MAX(SNO__)+1 from EXCHANGE_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from EXCHANGE_MASTER))
EDIT_EXCHANGE_MASTER=select E.CURRENCY_ID,E.AMEND_ID,TO_CHAR(E.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,E.EXCHANGE_RATE,E.REMARKS,E.RSACODE,E.STATUS,E.EXCHANGE_ID from EXCHANGE_MASTER E where E.EXCHANGE_ID\=? AND E.COUNTRY_ID\=(SELECT COUNTRY_ID FROM BRANCH_MASTER WHERE BRANCH_CODE\=?) AND E.AMEND_ID\=(select MAX(AMEND_ID) from EXCHANGE_MASTER where EXCHANGE_ID\=E.EXCHANGE_ID AND COUNTRY_ID\=E.COUNTRY_ID group by E.EXCHANGE_ID)
Check_exchange=select count(RSACODE) from EXCHANGE_MASTER where RSACODE=?
GET_COVER_NAME=SELECT  C.COVER_NAME,M.TRANSPORT_DESCRIPTION,C.COVER_RATE,DECODE (C.STATUS,'Y', 'Active','N','DeActive') STATUS, C.COVER_ID  FROM   COVER_MASTER C, MODE_OF_TRANSPORT M WHERE  C.branch_code = ? AND C.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   COVER_MASTER CM  WHERE   CM.COVER_ID = C.COVER_ID  AND CM.BRANCH_CODE =C.BRANCH_CODE)  AND M.MODE_TRANSPORT_ID = C.MODE_TRANSPORT_ID   AND C.MODE_TRANSPORT_ID = M.MODE_TRANSPORT_ID AND M.BRANCH_CODE = C.BRANCH_CODE order by C.DISPLAY_ORDER
GET_COVER_NAME_LIST=select C.COVER_NAME,C.COVER_ID from COVER_MASTER C where C.branch_code=? and c.MODE_TRANSPORT_ID=? and C.AMEND_ID=(select MAX(AMEND_ID) from COVER_MASTER where COVER_ID=C.COVER_ID)  AND  C.BRANCH_CODE=?
INS_COVER_MASTER=insert into COVER_MASTER (SNO__, COVER_ID, COVER_NAME,MODE_TRANSPORT_ID, DESCRIPTION, RSACODE,AMEND_ID, EFFECTIVE_DATE, DISPLAY_ORDER,BRANCH_CODE, COVER_RATE, REFERAL_STATUS,REFERAL_VALUE, REMARKS, STATUS) values(( select MAX(SNO__)+1 from COVER_MASTER),( select MAX(COVER_ID)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),( select MAX(DISPLAY_ORDER)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,?,'',?,?)
UPDATE_COVER_MASTER=UPDATE COVER_MASTER cm SET  COVER_NAME\=?,MODE_TRANSPORT_ID\=?, DESCRIPTION\=?, RSACODE\=?, EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'), DISPLAY_ORDER\=?, COVER_RATE\=?, REFERAL_STATUS\=?,REMARKS\=?, STATUS\=? WHERE COVER_ID\=? and cm.branch_code\=? and cm.amend_id\=(select max(amend_id) from COVER_MASTER CC where cc.cover_id\=cm.cover_id and cc.branch_code\=cm.branch_code)
UPDATE_COVER_MASTER_INSERT=insert into COVER_MASTER (   SNO__, COVER_ID, COVER_NAME,MODE_TRANSPORT_ID, DESCRIPTION, RSACODE,AMEND_ID, EFFECTIVE_DATE, DISPLAY_ORDER,BRANCH_CODE, COVER_RATE, REFERAL_STATUS,REFERAL_VALUE, REMARKS, STATUS,COVER_ARABIC) values ((select MAX(SNO__)+1 from COVER_MASTER),?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?)
EDIT_COVER_MASTER=select COVER_ID,COVER_NAME,DESCRIPTION,MODE_TRANSPORT_ID,COVER_RATE,STATUS,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,RSACODE,REMARKS,AMEND_ID,REFERAL_STATUS from COVER_MASTER where COVER_ID=? and BRANCH_CODE=?
Check_cover_name=select count(COVER_NAME) from COVER_MASTER where upper(COVER_NAME)=upper(?) and BRANCH_CODE=?
Check_cover=select count(RSACODE) from COVER_MASTER where RSACODE=? and BRANCH_CODE=?
GET_EXCLUSION_LIST=SELECT EXCLUSION_DESCRIPTION,RSACODE,EXCLUSION_ID,REMARKS,DECODE(STATUS,'Y','Active','N','DeActive')STATUS FROM EXCLUSION_MASTER WHERE BRANCH_CODE=?
GET_EXCLUSION_BY_NAME=SELECT EXCLUSION_DESCRIPTION,RSACODE,EXCLUSION_ID,REMARKS, DECODE(STATUS,'Y','Active','N','DeActive') STATUS FROM EXCLUSION_MASTER WHERE BRANCH_CODE=? and lower(EXCLUSION_DESCRIPTION) like lower('%'||?||'%')
Check_exclusion_name= select count(EXCLUSION_DESCRIPTION) from exclusion_master where lower(EXCLUSION_DESCRIPTION)=lower(?) and BRANCH_CODE=?
Check_Exclusion=select distinct(rsacode) from exclusion_master where rsacode=? and branch_code=?
INS_EXCLUSION_MASTER=insert into exclusion_master(SNO__,EXCLUSION_ID,EXCLUSION_DESCRIPTION,RSACODE,REMARKS,STATUS,BRANCH_CODE,DISPLAY_ORDER,INT_CODE) values((select max(SNO__)+1 from exclusion_master),(select max(EXCLUSION_ID)+1 from exclusion_master where branch_code=?), ?,?,?,?,?,(select max(EXCLUSION_ID)+1 from exclusion_master where branch_code=?), 'E'||?)
EDIT_EXCLUSION_MASTER=SELECT EXCLUSION_DESCRIPTION,RSACODE,EXCLUSION_ID,REMARKS,STATUS FROM EXCLUSION_MASTER WHERE BRANCH_CODE=? and exclusion_id=?
UPDATE_EXCLUSION_MASTER=UPDATE EXCLUSION_MASTER SET EXCLUSION_DESCRIPTION=?,REMARKS=?,RSACODE=?,STATUS=?,INT_CODE='E'||? WHERE EXCLUSION_ID=? AND BRANCH_CODE=?
GET_ERROR_MASTER=select EM.ERROR_ID,EM.ERROR_DESC,SM.STAGE_DESC,PM.PRODUCT_NAME,DECODE(EM.STATUS,'Y','Active','N','DeActive')STATUS FROM  ERROR_MASTER EM,STAGE_MASTER SM,PRODUCT_MASTER PM WHERE EM.STAGE_ID=SM.STAGE_ID AND EM.PRODUCT_ID=PM.PRODUCT_ID and SM.PRODUCT_ID=PM.PRODUCT_ID  AND PM.BRANCH_CODE=?
GET_ERROR_LIST_NAME=select EM.ERROR_ID,EM.ERROR_DESC,SM.STAGE_DESC,PM.PRODUCT_NAME,DECODE(EM.STATUS,'Y','Active','N','DeActive')STATUS FROM  ERROR_MASTER EM,STAGE_MASTER SM,PRODUCT_MASTER PM WHERE EM.STAGE_ID=SM.STAGE_ID AND EM.PRODUCT_ID=PM.PRODUCT_ID and SM.PRODUCT_ID=PM.PRODUCT_ID AND PM.BRANCH_CODE=? AND LOWER(ERROR_DESC) LIKE LOWER(('%'||?||'%'))
EDIT_ERROR_MASTER=SELECT PRODUCT_ID,STAGE_ID,ERROR_DESC,REMARKS,STATUS,ERROR_ID from ERROR_MASTER WHERE ERROR_ID=?
UPDATE_ERROR_MASTER=UPDATE ERROR_MASTER SET ERROR_DESC=?,PRODUCT_ID=?,STAGE_ID=?,REMARKS=?,STATUS=? WHERE ERROR_ID=?
GET_ERROR_MASTER_LIST=SELECT ERROR_DESC,PRODUCT_NAME,STAGE_DESC,REMARKS,DECODE(STATUS,'Y','Active','N','DeActive')STATUS from ERROR_MASTER where ERROR_ID=?
Check_name_error=select count(ERROR_DESC) from ERROR_MASTER where PRODUCT_ID=? and STAGE_ID=? and upper(ERROR_DESC)=upper(?)
GET_PRODUCT_NAME_LIST=select PRODUCT_ID,PRODUCT_NAME from PRODUCT_MASTER where BRANCH_CODE=?
GET_VESSEL_TYPE_LIST=SELECT DISTINCT (VESSEL_TYPE) FROM VESSEL_MASTER 
GET_STAGE_NAME_LIST=select STAGE_ID,STAGE_DESC from STAGE_MASTER where PRODUCT_ID=?
GET_CLAUSE_ID_LIST_NAME=SELECT C.CLAUSES_ID, C.CLAUSES_DESCRIPTION, C.DISPLAY_ORDER,DECODE (C.STATUS,'Y','Active','N','DeActive')STATUS,COV.COVER_NAME FROM   CLAUSES_MASTER C, COVER_MASTER COV WHERE C.BRANCH_CODE \= ? AND C.COVER_ID\=COV.COVER_ID AND COV.BRANCH_CODE\=? AND LOWER (C.CLAUSES_DESCRIPTION) LIKE LOWER ( ('%' || ? || '%')) AND COV.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID\=COV.COVER_ID) 
GET_CLAUSE_ID_MASTER=SELECT C.CLAUSES_ID,COV.MODE_TRANSPORT_ID,(select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT mt where COV.MODE_TRANSPORT_ID=mt.MODE_TRANSPORT_ID and branch_code=?)TRANSPORT_DESCRIPTION,C.COVER_ID,COV.COVER_NAME,C.CLAUSES_DESCRIPTION,C.RSACODE,C.DISPLAY_ORDER,C.REMARKS,DECODE (C.STATUS,'Y','Active','N','DeActive')STATUS,COV.COVER_NAME FROM CLAUSES_MASTER C, COVER_MASTER COV WHERE   C.BRANCH_CODE = ? AND C.COVER_ID = COV.COVER_ID AND COV.BRANCH_CODE=? AND C.EXTRA_COVER_ID = 0 AND COV.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID=COV.COVER_ID)
GET_WSRCC_LIST=SELECT C.CLAUSES_ID,COV.MODE_TRANSPORT_ID,(select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT mt where COV.MODE_TRANSPORT_ID=mt.MODE_TRANSPORT_ID and branch_code=?)TRANSPORT_DESCRIPTION,C.COVER_ID,COV.COVER_NAME,C.CLAUSES_DESCRIPTION,C.RSACODE,C.DISPLAY_ORDER,C.REMARKS,DECODE (C.STATUS,'Y','Active','N','DeActive')STATUS,COV.COVER_NAME FROM CLAUSES_MASTER C, COVER_MASTER COV WHERE   C.BRANCH_CODE = ? AND C.COVER_ID = COV.COVER_ID AND COV.BRANCH_CODE=? AND C.EXTRA_COVER_ID = 1 AND COV.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID=COV.COVER_ID)
INS_CLAUSE_ID_MASTER=INSERT INTO CLAUSES_MASTER (SNO__,COVER_ID,CLAUSES_ID,CLAUSES_DESCRIPTION,EXTRA_COVER_ID,RSACODE,DISPLAY_ORDER,REMARKS,STATUS,BRANCH_CODE,PDF_LOCATION,INT_CODE) VALUES ((SELECT MAX(SNO__)+1 FROM CLAUSES_MASTER WHERE BRANCH_CODE=?),?,(SELECT MAX(CLAUSES_ID)+1 FROM CLAUSES_MASTER WHERE BRANCH_CODE=?),?,?,?,?,?,?,?,?,'C'||?)
Check_display_order=select count(DISPLAY_ORDER) from CLAUSES_MASTER where BRANCH_CODE=? and DISPLAY_ORDER=?
UPDATE_CLAUSE_ID_MASTER=UPDATE CLAUSES_MASTER SET CLAUSES_DESCRIPTION=?,STATUS=?,RSACODE=?,DISPLAY_ORDER=?,REMARKS=?,PDF_LOCATION=?,INT_CODE='C'||? WHERE CLAUSES_ID=? AND BRANCH_CODE=? AND EXTRA_COVER_ID=? and COVER_ID=?
EDIT_CLAUSE_ID_MASTER=SELECT CM.CLAUSES_ID,CMT.COVER_ID,CM.CLAUSES_DESCRIPTION,CM.EXTRA_COVER_ID,CM.RSACODE,CM.DISPLAY_ORDER,CM.STATUS,CM.REMARKS,(SELECT CMT.MODE_TRANSPORT_ID FROM MODE_OF_TRANSPORT MT WHERE MT.MODE_TRANSPORT_ID\=CMT.MODE_TRANSPORT_ID AND BRANCH_CODE\=?) MODE_TRANSPORT_ID,CM.PDF_LOCATION FROM CLAUSES_MASTER CM,COVER_MASTER CMT WHERE CM.COVER_ID\=CMT.COVER_ID AND CM.CLAUSES_ID\=? and CM.BRANCH_CODE\=? AND CM.BRANCH_CODE=CMT.BRANCH_CODE
Check_vessel_name=SELECT COUNT(VESSEL_NAME) FROM VESSEL_MASTER WHERE upper(VESSEL_NAME)=upper(?)
Check_ClauseID=SELECT DISTINCT(RSACODE) FROM CLAUSES_MASTER where RSACODE=? and BRANCH_CODE=?
UPDATE_COMMODITY_MASTER_UPDATE=UPDATE COMMODITYMASTER CM SET COMMODITY_NAME \= ?,COMMODITY_RATE \= ?,COVERAGE_REFERAL \=?,ICC_A_SEA \= ?,ICC_B_SEA \= ?,ICC_C_SEA \= ?,ICC_C_NONDELIVERY\=?, ICC_A_FROZEN_MEAT_SEA\=?,ICC_A_FROZEN_FOOD_SEA\=?,  ICC_C_FROZEN_MEAT_SEA\=?,ICC_C_FROZEN_FOOD_SEA\=?,ICC_AIR_CARGO_AIR \=?,ICC_AIR_CARGO_ALL_RISKS\=? ,ALL_RISKS_LAND_TRANSIT_LAND \=?,LAND_TRANSIT_LAND\=?,ALL_RISKS_PARCEL_POST_AIR \=?,ALL_RISKS_SEA_AND_AIR \= ?,REMARKS \= ?,STATUS \= ?,RSACODE \= ?,EFFECTIVE_DATE \= TO_DATE (?, 'DD/MM/YYYY'),RAG \= ? WHERE COMMODITY_ID \= ? AND BRANCH_CODE \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID)FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID)      
Check_Categ=SELECT COUNT(DETAIL_NAME) FROM COMMODITY_CATEGORY_MASTER WHERE upper(DETAIL_NAME)\=upper(?) and BRANCH_CODE\=?      

#Portfolio
GET_PRODUCTS=select PRODUCT_ID,PRODUCT_NAME from PRODUCT_MASTER where BRANCH_CODE=(select BELONGING_BRANCH from branch_master where BRANCH_CODE = ?)
GET_PORTFOLIO_BY_DATE=select pm.application_no,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,md.premium,nvl(md.EXCESS_PREMIUM,'0'),pi.COMPANY_NAME,pi.LAST_NAME,pm.quote_no,md.remarks,pm.PDF_MODIFY_CLAUSE,pm.PDF_MODIFY_WARRANTY,pm.PDF_MODIFY_EXCLUSION,pm.PDF_MODIFY_EXTRACLAUSES,pm.PRODUCT_ID,Policy_Cancel_Status,nvl(pm.open_cover_no,'0'),pm.application_id,nvl(md.ADMIN_REFERRAL_STATUS,'N'),to_char(pm.entry_date,'DD/MM/YYYY') from position_master pm,marine_data md,personal_info pi where to_char(pm.entry_date,'DD/MM/YYYY')=? and pm.application_no=md.application_no and pi.customer_id=pm.customer_id and pm.remarks in ('Normal')  and  pm.product_id in (11,3) and lower(pm.status) in('y') and nvl(pm.open_cover_int_status,'0') not in ('LINKED') and (md.ADMIN_REFERRAL_STATUS in('N') or md.ADMIN_REFERRAL_STATUS is null) and pm.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)))   order by pm.quote_no desc
GET_BRANCH_REPORT_LIST=select ENTRY_DATE,BRANCH_NAME,LOGIN_ID,APPLICATIONID,QUOTE_NO,APPLICATION_NO,POLICY_NO,INCEPTION_DATE,EFFECTIVE_DATE,PRODUCT_ID,CUSTOMER_NAME,TRANSPORT_DESCRIPTION,COVER_NAME,SALE_TERM_NAME,TOTAL_SLAE_TERM_CHARGES,TOTAL_TOLERANCE_CHARGES,EXTRA_COVER_NAME,SUM_INSURED_LOCAL,CURRENCY_NAME,EXCHANGE_RATE,SUM_INSURED_FOREIGN,BASIC_PREMIUM,TOTAL_WAR_CHARGES,EXCESS_PREMIUM,POLICY_FEE,TOTAL_PREMIUM_LOCAL,FOREIGN_CURRENCY,TOTAL_PREMIUM_FOREIGN,COMMISSION,TRANSIT_FROM_CITY,TRANSIT_FROM_COUNTRY,FINAL_DEST_CITY,FINAL_DESTINATION_COUNTRY,DEBIT_NOTE_NO,REFERRAL,REFERAL_STATUS,STATUS,INTEGRATION_STATUS,INTEGRATION_ERROR from table(AdminReports(?,?,?)) where Product_id=?
GET_BRANCH_NAME_LIST=SELECT COLUMN_VALUE BRANCH_CODE,(SELECT BRANCH_NAME FROM BRANCH_MASTER WHERE BRANCH_CODE=COLUMN_VALUE) BRANCH_NAME FROM TABLE(SPLIT_TEXT_FN((SELECT ATTACHED_BRANCH FROM LOGIN_MASTER WHERE LOGIN_ID=?))) ORDER BY TO_NUMBER(COLUMN_VALUE)
GET_EXCHANGE_REPORT_LIST=SELECT A.EXCHANGE_RATE,B.CURRENCY_NAME,A.AMEND_ID,TO_CHAR(A.EFFECTIVE_DATE,'DD-MM-YYYY') EFFECTIVE_DATE,A.CURRENCY_ID FROM EXCHANGE_MASTER A, CURRENCY_MASTER B WHERE A.CURRENCY_ID\=B.CURRENCY_ID AND A.COUNTRY_ID\=B.COUNTRY_ID AND A.COUNTRY_ID\=? AND A.AMEND_ID||A.EXCHANGE_ID||A.CURRENCY_ID IN(SELECT MAX(AMEND_ID)||EXCHANGE_ID||CURRENCY_ID FROM EXCHANGE_MASTER WHERE NVL(TO_DATE(?,'dd-mm-yyyy'),SYSDATE)+ 10 / 24 BETWEEN EFFECTIVE_DATE AND EXPIRY_DATE AND STATUS\='Y' AND COUNTRY_ID\=? GROUP BY EXCHANGE_ID,CURRENCY_ID) AND NVL(TO_DATE(?,'dd-mm-yyyy'),SYSDATE)+ 10 / 24 BETWEEN A.EFFECTIVE_DATE AND A.EXPIRY_DATE AND A.STATUS\='Y' AND B.STATUS\='Y' AND B.STATUS\='Y' AND A.STATUS\='Y' AND  B.AMEND_ID||B.CURRENCY_ID IN(SELECT MAX(AMEND_ID)||CURRENCY_ID FROM CURRENCY_MASTER WHERE EFFECTIVE_DATE <\=SYSDATE+10/24 AND STATUS\='Y' AND COUNTRY_ID\=? GROUP BY CURRENCY_ID) ORDER BY A.DISPLAY_ORDER
branch.wise.country=SELECT ORIGINATION_COUNTRY_ID FROM BRANCH_MASTER WHERE BRANCH_CODE=?
get.tax.info=SELECT DETAIL_NAME,PERCENT FROM CONSTANT_DETAIL WHERE CATEGORY_ID\='149' AND BRANCH_CODE\=?
update_pm_deposit=update POSITION_MASTER set DEPOSIT_REFERRAL\=? where application_no\=?
GET_PORTFOLIO_BY_DATE1=select rownum SNO,ENTRY_DATE,COU,product_id from(select to_char(a.entry_date,'YYYY-MM-DD') ENTRY_DATE ,count(a.entry_date) COU,a.product_id from position_master a,marine_data b,personal_info c where  a.entry_date between to_date(?,'dd/mm/yyyy') and to_date(?,'dd/mm/yyyy')+1 and a.remarks in ('Normal') and (b.ADMIN_REFERRAL_STATUS in('N') or b.ADMIN_REFERRAL_STATUS is null) and a.customer_id\=c.customer_id and a.application_no\=b.application_no  and lower(a.status) in (?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?) 
GET_PORTFOLIO_BY_DATE_APPEND1=) group by to_char(a.entry_date,'YYYY-MM-DD'),a.product_id order by to_char(a.entry_date,'YYYY-MM-DD') desc)
GET_PORTFOLIO_BY_DATE2=select rownum SNO,ENTRY_DATE,COU,product_id from(select to_char(a.inception_date,'YYYY-MM-DD')ENTRY_DATE,count(a.inception_date) COU,a.product_id from position_master a,marine_data b,personal_info c where  a.inception_date between to_date(?,'dd/mm/yyyy') and to_date(?,'dd/mm/yyyy')+1  and   a.customer_id=c.customer_id and a.application_no=b.application_no  and   lower(a.status) in(?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)
GET_PORTFOLIO_BY_DATE_APPEND2=)  group by to_char(a.inception_date,'YYYY-MM-DD'),a.product_id order by to_char(a.inception_date,'YYYY-MM-DD') desc)

### FOR MOTORS & OTHERS
GET_MOTORPORTFOLIO_BY_DATE1=select rownum SNO,ENTRY_DATE,COU from(select to_char(a.entry_date,'YYYY-MM-DD') ENTRY_DATE ,count(a.entry_date) COU from home_position_master a,personal_info c where  a.entry_date between to_date(?,'dd/mm/yyyy') and to_date(?,'dd/mm/yyyy')+1 and a.customer_id\=c.customer_id  and lower(a.status) in (?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?) 
GET_MOTORPORTFOLIO_BY_DATE_APPEND1=) group by to_char(a.entry_date,'YYYY-MM-DD') order by to_char(a.entry_date,'YYYY-MM-DD') desc)
GET_MOTORPORTFOLIO_BY_DATE2=select rownum SNO,ENTRY_DATE,COU from(select to_char(a.inception_date,'YYYY-MM-DD')ENTRY_DATE,count(a.inception_date) COU from home_position_master a,personal_info c where  a.inception_date between to_date(?,'dd/mm/yyyy') and to_date(?,'dd/mm/yyyy')+1  and   a.customer_id=c.customer_id and  lower(a.status) in(?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)
GET_MOTORPORTFOLIO_BY_DATE_APPEND2=)  group by to_char(a.inception_date,'YYYY-MM-DD') order by to_char(a.inception_date,'YYYY-MM-DD') desc)
GET_HOMEPORTFOLIO_PLIST = SELECT ROWNUM SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,pm.premium + NVL (pm.EXCESS_PREMIUM, '0') premium,NVL (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,TO_CHAR (pm.entry_date, 'dd-mm-yyyy'),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name FROM home_position_master pm, personal_info pi WHERE TO_CHAR (pm.inception_date, 'YYYY-MM-DD') = ? AND pi.customer_id = pm.customer_id AND decode(?,'ALL','A',pm.product_id) IN decode(?,'ALL','A',?) AND LOWER (pm.status) IN (?) and pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?)))
GET_HOMEPORTFOLIO_QLIST = SELECT ROWNUM SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,pm.premium + NVL (pm.EXCESS_PREMIUM, '0') premium,NVL (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,TO_CHAR (pm.entry_date, 'dd-mm-yyyy'),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name FROM home_position_master pm, personal_info pi WHERE TO_CHAR (pm.entry_date, 'YYYY-MM-DD') = ? AND pi.customer_id = pm.customer_id AND decode(?,'ALL','A',pm.product_id) IN decode(?,'ALL','A',?) AND LOWER (pm.status) IN (?) and pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?)))

#Date
CHECK_DATE_CONVEYAN=SELECT  COUNT (EFFECTIVE_DATE)FROM CONVEYAN_MASTER WHERE BRANCH_CODE\=? AND CONVDESC \= ? AND AMEND_ID \= (SELECT MAX (AMEND_ID)FROM CONVEYAN_MASTER WHERE CONVDESC \= ? AND BRANCH_CODE\=?)AND EFFECTIVE_DATE <\= TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'DD/MM/YYYY'), 'DD/MM/YYYY') FROM DUAL)
CHECK_DATE_COUNTRY=SELECT COUNT (EFFECTIVE_DATE)FROM COUNTRY_MASTER WHERE COUNTRY_ID \= ? and amend_id \= (SELECT MAX (amend_id) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= ?) AND EFFECTIVE_DATE <\= TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'DD/MM/YYYY'), 'DD/MM/YYYY') FROM DUAL)
CHECK_DATE_COUNTRY_DETAIL=SELECT COUNT (EFFECTIVE_DATE)FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID \= ? and amend_id \= (SELECT MAX (amend_id) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID \= ?) AND EFFECTIVE_DATE <\= TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'DD/MM/YYYY'), 'DD/MM/YYYY') FROM DUAL)
CHECK_DATE_BANK=SELECT COUNT (EFFECTIVE_DATE) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME \= ? and   amend_id \= (SELECT MAX (amend_id) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME \= ?) AND EFFECTIVE_DATE <\= TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'DD/MM/YYYY'), 'DD/MM/YYYY') FROM DUAL)
CHECK_DATE_MATERIAL=SELECT COUNT(EFFECTIVE_DATE) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_DESC \= ? and BRANCH_CODE\=? and amend_id \= (SELECT   MAX (amend_id) FROM MATERIAL_TYPE_MASTER WHERE BRANCH_CODE\=? and MATERIAL_DESC \= ?) AND EFFECTIVE_DATE <\= TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'DD/MM/YYYY'), 'DD/MM/YYYY') FROM DUAL)
CHECK_DATE_WAR=SELECT COUNT(EFFECTIVE_DATE) FROM WAR_RATE_MASTER WHERE WAR_DESC \= ? and MODE_TRANSPORT_ID\=? and BRANCH_CODE\=? and amend_id \= (SELECT MAX (amend_id) FROM WAR_RATE_MASTER WHERE WAR_DESC \= ? and MODE_TRANSPORT_ID\=? and BRANCH_CODE\=?) AND EFFECTIVE_DATE <\= TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'DD/MM/YYYY'), 'DD/MM/YYYY') FROM DUAL)
CHECK_DATE_COMMODITY_EXCESS=SELECT COUNT(EFFECTIVE_DATE)  FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED \= ? and END_SUM_INSURED\=? and BRANCH_CODE\=? and amend_id \= (SELECT MAX(amend_id) FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED \= ? and END_SUM_INSURED\=? and BRANCH_CODE\=?)  AND EFFECTIVE_DATE <\= TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'DD/MM/YYYY'), 'DD/MM/YYYY') FROM DUAL)
CHECK_DATE_EXCHANGE=SELECT COUNT (EFFECTIVE_DATE) FROM EXCHANGE_MASTER WHERE CURRENCY_ID\=?  and amend_id \= (SELECT   MAX (amend_id) FROM  EXCHANGE_MASTER WHERE CURRENCY_ID\=? ) AND EFFECTIVE_DATE <\= TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'DD/MM/YYYY'), 'DD/MM/YYYY') FROM DUAL)
CHECK_DATE_COVER=SELECT COUNT(EFFECTIVE_DATE) FROM COVER_MASTER WHERE COVER_ID\=? and BRANCH_CODE\=?  and   amend_id \= (SELECT MAX (amend_id)FROM COVER_MASTER WHERE COVER_ID\=? and BRANCH_CODE\=?)  AND EFFECTIVE_DATE <\= TO_DATE (?, 'DD/MM/YYYY') AND TO_DATE (?, 'DD/MM/YYYY')>\=(SELECT TO_DATE(TO_CHAR(SYSDATE, 'DD/MM/YYYY'), 'DD/MM/YYYY') FROM DUAL)

#Rating Engine

UPDATE_CONVEYAN_MASTER_UPDATE=UPDATE CONVEYAN_MASTER E SET E.CONVDESC=?,E.CONV_RATE=?,E.EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),E.STATUS=?,E.REMARKS=?,E.CORE_APP_ID=? WHERE E.BRANCH_CODE=? AND E.CONV_MEAN=? AND E.MODE_TRANSPORT_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN=E.CONV_MEAN AND BRANCH_CODE=E.BRANCH_CODE AND MODE_TRANSPORT_ID=E.MODE_TRANSPORT_ID)
UPDATE_COUNTRY_MASTER_UPDATE=UPDATE COUNTRY_MASTER E SET E.COUNTRY_NAME=?,E.GEO_RATE=?,E.EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),E.STATUS=?,COUNTRY_SHORT_NAME=?,NATIONALITY_NAME=?,RSACODE=?,REMARKS=? WHERE E.COUNTRY_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID)FROM COUNTRY_MASTER WHERE COUNTRY_ID=E.COUNTRY_ID)
UPDATE_COUNTRYDET_UPDATE=UPDATE COUNTRY_MASTER_DETAIL E SET E.COUNTRY_NAME=?,E.COUNTRY_SHORT_NAME=?,E.EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),E.STATUS=?,E.WAR_RATE=?,E.ENDING_PLACE=?,E.EP_WARRANTIES_CONDITIONS=?,E.NATIONALITY_NAME=?,E.REMARKS=?,E.SP_WARRANTIES_CONDITIONS=?,E.STARTING_PLACE=? ,RSACODE=? WHERE E.COUNTRY_ID=? AND E.BELONGING_COUNTRY_ID=(select BELONGING_BRANCH from branch_master where branch_code=?) AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID=E.COUNTRY_ID AND BELONGING_COUNTRY_ID=E.BELONGING_COUNTRY_ID)
UPDATE_BANK_MASTER_UPDATE=UPDATE OPEN_COVER_BANK_MASTER E SET E.BANK_NAME=?,E.EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),E.STATUS=?,E.RSACODE=?, E.REMARKS=? WHERE E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE bank_id=E.bank_id) and e.bank_id=?
UPDATE_MATERIAL_TYPE_MASTER_UPDATE=UPDATE MATERIAL_TYPE_MASTER E SET E.MATERIAL_DESC=?,E.EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),E.MATERIAL_RATE=?,E.STATUS=?,E.REMARKS=?,E.CORE_APP_ID=? WHERE E.MATERIAL_ID=? AND E.COVER_ID=? AND E.BRANCH_CODE=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_ID=E.MATERIAL_ID AND COVER_ID=E.COVER_ID AND BRANCH_CODE=E.BRANCH_CODE)
UPDATE_WAR_RATE_MASTER_INSERT=INSERT INTO WAR_RATE_MASTER (SNO, WAR_ID, WAR_DESC, WAR_RATE, MODE_TRANSPORT_ID, EFFECTIVE_DATE, AMEND_ID, BRANCH_CODE, CORE_APP_ID, STATUS,REMARKS)VALUES((SELECT MAX(SNO)+1 FROM WAR_RATE_MASTER),?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),(SELECT MAX(AMEND_ID)+1 FROM WAR_RATE_MASTER WHERE BRANCH_CODE=? AND WAR_ID=? AND MODE_TRANSPORT_ID=?),?,?,?,?)
UPDATE_COMEX_INSERT=INSERT INTO COMMODITY_EXCESS_PREMIUM (SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE , RATE, AMEND_ID, EFFECTIVE_DATE,BRANCH_CODE,STATUS) VALUES(?,?,?,?,?,( SELECT MAX(AMEND_ID)+1 FROM COMMODITY_EXCESS_PREMIUM WHERE BRANCH_CODE=?  AND SNO=? ),TO_DATE(?,'DD/MM/YYYY'),?,?)
UPDATE_EXCHANGE_MASTER_UPDATE=UPDATE EXCHANGE_MASTER E SET E.EXCHANGE_RATE=?,E.EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),E.STATUS=?,E.REMARKS=?,E.RSACODE=? WHERE E.EXCHANGE_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EXCHANGE_MASTER WHERE EXCHANGE_ID=E.EXCHANGE_ID)
UPDATE_COVER_MASTER_UPDATE=UPDATE COVER_MASTER E SET E.DESCRIPTION=?,E.EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),E.STATUS=?,E.REMARKS=?,E.COVER_RATE=? WHERE E.EXCHANGE_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID=E.COVER_ID)
UPDATE_CURRENCY_MASTER_UPDATE=UPDATE CURRENCY_MASTER C SET C.CURRENCY_NAME=?,C.EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),C.REMARKS=?,C.RFACTOR=?,C.RSACODE=?,C.SHORT_NAME=?,C.STATUS=?,C.SUB_CURRENCY=? WHERE C.CURRENCY_ID=? AND C.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID=C.CURRENCY_ID and country_id = (select country_id from branch_master where branch_code=?))

##
GET_COUNTRY_NAME_DET=select E.COUNTRY_NAME from COUNTRY_MASTER E WHERE  E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME\=E.COUNTRY_NAME)order by E.COUNTRY_NAME
GET_COUNTRY_NAME=select E.COUNTRY_NAME,E.COUNTRY_ID from COUNTRY_MASTER E WHERE  E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID\=E.COUNTRY_ID)order by E.COUNTRY_NAME
GET_COUNTRY_NEW_NAME=select distinct(e.country_name),e.country_id from country_master E where not exists (select country_name from country_master_detail cm where e.country_id\=cm.country_id) and E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE country_id\=E.country_id) and STATUS\='Y' order by country_name 
CHECK_COM_EX_COUNT_START=select count(*) from commodity_excess_premium where branch_code=? and START_SUM_INSURED between ? and (select MAX(START_SUM_INSURED) from commodity_excess_premium)
CHECK_COM_EX_COUNT_END=select count(*) from commodity_excess_premium where branch_code\=? and END_SUM_INSURED between ? and (select MAX(END_SUM_INSURED) from commodity_excess_premium)
CHECK_COVER_NAME=select count(C.COVER_NAME) from COVER_MASTER C, MODE_OF_TRANSPORT M where C.branch_code\=? and c.mode_transport_id\=? and C.AMEND_ID\=(select MAX(AMEND_ID) from COVER_MASTER where COVER_ID\=C.COVER_ID) and M.MODE_TRANSPORT_ID\=C.MODE_TRANSPORT_ID  AND C.MODE_TRANSPORT_ID \= M.MODE_TRANSPORT_ID AND M.BRANCH_CODE\=C.BRANCH_CODE AND  C.BRANCH_CODE\=? and cover_name\=(select cover_name from cover_master where cover_id\=? and branch_code\=?)
GET_COVER=select C.COVER_NAME,C.COVER_ID from COVER_MASTER C where C.branch_code=? and c.MODE_TRANSPORT_ID=? and C.AMEND_ID=(select MAX(AMEND_ID) from COVER_MASTER where COVER_ID=C.COVER_ID)  AND  C.BRANCH_CODE=?
report.chart.portfolio= SELECT  COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b WHERE {0}  A.effective_Date >= SYSDATE and a.status= ''P'' AND b.customer_id= a.customer_id AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND a.product_id=? and a.APPLICATION_ID=NVL(?,''1'') AND NVL(OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'') AND B.STATUS = ''Y'' AND ORIGINAL_POLICY_NO IS NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
report.quoteregister.chart.lapsed=SELECT COUNT(a.quote_no)  FROM POSITION_MASTER a, personal_info PI WHERE {0} A.effective_Date < SYSDATE and A.effective_Date+30 >=SYSDATE AND PI.customer_id = a.customer_id AND a.product_id =? AND a.status=''Y'' and a.APPLICATION_ID=NVL(?,''1'') AND NVL(OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')    AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
report.quoteregister.chart.existing=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a,MARINE_DATA m, personal_info b  WHERE {0}  A.effective_Date + 30 >\= SYSDATE  AND a.status \= ''Y''  AND (A.REMARKS NOT IN (''Admin'', ''Referal'', ''NORMAL_EXCESS_PRICE''))  AND b.customer_id \= a.customer_id  AND a.product_id \= ? AND a.APPLICATION_ID \= NVL(?,''1'') AND NVL(a.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND M.APPLICATION_NO  \= A.APPLICATION_NO AND NVL (M.ADMIN_REFERRAL_STATUS, ''N'') NOT IN (''Y'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)
report.referral.chart.unapproved=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b , MARINE_DATA MD WHERE {0} A.effective_Date  >\= SYSDATE AND (A.FREIGHT_STATUS NOT IN (''F'', ''B'') OR A.FREIGHT_STATUS IS NULL) AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND ( (A.REMARKS IN (''Referal'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'') OR (A.REMARKS IN (''Admin'', ''Normal'', ''Referal'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  \= ''Y'')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND a.product_id \=? AND a.APPLICATION_ID \= NVL(?,''1'') AND NVL(a.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)
report.referral.chart.approved=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b, MARINE_DATA MD  WHERE {0} A.effective_Date >= SYSDATE AND a.status = ''Y'' AND b.customer_id = a.customer_id  AND ( (A.REMARKS IN (''Admin'') AND MD.ADMIN_REFERRAL_STATUS  = ''N'') OR (A.REMARKS IN (''Admin'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  = ''N'')) AND MD.APPLICATION_NO  = A.APPLICATION_NO AND a.product_id =?  and a.APPLICATION_ID=NVL(?,''1'') AND NVL(A.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
report.referral.chart.reject=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b  WHERE {0} A.effective_date + 30 >\= SYSDATE AND a.status \= ''R'' AND b.customer_id \= a.customer_id  AND a.product_id \=?  and a.APPLICATION_ID\=? AND NVL(OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND A.QUOTE_NO IS NOT NULL AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)
report.chart.portfolio.amount= SELECT sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)) PREMIUM FROM POSITION_MASTER a, personal_info b  WHERE {0}  A.effective_Date >= SYSDATE and a.status= ''P'' AND b.customer_id= a.customer_id AND NVL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND a.product_id=? and a.APPLICATION_ID=NVL(?,''1'') AND NVL(OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'') AND B.STATUS = ''Y'' AND ORIGINAL_POLICY_NO IS NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
report.chart.quoteregister.lapsed.amount=SELECT sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)) PREMIUM  FROM POSITION_MASTER a, personal_info PI WHERE {0} A.effective_Date < SYSDATE and A.effective_Date+30 >=SYSDATE AND PI.customer_id = a.customer_id AND a.product_id =? AND a.status=''Y'' and a.APPLICATION_ID=NVL(?,''1'') AND NVL(OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')   AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
report.chart.existing.amount=SELECT sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)) PREMIUM FROM POSITION_MASTER a,MARINE_DATA m, personal_info b  WHERE {0}  A.effective_Date + 30 >\= SYSDATE  AND a.status \= ''Y''  AND (A.REMARKS NOT IN (''Admin'', ''Referal'', ''NORMAL_EXCESS_PRICE''))  AND b.customer_id \= a.customer_id  AND a.product_id \=? AND a.APPLICATION_ID \= NVL(?,''1'') AND NVL(a.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND  M.APPLICATION_NO  \= A.APPLICATION_NO AND  NVL (M.ADMIN_REFERRAL_STATUS, ''N'') NOT IN (''Y'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)
report.referral.chart.unapproved.amount=SELECT sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)) PREMIUM FROM POSITION_MASTER a, personal_info b, MARINE_DATA MD WHERE {0} A.effective_Date  >\= SYSDATE AND (A.FREIGHT_STATUS NOT IN (''F'', ''B'') OR A.FREIGHT_STATUS IS NULL) AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND ( (A.REMARKS IN (''Referal'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'') OR (A.REMARKS IN (''Admin'', ''Normal'', ''Referal'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  \= ''Y'')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND a.product_id \=? AND a.APPLICATION_ID \= NVL(?,''1'') AND NVL(a.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)  
report.referral.chart.approved.amount=SELECT sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)) PREMIUM FROM POSITION_MASTER a, personal_info b , MARINE_DATA MD  WHERE {0} A.effective_Date >\= SYSDATE AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND ( (A.REMARKS IN (''Admin'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'') OR (A.REMARKS IN (''Admin'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND a.product_id \=?  and a.APPLICATION_ID\=NVL(?,''1'') AND NVL(A.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) 
report.referral.chart.reject.amount=SELECT sum( nvl(a.PREMIUM,0)+nvl(a.EXCESS_PREMIUM,0)) PREMIUM FROM POSITION_MASTER a, personal_info b, MARINE_DATA MD  WHERE {0} A.effective_date + 30 >= SYSDATE AND (A.FREIGHT_STATUS NOT IN (''F'', ''B'') OR A.FREIGHT_STATUS IS NULL) AND a.status = ''R'' AND b.customer_id = a.customer_id  AND MD.APPLICATION_NO  = A.APPLICATION_NO  AND a.product_id =?  and a.APPLICATION_ID=? AND NVL(A.OPEN_COVER_NO,''0'') like NVL(? ||''%'',''0'')  AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)

##Login
GET_VALID_USER=select login_id,PWD_COUNT from login_master where login_id=? AND APP_ID=? AND STATUS in ('T','Y')
GET_VALID_PWD_DAY=SELECT ROUND(TRUNC(SYSDATE)-TRUNC(PASSDATE-45)) DAYS FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND APP_ID = ?
GET_VALID_PWD_TIME=SELECT ROUND(SYSDATE- PASSDATE-45) AS HOURS FROM LOGIN_MASTER WHERE LOGIN_ID=? AND APP_ID = ?
GET_USER_BASIC_INFO=SELECT   lm.LOGIN_ID, lm.USERTYPE, lm.BRANCH_CODE, lm.USER_MAIL, lm.STATUS, PWD_COUNT, USERNAME, bm.BRANCH_NAME, bm.BELONGING_BRANCH, lm.COUNTRY_ID, lm.MENU_ID,lm.ATTACHED_BRANCH,lm.ACCESSTYPE FROM   LOGIN_MASTER lm, branch_master bm WHERE   lm.LOGIN_ID = ? AND APP_ID = ? AND bm.branch_code = lm.branch_code and bm.STATUS = 'Y'
GET_MAIL_FORGOT_VALID=SELECT LOGIN_ID FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND USER_MAIL = ? AND APP_ID = ?
GET_COUNT_PWD=SELECT COUNT(*) num FROM (SELECT REGEXP_SUBSTR(PWD,'[^,]+',1,LEVEL) AS USERPWD FROM (SELECT PASSWORD||','||LPASS1||','||LPASS2||','||LPASS3||','||LPASS4||','||LPASS5 PWD FROM login_master WHERE LOGIN_ID=? AND STATUS IN ('Y','T') AND APP_ID = ?) CONNECT BY LEVEL <= LENGTH(PWD)-LENGTH(REPLACE(PWD,',',''))+1) WHERE USERPWD=?
UPD_USER_PWD=UPDATE LOGIN_MASTER SET LPASS5=LPASS4,LPASS4=LPASS3,LPASS3=LPASS2,LPASS2=LPASS1,LPASS1=PASSWORD,PASSWORD=?,PASSDATE=SYSDATE+45,STATUS='Y' WHERE LOGIN_ID=? AND APP_ID = ? AND STATUS IN ('Y','T')
UPD_USER_PWD_TEMP=UPDATE LOGIN_MASTER SET LPASS5\=LPASS4,LPASS4\=LPASS3,LPASS3\=LPASS2,LPASS2\=LPASS1,LPASS1\=PASSWORD,PASSWORD\=?,PASSDATE\=SYSDATE+45,STATUS\='T',PWD_COUNT\=0 WHERE LOGIN_ID\=? AND APP_ID \= ? 
GET_MAIL_DETAILS=SELECT MAIL_CC, SMTP_HOST, SMTP_USER, SMTP_PWD, EXP_DATE, EXP_TIME, PWD_CNT, PWD_LEN, HOME_APP  from MAIL_MASTER where APP_ID=?
GET_TEMP_PWD_EXP=SELECT TO_CHAR(SYSDATE+?/24,'DD-MM-YYYY hh:mi:ss AM') expireTime FROM DUAL
UPD_PWD_CNT_RESET=UPDATE LOGIN_MASTER SET PWD_COUNT\=0 WHERE LOGIN_ID\=? AND APP_ID \= ? 
UPD_PWD_CNT=UPDATE LOGIN_MASTER SET PWD_COUNT = NVL(PWD_COUNT,0)+1 WHERE LOGIN_ID= ? AND APP_ID = ?
GET_PWD_CNT_INVALID=SELECT PWD_COUNT FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND APP_ID = ?
UPD_PWD_STATUS=UPDATE LOGIN_MASTER SET STATUS = ? WHERE LOGIN_ID=? AND APP_ID = ?
GET_APP_LIST=select app_id, app_name from app_master
GET_APP_INFO=select app_name from app_master where app_id=?
INS_NEW_USER_WS=INSERT into LOGIN_MASTER(USERNAME, LOGIN_ID, PASSWORD, app_id, STATUS, USER_MAIL, USERTYPE, PASSDATE,STARTDATE,PWD_COUNT) values (?,?,?,?,?,?,?,sysdate+45,sysdate,'0')
INS_NEW_USER=INSERT into LOGIN_MASTER(USERNAME, LOGIN_ID, PASSWORD, app_id, STATUS, USER_MAIL, USERTYPE, PASSDATE,STARTDATE,PWD_COUNT) values (?,?,?,?,?,?,?,sysdate+45,to_date(?,'DD/MM/YYYY'),'0')
UPD_USER_INFO=UPDATE LOGIN_MASTER SET APP_ID=?, STATUS=?, USER_MAIL=?, USERTYPE=?,STARTDATE=to_date(?,'DD/MM/YYYY') WHERE LOGIN_ID=? AND APP_ID=?
UPD_MAIL_MASTER=UPDATE MAIL_MASTER SET MAIL_CC=?, SMTP_HOST=?, SMTP_USER=?, SMTP_PWD=?, EXP_TIME=? where app_id=?
UPD_MAIL_CHANGE_WS=UPDATE LOGIN_MASTER SET USER_MAIL=? WHERE LOGIN_ID=? AND APP_ID = ?
UPD_STATUS_CHANGE_WS=UPDATE LOGIN_MASTER SET STATUS=? WHERE LOGIN_ID=? AND APP_ID = ?
GET_USER_INFO_CHANGE=SELECT LOGIN_ID, USERTYPE, USERNAME, STATUS, USER_MAIL, APP_ID, to_char(STARTDATE,'DD/MM/YYYY') STARTDATE FROM LOGIN_MASTER WHERE LOGIN_ID=? AND APP_ID=?
GET_ITEM_VALUES = SELECT ITEM_CODE, ITEM_VALUE FROM LIST_ITEM_VALUES WHERE ITEM_TYPE\=?
INS_SESSION_INFO = INSERT INTO SESSION_MASTER(LOGIN_ID, SESSION_ID, START_TIME, STATUS, SYS_IP_ADDRESS) VALUES(?, ?, SYSDATE, 'Y', ?)
UPD_SESSION_INFO = UPDATE SESSION_MASTER SET END_TIME=SYSDATE WHERE LOGIN_ID=? AND STATUS='Y' AND SESSION_ID=?
GET_LOGINID_COUNT=select count(1) from login_master where login_id=? and APP_ID=?

##OPENCOVER REPORT ADMIN
GET_OPENCOVER_REPORT_LIST=select (select USERNAME from login_master where LOGIN_ID\=broker_id) broker_name,(select FIRST_NAME from personal_info pi where pi.customer_id\=b.customer_id and amend_id\=(select max(amend_id) from personal_info p where p.customer_id\=pi.customer_id)) customer_name,customer_id,open_cover_no,status,premium,commission,PRO_COMMISSION from ( select (select distinct(broker_id) from open_cover_master ocm where ocm.proposal_no in (select proposal_no from open_cover_position_master ocpm where ocpm.open_cover_no\=A.open_cover_no)) broker_id,(select distinct(customer_id) from open_cover_master ocm where ocm.proposal_no in (select proposal_no from open_cover_position_master ocpm where ocpm.open_cover_no\=A.open_cover_no)) customer_id,open_cover_no,status,premium,commission,PRO_COMMISSION from (select open_cover_no,count(status) status,nvl(sum(premium+excess_premium),0) premium,nvl(sum( COMMISSION),0) commission ,nvl(sum(PRO_COMMISSION),0) PRO_COMMISSION  from position_master  where status\='P' and product_id\='11' and open_cover_no is not null and INCEPTION_DATE between to_date(?,'DD/MM/YYYY') and to_date(?,'DD/MM/YYYY')+1 and login_id in( select login_id from login_master  where oa_code in (select distinct oa_code from login_master where
GET_MULTI_OPENCOVER_LIST=select count(VESSEL_NAME) vessel_count,VESSEL_NAME, TRANSACTION_ID,sum(PREMIUM) PREMIUM, sum(TOTAL_SUM_INSURED) TOTAL_SUM_INSURED from ( SELECT WMQ.VESSEL_NAME, WMQ.TRANSACTION_ID, PM.QUOTE_NO, MD.TOTAL_SUM_INSURED,(NVL (PM.PREMIUM, 0) + NVL (PM.EXCESS_PREMIUM, 0)) PREMIUM,( SELECT  CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END  FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID\=MPD.SETTLING_AGENT_ID) SETTLING_AGENT_NAME, (SELECT COUNT ( * FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_RESULT_DETAILS MRD,WEBSERVICE_MARINE_QUOTE WMQ, MARINE_POLICY_DETAILS MPD, login_master lm WHERE  MRD.APPLICATION_NO\=PM.APPLICATION_NO  AND WMQ.APPLICATION_NO\=PM.APPLICATION_NO AND PM.OPEN_COVER_INT_STATUS\='LINKED' and lm.login_id\=PM.LOGIN_ID AND PM.ENTRY_DATE between to_date(?,'dd/mm/yyyy') and  to_date(?,'dd/mm/yyyy')+1  and WMQ.branch_code\=?  AND PM.REMARKS IN ('Normal', 'Admin')  AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > (SELECT SYSDATE FROM DUAL) AND PM.APPLICATION_ID \= NVL('','1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO\=PM.APPLICATION_NO AND MPD.QUOTE_NO\=PM.QUOTE_NO) group by TRANSACTION_ID, VESSEL_NAME order by TRANSACTION_ID desc

##ADMIN DASHBOARD
GET_DASHBOARD_ADMIN=select * from table(chart_report(?,?,'Admin',?))
GET_DUBAITRADE_STATUS=SELECT DECODE (REMARKS, NULL, 'N', 'Y') DUBAI_TRADE_STATUS FROM CONSTANT_DETAIL WHERE DETAIL_NAME = ? AND CATEGORY_ID = 149 AND BRANCH_CODE = ? AND STATUS = 'Y'
GET_ENDT_QUOTENO=select distinct quote_no from marine_data_endt mde where ORIGINAL_POLICY_NO= (select ORIGINAL_POLICY_NO from marine_data_endt where quote_no=?) and ENDT_NO=(select max(ENDT_NO) from marine_data_endt where ORIGINAL_POLICY_NO=mde.ORIGINAL_POLICY_NO)
BROKER_DELETE_PRODUCT=delete from login_user_details where agency_code\=? and product_id\=?
INS_LC_NEW_VALUE_QUOTE=insert into open_cover_lc_master (lc_number,lc_amount,bank_id,AMEND_ID,LC_DATE, EFFECTIVE_DATE,ENTRY_DATE,Expiry_DATE,REMARKS,STATUS, open_cover_no,LC_ID, lc_currency_id,LC_BALANCE_AMOUNT,LC_ACTUAL_AMOUNT,LC_SALE_TERM_ID) values(?,?,?,?,TO_DATE(?,'dd/mm/yyyy'), SYSDATE,SYSDATE,SYSDATE+365,?,?, ?,?,?,?,?,(select SALE_TERM_ID from sale_term_master where SALE_TERM_NAME='Declared Value' and BRANCH_CODE=?))
UPD_LC_VALUE_QUOTE=update open_cover_lc_master set lc_amount=?,bank_id=?,AMEND_ID=?,LC_DATE =TO_DATE(?,'dd-mm-yyyy'),EXPIRY_DATE=sysdate+365, lc_currency_id=?,LC_ACTUAL_AMOUNT=?, LC_SALE_TERM_ID=( select SALE_TERM_ID from sale_term_master where SALE_TERM_NAME='Declared Value' and BRANCH_CODE=?), effective_date=sysdate where open_cover_NO=? and lc_number=? and lc_id=?
CHECK_VALID_PROMOTIONAL_CODE=select count(*) from promotional_rate_master prm where prm.PROMOTIONAL_CODE\=? and prm.BRANCH_CODE\=? and status\='Y' and prm.start_date<\=sysdate and prm.end_date>\=sysdate and amend_id\=(select max(amend_id) from promotional_rate_master prmm where prmm.PROMOTIONAL_CODE\=prm.PROMOTIONAL_CODE and prmm.BRANCH_CODE\=prm.BRANCH_CODE and prmm.status\='Y' and prmm.start_date<\=sysdate and prmm.end_date>\=sysdate)
GET_BRANCHS_LIST=select branch_code, branch_name from branch_master where status='Y' order by branch_code
UPD_WS_MARINE_QUOTE=call Webservice_Data(?,?,?)

#Rating Engine Queries
GET_COMM_CATEG_LIST=select COMMODITY_TYPEID,DETAIL_NAME from COMMODITY_CATEGORY_MASTER CCM  where BRANCH_CODE\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITY_CATEGORY_MASTER CM WHERE CM.BRANCH_CODE\=CCM.BRANCH_CODE and cm.COMMODITY_TYPEID\=ccm.COMMODITY_TYPEID)

#EXCESS DESC
UPD_EXCESS_DESC =UPDATE   WEBSERVICE_MARINE_COMMODITY wmc SET   EXCESS_DESCRIPTION =(SELECT   EXCESS_DESCRIPTION FROM   open_cover_commodity_detail occd WHERE COVER_ID=? AND PROPOSAL_NO =(SELECT   proposal_no FROM   open_cover_position_master ocpm WHERE   ocpm.OPEN_COVER_NO = ? AND amend_id =(SELECT   MAX (amend_id) FROM   open_cover_position_master ocpm1 WHERE   ocpm1.proposal_no = ocpm.proposal_no)) AND occd.COMMODITY_ID = wmc.COMMODITY_CODE AND occd.amend_id =(SELECT   MAX (amend_id) FROM   open_cover_commodity_detail occd1 WHERE   occd1.proposal_no = occd.proposal_no and occd.cover_id=occd1.cover_id  and occd.COMMODITY_ID=occd1.COMMODITY_ID )) WHERE   application_no = ?
UPD_EXCESS_DESC_CHD_WEB=UPDATE WEBSERVICE_MARINE_COMMODITY wmc SET  EXCESS_DESCRIPTION \=? where application_no \= ? 
UPD_EXCESS_DESC_CHD_MRD=update marine_result_details set EXCESS_DESCRIPTION \=? where application_no \= ? 

##Commodity Selection##
SER_COMM_SHOW = SELECT COMMODITY_CODE,SUPPLIER_NAME, (SELECT   DISTINCT (COMMODITY_NAME) FROM   COMMODITYMASTER CM WHERE   Wmc.COMMODITY_CODE = CM.COMMODITY_ID AND branch_code = ? and amend_id=(select max(amend_id) from COMMODITYMASTER C where c.COMMODITY_ID=CM.COMMODITY_ID)) COMMODITY_NAME, COMMODITY_DESCRIPTION, SUMINSURED, INVOICE_NUMBER, TO_CHAR (INVOICE_DATE, 'DD/MM/YYYY') INVOICE_DATE, TO_CHAR (INVOICE_DATE, 'DD/MM/YYYY') INVOICE_DATE1, PACKAGE_DESCRIPTION, FRAGILE,  DECODE (FRAGILE, 'on', 'Yes', 'off', 'No') FRAGILE_SELECT FROM WEBSERVICE_MARINE_COMMODITY Wmc WHERE APPLICATION_NO =?
commodity.add=INSERT INTO WEBSERVICE_MARINE_COMMODITY (COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED,SUPPLIER_NAME,PACKAGE_DESCRIPTION,INVOICE_NUMBER,INVOICE_DATE,FRAGILE,REFERENCE_NUMBER,APPLICATION_NO,EXCESS_DESCRIPTION) VALUES (?,?,?,?,?,?,to_date(?,'DD/MM/YYYY'),?,?,?,?)
commodity.delete=DELETE FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO\=? AND COMMODITY_CODE\=?
COMMODITY_EXIST=select count(commodity_description) from webservice_marine_commodity where COMMODITY_CODE\=? and application_no\=?
quotation.commodity =  SELECT NVL (B.SELECTED, 'false') SELECTED, A.COMMODITY_ID, NVL (B.COMMODITY_DESCRIPTION, A.COMMODITY_NAME) COMMODITY_NAME, B.SUMINSURED SUM_INSURED, B.PACKAGE_DESCRIPTION PACKAGE_DESC, B.INVOICE_NUMBER, B.INVOICE_DATE, B.INVOICE_DATE1, B.supplier_name, B.FRAGILE, B.FRAGILE_SELECTED, A.COMMODITY_TYPE_ID,B.EXCESS_DESCRIPTION FROM COMMODITYMASTER A JOIN (SELECT 'true' SELECTED, COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED, PACKAGE_DESCRIPTION, INVOICE_NUMBER, TO_CHAR (INVOICE_DATE, 'DD/MM/YYYY') INVOICE_DATE, TO_CHAR (INVOICE_DATE, 'DD/MM/YYYY') INVOICE_DATE1, supplier_name, FRAGILE, DECODE (FRAGILE, 'on', 'true', 'off', 'false') FRAGILE_SELECTED,EXCESS_DESCRIPTION FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO = ? AND COMMODITY_CODE = ?) B ON (B.COMMODITY_CODE = A.COMMODITY_ID) WHERE A.BRANCH_CODE = ? AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID = A.COMMODITY_ID AND BRANCH_CODE = A.BRANCH_CODE) ORDER BY COMMODITY_NAME
quotation.commodity.oc=SELECT NVL (B.SELECTED, 'false') SELECTED, A.COMMODITY_ID, A.COMMODITY_TYPE_ID, NVL (B.COMMODITY_DESCRIPTION, A.COMMODITY_NAME_DESC) COMMODITY_NAME, B.SUMINSURED SUM_INSURED, B.SUPPLIER_NAME, B.PACKAGE_DESCRIPTION PACKAGE_DESC, B.INVOICE_NUMBER, B.INVOICE_DATE, B.FRAGILE, B.FRAGILE_SELECTED,B.EXCESS_DESCRIPTION FROM OPEN_COVER_COMMODITY_MASTER A LEFT OUTER JOIN (SELECT 'true' SELECTED, COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED, SUPPLIER_NAME, PACKAGE_DESCRIPTION, INVOICE_NUMBER,  TO_CHAR (INVOICE_DATE, 'DD/MM/YYYY') INVOICE_DATE,FRAGILE, DECODE (FRAGILE, 'on', 'true', 'off', 'false') FRAGILE_SELECTED,EXCESS_DESCRIPTION FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO \= ?) B ON (B.COMMODITY_CODE \= A.COMMODITY_ID) WHERE A.PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?) AND A.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO\=A.PROPOSAL_NO) AND COMMODITY_ID\=? ORDER BY COMMODITY_NAME
 
#Constant master
INS_CONSTANT_MASTER = insert into CONSTANT_MASTER (CATEGORY_ID,CATEGORY_NAME,RSACODE,STATUS,BRANCH_CODE) values ((select nvl(max(CATEGORY_ID),0)+1 from CONSTANT_MASTER where BRANCH_CODE=?),?,?,?,?)
UPD_CONSTANT_MASTER = UPDATE CONSTANT_MASTER SET CATEGORY_NAME=?,STATUS=?,RSACODE=? WHERE CATEGORY_ID=? AND BRANCH_CODE=?
EDIT_CONSTANT_MASTER =SELECT * FROM CONSTANT_MASTER WHERE CATEGORY_ID\=? AND BRANCH_CODE\=?


##RATING UPLOAD
GET_SEQ_TRANS=SELECT SEQ_NAME FROM XL_UPLOAD_TRANSACTION_SERIES WHERE TYPE_ID=? AND STATUS='Y'
INS_TRANS_DET=INSERT INTO XL_UPLOAD_TRANSACTION_DETAILS (TRAN_ID,TRANSACTION_DATE,USER_NAME,FILE_NAME,PATH,STATUS,TYPE_ID,DOWN_STATUS,EFFECTIVE_DATE, BRANCH_CODE) VALUES(?, SYSDATE, ? , ?, ?, 'Y', ?, 'Y', ?, ?)
GET_DB_COLUMNS=SELECT A.EXCEL_HEADER_NAME, B.FIELD_NAME, A.MOBILE_NO_YN, A.MANDATORY_YN, A.DATA_TYPE, A.FIELD_ID, A.HEADER_TYPE FROM XL_UPLOAD_CONFIG_MASTER A, XL_UPLOAD_FIELD_MASTER B WHERE A.TYPE_ID=? AND A.TYPE_ID=B.TYPE_ID AND B.FIELD_ID=A.FIELD_ID AND A.STATUS='Y'
GET_TYPE_INFO=SELECT RAW_TABLE_NAME, MAIN_TABLE_NAME, ERROR_TABLE_NAME FROM XL_UPLOAD_TYPE_MASTER WHERE TYPE_ID\=?
GET_TRANS_DET=SELECT TRAN_ID, to_char(TRANSACTION_DATE,'dd/mm/yyyy') TRANSACTION_DATE, USER_NAME, FILE_NAME, TOTAL_RECORDS, VALID_RECORDS, ERROR_RECORDS  from XL_UPLOAD_TRANSACTION_DETAILS where TRANSACTION_DATE between to_date(?,'DD/MM/YYYY') and to_date(?,'DD/MM/YYYY')+1 and TYPE_ID=? order by tran_id desc
CHK_EXCHANGE_MASTER_EFF_DATE=select count(*) from exchange_master emm where effective_date > to_date(?,'DD/MM/YYYY') and emm.country_id=(select bm.COUNTRY_ID from branch_master bm, login_master lm where bm.branch_code=lm.branch_code and lm.login_id=?) and amend_id=(select nvl(max(amend_id),0) from exchange_master em where emm.country_id=em.country_id)
CHK_EFF_DATE=select count(sysdate) from dual where to_date(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY') <\= to_date(?,'DD/MM/YYYY')

### BRANCH MASTER
BR_GET_COUNTRIES=SELECT DISTINCT(COUNTRY_ID), COUNTRY_NAME FROM COUNTRY_MASTER ORDER BY COUNTRY_NAME
BR_GET_CURRENCIES=SELECT  DISTINCT(CURRENCY_ID),CURRENCY_NAME FROM CURRENCY_MASTER ORDER BY CURRENCY_NAME
BR_GET_CITIES=SELECT DISTINCT(CITY_ID),CITY_NAME FROM CITY_MASTER WHERE COUNTRY_ID=? ORDER BY CITY_NAME
BR_SAVE_BRANCH=Insert into BRANCH_MASTER (SNO__, BRANCH_CODE, BRANCH_NAME, STATUS, ADDRESS1,ADDRESS2, ADDRESS3, CITY, COUNTRY, PHONE, FAX, EMAIL, AMEND_ID, EFFECTIVE_DATE, REMARKS,HEADER_IMG, FOOTER_IMG, SIGN_IMG, STAMP, CURRENCY_NAME, CURRENCY_ABBREVIATION, CURRENCY_ACRONYM,ORIGINATION_COUNTRY_ID, DESTINATION_COUNTRY_ID, CURRENCY_DECIMAL_NAME,CURRENCY_DECIMAL_DIGIT, DECIMAL_PLACES, TAX, BRANCH_PREFIX ,LANG_YN,BELONGING_BRANCH) Values ((select nvl(max(SNO__),0)+1 from BRANCH_MASTER),(select '0'||to_char(nvl(max(BRANCH_CODE),0)+1) from BRANCH_MASTER),?, ?, ?,?,?,?,?,?,?,?,?, to_date(?,'mm/dd/yy'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select BELONGING_BRANCH from BRANCH_MASTER bm where bm.BRANCH_CODE=? and  AMEND_ID=(select max(AMEND_ID) from BRANCH_MASTER where BRANCH_CODE=bm.BRANCH_CODE)))
BR_LOAD_LIST=Select BRANCH_NAME,BRANCH_CODE,CITY,EMAIL,decode(STATUS,'Y','Active','DeActive') STATUS from branch_Master
BR_GET_SEL_BROKER=SELECT SNO__, BRANCH_CODE, BRANCH_NAME, STATUS, ADDRESS1,ADDRESS2, ADDRESS3, CITY, COUNTRY, PHONE, FAX, EMAIL, AMEND_ID,to_char(EFFECTIVE_DATE,'mm/dd/yy') EFFECTIVE_DATE, REMARKS,HEADER_IMG, FOOTER_IMG, SIGN_IMG, STAMP, CURRENCY_NAME, CURRENCY_ABBREVIATION, CURRENCY_ACRONYM,ORIGINATION_COUNTRY_ID, DESTINATION_COUNTRY_ID, CURRENCY_DECIMAL_NAME,CURRENCY_DECIMAL_DIGIT, DECIMAL_PLACES, TAX,BRANCH_PREFIX,LANG_YN,BELONGING_BRANCH FROM BRANCH_MASTER bm where  bm.BRANCH_CODE\=? and AMEND_ID\=(select max(AMEND_ID) from  BRANCH_MASTER where  BRANCH_CODE\=bm.BRANCH_CODE)
BR_GET_BELONG_BRCH=SELECT BRANCH_CODE,BRANCH_NAME FROM BRANCH_MASTER
BR_UPDATE_BRANCH=UPDATE BRANCH_MASTER SET BRANCH_NAME\=?, STATUS\=?, ADDRESS1\=?,ADDRESS2\=?, ADDRESS3\=?, CITY\=?, COUNTRY\=?, PHONE\=?, FAX\=?, EMAIL\=?, AMEND_ID\=?, EFFECTIVE_DATE\=to_date(?,'mm/dd/yy'), REMARKS\=?,HEADER_IMG\=?, FOOTER_IMG\=?, SIGN_IMG\=?, STAMP\=?, CURRENCY_NAME\=?, CURRENCY_ABBREVIATION\=?, CURRENCY_ACRONYM\=?,ORIGINATION_COUNTRY_ID\=?, DESTINATION_COUNTRY_ID\=?, CURRENCY_DECIMAL_NAME\=?,CURRENCY_DECIMAL_DIGIT\=?, DECIMAL_PLACES\=?, TAX\=?, BRANCH_PREFIX\=? ,LANG_YN\=?,BELONGING_BRANCH\=(select BELONGING_BRANCH from BRANCH_MASTER bm where bm.BRANCH_CODE\=? and  AMEND_ID\=(select max(AMEND_ID) from BRANCH_MASTER where BRANCH_CODE\=bm.BRANCH_CODE)) WHERE  BRANCH_CODE\=?


#GET DEDUCTABLES
GET_DEDUCT=SELECT NVL(DEDUCTIBLE,'0') DEDUCTIBLE,nvl(RATE,'0') RATE  FROM COMMODITY_EXCESS_PREMIUM CEP WHERE ? BETWEEN START_SUM_INSURED AND END_SUM_INSURED AND STATUS='Y' AND AMEND_ID =   (SELECT MAX (AMEND_ID) FROM COMMODITY_EXCESS_PREMIUM WHERE ? BETWEEN START_SUM_INSURED AND END_SUM_INSURED and STATUS = CEP.STATUS )
#For Commission
GET_COMMISSION_DETAILS=SELECT NVL (lud.COMMISSION, 0) COMMISSION FROM login_user_details lud WHERE lud.agency_code = (Select oa_code from login_master lm where  lm.login_id = (Select login_id from position_master where application_no=?)) AND lud.product_id = ? AND lud.amend_id =(SELECT   MAX (amend_id) FROM  login_user_details ludd WHERE   lud.login_id = ludd.login_id AND ludd.product_id = lud.product_id)
UPD_COMMISSION_DETAILS=UPDATE POSITION_MASTER A SET DISCOUNT_PREMIUM\=? WHERE A.APPLICATION_NO\=? AND A.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO\=A.APPLICATION_NO)

#LC FILE UPLOAD
GET_LC_UPLOAD_DETAILS = select pi.First_name, pm.policy_no from position_master pm, personal_info pi where pm.policy_no=? and  pm.customer_id=pi.customer_id
GET_LC_UPLOAD_POLICY_DTLS = select ocbm.bank_name,mpd.lc_number,to_char(mpd.LC_DATE,'dd/mm/yyyy') LC_DATE,mpd.BL_AWB_NO,to_char(mpd.BL_AWB_DATE,'dd/mm/yyyy') BL_AWB_DATE,to_char(mpd.SAILING_DATE,'dd/mm/yyyy') SAILING_DATE  from marine_policy_details mpd, open_cover_bank_master ocbm,position_master pm where pm.policy_no=? and mpd.QUOTE_NO=pm.quote_no and mpd.BANK_NAME=ocbm.BANK_ID and ocbm.amend_id=(select max(amend_id) from open_cover_bank_master ocbm1 where ocbm1.bank_id=ocbm.bank_id)
GET_LC_UPLOAD_POL_DTLS =select mrd.invoice_number, to_char(mrd.invoice_date,'DD/MM/YYYY') invoice_date,mrd.DESCRIPTION from marine_result_details mrd, position_master pm where pm.policy_no\=? and mrd.application_no\=pm.application_no
GET_DOCUMENTS_LIST = select file_name,original_file,remarks from lc_file_upload_dtls where POLICY_NO=? order by upload_id
LC_FILE_INSERT = insert into LC_FILE_UPLOAD_DTLS(POLICY_NO,FILE_NAME,LOGIN_ID,ORIGINAL_FILE,REMARKS,STATUS,UPLOAD_ID) values(?,?,?,?,?,?,?)
GET_LC_FILE_LIST = select UPLOAD_ID,ORIGINAL_FILE,FILE_NAME,remarks from LC_FILE_UPLOAD_DTLS where POLICY_NO=? order by upload_id
LC_FILE_DELETE = delete from LC_FILE_UPLOAD_DTLS where UPLOAD_ID=?

#####Claim Query
GET_CLAIM_APP=Select Application_No,regexp_substr(Policy_No,'[^/]+',1,1) Branch_code,TO_CHAR(Trunc(pm.INCEPTION_DATE),'DD/MM/YYYY HH/MM/SS') INCEPTION_DATE  From Position_Master pm Where Regexp_substr(Policy_No,'[^-]+',1,1)=? and amend_id=(Select max(Amend_id) from position_master p Where  Regexp_substr(P.Policy_No,'[^-]+',1,1)=Regexp_substr(pm.Policy_No,'[^-]+',1,1))
GET_CLAIM_SCHEDULE=select * from table(schedule_reports(?,?,?,?))
GET_COUNT_POLICYNO=SELECT COUNT(POLICY_NO) FROM POSITION_MASTER WHERE POLICY_NO=?
COUNT_CLAIM_POLICYNO=SELECT COUNT(POLICY_NO) FROM Claim_Intimation  WHERE POLICY_NO\=? and status\=? 
GET_CLAIM_CONDITION=SELECT CODEDESC FROM TABLE(SELECT VIEWCLAUSES(?,?,?) FROM DUAL)
GET_BELONGING_BRANCH=select BELONGING_BRANCH from BRANCH_MASTER bm where bm.BRANCH_CODE=? and  AMEND_ID=(select max(AMEND_ID) from BRANCH_MASTER where BRANCH_CODE=bm.BRANCH_CODE)
SAVE_CLAIM=INSERT INTO CLAIM_INTIMATION (POLICY_NO,LOSS_DATE,LOSS_DESCRIPTION,INTIMATION_DATE,CLAIM_REPORTED_DATE,STATUS,REMARKS,SNO,CUSTOMER_NAME)VALUES(?,?,?,SYSDATE,SYSDATE,?,?,?,?)
GET_CLAIM_INTIMATION=Select Count(Policy_No) POLICY_COUNT,TO_CHAR(Trunc(Ci.Intimation_Date),'DD/MM/YYYY') INTIMATION_DATES From Claim_Intimation Ci WHERE STATUS\=? Group By Trunc(Ci.Intimation_Date) Order By Trunc(Ci.Intimation_Date) Asc 
GET_CLAIM_PENDING=select policy_no,customer_name,TO_CHAR(Trunc(Ci.claim_reported_date),'DD/MM/YYYY') REPORTED_DATE,loss_description from claim_intimation ci where TO_CHAR(Trunc(Ci.Intimation_Date),'DD/MM/YYYY')=? AND STATUS=?
GET_CLAIM_EXTRA_DETAIL=SELECT TO_CHAR(Trunc(Ci.LOSS_DATE),'DD/MM/YYYY') LOSS_DATE,LOSS_DESCRIPTION,TO_CHAR(Trunc(Ci.INTIMATION_DATE),'DD/MM/YYYY') INTIMATION_DATE FROM CLAIM_INTIMATION Ci WHERE POLICY_NO =? and STATUS=?
UPDATE_CLAIM=UPDATE CLAIM_INTIMATION SET REMARKS=?,STATUS=?,REMARKS_DATE=SYSDATE  WHERE POLICY_NO=?
GET_LIST_FOR_INTIMATE_VEHICLE = SELECT   (SELECT   MAKE_NAME FROM   motor_make_master mmm WHERE   mmm.MAKE_ID = mdd.MAKE_ID) Make, MANUFACTURE_YEAR Year, REGISTRATION_NO, ENGINE_NUMBER, CHASSIS_NO, mdd.AMEND_ID, mdd.APPLICATION_NO, (SELECT   COLOR_DESC_ENGLISH FROM  motor_color_master mcm WHERE   mdd.VEHICLE_COLOR = mcm.COLOR_ID) COLOR FROM   motor_data_detail mdd ,home_position_master hpm where mdd.QUOTE_NO =hpm.QUOTE_NO AND hpm.POLICY_NO = ? AND MDD.VEHICLE_ID = ? and  hpm.APPLICATION_NO=mdd.APPLICATION_NO AND mdd.amend_id = (SELECT   MAX (amend_id) FROM  motor_data_detail mdds WHERE   mdd.quote_no = mdds.quote_no AND mdd.APPLICATION_NO = mdds.APPLICATION_NO)
GET_LIST_FOR_INTIMATE_POLICY = SELECT * FROM (SELECT FIRST_NAME || LAST_NAME InsuredName, CUSTOMER_ID, Occupation, MOBILE, EMAIL, ADDRESS1 || ' ' || ADDRESS2 || ' ' || POBOX Address FROM   personal_info) pi, (SELECT   TO_CHAR (Policystartdate, 'dd/mm/yyyy') policy_start_date, TO_CHAR (Policyenddate, 'dd/mm/yyyy ') policy_end_date, QUOTENO,ISSELECTCOVER FROM   Motor_Policy_Details) mpd, home_position_master hpm WHERE  hpm.quote_no \= mpd.quoteno AND pi.CUSTOMER_ID \= hpm.CUSTOMER_ID AND hpm.POLICY_NO \= ? AND hpm.amend_id \= (SELECT MAX (amend_id) FROM   home_position_master hpms WHERE   hpms.quote_no \= hpm.quote_no AND hpms.customer_id \= hpm.customer_id)
GET_INTIMATE_FOR_INSERT = INSERT into motor_claim_intimation (SOLE_OWNER_YN,FINANCIERS,NAME_OF_DRIVER,DRIVER_DOB,LICENSE_NO,DATE_OBTAINED,LOSS_DATE,LOSS_TIME,LOSS_PLACE,LOSS_SPEED,LOSS_PURPOSE_DESC,LOSS_DETAILS_DESC,LOSS_REPORT_YN,LOSS_DATE_REPORTED,LOSS_TIME_REPORTED,LOSS_POLICE_VISIT_YN,POLICE_OFFICER_NAME,IDENTITY_NO,POLICE_STATION_NAME,LOSS_LOCATION,DRIVER_DESC,DECLARATION,POLICY_NO,VEHICLE_ID) VALUES(?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,?,?) 
GET_INTIMATE_THIRD_PARTY_FOR_INSERT = INSERT into motor_claim_intimation_tpa (PASSENGER_NAME_A,PASSENGER_NAME_B,PASSENGER_PHONENO_A,PASSENGER_PHONENO_B,PASSENGER_ADDRESS_A,PASSENGER_ADDRESS_B,PASSENGER_INJURY_A,PASSENGER_INJURY_B,HOSPITAL_NAME,NAME_OF_DOCTOR,DOC_TELEPHONE_NO,THIRD_PARTY_NAME,THIRD_PARTY_PROPERTY_DETAIL,THIRD_PARTY_OWNER_NAME,THIRD_PARTY_OWNER_TELEPHONE_NO,DRIVER_NAME,PHYSICAL_ADDRESS,REGISTER_NO,MAKE,NAME_OF_INSURER,POLICY_NO,VEHICLE_ID) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) 
##Claim Intimation
GET_LIST_FOR_INTIMATE_VIEW = SELECT SOLE_OWNER_YN,FINANCIERS,NAME_OF_DRIVER,LICENSE_NO,TO_CHAR(DATE_OBTAINED,'DD/MM/YYYY') DATE_OBTAINED,TO_CHAR(LOSS_DATE,'DD/MM/YYYY') LOSS_DATE,LOSS_TIME,LOSS_PLACE,LOSS_SPEED,LOSS_PURPOSE_DESC,LOSS_DETAILS_DESC,LOSS_REPORT_YN,TO_CHAR(LOSS_DATE_REPORTED,'DD/MM/YYYY') LOSS_DATE_REPORTED,LOSS_TIME_REPORTED,LOSS_POLICE_VISIT_YN,POLICE_OFFICER_NAME,IDENTITY_NO,POLICE_STATION_NAME,LOSS_LOCATION,DRIVER_DESC,DECLARATION,TO_CHAR(DRIVER_DOB,'DD/MM/YYYY') DRIVER_DOB FROM motor_CLAIM_INTIMATION WHERE POLICY_NO = ? AND VEHICLE_ID=?
GET_LIST_FOR_INTIMATE_THIRD_PARTY_VIEW = SELECT NAME_OF_DOCTOR,DOC_TELEPHONE_NO,THIRD_PARTY_NAME,THIRD_PARTY_OWNER_TELEPHONE_NO,DRIVER_NAME,PHYSICAL_ADDRESS,REGISTER_NO,MAKE,NAME_OF_INSURER,HOSPITAL_NAME,THIRD_PARTY_PROPERTY_DETAIL,THIRD_PARTY_OWNER_NAME,PASSENGER_NAME_A,PASSENGER_NAME_B,PASSENGER_ADDRESS_A,PASSENGER_ADDRESS_B,PASSENGER_PHONENO_A,PASSENGER_PHONENO_B,PASSENGER_INJURY_A,PASSENGER_INJURY_B FROM MOTOR_CLAIM_INTIMATION_TPA WHERE POLICY_NO \= ? AND VEHICLE_ID\=?
GET_INTIMATE_FOR_EDIT = SELECT DECODE (SOLE_OWNER_YN, 'Y', 'Yes', 'No') SOLE_OWNER_YN,FINANCIERS,NAME_OF_DRIVER,TO_CHAR(DRIVER_DOB,'DD/MM/YYYY') DRIVER_DOB,LICENSE_NO,TO_CHAR(DATE_OBTAINED,'DD/MM/YYYY') DATE_OBTAINED,TO_CHAR(LOSS_DATE,'DD/MM/YYYY') LOSS_DATE,LOSS_TIME,LOSS_PLACE,LOSS_SPEED,LOSS_PURPOSE_DESC,LOSS_DETAILS_DESC,DECODE (LOSS_REPORT_YN, 'Y', 'Yes', 'No') LOSS_REPORT_YN,TO_CHAR(LOSS_DATE_REPORTED,'DD/MM/YYYY') LOSS_DATE_REPORTED,LOSS_TIME_REPORTED,DECODE (LOSS_POLICE_VISIT_YN, 'Y', 'Yes', 'No') LOSS_POLICE_VISIT_YN,POLICE_OFFICER_NAME,IDENTITY_NO,POLICE_STATION_NAME,LOSS_LOCATION,DRIVER_DESC FROM MOTOR_CLAIM_INTIMATION WHERE POLICY_NO \= ? AND VEHICLE_ID\=?
GET_INTIMATE_THIRD_PARTY_FOR_EDIT = SELECT PASSENGER_NAME_A,PASSENGER_NAME_B,PASSENGER_PHONENO_A,PASSENGER_PHONENO_B,PASSENGER_ADDRESS_A,PASSENGER_ADDRESS_B,PASSENGER_INJURY_A,PASSENGER_INJURY_B,HOSPITAL_NAME,NAME_OF_DOCTOR,DOC_TELEPHONE_NO,THIRD_PARTY_NAME,THIRD_PARTY_PROPERTY_DETAIL,THIRD_PARTY_OWNER_NAME,THIRD_PARTY_OWNER_TELEPHONE_NO,DRIVER_NAME,PHYSICAL_ADDRESS,REGISTER_NO,MAKE,NAME_OF_INSURER FROM MOTOR_CLAIM_INTIMATION_TPA WHERE POLICY_NO \= ? AND VEHICLE_ID\=?
GET_INTIMATE_FOR_UPDATE = UPDATE MOTOR_CLAIM_INTIMATION SET SOLE_OWNER_YN\=?,FINANCIERS\=?,NAME_OF_DRIVER\=?,DRIVER_DOB\=TO_DATE(?,'DD/MM/YYYY'),LICENSE_NO\=?,DATE_OBTAINED\=TO_DATE(?,'DD/MM/YYYY'),LOSS_DATE\=TO_DATE(?,'DD/MM/YYYY'),LOSS_TIME\=?,LOSS_PLACE\=?,LOSS_SPEED\=?,LOSS_PURPOSE_DESC\=?,LOSS_DETAILS_DESC\=?,LOSS_REPORT_YN\=?,LOSS_DATE_REPORTED\=TO_DATE(?,'DD/MM/YYYY'),LOSS_TIME_REPORTED\=?,LOSS_POLICE_VISIT_YN\=?,POLICE_OFFICER_NAME\=?,IDENTITY_NO\=?,POLICE_STATION_NAME\=?,LOSS_LOCATION\=?,DRIVER_DESC\=?,DECLARATION\=? WHERE POLICY_NO \=? AND VEHICLE_ID\=?
GET_INTIMATE_THIRD_PARTY_FOR_UPDATE = UPDATE MOTOR_CLAIM_INTIMATION_TPA SET PASSENGER_NAME_A \=?,PASSENGER_NAME_B \=?,PASSENGER_PHONENO_A\=?,PASSENGER_PHONENO_B\=?,PASSENGER_ADDRESS_A \=?,PASSENGER_ADDRESS_B \=?,PASSENGER_INJURY_A\=?,PASSENGER_INJURY_B\=?,HOSPITAL_NAME\=?,NAME_OF_DOCTOR\=?,DOC_TELEPHONE_NO\=?,THIRD_PARTY_NAME\=?,THIRD_PARTY_PROPERTY_DETAIL\=?,THIRD_PARTY_OWNER_NAME\=?,THIRD_PARTY_OWNER_TELEPHONE_NO\=?,DRIVER_NAME\=?,PHYSICAL_ADDRESS\=?,REGISTER_NO\=?,MAKE\=?,NAME_OF_INSURER\=? WHERE POLICY_NO \=? AND VEHICLE_ID\=?
CHECK_INTIMATE_COMP = SELECT COUNT(*) FROM MOTOR_CLAIM_INTIMATION WHERE POLICY_NO=? AND VEHICLE_ID=?
CHECK_INTIMATE_TPA = SELECT COUNT(*) FROM MOTOR_CLAIM_INTIMATION_TPA WHERE POLICY_NO=? AND VEHICLE_ID=?
GET_CHECK_FOR_INTIMATE_POLICY = SELECT ISSELECTCOVER FROM MOTOR_POLICY_DETAILS MPD,HOME_POSITION_MASTER HPM WHERE POLICY_NO \=? AND MPD.APPLICATIONNO \= HPM.APPLICATION_NO
##Claim Intimation Admin
GET_CLAIM_INTIMATE_REPORT_LIST = SELECT MCI.POLICY_NO, (SELECT MAKE_NAME  FROM MOTOR_MAKE_MASTER MMM  WHERE MMM.MAKE_ID= MDD.MAKE_ID  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_MAKE_MASTER MMMS WHERE MMM.MAKE_ID= MMMS.MAKE_ID) ) MAKE_NAME, (SELECT MODEL_NAME FROM MOTOR_MODEL_MASTER  MMM  WHERE MMM.MODEL_ID= MDD.MODEL_ID AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_MODEL_MASTER MMMS WHERE MMM.MODEL_ID= MMMS.MODEL_ID) ) MODEL_NAME FROM HOME_POSITION_MASTER HPM,MOTOR_DATA_DETAIL MDD,MOTOR_CLAIM_INTIMATION MCI WHERE  MCI.POLICY_NO=HPM.POLICY_NO AND  HPM.QUOTE_NO=MDD.QUOTE_NO AND HPM.APPLICATION_NO=MDD.APPLICATION_NO AND TRUNC(mci.ENTRY_DATE) Between to_date(?,'DD/MM/YYYY') and  to_date(?,'DD/MM/YYYY') AND HPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM  HOME_POSITION_MASTER HPMS WHERE HPM.QUOTE_NO=HPMS.QUOTE_NO AND HPM.APPLICATION_NO=HPMS.APPLICATION_NO )
GET_CLAIM_INTIMATE_TPA_REPORT_LIST = SELECT MCIT.POLICY_NO, (SELECT MAKE_NAME  FROM MOTOR_MAKE_MASTER MMM  WHERE MMM.MAKE_ID= MDD.MAKE_ID  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_MAKE_MASTER MMMS WHERE MMM.MAKE_ID= MMMS.MAKE_ID) ) MAKE_NAME, (SELECT MODEL_NAME FROM MOTOR_MODEL_MASTER  MMM  WHERE MMM.MODEL_ID= MDD.MODEL_ID AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_MODEL_MASTER MMMS WHERE MMM.MODEL_ID= MMMS.MODEL_ID) ) MODEL_NAME FROM HOME_POSITION_MASTER HPM,MOTOR_DATA_DETAIL MDD,MOTOR_CLAIM_INTIMATION_TPA MCIT WHERE  MCIT.POLICY_NO=HPM.POLICY_NO AND  HPM.QUOTE_NO=MDD.QUOTE_NO AND HPM.APPLICATION_NO=MDD.APPLICATION_NO AND TRUNC(mcit.ENTRY_DATE) Between to_date(?,'DD/MM/YYYY') and  to_date(?,'DD/MM/YYYY') AND HPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM  HOME_POSITION_MASTER HPMS WHERE HPM.QUOTE_NO=HPMS.QUOTE_NO AND HPM.APPLICATION_NO=HPMS.APPLICATION_NO )
##ENDORSAMENT 
GET_ENDORSEMENT_DROPDOWN=Select * from endt_type_master Where Product_id\=65 ORDER BY ENDT_TYPE 
INS_MOTOR_OTHERENDORSEMENT=INSERT INTO MOTOR_VECHICLE_ENDT_DETAILS(POLICY_NO,VEHICLE_ID,ENDORSEMENT_ID,REMARKS,REFERENCE_NO) VALUES (?,?,?,?,?)
#######MAIL INFORMATION#########
GET_QUOTE_MAILIDS = SELECT DECODE(APPLICATION_ID,'1','',(SELECT USER_MAIL FROM LOGIN_MASTER WHERE LOGIN_ID=PM.APPLICATION_ID)) CC_ADDRESS, (SELECT USER_MAIL FROM LOGIN_MASTER WHERE AGENCY_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID)) TO_ADDRESS FROM POSITION_MASTER PM WHERE APPLICATION_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER PM1 WHERE  PM1.APPLICATION_NO=PM.APPLICATION_NO)
GET_QUOTE_USER_MAILIDS = SELECT DECODE(APPLICATION_ID,'1','',(SELECT USER_MAIL FROM LOGIN_MASTER WHERE LOGIN_ID\=PM.APPLICATION_ID)) CC_ADDRESS, (SELECT USER_MAIL FROM LOGIN_MASTER WHERE AGENCY_CODE \= (SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=PM.LOGIN_ID)) TO_ADDRESS FROM POSITION_MASTER PM WHERE APPLICATION_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER PM1 WHERE  PM1.APPLICATION_NO\=PM.APPLICATION_NO)
GET_REFERRAL_MAIL_DATAS = SELECT PM.QUOTE_NO,PM.APPLICATION_ID, NVL (md.remarks, 'Normal') REFERRAL_REMARKS, DECODE (PM.APPLICATION_ID, '1', '', (SELECT LM.USERNAME FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID = PM.APPLICATION_ID)) ISSUER_NAME, (PI.TITLE || ' ' || PI.first_name || ' ' || PI.Last_name) CUSTOMER_NAME, (SELECT NVL (BCM.company_name, ' ') FROM broker_company_master BCM WHERE BCM.agency_code = (SELECT LM.oa_code FROM login_master LM WHERE LM.login_id = PM.LOGIN_ID)) BROKER_COMPANY_NAME FROM POSITION_MASTER PM, MARINE_DATA MD, PERSONAL_INFO PI WHERE PM.APPLICATION_NO = ? AND MD.APPLICATION_NO = PM.APPLICATION_NO AND PM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.APPLICATION_NO = PM.APPLICATION_NO) AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PI1 WHERE PI1.CUSTOMER_ID = PI.CUSTOMER_ID) AND MD.AMEND_ID = (SELECT MAX (AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO = MD.APPLICATION_NO)
GET_REFERRAL_USER_MAIL_DATAS =SELECT PM.QUOTE_NO,PM.APPLICATION_ID, NVL (md.remarks, 'Normal') REFERRAL_REMARKS, DECODE (PM.APPLICATION_ID, '1', '', (SELECT LM.USERNAME FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID \= PM.APPLICATION_ID)) ISSUER_NAME, (PI.TITLE || ' ' || PI.first_name || ' ' || PI.Last_name) CUSTOMER_NAME, DECODE (PM.APPLICATION_ID,'1',(SELECT (PI.first_name || ' ' || PI.Last_name) CUSTOMER_NAME FROM PERSONAL_INFO UPI WHERE UPI.LOGIN_ID\=PM.LOGIN_ID AND UPI.APPLICATION_ID\='2'),(SELECT NVL (BCM.company_name, ' ') FROM broker_company_master BCM WHERE BCM.agency_code \= (SELECT LM.oa_code FROM login_master LM WHERE LM.login_id \= PM.LOGIN_ID))) BROKER_COMPANY_NAME FROM POSITION_MASTER PM, MARINE_DATA MD, PERSONAL_INFO PI WHERE PM.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.APPLICATION_NO \= PM.APPLICATION_NO) AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PI.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PI1 WHERE PI1.CUSTOMER_ID \= PI.CUSTOMER_ID) AND MD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO \= MD.APPLICATION_NO)
GET_COMMON_CCADDRESS =SELECT MAIL_CC FROM MAIL_MASTER WHERE APP_ID\=?
GET_BRANCH_MAILIDS = SELECT EMAIL_TO TO_ADDRESS, EMAIL_CC CC_ADDRESS FROM MAIL_DETAILS WHERE BRANCH_CODE=?

################################

######## Branch Report Scheduler############
GET_BRANCHDETAILS_LIST = SELECT BRANCH_CODE,BRANCH_NAME,BELONGING_BRANCH FROM BRANCH_MASTER WHERE STATUS='Y' AND SCHEDULER_YN='Y' ORDER BY TO_NUMBER(BRANCH_CODE)
GET_BRANCH_REPORT_CNT = SELECT COUNT(*) FROM (SELECT * FROM TABLE(ADMINREPORTS(?,?,?,'3',?,?)) UNION ALL SELECT * FROM TABLE(ADMINREPORTS(?,?,?,'11',?,?)))
GET_BRANCH_SCHEDULE_CNT = select COUNT(*) from table(schedule_reports('',?,?,?))
GET_BRANCH_DEBIT_CNT = select COUNT(*) from table(Debit_Schedule_new('',?,?,?,?))
GET_BRANCH_CREDIT_CNT = select COUNT(*) from table(Debit_Schedule_new('',?,?,?,?))
############################################

##OPD DETAILS
GET_OPD_DETAILS = SELECT POLICY_NO,QUOTE_NO,CUSTOMER_NAME,LAST_NAME,OPEN_COVER_NO,DEBIT_NOTE_NO,to_char(INCEPTION_DATE,'DD/MM/YYYY')INCEPTION_DATE,nvl(PREMIUM,0)+nvl(EXCESS_PREMIUM,0) PREMIUM,SCHEDULE_PATH FROM ARAB_EXIST_DATA WHERE OPEN_COVER_NO\=? 

############################################
#Admin Opencover Changes
GET_COMMODITY_LIST_CLAUSES=SELECT COMMODITY_ID CODE,COMMODITY_NAME_DESC CODE_DESC FROM OPEN_COVER_COMMODITY_MASTER OCPM WHERE PROPOSAL_NO\=? AND OCPM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER OCP WHERE OCPM.PROPOSAL_NO\=OCP.PROPOSAL_NO) ORDER BY COMMODITY_NAME_DESC 
GET_COVER_LIST_CLAUSES=SELECT OCSD.COVER_ID CODE,COVER_NAME CODE_DESC FROM OPEN_COVER_SUB_DETAIL OCSD,COVER_MASTER CM WHERE OCSD.COVER_ID\=CM.COVER_ID AND PROPOSAL_NO\=? AND CM.Branch_code\=? AND OCSD.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_SUB_DETAIL OCP WHERE OCSD.PROPOSAL_NO\=OCP.PROPOSAL_NO) ORDER BY COVER_NAME
GET_DEFLT_ORCODE=select PERCENT,RSACODE from constant_detail where CATEGORY_ID \='154' AND BRANCH_CODE \= ?
GET_RIMASTER=select CATEGORY_DETAIL_ID CODE,DETAIL_NAME CODEDESC  from constant_Detail where CATEGORY_ID = 157 AND STATUS = 'Y' order by CATEGORY_DETAIL_ID
GET_UW_REFLIST=SELECT * FROM TABLE(REFERAL_LIST(?,?))
## For the Link in Open Cover Report
report.policy1=select * from table(reports(?,?,?,?,?,?,?))
## For Edit Claueses
QUOTE_FINALIZE_YN=select nvl(EDIT_CLAUSES_YN,'N') EDIT_CLAUSES_YN,nvl(finalize_yn,'N') finalize_yn from position_master where application_no\=?
GET_PDF_MODIFY_CLAUSES=select PDF_MODIFY_CLAUSE,PDF_MODIFY_WARRANTY,PDF_MODIFY_EXCLUSION,PDF_MODIFY_EXTRACLAUSES,APPLICATION_NO from position_master where quote_no\=? and amend_id\=(select max(amend_id) from position_master where quote_no\=? )
GET_CONDITIONS_CLAUSES=select CODE,CODEDESC,CODESTATUS FROM TABLE(SCHEDULE_CLAUSES(?,?,?,?)) WHERE CODEDESC IS NOT NULL ORDER BY TO_NUMBER(CODE)
UPDATE_PDF_MODIFY_CLAUSES=UPDATE POSITION_MASTER SET PDF_MODIFY_CLAUSE=? WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=?)
UPDATE_PDF_MODIFY_EXTRACLAUSES=UPDATE POSITION_MASTER SET PDF_MODIFY_EXTRACLAUSES=? WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=?)
UPDATE_PDF_MODIFY_WARRANTY=UPDATE POSITION_MASTER SET PDF_MODIFY_WARRANTY=? WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=?)
UPDATE_PDF_MODIFY_EXCLUSION=UPDATE POSITION_MASTER SET PDF_MODIFY_EXCLUSION\=? WHERE QUOTE_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO\=?)
GET_UPDATE_PREMIUMYN=UPDATE POSITION_MASTER SET PDF_PRE_SHOW_STATUS\=?,finalize_yn\=?,EDIT_CLAUSES_YN\=? WHERE APPLICATION_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO\=?)

##OTHERS OPTION IN OPENCOVER
GET_OPTIONAL_COVER_NOT_SELECTED=select CLAUSES_ID rsacode,clauses_description from clauses_master where OPTIONAL_TYPE\='O' and branch_code\=(select BELONGING_BRANCH from branch_master where BRANCH_CODE\=?) and cover_id\='99' and CLAUSES_ID not in (select FREE_TEXT_ID from OPEN_COVER_FREE_TEXT where PROPOSAL_NO\=? and amend_id\=(select max(amend_id) from OPEN_COVER_FREE_TEXT where PROPOSAL_NO\=? and cover_id\=? and type\='O') and cover_id\=? and type\='O') 
GET_OPTIONAL_COVER_SELECTED=select FREE_TEXT_ID rsacode,FREE_TEXT_DESCRIPTION clauses_description,to_char(EFFECTIVE_DATE,'dd-mm-yyyy') EFFECTIVE_DATE from OPEN_COVER_FREE_TEXT where PROPOSAL_NO=? and type='O' and amend_id=(select max(amend_id) from OPEN_COVER_FREE_TEXT where PROPOSAL_NO=? and COVER_ID=? and type='O') and COVER_ID=?
OPTIONAL_COVER_INSERT=insert into OPEN_COVER_FREE_TEXT(PROPOSAL_NO,AMEND_ID,MODE_OF_TRANSPORT,COVER_ID,EXTRA_COVER_ID,FREE_TEXT_ID,FREE_TEXT_DESCRIPTION,EFFECTIVE_DATE,STATUS,BRANCH_CODE,type) values(?,?,(select distinct(MODE_TRANSPORT_ID) from cover_master where COVER_ID\=?),?,?,?,?,to_date(?,'dd/mm/yyyy'),?,?,?)

#Validation for coverage
COVER_REFERAL_VALIDATE = Select count(*) from ( Select Distinct(Regexp_Substr(Coverage_Referal,'[^,]+',1,Level)) Coverage_Referal From (Select Coverage_Referal From Commoditymaster CMC Where  Commodity_Id=? And Branch_Code=? And Amend_Id= (Select Max(Amend_Id) From Commoditymaster CM Where CM.Branch_Code =CMC.Branch_Code And cm.Commodity_Id=CMC.Commodity_Id) ) B Connect By Level <= Length(Coverage_Referal) - Length(Replace(Coverage_Referal,',',''))+1) Where Coverage_Referal=?
#Policy Report
GET_POLICY_REPORT=SELECT INCEPTION_DATE,OPEN_COVER_NO,CUSTOMER_NAME,TOTAL_POLICY FROM TABLE(SCHEDULE_GENERATION('Count',?,?,?,?))

############################################################## Motor Admin Part Start ###############################################################
#Motor New Admin
##Sub Policy Type /Comprehensive Rate Master
GET_POLICY_TYPE_LIST_ADMIN = SELECT POLICYTYPE_DESC_ENGLISH,POLICY_SUBTYPE_ID FROM MOTOR_POLICYTYPE_MASTER MPM WHERE STATUS='Y' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID = MPM.POLICY_SUBTYPE_ID )AND BRANCH_CODE =? ORDER BY POLICYTYPE_DESC_ENGLISH
GET_MOTOR_BODY_TYPE_ADMIN = SELECT TYPE_OF_BODY_ID,TYPE_OF_BODY_NAME FROM MOTOR_BODYTYPE_DETAIL MB WHERE VTYPE_ID=? AND STATUS='Y' AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL WHERE TYPE_OF_BODY_ID=MB.TYPE_OF_BODY_ID) ORDER BY TYPE_OF_BODY_NAME
GET_MOTOR_BODY_TYPE_WTVT = SELECT BODY_ID TYPE_OF_BODY_ID, BODY_NAME TYPE_OF_BODY_NAME FROM MOTOR_BODYTYPE_MASTER MB WHERE STATUS='Y' AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_MASTER WHERE BODY_ID=MB.BODY_ID) ORDER BY BODY_NAME

##Sub Policy Master
##GET_SUB_POLICY_TYPE_LIST = SELECT   MSM.SUB_RATE_ID,MSM.VEHICLE_COUNT,MSM.AGE_OF_VEHICLE_START,MSM.AGE_OF_VEHICLE_END,(Select to_char(wm_concat(COUNTRY_NAME)) from Motor_MFG_Country_master where Decode(COUNTRY_APPLICABLE,'999','A',COUNTRY_CODE) in (SELECT Decode(COUNTRY_APPLICABLE,'999','A',(REGEXP_SUBSTR(COUNTRY_APPLICABLE,'[^,]+',1,LEVEL))) FROM dual B CONNECT BY LEVEL <= LENGTH(COUNTRY_APPLICABLE) - LENGTH(REPLACE(COUNTRY_APPLICABLE,',',''))+1)) COUNTRY_APPLICABLE, MSM.CITY_APPLICABLE, MSM.CLAIMS_START, MSM.CLAIMS_END, DECODE(MSM.STATUS,'Y','Active','De Active')STATUS, TO_CHAR (MSM.ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE, TO_CHAR (MSM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, MSM.REMARKS, MSM.DESCRIPTION FROM   MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE   MSM.POLICY_SUBTYPE_ID = ? AND MSM.BODY_TYPE_ID = ? and amend_id=(Select max(Amend_id) from MOTOR_SUBPOLICYTYPE_MASTER MS  Where MSM.POLICY_SUBTYPE_ID=MS.POLICY_SUBTYPE_ID and MSM.BODY_TYPE_ID=MS.BODY_TYPE_ID and MSM.AGE_OF_VEHICLE_START=MS.AGE_OF_VEHICLE_START and MSM.AGE_OF_VEHICLE_END=MS.AGE_OF_VEHICLE_END and MSM.COUNTRY_APPLICABLE=MS.COUNTRY_APPLICABLE and MSM.CITY_APPLICABLE=MS.CITY_APPLICABLE and MSM.CLAIMS_START=MS.CLAIMS_START and MSM.CLAIMS_END=MS.CLAIMS_END)
GET_SUB_POLICY_TYPE_LIST = SELECT   MSM.SUB_RATE_ID,MSM.VEHICLE_COUNT,MSM.AGE_OF_VEHICLE_START,MSM.AGE_OF_VEHICLE_END,(Select to_char(wm_concat(COUNTRY_NAME)) from Motor_MFG_Country_master where Decode(COUNTRY_APPLICABLE,'999','A',COUNTRY_CODE) in (SELECT Decode(COUNTRY_APPLICABLE,'999','A',(REGEXP_SUBSTR(COUNTRY_APPLICABLE,'[^,]+',1,LEVEL))) FROM dual B CONNECT BY LEVEL <= LENGTH(COUNTRY_APPLICABLE) - LENGTH(REPLACE(COUNTRY_APPLICABLE,',',''))+1)) COUNTRY_APPLICABLE, MSM.CITY_APPLICABLE, MSM.CLAIMS_START, MSM.CLAIMS_END, DECODE(MSM.STATUS,'Y','Active','De Active')STATUS, TO_CHAR (MSM.ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE, TO_CHAR (MSM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, MSM.REMARKS, MSM.DESCRIPTION FROM   MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE   MSM.POLICY_SUBTYPE_ID = ? AND MSM.BODY_TYPE_ID = ? and amend_id=(Select max(Amend_id) from MOTOR_SUBPOLICYTYPE_MASTER MS  WHERE   MSM.SUB_RATE_ID = MS.SUB_RATE_ID)
GET_VEHICLE_APPLICABLE_COUNTRY_LIST = SELECT COUNTRY_CODE,COUNTRY_NAME FROM MOTOR_MFG_COUNTRY_MASTER WHERE BRANCH_CODE=? AND STATUS='Y'
GET_VEHICLE_APPLICABLE_CITY_LIST = SELECT COUNTRY_CODE,COUNTRY_NAME FROM MOTOR_MFG_COUNTRY_MASTER WHERE BRANCH_CODE=? AND STATUS ='Y'
CHECK_VEHICLE_AGE_MODAL = SELECT   (Select POLICYTYPE_DESC_ENGLISH From MOTOR_POLICYTYPE_MASTER MPM WHERE MPM.POLICY_SUBTYPE_ID\=MSM.POLICY_SUBTYPE_ID) POLICY_SUBTYPE_ID,(select TYPE_OF_BODY_NAME From MOTOR_BODYTYPE_DETAIL  MTBM Where MTBM.TYPE_OF_BODY_ID\=MSM.BODY_TYPE_ID) BODY_TYPE_ID , SUB_RATE_ID,AGE_OF_VEHICLE_START, AGE_OF_VEHICLE_END, (Select to_char(Replace(wm_concat(COUNTRY_NAME),',',', ')) from Motor_MFG_Country_master where Decode(COUNTRY_APPLICABLE,'999','A',COUNTRY_CODE) in (SELECT Decode(COUNTRY_APPLICABLE,'999','A',(REGEXP_SUBSTR(COUNTRY_APPLICABLE,'[^,]+',1,LEVEL))) FROM dual B CONNECT BY LEVEL <\= LENGTH(COUNTRY_APPLICABLE) - LENGTH(REPLACE(COUNTRY_APPLICABLE,',',''))+1)) COUNTRY_APPLICABLE, CITY_APPLICABLE, CLAIMS_START, CLAIMS_END, STATUS, TO_CHAR (ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE, TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, REMARKS, DESCRIPTION FROM   MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE   POLICY_SUBTYPE_ID\=? AND BODY_TYPE_ID\=? AND  ((? BETWEEN MSM.AGE_OF_VEHICLE_START AND MSM.AGE_OF_VEHICLE_END) OR (? BETWEEN MSM.AGE_OF_VEHICLE_START AND MSM.AGE_OF_VEHICLE_END)) AND MSM.VEHICLE_COUNT \= ? AND AMEND_ID \=(SELECT MAX(AMEND_ID) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID \=MSM.SUB_RATE_ID)
CHECK_VEHICLE_AGE = SELECT COUNT(*) FROM MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE  MSM.POLICY_SUBTYPE_ID=? AND MSM.BODY_TYPE_ID=? AND  ((? BETWEEN MSM.AGE_OF_VEHICLE_START AND MSM.AGE_OF_VEHICLE_END) OR (? BETWEEN MSM.AGE_OF_VEHICLE_START AND MSM.AGE_OF_VEHICLE_END)) AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID =MSM.SUB_RATE_ID)
CHECK_VEHICLE_CLAIM_MODAL = SELECT   (Select POLICYTYPE_DESC_ENGLISH From MOTOR_POLICYTYPE_MASTER MPM WHERE MPM.POLICY_SUBTYPE_ID\=MSM.POLICY_SUBTYPE_ID) POLICY_SUBTYPE_ID,( select TYPE_OF_BODY_NAME From MOTOR_BODYTYPE_DETAIL  MTBM Where MTBM.TYPE_OF_BODY_ID\=MSM.BODY_TYPE_ID) BODY_TYPE_ID , SUB_RATE_ID, AGE_OF_VEHICLE_START, AGE_OF_VEHICLE_END, ( Select to_char(Replace(wm_concat(COUNTRY_NAME),',',', ')) from Motor_MFG_Country_master where Decode(COUNTRY_APPLICABLE,'999','A',COUNTRY_CODE) in ( SELECT Decode(COUNTRY_APPLICABLE,'999','A',(REGEXP_SUBSTR( COUNTRY_APPLICABLE,'[^,]+',1,LEVEL))) FROM dual B CONNECT BY LEVEL <\= LENGTH(COUNTRY_APPLICABLE) - LENGTH(REPLACE( COUNTRY_APPLICABLE,',',''))+1)) COUNTRY_APPLICABLE, CITY_APPLICABLE, CLAIMS_START, CLAIMS_END, STATUS, TO_CHAR (ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE, TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, REMARKS, DESCRIPTION FROM   MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE   POLICY_SUBTYPE_ID\=? AND BODY_TYPE_ID\=? AND  ((? BETWEEN MSM.CLAIMS_START AND MSM.CLAIMS_END) OR (? BETWEEN MSM.CLAIMS_START AND MSM.CLAIMS_END)) AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID \=MSM.SUB_RATE_ID) 
GET_SUBPOLICY_HEADER_DETAILS = SELECT MPM.POLICYTYPE_DESC_ENGLISH,MVM.VEHICLETYPE_DESC,MBM.TYPE_OF_BODY_NAME FROM MOTOR_POLICYTYPE_MASTER MPM, MOTOR_VEHICLETYPE_MASTER MVM, MOTOR_BODYTYPE_DETAIL MBM WHERE MPM.POLICY_SUBTYPE_ID \=? AND MPM.STATUS\='Y' AND MVM.VTYPE_ID\=? AND MVM.STATUS\='Y' AND MBM.TYPE_OF_BODY_ID\=? AND MBM.STATUS\='Y'
GET_MAX_SUBPOLICY_ID = SELECT NVL(MAX(SUB_RATE_ID)+1,0) FROM MOTOR_SUBPOLICYTYPE_MASTER 
GET_EDIT_SUBPOLICY_AMEND = SELECT AMEND_ID FROM MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_SUBPOLICYTYPE_MASTER WHERE   SUB_RATE_ID = MSM.SUB_RATE_ID) AND SUB_RATE_ID = ? AND EFFECTIVE_DATE > SYSDATE
INS_MOTOR_SUBPOLICY = INSERT INTO MOTOR_SUBPOLICYTYPE_MASTER(POLICY_SUBTYPE_ID,BODY_TYPE_ID,SUB_RATE_ID,AMEND_ID,AGE_OF_VEHICLE_START,AGE_OF_VEHICLE_END,COUNTRY_APPLICABLE,CITY_APPLICABLE,CLAIMS_START,CLAIMS_END,STATUS,ENTRY_DATE,EFFECTIVE_DATE,REMARKS,DESCRIPTION,VEHICLE_COUNT) VALUES(?,?,?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID=?),?,?,?,?,?,?,?,SYSDATE,TO_DATE(?,'dd/mm/yyyy'),?,?,?)
GET_MOTOR_SUBPOLICY =SELECT AGE_OF_VEHICLE_START,AGE_OF_VEHICLE_END,COUNTRY_APPLICABLE,CITY_APPLICABLE,VEHICLE_COUNT,CLAIMS_START,CLAIMS_END,STATUS,TO_CHAR(ENTRY_DATE,'DD/MM/YYYY')ENTRY_DATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,REMARKS,DESCRIPTION FROM  MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE  SUB_RATE_ID \= ? AND AMEND_ID\= (SELECT MAX(AMEND_ID) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID\=MSM.SUB_RATE_ID)
GET_AMEND_ID_MOTOR_SUBPOLICY = SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID=?
UPD_MOTOR_SUBPOLICY = UPDATE MOTOR_SUBPOLICYTYPE_MASTER MSM SET POLICY_SUBTYPE_ID = ?,BODY_TYPE_ID =?,AGE_OF_VEHICLE_START=?,AGE_OF_VEHICLE_END=?,COUNTRY_APPLICABLE=?,CITY_APPLICABLE=?,CLAIMS_START=?,CLAIMS_END=?,STATUS=?,EFFECTIVE_DATE=TO_DATE(?,'dd/mm/yyyy'),REMARKS=?,DESCRIPTION=?,VEHICLE_COUNT=? WHERE SUB_RATE_ID=? AND AMEND_ID = ?
CHECK_SUB_POLICY_COMBINATION = SELECT COUNT(*) FROM MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE POLICY_SUBTYPE_ID \= ? AND BODY_TYPE_ID \= ? AND ((? BETWEEN MSM.AGE_OF_VEHICLE_START AND MSM.AGE_OF_VEHICLE_END) OR (? BETWEEN MSM.AGE_OF_VEHICLE_START AND MSM.AGE_OF_VEHICLE_END)) AND VEHICLE_COUNT \= ? AND STATUS\='Y' AND AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID \= MSM.SUB_RATE_ID) 
##Comprehensive Master
GET_COMPREHENSIVE_RATE_LIST = SELECT  MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,to_char(MTRM.POLICY_START_DATE,'DD/MM/YYYY')POLICY_START_DATE,TO_CHAR(MTRM.POLICY_END_DATE,'DD/MM/YYYY')POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,DECODE(MTRM.STATUS,'Y','Active','De Active') STATUS,TO_CHAR(MTRM.ENTRY_DATE,'DD/MM/YYYY')ENTRY_DATE,TO_CHAR(MTRM.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,MTRM.REMARKS  FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID = ? AND MTRM.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID = MTRM.SUB_RATE_ID AND RATE_ID = MTRM.RATE_ID )
CHECK_SEATING_TON = SELECT   MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,TO_CHAR (MTRM.POLICY_START_DATE, 'DD/MM/YYYY') POLICY_START_DATE,TO_CHAR (MTRM.POLICY_END_DATE, 'DD/MM/YYYY') POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,MTRM.STATUS,         TO_CHAR (MTRM.ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE,TO_CHAR (MTRM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,MTRM.REMARKS FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID \= MTRM.SUB_RATE_ID AND MTRM.AGENCY_CODE \= MT.AGENCY_CODE AND MTRM.SEATING_TON_START \= MT.SEATING_TON_START AND MTRM.SEATING_TON_END \= MT.SEATING_TON_END AND MTRM.CC_GVW_START_RANGE \= MT.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE \= MT.CC_GVW_END_RANGE AND MTRM.UAE_LISCENCE_START \= MT.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END \= MT.UAE_LISCENCE_END AND MTRM.DRIVER_AGE_FROM \= MT.DRIVER_AGE_FROM AND MTRM.DRIVER_AGE_TO \= MT.DRIVER_AGE_TO AND MTRM.SUMINSURED_START \= MT.SUMINSURED_START AND MTRM.SUMINSURED_END \= MT.SUMINSURED_END) and  ((? BETWEEN MTRM.SEATING_TON_START AND MTRM.SEATING_TON_END) OR (? BETWEEN MTRM.SEATING_TON_START AND MTRM.SEATING_TON_END)) AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \=MTRM.RATE_ID) 
CHECK_POLICY_DATE = SELECT   COUNT(*) FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= ( SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID \= MTRM.SUB_RATE_ID) and  ((? BETWEEN MTRM.POLICY_START_DATE AND MTRM.POLICY_END_DATE) OR (? BETWEEN MTRM.POLICY_START_DATE AND MTRM.POLICY_END_DATE)) AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \=MTRM.RATE_ID) AND STATUS\='Y' 
CHECK_CCGVWRANGE= SELECT   MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,TO_CHAR (MTRM.POLICY_START_DATE, 'DD/MM/YYYY') POLICY_START_DATE,TO_CHAR (MTRM.POLICY_END_DATE, 'DD/MM/YYYY') POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,MTRM.STATUS,         TO_CHAR (MTRM.ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE,TO_CHAR (MTRM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,MTRM.REMARKS FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID \= MTRM.SUB_RATE_ID AND MTRM.AGENCY_CODE \= MT.AGENCY_CODE AND MTRM.SEATING_TON_START \= MT.SEATING_TON_START AND MTRM.SEATING_TON_END \= MT.SEATING_TON_END AND MTRM.CC_GVW_START_RANGE \= MT.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE \= MT.CC_GVW_END_RANGE AND MTRM.UAE_LISCENCE_START \= MT.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END \= MT.UAE_LISCENCE_END AND MTRM.DRIVER_AGE_FROM \= MT.DRIVER_AGE_FROM AND MTRM.DRIVER_AGE_TO \= MT.DRIVER_AGE_TO AND MTRM.SUMINSURED_START \= MT.SUMINSURED_START AND MTRM.SUMINSURED_END \= MT.SUMINSURED_END) and  ((? BETWEEN MTRM.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE) OR (? BETWEEN MTRM.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE)) AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \=MTRM.RATE_ID) 
CHECK_UAE_LISCENCE = SELECT   MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,TO_CHAR (MTRM.POLICY_START_DATE, 'DD/MM/YYYY') POLICY_START_DATE,TO_CHAR (MTRM.POLICY_END_DATE, 'DD/MM/YYYY') POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,MTRM.STATUS,         TO_CHAR (MTRM.ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE,TO_CHAR (MTRM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,MTRM.REMARKS FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID \= MTRM.SUB_RATE_ID AND MTRM.AGENCY_CODE \= MT.AGENCY_CODE AND MTRM.SEATING_TON_START \= MT.SEATING_TON_START AND MTRM.SEATING_TON_END \= MT.SEATING_TON_END AND MTRM.CC_GVW_START_RANGE \= MT.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE \= MT.CC_GVW_END_RANGE AND MTRM.UAE_LISCENCE_START \= MT.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END \= MT.UAE_LISCENCE_END AND MTRM.DRIVER_AGE_FROM \= MT.DRIVER_AGE_FROM AND MTRM.DRIVER_AGE_TO \= MT.DRIVER_AGE_TO AND MTRM.SUMINSURED_START \= MT.SUMINSURED_START AND MTRM.SUMINSURED_END \= MT.SUMINSURED_END) AND ((? BETWEEN MTRM.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END) OR (? BETWEEN MTRM.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END))  AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \=MTRM.RATE_ID) 
CHECK_DRIVER_AGE = SELECT   MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,TO_CHAR (MTRM.POLICY_START_DATE, 'DD/MM/YYYY') POLICY_START_DATE,TO_CHAR (MTRM.POLICY_END_DATE, 'DD/MM/YYYY') POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,MTRM.STATUS,         TO_CHAR (MTRM.ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE,TO_CHAR (MTRM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,MTRM.REMARKS FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID \= MTRM.SUB_RATE_ID AND MTRM.AGENCY_CODE \= MT.AGENCY_CODE AND MTRM.SEATING_TON_START \= MT.SEATING_TON_START AND MTRM.SEATING_TON_END \= MT.SEATING_TON_END AND MTRM.CC_GVW_START_RANGE \= MT.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE \= MT.CC_GVW_END_RANGE AND MTRM.UAE_LISCENCE_START \= MT.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END \= MT.UAE_LISCENCE_END AND MTRM.DRIVER_AGE_FROM \= MT.DRIVER_AGE_FROM AND MTRM.DRIVER_AGE_TO \= MT.DRIVER_AGE_TO AND MTRM.SUMINSURED_START \= MT.SUMINSURED_START AND MTRM.SUMINSURED_END \= MT.SUMINSURED_END) AND ((? BETWEEN MTRM.DRIVER_AGE_FROM AND MTRM.DRIVER_AGE_TO) OR (? BETWEEN MTRM.DRIVER_AGE_FROM AND MTRM.DRIVER_AGE_TO)) AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \=MTRM.RATE_ID) 
CHECK_SUM_INSURED = SELECT   MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,TO_CHAR (MTRM.POLICY_START_DATE, 'DD/MM/YYYY') POLICY_START_DATE,TO_CHAR (MTRM.POLICY_END_DATE, 'DD/MM/YYYY') POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,MTRM.STATUS,         TO_CHAR (MTRM.ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE,TO_CHAR (MTRM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,MTRM.REMARKS FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID \= MTRM.SUB_RATE_ID AND MTRM.AGENCY_CODE \= MT.AGENCY_CODE AND MTRM.SEATING_TON_START \= MT.SEATING_TON_START AND MTRM.SEATING_TON_END \= MT.SEATING_TON_END AND MTRM.CC_GVW_START_RANGE \= MT.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE \= MT.CC_GVW_END_RANGE AND MTRM.UAE_LISCENCE_START \= MT.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END \= MT.UAE_LISCENCE_END AND MTRM.DRIVER_AGE_FROM \= MT.DRIVER_AGE_FROM AND MTRM.DRIVER_AGE_TO \= MT.DRIVER_AGE_TO AND MTRM.SUMINSURED_START \= MT.SUMINSURED_START AND MTRM.SUMINSURED_END \= MT.SUMINSURED_END) AND ((? BETWEEN MTRM.SUMINSURED_START AND MTRM.SUMINSURED_END) OR (? BETWEEN MTRM.SUMINSURED_START AND MTRM.SUMINSURED_END)) AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \=MTRM.RATE_ID)
GET_MAX_MOTOR_COMPRE_RATE_ID = SELECT NVL(MAX(RATE_ID)+1,0) FROM MOTOR_TYPE_RATE_MASTER
GET_EDIT_COMPRERATE_AMEND = SELECT AMEND_ID FROM MOTOR_TYPE_RATE_MASTER MTRM WHERE MTRM.RATE_ID \= ? AND MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \= MTRM.RATE_ID) AND EFFECTIVE_DATE > SYSDATE  
INS_COMPRE_RATE = INSERT INTO  MOTOR_TYPE_RATE_MASTER (SUB_RATE_ID,RATE_ID,AMEND_ID,AGENCY_CODE,SEATING_TON_START,SEATING_TON_END,CC_GVW_START_RANGE,CC_GVW_END_RANGE,UAE_LISCENCE_START,UAE_LISCENCE_END,DRIVER_AGE_FROM,DRIVER_AGE_TO, SUMINSURED_START,SUMINSURED_END,POLICY_START_DATE,POLICY_END_DATE, MOTOR_RATE,MINIMUM_PREMIUM,ONLINE_PERCENT,DEDUCTION_PERCENT, DEDUCTION_AMOUNT,DEDUCTION_DESC,STATUS,ENTRY_DATE,EFFECTIVE_DATE,REMARKS ) VALUES(?,?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID=?),( SELECT LM.AGENCY_CODE FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID =?),?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'), TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,SYSDATE,TO_DATE(?,'DD/MM/YYYY'),?)
GET_AMEND_ID_MOTOR_COMPRE_RATE = SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_TYPE_RATE_MASTER WHERE SUB_RATE_ID\=?
EDIT_COMPRE_RATE = SELECT SUB_RATE_ID,RATE_ID,AMEND_ID,AGENCY_CODE,SEATING_TON_START,SEATING_TON_END,CC_GVW_START_RANGE,CC_GVW_END_RANGE,UAE_LISCENCE_START,UAE_LISCENCE_END,DRIVER_AGE_FROM,DRIVER_AGE_TO,SUMINSURED_START,SUMINSURED_END,TO_CHAR(POLICY_START_DATE,'DD/MM/YYYY')POLICY_START_DATE,TO_CHAR(POLICY_END_DATE,'DD/MM/YYYY')POLICY_END_DATE,MOTOR_RATE,MINIMUM_PREMIUM,ONLINE_PERCENT,DEDUCTION_PERCENT,DEDUCTION_AMOUNT,DEDUCTION_DESC,STATUS,TO_CHAR(ENTRY_DATE,'DD/MM/YYYY')ENTRY_DATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,REMARKS FROM MOTOR_TYPE_RATE_MASTER MTRM WHERE MTRM.RATE_ID \= ? AND MTRM.SUB_RATE_ID \=? AND MTRM.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \= MTRM.RATE_ID)
UPD_COMPRE_RATE = UPDATE MOTOR_TYPE_RATE_MASTER MTRM SET AGENCY_CODE\=(SELECT LM.AGENCY_CODE FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID \=?),SEATING_TON_START\=?,SEATING_TON_END\=?,CC_GVW_START_RANGE\=?,CC_GVW_END_RANGE\=?,UAE_LISCENCE_START\=?, UAE_LISCENCE_END\=?,DRIVER_AGE_FROM\=?,DRIVER_AGE_TO\=?,SUMINSURED_START\=?,SUMINSURED_END\=?,POLICY_START_DATE\=TO_DATE(?,'DD/MM/YYYY'),POLICY_END_DATE\=TO_DATE(?,'DD/MM/YYYY'),MOTOR_RATE\=?, MINIMUM_PREMIUM\=?,ONLINE_PERCENT\=?,DEDUCTION_PERCENT\=?,DEDUCTION_AMOUNT\=?,DEDUCTION_DESC\=?,STATUS\=?,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'),REMARKS\=? WHERE MTRM.SUB_RATE_ID \= ? AND MTRM.RATE_ID\=? AND MTRM.AMEND_ID \= ? 


##Make Master
##GET_MAKE_MASTER_LIST = SELECT MMM.MAKE_ID,MMM.MAKE_NAME,DECODE(MMM.STATUS,'Y','Active','N','De Active')STATUS,TO_CHAR(MMM.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE ,TO_CHAR(MMM.EXPIRY_DATE,'DD/MM/YYYY')EXPIRY_DATE,MMM.REMARKS,MMM.BRANCH_CODE,MMM.MAKE_NAME_ARABIC,DECODE(MMM.REFERRAL_STATUS,'Y','Active','N','De Active')REFERRAL_STATUS,MFCM.COUNTRY_NAME FROM  MOTOR_MAKE_MASTER MMM,MOTOR_MFG_COUNTRY_MASTER MFCM WHERE MFCM.COUNTRY_ID = MMM.COUNTRY_ID AND MMM.BRANCH_CODE=? AND MMM.VTYPE_ID=? AND MMM.BODY_ID=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM  MOTOR_MAKE_MASTER WHERE MAKE_ID=MMM.MAKE_ID ) ORDER BY MMM.MAKE_ID DESC
GET_MAKE_MASTER_LIST = SELECT MMM.MAKE_ID,MMM.MAKE_NAME,DECODE(MMM.STATUS,'Y','Active','De Active')STATUS,TO_CHAR(MMM.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE ,TO_CHAR(MMM.EXPIRY_DATE,'DD/MM/YYYY')EXPIRY_DATE,MMM.REMARKS,MMM.BRANCH_CODE,MMM.MAKE_NAME_ARABIC,DECODE(REFERRAL_STATUS,'Y',' Referral','Non-Referral') REFERRAL_STATUS FROM  MOTOR_MAKE_MASTER MMM WHERE MMM.BRANCH_CODE= ? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM  MOTOR_MAKE_MASTER WHERE MAKE_ID=MMM.MAKE_ID ) ORDER BY MMM.MAKE_ID
##GET_MAKE_HEADER_LIST = SELECT MVM.VEHICLETYPE_DESC,MBM.TYPE_OF_BODY_NAME FROM MOTOR_VEHICLETYPE_MASTER MVM, MOTOR_BODYTYPE_DETAIL MBM WHERE MVM.VTYPE_ID\=? AND MVM.STATUS\='Y' AND MVM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_VEHICLETYPE_MASTER WHERE VTYPE_ID\=MVM.VTYPE_ID) AND MBM.TYPE_OF_BODY_ID\=?       AND MBM.STATUS\='Y' AND MBM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL WHERE TYPE_OF_BODY_ID\=MBM.TYPE_OF_BODY_ID)
CHECK_MAKE_CORE_CODE = SELECT COUNT(*) FROM MOTOR_MAKE_MASTER WHERE CORE_CODE \= ? AND BRANCH_CODE \= ?
GET_MAX_MAKE_ID = SELECT NVL(MAX(MAKE_ID),0)+1 FROM MOTOR_MAKE_MASTER  
GET_EDIT_MAKE_AMEND = SELECT  AMEND_ID FROM   MOTOR_MAKE_MASTER MMM WHERE   MAKE_ID \= ? AND AMEND_ID \= ( SELECT   MAX (AMEND_ID) FROM   MOTOR_MAKE_MASTER WHERE   MAKE_ID \= MMM.MAKE_ID) AND BRANCH_CODE \= ? AND EFFECTIVE_DATE > SYSDATE  
INS_MAKE_MASTER = INSERT INTO MOTOR_MAKE_MASTER(MAKE_ID,MAKE_NAME,STATUS,EFFECTIVE_DATE,EXPIRY_DATE,REMARKS,AMEND_ID,BRANCH_CODE,MAKE_NAME_ARABIC,REFERRAL_STATUS,COUNTRY_ID,CORE_CODE) VALUES (?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_MAKE_MASTER WHERE MAKE_ID=?),?,?,?,?,?)
EDIT_MAKE_MASTER = SELECT  MAKE_ID,MAKE_NAME,STATUS,TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY')EFFECTIVE_DATE,TO_CHAR (EXPIRY_DATE, 'DD/MM/YYYY')EXPIRY_DATE,REMARKS,MAKE_NAME_ARABIC,REFERRAL_STATUS,COUNTRY_ID,CORE_CODE FROM   MOTOR_MAKE_MASTER MMM WHERE   MAKE_ID \= ? AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_MAKE_MASTER WHERE   MAKE_ID \= MMM.MAKE_ID) AND MMM.BRANCH_CODE \= ?
UPD_MAKE_MASTER = UPDATE MOTOR_MAKE_MASTER MMM SET MAKE_NAME\=?,STATUS\=?,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'),EXPIRY_DATE\=TO_DATE(?,'DD/MM/YYYY'),REMARKS\=?,BRANCH_CODE\=?,MAKE_NAME_ARABIC\=?,REFERRAL_STATUS\=?,COUNTRY_ID\=?,CORE_CODE\=? WHERE MMM.MAKE_ID \= ? AND MMM.AMEND_ID \= ?     
##Model Master
##GET_MODEL_MASTER_LIST = SELECT   MODEL_ID,MODEL_NAME,BODY_ID, DECODE(STATUS,'Y','Active','Deactive') STATUS,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,TO_CHAR(EXPIRY_DATE,'DD/MM/YYYY')EXPIRY_DATE,REMARKS,MODEL_NAME_ARABIC,DECODE(REFERRAL_STATUS,'Y',' Referral','Non-Referral')REFERRAL_STATUS FROM   MOTOR_MODEL_MASTER MMM WHERE BRANCH_CODE = ? AND MAKE_ID = ? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM  MOTOR_MODEL_MASTER WHERE MODEL_ID=MMM.MODEL_ID ) ORDER BY MODEL_ID DESC
GET_MODEL_MASTER_LIST = SELECT   MMM.MODEL_ID,MMM.MODEL_NAME,MMB.MAKE_ID,DECODE (MMM.STATUS, 'Y', 'Active', 'Deactive') STATUS, TO_CHAR (MMM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, TO_CHAR (MMM.EXPIRY_DATE, 'DD/MM/YYYY') EXPIRY_DATE, MMM.REMARKS, MMM.MODEL_NAME_ARABIC, DECODE (MMM.REFERRAL_STATUS, 'Y', ' Referral', 'Non-Referral') REFERRAL_STATUS FROM   MOTOR_MODEL_MASTER MMM,MOTOR_MAKE_MASTER MMB WHERE MMM.BRANCH_CODE \= ? AND MMM.MAKE_ID \= ? AND MMB.MAKE_ID\=MMM.MAKE_ID AND MMM.AMEND_ID \= (SELECT   MAX (MMMA.AMEND_ID) FROM   MOTOR_MODEL_MASTER MMMA WHERE   MMMA.MODEL_ID \= MMM.MODEL_ID) ORDER BY   MODEL_ID DESC 
GET_MODEL_HEADER_LIST = SELECT MAKE_NAME FROM  MOTOR_MAKE_MASTER MMM  WHERE MMM.MAKE_ID\=? AND MMM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_MAKE_MASTER WHERE MAKE_ID\=MMM.MAKE_ID)
GET_MAX_MODEL_ID = SELECT NVL(MAX(MODEL_ID)+1,0) FROM MOTOR_MODEL_MASTER  
GET_EDIT_MODEL_AMEND_ID = SELECT AMEND_ID FROM MOTOR_MODEL_MASTER MMM WHERE MODEL_ID \= ? AND AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM MOTOR_MODEL_MASTER WHERE MODEL_ID \= MMM.MODEL_ID) AND BRANCH_CODE \=? AND EFFECTIVE_DATE > SYSDATE 
CHECK_MODEL_CORE_CODE = SELECT COUNT(*) FROM MOTOR_MODEL_MASTER MMM WHERE CORE_CODE = ? AND BRANCH_CODE = ? AND STATUS ='Y' AND AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   MOTOR_MODEL_MASTER WHERE   MODEL_ID = MMM.MODEL_ID)
INS_MODEL_MASTER = INSERT INTO MOTOR_MODEL_MASTER (MODEL_ID,MAKE_ID,MODEL_NAME,STATUS,EFFECTIVE_DATE,EXPIRY_DATE,REMARKS,AMEND_ID,BRANCH_CODE,MODEL_NAME_ARABIC,REFERRAL_STATUS,CORE_CODE) VALUES(?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_MODEL_MASTER WHERE MODEL_ID\=?),?,?,?,?)
UPD_MODEL_MASTER = UPDATE MOTOR_MODEL_MASTER MMM SET MAKE_ID\=?,MODEL_NAME\=?,STATUS\=?,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'),EXPIRY_DATE\=TO_DATE(?,'DD/MM/YYYY'),REMARKS\=?,BRANCH_CODE\=?,MODEL_NAME_ARABIC\=?,REFERRAL_STATUS\=?,CORE_CODE\=? WHERE MODEL_ID \= ? AND AMEND_ID \= ?
EDIT_MODEL_MASTER = SELECT MODEL_NAME,STATUS,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,TO_CHAR(EXPIRY_DATE,'DD/MM/YYYY')EXPIRY_DATE,BODY_ID,REMARKS,BRANCH_CODE,MODEL_NAME_ARABIC,REFERRAL_STATUS,CORE_CODE FROM MOTOR_MODEL_MASTER MMM WHERE MODEL_ID \= ? AND AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_MODEL_MASTER WHERE MODEL_ID \= MMM.MODEL_ID) AND BRANCH_CODE \=?  
CHECK_MODEL_BODY_COMBINATION = SELECT COUNT(*) FROM MOTOR_MODEL_MASTER MMM WHERE STATUS \= 'Y' AND BODY_ID \= ? AND UPPER(MODEL_NAME)\=UPPER(?) AND BRANCH_CODE\=?  AND AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   MOTOR_MODEL_MASTER WHERE   MODEL_ID \= MMM.MODEL_ID)  
##Make and Model Master Body Type
GET_MODEL_DETAIL_LIST = select mmm.MODEL_TYPE_ID,mmm.MODEL_ID,mmm.MAKE_ID,mmm.MODEL_NAME,mbm.BODY_ID,mbm.BODY_NAME,DECODE (MMM.STATUS, 'Y', 'Active', 'Deactive') STATUS,DECODE (MMM.REFERRAL_STATUS,'Y','Referral','Non-Referral') REFERRAL_STATUS from Motor_Model_Detail mmm,MOTOR_BODYTYPE_MASTER mbm where mbm.body_id=mmm.body_id and mmm.branch_code = ? and mmm.make_id = ? and mmm.Model_name = ?
INS_MODEL_DETAIL = insert into motor_model_detail (model_type_id,model_id,make_id,model_name,body_id,status,branch_code,remarks,amend_id) values((SELECT NVL(MAX(MODEL_TYPE_ID)+1,0) FROM MOTOR_MODEL_DETAIL),?,?,?,?,?,?,?,'0')
UPD_MODEL_DETAIL = update motor_model_detail set make_id\=? ,model_name\=?,body_id\=?,status\=?,branch_code\=?,remarks\=?,model_id\=? where model_type_id \= ?
EDIT_MODEL_DETAIL =select model_id,model_name,body_id,status,remarks from motor_model_detail where branch_code\=? and model_type_id\=?
CHECK_MODEL_DETAIL_MASTER = select count(*) from motor_model_detail where model_id\=? and make_id\=? and body_id\=? and status\= 'Y'
##Document Master
##GET_DOCUMENT_MASTER = SELECT   DOCUMENT_ID,(SELECT wm_concat(POLICYTYPE_DESC_ENGLISH)  FROM MOTOR_POLICYTYPE_MASTER MPM  where POLICYTYPE_ID in(select column_value from table  (split_text_fn(mdm.POLICY_TYPE,',')))) POLICY_TYPE,DOCUMENT_DESC,DECODE (MANDATORY_STATUS,'Y','Active','N','Deactive') MANDATORY_STATUS,DECODE (STATUS,'Y','Active','N','Deactive')STATUS,REMARKS FROM   motor_document_master mdm ORDER BY   DOCUMENT_ID
##GET_DOCUMENT_FOR_EDIT = SELECT DOCUMENT_ID,DOCUMENT_DESC,POLICY_TYPE,MANDATORY_STATUS,STATUS,REMARKS FROM motor_document_master WHERE DOCUMENT_ID=?
##GET_MAX_DOCUMENT_ID = SELECT max(DOCUMENT_ID)+1 DOCUMENT_ID from motor_document_master 
##DOCUMENT_UPDATE = UPDATE motor_document_master SET   DOCUMENT_DESC=?,POLICY_TYPE=?,MANDATORY_STATUS=?,STATUS=?,REMARKS=? WHERE DOCUMENT_ID=?
##DOCUMENT_INSERT = INSERT INTO motor_document_master (DOCUMENT_ID,DOCUMENT_DESC,POLICY_TYPE,MANDATORY_STATUS,STATUS,REMARKS) VALUES(?,?,?,?,?,?)
##CHECK_DOCUMENTDISPLAY_ORDER = SELECT COUNT(*) FROM MOTOR_DOCUMENT_MASTER WHERE DISPLAY_ORDER\=?
GET_DOCUMENT_MASTER = SELECT   DOCUMENT_ID,(SELECT wm_concat(POLICYTYPE_DESC_ENGLISH)  FROM MOTOR_POLICYTYPE_MASTER MPM  where POLICYTYPE_ID in(select column_value from table  (split_text_fn(mdm.POLICY_TYPE,',')))) POLICY_TYPE,DOCUMENT_DESC,DECODE (MANDATORY_STATUS,'Y','Active','N','Deactive') MANDATORY_STATUS,DECODE (STATUS,'Y','Active','N','Deactive')STATUS,REMARKS,DISPLAY_ORDER,DOC_APPLICABLE FROM   motor_document_master mdm ORDER BY   DOCUMENT_ID
GET_DOCUMENT_FOR_EDIT = SELECT DOCUMENT_ID,DOCUMENT_DESC,POLICY_TYPE,MANDATORY_STATUS,STATUS,REMARKS,DISPLAY_ORDER,DOC_APPLICABLE FROM motor_document_master WHERE DOCUMENT_ID=?
GET_MAX_DOCUMENT_ID = SELECT max(DOCUMENT_ID)+1 DOCUMENT_ID from motor_document_master 
DOCUMENT_UPDATE = UPDATE motor_document_master SET   DOCUMENT_DESC=?,POLICY_TYPE=?,MANDATORY_STATUS=?,STATUS=?,REMARKS=?,DISPLAY_ORDER=?,DOC_APPLICABLE=? WHERE DOCUMENT_ID=?
DOCUMENT_INSERT = INSERT INTO motor_document_master (DOCUMENT_ID,DOCUMENT_DESC,POLICY_TYPE,MANDATORY_STATUS,STATUS,REMARKS,DISPLAY_ORDER,DOC_APPLICABLE) VALUES(?,?,?,?,?,?,?,?)
CHECK_DOCUMENTDISPLAY_ORDER = SELECT COUNT(*) FROM MOTOR_DOCUMENT_MASTER WHERE DISPLAY_ORDER\=?  
GET_DOC_APP_DRPDWN = SELECT ITEM_VALUE,ITEM_CODE FROM list_item_value WHERE STATUS='Y' and ITEM_TYPE='DOCPOLICYTYPE'
##Third Party Master
##GET_THIRD_PARTY_LIST = SELECT MTR.THIRD_PARTY_ID,MTR.THIRD_PARTY_RATE,TO_DATE (MTR.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,MTR.COREAPP_CODE,DECODE (MTR.STATUS,'Y','Active','N', 'Deactive')STATUS,MVM.VEHICLETYPE_DESC FROM   MOTOR_TYPE_THIRD_PARTY MTR,MOTOR_VEHICLETYPE_MASTER MVM WHERE MTR.BRANCH_CODE \= ? AND MTR.PRODUCT_ID \= ? AND MVM.VTYPE_ID \= MTR.TYPE_OF_BODY_ID AND MTR.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_THIRD_PARTY MTP WHERE   THIRD_PARTY_ID \= MTR.THIRD_PARTY_ID)
GET_THIRD_PARTY_LIST = SELECT MTR.SEATING_CYLINDER_START,MTR.SEATING_CYLINDER_END,MTR.THIRD_PARTY_ID,MTR.THIRD_PARTY_RATE,TO_DATE (MTR.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,MTR.COREAPP_CODE,DECODE (MTR.STATUS,'Y', 'Active','N', 'Deactive')STATUS FROM   MOTOR_TYPE_THIRD_PARTY MTR WHERE MTR.BRANCH_CODE \= ? AND MTR.PRODUCT_ID \= ? AND MTR.TYPE_OF_BODY_ID \= ? AND MTR.AMEND_ID \= ( SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_THIRD_PARTY MTP WHERE   THIRD_PARTY_ID \= MTR.THIRD_PARTY_ID)   
GET_EDIT_THIRD_PARTY = SELECT THIRD_PARTY_ID,TYPE_OF_BODY_ID,SEATING_CYLINDER_START,SEATING_CYLINDER_END,THIRD_PARTY_RATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,COREAPP_CODE,STATUS FROM MOTOR_TYPE_THIRD_PARTY MTR WHERE THIRD_PARTY_ID = ? AND PRODUCT_ID =? AND BRANCH_CODE =? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID = MTR.THIRD_PARTY_ID)
CHECK_THIRD_PARTY_CORE_CODE = SELECT COUNT(*) FROM MOTOR_TYPE_THIRD_PARTY MTR WHERE COREAPP_CODE = ? AND BRANCH_CODE =? AND STATUS ='Y'  AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_THIRD_PARTY MTP WHERE   THIRD_PARTY_ID = MTR.THIRD_PARTY_ID)
CHECK_THIRD_PARTY_VEHICLE_USAGE = SELECT COUNT(*) FROM MOTOR_TYPE_THIRD_PARTY MTR WHERE TYPE_OF_BODY_ID = ? AND BRANCH_CODE =? AND STATUS ='Y' AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_THIRD_PARTY MTP WHERE   THIRD_PARTY_ID = MTR.THIRD_PARTY_ID)
GET_MAX_THIRD_PARTY_ID = SELECT NVL(MAX(THIRD_PARTY_ID)+1,0) FROM MOTOR_TYPE_THIRD_PARTY
GET_EDIT_THIRD_PARTY_AMEND_ID = SELECT AMEND_ID FROM MOTOR_TYPE_THIRD_PARTY MTP WHERE THIRD_PARTY_ID \= ? AND AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID \= MTP.THIRD_PARTY_ID)  AND EFFECTIVE_DATE > SYSDATE
INS_THIRD_PARTY_MASTER = INSERT INTO MOTOR_TYPE_THIRD_PARTY(BRANCH_CODE,PRODUCT_ID,THIRD_PARTY_ID,AMEND_ID,TYPE_OF_BODY_ID,SEATING_CYLINDER_START,THIRD_PARTY_RATE,EFFECTIVE_DATE,COREAPP_CODE,STATUS,SEATING_CYLINDER_END,LOCATIONID) VALUES(?,?,?,( SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID \=?),?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?) 
UPD_THIRD_PARTY_MASTER = UPDATE MOTOR_TYPE_THIRD_PARTY MTR SET BRANCH_CODE=?,PRODUCT_ID=?,TYPE_OF_BODY_ID=?,SEATING_CYLINDER_START=?,THIRD_PARTY_RATE=?,EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),COREAPP_CODE=?,STATUS=?,SEATING_CYLINDER_END=?,LOCATIONID=? WHERE THIRD_PARTY_ID=? AND AMEND_ID= ?
GET_THIRD_PARTY_HEADER_LIST = SELECT MVM.VEHICLETYPE_DESC,MBM.TYPE_OF_BODY_NAME FROM MOTOR_VEHICLETYPE_MASTER MVM, MOTOR_BODYTYPE_DETAIL MBM WHERE MVM.VTYPE_ID\=? AND MVM.STATUS\='Y' AND MVM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_VEHICLETYPE_MASTER WHERE VTYPE_ID\=MVM.VTYPE_ID) AND MBM.TYPE_OF_BODY_ID\=?       AND MBM.STATUS\='Y' AND MBM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL WHERE TYPE_OF_BODY_ID\=MBM.TYPE_OF_BODY_ID)

CHECK_THIRD_PARTY_SEATING_CYL = SELECT COUNT(*) FROM MOTOR_TYPE_THIRD_PARTY MSM WHERE MSM.TYPE_OF_BODY_ID\=? AND STATUS\='Y' AND  ((? BETWEEN MSM.SEATING_CYLINDER_START AND MSM.SEATING_CYLINDER_END) OR (? BETWEEN MSM.SEATING_CYLINDER_START AND MSM.SEATING_CYLINDER_END)) AND BRANCH_CODE \= ? AND MSM.AMEND_ID \=(SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID\=MSM.THIRD_PARTY_ID )  
GET_THIRD_PARTY_SEATING_CYL_MODEL = SELECT SEATING_CYLINDER_START,SEATING_CYLINDER_END,BRANCH_CODE, PRODUCT_ID, (SELECT TYPE_OF_BODY_NAME FROM MOTOR_BODYTYPE_DETAIL  MTBM WHERE MTBM.TYPE_OF_BODY_ID=MTTP.TYPE_OF_BODY_ID AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL MT WHERE MTBM.TYPE_OF_BODY_ID=MT.TYPE_OF_BODY_ID )) TYPE_OF_BODY_ID, TYPE_OF_BODY_ID, AMEND_ID, SEATING_CYLINDER_START, SEATING_CYLINDER_END, THIRD_PARTY_RATE, TO_CHAR(EFFECTIVE_DATE,'dd/mm/yyyy' ) EFFECTIVE_DATE, COREAPP_CODE, STATUS,(SELECT COUNTRY_NAME FROM  MOTOR_MFG_COUNTRY_MASTER MMCM WHERE MMCM.COUNTRY_ID=MTTP.LOCATIONID AND BRANCH_CODE=MTTP.BRANCH_CODE) COUNTRY_NAME FROM MOTOR_TYPE_THIRD_PARTY MTTP WHERE MTTP.TYPE_OF_BODY_ID=? AND  ((? BETWEEN MTTP.SEATING_CYLINDER_START AND MTTP.SEATING_CYLINDER_END) OR (? BETWEEN MTTP.SEATING_CYLINDER_START AND MTTP.SEATING_CYLINDER_END)) AND MTTP.AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID=MTTP.THIRD_PARTY_ID )

   


#Deductible Master
GET_DEDUCTIBLE_MASTER = SELECT DEDUCT_ID, DEDUCT_START, DEDUCT_END, RATE, DISC_AMT, AMEND_ID,DECODE ( STATUS,'Y','Active','N','Deactive') STATUS, ENTRY_DATE, EFFECTIVE_DATE, REMARKS, BRANCH_CODE, SEATING_START,SEATING_END, (Select VEHICLETYPE_DESC From  Motor_vehicletype_master where VTYPE_ID=(Select VTYPE_ID from Motor_bodytype_detail mbd Where mbd.TYPE_OF_BODY_ID=mdms.TYPE_OF_BODY_ID)) Vehicle_name , (Select BODY_NAME From  Motor_Bodytype_master where BODY_ID=(Select BODY_ID from Motor_bodytype_detail mbd Where mbd.TYPE_OF_BODY_ID=mdms.TYPE_OF_BODY_ID)) BODY_name FROM MOTOR_DEDUCTIBLE_MASTER mdms where BRANCH_CODE=? and amend_id=( select max(amend_id) from MOTOR_DEDUCTIBLE_MASTER mdm where mdm.BRANCH_CODE=mdms.BRANCH_CODE and mdm.DEDUCT_ID=mdms.DEDUCT_ID) ORDER BY DEDUCT_ID
GET_DEDUCTIBLE_FOR_EDIT = SELECT mdms.DEDUCT_ID,mdms.DEDUCT_START,mdms.DEDUCT_END,mdms.RATE,mdms.DISC_AMT, mdms.SEATING_START ,mdms.SEATING_END,mdms.STATUS,TO_CHAR(mdms.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE, mdms.REMARKS,MBD.BODY_ID,MBD.VTYPE_ID FROM MOTOR_DEDUCTIBLE_MASTER mdms,Motor_bodytype_detail mbd WHERE DEDUCT_ID=? and BRANCH_CODE=? and MBD.TYPE_OF_BODY_ID = MDMS.TYPE_OF_BODY_ID and mdms.amend_id=(select max(amend_id) from MOTOR_DEDUCTIBLE_MASTER mdm where mdm.DEDUCT_ID=mdms.DEDUCT_ID)
GET_DEDUCTIBLE_FOR_INSERT = INSERT INTO MOTOR_DEDUCTIBLE_MASTER (DEDUCT_ID,DEDUCT_START,DEDUCT_END,RATE,DISC_AMT,TYPE_OF_BODY_ID,SEATING_START,SEATING_END,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE) VALUES (?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_DEDUCTIBLE_MASTER WHERE DEDUCT_ID=? ),?)
GET_MAX_DEDUCTIBLE_ID = SELECT MAX(DEDUCT_ID)+1 FROM MOTOR_DEDUCTIBLE_MASTER 
GET_EDIT_DEDUCTIBLE_AMEND_ID = SELECT AMEND_ID FROM MOTOR_DEDUCTIBLE_MASTER MDMS WHERE DEDUCT_ID \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_DEDUCTIBLE_MASTER MDM WHERE MDM.DEDUCT_ID\=MDMS.DEDUCT_ID)  AND EFFECTIVE_DATE > SYSDATE
GET_DEDUCTIBLE_FOR_UPDATE = UPDATE MOTOR_DEDUCTIBLE_MASTER MMM SET DEDUCT_START\=?,DEDUCT_END\=?,RATE\=?,DISC_AMT\=?,TYPE_OF_BODY_ID\=?,SEATING_START\=?,SEATING_END\=?,STATUS\=?,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'),REMARKS\=?,BRANCH_CODE\=? WHERE MMM.DEDUCT_ID \= ? AND MMM.AMEND_ID \=?

##Area Coverage
GET_AREACOVERAGE_MASTER = SELECT AREACOVER_ID, AREACOVER_CODE, AREACOVER_DESC_ENGLISH, AREACOVER_DESC_ARABIC,DECODE (STATUS,'Y','Active','N','Deactive')STATUS, TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,EXPIRY_DATE, REMARKS, AMEND_ID, BRANCH_CODE FROM MOTOR_AREACOVERAGE_MASTER mdms where BRANCH_CODE=? and amend_id=(select max(amend_id) from MOTOR_AREACOVERAGE_MASTER mdm where mdm.BRANCH_CODE=mdms.BRANCH_CODE and mdm.AREACOVER_ID=mdms.AREACOVER_ID) ORDER BY AREACOVER_ID
GET_AREACOVERAGE_FOR_EDIT = SELECT AREACOVER_ID,AREACOVER_CODE,AREACOVER_DESC_ENGLISH,AREACOVER_DESC_ARABIC,STATUS,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,REMARKS FROM MOTOR_AREACOVERAGE_MASTER MAM WHERE AREACOVER_ID=? and BRANCH_CODE=?  AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_ID = MAM.AREACOVER_ID)
GET_AREACOVERAGE_FOR_INSERT = INSERT INTO MOTOR_AREACOVERAGE_MASTER (AREACOVER_ID,AREACOVER_CODE,AREACOVER_DESC_ENGLISH,AREACOVER_DESC_ARABIC,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE) VALUES (?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_ID\=? ),?)
GET_EDIT_AREA_AMEND_ID = SELECT   AMEND_ID FROM   MOTOR_AREACOVERAGE_MASTER MDMS WHERE   AREACOVER_ID = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_AREACOVERAGE_MASTER MDM WHERE   MDM.AREACOVER_ID = MDMS.AREACOVER_ID)  AND EFFECTIVE_DATE > SYSDATE
GET_MAX_AREACOVERAGE_ID = SELECT NVL(MAX(AREACOVER_ID),0)+1 FROM MOTOR_AREACOVERAGE_MASTER 
GET_AREACOVERAGE_FOR_UPDATE = UPDATE MOTOR_AREACOVERAGE_MASTER MMM SET AREACOVER_CODE\=?,AREACOVER_DESC_ENGLISH\=?,AREACOVER_DESC_ARABIC\=?,STATUS\=?,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'),REMARKS\=?,BRANCH_CODE\=? WHERE MMM.AREACOVER_ID \= ? AND MMM.AMEND_ID \=?
CHECK_AREACOVERAGE_CODE = select COUNT(*) FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_CODE\=? AND BRANCH_CODE\=? AND STATUS\='Y'

##GET_VEHICLE_TYPE_LIST_ADMIN = SELECT   MVM.VTYPE_ID, MVM.VTYPE_CODE FROM   MOTOR_VEHICLETYPE_MASTER MVM WHERE   STATUS = 'Y' AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_VEHICLETYPE_MASTER WHERE   VTYPE_ID = MVM.VTYPE_ID)

##OPCOVER MASTER
#GET_OPCOVER_MASTER_LIST = SELECT OPC.OPCOVER_ID, MPM.POLICYTYPE_DESC_ENGLISH, OPC.POLICY_SUBTYPE_ID, OPC.OPCOVER_DESC, OPC.COREAPP_CODE, DECODE (OPC.STATUS,'Y','Active','N','De Active') STATUS, TO_CHAR (OPC.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE FROM MOTOR_OPCOVER_MASTER OPC, MOTOR_POLICYTYPE_MASTER MPM WHERE OPC.BRANCH_CODE = ? AND MPM.POLICYTYPE_ID=OPC.POLICY_SUBTYPE_ID AND MPM.BRANCH_CODE=OPC.BRANCH_CODE AND OPC.AMEND_ID = (SELECT   MAX (MOM.AMEND_ID) FROM   MOTOR_OPCOVER_MASTER MOM WHERE   MOM.OPCOVER_ID = OPC.OPCOVER_ID) ORDER BY   OPC.OPCOVER_ID
GET_OPCOVER_MASTER_LIST = SELECT OPC.OPCOVER_ID, OPC.OPCOVER_DESC, OPC.COREAPP_CODE, DECODE (OPC.STATUS,'Y','Active','N','De Active') STATUS, TO_CHAR (OPC.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE FROM MOTOR_OPCOVER_MASTER OPC WHERE OPC.BRANCH_CODE = ? AND OPC.AMEND_ID = (SELECT   MAX (MOM.AMEND_ID) FROM   MOTOR_OPCOVER_MASTER MOM WHERE   MOM.OPCOVER_ID = OPC.OPCOVER_ID) ORDER BY   OPC.OPCOVER_ID
EDIT_OPCOVER_MASTER = SELECT  OPCOVER_DESC, COREAPP_CODE, STATUS, TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, POLICY_SUBTYPE_ID, REMARKS FROM MOTOR_OPCOVER_MASTER OPC WHERE BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (MOM.AMEND_ID) FROM   MOTOR_OPCOVER_MASTER MOM WHERE   MOM.OPCOVER_ID = OPC.OPCOVER_ID) and OPCOVER_ID=? ORDER BY   OPCOVER_ID DESC
GET_EDIT_AMENDID_OPCOVER =  SELECT AMEND_ID  FROM MOTOR_OPCOVER_MASTER MOP WHERE OPCOVER_ID = ? AND BRANCH_CODE=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_OPCOVER_MASTER  WHERE OPCOVER_ID  = MOP.OPCOVER_ID ) AND EFFECTIVE_DATE > SYSDATE
INSERT_OPCOVER_MASTER = Insert into MOTOR_OPCOVER_MASTER(OPCOVER_ID, AMEND_ID, OPCOVER_DESC, COREAPP_CODE, STATUS, EFFECTIVE_DATE, ENTRY_DATE, REMARKS, PRODUCT, BRANCH_CODE, POLICY_SUBTYPE_ID) Values (?, (SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_OPCOVER_MASTER WHERE OPCOVER_ID= ?), ?, ?, ?, TO_DATE(?,'DD/MM/YYYY'), sysdate,?, ?, ?, ?)
UPDATE_OPCOVER_MASTER = UPDATE MOTOR_OPCOVER_MASTER OPC SET OPCOVER_DESC = ?, COREAPP_CODE = ?, EFFECTIVE_DATE = TO_DATE(?,'DD/MM/YYYY'), REMARKS=?, STATUS= ?, POLICY_SUBTYPE_ID = ? WHERE OPCOVER_ID = ? AND AMEND_ID = ?
GET_MAX_OPCOVERID = SELECT NVL(MAX(OPCOVER_ID),0)+1 FROM MOTOR_OPCOVER_MASTER
CHECK_CORE_APP_CODE_OPCOVER = select COUNT(*) FROM MOTOR_OPCOVER_MASTER WHERE COREAPP_CODE\=? and BRANCH_CODE\=?


##Body Type Master
GET_BODYTYPE_MASTER_LIST=select BODY_ID,BODY_NAME,COREAPP_CODE,DECODE(STATUS,'Y','Active','Deactive') STATUS,DECODE(REFERRAL_STATUS,'Y',' Referral','Non-Referral') REFERRAL_STATUS  From motor_bodytype_master mbm WHERE BRANCH_CODE\=?  AND AMEND_ID \= (SELECT max(AMEND_ID) FROM  motor_bodytype_master WHERE BODY_ID\=mbm.BODY_ID ) ORDER BY BODY_ID 
EDIT_BODYTYPE_MASTER=select BODY_ID,BODY_NAME,COREAPP_CODE,STATUS,REFERRAL_STATUS,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE ,TO_CHAR(ENTRY_DATE,'DD/MM/YYYY')ENTRY_DATE,REMARKS  From motor_bodytype_master  WHERE BODY_ID\=? AND AMEND_ID \= (SELECT max(AMEND_ID) FROM  motor_bodytype_master WHERE BODY_ID\=? ) ORDER BY BODY_ID DESC
GET_MAX_AMEND_ID_BODY_TYPE=SELECT NVL(MAX(AMEND_ID)+1,0) FROM motor_bodytype_master where BODY_ID=?
GET_EDIT_BODYTYPE_AMEND_ID = SELECT AMEND_ID FROM MOTOR_BODYTYPE_MASTER MBM WHERE BODY_ID = ? AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_MASTER WHERE BODY_ID = MBM.BODY_ID)  AND EFFECTIVE_DATE > SYSDATE
BODY_TYPE_INSERT=INSERT INTO motor_bodytype_master(BODY_ID,AMEND_ID,BODY_NAME,COREAPP_CODE,STATUS,ENTRY_DATE,EFFECTIVE_DATE,REMARKS,BRANCH_CODE,REFERRAL_STATUS)values((SELECT NVL(MAX(BODY_ID),0)+1 FROM motor_bodytype_master),?,?,?,?,SYSDATE,TO_DATE(?,'DD/MM/YYYY'),?,?,?)
BODY_TYPE_UPDATE=UPDATE motor_bodytype_master SET BODY_NAME\=?,COREAPP_CODE\=?,STATUS\=?,ENTRY_DATE\=SYSDATE,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'),REMARKS\=?,BRANCH_CODE \= ?,REFERRAL_STATUS\=? WHERE BODY_ID\=? AND AMEND_ID \=? 
BODY_TYPE_UPDATE_INSERT=INSERT INTO MOTOR_BODYTYPE_MASTER(AMEND_ID,BODY_NAME,COREAPP_CODE,STATUS,ENTRY_DATE,EFFECTIVE_DATE,REMARKS,BRANCH_CODE,BODY_ID,REFERRAL_STATUS)VALUES((SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_BODYTYPE_MASTER WHERE BODY_ID=?),?,?,?,SYSDATE,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?)

##VEHICLE_LINK_LIST_BODY_TYPE_MASTER=select VTYPE_ID,TYPE_OF_BODY_NAME,COREAPP_CODE,DECODE(STATUS,'Y','Active','Deactive') STATUS,DECODE(REFERRAL_STATUS,'Y','Active','Deactive')REFERRAL_STATUS from MOTOR_BODYTYPE_DETAIL where BODY_ID=?
##VEHICLE_LINK_LIST_BODY_TYPE_MASTER= select VTYPE_ID,TYPE_OF_BODY_ID,(SELECT VEHICLETYPE_DESC FROM motor_vehicletype_master MVM WHERE MVM.VTYPE_ID=MTBM.VTYPE_ID AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM motor_vehicletype_master MM WHERE MM.TYPE_OF_BODY_ID=MVM.TYPE_OF_BODY_ID)) VEHICLETYPE_DESC,TYPE_OF_BODY_NAME,COREAPP_CODE,DECODE(STATUS,'Y','Active','Deactive') STATUS,DECODE(REFERRAL_STATUS,'Y','Active','Deactive')REFERRAL_STATUS from MOTOR_BODYTYPE_DETAIL MTBM where BODY_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL MTM WHERE MTM.TYPE_OF_BODY_ID=MTBM.TYPE_OF_BODY_ID)
VEHICLE_LINK_LIST_BODY_TYPE_MASTER=select VTYPE_ID,TYPE_OF_BODY_ID,(SELECT VEHICLETYPE_DESC FROM motor_vehicletype_master MVM WHERE MVM.VTYPE_ID=MTBM.VTYPE_ID AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM motor_vehicletype_master MM WHERE MM.VTYPE_ID=MVM.VTYPE_ID)) VEHICLETYPE_DESC, TYPE_OF_BODY_NAME,DECODE(STATUS,'Y','Active','Deactive') STATUS from MOTOR_BODYTYPE_DETAIL MTBM where BODY_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL MTM WHERE MTM.TYPE_OF_BODY_ID=MTBM.TYPE_OF_BODY_ID)
VEHICLE_LIST=select VTYPE_ID,VEHICLETYPE_DESC from  motor_vehicletype_master MV where AMEND_ID\=(SELECT MAX(AMEND_ID) FROM motor_vehicletype_master MVM WHERE MVM.VTYPE_ID\=MV.VTYPE_ID) 
##VEHICLE_LINK_EDIT=select VTYPE_ID,EFFECTIVE_DATE,REMARKS,TYPE_OF_BODY_ID,(SELECT VEHICLETYPE_DESC FROM motor_vehicletype_master MVM WHERE MVM.VTYPE_ID=MTBM.VTYPE_ID AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM motor_vehicletype_master MM WHERE MM.VTYPE_ID=MVM.VTYPE_ID)) VEHICLETYPE_DESC,TYPE_OF_BODY_NAME,COREAPP_CODE,DECODE(STATUS,'Y','Active','Deactive') STATUS,DECODE(REFERRAL_STATUS,'Y','Active','Deactive')REFERRAL_STATUS from MOTOR_BODYTYPE_DETAIL MTBM where AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL MTM WHERE MTM.VTYPE_ID=MTBM.VTYPE_ID) AND TYPE_OF_BODY_ID=?
VEHICLE_LINK_EDIT=select VTYPE_ID,TYPE_OF_BODY_ID,TYPE_OF_BODY_NAME,STATUS from MOTOR_BODYTYPE_DETAIL MTBM where  AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL MTM WHERE MTM.TYPE_OF_BODY_ID=MTBM.TYPE_OF_BODY_ID) AND TYPE_OF_BODY_ID=?
VEHICLE_COUNT=select count(*) from MOTOR_BODYTYPE_DETAIL WHERE  BODY_ID=?
VEHICLE_COUNT1=select count(*) from MOTOR_BODYTYPE_DETAIL WHERE  TYPE_OF_BODY_ID=?
BODY_ADDED_VEHYCLE=select BODY_NAME,STATUS FROM motor_bodytype_master MBM WHERE BODY_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM motor_bodytype_master MTM WHERE MTM.BODY_ID=MBM.BODY_ID)
VEHICLE_INSERT=insert into MOTOR_BODYTYPE_DETAIL(VTYPE_ID,BODY_ID,AMEND_ID,TYPE_OF_BODY_ID,STATUS,TYPE_OF_BODY_NAME)values(?,?,?,(SELECT NVL(MAX(TYPE_OF_BODY_ID),0)+1 FROM MOTOR_BODYTYPE_DETAIL),?,?)
VEHICLE_BODY_TYPE_ID_INSERT=insert into MOTOR_BODYTYPE_DETAIL(VTYPE_ID,AMEND_ID,TYPE_OF_BODY_ID,STATUS,TYPE_OF_BODY_NAME,BODY_ID)values(?,(select max(AMEND_ID)+1 from MOTOR_BODYTYPE_DETAIL where TYPE_OF_BODY_ID=?),?,?,?,(select BODY_ID from MOTOR_BODYTYPE_DETAIL MK where TYPE_OF_BODY_ID=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL MTM WHERE MTM.TYPE_OF_BODY_ID=MK.TYPE_OF_BODY_ID)))
CORE_APP_CODE_COUNT=select count(*) from motor_bodytype_master where BRANCH_CODE=? and COREAPP_CODE=? and BODY_ID!=? and STATUS='Y'
CORE_APP_CODE_COUNT1=select count(*) from motor_bodytype_master where BRANCH_CODE\=? and COREAPP_CODE\=? and STATUS\='Y'


##VEHICLE TYPE MASTER
GET_VEHICLE_TYPE_MASTER =SELECT VTYPE_ID, VEHICLETYPE_DESC, CORE_APP_CODE, DECODE(STATUS,'Y','Active','N','Deactive')STATUS, TO_CHAR(EFFECTIVE_DATE,'dd-mm-yyyy')EFFECTIVE_DATE,DECODE(REFERRAL_STATUS,'Y','Active','N','Deactive')REFERRAL_STATUS FROM MOTOR_VEHICLETYPE_MASTER  mvms where BRANCH_CODE\=? and amend_id\=(select max(amend_id) from MOTOR_VEHICLETYPE_MASTER mvm where mvm.BRANCH_CODE\=mvms.BRANCH_CODE and mvm.VTYPE_ID\=mvms.VTYPE_ID) order by VTYPE_ID
GET_EDIT_VEHICLE_TYPE = SELECT  VTYPE_ID,VEHICLETYPE_DESC,CORE_APP_CODE,TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY')EFFECTIVE_DATE,REMARKS,REFERRAL_STATUS,STATUS FROM   MOTOR_VEHICLETYPE_MASTER MVM WHERE   VTYPE_ID = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_VEHICLETYPE_MASTER WHERE   VTYPE_ID = MVM.VTYPE_ID) AND MVM.BRANCH_CODE = ?
GET_MAX_VTYPE_ID = SELECT NVL(MAX(VTYPE_ID),0)+1 FROM MOTOR_VEHICLETYPE_MASTER
GET_EDIT_VTYPE_AMEND_ID = SELECT AMEND_ID FROM   MOTOR_VEHICLETYPE_MASTER MVM WHERE   VTYPE_ID \= ? AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_VEHICLETYPE_MASTER WHERE   VTYPE_ID \= MVM.VTYPE_ID) AND EFFECTIVE_DATE > SYSDATE 
GET_VEHICLETYPE_INSERT = INSERT INTO MOTOR_VEHICLETYPE_MASTER(VTYPE_ID,VEHICLETYPE_DESC,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE,CORE_APP_CODE,REFERRAL_STATUS,PRODUCT_ID) VALUES (?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_VEHICLETYPE_MASTER WHERE VTYPE_ID\=? ),?,?,?,?)
UPDATE_VEHICLETYPE_MASTER =UPDATE MOTOR_VEHICLETYPE_MASTER MVM SET VEHICLETYPE_DESC\=?,STATUS\=?,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'),REMARKS\=?,BRANCH_CODE\=?,CORE_APP_CODE\=?,REFERRAL_STATUS\=?,PRODUCT_ID\=? WHERE MVM.VTYPE_ID \= ? AND MVM.AMEND_ID \=?
CHECK_CORE_APP_CODE = select COUNT(*) FROM MOTOR_VEHICLETYPE_MASTER WHERE CORE_APP_CODE\=?

##Policy Type Master
GET_POLICY_TYPE_MASTER_LIST =SELECT POLICYTYPE_ID,COREAPP_CODE,POLICYTYPE_DESC_ENGLISH,POLICYTYPE_DESC_ARABIC,DECODE(PAYMENT_YN,'Y','Yes','No') PAYMENT_YN,DECODE(STATUS,'Y','Active','N','Deactive')STATUS,to_char(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,REMARKS,POLICY_SUBTYPE_ID FROM  MOTOR_POLICYTYPE_MASTER MPM  WHERE BRANCH_CODE \= ? AND AMEND_ID \= (SELECT MAX(AMEND_ID) FROM  MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID \= MPM.POLICY_SUBTYPE_ID) ORDER BY POLICY_SUBTYPE_ID DESC
GET_EDIT_POLICY_TYPE_MASTER = SELECT POLICYTYPE_ID,PAYMENT_YN,COREAPP_CODE,POLICYTYPE_DESC_ENGLISH,POLICYTYPE_DESC_ARABIC,STATUS,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,REMARKS FROM MOTOR_POLICYTYPE_MASTER MPM WHERE POLICY_SUBTYPE_ID =? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID= MPM.POLICY_SUBTYPE_ID)
GET_MAIN_POLICY_TYPE_LIST = SELECT ITEM_CODE,ITEM_VALUE FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE='POLICYTYPE' ORDER BY ITEM_CODE ASC
GET_MAX_POLICY_SUB_ID = SELECT   NVL(MAX (POLICY_SUBTYPE_ID)+1,0) FROM   MOTOR_POLICYTYPE_MASTER
GET_EDIT_POLICY_TYPE_AMEND_ID = SELECT AMEND_ID FROM  MOTOR_POLICYTYPE_MASTER MPM WHERE POLICY_SUBTYPE_ID \= ? AND AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM  MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID \= MPM.POLICY_SUBTYPE_ID)  AND EFFECTIVE_DATE > SYSDATE
INS_POLICY_TYPE_MASTER = INSERT INTO MOTOR_POLICYTYPE_MASTER (POLICYTYPE_ID,COREAPP_CODE,POLICYTYPE_DESC_ENGLISH,POLICYTYPE_DESC_ARABIC,STATUS,EFFECTIVE_DATE,REMARKS,BRANCH_CODE,AMEND_ID,POLICY_SUBTYPE_ID,PAYMENT_YN) VALUES (?,?,?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,(SELECT   NVL(MAX (AMEND_ID)+1,0) FROM   MOTOR_POLICYTYPE_MASTER WHERE   POLICY_SUBTYPE_ID = ?),?,?)
UPD_POLICY_TYPE_MASTER = UPDATE MOTOR_POLICYTYPE_MASTER MPM SET POLICYTYPE_ID=?,COREAPP_CODE=?,POLICYTYPE_DESC_ENGLISH=?,POLICYTYPE_DESC_ARABIC=?,STATUS=?,EFFECTIVE_DATE=?,REMARKS=?,PAYMENT_YN=? WHERE POLICY_SUBTYPE_ID =? AND AMEND_ID = ?
CHECK_POLICYTYPE_CORE_CODE = SELECT COUNT(*) FROM MOTOR_POLICYTYPE_MASTER WHERE COREAPP_CODE \=? AND BRANCH_CODE \= ? 

##NCB Master
##GET_NCB_MASTER_DATA_LIST = SELECT S_NO,POLICYTYPE,NCBYEAR,INSUREDVALUE_START,INSUREDVALUE_END,RATE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE,EXPIRY_DATE,AMEND_ID,BRANCH_CODE,RATE_TYPE,DECODE(STATUS,'Y','Active','N','DeActive')STATUS,CORE_CODE FROM MOTOR_NCB_MASTER MNM WHERE  BRANCH_CODE = ? AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_NCB_MASTER WHERE  NCBYEAR = MNM.NCBYEAR)
GET_NCB_MASTER_DATA_LIST = SELECT   MNM.S_NO,MNM.POLICYTYPE,MNM.NCBYEAR,MNM.INSUREDVALUE_START,MNM.INSUREDVALUE_END,MNM.RATE,TO_CHAR (MNM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,MNM.EXPIRY_DATE,MNM.AMEND_ID,MNM.BRANCH_CODE,MNM.RATE_TYPE,LIV.ITEM_VALUE VEHICLE_USAGE,DECODE (MNM.STATUS,'Y','Active','N','DeActive') STATUS,MNM.CORE_CODE FROM   MOTOR_NCB_MASTER MNM, LIST_ITEM_VALUE LIV WHERE   BRANCH_CODE \= ? AND LIV.ITEM_TYPE\='NCBVEHICLE' AND LIV.ITEM_CODE \=MNM.VTYPE_ID AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE   S_NO \= MNM.S_NO) 
GET_NCB_VEHICLE_USAGE = SELECT ITEM_CODE,ITEM_VALUE FROM LIST_ITEM_VALUE WHERE ITEM_TYPE='NCBVEHICLE' ORDER BY ITEM_CODE ASC
##GET_EDIT_NCB_MASTER = SELECT   S_NO,POLICYTYPE,NCBYEAR,INSUREDVALUE_START, INSUREDVALUE_END, RATE, TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, EXPIRY_DATE, AMEND_ID, BRANCH_CODE, RATE_TYPE, STATUS, CORE_CODE FROM   MOTOR_NCB_MASTER MNM WHERE   S_NO = ? AND BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE  NCBYEAR = MNM.NCBYEAR)
GET_EDIT_NCB_MASTER = SELECT   S_NO,POLICYTYPE,NCBYEAR,INSUREDVALUE_START, INSUREDVALUE_END,VTYPE_ID,RATE, TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, EXPIRY_DATE, AMEND_ID, BRANCH_CODE, RATE_TYPE, STATUS, CORE_CODE FROM   MOTOR_NCB_MASTER MNM WHERE   S_NO = ? AND BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE  S_NO = MNM.S_NO)
CHECK_NCB_MASTER = SELECT COUNT(*) FROM MOTOR_NCB_MASTER MNM WHERE NCBYEAR =? AND VTYPE_ID =? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE   S_NO = MNM.S_NO) AND STATUS='Y'
GET_COUNT_NCB = SELECT COUNT(*) FROM MOTOR_NCB_MASTER WHERE NCBYEAR =? AND BRANCH_CODE =?
CHECK_NCB_CORE_CODE = SELECT COUNT(*) FROM MOTOR_NCB_MASTER MNM WHERE CORE_CODE \=? AND BRANCH_CODE \=? AND STATUS\='Y' AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE   S_NO \= MNM.S_NO)
GET_MAX_NCB_ID = SELECT NVL(MAX(S_NO)+1,0) FROM MOTOR_NCB_MASTER 
GET_EDIT_NCB_AMEND_ID = SELECT   AMEND_ID FROM   MOTOR_NCB_MASTER NCB WHERE       AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE   S_NO = NCB.S_NO) AND S_NO = ? AND EFFECTIVE_DATE > SYSDATE
INS_NCB_MASTER = INSERT INTO MOTOR_NCB_MASTER (PRODUCT_ID,POLICYTYPE,NCBYEAR,INSUREDVALUE_START,INSUREDVALUE_END,RATE,EFFECTIVE_DATE,S_NO,AMEND_ID,BRANCH_CODE,STATUS,CORE_CODE,VTYPE_ID) VALUES (?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_NCB_MASTER WHERE S_NO =?),?,?,?,?)
##UPD_NCB_MASTER = UPDATE MOTOR_NCB_MASTER MNM SET PRODUCT_ID\=?,NCBYEAR\=?,INSUREDVALUE_START\=?,INSUREDVALUE_END\=?,RATE\=?,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'),BRANCH_CODE\=?,STATUS\=?,CORE_CODE \=? WHERE S_NO \=? AND  AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_NCB_MASTER WHERE  S_NO \= MNM.S_NO)
UPD_NCB_MASTER = UPDATE MOTOR_NCB_MASTER MNM SET PRODUCT_ID\=?,NCBYEAR\=?,INSUREDVALUE_START\=? ,INSUREDVALUE_END\=?,RATE\=?,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'), BRANCH_CODE\=?,STATUS\=?,CORE_CODE \=?,VTYPE_ID\=? WHERE S_NO \=? AND  AMEND_ID \= ? 

##Constant Details

GET_CONSTANT_MASTER_LIST = SELECT DISTINCT ITEM_TYPE FROM LIST_ITEM_VALUE

##BANK FINANCE MASTER
GET_BANK_FINANCE_MASTER = SELECT BANK_ID, BANK_CODE, BANK_NAME_ENGLISH, BANK_NAME_ARABIC,DECODE(STATUS,'Y','Active','N','Deactive')STATUS, TO_CHAR(EFFECTIVE_DATE,'dd-mm-yyyy')EFFECTIVE_DATE FROM MOTOR_FINANCE_BANK_MASTER  mfbm where BRANCH_CODE\=? and amend_id\=(select max(amend_id) from MOTOR_FINANCE_BANK_MASTER mfm where mfm.BRANCH_CODE\=mfbm.BRANCH_CODE and mfm.BANK_ID\=mfbm.BANK_ID) order by BANK_ID
GET_EDIT_BANK_FINANCE = SELECT  BANK_ID,BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY')EFFECTIVE_DATE,REMARKS,STATUS FROM   MOTOR_FINANCE_BANK_MASTER MFBM WHERE   BANK_ID = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_FINANCE_BANK_MASTER WHERE   BANK_ID = MFBM.BANK_ID) AND MFBM.BRANCH_CODE = ?
GET_MAX_BANK_ID = SELECT NVL(MAX(BANK_ID),0)+1 FROM MOTOR_FINANCE_BANK_MASTER
GET_EDIT_FBANK_AMEND_ID = SELECT AMEND_ID FROM MOTOR_FINANCE_BANK_MASTER  MFBM WHERE BANK_ID\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_FINANCE_BANK_MASTER MFM WHERE  MFM.BANK_ID\=MFBM.BANK_ID) AND EFFECTIVE_DATE > SYSDATE
GET_BANK_FINANCE_INSERT = INSERT INTO MOTOR_FINANCE_BANK_MASTER(BANK_ID,BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE) VALUES (?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_FINANCE_BANK_MASTER WHERE BANK_ID=?),?)
UPDATE_BANK_FINANCE_MASTER =UPDATE MOTOR_FINANCE_BANK_MASTER MFBM SET BANK_CODE\=?,BANK_NAME_ENGLISH\=?,BANK_NAME_ARABIC\=?,STATUS\=?,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'),REMARKS\=?,BRANCH_CODE\=? WHERE MFBM.BANK_ID \= ? AND MFBM.AMEND_ID \=?
CHECK_BANK_CODE =select COUNT(*) FROM MOTOR_FINANCE_BANK_MASTER WHERE BANK_CODE\=? AND BRANCH_CODE\=?

##Group Master
GET_GROUP_MASTER = SELECT GROUP_ID, GROUP_DESC_ENGLISH,DECODE(STATUS,'Y','Active','N','Deactive')STATUS, TO_CHAR(EFFECTIVE_DATE,'dd-mm-yyyy')EFFECTIVE_DATE,DISPLAY_ORDER FROM MOTOR_GROUP_MASTER  mgmm where BRANCH_CODE\=? and amend_id\=(select max(amend_id) from MOTOR_GROUP_MASTER mgm where mgm.BRANCH_CODE\=mgmm.BRANCH_CODE and mgm.GROUP_ID\=mgmm.GROUP_ID) order by GROUP_ID 
GET_EDIT_GROUP_MASTER = SELECT GROUP_ID,GROUP_DESC_ENGLISH,DISPLAY_ORDER,TO_CHAR(EFFECTIVE_DATE, 'DD/MM/YYYY')EFFECTIVE_DATE,REMARKS,STATUS FROM   MOTOR_GROUP_MASTER MGM WHERE   GROUP_ID \= ? AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_GROUP_MASTER WHERE   GROUP_ID \= MGM.GROUP_ID) AND MGM.BRANCH_CODE \= ? 
GET_MAX_GROUP_ID = SELECT NVL(MAX(GROUP_ID),0)+1 FROM MOTOR_GROUP_MASTER
GET_EDIT_GROUP_AMEND_ID = SELECT AMEND_ID FROM MOTOR_GROUP_MASTER  MGMM WHERE GROUP_ID \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_GROUP_MASTER MGM WHERE  MGM.GROUP_ID\=MGMM.GROUP_ID)  AND EFFECTIVE_DATE > SYSDATE  
GET_GROUP_INSERT = INSERT INTO MOTOR_GROUP_MASTER(GROUP_ID, GROUP_DESC_ENGLISH,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE,DISPLAY_ORDER) VALUES (?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,(SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_GROUP_MASTER WHERE GROUP_ID\=?),?,?)
GET_GROUP_UPDATE = UPDATE MOTOR_GROUP_MASTER MGM SET GROUP_DESC_ENGLISH\=?,STATUS\=?,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'),REMARKS\=?,BRANCH_CODE\=?,DISPLAY_ORDER\=? WHERE MGM.GROUP_ID\= ? AND MGM.AMEND_ID \=?
CHECK_DISPLAY_ORDER = SELECT COUNT(*) FROM MOTOR_GROUP_MASTER WHERE DISPLAY_ORDER\=? AND BRANCH_CODE\=?

##BANK MASTER
GET_BANK_MASTER_LIST = SELECT BANK_ID, BANK_CODE, BANK_NAME_ENGLISH, BANK_NAME_ARABIC, DECODE (STATUS,'Y','Active','N','De Active') STATUS, TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE FROM MOTOR_BANK_MASTER MB WHERE   BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (MBM.AMEND_ID) FROM   MOTOR_BANK_MASTER MBM WHERE   MBM.BANK_ID = MB.BANK_ID) ORDER BY   BANK_ID
EDIT_BANK_MASTER_ADMIN = SELECT BANK_ID, BANK_CODE, BANK_NAME_ENGLISH, BANK_NAME_ARABIC, STATUS, TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, REMARKS FROM MOTOR_BANK_MASTER MB WHERE   BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (MBM.AMEND_ID) FROM   MOTOR_BANK_MASTER MBM WHERE   MBM.BANK_ID = MB.BANK_ID) AND BANK_ID= ? ORDER BY   BANK_ID DESC
GET_EDIT_BANK_AMEND_ID = SELECT AMEND_ID FROM MOTOR_BANK_MASTER MB WHERE   BANK_ID = ? AND AMEND_ID = (SELECT   MAX (MBM.AMEND_ID) FROM   MOTOR_BANK_MASTER MBM WHERE   MBM.BANK_ID = MB.BANK_ID)  AND EFFECTIVE_DATE > SYSDATE
GET_MAX_BANKID = SELECT NVL(MAX(BANK_ID),0)+1 FROM MOTOR_BANK_MASTER
INSERT_BANK_MASTER = Insert into MOTOR_BANK_MASTER(BANK_ID, AMEND_ID, BANK_CODE, BANK_NAME_ENGLISH, BANK_NAME_ARABIC, STATUS,EFFECTIVE_DATE, REMARKS, BRANCH_CODE) Values(?, (SELECT NVL(MAX(AMEND_ID)+1,0) FROM MOTOR_BANK_MASTER WHERE BANK_ID= ?), ?, ?, ?, ?, TO_DATE(?,'DD/MM/YYYY'),?, ?)
UPDATE_BANK_MASTER_ADMIN = UPDATE MOTOR_BANK_MASTER MB SET BANK_CODE=?, BANK_NAME_ENGLISH=?, BANK_NAME_ARABIC=?, STATUS=?,EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'), REMARKS=? WHERE BANK_ID = ? AND AMEND_ID = ?

##MFG COUNTRY MASTER
GET_MFGCOUNTRY_MASTER_LIST = SELECT COUNTRY_ID, COUNTRY_CODE, COUNTRY_NAME, DECODE (STATUS,'Y','Active','N','De Active') STATUS, TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, COREAPPCODE, NATIONALITY_NAME FROM motor_mfg_country_master MB WHERE   BRANCH_CODE = ?  ORDER BY   COUNTRY_ID
EDIT_MFGCOUNTRY_MASTER = SELECT COUNTRY_ID, COUNTRY_CODE, COUNTRY_NAME, STATUS, TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, COREAPPCODE, NATIONALITY_NAME, REMARKS FROM motor_mfg_country_master MB WHERE   BRANCH_CODE = ? AND COUNTRY_ID = ? ORDER BY   COUNTRY_ID
INSERT_MFGCOUNTRY_MASTER = Insert into MOTOR_MFG_COUNTRY_MASTER(COUNTRY_ID, COUNTRY_CODE, COUNTRY_NAME, STATUS, ENTRY_DATE, COREAPPCODE, REMARKS, BRANCH_CODE, NATIONALITY_NAME, EFFECTIVE_DATE) Values(?, ?, ?, ?, SYSDATE, ?, ?, ?, ?, TO_DATE(?, 'DD/MM/YYYY'))
UPDATE_MFGCOUNTRY_MASTER = UPDATE MOTOR_MFG_COUNTRY_MASTER SET COUNTRY_CODE = ?, COUNTRY_NAME = ?, STATUS =?, COREAPPCODE =?, REMARKS =?, NATIONALITY_NAME =?, EFFECTIVE_DATE =TO_DATE(?,'DD/MM/YYYY') WHERE COUNTRY_ID= ?
GET_MAX_MFGCOUNTRYID = SELECT NVL(MAX(COUNTRY_ID),0)+1 FROM MOTOR_MFG_COUNTRY_MASTER
CHECK_CORE_APP_CODE_COUNTRY = select COUNT(*) FROM MOTOR_MFG_COUNTRY_MASTER WHERE COREAPPCODE\=? and BRANCH_CODE\=?

##Motor Report
GET_MOTOR_REPORT = SELECT POLICYTYPE,(Select POLICYTYPE_DESC_ENGLISH FROM MOTOR_POLICYTYPE_MASTER MPM WHERE MPM.POLICY_SUBTYPE_ID=A.POLICYTYPE) POLICY_NAME,NO_OF_POLICY,Premium From (Select Policytype,Count(*) NO_OF_POLICY,TRIM(TO_CHAR(Sum(Premium),'999G999G999G999G999G999G999G999')) Premium from  Motor_data_detail Where trunc(INCEPTION_DATE) Between to_date(?,'DD/MM/YYYY') and  to_date(?,'DD/MM/YYYY')  and quote_no in (Select quote_no from home_position_master Where status='P')group by Policytype) A order by Policytype ASC
GET_MOTOR_REPORT_DETAIL = Select POLICYTYPENAME,MAKE_NAME,MODEL_NAME,TYPE_OF_BODY_NAME,VEHICLETYPE_DESC,MANUFACTURE_YEAR,SEATING_CAPACITY,CUBIC_CAPACITY,AREA_COVERAGE,SUMINSURED_VALUE_LOCAL,BASE_RATE VEHICLERATE,PREMIUM,OPTIONAL_COVER,NO_CLAIM_BONUS,CLAIMYN,CLAIM_AMOUNT,DRIVER_ID,DRIVER_DOB,VEHICLE_COLOR,POLICY_NO from table(Motor_Policy_Reports(?,?,?,'',?))

## Travel Report
GET_TRAVEL_REPORT =  select * from table(Travel_report(?,?,?,?))

GET_COUNTRY_DROP_DOWN_LIST = SELECT COUNTRY_ID CODE,COUNTRY_NAME CODEDESC FROM MOTOR_MFG_COUNTRY_MASTER WHERE BRANCH_CODE = ?
GET_VEHICLE_TYPE_DROP_DOWN = SELECT VTYPE_ID CODE,UPPER(VEHICLETYPE_DESC) CODEDESC FROM MOTOR_VEHICLETYPE_MASTER MVM  WHERE STATUS='Y' and BRANCH_CODE= ?  AND AMEND_ID  = (SELECT MAX(AMEND_ID) FROM MOTOR_VEHICLETYPE_MASTER MV WHERE  MVM.VTYPE_ID=MV.VTYPE_ID) ORDER BY VEHICLETYPE_DESC
GET_MAKE_DROP_DOWN = SELECT MAKE_ID CODE, MAKE_NAME CODEDESC  FROM  MOTOR_MAKE_MASTER MMM WHERE  BRANCH_CODE=?  AND AMEND_ID  = (SELECT MAX(AMEND_ID) FROM MOTOR_VEHICLETYPE_MASTER WHERE  MAKE_ID=MMM.MAKE_ID) ORDER BY MAKE_NAME

##OPCOVER DETAIL
EDIT_OPCOVER_DETAIL = SELECT STATUS, RATE, IS_SELECTED, IS_ADDON, COREAPP_CODE,DELETABLE,CALC_TYPE,DESCRIPTION  FROM motor_opcover_details MOD WHERE MOD.OPCOVER_ID =? AND POLICY_SUBTYPE_ID=? AND GROUP_ID='1' AND MOD.AMEND_ID = (SELECT   MAX (MO.AMEND_ID) FROM motor_opcover_details MO WHERE   MO.OPCOVER_ID = MOD.OPCOVER_ID and  MO.POLICY_SUBTYPE_ID=MOD.POLICY_SUBTYPE_ID)
UPDATE_OPCOVER_DETAIL_INSERT = Insert into MOTOR_OPCOVER_DETAILS(OPCOVER_ID, OPCOVERSUB_ID, AMEND_ID, STATUS, ENTRY_DATE, RATE, GROUP_ID, IS_SELECTED, IS_ADDON, DELETABLE, CALC_TYPE,DESCRIPTION,POLICY_SUBTYPE_ID, COREAPP_CODE) Values (?, ?, ?, ?, sysdate,  ?, 1, ?, ?, ?, ?,?, ?, ?)
INSERT_OPCOVER_DETAIL = Insert into MOTOR_OPCOVER_DETAILS(OPCOVER_ID, OPCOVERSUB_ID, AMEND_ID, STATUS, ENTRY_DATE, RATE, GROUP_ID, IS_SELECTED, IS_ADDON, DELETABLE, CALC_TYPE,DESCRIPTION,POLICY_SUBTYPE_ID, COREAPP_CODE) Values (?, ?, ?, ?, sysdate,  ?, 1, ?, ?, ?, ?, ?, ?, ?)
GET_MAX_OPCOVERSUBID = SELECT NVL(MAX(OPCOVERSUB_ID),0)+1 FROM motor_opcover_details
GET_DETAILS_OPCOVERSUBID = SELECT OPCOVERSUB_ID  ,AMEND_ID+1 AMEND_ID FROM MOTOR_OPCOVER_DETAILS MOD WHERE OPCOVER_ID= ? AND POLICY_SUBTYPE_ID=? AND GROUP_ID='1'  AND AMEND_ID = (SELECT   MAX (MO.AMEND_ID) FROM motor_opcover_details MO WHERE   MO.OPCOVER_ID = MOD.OPCOVER_ID and  MO.POLICY_SUBTYPE_ID=MOD.POLICY_SUBTYPE_ID )
##GET_OPCOVER_DETAIL_LIST = SELECT MOD.OPCOVER_ID, MOD.POLICY_SUBTYPE_ID, MOD.RATE, DECODE (MOD.STATUS,'Y','Active','N','De Active') STATUS, MPM.POLICYTYPE_DESC_ENGLISH FROM Motor_opcover_details MOD, MOTOR_POLICYTYPE_MASTER MPM WHERE MOD.GROUP_ID = 1 AND MOD.OPCOVER_ID=? AND MPM.POLICYTYPE_ID=MOD.POLICY_SUBTYPE_ID AND MOD.AMEND_ID = (SELECT   MAX (MOM.AMEND_ID) FROM Motor_opcover_details MOM WHERE   MOM.OPCOVER_ID = MOD.OPCOVER_ID) ORDER BY   MOD.POLICY_SUBTYPE_ID
GET_OPCOVER_DETAIL_LIST = SELECT MOD.OPCOVER_ID,OPM.OPCOVER_DESC, MOD.POLICY_SUBTYPE_ID, MOD.RATE, DECODE (MOD.STATUS,'Y','Active','N','De Active') STATUS, MPM.POLICYTYPE_DESC_ENGLISH FROM Motor_opcover_details MOD, MOTOR_POLICYTYPE_MASTER MPM, Motor_opcover_MASTER OPM WHERE MOD.GROUP_ID = 1 AND MOD.OPCOVER_ID=? AND MPM.POLICYTYPE_ID=MOD.POLICY_SUBTYPE_ID AND OPM.OPCOVER_ID = MOD.OPCOVER_ID AND MOD.AMEND_ID = (SELECT   MAX (MOM.AMEND_ID) FROM Motor_opcover_details MOM WHERE   MOM.OPCOVER_ID = MOD.OPCOVER_ID) ORDER BY   MOD.POLICY_SUBTYPE_ID
CHECK_CORE_APP_CODE_OPCOVER_DETAIL = select COUNT(*) FROM MOTOR_OPCOVER_DETAILS WHERE COREAPP_CODE\=? and GROUP_ID\=1
CHECK_OP_POLICY_EXISTS = select count(*) from motor_opcover_details where OPCOVER_ID=? and POLICY_SUBTYPE_ID=? and GROUP_ID=1


##Quarter Master
GET_QUARTER_FOR_EDIT=SELECT MP.POLICYTYPE_ID,MP.POLICYTYPE_DESC_ENGLISH POLICY_TYPE, M.QUATERID,M.STARTRANGE,M.ENDRANGE, M.DISCOUNT_PERC,M.STATUS,TO_CHAR(M.EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,M.REMARKS,m.amend_id,m.SNO FROM MOTOR_QUARTERPREM_DISCOUNTS M,MOTOR_POLICYTYPE_MASTER MP where M.POLICYTYPE_ID=MP.POLICYTYPE_ID and M.SNO=? and m.amend_id=(select max(amend_id) from MOTOR_QUARTERPREM_DISCOUNTS mqd where m.POLICYTYPE_ID=mqd.POLICYTYPE_ID)
GET_QUATER_MASTER=SELECT MP.POLICYTYPE_DESC_ENGLISH POLICY_TYPE, M.QUATERID,M.STARTRANGE,M.ENDRANGE, M.DISCOUNT_PERC, decode(M.STATUS,'Y','Activate','N','Deactivate') STATUS,TO_CHAR(M.EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,M.REMARKS,m.SNO FROM MOTOR_QUARTERPREM_DISCOUNTS M,MOTOR_POLICYTYPE_MASTER MP where MP.POLICYTYPE_ID=M.POLICYTYPE_ID
GET_EDIT_QUARTER_AMEND_ID=SELECT mqd.AMEND_ID FROM MOTOR_QUARTERPREM_DISCOUNTS mqd where mqd.sno=? and amend_id=(select max(amend_id) from MOTOR_QUARTERPREM_DISCOUNTS mqdi where mqd.POLICYTYPE_ID=mqdi.POLICYTYPE_ID and  mqdi.QUATERID=mqd.QUATERID)
GET_MAX_QUARTER_SERIAL_ID=SELECT NVL(MAX(sno),0)+1 FROM MOTOR_QUARTERPREM_DISCOUNTS  
GET_QUARTER_FOR_UPDATE=UPDATE MOTOR_QUARTERPREM_DISCOUNTS M SET POLICYTYPE_ID=?,QUATERID=?,STARTRANGE=?,ENDRANGE=?,DISCOUNT_PERC=?,STATUS=?,EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),REMARKS=? WHERE SNO= ? AND AMEND_ID= ?
GET_QUARTER_FOR_INSERT=Insert into MOTOR_QUARTERPREM_DISCOUNTS(POLICYTYPE_ID, QUATERID, STARTRANGE, ENDRANGE, DISCOUNT_PERC,STATUS,EFFECTIVE_DATE, REMARKS, AMEND_ID, SNO) VALUES(?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?)
GET_QUARTER_EXIST=select count(*) from  MOTOR_QUARTERPREM_DISCOUNTS where POLICYTYPE_ID=? and QUATERID=? and STATUS='Y'

### Quotation Status
GET_MOTOR_PAYMENT_DETAIL = select QUOTE_NO,(select policy_no from home_position_master hpm  where hpm.quote_no=mpd.quote_no) policy_no,CUSTOMER_NAME,payment_type,MERCHANT_REFERENCE from PAYMENT_DETAIL mpd where trunc(REQUEST_TIME) BETWEEN TO_DATE(?,'dd/mm/yyyy') AND TO_DATE(?,'dd/mm/yyyy')  and product_id = ?
GET_PAYMENT_TYPE = select DETAIL_NAME,REMARKS,CATEGORY_DETAIL_ID from CONSTANT_DETAIL where CATEGORY_ID='197'
GET_PAYMENT_VIEW = select pi.FIRST_NAME,pi.LAST_NAME,pi.ADDRESS1,pi.ADDRESS2,pi.POBOX,pi.MOBILE,pi.EMAIL,hpm.QUOTE_NO,hpm.CUSTOMER_ID,hpm.POLICY_NO,hpm.PREMIUM,hpm.POLICY_FEE,hpm.OVERALL_PREMIUM,hpm.INCEPTION_DATE,hpm.EXPIRY_DATE,mpm.QUOTE_NO,mpm.CHEQUE_NO,mpm.BANK_NAME,mpm.MICR_CODE,mpm.CHEQUE_AMOUNT,mpm.CHEQUE_DATE,mpm.REQUEST_TIME,mpm.RESPONSE_TIME,mpm.RESPONSE_TRAN_NO,mpm.RESPONSE_STATUS,mpm.RESPONSE_MESSAGE,mpm.CARD_NUMBER_MASKED,mpm.RESPONSE_CODE,mpm.PAYMENT_TYPE,mpm.MERCHANT_REFERENCE from PAYMENT_DETAIL mpm,home_position_master hpm,personal_info pi where pi.customer_id = hpm.customer_id and hpm.QUOTE_NO=mpm.QUOTE_NO and mpm.quote_no = ? and mpm.MERCHANT_REFERENCE = ? and hpm.branch_code = ?

### CONSTANT MASTER
INSERT_ITEM_VALUE = insert into list_item_value (ITEM_ID,ITEM_TYPE,ITEM_CODE,ITEM_VALUE,ITEM_DESC,PARAM1,PARAM2,STATUS) values ((select nvl(max(item_id+1),1)item_id from list_item_value),?,(select nvl(max(item_code+1),1)item_code from list_item_value where item_type = ?),?,?,?,?,?)
UPDATE_ITEM_VALUE = update list_item_value set ITEM_TYPE=?,ITEM_CODE=?,ITEM_VALUE=?,ITEM_DESC=?,PARAM1=?,PARAM2=?,STATUS=? where item_id = ?
GET_ITEM_LIST = select ITEM_ID,ITEM_TYPE,ITEM_CODE,ITEM_VALUE,ITEM_DESC,PARAM1,PARAM2,Decode(STATUS,'Y','Active','N','De-Active')STATUS from list_item_value  where item_id != 0 order by item_type
GET_ITEM_TYPE = select distinct(ITEM_TYPE) from list_item_value order by item_type
GET_ITEM_FOR_EDIT = select ITEM_ID,ITEM_TYPE,ITEM_CODE,ITEM_VALUE,ITEM_DESC,PARAM1,PARAM2,STATUS from list_item_value where item_id = ?

############################################################## Motor Admin Part End ###############################################################

##--- Travel Admin----- 
#GET_SCHEME_VALUE=SELECT SCHEME_ID,SCHEME_NAME FROM TRAVEL_SCHEME_COVERS WHERE STATUS='Y' AND BRANCH_CODE=?
GET_SCHEME_VALUE=SELECT SCHEME_ID,SCHEME_NAME FROM TRAVEL_SCHEME_COVERS WHERE STATUS='Y' AND SCHEME_ID IN ( SELECT SCHEME_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE PRODUCT_CODE=?  AND STATUS='Y') ORDER BY SCHEME_NAME
#GET_OPTION_VALUE=SELECT TRIM(OPTION_ID) OPTION_ID,OPTION_NAME FROM TRAVEL_OPTION_COVERS WHERE STATUS='Y' AND BRANCH_CODE=?
GET_OPTION_VALUE=SELECT OPTION_ID,OPTION_NAME  FROM TRAVEL_OPTION_COVERS WHERE  STATUS='Y' AND OPTION_ID IN ( SELECT OPTION_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE  STATUS='Y' AND SCHEME_ID=? AND PRODUCT_CODE=?)
GET_COVER_VALUE=SELECT TRIM(OPTION_ID) COVER_ID,OPTION_NAME COVER_NAME FROM TRAVEL_OPTION_COVERS WHERE STATUS='Y' AND BRANCH_CODE=? AND OPTION_ID IN (SELECT OPTION_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_ID=? AND STATUS='Y' AND PRODUCT_CODE=? AND BRANCH_CODE=?)
GET_TYPE_VALUE=select RSACODE,DETAIL_NAME from constant_detail where BRANCH_CODE=? and CATEGORY_ID='53'
GET_RELATION_TYPE_VALUE=select RSACODE,DETAIL_NAME from constant_detail where BRANCH_CODE=? and CATEGORY_ID='198'



GET_SCHEME=SELECT SCHEME_ID,SCHEME_NAME,CASE WHEN(STATUS='Y') THEN 'Active' ELSE 'InActive' END STATUS ,COREAPP_CODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE FROM TRAVEL_SCHEME_COVERS TSC WHERE BRANCH_CODE=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_SCHEME_COVERS TC WHERE TC.BRANCH_CODE=TSC.BRANCH_CODE  AND TC.SCHEME_ID=TSC.SCHEME_ID)   ORDER BY SCHEME_ID ASC
GET_SCHEME_DATA=SELECT SCHEME_ID,SCHEME_NAME,STATUS,COREAPP_CODE,PRODUCT_CODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE FROM TRAVEL_SCHEME_COVERS TSC WHERE SCHEME_ID=? AND BRANCH_CODE=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_SCHEME_COVERS TC WHERE TC.BRANCH_CODE=TSC.BRANCH_CODE  AND TC.SCHEME_ID=TSC.SCHEME_ID)
GET_SCHEME_MAX_AMEND_ID=SELECT MAX(AMEND_ID)+1 FROM TRAVEL_SCHEME_COVERS WHERE SCHEME_ID=? AND BRANCH_CODE=?
GET_SCHEME_AMEND_ID=SELECT AMEND_ID FROM TRAVEL_SCHEME_COVERS MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_SCHEME_COVERS WHERE   SCHEME_ID = MSM.SCHEME_ID) AND SCHEME_ID = ? AND BRANCH_CODE=? AND EFFECTIVE_DATE > SYSDATE
#INS_SCHEME_DTLS=INSERT INTO TRAVEL_SCHEME_COVERS(SCHEME_ID,SCHEME_NAME,BRANCH_CODE,STATUS,COREAPP_CODE,PRODUCT_CODE,EFFECTIVE_DATE,AMEND_ID)VALUES(?,?,?,?,?,?,?,?)
INS_SCHEME_DTLS=INSERT INTO TRAVEL_SCHEME_COVERS (SCHEME_ID,SCHEME_NAME,BRANCH_CODE,STATUS,COREAPP_CODE,PRODUCT_CODE,EFFECTIVE_DATE,AMEND_ID)VALUES(?,?,?,?,?,?,to_date(?,'DD/MM/YYYY'),?)
GET_SCHEME_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_SCHEME_COVERS WHERE COREAPP_CODE=?
GET_SCHEME_HISTORY=SELECT SCHEME_ID,SCHEME_NAME,STATUS,COREAPP_CODE,PRODUCT_CODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE FROM TRAVEL_SCHEME_COVERS WHERE SCHEME_ID=? AND BRANCH_CODE=?
GET_SCHEME_ID=SELECT MAX(SCHEME_ID)+1 FROM TRAVEL_SCHEME_COVERS WHERE BRANCH_CODE=?
UPDATE_SCHEME_DATA=update TRAVEL_SCHEME_COVERS TSC set SCHEME_NAME=?,STATUS=?,COREAPP_CODE=?,PRODUCT_CODE=?,EFFECTIVE_DATE=to_date(?,'DD/MM/YYYY'),AMEND_ID=? where SCHEME_ID=? and BRANCH_CODE=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_SCHEME_COVERS TC WHERE TC.BRANCH_CODE=TSC.BRANCH_CODE  AND TC.SCHEME_ID=TSC.SCHEME_ID)
GET_SCHEME_CORE_CODE1=SELECT COUNT(*) FROM TRAVEL_SCHEME_COVERS WHERE COREAPP_CODE\=? and SCHEME_ID\!\=?

GET_OPTION=SELECT OPTION_ID,OPTION_NAME,CASE WHEN(STATUS='Y') THEN 'Active' ELSE 'InActive' END STATUS ,COREAPP_CODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE FROM TRAVEL_OPTION_COVERS TOC WHERE BRANCH_CODE=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_OPTION_COVERS TC WHERE TC.BRANCH_CODE=TOC.BRANCH_CODE  AND TC.OPTION_ID=TOC.OPTION_ID)   ORDER BY OPTION_ID ASC
GET_OPTION_DATA=SELECT OPTION_ID,OPTION_NAME,STATUS,COREAPP_CODE,PRODUCT_CODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE FROM TRAVEL_OPTION_COVERS TOC WHERE OPTION_ID=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_OPTION_COVERS TC WHERE TC.BRANCH_CODE=TOC.BRANCH_CODE AND TC.PRODUCT_CODE=TOC.PRODUCT_CODE AND TC.OPTION_ID=TOC.OPTION_ID)
GET_OPTION_AMEND_ID=SELECT MAX(AMEND_ID)+1 FROM TRAVEL_OPTION_COVERS WHERE OPTION_ID=? AND BRANCH_CODE=?
##INS_OPTION_DTLS=INSERT INTO TRAVEL_OPTION_COVERS(OPTION_ID,OPTION_NAME,BRANCH_CODE,STATUS,COREAPP_CODE,PRODUCT_CODE,EFFECTIVE_DATE)VALUES(?,?,?,?,?,?,to_date(?,'DD/MM/YYYY'))
INS_OPTION_DTLS=INSERT INTO TRAVEL_OPTION_COVERS(OPTION_ID,OPTION_NAME,BRANCH_CODE,STATUS,COREAPP_CODE,PRODUCT_CODE,EFFECTIVE_DATE,AMEND_ID)VALUES(?,?,?,?,?,?,to_date(?,'DD/MM/YYYY'),?)
GET_OPTION_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_OPTION_COVERS WHERE COREAPP_CODE=?
GET_OPTION_CORE_CODE1=SELECT COUNT(*) FROM TRAVEL_OPTION_COVERS WHERE COREAPP_CODE=? and OPTION_ID!=?
GET_OPTION_AMEND_ID1=SELECT AMEND_ID FROM TRAVEL_OPTION_COVERS MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_OPTION_COVERS WHERE   OPTION_ID = MSM.OPTION_ID) AND OPTION_ID = ? AND BRANCH_CODE=? AND EFFECTIVE_DATE > SYSDATE
GET_OPTION_HISTORY=SELECT OPTION_ID,OPTION_NAME,STATUS,COREAPP_CODE,PRODUCT_CODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE FROM TRAVEL_OPTION_COVERS WHERE OPTION_ID=? AND BRANCH_CODE=?
GET_OPTION_ID=SELECT MAX(OPTION_ID)+1 FROM TRAVEL_OPTION_COVERS WHERE BRANCH_CODE=?
UPDATE_OPTION_DTLS=update TRAVEL_OPTION_COVERS set OPTION_NAME=?,STATUS=?,COREAPP_CODE=?,PRODUCT_CODE=?,EFFECTIVE_DATE=to_date(?,'DD/MM/YYYY'),AMEND_ID=? where OPTION_ID=? and BRANCH_CODE=? and AMEND_ID=(select MAX(AMEND_ID) FROM TRAVEL_OPTION_COVERS TOC WHERE TOC.OPTION_ID=OPTION_ID)

GET_MASTER_COVERAGE=SELECT COVERAGES_ID,COVERAGES_NAME,COVERAGES_VALUE,CASE WHEN(STATUS='Y') THEN 'Active' ELSE 'InActive' END STATUS ,COREAPP_CODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE FROM TRAVEL_MAS_COVERAGES TMC WHERE BRANCH_CODE=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_MAS_COVERAGES TC WHERE TC.BRANCH_CODE=TMC.BRANCH_CODE  AND TC.COVERAGES_ID=TMC.COVERAGES_ID)   ORDER BY COVERAGES_ID ASC
GET_COVERAGE_DATA=SELECT COVERAGES_ID,COVERAGES_NAME,COVERAGES_VALUE,STATUS,COREAPP_CODE,PRODUCT_CODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE FROM TRAVEL_MAS_COVERAGES TMC WHERE COVERAGES_ID=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_MAS_COVERAGES TC WHERE TC.BRANCH_CODE=TMC.BRANCH_CODE AND TC.PRODUCT_CODE=TMC.PRODUCT_CODE AND TC.COVERAGES_ID=TMC.COVERAGES_ID)
GET_COVERAGE_AMEND_ID=SELECT MAX(AMEND_ID)+1 FROM TRAVEL_MAS_COVERAGES WHERE COVERAGES_ID=? AND BRANCH_CODE=?
GET_COVERAGE_AMEND_ID1=SELECT AMEND_ID FROM TRAVEL_MAS_COVERAGES MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_MAS_COVERAGES WHERE   COVERAGES_ID = MSM.COVERAGES_ID) AND COVERAGES_ID = ? AND BRANCH_CODE=? AND EFFECTIVE_DATE > SYSDATE
INS_COVERAGE_DTLS=INSERT INTO TRAVEL_MAS_COVERAGES(COVERAGES_ID,COVERAGES_NAME,COVERAGES_VALUE,BRANCH_CODE,STATUS,COREAPP_CODE,PRODUCT_CODE,EFFECTIVE_DATE,AMEND_ID)VALUES(?,?,?,?,?,?,?,to_date(?,'DD/MM/YYYY'),?)
GET_COVERAGE_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_MAS_COVERAGES WHERE COREAPP_CODE=?
GET_COVERAGE_CORE_CODE1=SELECT COUNT(*) FROM TRAVEL_MAS_COVERAGES WHERE COREAPP_CODE=? AND COVERAGES_ID!=?
GET_COVERAGE_HISTORY=SELECT COVERAGES_ID,COVERAGES_NAME,COVERAGES_VALUE,STATUS,COREAPP_CODE,PRODUCT_CODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE FROM TRAVEL_MAS_COVERAGES WHERE COVERAGES_ID=? AND BRANCH_CODE=?
GET_COVERAGE_ID=SELECT MAX(COVERAGES_ID)+1 FROM TRAVEL_MAS_COVERAGES WHERE BRANCH_CODE=?
UPDATE_COVERAGE_DTLS=UPDATE  TRAVEL_MAS_COVERAGES TMC SET COVERAGES_NAME\=?,COVERAGES_VALUE\=?,STATUS\=?,COREAPP_CODE\=?,PRODUCT_CODE\=?,EFFECTIVE_DATE\=to_date(?,'DD/MM/YYYY'),AMEND_ID\=? WHERE COVERAGES_ID\=? and BRANCH_CODE\=? and AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TRAVEL_MAS_COVERAGES TC WHERE TC.BRANCH_CODE\=TMC.BRANCH_CODE  AND TC.COVERAGES_ID\=TMC.COVERAGES_ID)  

##GET_DISCOUNT_RATE=SELECT RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,TO_CHAR(EFF_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_DISCOUNT_RATE TDR WHERE TDR.PRODUCT_CODE=? AND  TDR.BRANCH_CODE= ? AND (TDR.EFF_DATE>= SYSDATE OR (TDR.EFF_DATE< SYSDATE)) AND TDR.AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_DISCOUNT_RATE WHERE PRODUCT_CODE=? AND AGE_START=TDR.AGE_START AND AGE_END=TDR.AGE_END AND TYPE=TDR.TYPE AND BRANCH_CODE= ? AND EFF_DATE < SYSDATE) ORDER BY 3,4
GET_DISCOUNT_RATE=SELECT RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,TO_CHAR(EFF_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_DISCOUNT_RATE TDR WHERE TDR.PRODUCT_CODE=? AND  TDR.BRANCH_CODE= ?  AND TDR.AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_DISCOUNT_RATE WHERE PRODUCT_CODE=? AND AGE_START=TDR.AGE_START AND AGE_END=TDR.AGE_END AND TYPE=TDR.TYPE AND BRANCH_CODE= ? ) ORDER BY 3,4
GET_DISCOUNT_RATE_DATA=SELECT RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,TO_CHAR(EFF_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_DISCOUNT_RATE TDR WHERE PRODUCT_CODE=? AND RATE_ID=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_DISCOUNT_RATE TD WHERE TD.RATE_ID=TDR.RATE_ID AND TD.BRANCH_CODE=TDR.BRANCH_CODE AND TD.PRODUCT_CODE=TDR.PRODUCT_CODE)
GET_DISCOUNT_RATE_MAX_AMEND_ID=SELECT MAX(AMEND_ID)+1 FROM TRAVEL_DISCOUNT_RATE WHERE RATE_ID=? AND BRANCH_CODE=?
GET_DISCOUNT_RATE_AMEND_ID=SELECT AMEND_ID FROM TRAVEL_DISCOUNT_RATE MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_DISCOUNT_RATE WHERE   RATE_ID = MSM.RATE_ID) AND RATE_ID = ? AND BRANCH_CODE=? AND EFF_DATE > SYSDATE
INS_DISCOUNT_RATE_DTLS=INSERT INTO TRAVEL_DISCOUNT_RATE(RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,BRANCH_CODE,EFF_DATE,AMEND_ID,STATUS,COREAPP_CODE,PRODUCT_CODE)VALUES(?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?)
GET_DISCOUNT_RATE_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_DISCOUNT_RATE WHERE COREAPP_CODE=?
GET_DISCOUNT_RATE_CORE_CODE1=select count(*) from TRAVEL_DISCOUNT_RATE where COREAPP_CODE\=? and RATE_ID\!\=?  
GET_DISCOUNT_RATE_HISTORY=SELECT RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,TO_CHAR(EFF_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_DISCOUNT_RATE WHERE PRODUCT_CODE=? AND RATE_ID=? AND BRANCH_CODE=?
GET_DISCOUNT_RATE_ID=SELECT MAX(RATE_ID)+1 FROM TRAVEL_DISCOUNT_RATE WHERE BRANCH_CODE=?
UPDATE_NEW_DISCOUNT_RATE=UPDATE TRAVEL_DISCOUNT_RATE TDR SET TYPE=?,AGE_START=?,AGE_END=?,RATE_VALUE=?,EFF_DATE=to_date(?, 'DD/MM/YYYY'),AMEND_ID=?,STATUS=?,COREAPP_CODE=?,PRODUCT_CODE=? WHERE RATE_ID=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_DISCOUNT_RATE TD WHERE TD.RATE_ID=TDR.RATE_ID AND TD.BRANCH_CODE=TDR.BRANCH_CODE AND TD.PRODUCT_CODE=TDR.PRODUCT_CODE)

UPDATE_DISCOUNT_RATE=UPDATE  TRAVEL_PREMIUM_RATE TPR SET  NO_OF_DAYS\=?, SCHEME_ID\=?, OPTION_ID\=?, EFF_DATE\=TO_DATE(?,'DD/MM/YYYY'), PREMIUM\=?,PRODUCT_CODE\=?,COREAPPCODE\=?,STATUS\=? WHERE TRAVEL_PREMIUM_ID\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TRAVEL_PREMIUM_RATE TR WHERE TR.BRANCH_CODE \= TPR.BRANCH_CODE AND TR.TRAVEL_PREMIUM_ID\=TPR.TRAVEL_PREMIUM_ID)
##GET_RELATION_DISCOUNT=SELECT DISCOUNT_ID,DISCOUNT_START,DISCOUNT_END,RATE_VALUE,RELATION_TYPE, to_date(EFF_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,STATUS,COREAPP_CODE FROM TRAVEL_RELATION_DISCOUNT TRD WHERE TRD.PRODUCT_CODE=? AND TRD.BRANCH_CODE=? AND (TRD.EFF_DATE>= SYSDATE OR (TRD.EFF_DATE< SYSDATE)) AND TRD.AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_RELATION_DISCOUNT WHERE PRODUCT_CODE=? AND DISCOUNT_START=TRD.DISCOUNT_START AND DISCOUNT_END=TRD.DISCOUNT_END AND RELATION_TYPE=TRD.RELATION_TYPE AND BRANCH_CODE= ? AND EFF_DATE < SYSDATE) ORDER BY 2,3
##GET_RELATION_DISCOUNT=SELECT DISCOUNT_ID,DISCOUNT_START,DISCOUNT_END,RATE_VALUE,RELATION_TYPE, TO_CHAR(EFF_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,STATUS,COREAPP_CODE FROM TRAVEL_RELATION_DISCOUNT TRD WHERE TRD.PRODUCT_CODE=? AND TRD.BRANCH_CODE=?  AND TRD.AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_RELATION_DISCOUNT WHERE PRODUCT_CODE=? AND DISCOUNT_START=TRD.DISCOUNT_START AND DISCOUNT_END=TRD.DISCOUNT_END AND RELATION_TYPE=TRD.RELATION_TYPE AND BRANCH_CODE= ? ) ORDER BY 2,3
GET_RELATION_DISCOUNT=SELECT DISCOUNT_ID,DISCOUNT_START,DISCOUNT_END,RATE_VALUE,RELATION_TYPE, TO_CHAR(EFF_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,STATUS,COREAPP_CODE FROM TRAVEL_RELATION_DISCOUNT TRD WHERE TRD.PRODUCT_CODE=? AND TRD.BRANCH_CODE=?  AND TRD.AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_RELATION_DISCOUNT WHERE PRODUCT_CODE=?  AND DISCOUNT_ID=TRD.DISCOUNT_ID  AND BRANCH_CODE= ? ) ORDER BY 2,3
GET_RELATION_DISCOUNT_DATA=SELECT DISCOUNT_ID,DISCOUNT_START,DISCOUNT_END,RATE_VALUE,RELATION_TYPE, COREAPP_CODE, STATUS, TO_CHAR(EFF_DATE,'DD/MM/YYYY') EFFECTIVE_DATE FROM TRAVEL_RELATION_DISCOUNT TRD WHERE TRD.PRODUCT_CODE =? AND TRD.DISCOUNT_ID=? AND TRD.BRANCH_CODE =? AND TRD.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_RELATION_DISCOUNT TRRD WHERE TRD.DISCOUNT_ID=TRRD.DISCOUNT_ID AND TRD.BRANCH_CODE=TRRD.BRANCH_CODE AND  TRD.PRODUCT_CODE= TRRD.PRODUCT_CODE)
GET_RELATION_DISCOUNT_MAX_AMEND_ID=SELECT MAX(AMEND_ID)+1 FROM TRAVEL_RELATION_DISCOUNT WHERE DISCOUNT_ID=? AND BRANCH_CODE=?
GET_RELATION_DISCOUNT_AMEND_ID=SELECT AMEND_ID FROM TRAVEL_RELATION_DISCOUNT MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_RELATION_DISCOUNT WHERE   DISCOUNT_ID = MSM.DISCOUNT_ID) AND DISCOUNT_ID = ? AND BRANCH_CODE=? AND EFF_DATE > SYSDATE
#INS_RELATION_DISCOUNT_DTLS=INSERT INTO TRAVEL_RELATION_DISCOUNT(DISCOUNT_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,BRANCH_CODE,EFF_DATE EFFECTIVE_DATE,AMEND_ID,STATUS,COREAPP_CODE,PRODUCT_CODE)VALUES(?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?)
INS_RELATION_DISCOUNT_DTLS=INSERT INTO TRAVEL_RELATION_DISCOUNT(DISCOUNT_ID, DISCOUNT_START, DISCOUNT_END, RATE_VALUE, RELATION_TYPE,EFF_DATE, COREAPP_CODE, AMEND_ID, STATUS,BRANCH_CODE,PRODUCT_CODE,AGENCY_CODE)VALUES(?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?)
GET_RELATION_DISCOUNT_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_RELATION_DISCOUNT WHERE COREAPP_CODE=?
GET_RELATION_DISCOUNT_CORE_CODE1=SELECT COUNT(*) FROM TRAVEL_RELATION_DISCOUNT WHERE COREAPP_CODE=? and DISCOUNT_ID!=?
GET_RELATION_DISCOUNT_HISTORY=SELECT DISCOUNT_ID, DISCOUNT_START, DISCOUNT_END, RATE_VALUE, RELATION_TYPE,TO_CHAR(EFF_DATE,'DD/MM/YYYY') EFFECTIVE_DATE, COREAPP_CODE, AMEND_ID, STATUS,BRANCH_CODE,PRODUCT_CODE  FROM TRAVEL_RELATION_DISCOUNT WHERE PRODUCT_CODE=? AND DISCOUNT_ID=? AND BRANCH_CODE=?
GET_RELATION_DISCOUNT_ID=SELECT MAX(DISCOUNT_ID)+1 FROM TRAVEL_RELATION_DISCOUNT WHERE BRANCH_CODE=?
UPDATE_DISCOUNT_RELATION=UPDATE TRAVEL_RELATION_DISCOUNT trd SET  DISCOUNT_START=?, DISCOUNT_END=?, RATE_VALUE=?, RELATION_TYPE=?,EFF_DATE=to_date(?,'DD/MM/YYYY'), COREAPP_CODE=?, AMEND_ID=?, STATUS=?,PRODUCT_CODE=? WHERE DISCOUNT_ID=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_RELATION_DISCOUNT TR WHERE TR.DISCOUNT_ID=trd.DISCOUNT_ID AND TR.BRANCH_CODE=BRANCH_CODE)

##GET_PREMIUM_RATE=SELECT TPR.TRAVEL_PREMIUM_ID, TPR.NO_OF_DAYS, TSC.SCHEME_NAME, TOC.OPTION_NAME, TPR.PREMIUM, to_date(TPR.EFF_DATE, 'dd/mm/yyyy')  FROM TRAVEL_PREMIUM_RATE TPR, TRAVEL_OPTION_COVERS TOC, TRAVEL_SCHEME_COVERS TSC WHERE TPR.OPTION_ID = TOC.OPTION_ID AND TPR.SCHEME_ID = TSC.SCHEME_ID AND TSC.STATUS = 'Y'  AND TOC.STATUS = 'Y'  AND TPR.PRODUCT_CODE =? AND TPR.BRANCH_CODE =? AND TSC.BRANCH_CODE = TPR.BRANCH_CODE AND TOC.BRANCH_CODE = TPR.BRANCH_CODE AND (TPR.EFF_DATE >= SYSDATE OR (TPR.EFF_DATE <= SYSDATE)) ORDER BY TPR.TRAVEL_PREMIUM_ID
##GET_PREMIUM_RATE=SELECT TPR.TRAVEL_PREMIUM_ID, TPR.NO_OF_DAYS, TSC.SCHEME_NAME, TOC.OPTION_NAME, TPR.PREMIUM, TO_CHAR(EFF_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE,TPR.COREAPPCODE,TPR.STATUS FROM TRAVEL_PREMIUM_RATE TPR, TRAVEL_OPTION_COVERS TOC, TRAVEL_SCHEME_COVERS TSC WHERE TPR.OPTION_ID = TOC.OPTION_ID AND TPR.SCHEME_ID = TSC.SCHEME_ID AND TSC.STATUS = 'Y'  AND TOC.STATUS = 'Y'  AND TPR.PRODUCT_CODE =? AND TPR.BRANCH_CODE =? AND TSC.BRANCH_CODE = TPR.BRANCH_CODE AND TOC.BRANCH_CODE = TPR.BRANCH_CODE ORDER BY TPR.TRAVEL_PREMIUM_ID
GET_PREMIUM_RATE=SELECT  distinct TPR.TRAVEL_PREMIUM_ID, TPR.NO_OF_DAYS, TSC.SCHEME_NAME, TOC.OPTION_NAME, TPR.PREMIUM, TO_CHAR(TPR.EFF_DATE, 'dd/mm/yyyy') EFFECTIVE_DATE,TPR.COREAPPCODE,TPR.STATUS FROM TRAVEL_PREMIUM_RATE TPR, TRAVEL_OPTION_COVERS TOC, TRAVEL_SCHEME_COVERS TSC WHERE TPR.OPTION_ID = TOC.OPTION_ID AND TPR.SCHEME_ID = TSC.SCHEME_ID AND TSC.STATUS = 'Y'  AND TOC.STATUS = 'Y'  AND TPR.PRODUCT_CODE =? AND TPR.BRANCH_CODE =? AND TSC.BRANCH_CODE = TPR.BRANCH_CODE AND TOC.BRANCH_CODE = TPR.BRANCH_CODE AND TPR.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_PREMIUM_RATE TR WHERE TR.TRAVEL_PREMIUM_ID= TPR.TRAVEL_PREMIUM_ID ) ORDER BY TPR.TRAVEL_PREMIUM_ID
##GET_PREMIUM_RATE=SELECT TPR.TRAVEL_PREMIUM_ID,TPR.NO_OF_DAYS,TSC.SCHEME_NAME,TOC.OPTION_NAME,TPR.PREMIUM,convert(varchar,TPR.EFF_DATE,103)  FROM TRAVEL_PREMIUM_RATE TPR,TRAVEL_OPTION_COVERS TOC,TRAVEL_SCHEME_COVERS TSC WHERE TPR.OPTION_ID=TOC.OPTION_ID AND TPR.SCHEME_ID = TSC.SCHEME_ID AND TSC.STATUS = 'Y' AND TOC.STATUS = 'Y' AND TPR.PRODUCT_CODE = ? AND TPR.BRANCH_CODE = ? AND TSC.BRANCH_CODE =TPR.BRANCH_CODE and TOC.BRANCH_CODE=TPR.BRANCH_CODE AND (TPR.EFF_DATE >= SYSDATE OR (TPR.EFF_DATE <= SYSDATE AND TPR.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM TRAVEL_PREMIUM_RATE WHERE PRODUCT_CODE=TPR.PRODUCT_CODE  AND SCHEME_ID=TPR.SCHEME_ID AND OPTION_ID=TPR.OPTION_ID AND NO_OF_DAYS=TPR.NO_OF_DAYS AND BRANCH_CODE= ?  AND EFF_DATE <= SYSDATE))) ORDER BY 3,4,2
##GET_PREMIUM_RATE_DATA=SELECT TRAVEL_PREMIUM_ID, NO_OF_DAYS, SCHEME_ID, OPTION_ID, EFF_DATE,PREMIUM, BRANCH_CODE, PRODUCT_CODE FROM TRAVEL_PREMIUM_RATE WHERE PRODUCT_CODE=? AND RATE_ID=? AND BRANCH_CODE=?
GET_PREMIUM_RATE_DATA=SELECT TRAVEL_PREMIUM_ID, NO_OF_DAYS, SCHEME_ID, OPTION_ID, TO_CHAR(EFF_DATE, 'dd/mm/yyyy') EFFECTIVE_DATE,PREMIUM, BRANCH_CODE, PRODUCT_CODE,COREAPPCODE,STATUS FROM TRAVEL_PREMIUM_RATE TP WHERE PRODUCT_CODE=? AND TRAVEL_PREMIUM_ID=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_PREMIUM_RATE TPR WHERE TPR.TRAVEL_PREMIUM_ID=TP.TRAVEL_PREMIUM_ID)
##GET_PREMIUM_RATE_DATA=SELECT TPR.TRAVEL_PREMIUM_ID, TPR.NO_OF_DAYS, TSC.SCHEME_NAME, TOC.OPTION_NAME, TPR.PREMIUM, to_date(TPR.EFF_DATE, 'dd/mm/yyyy') EFFECTIVE_DATE,TPR.COREAPPCODE,TPR.STATUS  FROM TRAVEL_PREMIUM_RATE TPR, TRAVEL_OPTION_COVERS TOC, TRAVEL_SCHEME_COVERS TSC WHERE TPR.OPTION_ID = TOC.OPTION_ID AND TPR.SCHEME_ID = TSC.SCHEME_ID AND TSC.STATUS = 'Y'  AND TOC.STATUS = 'Y'  AND TPR.PRODUCT_CODE =? AND TPR.BRANCH_CODE =? AND TSC.BRANCH_CODE = TPR.BRANCH_CODE AND TOC.BRANCH_CODE = TPR.BRANCH_CODE ORDER BY TPR.TRAVEL_PREMIUM_ID
GET_PREMIUM_RATE_AMEND_ID=SELECT MAX(AMEND_ID)+1 FROM TRAVEL_PREMIUM_RATE WHERE TRAVEL_PREMIUM_ID=? AND BRANCH_CODE=?
#INS_PREMIUM_RATE_DTLS=INSERT INTO TRAVEL_PREMIUM_RATE(RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,BRANCH_CODE,EFFECTIVE_DATE,AMEND_ID,STATUS,COREAPP_CODE,PRODUCT_CODE)VALUES(?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?)
INS_PREMIUM_RATE_DTLS=INSERT INTO TRAVEL_PREMIUM_RATE( TRAVEL_PREMIUM_ID, NO_OF_DAYS, SCHEME_ID, OPTION_ID, EFF_DATE, PREMIUM, BRANCH_CODE, PRODUCT_CODE,AMEND_ID,STATUS,COREAPPCODE)VALUES(?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?)
GET_PREMIUM_RATE_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_PREMIUM_RATE WHERE COREAPPCODE=?
GET_PREMIUM_RATE_CORE_CODE1=SELECT COUNT(*) FROM TRAVEL_PREMIUM_RATE WHERE COREAPPCODE=? AND TRAVEL_PREMIUM_ID!=?
GET_PREMIUM_RATE_AMEND_ID1=SELECT AMEND_ID FROM TRAVEL_PREMIUM_RATE MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_PREMIUM_RATE WHERE   TRAVEL_PREMIUM_ID = MSM.TRAVEL_PREMIUM_ID) AND TRAVEL_PREMIUM_ID = ? AND BRANCH_CODE=? AND EFF_DATE > SYSDATE
#GET_PREMIUM_RATE_HISTORY=SELECT TRAVEL_PREMIUM_ID, NO_OF_DAYS, SCHEME_ID, OPTION_ID, EFF_DATE, PREMIUM, BRANCH_CODE, PRODUCT_CODE,AMEND_ID,STATUS,COREAPPCODE FROM TRAVEL_PREMIUM_RATE WHERE PRODUCT_CODE=? AND TRAVEL_PREMIUM_ID=? AND BRANCH_CODE=?
GET_PREMIUM_RATE_HISTORY=SELECT TPR.TRAVEL_PREMIUM_ID, TPR.NO_OF_DAYS, TSC.SCHEME_NAME, TOC.OPTION_NAME, TPR.PREMIUM, TO_CHAR(TPR.EFF_DATE, 'dd/mm/yyyy') EFFECTIVE_DATE,TPR.COREAPPCODE,TPR.STATUS FROM TRAVEL_PREMIUM_RATE TPR, TRAVEL_OPTION_COVERS TOC, TRAVEL_SCHEME_COVERS TSC WHERE TPR.OPTION_ID = TOC.OPTION_ID AND TPR.SCHEME_ID = TSC.SCHEME_ID AND TSC.STATUS = 'Y'  AND TOC.STATUS = 'Y'  AND TPR.PRODUCT_CODE =? AND TPR.TRAVEL_PREMIUM_ID=? AND TPR.BRANCH_CODE =?  AND TSC.BRANCH_CODE = TPR.BRANCH_CODE AND TOC.BRANCH_CODE = TPR.BRANCH_CODE  ORDER BY TPR.TRAVEL_PREMIUM_ID
GET_PREMIUM_RATE_ID=SELECT MAX(TRAVEL_PREMIUM_ID)+1 FROM TRAVEL_PREMIUM_RATE WHERE BRANCH_CODE=?


GET_LINK_OPTION=SELECT OPTION_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE STATUS='Y' AND PRODUCT_CODE=? AND BRANCH_CODE=?
GET_LINK_OPTION_DATA=SELECT SCHEME_ID,OPTION_ID,BRANCH_CODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_iD=? AND PRODUCT_CODE=? AND BRANCH_CODE=?
GET_LINK_OPTION_AMEND_ID=SELECT MAX(AMEND_ID) FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_ID=? AND BRANCH_CODE=?
INS_LINK_OPTION_DTLS=INSERT INTO TRAVEL_SCHEME_OPTION_COVERS(COVER_ID,SCHEME_ID,OPTION_ID,STATUS,BRANCH_CODE,COREAPP_CODE,PRODUCT_CODE,EFFECTIVE_DATE,AMEND_ID)VALUES((SELECT NVL(MAX(COVER_ID)+1,0) FROM TRAVEL_SCHEME_OPTION_COVERS),?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?)
GET_LINK_OPTION_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_SCHEME_OPTION_COVERS WHERE COREAPP_CODE=?
GET_LINK_OPTION_HISTORY=SELECT SCHEME_ID,OPTION_ID,BRANCH_CODE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_iD=? AND PRODUCT_CODE=? AND BRANCH_CODE=?
GET_LINK_OPTION_ID=SELECT MAX(RATE_ID)+1 FROM TRAVEL_SCHEME_OPTION_COVERS WHERE BRANCH_CODE=?

GET_LINK_COVERAGE=SELECT OPTION_ID,OPTION_NAME FROM TRAVEL_OPTION_COVERS WHERE STATUS\='Y' AND BRANCH_CODE\=? AND OPTION_ID IN (SELECT OPTION_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE STATUS\='Y' AND PRODUCT_CODE\=? AND BRANCH_CODE\=?) 
GET_LINK_COVERAGE_DATA=SELECT TMC.COVERAGES_ID,TLC.RATE,TO_CHAR(TLC.EFF_DATE,'DD/MM/YYYY'),TLC.CORE_APP_CODE,TLC.STATUS FROM TRAVEL_OPTION_COVERS TMC ,TRAVEL_LINK_COVERAGES TLC ,TRAVEL_SCHEME_OPTION_COVERS TSOC WHERE  TLC.COVER_ID = TSOC.COVER_ID AND TSOC.SCHEME_ID=?  AND TSOC.OPTION_ID=?  AND TSOC.PRODUCT_CODE=? AND TSOC.BRANCH_CODE=?  AND TSOC.STATUS='Y' AND TSOC.COVER_ID = TLC.COVER_ID  AND TMC.COVERAGES_ID = TLC.COVERAGES_ID AND TMC.STATUS = 'Y' AND TLC.STATUS = 'Y' AND TLC.BRANCH_CODE = ? AND TLC.PRODUCT_CODE = ? AND TLC.EFF_DATE < SYSDATE AND TLC.AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_LINK_COVERAGES WHERE PRODUCT_CODE=TLC.PRODUCT_CODE AND COVER_ID = TLC.COVER_ID AND BRANCH_CODE = TLC.BRANCH_CODE AND EFF_DATE <= SYSDATE)
GET_LINK_COVERAGE_AMEND_ID=SELECT MAX(AMEND_ID) FROM TRAVEL_OPTION_COVERS WHERE RATE_ID=? AND BRANCH_CODE=?
INS_LINK_COVERAGE_DTLS=INSERT INTO TRAVEL_LINK_COVERAGES (SNO,COVERAGES_ID,COVER_ID,RATE,STATUS,PRODUCT_CODE,BRANCH_CODE,eff_date,amend_id) VALUES ((SELECT NVL(MAX(SNO)+1,0) FROM TRAVEL_LINK_COVERAGES),?,(SELECT COVER_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_ID=? AND OPTION_ID=? AND PRODUCT_CODE=? and BRANCH_CODE=?),?,'Y',?,?,TO_DATE(?,'DD/MM/YYYY'),(select NVL(MAX(amend_id),'-1')+1 from TRAVEL_LINK_COVERAGES where COVERAGES_ID=? and COVER_ID=((SELECT COVER_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_ID=? AND OPTION_ID=? AND PRODUCT_CODE=? and BRANCH_CODE=?)) and PRODUCT_CODE=? and BRANCH_CODE=?))
GET_LINK_COVERAGE_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_OPTION_COVERS WHERE COREAPP_CODE=?
GET_LINK_COVERAGE_HISTORY=SELECT RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,TO_CHAR(EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_OPTION_COVERS WHERE PRODUCT_CODE=? AND RATE_ID=? AND BRANCH_CODE=?
GET_LINK_COVERAGE_ID=SELECT MAX(RATE_ID)+1 FROM TRAVEL_OPTION_COVERS WHERE BRANCH_CODE=?

##- Travel Admin End Here




###############################################################################################
###############################################################################################
############Common Home Query - Start #########################################################
travel.quotation.option=SELECT CODE, CODEDESC, CODEVALUE FROM TABLE(SELECT QUOTATIONDATA(?,?,?,?,?,?,?,?,?,?,?,?,?) FROM DUAL)
GET_BROKER_BRANCH_CODE=SELECT NVL(BRANCH_CODE,'01') FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE = (SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID IN (''{0}''))
GET_AGE_CALC=SELECT TRUNC(MONTHS_BETWEEN(SYSDATE,TO_DATE(?,'DD/MM/YYYY'))/12 ) YEARS ,MOD( TRUNC( MONTHS_BETWEEN(SYSDATE, TO_DATE(?,'DD/MM/YYYY')) ), 12 ) MONTHS ,TO_DATE(TO_CHAR(SYSDATE,'DD/MM/YYYY'),'DD/MM/YYYY')  - ADD_MONTHS(TO_DATE(?,'DD/MM/YYYY'),TRUNC( MONTHS_BETWEEN(SYSDATE,TO_DATE(?,'DD/MM/YYYY')))) DAYS FROM DUAL
GET_CONSTRANCT_DTLS=SELECT CATEGORY_DETAIL_ID FROM CONSTANT_DETAIL WHERE CATEGORY_ID=? AND BRANCH_CODE=? AND STATUS='Y'
GET_BACK_DATE_ALLOWED=SELECT distinct(BACK_DATE_ALLOWED) FROM LOGIN_USER_DETAILS LUD WHERE AGENCY_CODE IN(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \=?) AND PRODUCT_ID \=? AND LUD.AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID\=LUD.LOGIN_ID AND PRODUCT_ID\=LUD.PRODUCT_ID)
UPD_HPMDATE_QUOTENO=UPDATE HOME_POSITION_MASTER SET DEBIT_NOTE_DATE=TO_TIMESTAMP(?,'DD/MM/YYYY HH:MI:SS'),EFFECTIVE_DATE=TO_TIMESTAMP(?,'DD/MM/YYYY HH:MI:SS')  WHERE  QUOTE_NO=?
UPD_HPMDATE_POLICYNO=UPDATE HOME_POSITION_MASTER SET DEBIT_NOTE_DATE=TO_TIMESTAMP(?,'DD/MM/YYYY HH:MI:SS'),EFFECTIVE_DATE=TO_TIMESTAMP(?,'DD/MM/YYYY HH:MI:SS')  WHERE  POLICY_NO=?
GET_RSACODE=SELECT NVL(PM.RSACODE,0) FROM PRODUCT_MASTER PM,HOME_POSITION_MASTER HPM WHERE HPM.QUOTE_NO=? AND PM.STATUS='Y' AND PM.BRANCH_CODE=? AND PM.PRODUCT_ID=NVL(HPM.PROPOSAL_NO,HPM.PRODUCT_ID) AND PM.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PRODUCT_MASTER where PRODUCT_ID=pm.PRODUCT_ID AND BRANCH_CODE = PM.BRANCH_CODE )
GET_CLOSE_TRNRSACODE=SELECT EXTRACT(YEAR FROM TRN.CLO_DATE_CLOSED) AS CLOSE_YEARS,EXTRACT(MONTH FROM TRN.CLO_DATE_CLOSED) AS CLOSE_MONTHS,EXTRACT(DAY FROM TRN.CLO_DATE_CLOSED) AS CLOSE_DAYS,EXTRACT(YEAR FROM TRN.CLO_DATE_OPENED) AS OPEN_YEARS,EXTRACT(MONTH FROM TRN.CLO_DATE_OPENED) AS OPEN_MONTHS,EXTRACT(DAY FROM TRN.CLO_DATE_OPENED) AS OPEN_DAYS FROM T_TRN_CLOSING TRN,PRODUCT_MASTER PM,HOME_POSITION_MASTER HPM WHERE PM.BRANCH_CODE=TRN.BRANCH_CODE AND TRN.BRANCH_CODE=? AND PM.PRODUCT_ID=NVL(HPM.PROPOSAL_NO,HPM.PRODUCT_ID) AND  PM.RSACODE=TRN.PRODUCT_CORE_CODE AND PM.RSACODE=? AND HPM.QUOTE_NO=? AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PRODUCT_MASTER WHERE PRODUCT_ID=PM.PRODUCT_ID AND BRANCH_CODE = PM.BRANCH_CODE )
GET_CLOSE_TRN=SELECT EXTRACT(YEAR AS TRN.CLO_DATE_CLOSED) AS CLOSE_YEARS,EXTRACT(MONTH AS TRN.CLO_DATE_CLOSED) AS CLOSE_MONTHS,EXTRACT(DAY AS TRN.CLO_DATE_CLOSED) AS CLOSE_DAYS,EXTRACT(YEAR AS TRN.CLO_DATE_OPENED) AS OPEN_YEARS,EXTRACT(MONTH AS TRN.CLO_DATE_OPENED) AS OPEN_MONTHS,EXTRACT(DAY ASTRN.CLO_DATE_OPENED) AS OPEN_DAYS FROM T_TRN_CLOSING TRN, PRODUCT_MASTER PM, HOME_POSITION_MASTER HPM WHERE PM.BRANCH_CODE = TRN.BRANCH_CODE AND TRN.BRANCH_CODE = ? AND PM.PRODUCT_ID = NVL (HPM.PROPOSAL_NO, HPM.PRODUCT_ID) AND PM.RSACODE = TRN.PRODUCT_CORE_CODE AND HPM.QUOTE_NO IN (?) AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PRODUCT_MASTER WHERE PRODUCT_ID = PM.PRODUCT_ID AND EFFECTIVE_DATE = PM.EFFECTIVE_DATE ) AND (PM.EFFECTIVE_DATE) <= (SYSDATE) AND PM.STATUS='Y'
GET_POLICYFEE_PERCENT = SELECT PERCENT FROM CONSTANT_DETAIL WHERE CATEGORY_ID='191' AND CATEGORY_DETAIL_ID='1' AND BRANCH_CODE=?
GET_DEBITNO_SEQ = Select policy_generate(''{1}'',''{0}'',''Debit'') from dual
GET_CERDITNO_SEQ = Select policy_generate(''{1}'',''{0}'',''Credit'') from dual
GET_SEQUENCE = Select policy_generate(?,?,?,?) from dual
GET_B2C_LOGINID = SELECT REMARKS FROM CONSTANT_DETAIL WHERE CATEGORY_ID='154' AND CATEGORY_DETAIL_ID='1' AND BRANCH_CODE=?
GET_AGENCYCODE = SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?
GET_REFERAL_YN=SELECT NVL(REFERAL,'N') REFERAL FROM LOGIN_MASTER WHERE AGENCY_CODE=(select OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GET_TODAY_DT=select EXTRACT(YEAR FROM SYSDATE) YEAR,EXTRACT(MONTH FROM SYSDATE) MONTH,EXTRACT(DAY FROM SYSDATE) DAY FROM dual
GET_MINIUM_PREMIUM=SELECT  NVL(MIN_PREMIUM_AMOUNT, '0.0') FROM LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM,HOME_POSITION_MASTER HPM WHERE   LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID=HPM.LOGIN_ID AND HPM.APPLICATION_NO =? AND LUD.PRODUCT_ID = HPM.PRODUCT_ID AND HPM.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?) AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE PRODUCT_ID=LUD.PRODUCT_ID AND LOGIN_ID=LUD.LOGIN_ID)
GET_LOGIN_PROD_ID=SELECT NVL(LOGIN_ID,'0') LOGIN_ID,NVL(PROPOSAL_NO,PRODUCT_ID) PROD_ID FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?
##GET_POLICYINFO=SELECT HPM.QUOTE_NO,CASE WHEN HPM.STATUS\='E' THEN NULL ELSE HPM.POLICY_NO END POLICY_NO,HPM.RECEIPT_NO,HPM.DEBIT_NOTE_NO,TO_CHAR(HPM.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTE_DATE,TO_CHAR(HPM.EFFECTIVE_DATE,'DD/MM/YYYY') POL_DATE,PI.FIRST_NAME ||' '||NVL(PI.LAST_NAME,'') PROPOSER_NAME,TO_CHAR(HPM.INCEPTION_DATE,'DD/MM/YYYY') COVER_START_DATE,(CASE WHEN (HPM.STATUS IN ('Y','E') AND ((HPM.REMARKS IN ('Referal') AND HPM.ADMIN_REFERRAL_STATUS \= 'N') OR (HPM.REMARKS IN ('Admin','Normal', 'Referal') AND HPM.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN 'Y' ELSE 'N' END) STATUS,CASE WHEN HPM.AMEND_ID\=0 THEN HPM.OVERALL_PREMIUM ELSE HPM.ENDT_PREMIUM+HPM.POLICY_FEE END PREMIUM,HPM.LOGIN_ID FROM  HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE HPM.QUOTE_NO\=? AND PI.CUSTOMER_ID\=HPM.CUSTOMER_ID AND PI.STATUS\='Y' AND PI.AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID)
GET_POLICYINFO = SELECT   HPM.QUOTE_NO, CASE WHEN HPM.STATUS = 'E' THEN NULL ELSE HPM.POLICY_NO END POLICY_NO, HPM.RECEIPT_NO, HPM.DEBIT_NOTE_NO, TO_CHAR (HPM.EFFECTIVE_DATE - 30, 'DD/MM/YYYY') QUOTE_DATE, TO_CHAR (HPM.EFFECTIVE_DATE, 'DD/MM/YYYY') POL_DATE, TO_CHAR (MPD.POLICYSTARTDATE, 'dd/mm/yyyy') POLICYSTARTDATE, TO_CHAR (MPD.POLICYENDDATE, 'DD/MM/YYYY') COVER_END_DATE, TO_CHAR (MPD.POLICYENDDATE, 'DD/MM/YYYY') || ' (' || (TRUNC (MPD.POLICYENDDATE) - TRUNC (MPD.POLICYSTARTDATE)) || ' Days)' COVER_END_PERIODS, PI.FIRST_NAME || ' ' || NVL (PI.LAST_NAME, '') PROPOSER_NAME, TO_CHAR (HPM.INCEPTION_DATE, 'DD/MM/YYYY') COVER_START_DATE, (CASE WHEN (HPM.STATUS IN ('Y', 'E') AND ( (HPM.REMARKS IN ('Referal') AND HPM.ADMIN_REFERRAL_STATUS = 'N') OR (HPM.REMARKS IN ('Admin', 'Normal', 'Referal') AND HPM.ADMIN_REFERRAL_STATUS = 'Y'))) THEN 'Y' ELSE 'N' END) STATUS, CASE WHEN HPM.AMEND_ID = 0 THEN HPM.OVERALL_PREMIUM ELSE HPM.ENDT_PREMIUM + HPM.POLICY_FEE END PREMIUM, HPM.LOGIN_ID FROM   HOME_POSITION_MASTER HPM, PERSONAL_INFO PI,  MOTOR_POLICY_DETAILS MPD WHERE       HPM.QUOTE_NO =  ? AND MPD.QUOTENO = HPM.QUOTE_NO AND PI.CUSTOMER_ID = HPM.CUSTOMER_ID          AND PI.STATUS = 'Y' AND PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM PERSONAL_INFO WHERE   CUSTOMER_ID = PI.CUSTOMER_ID)
##GET_COMM=SELECT NVL (COMMISSION, '0') COMMISSION FROM LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM WHERE LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID = ? AND LM.STATUS = 'Y' AND LUD.STATUS = 'Y' AND LUD.PRODUCT_ID =  ? AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=LM.LOGIN_ID AND PRODUCT_ID=LUD.PRODUCT_ID)
GET_COMM=SELECT NVL (COMMISSION, '0') COMMISSION FROM LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM WHERE LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID = ? AND LM.STATUS = 'Y' AND LUD.STATUS = 'Y' AND LUD.PRODUCT_ID =  ? AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=LM.LOGIN_ID AND PRODUCT_ID=LUD.PRODUCT_ID)
GET_POLICY_STATUS=SELECT NVL(STATUS,'Y') STATUS,POLICY_NO,RECEIPT_NO,DEBIT_NOTE_NO FROM HOME_POSITION_MASTER WHERE QUOTE_NO=? AND (PRODUCT_ID=? OR PROPOSAL_NO=?)
UPD_POLICY_NO=UPDATE HOME_POSITION_MASTER SET POLICY_NO=?,RECEIPT_NO=?,DEBIT_NOTE_NO=?,DEBIT_NOTE_DATE=SYSDATE,RECEIPT_DATE=SYSDATE,STATUS='P',EFFECTIVE_DATE=SYSDATE,PAYMENT_MODE=? WHERE QUOTE_NO=?

GET_HOME_ENDT_INFO = SELECT A.APPLICATION_NO, A.QUOTE_NO, (CASE WHEN A.STATUS = 'R' THEN 'RR' WHEN (a.REMARKS IN ('Referal')) THEN 'RU' WHEN (a.REMARKS IN ('Admin') AND A.STATUS = 'E') THEN 'RA' ELSE 'N' END) REF_STATUS, A.STATUS,A.ENDT_STATUS FROM HOME_POSITION_MASTER A WHERE A.PRODUCT_ID=? AND A.ORIGINAL_POLICY_NO=? AND A.QUOTE_NO = (SELECT MAX(QUOTE_NO) FROM HOME_POSITION_MASTER WHERE LOGIN_ID = a.LOGIN_ID AND PRODUCT_ID = A.PRODUCT_ID AND ORIGINAL_POLICY_NO = A.ORIGINAL_POLICY_NO)
GET_MOTOR_ENDT_INFO = SELECT A.APPLICATION_NO,A.QUOTE_NO,(CASE WHEN A.STATUS = 'R' THEN 'RR' WHEN (A.REMARKS IN ('Referal')) THEN 'RU' WHEN (A.REMARKS IN ('Admin') AND A.STATUS = 'E') THEN 'RA' ELSE 'N' END) REF_STATUS,A.STATUS,A.ENDT_STATUS FROM HOME_POSITION_MASTER A WHERE A.PRODUCT_ID =? AND A.ORIGINAL_POLICY_NO =? AND A.VEHICLE_ID=? AND A.QUOTE_NO = (SELECT MAX (QUOTE_NO) FROM HOME_POSITION_MASTER WHERE LOGIN_ID = A.LOGIN_ID AND A.VEHICLE_ID=VEHICLE_ID AND PRODUCT_ID = A.PRODUCT_ID AND ORIGINAL_POLICY_NO = A.ORIGINAL_POLICY_NO)
GET_TRAVEL_END_LIST = SELECT HPM.APPLICATION_NO,HPM.QUOTE_NO, NVL(PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME,TO_CHAR(HPM.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTATION_DATE ,HPM.ENDT_PREMIUM+HPM.POLICY_FEE PREMIUM ,HPM.POLICY_NO ,HPM.STATUS,(CASE WHEN hpm.STATUS\='R' THEN 'RR' WHEN ((hpm.REMARKS IN ('Referal') AND hpm.ADMIN_REFERRAL_STATUS \= 'N') OR (hpm.REMARKS IN ('Admin', 'Normal' , 'Referal') AND hpm.ADMIN_REFERRAL_STATUS \= 'Y') AND HPM.STATUS \= 'E') THEN 'RU' WHEN (HPM.REMARKS IN ('ADMIN') AND HPM.ADMIN_REFERRAL_STATUS \= 'N' AND HPM.STATUS \= 'E') THEN 'RA' ELSE 'N' END) REF_STATUS,'Y' ENDT_STATUS,HPM.CUSTOMER_ID,HPM.DEBIT_NOTE_NO,HPM.RECEIPT_NO,HPM.ENDT_TYPE_ID ENDT_TYPE FROM HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE HPM.ORIGINAL_POLICY_NO \= ? AND HPM.PRODUCT_ID \= ? AND HPM.CUSTOMER_ID \= PI.CUSTOMER_ID AND PI.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY HPM.QUOTE_NO DESC
GET_MOTOR_END_LIST = SELECT HPM.APPLICATION_NO,HPM.QUOTE_NO,NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME,TO_CHAR (HPM.EFFECTIVE_DATE - 30, 'DD/MM/YYYY') QUOTATION_DATE,HPM.ENDT_PREMIUM + HPM.POLICY_FEE PREMIUM,HPM.POLICY_NO,HPM.STATUS,(CASE WHEN hpm.STATUS = 'R' THEN 'RR' WHEN ( (hpm.REMARKS IN ('Referal') AND hpm.ADMIN_REFERRAL_STATUS = 'N') OR (hpm.REMARKS IN ('Admin', 'Normal', 'Referal') AND hpm.ADMIN_REFERRAL_STATUS = 'Y') AND HPM.STATUS = 'E') THEN 'RU' WHEN (    HPM.REMARKS IN ('ADMIN') AND HPM.ADMIN_REFERRAL_STATUS = 'N' AND HPM.STATUS = 'E') THEN 'RA' ELSE 'N' END) REF_STATUS,'Y' ENDT_STATUS,HPM.CUSTOMER_ID,HPM.DEBIT_NOTE_NO,HPM.RECEIPT_NO,HPM.ENDT_TYPE_ID ENDT_TYPE FROM   HOME_POSITION_MASTER HPM, PERSONAL_INFO PI WHERE       HPM.ORIGINAL_POLICY_NO = ? AND HPM.PRODUCT_ID = ? AND HPM.VEHICLE_ID = ? AND HPM.CUSTOMER_ID = PI.CUSTOMER_ID AND PI.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID = PI.CUSTOMER_ID) ORDER BY   HPM.QUOTE_NO DESC

############Common Home Query - End ###########################################################
###############################################################################################
############Customer Home Query - Start #######################################################
GET_SEARCH1=SELECT PI.CUSTOMER_ID,PI.TITLE,PI.GENDER,PI.FIRST_NAME,PI.LAST_NAME,PI.NATIONALITY,TO_CHAR(PI.DOB,'DD/MM/YYYY') AS DOB,PI.TELEPHONE,PI.MOBILE,PI.FAX,PI.EMAIL,PI.ADDRESS1,PI.OCCUPATION,PI.EMIRATE,PI.COUNTRY,PI.POBOX,PI.COMPANY_NAME,PI.ADDRESS2,PI.CUSTOMER_SOURCE FROM PERSONAL_INFO PI ,LOGIN_MASTER LM1 ,LOGIN_MASTER LM2 WHERE LM1.OA_CODE=LM2.OA_CODE AND LM2.LOGIN_ID=? AND LM1.LOGIN_ID NOT IN ('NONE', 'NON') AND PI.LOGIN_ID=LM1.LOGIN_ID AND (LOWER(PI.FIRST_NAME) LIKE NVL(LOWER(?),'(%') OR LOWER(PI.COMPANY_NAME) LIKE NVL(LOWER(?),'(%') OR PI.EMAIL LIKE NVL(LOWER(?),'(%') OR PI.MOBILE LIKE NVL(LOWER(?),'(%') OR PI.TELEPHONE LIKE NVL(LOWER(?),'(%') OR PI.DOB=TO_DATE(?,'DD/MM/YYYY') OR PI.CUSTOMER_SOURCE LIKE NVL(LOWER(?),'(%')) AND PI.APPLICATION_ID='1' AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
GET_SEARCH2=SELECT PI.CUSTOMER_ID,PI.TITLE,PI.GENDER,PI.FIRST_NAME,PI.LAST_NAME,PI.NATIONALITY,TO_CHAR(PI.DOB,'DD/MM/YYYY') AS DOB,PI.TELEPHONE,PI.MOBILE,PI.FAX,PI.EMAIL,PI.ADDRESS1,PI.OCCUPATION,PI.EMIRATE,PI.COUNTRY,PI.POBOX,PI.COMPANY_NAME,PI.ADDRESS2,PI.CUSTOMER_SOURCE FROM PERSONAL_INFO PI ,LOGIN_MASTER LM1 ,LOGIN_MASTER LM2 WHERE LM1.OA_CODE=LM2.OA_CODE AND LM2.LOGIN_ID=? AND LM1.LOGIN_ID NOT IN ('NONE', 'NON') AND PI.LOGIN_ID=LM1.LOGIN_ID AND PI.CUSTOMER_SOURCE=?  AND PI.CUSTOMER_ID<> ? AND PI.APPLICATION_ID='1' AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
GET_SEARCH3=SELECT CUSTOMER_ID,TITLE,GENDER,FIRST_NAME,LAST_NAME,NATIONALITY,TO_CHAR(PI.DOB,'DD/MM/YYYY') AS DOB,TELEPHONE,MOBILE,FAX,EMAIL,ADDRESS1,OCCUPATION,EMIRATE,COUNTRY,POBOX,COMPANY_NAME,ADDRESS2,CUSTOMER_SOURCE FROM PERSONAL_INFO PI WHERE CUSTOMER_ID=? AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
INS_CUS_DTL=INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,NATIONALITY,DOB,GENDER,TELEPHONE,MOBILE,FAX,EMAIL,ADDRESS1,OCCUPATION,POBOX,COUNTRY,EMIRATE,STATUS,ENTRY_DATE,LOGIN_ID, COMPANY_NAME,ADDRESS2,CUSTOMER_SOURCE,AGENCY_CODE,OA_CODE)VALUES(?,'1',?,?,?,'0',?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,?,?,'Y',TO_DATE(SYSDATE,'DD/MM/YYYY'),?, ?,?,?,'','')
UPD_CUS_DTL=UPDATE PERSONAL_INFO SET APPLICATION_ID='1',TITLE=?,FIRST_NAME=?,LAST_NAME=?,NATIONALITY=?,DOB=TO_DATE(?,'DD/MM/YYYY'),GENDER=?,TELEPHONE=?,MOBILE=?,FAX=?,EMAIL=?,ADDRESS1=?,OCCUPATION=?,POBOX=?,COUNTRY=?,EMIRATE=?,STATUS='Y',EFFECTIVE_DATE=TO_DATE(SYSDATE,'DD/MM/YYYY'),COMPANY_NAME=?,ADDRESS2=?,CUSTOMER_SOURCE=?,AGENCY_CODE='',OA_CODE='' WHERE CUSTOMER_ID=? AND AMEND_ID=?
GET_CUS_DTL_MAX_AMEND_ID=SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=?
INS_HOME_CUS_DTL=INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,MOBILE,EMAIL,ADDRESS1,ADDRESS2,POBOX,EMIRATE,STATUS,ENTRY_DATE,LOGIN_ID,COMPANY_NAME,AGENCY_CODE,OA_CODE,MISSIPPI_CUSTOMER_CODE,CLIENT_CUSTOMER_ID,CUST_AR_NO,CUST_NAME) VALUES (?,'1',?,?,?,'0',?,?,?,?,?,?,'Y',SYSDATE,?,?,(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),?,?,?,?)
UPD_HOME_CUS_DTL=UPDATE PERSONAL_INFO PI SET PI.APPLICATION_ID='1',PI.TITLE=?,PI.FIRST_NAME=?,PI.LAST_NAME=?,PI.MOBILE=?,PI.EMAIL=?,PI.ADDRESS1=?,PI.ADDRESS2=?,PI.POBOX=?,PI.EMIRATE=?,PI.STATUS='Y',PI.EFFECTIVE_DATE=SYSDATE,PI.COMPANY_NAME=?,PI.AGENCY_CODE=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),PI.OA_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),MISSIPPI_CUSTOMER_CODE=?,CLIENT_CUSTOMER_ID=?,CUST_AR_NO=?,CUST_NAME=? WHERE PI.CUSTOMER_ID=? AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
GET_CUSTOMER_DETAILS = SELECT CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,MOBILE,EMAIL,ADDRESS1,ADDRESS2,POBOX,EMIRATE,STATUS,ENTRY_DATE,LOGIN_ID,MISSIPPI_CUSTOMER_CODE,CLIENT_CUSTOMER_ID,CUST_AR_NO,CUST_NAME,CITY,STATE,customer_type,TO_CHAR (DOB, 'DD/MM/YYYY') DOB,GENDER,TELEPHONE,COMPANY_NAME FROM PERSONAL_INFO WHERE CUSTOMER_ID=?
GET_USER_TYPE = SELECT USERTYPE FROM LOGIN_MASTER WHERE LOGIN_ID=? AND APP_ID=?

############Customer Home Query - Start #######################################################
###############################################################################################
############ Home Report Chart - Start ###############################################################
travel.report.chart.portfolio= SELECT  COUNT( a.quote_no) FROM HOME_POSITION_MASTER a, personal_info b    WHERE A.EFFECTIVE_DATE<=SYSDATE and {0}  a.status= ''P'' AND a.AMEND_ID=''0'' AND b.customer_id= a.customer_id  AND a.product_id=? and nvl(a.scheme_id,'1')=? and a.APPLICATION_ID=?  AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.chart.quoteregister.lapsed=SELECT COUNT(a.quote_no)  FROM HOME_POSITION_MASTER a, personal_info PI WHERE A.effective_Date < SYSDATE and A.effective_Date+30 >=SYSDATE and {0} a.product_id =? and nvl(a.scheme_id,'1')=? and a.APPLICATION_ID=? AND a.status=''Y''  AND PI.customer_id = a.customer_id  AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
travel.quoteregister.chart.existing=SELECT COUNT( a.quote_no) FROM HOME_POSITION_MASTER a, personal_info b  WHERE {0}  A.effective_Date >= SYSDATE  AND a.status = ''Y'' AND a.remarks IS NULL  AND a.ADMIN_REFERRAL_STATUS IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ? and nvl(a.scheme_id,'1')=? AND a.APPLICATION_ID = ? AND a.payment_status IS NULL AND A.quote_no IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.unapproved=SELECT COUNT( a.quote_no) FROM home_position_master a, personal_info b   WHERE {0} A.effective_Date >= SYSDATE AND a.status = ''Y'' AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id =? and nvl(a.scheme_id,'1')=? AND a.APPLICATION_ID = ? AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.approved=SELECT COUNT( a.quote_no) FROM home_position_master a, personal_info b  WHERE {0} A.effective_Date >= SYSDATE AND a.status = ''Y'' AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Admin''))  AND a.product_id =? and nvl(a.scheme_id,'1')=? and a.APPLICATION_ID=? AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.reject=SELECT COUNT( a.quote_no) FROM home_position_master a, personal_info b  WHERE {0} A.effective_date >= SYSDATE AND a.status = ''R'' AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id =? and nvl(a.scheme_id,'1')=? and a.APPLICATION_ID=? AND  a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.chart.portfolio.amount= SELECT  sum( a.OVERALL_PREMIUM) FROM HOME_POSITION_MASTER a, personal_info b  WHERE A.EFFECTIVE_DATE<=SYSDATE AND {0}  a.status= ''P'' AND a.AMEND_ID=''0'' AND b.customer_id= a.customer_id  AND a.product_id=? and nvl(a.scheme_id,'1')=? and a.APPLICATION_ID=? AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.chart.quoteregister.lapsed.amount=SELECT sum( a.OVERALL_PREMIUM)  FROM HOME_POSITION_MASTER a, personal_info PI WHERE A.effective_Date < SYSDATE and A.effective_Date+30 >= SYSDATE and  {0} a.product_id =? and nvl(a.scheme_id,'1')=? and a.APPLICATION_ID=?  AND  a.status=''Y''  AND PI.customer_id = a.customer_id AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
travel.quoteregister.chart.existing.amount=SELECT sum( a.OVERALL_PREMIUM) FROM HOME_POSITION_MASTER a, personal_info b  WHERE {0}  A.effective_Date >= SYSDATE  AND a.status = ''Y'' AND a.remarks IS NULL  AND a.ADMIN_REFERRAL_STATUS IS NULL  AND b.customer_id = a.customer_id  AND a.product_id =? and nvl(a.scheme_id,'1')=? AND a.APPLICATION_ID = ? AND a.payment_status IS NULL AND A.quote_no IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.unapproved.amount=SELECT sum( a.OVERALL_PREMIUM) FROM home_position_master a, personal_info b   WHERE {0} A.effective_Date >\= SYSDATE AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id \=? and nvl(a.scheme_id,'1')\=? AND a.APPLICATION_ID \= ? AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)  
travel.report.referral.chart.approved.amount=SELECT sum( a.OVERALL_PREMIUM) FROM home_position_master a, personal_info b  WHERE {0} A.effective_Date >\= SYSDATE AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND (a.REMARKS IN (''Admin''))  AND a.product_id \=? and nvl(a.scheme_id,'1')\=? and a.APPLICATION_ID\=? AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) 
travel.report.referral.chart.reject.amount=SELECT sum( a.OVERALL_PREMIUM) FROM home_position_master a, personal_info b  WHERE {0} (A.STATUS IN (''D'', ''R'')) AND b.customer_id = a.customer_id AND a.product_id =? and nvl(a.scheme_id,'1')=? and a.APPLICATION_ID=? AND a.PAYMENT_STATUS IS NULL AND A.effective_Date  >= SYSDATE AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
############ Home CHART - End #################################################################
###############################################################################################
############Home Portfolio / Home Position master - Start #####################################
travel.issuer.brokerList=SELECT DISTINCT(A.LOGIN_ID) LOGIN_ID,D.USERNAME FROM HOME_POSITION_MASTER A,PERSONAL_INFO B,BROKER_COMPANY_MASTER C, LOGIN_MASTER D WHERE A.PRODUCT_ID = ? AND A.INCEPTION_DATE <= SYSDATE AND A.APPLICATION_ID NOT IN (?,'1') AND C.AGENCY_CODE=D.OA_CODE AND C.BRANCH_CODE=? AND D.LOGIN_ID=A.LOGIN_ID
travel.userlist.issuer=SELECT DISTINCT PM.LOGIN_ID LOGIN_ID,PM.LOGIN_ID FIRST_NAME,BCM.COMPANY_NAME USERNAME FROM HOME_POSITION_MASTER PM,LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE PM.APPLICATION_ID = ? AND LM.LOGIN_ID=PM.LOGIN_ID AND LM.OA_CODE=BCM.AGENCY_CODE AND PM.STATUS in ('P','Y') AND PM.PRODUCT_ID = ?
travel.report.userlist=SELECT DISTINCT LM1.LOGIN_ID,LM1.USERNAME FROM LOGIN_MASTER LM1, LOGIN_MASTER LM2,HOME_POSITION_MASTER HPM, PERSONAL_INFO PI WHERE LM1.OA_CODE=LM2.OA_CODE AND LM2.LOGIN_ID = ? AND LM2.USERTYPE NOT IN ( 'Customer','User','Freight') AND LM1.USERTYPE != 'Freight' AND LM1.LOGIN_ID=HPM.LOGIN_ID AND HPM.PRODUCT_ID = ? AND trunc(HPM.EFFECTIVE_DATE) >= TRUNC(SYSDATE) AND HPM.CUSTOMER_ID = PI.CUSTOMER_ID AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) AND PI.STATUS='Y' ORDER BY LM1.USERNAME

travel.report.portfolio=SELECT HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,TO_CHAR(HPM.EFFECTIVE_DATE,''DD/MM/YYYY'') QUOTATION_DATE,NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,NULL CREDIT_NOTE_NO,HPM.AMEND_ID,HPM.RECEIPT_NO,BCM.COMPANY_NAME BROKER_NAME FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.LOGIN_ID = ? AND HPM.STATUS = ''P'' AND HPM.AMEND_ID=''0'' AND PI.CUSTOMER_ID = HPM.CUSTOMER_ID AND HPM.PRODUCT_ID = ? AND NVL(HPM.SCHEME_ID,'1')=? {0} AND PI.STATUS=''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) AND HPM.LOGIN_ID=LM.LOGIN_ID AND LM.OA_CODE = BCM.AGENCY_CODE
travel.report.quoteregister.lapsed= SELECT a.quote_no, a.LAPSED_REMARKS,TO_CHAR(A.LAPSED_DATE,''DD/MM/YYYY'')  LAPSED_DATE, a.customer_id,TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'')  QUOTATION_DATE,TO_CHAR(A.EFFECTIVE_DATE,''DD/MM/YYYY'') VALIDITY_DATE, NVL(PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME  FROM   HOME_POSITION_MASTER a, personal_info PI  WHERE a.login_id =? AND TRUNC(A.EFFECTIVE_DATE) < TRUNC(SYSDATE) AND a.product_id =? and a.APPLICATION_ID IN(''{0}'') AND a.status=''Y''  AND PI.customer_id = a.customer_id AND A.quote_no IS NOT NULL AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS=''Y'' {1}
travel.quoteregister.existing=SELECT A.APPLICATION_NO, a.quote_no, A.CONTENT_TYPE_ID, a.customer_id,TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') QUOTATION_DATE, TO_CHAR(A.EFFECTIVE_DATE,''DD/MM/YYYY'') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, B.EMAIL, A.INCEPTION_DATE, null OPEN_COVER_NO, NVL(a.OVERALL_PREMIUM,''0'') PREMIUM FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.login_id =? AND TRUNC(A.EFFECTIVE_DATE) >= TRUNC(SYSDATE) AND a.status = ''Y''  AND a.remarks IS NULL  AND a.ADMIN_REFERRAL_STATUS IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ? AND a.APPLICATION_ID IN (''{0}'')  AND a.payment_status IS NULL AND A.quote_no IS NOT NULL AND B.STATUS=''Y'' AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID) {1}
travel.report.referral.unapproved=SELECT a.quote_no,a.customer_id, a.CONTENT_TYPE_ID, TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') QUOTATION_DATE,B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, null OPEN_COVER_NO  FROM   home_position_master a, personal_info b   WHERE       a.login_id =?  AND a.status = ''Y''  AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id =? and a.APPLICATION_ID IN (''{0}'')  AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y'' {1}
travel.report.referral.approved=SELECT a.quote_no, a.CONTENT_TYPE_ID, a.customer_id,TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, null OPEN_COVER_NO FROM   home_position_master a, personal_info b  WHERE       a.login_id =?  AND a.status = ''Y''  AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Admin''))  AND a.product_id =? and a.APPLICATION_ID IN (''{0}'')   AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y'' {1}
travel.report.referral.reject=SELECT   a.quote_no, a.LAPSED_REMARKS,TO_DATE(A.LAPSED_DATE,''DD/MM/YYYY'') LAPSED_DATE, a.customer_id, TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') AS QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NULL OPEN_COVER_NO FROM   home_position_master a, personal_info b WHERE a.login_id = ? AND (A.STATUS IN (''R'')) AND b.customer_id = a.customer_id AND a.product_id = ? and a.APPLICATION_ID IN (''{0}'') AND a.PAYMENT_STATUS IS NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y'' {1}
travel.report.lapsedquote=SELECT A.QUOTE_NO,a.LAPSED_REMARKS,TO_CHAR(A.LAPSED_DATE,''DD/MM/YYYY'') LAPSED_DATE,A.APPLICATION_NO, A.CUSTOMER_ID, TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'')  QUOTATION_DATE, TO_CHAR(A.EFFECTIVE_DATE,''DD/MM/YYYY'') VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME,   ''Rejected''  REJECT_DESC  FROM HOME_POSITION_MASTER A, PERSONAL_INFO B WHERE A.LOGIN_ID =?  AND (A.STATUS IN (''D''))  AND B.CUSTOMER_ID  = A.CUSTOMER_ID  AND A.PRODUCT_ID = ? AND A.APPLICATION_ID IN (''{0}'') AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y'' {1}
travel.report.policy=SELECT A.POLICY_NO,TO_CHAR(A.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE,A.OVERALL_PREMIUM,A.REMARKS,A.LOGIN_ID,A.QUOTE_NO,A.DEBIT_NOTE_NO,A.RECEIPT_NO,NVL(B.COMPANY_NAME,B.FIRST_NAME) INSURED_NAME,A.COMMISSION,NVL(A.PAYMENT_MODE,'-') PAYMENT_MODE,TO_CHAR(A.EFFECTIVE_DATE,'DD/MM/YYYY') EFFECTIVE_DATE,TO_CHAR(A.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,PM.PRODUCT_DESCRIPTION,NVL(PM.BROKER_ID,'Travel') FROM HOME_POSITION_MASTER A,PERSONAL_INFO B,HOME_PRODUCT_MASTER PM WHERE A.EFFECTIVE_DATE BETWEEN TO_DATE(?,'DD/MM/YYYY') AND TO_DATE(?,'DD/MM/YYYY')+1 AND A.LOGIN_ID IN (?) AND A.STATUS\='P' AND  A.PRODUCT_ID\=? AND NVL(A.SCHEME_ID,'1')\=? AND A.DEBIT_NOTE_NO IS NOT NULL AND A.CUSTOMER_ID\=B.CUSTOMER_ID AND PM.PRODUCT_ID \= A.PRODUCT_ID  AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) and B.STATUS\='Y'  and PM.STATUS\='Y' ORDER BY A.EFFECTIVE_DATE DESC
travel.quote.detail=SELECT A.CUSTOMER_ID, A.QUOTE_NO,TO_CHAR(A.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTE_DATE, TO_CHAR(A.EFFECTIVE_DATE,'DD/MM/YYYY') VALIDITY_DATE, NVL (B.FIRST_NAME, B.COMPANY_NAME) CUSTOMER_NAME FROM HOME_POSITION_MASTER A, PERSONAL_INFO B WHERE A.QUOTE_NO = ? AND A.CUSTOMER_ID = B.CUSTOMER_ID AND B.STATUS = 'Y' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.lapsed.update=UPDATE HOME_POSITION_MASTER SET STATUS= 'D',LAPSED_REMARKS=?,LAPSED_DATE=SYSDATE, LAPSED_UPDATED_BY=? WHERE QUOTE_NO=?
travel.active.lapsed=UPDATE HOME_POSITION_MASTER SET EFFECTIVE_DATE\=SYSDATE+30,INCEPTION_DATE\=SYSDATE WHERE QUOTE_NO\=?
travel.report.searchByQuote=SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,hpm.CUSTOMER_ID,TO_CHAR(hpm.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR(hpm.EFFECTIVE_DATE,'DD/MM/YYYY') VALIDITY_DATE, NVL (pi.COMPANY_NAME, pi.FIRST_NAME) CUSTOMER_NAME,hpm.LOGIN_ID,pi.COMPANY_NAME, TO_CHAR(hpm.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE, NVL (hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE  WHEN     hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') THEN 'RA' ELSE case when hpm.STATUS = 'Y' AND trunc(HPM.EFFECTIVE_DATE) >= trunc(SYSDATE) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL then 'Q' else hpm.STATUS END end AS STATUS  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI   WHERE       hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID  AND hpm.PRODUCT_ID =?   AND hpm.APPLICATION_ID = NVL(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID)  AND QUOTE_NO LIKE ? AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC
travel.report.searchByPolicy=SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,hpm.CUSTOMER_ID,TO_CHAR(hpm.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR(hpm.EFFECTIVE_DATE,'DD/MM/YYYY') VALIDITY_DATE, NVL (pi.COMPANY_NAME, pi.FIRST_NAME) CUSTOMER_NAME,hpm.LOGIN_ID,pi.COMPANY_NAME, TO_CHAR(hpm.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE, NVL (hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE  WHEN     hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') THEN 'RA' ELSE case when hpm.STATUS = 'Y' AND trunc(HPM.EFFECTIVE_DATE) >= trunc(SYSDATE) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL then 'Q' else hpm.STATUS END end AS STATUS  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI   WHERE       hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID  AND hpm.PRODUCT_ID =?   AND hpm.APPLICATION_ID = NVL(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID)  AND POLICY_NO LIKE ? AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC
travel.report.searchByCustomer=SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,hpm.CUSTOMER_ID,TO_CHAR(hpm.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR(hpm.EFFECTIVE_DATE,'DD/MM/YYYY') VALIDITY_DATE, NVL (pi.COMPANY_NAME, pi.FIRST_NAME) CUSTOMER_NAME,hpm.LOGIN_ID,pi.COMPANY_NAME, TO_CHAR(hpm.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE, NVL (hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE  WHEN     hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') THEN 'RA' ELSE case when hpm.STATUS = 'Y' AND trunc(HPM.EFFECTIVE_DATE) >= trunc(SYSDATE) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL then 'Q' else hpm.STATUS END end AS STATUS  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI   WHERE       hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID  AND hpm.PRODUCT_ID =?   AND hpm.APPLICATION_ID = NVL(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID) AND (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?)))) AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC
travel.report.searchByQuoteOthers=SELECT  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, TO_CHAR(A.EFFECTIVE_DATE-30,'DD/MM/YYYY') QUOTATION_DATE, TO_CHAR(A.EFFECTIVE_DATE,'DD/MM/YYYY') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, NVL (M.OPEN_COVER_NO, '0'), (NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0)) PREMIUM,TO_CHAR(A.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE,A.POLICY_NO,CASE WHEN A.STATUS='Y' AND A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  = 'N' THEN 'RA' ELSE A.STATUS END AS STATUS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID =? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND trunc(A.EFFECTIVE_DATE) > =trunc(SYSDATE) AND M.APPLICATION_NO  = A.APPLICATION_NO AND B.CUSTOMER_ID = A.CUSTOMER_ID AND A.PRODUCT_ID = ? AND A.APPLICATION_ID NOT IN (?,'1') AND NVL(A.OPEN_COVER_NO,'0') = NVL(?,'0') AND QUOTE_NO LIKE ? AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and B.STATUS='Y' ORDER BY QUOTE_NO DESC
############Home Portfolio / Home Position master - End ########################################
################################################################################################
############Motor B2C Portfolio / Home Position master - Start #################################
GET_B2C_EXISTINGQUOTE_LIST = SELECT A.APPLICATION_NO, a.quote_no, A.CONTENT_TYPE_ID, a.customer_id,TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') QUOTATION_DATE, TO_CHAR(A.EFFECTIVE_DATE,''DD/MM/YYYY'') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, B.EMAIL, A.INCEPTION_DATE, null OPEN_COVER_NO, NVL(a.OVERALL_PREMIUM,''0'') PREMIUM FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.login_id IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)) AND TRUNC(A.EFFECTIVE_DATE) >= TRUNC(SYSDATE) AND a.status = ''Y''  AND a.remarks IS NULL  AND a.ADMIN_REFERRAL_STATUS IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ?  AND A.APPLICATION_ID NOT IN (''{0}'')  AND a.payment_status IS NULL AND A.quote_no IS NOT NULL AND B.STATUS=''Y'' AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID)
GET_MOTOR_ISSUERQUOTE_LIST = SELECT A.APPLICATION_NO, a.quote_no, A.CONTENT_TYPE_ID, a.customer_id,TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') QUOTATION_DATE, TO_CHAR(A.EFFECTIVE_DATE,''DD/MM/YYYY'') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, B.EMAIL, A.INCEPTION_DATE, null OPEN_COVER_NO, NVL(a.OVERALL_PREMIUM,''0'') PREMIUM FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.login_id IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)) AND TRUNC(A.EFFECTIVE_DATE) >= TRUNC(SYSDATE) AND a.status = ''Y''  AND a.remarks IS NULL  AND a.ADMIN_REFERRAL_STATUS IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ?  {0}  AND a.payment_status IS NULL AND A.quote_no IS NOT NULL AND B.STATUS=''Y'' AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID)
GET_MOTOR_EXISTINGQUOTE_LIST = SELECT A.APPLICATION_NO, a.quote_no, A.CONTENT_TYPE_ID, a.customer_id,TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') QUOTATION_DATE, TO_CHAR(A.EFFECTIVE_DATE,''DD/MM/YYYY'') VALIDITY_DATE, NVL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, B.EMAIL, A.INCEPTION_DATE, null OPEN_COVER_NO, NVL(a.OVERALL_PREMIUM,''0'') PREMIUM FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.login_id =? AND TRUNC(A.EFFECTIVE_DATE) >= TRUNC(SYSDATE) AND a.status = ''Y''  AND a.remarks IS NULL  AND a.ADMIN_REFERRAL_STATUS IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ?  {0}  AND a.payment_status IS NULL AND A.quote_no IS NOT NULL AND B.STATUS=''Y'' AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID)
GET_MOTOR_ISSUERPORTFOLIO=SELECT HPM.POLICY_NO,HPM.RECEIPT_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,TO_CHAR(HPM.EFFECTIVE_DATE,''DD/MM/YYYY'') QUOTATION_DATE,NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,NULL CREDIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?)) AND HPM.STATUS \= ''P'' AND HPM.AMEND_ID\=''0'' AND PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \= ? {0} AND PI.STATUS\=''Y'' AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) AND HPM.LOGIN_ID\=LM.LOGIN_ID AND LM.OA_CODE \= BCM.AGENCY_CODE
GET_MOTOR_PORTFOLIO=SELECT HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,TO_CHAR(HPM.EFFECTIVE_DATE,''DD/MM/YYYY'') QUOTATION_DATE,NVL (PI.COMPANY_NAME, PI.FIRST_NAME) CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,NULL CREDIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.LOGIN_ID \= ? AND HPM.STATUS \= ''P'' AND HPM.AMEND_ID\=''0'' AND PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \= ? {0} AND PI.STATUS\=''Y'' AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) AND HPM.LOGIN_ID\=LM.LOGIN_ID AND LM.OA_CODE \= BCM.AGENCY_CODE 
GET_MOTOR_ISSUER_RUQUOTE_LIST=SELECT a.quote_no,a.customer_id, a.CONTENT_TYPE_ID, TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') QUOTATION_DATE,nvl((B.FIRST_NAME || B.Last_name),b.company_name) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, null OPEN_COVER_NO  FROM   home_position_master a, personal_info b   WHERE       a.login_id IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?))  AND a.status \= ''Y''  AND b.customer_id \= a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id \=? {0}  AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) and B.STATUS\=''Y'' 
GET_MOTOR_RUQUOTE_LIST=SELECT a.quote_no,a.customer_id, a.CONTENT_TYPE_ID, TO_CHAR(A.EFFECTIVE_DATE-30,''DD/MM/YYYY'') QUOTATION_DATE,nvl((B.FIRST_NAME || B.Last_name),b.company_name) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, null OPEN_COVER_NO  FROM   home_position_master a, personal_info b   WHERE       a.login_id =?  AND a.status = ''Y''  AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id =? {0}  AND a.PAYMENT_STATUS IS NULL AND A.QUOTE_NO IS NOT NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y''
############Motor B2C Portfolio / Home Position master - End ###################################
################################################################################################
############Home Copy Quote - Start ############################################################
travel.copyquote.quoteNo=SELECT PM.QUOTE_NO, PI.FIRST_NAME, (nvl(pm.PREMIUM,0) + nvl(pm.POLICY_FEE,0)) PREMIUM FROM HOME_POSITION_MASTER PM, LOGIN_MASTER LM, PERSONAL_INFO PI WHERE       PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.QUOTE_NO\=? AND LM.LOGIN_ID \= PM.LOGIN_ID  AND (PM.LOGIN_ID\=? OR PM.APPLICATION_ID IN ('1','2')) AND PM.PRODUCT_ID\=? AND PI.STATUS \= 'Y' AND PM.REMARKS IS NULL AND PM.ADMIN_REFERRAL_STATUS IS NULL AND PM.PAYMENT_STATUS IS NULL AND PM.QUOTE_NO IS NOT NULL  AND (TRUNC(PM.EFFECTIVE_DATE) >\= TRUNC(SYSDATE)  OR PM.STATUS \!\= 'Y') AND (PM.STATUS \= 'Y' OR PM.STATUS \= 'P') AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY   PM.EFFECTIVE_DATE DESC
travel.copyquote.policyNo=SELECT PM.QUOTE_NO, PI.FIRST_NAME, (nvl(pm.PREMIUM,0) + nvl(pm.POLICY_FEE,0)) PREMIUM FROM HOME_POSITION_MASTER PM, LOGIN_MASTER LM, PERSONAL_INFO PI WHERE    PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.POLICY_NO\=? AND LM.LOGIN_ID \= PM.LOGIN_ID AND (PM.LOGIN_ID\=? OR PM.APPLICATION_ID IN ('1','2')) AND PM.PRODUCT_ID\=? AND PI.STATUS \= 'Y' AND PM.REMARKS IS NULL AND PM.ADMIN_REFERRAL_STATUS IS NULL AND PM.PAYMENT_STATUS IS NULL AND PM.QUOTE_NO IS NOT NULL AND (TRUNC(PM.EFFECTIVE_DATE) >\= TRUNC(SYSDATE)  OR PM.STATUS \!\= 'Y') AND (PM.STATUS \= 'Y' OR PM.STATUS \= 'P') AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY   PM.EFFECTIVE_DATE DESC
travel.copyquote.custName=SELECT PM.QUOTE_NO, PI.FIRST_NAME, (nvl(pm.PREMIUM,0) + nvl(pm.POLICY_FEE,0)) PREMIUM FROM HOME_POSITION_MASTER PM, LOGIN_MASTER LM, PERSONAL_INFO PI WHERE   PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND UPPER (PI.FIRST_NAME) \= UPPER (?) AND LM.LOGIN_ID \= PM.LOGIN_ID AND PI.STATUS \= 'Y' AND PM.REMARKS IS NULL AND PM.ADMIN_REFERRAL_STATUS IS NULL AND PM.PAYMENT_STATUS IS NULL AND PM.QUOTE_NO IS NOT NULL AND PM.LOGIN_ID\=? AND PM.PRODUCT_ID\=? AND (TRUNC(PM.EFFECTIVE_DATE) >\= TRUNC(SYSDATE) OR PM.STATUS \!\= 'Y') AND (PM.STATUS \= 'Y' OR PM.STATUS \= 'P')   AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY   PM.EFFECTIVE_DATE DESC
############Home Copy Quote - End ##############################################################
##Motor Payment Details start
GET_PAYMENT_TRANID_SEQ = SELECT PAYMENT_TRAN_ID.NEXTVAL FROM DUAL
INS_PAY_DETAILS = INSERT INTO PAYMENT_DETAIL(APPLICATION_NO,QUOTE_NO,PRODUCT_ID,PAYMENT_TYPE,CHEQUE_NO,BANK_NAME,MICR_CODE,CHEQUE_AMOUNT,CHEQUE_DATE,REQUEST_TIME,MERCHANT_REFERENCE,CUSTOMER_EMAIL,CUSTOMER_NAME,BRANCH_CODE,CURRENCY_TYPE,PREMIUM,NO_OF_INSTALLMENT,INSTALLMENT_AMOUNT,INSTALLMENT_FREQUENCY,INSTALLMENT_START_DATE,INSTALLMENT_YN) VALUES (?,?,?,?,?,?,?,?, TO_DATE(?,'DD/MM/YYYY'),SYSDATE,?,?,?,?,?,?,?,?,?,?,?)
UPD_MOTOR_PAY_DETAILS = UPDATE PAYMENT_DETAIL SET RESPONSE_TIME=SYSDATE,RESPONSE_MESSAGE=?,RESPONSE_STATUS=?,CARD_NUMBER_MASKED=?,RESPONSE_CODE=?,RESPONSE_TRAN_NO=? WHERE MERCHANT_REFERENCE=?
GET_MOTOR_PAY_DETAILS = SELECT * FROM PAYMENT_DETAIL WHERE MERCHANT_REFERENCE=?
GET_PAYMENTQUOTENO = SELECT QUOTE_NO FROM PAYMENT_DETAIL WHERE MERCHANT_REFERENCE=?
GET_PAYMENTAPPLICATIONNO = SELECT APPLICATION_NO FROM PAYMENT_DETAIL WHERE MERCHANT_REFERENCE=?
#End
################################################################################################





################################################################################################
#Motor Insurance
##INS_MOTOR_QUICK_CUS_DTL = INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,MOBILE,STATUS,ENTRY_DATE,LOGIN_ID,COMPANY_NAME,AGENCY_CODE,OA_CODE,CUST_NAME,CUSTOMER_TYPE,EMAIL,CUST_NAME_ARABIC) VALUES (?,'1',?,?,?,'0',?,'Y',SYSDATE,?,?,(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),?,?,?,?)
INS_MOTOR_QUICK_CUS_DTL =   INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,MOBILE,STATUS,ENTRY_DATE,LOGIN_ID,COMPANY_NAME,AGENCY_CODE,OA_CODE,CUST_NAME,CUSTOMER_TYPE,COMPANY_REG_NO,EMAIL,CUST_NAME_ARABIC) VALUES (?,'1',?,?,?,'0',?,'Y',sysdate,?,?,(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),?,?,?,?,?)
##UPD_MOTOR_QUICK_CUS_DTL = UPDATE PERSONAL_INFO PI SET PI.APPLICATION_ID='1',PI.TITLE=?,PI.FIRST_NAME=?,PI.LAST_NAME=?,PI.MOBILE=?,PI.STATUS='Y',PI.EFFECTIVE_DATE=SYSDATE,PI.COMPANY_NAME=?,PI.AGENCY_CODE=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),PI.OA_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),CUST_NAME=?,CUSTOMER_TYPE=?,EMAIL=?,CUST_NAME_ARABIC=? WHERE PI.CUSTOMER_ID=? AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
UPD_MOTOR_QUICK_CUS_DTL = UPDATE PERSONAL_INFO  SET APPLICATION_ID='1',TITLE=?,FIRST_NAME=?,LAST_NAME=?,MOBILE=?,STATUS='Y',EFFECTIVE_DATE=SYSDATE,COMPANY_NAME=?,AGENCY_CODE=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),OA_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),CUST_NAME=?,CUSTOMER_TYPE=?,COMPANY_REG_NO=?,EMAIL=?,CUST_NAME_ARABIC=? WHERE CUSTOMER_ID=?
INS_MOTOR_CUS_DTL=INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,MOBILE,EMAIL,ADDRESS1,ADDRESS2,POBOX,EMIRATE,STATUS,ENTRY_DATE,LOGIN_ID,COMPANY_NAME,AGENCY_CODE,OA_CODE,MISSIPPI_CUSTOMER_CODE,CLIENT_CUSTOMER_ID,CUST_AR_NO,CUST_NAME,NRC,PASSPORT_NUMBER,DOB,DOB_AR,ALTERNATE_MOBILE,TELEPHONE,CUSTOMER_TYPE,COMPANY_REG_NO,CUST_NAME_ARABIC) VALUES (?,'1',?,?,?,'0',?,?,?,?,?,?,'Y',SYSDATE,?,?,(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?)
UPD_MOTOR_CUS_DTL=UPDATE PERSONAL_INFO PI SET PI.APPLICATION_ID='1',PI.TITLE=?,PI.FIRST_NAME=?,PI.LAST_NAME=?,PI.MOBILE=?,PI.EMAIL=?,PI.ADDRESS1=?,PI.ADDRESS2=?,PI.POBOX=?,PI.EMIRATE=?,PI.STATUS='Y',PI.EFFECTIVE_DATE=SYSDATE,PI.COMPANY_NAME=?,PI.AGENCY_CODE=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),PI.OA_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),MISSIPPI_CUSTOMER_CODE=?,CLIENT_CUSTOMER_ID=?,CUST_AR_NO=?,CUST_NAME=?, NRC=?, PASSPORT_NUMBER=?, DOB=TO_DATE(?,'DD/MM/YYYY'), DOB_AR=?, ALTERNATE_MOBILE=?, TELEPHONE=?,CUSTOMER_TYPE=?,COMPANY_REG_NO=?,CUST_NAME_ARABIC=?,LOGIN_ID=? WHERE PI.CUSTOMER_ID=? AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
GET_MOTOR_CUS_CNT = SELECT COUNT(*) FROM PERSONAL_INFO WHERE CUSTOMER_ID=?
GET_HOM_POS_CNT = SELECT COUNT(*) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?
GET_MOTOR_DTL_CNT = SELECT COUNT(*) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=? AND VEHICLE_ID=?
INS_MOTOR_HOME_POS_DTLS=INSERT INTO HOME_POSITION_MASTER (QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,APPLICATION_NO,STATUS,COMPANY_ID,EFFECTIVE_DATE,ENTRY_DATE,FLEET_NO,BRANCH_CODE,APPLICATION_ID,ADMIN_REMARKS,BROKER_CODE,AC_EXECUTIVE_ID) VALUES(?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),?,?,?,SYSDATE+30,SYSDATE,?,?,?,?,?,?)
#INS_MOTOR_HOME_POS_DTLS_REF=INSERT INTO HOME_POSITION_MASTER (QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,APPLICATION_NO,STATUS,COMPANY_ID,EFFECTIVE_DATE,ENTRY_DATE,FLEET_NO,BRANCH_CODE,APPLICATION_ID,ADMIN_REFERRAL_STATUS,REMARKS,REFERRAL_DESCRIPTION,BROKER_CODE,AC_EXECUTIVE_ID) VALUES(?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(TO_CHAR(ADD_MONTHS(TO_DATE(NVL(?,SYSDATE),'DD/MM/YYYY'),13)-1,'DD-MM-YYYY')||' 23:59:59','DD-MM-YYYY HH24:MI:SS'),?,?,?,SYSDATE+30,SYSDATE,?,?,?,'Y','Referal',?,?,?)
UPD_MOTOR_HOME_POS_DTLS=UPDATE HOME_POSITION_MASTER SET INCEPTION_DATE=TO_DATE(?,'dd/mm/yyyy'),EXPIRY_DATE=TO_DATE(?,'dd/mm/yyyy'),EFFECTIVE_DATE=SYSDATE+30,REFERRAL_DESCRIPTION=?,REMARKS=NULL,ADMIN_REFERRAL_STATUS=NULL,STATUS=?,BROKER_CODE=?,AC_EXECUTIVE_ID=?, APPLICATION_ID=? WHERE APPLICATION_NO=?
#UPD_MOTOR_HOME_POS_REF=UPDATE HOME_POSITION_MASTER SET INCEPTION_DATE=TO_DATE(?,'dd/mm/yyyy'),EXPIRY_DATE=TO_DATE(TO_CHAR(ADD_MONTHS(TO_DATE(NVL(?,SYSDATE),'dd/mm/yyyy'),13)-1,'DD-MM-YYYY')||' 23:59:59','DD-MM-YYYY HH24:MI:SS'),EFFECTIVE_DATE=SYSDATE+30,REFERRAL_DESCRIPTION=?,REMARKS='Referal',ADMIN_REFERRAL_STATUS='Y',STATUS=?,PREMIUM=NULL,OVERALL_PREMIUM=NULL,BROKER_CODE=?,AC_EXECUTIVE_ID=?, APPLICATION_ID=? WHERE APPLICATION_NO=?
UPD_MOTOR_HOME_POS_DTLS_ADMIN=UPDATE HOME_POSITION_MASTER SET INCEPTION_DATE=TO_DATE(?,'dd/mm/yyyy'),EXPIRY_DATE=TO_DATE(?,'dd/mm/yyyy'),EFFECTIVE_DATE=SYSDATE+30,APPROVED_BY = ?,STATUS=?,BROKER_CODE=?,AC_EXECUTIVE_ID=? WHERE APPLICATION_NO=?
UPD_MOTOR_ADMIN_REFSTATUS=UPDATE HOME_POSITION_MASTER SET REMARKS=?,ADMIN_REMARKS=?,EXCESS_PREMIUM=?,ADMIN_REFERRAL_STATUS='N',STATUS=?,EXCESS_SIGN=?,EFFECTIVE_DATE=SYSDATE+30,OVERALL_PREMIUM=?,COMMISSION=?,APPROVED_BY=(SELECT NVL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?),PREMIUM=? WHERE QUOTE_NO=?
UPD_MOTOR_REFSTATUS = UPDATE HOME_POSITION_MASTER SET REFERRAL_DESCRIPTION=?,REMARKS=?,ADMIN_REFERRAL_STATUS=? WHERE APPLICATION_NO=?
##INS_MOTOR_DATA_DTLS=INSERT INTO MOTOR_DATA_DETAIL (QUOTE_NO,CUSTOMER_ID,PRODUCT_ID,AMEND_ID,ENTRY_DATE,APPLICATION_NO,STATUS,MAKE_ID,MODEL_ID,BODY,MANUFACTURE_YEAR,CUBIC_CAPACITY,SEATING_CAPACITY,SUMINSURED_VALUE_LOCAL,AGENCY_REPAIR,NO_OF_CYLINDER,VEHICLE_TYPE,DRIVER_UAE_LICENCE,CLAIMYN,CLAIM_AMOUNT,NO_CLAIM_BONUS,AREA_COVERAGE,DRIVER_DOB,INCEPTION_DATE,EXPIRY_DATE,THIRD_PARTY_LIABILITY,EXCESS,DRIVER_NATIONALITY,DRIVER_UAE_LIC_EXP_DT,REFERRAL_REMARKS,DEDUCTIBLE_ID,DRIVER_ID,ELECTRICAL_SI,NONELECTRICAL_SI,VEHICLE_ID) values(?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'dd/mm/yyyy'),TO_DATE(TO_CHAR(ADD_MONTHS(TO_DATE(NVL(?,SYSDATE),'DD/MM/YYYY'),13)-1,'DD-MM-YYYY')||' 23:59:59','DD-MM-YYYY HH24:MI:SS'),?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,?,?,?)
INS_MOTOR_DATA_DTLS=INSERT INTO MOTOR_DATA_DETAIL (QUOTE_NO,CUSTOMER_ID,PRODUCT_ID,AMEND_ID,ENTRY_DATE,APPLICATION_NO,STATUS,MAKE_ID,MODEL_ID,BODY,MANUFACTURE_YEAR,CUBIC_CAPACITY,SEATING_CAPACITY,SUMINSURED_VALUE_LOCAL,AGENCY_REPAIR,NO_OF_CYLINDER,VEHICLE_TYPE,DRIVER_UAE_LICENCE,CLAIMYN,CLAIM_AMOUNT,NO_CLAIM_BONUS,AREA_COVERAGE,DRIVER_DOB,INCEPTION_DATE,EXPIRY_DATE,THIRD_PARTY_LIABILITY,EXCESS,DRIVER_NATIONALITY,DRIVER_UAE_LIC_EXP_DT,REFERRAL_REMARKS,DEDUCTIBLE_ID,DRIVER_ID,VEHICLE_ID) values(?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'dd/mm/yyyy'),TO_DATE(TO_CHAR(ADD_MONTHS(TO_DATE(NVL(?,SYSDATE),'DD/MM/YYYY'),13)-1,'DD-MM-YYYY')||' 23:59:59','DD-MM-YYYY HH24:MI:SS'),?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,?)
UPD_MOTOR_DATA_DTLS=UPDATE MOTOR_DATA_DETAIL SET CUSTOMER_ID=?,MAKE_ID=?,MODEL_ID=?,BODY=?,MANUFACTURE_YEAR=?,CUBIC_CAPACITY=?,SEATING_CAPACITY=?,SUMINSURED_VALUE_LOCAL=?,AGENCY_REPAIR=?,NO_OF_CYLINDER=?,VEHICLE_TYPE=?,DRIVER_UAE_LICENCE=?,CLAIMYN=?,CLAIM_AMOUNT=?,NO_CLAIM_BONUS=?,AREA_COVERAGE=?,DRIVER_DOB=TO_DATE(?,'DD/MM/YYYY'),INCEPTION_DATE=TO_DATE(?,'DD/MM/YYYY'),EXPIRY_DATE=TO_DATE(TO_CHAR(ADD_MONTHS(TO_DATE(NVL(?,SYSDATE),'DD/MM/YYYY'),13)-1,'DD-MM-YYYY')||' 23:59:59','DD-MM-YYYY HH24:MI:SS'),THIRD_PARTY_LIABILITY=?,EXCESS=?,DRIVER_NATIONALITY=?,DRIVER_UAE_LIC_EXP_DT=TO_DATE(?,'dd/mm/yyyy'),REFERRAL_REMARKS=?,DEDUCTIBLE_ID=?,DRIVER_ID=? WHERE APPLICATION_NO=? AND VEHICLE_ID=?
#GET_MOTOR_DATA_DTLS=SELECT MD.QUOTE_NO,MD.MAKE_ID,MD.MODEL_ID,MD.BODY,MD.MANUFACTURE_YEAR,MD.SUMINSURED_VALUE_LOCAL,MD.CUBIC_CAPACITY,MD.SEATING_CAPACITY,MD.CURRENCY_TYPE,MD.AGENCY_REPAIR,MD.NO_OF_CYLINDER,MD.VEHICLE_TYPE,MD.LEASED,TO_CHAR(MD.DRIVER_DOB,'DD/MM/YYYY') DRIVER_DOB,MD.DRIVER_UAE_LICENCE,MD.DRIVER_OTHER_LICENCE,MD.NO_OF_CLAIMS,MD.NO_CLAIM_BONUS,MD.AREA_COVERAGE,TO_CHAR(MD.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE,TO_CHAR(MD.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,MD.POLICYTYPE,MD.OPTIONAL_COVER,MD.THIRD_PARTY_LIABILITY,MD.EXCESS,MD.BANK_ID,MD.DRIVER_NATIONALITY,MD.DRIVER_LICENSE,MD.DRIVER_GENDER,MD.CUSTOMER_ID,MD.CLAIMYN,MD.CLAIM_AMOUNT,MD.REGISTRATION_NO, MD.CHASSIS_NO, MD.ENGINE_NUMBER, MD.VEHICLE_COLOR, MD.INSURED_NAME_ARABIC, MD.INSURED_ADDRESS_ARABIC,TO_CHAR(MD.DRIVER_UAE_LIC_EXP_DT,'DD/MM/YYYY') RIVER_UAE_LIC_EXP_DT,MD.REGISTER_LOCATION,MD.PLATE_COLOR,PI.TITLE,NVL(PI.FIRST_NAME,PI.COMPANY_NAME) NAME,PI.MOBILE,PI.EMAIL,PI.ADDRESS1,PI.ADDRESS2,PI.POBOX,PI.EMIRATE,PI.MISSIPPI_CUSTOMER_CODE,PI.CLIENT_CUSTOMER_ID,PI.CUST_AR_NO,HPM.BROKER_CODE,HPM.AC_EXECUTIVE_ID,HPM.LOGIN_ID FROM MOTOR_DATA_DETAIL MD,PERSONAL_INFO PI,HOME_POSITION_MASTER HPM WHERE MD.APPLICATION_NO=? AND MD.PRODUCT_ID=? AND  HPM.APPLICATION_NO=MD.APPLICATION_NO AND HPM.PRODUCT_ID=MD.PRODUCT_ID AND MD.STATUS='Y' AND PI.STATUS='Y' AND PI.CUSTOMER_ID=MD.CUSTOMER_ID AND MD.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=MD.APPLICATION_NO AND PRODUCT_ID=MD.PRODUCT_ID) AND HPM.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   HOME_POSITION_MASTER WHERE APPLICATION_NO = HPM.APPLICATION_NO AND PRODUCT_ID = HPM.PRODUCT_ID) AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
GET_MOTOR_DATA_DTLS = SELECT HPM.QUOTE_NO, TO_CHAR (HPM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (HPM.EXPIRY_DATE, 'DD/MM/YYYY') EXPIRY_DATE, HPM.CUSTOMER_ID, HPM.BROKER_CODE, HPM.AC_EXECUTIVE_ID, HPM.LOGIN_ID FROM HOME_POSITION_MASTER HPM WHERE HPM.APPLICATION_NO=? AND HPM.PRODUCT_ID=? AND HPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO = HPM.APPLICATION_NO AND PRODUCT_ID = HPM.PRODUCT_ID)
GET_MOTOR_POL_TYPE_IDS=SELECT SUBSTR (SYS_CONNECT_BY_PATH (POLICYTYPE_IDS,','),2) POLICYTYPE_IDS FROM (SELECT POLICYTYPE_IDS,ROW_NUMBER () OVER (ORDER BY POLICYTYPE_IDS) RN,COUNT(*) OVER() CNT FROM MOTOR_BROKER_POLICYTYPE_MASTER MP WHERE BROKER_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_BROKER_POLICYTYPE_MASTER WHERE BROKER_ID=MP.BROKER_ID AND BRANCH_CODE=MP.BRANCH_CODE AND PRODUCT_ID=MP.PRODUCT_ID AND POLICYTYPE_IDS=MP.POLICYTYPE_IDS)) WHERE RN=CNT START WITH RN=1 CONNECT BY RN = PRIOR RN+1
GET_MOTOR_POL_MSTR=SELECT POLICYTYPE_ID,POLICYTYPE_DESC_ENGLISH FROM MOTOR_POLICYTYPE_MASTER WHERE BRANCH_CODE=? AND POLICYTYPE_ID||AMEND_ID IN (SELECT POLICYTYPE_ID||MAX(AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE BRANCH_CODE=? GROUP BY POLICYTYPE_ID) {0}
GET_MOTOR_COVERAGE_DTLS=SELECT POLICYTYPE_COVERID,GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE FROM MOTOR_POLICY_COVER_DETAIL A WHERE POLICYTYPE_ID=? AND POLICYCOVER_ID=0 AND BRANCH_CODE=? AND TYPE_OF_BODY=? AND STATUS='Y' AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_ID=A.POLICYTYPE_ID AND POLICYCOVER_ID=0 AND BRANCH_CODE=A.BRANCH_CODE AND TYPE_OF_BODY=A.TYPE_OF_BODY AND POLICYTYPE_COVERID=A.POLICYTYPE_COVERID)
GET_MOTOR_BRPOLTYPEMSTR_RATE=SELECT RATE_ONE,RATE_TWO,RATE_THREE,RATE_FOUR FROM MOTOR_BROKER_POLICYTYPE_MASTER MP WHERE MP.PRODUCT_ID = ? AND MP.BROKER_ID = (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE UPPER (USERTYPE) = 'BROKER' AND OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = ?)) AND MP.BRANCH_CODE = ? AND MP.POLICYTYPE_IDS=?
DEL_MOTOR_POL_COV1=DELETE FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND X_ID=? AND Y_ID NOT IN(?)
GET_MOTOR_POL_COV_CNT=SELECT COUNT(*) FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND X_ID=? AND Y_ID=?
INS_MOTOR_POL_COV=INSERT INTO MOTOR_POLICY_COVERAGE (APPLICATION_NO,X_ID,X_DATA_NAME,Y_ID,Y_DATA_NAME,DATA_VALUE,ENTRY_DATE,UPDATED_DATE,REMARKS,STATUS,GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE,RATE,BASE_RATE,MIN_PREMIUM) VALUES (?,?,?,?,(SELECT GROUP_DESC_ENGLISH FROM MOTOR_GROUP_MASTER WHERE GROUP_ID=0 AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_GROUP_MASTER WHERE GROUP_ID=0)),?,SYSDATE,SYSDATE,NULL,'Y',?,?,?,?,?,?,?,?)
UPD_MOTOR_POL_COV=UPDATE MOTOR_POLICY_COVERAGE SET (DATA_VALUE,GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE,RATE,BASE_RATE,MIN_PREMIUM)=(SELECT ?,?,?,?,?,?,?,?,? FROM DUAL) WHERE APPLICATION_NO=? AND X_ID=? AND Y_ID=?
DEL_MOTOR_POL_COV2=DELETE FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND X_ID=?
GET_MOTOR_AGENCY_CODE=SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE UPPER(USERTYPE)='BROKER' AND OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=(SELECT LOGIN_ID FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?))
GET_MOTOR_AG_CODE=SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE UPPER(USERTYPE)='BROKER' AND OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GET_MOTOR_DRIVER_AGE_CNT=SELECT COUNT(*) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND (SELECT  ROUND(FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(?,''dD/MM/YYYY''))) / 12) FROM DUAL) BETWEEN DRIVER_START_AGE AND DRIVER_END_AGE AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? AND (AGENCY_CODE IN (''{0}'') OR AGENCY_CODE IS NULL) AND TYPEID||AMEND_ID IN (SELECT TYPEID||MAX(AMEND_ID) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? GROUP BY TYPEID)
GET_MOTOR_UAE_LICENCE_CNT=SELECT COUNT(*) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND ? BETWEEN UAE_LICENCE_START AND UAE_LICENCE_END AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? AND (AGENCY_CODE IN (''{0}'') OR AGENCY_CODE IS NULL) AND TYPEID||AMEND_ID IN (SELECT TYPEID||MAX(AMEND_ID) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? GROUP BY TYPEID)
GET_MOTOR_VEHICLE_TYPE_CNT=SELECT COUNT(*) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND VEHICLE_TYPE=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? AND (AGENCY_CODE IN (''{0}'') OR AGENCY_CODE IS NULL) AND TYPEID||AMEND_ID IN (SELECT TYPEID||MAX(AMEND_ID) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? GROUP BY TYPEID)
GET_MOTOR_TYPE_INFO1=SELECT TYPEID,MODEL_ID,NVL(AGENCY_CODE,'None') AG_CODE FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=?
GET_MOTOR_TYPE_INFO2= AND (SELECT  ROUND(FLOOR(MONTHS_BETWEEN(SYSDATE,TO_DATE(''{0}'',''dD/MM/YYYY''))) / 12) FROM DUAL) BETWEEN DRIVER_START_AGE AND DRIVER_END_AGE
GET_MOTOR_TYPE_INFO3= AND ''{0}'' BETWEEN UAE_LICENCE_START AND UAE_LICENCE_END
GET_MOTOR_TYPE_INFO4= AND VEHICLE_TYPE=''{0}''
GET_MOTOR_TYPE_INFO5= AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? AND (AGENCY_CODE IN (''{0}'') OR AGENCY_CODE IS NULL) AND TYPEID||AMEND_ID IN (SELECT TYPEID||MAX(AMEND_ID) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? GROUP BY TYPEID)
GET_MOTOR_YEAR_CNT=SELECT ROUND(MONTHS_BETWEEN(SYSDATE,TO_DATE(?,'yyyy'))/12) YEAR FROM DUAL
GET_MOTOR_POL_COV_DTLS=SELECT A.POLICYTYPE_COVERID,B.OPCOVER_DESC_ENGLISH,A.POLICYCOVER_ID,A.CALC_TYPE FROM MOTOR_POLICY_COVER_DETAIL A,MOTOR_OPCOVER_MASTER B WHERE B.OPCOVER_ID=A.POLICYCOVER_ID AND B.OPCOVER_ID!=0 AND A.POLICYTYPE_ID=? AND A.TYPE_OF_BODY=? AND A.AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_ID=A.POLICYTYPE_ID AND BRANCH_CODE=A.BRANCH_CODE AND TYPE_OF_BODY=A.TYPE_OF_BODY AND POLICYTYPE_COVERID=A.POLICYTYPE_COVERID) AND B.AMEND_ID IN(SELECT MAX(D.AMEND_ID) FROM MOTOR_OPCOVER_MASTER D WHERE D.OPCOVER_ID=B.OPCOVER_ID AND B.BRANCH_CODE=D.BRANCH_CODE)  AND A.BRANCH_CODE=? AND A.BRANCH_CODE=B.BRANCH_CODE AND A.STATUS='Y' AND B.STATUS='Y' ORDER BY A.POLICYTYPE_COVERID
INS_MOTOR_POL_COV_DTL=INSERT INTO MOTOR_POLICY_COVERAGE (APPLICATION_NO,X_ID,X_DATA_NAME,Y_ID,Y_DATA_NAME,DATA_VALUE,ENTRY_DATE,UPDATED_DATE,REMARKS,STATUS,GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE,RATE,BASE_RATE) (SELECT ?,?,?,?,?,((CASE WHEN (POLICYCOVER_ID=2 OR POLICYCOVER_ID=14 OR POLICYCOVER_ID=16) THEN {0} ELSE 1 END)*({1})),SYSDATE,SYSDATE,NULL,''Y'',GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE{2} FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=?))
UPD_MOTOR_POL_COV_DTL=UPDATE MOTOR_POLICY_COVERAGE MC SET (DATA_VALUE,GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE,RATE,BASE_RATE)=(SELECT ((CASE WHEN (POLICYCOVER_ID=2 OR POLICYCOVER_ID=14 OR POLICYCOVER_ID=16) THEN {0} ELSE 1 END)*({1})),GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE {2} FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=MC.Y_ID AND BRANCH_CODE=? AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=?)), UPDATED_DATE=SYSDATE WHERE APPLICATION_NO=? AND X_ID=? AND Y_ID=?
GET_MOTOR_VEHICLE_AGE=SELECT COUNT(*) FROM MOTOR_BODYTYPE_DETAIL M WHERE BRANCH_CODE=? AND PRODUCT_ID=? AND TYPE_OF_BODY_ID=? AND STATUS='Y' AND NO_OF_YEARS_ALLOWED>? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL WHERE BRANCH_CODE=M.BRANCH_CODE AND PRODUCT_ID=M.PRODUCT_ID AND TYPE_OF_BODY_ID=M.TYPE_OF_BODY_ID)
GET_MOTOR_COMPREHENSIVE_RATE=SELECT RATE,(CASE WHEN MINIMUM_PREMIUM<(SELECT MIN_PREMIUM_AMOUNT FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=?  AND PRODUCT_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? AND PRODUCT_ID=?)) THEN (SELECT MIN_PREMIUM_AMOUNT FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? AND PRODUCT_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? AND PRODUCT_ID=?)) ELSE MINIMUM_PREMIUM END) PREMIUM FROM MOTOR_TYPE_BODY_RATE WHERE AGENCY_REPAIR_YEAR=? AND ? BETWEEN  SEATING_TON_START AND SEATING_TON_END  AND ? BETWEEN START_SUMINSURED AND END_SUMINSURED AND TYPEID=?  AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS='Y' AND POLICYTYPE_ID=? AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM  MOTOR_TYPE_BODY_RATE  WHERE AGENCY_REPAIR_YEAR=? AND TYPEID=?  AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS='Y' AND POLICYTYPE_ID=?)
GET_MOTOR_THIRD_PARTY_RATE=SELECT THIRD_PARTY_RATE RATE FROM MOTOR_TYPE_THIRD_PARTY WHERE TYPEID=? AND SEATING_CYLINDER=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS='Y' AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE TYPEID=? AND SEATING_CYLINDER=? AND BRANCH_CODE=? AND PRODUCT_ID=?)
GET_MOTOR_POL_COVER_DATA_RATE=SELECT NVL(RATE,0) RATE FROM MOTOR_POLICY_COVER_DATA WHERE APPLICATION_NO=? AND POLICYTYPE_COVERID=?
DEL_MOTOR_POL_COVERAGE=DELETE FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND X_ID NOT IN (''{0}'')
GET_MOTOR_POL_COV_COUNT=SELECT COUNT(*) FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND X_ID=?
GET_MOTOR_QUOTE_INFO=SELECT TO_CHAR(MPD.POLICYSTARTDATE, 'dd/mm/yyyy') POLICYSTARTDATE, TO_CHAR(MPD.POLICYENDDATE, 'DD/MM/YYYY') POLICYENDDATE,to_char(MPD.POLICYENDDATE,'DD/MM/YYYY') ||' (' || (trunc(MPD.POLICYENDDATE)-trunc(MPD.POLICYSTARTDATE)) || ' Days)' POLICYENDDATE_PERIOD,MPD.POLICYTYPE,E.PRODUCT_NAME, F.PREMIUM, TO_CHAR (F.ENTRY_DATE, 'dd/mm/yyyy') ENTRY_DATE, F.PAYMENT_MODE, NVL (F.ADMIN_REFERRAL_STATUS, 'N') ADMIN_REFERRAL_YN, F.EXCESS_PREMIUM, F.EXCESS_SIGN, (CASE WHEN (F.STATUS = 'Y') THEN CASE WHEN F.REMARKS IN ('Referal') THEN 'A' ELSE 'Y' END ELSE 'N' END) ADMIN_REFERRAL_STATUS, F.ADMIN_REMARKS, F.LOGIN_ID, F.BROKER_CODE, F.AC_EXECUTIVE_ID, F.CHQ_INV_NO, PI.CUSTOMER_ID, PI.TITLE, NVL (PI.FIRST_NAME, PI.COMPANY_NAME) NAME, PI.MOBILE, PI.EMAIL, PI.ADDRESS1, PI.ADDRESS2, PI.POBOX, PI.EMIRATE, PI.MISSIPPI_CUSTOMER_CODE, PI.CLIENT_CUSTOMER_ID, PI.CUST_AR_NO, PI.LAST_NAME, PI.NRC, PI.PASSPORT_NUMBER, TO_CHAR (PI.DOB, 'DD/MM/YYYY') CUST_DOB, PI.DOB_AR CUST_DOB_AR, PI.ALTERNATE_MOBILE, PI.TELEPHONE, PI.CUSTOMER_TYPE, PI.COMPANY_REG_NO,PI.CUST_NAME_ARABIC FROM PRODUCT_MASTER E, HOME_POSITION_MASTER F, PERSONAL_INFO PI, MOTOR_POLICY_DETAILS MPD WHERE F.APPLICATION_NO=? AND F.PRODUCT_ID=? AND F.BRANCH_CODE=? AND PI.CUSTOMER_ID = F.CUSTOMER_ID AND MPD.APPLICATIONNO=F.APPLICATION_NO AND F.PRODUCT_ID=E.PRODUCT_ID AND F.BRANCH_CODE=E.BRANCH_CODE
#TO_CHAR(A.EXPIRY_DATE,'DD-MON-YYYY HH24:MI:SS')||' ('||POLICY_TERM||' MONTHS)' EXPIRY_DATE 
##GET_MOTOR_PREMIUM_INFO = SELECT GROUP_ID,POLICYTYPE_COVERID,SUM(Case when Currency_id=1 then SUM_INSURED Else USD_SUM_INSURED End) SUM_INSURED,sum(USD_SUM_INSURED) USD_SUM_INSURED,SUM (DECODE (POLICYTYPE_COVERID,'0', ROUND ((NVL (Case when currency_id=1 then RATE Else USD_RATE End, '0')) / (SELECT COUNT (*) FROM MOTOR_POLICY_COVER_DATA MP WHERE     MP.APPLICATION_NO = MPCD.APPLICATION_NO AND MP.GROUP_ID = MPCD.GROUP_ID AND MP.POLICYTYPE_COVERID =MPCD.POLICYTYPE_COVERID),4),Case when currency_id=1 then RATE Else USD_RATE End)) RATE,SUM(Case when currency_id=1 then PREMIUM else PREMIUM End)  PREMIUM,sum(PREMIUM) USD_PREMIUM,OPCOVER_DESC OPCOVER_DESC_ENGLISH,DESCRIPTION,GROUP_DESC GROUP_DESC_ENGLISH FROM MOTOR_POLICY_COVER_DATA MPCD WHERE APPLICATION_NO = ? AND BRANCH_CODE = ? GROUP BY POLICYTYPE_COVERID,DESCRIPTION,OPCOVER_DESC,GROUP_DESC,GROUP_ID ORDER BY CASE WHEN GROUP_ID = 0 THEN 0.1 WHEN GROUP_ID = 101 THEN 0.2 WHEN GROUP_ID = 102 THEN 0.3 ELSE GROUP_ID END
GET_MOTOR_PREMIUM_INFO = SELECT GROUP_ID,POLICYTYPE_COVERID,SUM(SUM_INSURED) SUM_INSURED,SUM(RATE) RATE,SUM(PREMIUM) PREMIUM,OPCOVER_DESC OPCOVER_DESC_ENGLISH,DESCRIPTION,GROUP_DESC GROUP_DESC_ENGLISH FROM  MOTOR_POLICY_COVER_DATA MPCD WHERE APPLICATION_NO=? AND BRANCH_CODE=?  GROUP BY POLICYTYPE_COVERID,DESCRIPTION,OPCOVER_DESC,GROUP_DESC,GROUP_ID ORDER BY POLICYTYPE_COVERID
##GET_MOTOR_MIN_PREMIUM=SELECT NVL(C.MIN_PREMIUM_AMOUNT,0) FROM HOME_POSITION_MASTER A,LOGIN_MASTER B,LOGIN_USER_DETAILS C WHERE  A.APPLICATION_NO=? AND A.PRODUCT_ID=? AND A.LOGIN_ID=B.LOGIN_ID AND B.OA_CODE=C.AGENCY_CODE AND C.PRODUCT_ID=A.PRODUCT_ID
GET_MOTOR_RATE_MODYN=SELECT NVL(PROVISION_FOR_RATE,'N') PROVISION_FOR_RATE FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? AND PRODUCT_ID=?
GET_MOTOR_POL_TYPE_ID=SELECT DISTINCT POLICYSUBTYPE POLICYTYPE_ID FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? and Branch_code=? Order by POLICYSUBTYPE
GET_MOTOR_POL_TYPE=SELECT DISTINCT X_ID,X_DATA_NAME,SUM(RATE) RATE,SUM(BASE_RATE) BASE_RATE, SUM(DATA_VALUE) DATA_VALUE,SUM(MIN_PREMIUM) MIN_PREMIUM FROM MOTOR_POLICY_COVERAGE  WHERE APPLICATION_NO=? AND STATUS='Y' AND GROUP_ID=0 GROUP BY  X_ID,X_DATA_NAME ORDER BY DATA_VALUE Desc
GET_MOTOR_POL_GROUP=SELECT DISTINCT MP.GROUP_ID,GROUP_DESC_ENGLISH,MG.DISPLAY_ORDER FROM MOTOR_POLICY_COVERAGE MP,MOTOR_GROUP_MASTER MG WHERE APPLICATION_NO\=? AND MG.BRANCH_CODE\=? AND MP.STATUS\='Y'  AND MP.GROUP_ID\=MG.GROUP_ID AND MG.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_GROUP_MASTER  WHERE GROUP_ID\=MG.GROUP_ID) Group by MP.GROUP_ID,MG.GROUP_DESC_ENGLISH,MG.DISPLAY_ORDER ORDER BY MG.DISPLAY_ORDER
GET_MOTOR_POLGROUP_REF_CNT = SELECT COUNT(*) FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO\=? AND X_ID\=? AND STATUS\='Y' AND GROUP_ID\=0 AND REFERAL_STATUS\='Y' 
GET_MOTOR_POL_COVERAGE=SELECT DISTINCT Y_DATA_NAME FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND STATUS='Y' AND GROUP_ID=?
GET_MOTOR_POL_COVERAGE_DTLS=SELECT Y_ID,DESCRIPTION, SUM(DATA_VALUE) DATA_VALUE,IS_SELECTED,IS_ADDON,DELETABLE FROM MOTOR_POLICY_COVERAGE MPC WHERE     STATUS = 'Y' AND APPLICATION_NO = ? AND GROUP_ID = ? AND X_ID = ? AND Y_DATA_NAME = ? GROUP BY Y_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE
GET_MOTOR_RATES=SELECT NVL(RATE_ONE, 0) RATE_ONE,NVL(RATE_TWO, 0) RATE_TWO,NVL(RATE_THREE, 0) RATE_THREE,NVL(RATE_FOUR, 0) RATE_FOUR,MP.PROVISION_FOR_RATE FROM LOGIN_USER_DETAILS LUD, MOTOR_BROKER_POLICYTYPE_MASTER MP WHERE LUD.PRODUCT_ID = ? AND LUD.LOGIN_ID = (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE UPPER (USERTYPE) = 'BROKER' AND OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = ?)) AND LUD.PRODUCT_ID = MP.PRODUCT_ID AND MP.BRANCH_CODE = ? AND MP.POLICYTYPE_IDS=? AND MP.BROKER_ID=LUD.LOGIN_ID
UPD_MOTOR_DATA_DTLS_OPT_COVPOLTYPE=UPDATE MOTOR_DATA_DETAIL SET POLICYTYPE=?,OPTIONAL_COVER=? WHERE APPLICATION_NO=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?)
DEL_MOTOR_POL_COV_DATA=DELETE FROM MOTOR_POLICY_COVER_DATA WHERE APPLICATION_NO=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DATA WHERE APPLICATION_NO=?)
GET_MOTOR_POL_COV_DTL_POLCOVID_CLCTYPE=SELECT POLICYCOVER_ID,CALC_TYPE FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=?)
INS_AMD_MOTOR_POL_COV_DATA=INSERT INTO MOTOR_POLICY_COVER_DATA (APPLICATION_NO,QUOTE_NO,POLICYTYPE_COVERID,SUM_INSURED,RATE,PREMIUM,STATUS,AMEND_ID,BRANCH_CODE)(SELECT ?,?,?,?,{0},{1},''Y'',0,? FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=?))
INS_MOTOR_POL_COV_DATA=INSERT INTO MOTOR_POLICY_COVER_DATA (APPLICATION_NO,QUOTE_NO,POLICYTYPE_COVERID,SUM_INSURED,RATE,PREMIUM,STATUS,AMEND_ID,BRANCH_CODE) VALUES(?,?,?,?,?,?,?,?,?)
UPD_MOTOR_REF_STATUS=UPDATE HOME_POSITION_MASTER SET EFFECTIVE_DATE=SYSDATE+30,REMARKS=?,SUMMARY_REMARKS= ?,ADMIN_REFERRAL_STATUS = ?, REFERRAL_DESCRIPTION = ?,PREMIUM=?,POLICY_FEE=?,OVERALL_PREMIUM=?,COMMISSION=? WHERE QUOTE_NO = ?
UPD_MOTOR_HOME_POS_MASTER_MODEOFPAY=UPDATE HOME_POSITION_MASTER SET SUMMARY_CLAUSES=?,AIRMILES_NO=?, INSURANCE_DETAILS=?,PAYMENT_MODE=?,CSH_ID_TYP_CODE=?,PREMIUM=?,POLICY_FEE=?,OVERALL_PREMIUM=?,COMMISSION=?,EFFECTIVE_DATE=SYSDATE+30,STATUS=?,CHQ_INV_NO=? WHERE QUOTE_NO=?
UPD_MOTOR_POLICY_COVER_RATEPR=Update Motor_Policy_Cover_Data Pca Set Pca.Rate=?, Pca.Premium=(Nvl(Pca.Sum_Insured,'1') * (Case When (Pca.Group_Id='0' Or Pca.Group_Id>100) And (Select Isselectcover From Motor_Policy_Details Where Applicationno=Pca.Application_No)!=? Then ?/100 Else ? End)) Where Pca.Application_No=? And Pca.Policytype_Coverid=? And  Branch_Code=? And Pca.Amend_Id=(Select Max(Amend_Id) From  Motor_Policy_Cover_Data Where Policytype_Coverid=Pca.Policytype_Coverid And Application_No=Pca.Application_No And Branch_Code=Pca.Branch_Code And Group_Id=Pca.Group_Id)
GET_MOTOR_MAKE_REF_STATUS=SELECT NVL(REFERRAL_STATUS,'N') REF_STATUS FROM MOTOR_MAKE_MASTER WHERE MAKE_ID=? AND BRANCH_CODE=? AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_MAKE_MASTER WHERE MAKE_ID=? AND BRANCH_CODE=?)
GET_MOTOR_MODEL_REF_STATUS=SELECT NVL(REFERRAL_STATUS,'N') REF_STATUS FROM MOTOR_MODEL_MASTER WHERE MODEL_ID=? AND MAKE_ID=? AND BRANCH_CODE=? AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_MODEL_MASTER WHERE MODEL_ID=? AND MAKE_ID=? AND BRANCH_CODE=?)
GET_MOTOR_TYPE_BODY_CNT=SELECT COUNT(*) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=''Y'' AND (AGENCY_CODE IN (''{0}'',''None'') OR AGENCY_CODE IS NULL)
GET_SI_LIMIT=SELECT  NVL(LUD.INSURANCE_END_LIMIT,0) INSURANCE_END_LIMIT FROM LOGIN_USER_DETAILS LUD WHERE AGENCY_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE   LOGIN_ID = ?) AND PRODUCT_ID = ? AND LUD.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   LOGIN_USER_DETAILS WHERE LOGIN_ID = LUD.LOGIN_ID AND PRODUCT_ID = LUD.PRODUCT_ID)
GET_SI_LIMIT_APPNO=SELECT  NVL(LUD.INSURANCE_END_LIMIT,0) INSURANCE_END_LIMIT FROM LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM,HOME_POSITION_MASTER HPM WHERE   LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID=HPM.LOGIN_ID AND HPM.APPLICATION_NO =? AND LUD.PRODUCT_ID = HPM.PRODUCT_ID AND HPM.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?) AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE PRODUCT_ID=LUD.PRODUCT_ID AND LOGIN_ID=LUD.LOGIN_ID)
GET_MOTOR_CUST_INFO=SELECT PI.TITLE,NVL (PI.COMPANY_NAME, PI.FIRST_NAME) NAME,PI.CUST_NAME_ARABIC,PI.EMAIL,PI.POBOX,PI.MOBILE,PI.EMIRATE,PI.CUSTOMER_ID,PI.MISSIPPI_CUSTOMER_CODE,PI.CLIENT_CUSTOMER_ID,PI.ADDRESS1,PI.ADDRESS2,PI.CUST_AR_NO,PI.CUSTOMER_TYPE,PI.COMPANY_REG_NO FROM PERSONAL_INFO PI  WHERE PI.CUSTOMER_ID=? AND PI.APPLICATION_ID = '1' AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID AND APPLICATION_ID=PI.APPLICATION_ID)
GET_MOTOR_COV_PRE_SUM=SELECT SUM(NVL (A.PREMIUM, '0')) PREMIUM FROM  MOTOR_POLICY_COVER_DATA A WHERE APPLICATION_NO =?  AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_POLICY_COVER_DATA WHERE QUOTE_NO = A.QUOTE_NO)
UPD_MOTOR_PRE=UPDATE HOME_POSITION_MASTER SET PREMIUM=?,POLICY_FEE=?,EXCESS_SIGN=?,EXCESS_PREMIUM=?,OVERALL_PREMIUM=?,TRAN_ID=? WHERE APPLICATION_NO=?
GET_MOTOR_HELP_LIST = SELECT HELP_ID, DESCRIPTION, REMARKS FROM MOTOR_HELP_MASTER WHERE HELP_TYPE=? AND STATUS='Y' AND BRANCH_CODE=? ORDER BY DISPLAY_ORDER ASC
##UPD_MOTOR_ADDVEHICLE_DTLS = UPDATE MOTOR_DATA_DETAIL SET VEHICLE_COLOR\=?,LEASED\=?,BANK_ID\=?,REGISTRATION_NO\=?,CHASSIS_NO\=?,ENGINE_NUMBER\=?,INSURED_NAME_ARABIC\=?,INSURED_ADDRESS_ARABIC\=?,REGISTER_LOCATION\=?,PLATE_COLOR\=?,DRIVER_ID\=?,PREV_POLICYNO\=?,PREV_POLICYEXPIRYDATE\=TO_DATE(?,'DD/MM/YYYY'),INS_COMPANY\=? WHERE APPLICATION_NO\=? AND VEHICLE_ID\=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO\=?)
UPD_MOTOR_ADDVEHICLE_DTLS = UPDATE MOTOR_DATA_DETAIL SET VEHICLE_COLOR=?,LEASED=?,BANK_ID=?,REGISTRATION_NO=?,CHASSIS_NO=?,ENGINE_NUMBER=?,INSURED_NAME_ARABIC=?,INSURED_ADDRESS_ARABIC=?,REGISTER_LOCATION=?,PLATE_COLOR=?,REGISTRATION_YEAR=? WHERE APPLICATION_NO=? AND VEHICLE_ID=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?)
GET_MOTOR_MULTI_DATA_DETAILS = select * from table(Motor_Vehicle_Data_Details(?,?,?))
GET_MOTOR_DTL_VEHICLEID = SELECT NVL (MAX (VEHICLE_ID), 0)+1 FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?
DEL_MOTOR_VEHICLE_DETAILS_ALL = DELETE FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?
DEL_MOTOR_VEHICLE_DETAILS = DELETE FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=? AND VEHICLE_ID=?
CAL_MOTOR_PREMIUM_CALC = CALL Motor_Premium_calc(?,?,?,?,?)
UPD_MOTOR_SIREFERRAL_DTLS = UPDATE MOTOR_DATA_DETAIL SET REFERRAL_REMARKS=DECODE(REFERRAL_REMARKS,'','Sum Insured Limit Referral',REFERRAL_REMARKS||'~Sum Insured Limit Referral') WHERE SUMINSURED_VALUE_LOCAL>(Select Nvl(Insurance_End_Limit,0) From Login_User_Details Where Login_Id = (Select Login_Id From Login_Master Where Agency_Code=(Select Oa_Code From Login_Master Where Login_Id=?)) And Product_Id=?) AND APPLICATION_NO=?
GET_MOTOR_REFERRALMSGS = SELECT TO_CHAR(WM_CONCAT('Vehicle '||VEHICLE_ID||'-'||REFERRAL_REMARKS)) REFERRAL_REMARKS FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=? AND REFERRAL_REMARKS IS NOT NULL
GET_USER_MOTOR_CUSTOMER_DETAILS = SELECT   PI.TITLE,NVL (PI.COMPANY_NAME, PI.FIRST_NAME) NAME,PI.EMAIL,PI.POBOX,PI.MOBILE,PI.EMIRATE,PI.MISSIPPI_CUSTOMER_CODE,PI.CLIENT_CUSTOMER_ID,PI.ADDRESS1,PI.ADDRESS2,PI.CUST_AR_NO,PI.CUSTOMER_TYPE,PI.COMPANY_REG_NO FROM   PERSONAL_INFO PI WHERE   PI.LOGIN_ID = ? AND PI.CUSTOMER_ID = (SELECT   MIN (CUSTOMER_ID) FROM   PERSONAL_INFO WHERE   LOGIN_ID = PI.LOGIN_ID)
GET_MOTOR_POLICY_REFERRALMSGS=SELECT REFERRAL_REMARKS FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO=?
##INS_MOTOR_POLICY_DETAILS = INSERT INTO MOTOR_POLICY_DETAILS (APPLICATIONNO,QUOTENO,POLICYTYPE,POLICYSTARTDATE,POLICYENDDATE,CURRENCY_TYPE) VALUES (?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),?)
INS_MOTOR_POLICY_DETAILS = INSERT INTO MOTOR_POLICY_DETAILS (APPLICATIONNO,QUOTENO,POLICYTYPE,POLICYSTARTDATE,POLICYENDDATE) VALUES (?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'))
CNT_MOTOR_POLICY_DETAILS = SELECT COUNT(*) FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO=?
UPD_MOTOR_POLICY_DETAILS = UPDATE MOTOR_POLICY_DETAILS SET POLICYSTARTDATE=TO_DATE(?,'DD/MM/YYYY'),POLICYENDDATE=TO_DATE(?,'DD/MM/YYYY'),POLICYTYPE=? WHERE APPLICATIONNO=?
GET_MOTOR_POLICY_DETAILS = SELECT APPLICATIONNO, QUOTENO, POLICYTYPE, ISSELECTCOVER, OPTIONAL_COVER, TO_CHAR(POLICYSTARTDATE, 'DD/MM/YYYY') POLICYSTARTDATE, TO_CHAR(POLICYENDDATE, 'DD/MM/YYYY') POLICYENDDATE, PREMIUM FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO=?
UPD_MOTOR_POLICY_DTLS_OPT_COVPOLTYPE = UPDATE MOTOR_POLICY_DETAILS SET ISSELECTCOVER=?,OPTIONAL_COVER=?,REFERRAL_REMARKS=? WHERE APPLICATIONNO=?
GET_MOTOR_THIRDPARTY_PREMIUMINFO = SELECT DISTINCT X_ID,X_DATA_NAME,SUM(RATE) RATE,SUM(BASE_RATE) BASE_RATE,SUM(DATA_VALUE) DATA_VALUE,SUM(MIN_PREMIUM) MIN_PREMIUM FROM MOTOR_POLICY_COVERAGE  WHERE APPLICATION_NO=? AND STATUS='Y' AND GROUP_ID=0 AND X_ID=? GROUP BY  X_ID,X_DATA_NAME ORDER BY DATA_VALUE Desc
INS_MOTOR_DOCUMENTS = INSERT INTO MOTOR_VEHICLE_DOCUMENTS (APPLIATION_NO,QUOTE_NO,VEHICLE_ID,DOCUMENT_ID,DOCUMENT_PATH) VALUES (?,?,?,?,?)
DEL_MOTOR_DOCUMENTS = DELETE FROM MOTOR_VEHICLE_DOCUMENTS WHERE APPLIATION_NO=? AND VEHICLE_ID=? AND DOCUMENT_ID=?
GET_MOTOR_DOCUMENTS = SELECT DOCUMENT_ID,DOCUMENT_PATH FROM MOTOR_VEHICLE_DOCUMENTS WHERE APPLIATION_NO=? AND VEHICLE_ID=?
GET_MOTOR_VEHICLEDOCUMENTS_VAL = SELECT (SELECT COUNT(*) FROM MOTOR_DOCUMENT_MASTER MDM WHERE MDM.POLICY_TYPE LIKE (SELECT '%,'||ISSELECTCOVER||',%' FROM MOTOR_POLICY_DETAILS MPD WHERE MPD.APPLICATIONNO=?) AND MDM.STATUS='Y' AND MDM.MANDATORY_STATUS='Y') DOCUMENT_COUNT, (SELECT COUNT(*) FROM MOTOR_VEHICLE_DOCUMENTS MVD WHERE MVD.APPLIATION_NO=? AND MVD.VEHICLE_ID=? AND MVD.DOCUMENT_ID IN (SELECT MDM.DOCUMENT_ID FROM MOTOR_DOCUMENT_MASTER MDM WHERE POLICY_TYPE LIKE (SELECT '%,'||ISSELECTCOVER||',%' FROM MOTOR_POLICY_DETAILS MPD WHERE MPD.APPLICATIONNO=?) AND STATUS='Y' AND MANDATORY_STATUS='Y')) VEHICLE_DOCUMENT_COUNT FROM DUAL
GET_MOTOR_DOCUMENTS_LIST = SELECT DOCUMENT_ID,DOCUMENT_DESC,MANDATORY_STATUS FROM MOTOR_DOCUMENT_MASTER WHERE POLICY_TYPE LIKE (SELECT '%,'||ISSELECTCOVER||',%' FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO=?) AND STATUS='Y' ORDER BY DISPLAY_ORDER
GET_MOTOR_SELECTED_POLICY = SELECT ISSELECTCOVER FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO=?
GET_MOTOR_POLICYTYPE_PAYMENTYN = Select Payment_Yn From Motor_Policytype_Master Where Policy_Subtype_Id=(Select Isselectcover From Motor_Policy_Details Where Applicationno=?)
VALIDATE_MOTOR_VEHICLE_TYPE = SELECT NVL((SELECT DISTINCT VEHICLE_TYPE  FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO\=? AND VEHICLE_ID\!\=?),?) VEHICLE_TYPE_ID FROM DUAL 
GET_VEHICLETYPE_DETAILS = Select MMM.Make_id,MMM.Make_Name,MMD.Model_id,MMD.Model_name,MMD.Body_id, (Select BODY_NAME From Motor_Bodytype_master Mdm Where Mdm.Body_id=MMD.Body_id And mdm.status='Y' and trunc(Mdm.effective_date)<Trunc(Sysdate) And mdm.amend_id=(Select Max(amend_id) from Motor_Bodytype_master Mb Where mdm.body_id=Mb.BODY_ID and trunc(mdm.effective_date)=Trunc(Mb.effective_date))) BodyName,mbb.vtype_id, (Select VEHICLETYPE_DESC From Motor_vehicletype_master mvm Where mvm.VTYPE_ID=mbb.vtype_id and mvm.status='Y' and trunc(mvm.effective_date)<Trunc(Sysdate) and mvm.Amend_id=(Select max(Amend_id) from Motor_vehicletype_master mv where mvm.vtype_id=mv.vtype_id and trunc(mvm.effective_date)=trunc(mv.effective_date))) vtype_name From Motor_make_master MMM,Motor_Model_master MM, MOTOR_MODEL_DETAIL MMD,Motor_bodytype_detail mbb Where MMM.make_id=MM.Make_id and MMD.Model_id=MM.Model_id and mbb.body_id=MMD.Body_id and MMM.Amend_id=(Select max(amend_id) from Motor_make_master MM where MM.make_id=MMM.MAKE_ID and MM.branch_code=MMM.branch_code and trunc(MMM.effective_date)=Trunc(MM.effective_date)) and MM.Amend_id=(Select Max(Amend_id) from Motor_Model_master M where M.model_id=mm.model_id and M.branch_code=MM.branch_code and trunc(MM.effective_date)=Trunc(M.effective_date)) and MMM.status='Y' and MM.status='Y' and Trunc(MMM.effective_date) < trunc(sysdate) and Trunc(MM.effective_date) < trunc(sysdate) and MMM.make_id=? and MM.Model_id=? and MMM.Branch_code=? and mmm.branch_code=MM.branch_Code


###Motor User Registration - Start
INS_USERREG_PERSONAL_INFO = insert into personal_info(customer_id,application_id,title,first_name,last_name,amend_id,nationality,dob,gender,telephone,mobile,fax,email,address1,address2,occupation,pobox,country,emirate,status,entry_date,login_id,AGENCY_CODE,OA_CODE,city,fd_code)values(?,?,?,?,?,?,?, to_date(?,'dd/mm/yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,?,?)
INS_USERREG_LOGIN_MASTER = insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,ACCESSTYPE,RIGHTS,LPASS1,LPASS2,LPASS3,PASSDATE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,REFERAL, APP_ID, PWD_COUNT, USER_MAIL, branch_code, COUNTRY_ID) values(?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,?,?,?,'16','0',?,?,?)
GET_USERREG_COMMISSION = select pm.product_name uproductName, pm.product_id uproductId, lud.SPECIAL_DISCOUNT specialDis, lud.FREIGHT_DEBIT_OPTION freight, lud.INSURANCE_END_LIMIT insEndLimit, lud.pay_receipt_status receipt, lud.open_cover_no, decode(lud.login_id,null,'N','Y') product from PRODUCT_MASTER pm left outer join LOGIN_USER_DETAILS lud on PM.PRODUCT_ID = LUD.PRODUCT_ID and LUD.AGENCY_CODE = ? and LUD.OA_CODE = ? where PM.BRANCH_CODE = (SELECT BELONGING_BRANCH FROM BRANCH_MASTER WHERE BRANCH_CODE=?)
GET_BROKER_USERREG_DETAILS=select pi.TITLE,pi.GENDER,pi.FIRST_NAME,pi.LAST_NAME,(select NATIONALITY_NAME from COUNTRY_MASTER where amend_id||country_id in( select max(amend_id)||country_id from country_master group by country_id) and COUNTRY_ID=pi.nationality) nationality_name, pi.NATIONALITY, to_char(pi.DOB,'dd/mm/yyyy') DOB,pi.TELEPHONE,pi.MOBILE,pi.FAX,pi.EMAIL,pi.ADDRESS1,pi.ADDRESS2,pi.OCCUPATION,pi.EMIRATE,pi.COUNTRY,(select COUNTRY_NAME from country_master where COUNTRY_ID=pi.COUNTRY and AMEND_ID=(SELECT max(AMEND_ID) FROM country_master WHERE COUNTRY_ID=pi.COUNTRY)) country_name,pi.POBOX,lm.agency_code,pi.entry_date,pi.status,pi.city,lm.BRANCH_CODE,lm.login_id,(select COMPANY_NAME from broker_company_master where AGENCY_CODE=lm.OA_CODE) bname, lm.usertype, PI.CUST_NAME,PI.CUST_AR_NO,pi.customer_id, (select distinct(USERNAME) from login_master where  AGENCY_CODE=lm.OA_CODE)borganization, lm.OA_CODE from personal_info pi, login_master lm where pi.agency_code=lm.agency_code and pi.LOGIN_ID=lm.LOGIN_ID and  pi.agency_code=? and PI.AMEND_ID=(select max(amend_id) from personal_info where pi.agency_code = lm.agency_code)
UPD_USER_APPLICATIONS = UPDATE HOME_POSITION_MASTER SET LOGIN_ID=? WHERE APPLICATION_NO=?
GET_USER_OA_CODE = SELECT RSACODE FROM CONSTANT_DETAIL WHERE CATEGORY_ID='154' AND CATEGORY_DETAIL_ID='1' AND BRANCH_CODE=?
UPD_B2CUSER_PERSONAL_INFO = update personal_info set title=?, first_name=?, last_name=?, nationality=?, dob=to_date(?,'dd/mm/yyyy'), gender=?, telephone=?, mobile=?, fax=?, email=?, address1=?, address2=?, occupation=?, pobox=?, country=?, emirate=?, status=?, city=? where agency_code=?
UPD_B2CUSER_LOGIN_MASTER = update login_master set USERNAME=?, STATUS=?, USER_MAIL=? where AGENCY_CODE=?
UPD_CUSTOMER_ID_MOTOR_DATA_DETAILS = update MOTOR_DATA_DETAIL set CUSTOMER_ID=? where APPLICATION_NO =?
GET_MOTOR_NEW_USER_CUST_ID = SELECT CUSTOMER_ID FROM HOME_POSITION_MASTER HPM  WHERE HPM.APPLICATION_NO \=?
MOTOR_USER_VALIDATE_MOBILE = SELECT COUNT(*) FROM PERSONAL_INFO WHERE MOBILE=?
##MOTOR_USER_VALIDATE_MAIL = SELECT COUNT(*) FROM PERSONAL_INFO WHERE EMAIL=?
MOTOR_NEW_USER_EXIST_CUS_INFO = SELECT PI.CUSTOMER_ID,PI.APPLICATION_ID,PI.TITLE,PI.FIRST_NAME,PI.LAST_NAME,PI.NATIONALITY,TO_CHAR(PI.DOB,'DD/MM/YYYY') DOB,PI.GENDER,PI.TELEPHONE,PI.MOBILE,PI.FAX,PI.EMAIL,PI.ADDRESS1,PI.ADDRESS2,PI.OCCUPATION,PI.POBOX,pi.COUNTRY,pi.LOGIN_ID,pi.COMPANY_NAME,PI.CITY FROM   PERSONAL_INFO PI ,home_position_master HPM WHERE   PI.CUSTOMER_ID = HPM.CUSTOMER_ID AND HPM.APPLICATION_NO =?
MOTOR_NEW_USER_CUS_UPD = UPDATE PERSONAL_INFO SET TITLE =?,FIRST_NAME=?,LAST_NAME=?,GENDER=?,DOB=TO_DATE(?,'DD/MM/YYYY'),OCCUPATION=?,ADDRESS1=?,ADDRESS2=?,POBOX=?,CITY=?,EMIRATE=?,COUNTRY=?,TELEPHONE=?,MOBILE=?,EMAIL=?,LOGIN_ID=?,AGENCY_CODE=?,OA_CODE=? Where customer_id=(Select Customer_id from HOME_POSITION_MASTER HPM  Where HPM .APPLICATION_NO =?)
SELECT_MOTOR_EXIT_USER_PER = SELECT PI.LAST_NAME,PI.NATIONALITY,TO_CHAR(PI.DOB,'DD/MM/YYYY')DOB,PI.GENDER,PI.TELEPHONE,PI.MOBILE,PI.FAX,PI.EMAIL,PI.ADDRESS1,PI.ADDRESS2,PI.OCCUPATION,PI.POBOX,PI.COUNTRY,PI.EMIRATE,PI.LOGIN_ID,PI.AGENCY_CODE,PI.OA_CODE,PI.COMPANY_NAME,PI.CITY,PI.CUST_NAME,PI.PASSPORT_NUMBER FROM personal_info pi, login_master lm WHERE pi.agency_code = lm.agency_code AND pi.LOGIN_ID = ? and PI.AMEND_ID=(select max(amend_id) from personal_info where pi.agency_code = lm.agency_code)
MOTOR_EXIT_USER_PER_UPD = UPDATE PERSONAL_INFO SET LAST_NAME=?,NATIONALITY=?,DOB=TO_DATE(?,'DD/MM/YYYY'),GENDER=?,TELEPHONE=?,MOBILE=?,FAX=?,EMAIL=?,ADDRESS1=?,ADDRESS2=?,OCCUPATION=?,POBOX=?,COUNTRY=?,EMIRATE=?,LOGIN_ID=?,AGENCY_CODE=?,OA_CODE=?,COMPANY_NAME=?,CITY=?,CUST_NAME=?,PASSPORT_NUMBER=? WHERE CUSTOMER_ID=(SELECT CUSTOMER_ID FROM HOME_POSITION_MASTER HPM  WHERE HPM .APPLICATION_NO =?)
GET_USER_EMAIL_COUNT = SELECT COUNT (*) FROM   LOGIN_MASTER LM, PERSONAL_INFO PI WHERE LM.LOGIN_ID\=(select PI1.EMAIL FROM PERSONAL_INFO PI1, HOME_POSITION_MASTER HPM WHERE  HPM.APPLICATION_NO \=? AND PI1.CUSTOMER_ID\=HPM.CUSTOMER_ID) AND pi.agency_code \= lm.agency_code AND pi.LOGIN_ID \= lm.LOGIN_ID AND APPLICATION_ID \!\='1' 
GET_CUSTOMER_DETAILS_ON_EMAIL = SELECT  PI.CUSTOMER_ID,PI.APPLICATION_ID,PI.TITLE,PI.FIRST_NAME,PI.LAST_NAME,PI.NATIONALITY,TO_CHAR (PI.DOB, 'DD/MM/YYYY') DOB,PI.GENDER,PI.TELEPHONE,PI.MOBILE,PI.FAX,PI.EMAIL,PI.ADDRESS1,PI.ADDRESS2,PI.OCCUPATION,PI.POBOX,pi.COUNTRY,pi.LOGIN_ID,pi.COMPANY_NAME,PI.CITY FROM LOGIN_MASTER LM, PERSONAL_INFO PI WHERE LM.LOGIN_ID=(select PI1.EMAIL FROM PERSONAL_INFO PI1, HOME_POSITION_MASTER HPM WHERE  HPM.APPLICATION_NO =? AND PI1.CUSTOMER_ID=HPM.CUSTOMER_ID) AND pi.agency_code = lm.agency_code AND pi.LOGIN_ID = lm.LOGIN_ID AND APPLICATION_ID !='1'
CNT_OFS_DATA = SELECT COUNT(*) FROM OFS_DATA WHERE QUOTE_NO=?
INS_OFS_DATA = INSERT INTO OFS_DATA(QUOTE_NO,AMEND_ID,CUSTOMER_ID,INSURED_ADDRESS_DIFFERENT,ADDRESS1,POBOX,COUNTRY,EMIRATE,FREEZONE,CONTENT_VALUE,CONTENT_VALUE_OTHERS,CLAIM_STATUS,LAST_YEARS_1,LAST_YEARS_2,LAST_YEARS_3,AMOUNT_1,AMOUNT_2,AMOUNT_3,INCEPTION_DATE,ENTRY_DATE,APPLICATION_NO,STATUS,ACTIVITY_PROFESSION,ACTIVITY_STATUS,EXPIRY_DATE,PROF_OTHERS,FREEZONE_OTHERS,CONTENT_STATUS,NO_OF_CLAIM1,NO_OF_CLAIM2,NO_OF_CLAIM3,TELEPHONE,EMAIL,PACOVER_YN,TRACTER_YN) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(sysdate,'dd-mm-yyyy hh24:mi:ss'),sysdate,?,?,?,?,(add_months(to_date(sysdate),12)-1),?,?,?,?,?,?,?,?,?,?)
UPD_OFS_DATA = UPDATE OFS_DATA SET AMEND_ID=?, CUSTOMER_ID=?, INSURED_ADDRESS_DIFFERENT=?, ADDRESS1=?, POBOX=?, COUNTRY=?, EMIRATE=?, FREEZONE=?, CONTENT_VALUE=?, CONTENT_VALUE_OTHERS=?, CLAIM_STATUS=?, LAST_YEARS_1=?, LAST_YEARS_2=?, LAST_YEARS_3=?, AMOUNT_1=?, AMOUNT_2=?, AMOUNT_3=?,  INCEPTION_DATE=TO_DATE (SYSDATE, 'dd-mm-yyyy hh24:mi:ss'), ENTRY_DATE=SYSDATE,  APPLICATION_NO=?, STATUS=?, ACTIVITY_PROFESSION=?, ACTIVITY_STATUS=?, EXPIRY_DATE= (ADD_MONTHS (TO_DATE (SYSDATE), 12) - 1), PROF_OTHERS=?, FREEZONE_OTHERS=?, CONTENT_STATUS=?, NO_OF_CLAIM1=?, NO_OF_CLAIM2=?, NO_OF_CLAIM3=?, TELEPHONE=?, EMAIL=?, PACOVER_YN=?,TRACTER_YN=? WHERE QUOTE_NO=?
CNT_HOME_DTL = SELECT COUNT(*) FROM HOME_POSITION_MASTER WHERE QUOTE_NO=?
INS_HOME_DTL=INSERT INTO HOME_POSITION_MASTER (QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,COMPANY_ID,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,APPLICATION_NO,STATUS,SCHEME_ID,CONTENT_TYPE_ID,APPLICATION_ID) values(?,?,?,?,?,?,sysdate,(add_months(sysdate,12)-1),sysdate+30,sysdate,?,?,?,?,?)
UPD_HOME_DTL=UPDATE HOME_POSITION_MASTER SET CUSTOMER_ID=?, LOGIN_ID=?, PRODUCT_ID=?, COMPANY_ID=?, AMEND_ID=?, INCEPTION_DATE=SYSDATE, EXPIRY_DATE=(ADD_MONTHS (SYSDATE, 12) - 1), EFFECTIVE_DATE=SYSDATE + 30, ENTRY_DATE=SYSDATE, APPLICATION_NO=?, STATUS=?, SCHEME_ID=?, CONTENT_TYPE_ID=? WHERE QUOTE_NO=?
GET_OFS_DATA = SELECT CUSTOMER_ID,PACOVER_YN,TRACTER_YN FROM OFS_DATA WHERE QUOTE_NO=?
GET_HOME_INFO=SELECT distinct(d.CALC_TYPE) GRID_CALC_TYPE, b.CALC_TYPE, a.coverages_id,a.coverages_name,b.coverages_type,a.coverages_display_name,b.display_order,b.MULTIPLE_ROWS,b.sub_coverages,b.control_type, b.CALC_STATUS, c.coverages_suminsured SUM_INSURED,trim(to_char(nvl(c.coverages_suminsured,0),'999G999G999G999G999G999G999G999G999G990')) COVERAGES_SUMINSURED, NVL(c.coverages_base_rate,b.BASE_RATE) coverages_base_rate, b.BASE_RATE, b.help_contents_id,c.coverages_y_n_option, b.calc_status,  b.sum_insured_limit,  b.sum_insured_control_type,b.coverages_limit, c.PREMIUM_AMOUNT, d.amend_id, b.UPLOAD_OPTION FROM  OFS_MASTER a JOIN OFS_COVERAGES_MASTER b ON a.COVERAGES_ID = b.COVERAGES_ID AND b.CONTENT_TYPE_ID = ? LEFT OUTER JOIN OFS_DATA_DETAILS c  ON b.content_type_id = c.content_type_id AND a.COVERAGES_ID = c.COVERAGES_ID AND b.scheme_id = c.scheme_id AND b.product_id = c.product_id AND c.quote_no = NVL (?, 0) LEFT OUTER JOIN OFS_GRID_MASTER d ON b.content_type_id = d.content_type_id AND b.COVERAGES_ID = d.COVERAGES_ID AND b.scheme_id = d.scheme_id AND coverages_sub_id='0' and d.status='Y' AND b.product_id = d.product_id AND d.amend_id || d.coverages_id || d.coverages_sub_id IN (SELECT MAX (amend_id) || coverages_id || coverages_sub_id FROM OFS_GRID_MASTER WHERE CONTENT_TYPE_ID = ? AND product_id = ? AND scheme_id = ? AND coverages_sub_id='0' and status='Y' GROUP BY coverages_id, coverages_sub_id) WHERE   b.product_id =? AND b.scheme_id = ? AND b.status = 'Y' AND B.CONTENT_TYPE_ID = ? AND b.amend_id = (SELECT MAX (amend_id) FROM OFS_COVERAGES_MASTER WHERE product_id = ? AND scheme_id = ? AND CONTENT_TYPE_ID =? AND coverages_id = b.coverages_id) order by display_order ASC,COVERAGES_ID ASC
GET_UPLOAD_LIST=SELECT distinct(d.CALC_TYPE) GRID_CALC_TYPE, b.CALC_TYPE, a.coverages_id,a.coverages_name,b.coverages_type,a.coverages_display_name,b.display_order,b.MULTIPLE_ROWS,b.sub_coverages,b.control_type, b.CALC_STATUS, c.coverages_suminsured SUM_INSURED,NVL(c.coverages_base_rate,b.BASE_RATE) coverages_base_rate, b.BASE_RATE, b.help_contents_id,c.coverages_y_n_option, b.calc_status,  b.sum_insured_limit,  b.sum_insured_control_type,b.coverages_limit, c.PREMIUM_AMOUNT, d.amend_id, b.UPLOAD_OPTION FROM  OFS_MASTER a JOIN OFS_COVERAGES_MASTER b ON a.COVERAGES_ID = b.COVERAGES_ID AND b.CONTENT_TYPE_ID = ? LEFT OUTER JOIN OFS_DATA_DETAILS c  ON b.content_type_id = c.content_type_id AND a.COVERAGES_ID = c.COVERAGES_ID AND b.scheme_id = c.scheme_id AND b.product_id = c.product_id AND c.quote_no = NVL (?, 0) LEFT OUTER JOIN OFS_GRID_MASTER d ON b.content_type_id = d.content_type_id AND b.COVERAGES_ID = d.COVERAGES_ID AND b.scheme_id = d.scheme_id AND coverages_sub_id='0' and d.status='Y' AND b.product_id = d.product_id AND d.amend_id || d.coverages_id || d.coverages_sub_id IN (SELECT MAX (amend_id) || coverages_id || coverages_sub_id FROM OFS_GRID_MASTER WHERE CONTENT_TYPE_ID = ? AND product_id = ? AND scheme_id = ? AND coverages_sub_id='0' and status='Y' GROUP BY coverages_id, coverages_sub_id) WHERE   b.product_id =? AND b.scheme_id = ? AND b.status = 'Y' AND B.CONTENT_TYPE_ID = ? AND b.amend_id = (SELECT MAX (amend_id) FROM OFS_COVERAGES_MASTER WHERE product_id = ? AND scheme_id = ? AND CONTENT_TYPE_ID =? AND coverages_id = b.coverages_id) AND b.UPLOAD_OPTION = 'Y' and c.coverages_suminsured is not null order by COVERAGES_TYPE,display_order
GET_SUB_UPLOADCOVER_LIST = SELECT ofm.coverages_name, ofm.COVERAGES_DISPLAY_NAME,ofd.quote_no,ofd.coverages_id,ofd.coverages_sub_id,ofd.premium_amount,ofd.coverages_covered_employees, ofd.coverages_sub_base_rate, ofsm.SUB_COVERAGES_LIMIT, ofsm.SUB_RATE, ofsm.SUB_CONTROL_TYPE, ofsm.CALC_TYPE, ofsm.SUM_INSURED_LIMIT, ofsm.MIN_SUM_INSURED, ofsm.SUB_NEWCONTROL_TYPE, ofgm.CALC_TYPE grid_calc_type, ofsm.MULTIPLE_ROWS, ofsm.UPLOAD_OPTION, ofsm.AMEND_ID FROM ofs_data_sub_details ofd JOIN ofs_master ofm ON ofd.coverages_sub_id \= ofm.coverages_id JOIN ofs_coverages_sub_master ofsm ON ofd.coverages_id \= ofsm.coverages_id AND ofd.COVERAGES_SUB_ID \= ofsm.COVERAGES_SUB_ID AND ofd.SCHEME_ID \= ofsm.SCHEME_ID AND ofd.CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID AND ofsm.UPLOAD_OPTION \= 'Y' AND ofsm.amend_id \= (SELECT MAX (amend_id) FROM ofs_coverages_sub_master WHERE coverages_id \= ofsm.coverages_id AND COVERAGES_SUB_ID \= ofsm.COVERAGES_SUB_ID AND SCHEME_ID \= ofsm.SCHEME_ID AND CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID) AND ofd.quote_no\= ? AND ofd.amend_id \= (SELECT MAX (amend_id) FROM ofs_data_sub_details WHERE quote_no \= ofd.quote_no AND COVERAGES_SUB_ID \= ofd.COVERAGES_SUB_ID) AND ofd.status \= 'Y' LEFT OUTER JOIN (SELECT * FROM ofs_grid_master OFS WHERE amend_id \= (SELECT MAX (amend_id) FROM ofs_grid_master WHERE coverages_id \= OFS.coverages_id AND COVERAGES_SUB_ID \= OFS.COVERAGES_SUB_ID)) ofgm ON ( ofgm.CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID AND ofgm.coverages_id \= ofsm.coverages_id AND ofgm.coverages_SUB_id \= ofsm.coverages_SUB_id AND ofgm.STATUS \= 'Y')  order by SUB_DISPLAY_ORDER
GET_HOME_SUBPREMIUM=SELECT ofm.coverages_name, ofm.COVERAGES_DISPLAY_NAME,ofd.quote_no,ofd.coverages_id,ofd.coverages_sub_id,ofd.premium_amount,ofd.coverages_covered_employees, (CASE WHEN DROPDOWNID IS NOT NULL THEN (SELECT DETAIL_NAME FROM CONSTANT_DETAIL CD WHERE CD.CATEGORY_ID\=DROPDOWNID  AND CATEGORY_DETAIL_ID\=OFD.COVERAGES_COVERED_EMPLOYEES) ELSE TRIM(TO_CHAR (NVL (OFD.COVERAGES_COVERED_EMPLOYEES, 0),'999G999G999G999G999G999G999G999G999G990')) END) COVERAGES_COVERED_EMPLOYEES1, ofd.coverages_sub_base_rate, ofsm.SUB_COVERAGES_LIMIT, ofsm.SUB_RATE, ofsm.SUB_CONTROL_TYPE, ofsm.CALC_TYPE, ofsm.SUM_INSURED_LIMIT, ofsm.MIN_SUM_INSURED, ofsm.SUB_NEWCONTROL_TYPE, ofgm.CALC_TYPE grid_calc_type, ofsm.MULTIPLE_ROWS, ofsm.AMEND_ID FROM ofs_data_sub_details ofd JOIN ofs_master ofm ON ofd.coverages_sub_id \= ofm.coverages_id JOIN ofs_coverages_sub_master ofsm ON ofd.coverages_id \= ofsm.coverages_id AND ofd.COVERAGES_SUB_ID \= ofsm.COVERAGES_SUB_ID AND ofd.SCHEME_ID \= ofsm.SCHEME_ID AND ofd.CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID AND ofsm.amend_id \= (SELECT MAX (amend_id) FROM ofs_coverages_sub_master WHERE coverages_id \= ofsm.coverages_id AND COVERAGES_SUB_ID \= ofsm.COVERAGES_SUB_ID AND SCHEME_ID \= ofsm.SCHEME_ID AND CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID) AND ofd.quote_no\= ? AND ofd.amend_id \= (SELECT MAX (amend_id) FROM ofs_data_sub_details WHERE quote_no \= ofd.quote_no AND COVERAGES_SUB_ID \= ofd.COVERAGES_SUB_ID) AND ofd.status \= 'Y' LEFT OUTER JOIN (SELECT * FROM ofs_grid_master OFS WHERE amend_id \= (SELECT MAX (amend_id) FROM ofs_grid_master WHERE coverages_id \= OFS.coverages_id AND COVERAGES_SUB_ID \= OFS.COVERAGES_SUB_ID)) ofgm ON ( ofgm.CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID AND ofgm.coverages_id \= ofsm.coverages_id AND ofgm.coverages_SUB_id \= ofsm.coverages_SUB_id AND ofgm.STATUS \= 'Y') order by SUB_DISPLAY_ORDER
GET_SUB_HOME_INFO=select a.COVERAGES_SUB_ID,a.COVERAGES_ID,b.COVERAGES_DISPLAY_NAME coverages_name,a.MULTIPLE_ROWS,a.SUB_COVERAGES_LIMIT,a.SUB_RATE, a.PRODUCT_ID,a.SUB_CONTROL_TYPE,a.SUB_DISPLAY_ORDER,a.CALC_TYPE,a.REMARKS,a.SUM_INSURED_LIMIT, c.PREMIUM_AMOUNT, c.COVERAGES_COVERED_EMPLOYEES, c.COVERAGES_SUB_BASE_RATE, d.CALC_TYPE GRID_CALC_TYPE, d.amend_id,a.DROPDOWNID FROM OFS_MASTER b JOIN OFS_COVERAGES_SUB_MASTER a ON a.COVERAGES_sub_ID \= b.COVERAGES_ID AND a.CONTENT_TYPE_ID \=? LEFT OUTER JOIN OFS_DATA_SUB_DETAILS c ON a.content_type_id \= c.content_type_id AND a.COVERAGES_ID \= c.COVERAGES_ID AND a.COVERAGES_SUB_ID \= c.COVERAGES_SUB_ID AND a.scheme_id \= c.scheme_id AND a.product_id \= c.product_id AND c.quote_no \= NVL (?, 0) LEFT OUTER JOIN OFS_GRID_MASTER d ON a.content_type_id \= d.content_type_id AND a.COVERAGES_ID \= d.COVERAGES_ID AND a.COVERAGES_SUB_ID \= d.COVERAGES_SUB_ID AND a.scheme_id \= d.scheme_id AND a.product_id \= d.product_id AND d.amend_id || d.coverages_id || d.coverages_sub_id IN (SELECT MAX (amend_id) || coverages_id || coverages_sub_id FROM OFS_GRID_MASTER WHERE CONTENT_TYPE_ID \= ? AND product_id \=? AND scheme_id \=? GROUP BY coverages_id, coverages_sub_id) WHERE a.product_id\=? AND a.scheme_id\=? AND a.status \= 'Y' AND a.CONTENT_TYPE_ID\=? AND a.amend_id \=( SELECT MAX (amend_id) FROM OFS_COVERAGES_SUB_MASTER WHERE product_id\=? AND scheme_id\=? AND CONTENT_TYPE_ID\=? AND coverages_id \= a.coverages_id and COVERAGES_SUB_ID\=a.COVERAGES_SUB_ID) order by SUB_DISPLAY_ORDER
GET_HOMECOVER_DROPDOWN_LIST = SELECT CATEGORY_DETAIL_ID LISTKEY,DETAIL_NAME LISTVALUE FROM CONSTANT_DETAIL WHERE CATEGORY_ID=? AND BRANCH_CODE=? AND STATUS='Y' ORDER BY CATEGORY_DETAIL_ID ASC
GET_PREMIUM_DTL=SELECT A.QUOTE_NO, C.TITLE, (C.FIRST_NAME || C.COMPANY_NAME) CUSTOMER_NAME, C.LAST_NAME, C.ADDRESS1 ADDRESS1, C.ADDRESS2,NVL((SELECT D.CONTENT_DESCRIPTION FROM OFS_CONTENT_MASTER D WHERE A.CONTENT_VALUE \= D.CONTENT_TYPE_ID AND D.PRODUCT_ID \= E.PRODUCT_ID AND D.SCHEME_ID \= E.SCHEME_ID AND D.CONTENT_TYPE_ID \= E.CONTENT_TYPE_ID),' '), (CASE WHEN A.PROF_OTHERS IS NOT NULL THEN (NVL((SELECT F.PROFESSION FROM OFS_ACT_PROF_MASTER F WHERE A.ACTIVITY_PROFESSION \= F.ACTIVITY_PROFESSION AND F.SCHEME_ID \= E.SCHEME_ID),' ') || '-' || A.PROF_OTHERS) ELSE NVL((SELECT F.PROFESSION FROM OFS_ACT_PROF_MASTER F WHERE A.ACTIVITY_PROFESSION \= F.ACTIVITY_PROFESSION AND F.SCHEME_ID \= E.SCHEME_ID),' ') END), (CASE WHEN A.FREEZONE_OTHERS IS NOT NULL THEN (NVL((SELECT G.FREEZONE_DESCRIPTION FROM OFS_FREEZONE_MASTER G WHERE A.FREEZONE \= G.FREEZONE),' ') || '-' || A.FREEZONE_OTHERS) ELSE NVL((SELECT G.FREEZONE_DESCRIPTION FROM OFS_FREEZONE_MASTER G WHERE A.FREEZONE \= G.FREEZONE),' ') END), I.CONTACT_PERSON, I.COMPANY_NAME, E.PREMIUM,  TO_CHAR (C.DOB, 'dd-mm-yyyy'), C.OCCUPATION, INITCAP (C.COUNTRY), A.EMIRATE, A.POBOX, C.TELEPHONE, C.MOBILE, C.FAX, C.EMAIL EMAIL, TO_CHAR (E.EFFECTIVE_DATE, 'dd-mm-yyyy') EFFECTIVE_DATE, TO_CHAR (E.EXPIRY_DATE, 'dd-mm-yyyy') EXPIRY_DATE, E.SUMMARY_REMARKS, E.ADMIN_SUMMARY_STATUS, E.ADMIN_REMARKS,  E.ADMIN_REFERRAL_STATUS, NVL (E.REMARKS, ' '), NVL((SELECT D.CONTENT_TYPE_ID FROM OFS_CONTENT_MASTER D WHERE A.CONTENT_VALUE \= D.CONTENT_TYPE_ID AND D.PRODUCT_ID \= E.PRODUCT_ID AND D.SCHEME_ID \= E.SCHEME_ID AND D.CONTENT_TYPE_ID \= E.CONTENT_TYPE_ID),'0'), E.REFERRAL_DESCRIPTION, A.ADDRESS1 ADDRESS, A.TELEPHONE, A.EMAIL MAIL FROM OFS_DATA A, PERSONAL_INFO C,  HOME_POSITION_MASTER E, LOGIN_MASTER H, BROKER_COMPANY_MASTER I WHERE  A.QUOTE_NO \= ?  AND A.AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   OFS_DATA WHERE   QUOTE_NO \= ?)  AND A.CUSTOMER_ID \= C.CUSTOMER_ID AND A.QUOTE_NO \= E.QUOTE_NO AND E.LOGIN_ID \= H.LOGIN_ID  AND H.OA_CODE \= I.AGENCY_CODE  AND E.QUOTE_NO \= ?  AND E.LOGIN_ID \= ?
GET_PREMIUM_INFO=SELECT OFM.COVERAGES_DISPLAY_NAME,ODD.COVERAGES_SUMINSURED,ODD.COVERAGES_ID,ODD.PREMIUM_AMOUNT FROM OFS_MASTER OFM,OFS_DATA_DETAILS ODD WHERE ODD.COVERAGES_ID=OFM.COVERAGES_ID AND OFM.COVERAGES_ID IN (SELECT COVERAGES_ID FROM OFS_DATA_DETAILS WHERE QUOTE_NO=? AND AMEND_ID||PRODUCT_ID||SCHEME_ID||CONTENT_TYPE_ID IN (SELECT MAX(AMEND_ID)||PRODUCT_ID||SCHEME_ID||CONTENT_TYPE_ID FROM OFS_DATA_DETAILS WHERE QUOTE_NO= ? AND PRODUCT_ID =? AND SCHEME_ID =? AND COVERAGES_Y_N_OPTION ='Y' GROUP BY PRODUCT_ID,SCHEME_ID,CONTENT_TYPE_ID ) AND COVERAGES_Y_N_OPTION ='Y' GROUP BY PRODUCT_ID,SCHEME_ID,CONTENT_TYPE_ID,COVERAGES_ID ) AND ODD.STATUS='Y' AND ODD.QUOTE_NO= ? AND ODD.PRODUCT_ID =? AND ODD.SCHEME_ID =? AND ODD.COVERAGES_Y_N_OPTION ='Y' AND ODD.CONTENT_TYPE_ID=? ORDER BY ODD.COVERAGES_ID
GET_HOME_EXIST=select max(amend_id) from OFS_DATA_DETAILS where quote_no=? and product_id=? and scheme_id=?
DELETE_HOME_EXIST=delete from OFS_DATA_DETAILS where  product_id=? and scheme_id=? and quote_no=?  and amend_id=?
GET_COVERAGE_EXIST=select count(1) from ofs_data_details where PRODUCT_ID=? and SCHEME_ID=? and CONTENT_TYPE_ID=? and COVERAGES_ID=? and QUOTE_NO=?
UPDATE_HOME_DATA=UPDATE OFS_DATA_DETAILS SET AMEND_ID=?, COVERAGES_SUMINSURED=?, PREMIUM_AMOUNT=?,COVERAGES_Y_N_OPTION=?,COVERAGES_BASE_RATE=?, STATUS=? where QUOTE_NO=? and COVERAGES_ID=? and SCHEME_ID=? and CONTENT_TYPE_ID=? and PRODUCT_ID=?
INSERT_HOME_DATA=insert into OFS_DATA_DETAILS(quote_no,amend_id,coverages_id,coverages_suminsured,premium_amount,COVERAGES_Y_N_OPTION,COVERAGES_BASE_RATE,status,product_id,scheme_id,content_type_id) values(?,?,?,?,?,?,?,?,?,?,?)
GET_HOME_EXIST_OPTIONAL=select max(amend_id) from OFS_DATA_SUB_DETAILS where quote_no=? and product_id=? and scheme_id=?
DELETE_HOME_EXIST_OPTIONAL=delete from OFS_DATA_SUB_DETAILS where  product_id=? and scheme_id=? and quote_no=?  and amend_id=?
GET_SUB_COVERAGE_EXIST=select count(1) from ofs_data_sub_details where PRODUCT_ID\=? and SCHEME_ID\=? and CONTENT_TYPE_ID\=? and COVERAGES_ID\=? and COVERAGES_SUB_ID\=? and QUOTE_NO\=?
UPDATE_HOME_DATA_OPTIONAL=UPDATE OFS_DATA_SUB_DETAILS SET amend_id\=?, coverages_covered_employees\=?, premium_amount\=?, COVERAGES_SUB_BASE_RATE\=?, status\=? WHERE quote_no\=? AND coverages_id\=? AND COVERAGES_SUB_ID\=? AND scheme_id\=? and content_type_id\=? and product_id\=?
INSERT_HOME_DATA_OPTIONAL=insert into OFS_DATA_SUB_DETAILS(quote_no,amend_id,coverages_id,COVERAGES_SUB_ID,coverages_covered_amount,premium_amount,coverages_covered_employees,COVERAGES_SUB_BASE_RATE,status,product_id,scheme_id,content_type_id) values(?,?,?,?,?,?,?,?,?,?,?,?)
GET_HOME_BASERATE=select NVL((BASE_RATE),'0') BASE_RATE, CALC_TYPE, MINIMUM_PREMIUM from OFS_GRID_MASTER where ? between START_SUMINSURED and END_SUMINSURED and STATUS='Y' AND ( PRODUCT_ID=? and SCHEME_ID=? and CONTENT_TYPE_ID=? and COVERAGES_ID=? and COVERAGES_SUB_ID=?) and AMEND_ID||COVERAGES_ID||COVERAGES_SUB_ID IN (select MAX(AMEND_ID)||COVERAGES_ID||COVERAGES_SUB_ID FROM OFS_GRID_MASTER WHERE PRODUCT_ID=? and SCHEME_ID=? and CONTENT_TYPE_ID=? GROUP BY COVERAGES_ID,COVERAGES_SUB_ID)
GET_HOME_FORMULA_SUM=select formula from formula_master where product_id\=? and scheme_id\=? and coverage_id\=? and status\='Y'
GET_HOME_FORMULA_COUNT=select count(*) from formula_master where product_id=? and scheme_id=? and coverage_id=? and status='Y'
GET_HOME_SUBCOVERAGES=select a.COVERAGES_SUB_ID,a.COVERAGES_ID,b.COVERAGES_DISPLAY_NAME,a.SUB_COVERAGES_LIMIT,a.SUB_RATE, a.PRODUCT_ID,a.SUB_CONTROL_TYPE,a.SUB_DISPLAY_ORDER,a.CALC_TYPE,a.REMARKS,a.SUM_INSURED_LIMIT from OFS_COVERAGES_SUB_MASTER a,OFS_MASTER b where a.COVERAGES_SUB_ID=b.COVERAGES_ID and a.CONTENT_TYPE_ID=? and a.product_id=? and a.scheme_id=? and a.status='Y' and a.amend_id||a.coverages_id||a.coverages_sub_id in (select max(amend_id)||coverages_id||coverages_sub_id from OFS_COVERAGES_SUB_MASTER where CONTENT_TYPE_ID=? and product_id=? and scheme_id=? group by coverages_id,coverages_sub_id) and ( to_date((select to_char(inception_date,'dd-mm-yyyy') from home_position_master where quote_no=?),'dd-mm-yyyy') between a.effective_date and a.expiry_date) order by a.sub_display_order
GET_HOME_REFERRAL_INFO=select ADMIN_REFERRAL_STATUS,REFERRAL_DESCRIPTION from HOME_POSITION_MASTER where quote_no=? and product_id=? and scheme_id=?
GET_HOME_MINIMUM_PREMIUM=select minimum_premium from OFS_CONTENT_MASTER where  product_id=? and scheme_id=? and CONTENT_TYPE_ID=?
GET_HOME_MIN_PREMIUM_BROKER=select c.min_premium_amount from home_position_master a,login_master b,LOGIN_USER_DETAILS c where a.quote_no\=? and a.product_id\=? and c.scheme_id\=? and a.login_id\=b.login_id and b.oa_code\=c.agency_code and c.product_id\=a.product_id
UPDATE_HOME_PREMIUM=UPDATE HOME_POSITION_MASTER SET INCEPTION_DATE\=TO_TIMESTAMP(?,''DD/MM/YYYY''), EXPIRY_DATE\=TO_TIMESTAMP(?,''DD/MM/YYYY''), OVERALL_PREMIUM\=?,PREMIUM\=? {0} WHERE QUOTE_NO\=? AND PRODUCT_ID\=? AND SCHEME_ID\=?
UPD_HOME_PREMIUM_DETAILS=update HOME_POSITION_MASTER set overall_premium\=?, premium\=? {0} where quote_no\=? and product_id\=? and scheme_id\=?
GET_HOME_MIN_PREMIUM=select minimum_premium from OFS_CONTENT_MASTER where  product_id=? and scheme_id=? and CONTENT_TYPE_ID=?
GET_HOME_PREMIUM_DETAILS=select ofm.coverages_display_name,odd.COVERAGES_SUMINSURED,odd.COVERAGES_id,odd.PREMIUM_AMOUNT from ofs_master ofm,ofs_data_details odd where odd.coverages_id=ofm.coverages_id and ofm.coverages_id in (select COVERAGES_ID from OFS_DATA_DETAILS where quote_no=? and amend_id||PRODUCT_ID||SCHEME_ID||CONTENT_TYPE_ID in (select max(amend_id)||PRODUCT_ID||SCHEME_ID||CONTENT_TYPE_ID from OFS_DATA_DETAILS where quote_no= ? and PRODUCT_ID =? and SCHEME_ID =? and COVERAGES_Y_N_OPTION ='Y' group by PRODUCT_ID,SCHEME_ID,CONTENT_TYPE_ID ) and COVERAGES_Y_N_OPTION ='Y' group by PRODUCT_ID,SCHEME_ID,CONTENT_TYPE_ID,COVERAGES_ID ) and odd.status='Y' and odd.quote_no= ? and odd.PRODUCT_ID =? and odd.SCHEME_ID =? and odd.COVERAGES_Y_N_OPTION ='Y' and odd.content_type_id=? order by odd.COVERAGES_id
GET_FARMHOME_QUOTE_PERSONAL_INFO = SELECT e.quote_no,c.title,c.customer_id,nvl(c.first_name,c.company_name) cust_name,c.EMIRATE,e.application_no,e.SUMMARY_REMARKS,c.last_name,e.status,e.PAYMENT_MODE,c.address1,c.address2,c.EMIRATE,NVL((SELECT d.content_description FROM OFS_CONTENT_MASTER d WHERE d.product_id = e.product_id AND d.scheme_id = e.scheme_id AND d.content_type_id = e.content_type_id),' '),i.CONTACT_PERSON,i.company_name,e.premium,e.OVERALL_PREMIUM,e.EXCESS_SIGN,NVL (e.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,E.POLICY_FEE,TO_CHAR (c.dob, 'dd/mm/yyyy') dob,c.OCCUPATION,INITCAP (c.country),c.POBOX,c.TELEPHONE,c.mobile,c.FAX,c.EMAIL,TO_CHAR (e.effective_date, 'dd/mm/yyyy') effective_date,e.summary_remarks,e.admin_summary_status,e.admin_remarks,e.admin_referral_status,NVL (e.remarks, ' '), NVL ((SELECT d.content_type_id FROM   OFS_CONTENT_MASTER d WHERE d.product_id = e.product_id AND d.scheme_id = e.scheme_id AND d.content_type_id = e.content_type_id),'0'), e.referral_description, TO_CHAR (e.INCEPTION_DATE, 'dd/mm/yyyy') INCEPTION_DATE,TO_CHAR (E.EXPIRY_DATE, 'DD/MM/YYYY') EXPIRY_DATE, TO_CHAR (e.EFFECTIVE_DATE - 30, 'dd/mm/yyyy') QUOTATION_DATE, TO_CHAR (e.INCEPTION_DATE, 'dd/mm/yyyy') INCEPTION_DATE1,TO_CHAR (E.EXPIRY_DATE, 'DD/MM/YYYY') EXPIRY_DATE1 FROM PERSONAL_INFO c, HOME_POSITION_MASTER e, LOGIN_MASTER h, BROKER_COMPANY_MASTER i WHERE e.login_id = h.login_id AND h.oa_code = i.agency_code AND C.CUSTOMER_ID = E.CUSTOMER_ID AND e.quote_no=?
GET_HOME_PERSONAL_INFO=SELECT pi.CUSTOMER_ID, pi.FIRST_NAME||pi.LAST_NAME CUST_NAME, pi.EMIRATE, pi.OCCUPATION, (select distinct(OCCUPATION_NAME) from HOME_OCCUPATION_MASTER where OCCUPATION_ID=pi.OCCUPATION) OCCUPATION_NAME, pi.TELEPHONE, pi.MOBILE, pi.FAX, pi.EMAIL from PERSONAL_INFO pi where pi.customer_id=?
GET_HOME_SUB_LIST=select DISPLAY_NAME, DISPLAY_TYPE, DISPLAY_ORDER, DEST_TABLE, DEST_COLUMN, DROPDOWN_KEY, DROPDOWN_VALUE, DROPDOWN_TABLE, VALIDATION_TYPE, Mandatory,TOTAL_SUMINSURED_YN from ofs_config_master where coverages_id\=? and coverages_sub_id\=? and product_id\=? and scheme_id\=? and content_type_id\=? and STATUS\='Y' and coverages_id||amend_id\=(select coverages_id||max(amend_id) from ofs_config_master where coverages_id\=? and coverages_sub_id\=? and product_id\=? and scheme_id\=? and content_type_id\=? group by coverages_id) order by display_order,ofs_config_id
GET_HOME_COVERAGES_DETAILS=select * from OFS_TRANSACTION_DETAILS where QUOTE_NO\=? AND COVERAGES_ID\=? AND COVERAGES_SUB_ID\=? AND product_id\=? and scheme_id\=? and content_type_id\=? and AMEND_ID\=(select max(AMEND_ID) from OFS_TRANSACTION_DETAILS where QUOTE_NO\=?)
GET_HOME_MAX_AMENDID_COVERAGE=SELECT MAX(AMEND_ID) FROM OFS_TRANSACTION_DETAILS WHERE QUOTE_NO=?
HOME_DEL_COVERAGE_DETAILS=delete from OFS_TRANSACTION_DETAILS where quote_no\=? and product_id\=? and scheme_id\=? and CONTENT_TYPE_ID\=? and COVERAGES_ID\=? and COVERAGES_SUB_ID\=?
HOME_INS_COVERAGE_DETAILS=Insert into OFS_TRANSACTION_DETAILS(QUOTE_NO, PRODUCT_ID, SCHEME_ID, CONTENT_TYPE_ID, COVERAGES_ID, COVERAGES_SUB_ID, MORE_DETAILS_ID {0},AMEND_ID, STATUS) values (?,?,?,?,?,?,? {1}, ?,?)
GET_HOME_UW_MENU=SELECT UW_ID, UW_DESCRIPTION FROM HOME_UW_MASTER WHERE PRODUCT_ID\=? AND SCHEME_ID\=? AND STATUS\='Y' ORDER BY DISPLAY_ORDER
GET_BUSINESSTYPE_LIST = SELECT * FROM HOME_BUSINESS_TYPE_DETAIL WHERE BUSINESS_ID=(SELECT BUSINESS_ID FROM HOME_BUSINESS_TYPE_MASTER WHERE CORE_APP_CODE=?) AND STATUS='Y' ORDER BY DISPLAY_ORDER ASC
GET_HOME_COVER_ID=select cover_id,cover_description from home_cover_master where product_id=? and cover_id not in(7) and status='Y'
GET_HOME_UW_DETAILS=select QUOTE_NO, NVL(TRIM(BUILT_OF_CONCRETE),'N') BUILT_OF_CONCRETE, PRIVATE_LIVING_ACCOMODATION, BUILT_ON_RECLAIMED_LAND, UNATTENDED_60_CONSECUTIVE_DAYS, DECLINED_CANELLED_CONDITIONS, ANY_CLAIM_IN_3YRS, NO_OF_CLAIMS, TYPE_OF_CLAIMS, CLAIM_AMOUNT, PROPERTY_TYPE from HOME_UW_QUESTIONS where QUOTE_NO=?
INS_HOME_UW_DETAILS=Insert into HOME_UW_QUESTIONS (QUOTE_NO, BUILT_OF_CONCRETE, PRIVATE_LIVING_ACCOMODATION, BUILT_ON_RECLAIMED_LAND, UNATTENDED_60_CONSECUTIVE_DAYS, DECLINED_CANELLED_CONDITIONS, ANY_CLAIM_IN_3YRS, NO_OF_CLAIMS, TYPE_OF_CLAIMS, CLAIM_AMOUNT, PROPERTY_TYPE) Values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
UPD_HOME_UW_DETAILS=Update HOME_UW_QUESTIONS set BUILT_OF_CONCRETE=?, PRIVATE_LIVING_ACCOMODATION=?, BUILT_ON_RECLAIMED_LAND=?, UNATTENDED_60_CONSECUTIVE_DAYS=?, DECLINED_CANELLED_CONDITIONS=?, ANY_CLAIM_IN_3YRS=?, NO_OF_CLAIMS=?, TYPE_OF_CLAIMS=?, CLAIM_AMOUNT=?, PROPERTY_TYPE=? where QUOTE_NO=?
GET_HOME_REFERAL_STATUS=select NVL(REFERAL,'N') REFERAL from login_master where LOGIN_ID\=?
UPD_HOME_MODEOFPAY=UPDATE HOME_POSITION_MASTER SET SUMMARY_CLAUSES=?,AIRMILES_NO=?, INSURANCE_DETAILS=?,PAYMENT_MODE=?,CSH_ID_TYP_CODE=?,EFFECTIVE_DATE=SYSDATE+30, APPLICATION_ID=? WHERE QUOTE_NO=?
GET_HOME_POLICY_STATUS=SELECT NVL(STATUS,'Y') STATUS,POLICY_NO,RECEIPT_NO,DEBIT_NOTE_NO FROM HOME_POSITION_MASTER WHERE QUOTE_NO=? AND (PRODUCT_ID=? OR PROPOSAL_NO=?)
GET_HOME_BROKER_POLICYFEES=SELECT nvl(BM.POLICY_FEE,0) POLICY_FEE FROM LOGIN_MASTER LM,BROKER_MASTER BM WHERE LM.OA_CODE=BM.AGENCY_CODE AND LM.LOGIN_ID=(SELECT LOGIN_ID FROM HOME_POSITION_MASTER WHERE QUOTE_NO=?) AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM BROKER_MASTER B,LOGIN_MASTER L WHERE L.OA_CODE=B.AGENCY_CODE AND L.LOGIN_ID=(SELECT LOGIN_ID FROM HOME_POSITION_MASTER WHERE QUOTE_NO=?) AND B.AGENCY_CODE=L.OA_CODE)
GET_HOME_POLICYFEE_CALCULATION=select PREMIUM, EXCESS_PREMIUM, EXCESS_SIGN, OVERALL_PREMIUM from HOME_POSITION_MASTER where QUOTE_NO=?
GET_HOME_POSITION_MASTER_POLICYFEES=select nvl(policy_fee,0) from home_position_master where quote_no\=?
GET_HELP_INFO=SELECT (select HELP_DESCRIPTION from OFS_HELP_MASTER WHERE HELP_CONTENTS_ID=?) HELP_DESCRIPTION, COVERAGES_NAME FROM OFS_MASTER WHERE coverages_id=?
UPD_HOME_REFERRAL_STATUS=UPDATE HOME_POSITION_MASTER SET REMARKS\=?,ADMIN_REMARKS\=?,EXCESS_PREMIUM\=?,ADMIN_REFERRAL_STATUS\='N',STATUS\=?,EXCESS_SIGN\=?, EFFECTIVE_DATE\=SYSDATE+30,OVERALL_PREMIUM\=?, APPROVED_BY\=(SELECT NVL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID\=?),PREMIUM\=?, POLICY_FEE\=? WHERE QUOTE_NO\=?
GET_HOME_COMM=SELECT NVL (COMMISSION, '0') COMMISSION FROM LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM WHERE LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID = ? AND LM.STATUS = 'Y' AND LUD.STATUS = 'Y' AND LUD.PRODUCT_ID =  ? AND LUD.SCHEME_ID=? AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=LM.LOGIN_ID AND PRODUCT_ID=LUD.PRODUCT_ID)
UPD_HOME_PREMIUM_INFO=UPDATE HOME_POSITION_MASTER SET POLICY_FEE\=?, OVERALL_PREMIUM\=? WHERE QUOTE_NO\=?
GET_GRID_MASTER_DETAILS=select distinct(COVERAGES_ID), CALC_TYPE from ofs_grid_master ogm  where PRODUCT_ID=? and SCHEME_ID=? and CONTENT_TYPE_ID=? and amend_id=(select max(amend_id) from ofs_grid_master where ogm.COVERAGES_ID=COVERAGES_ID and status='Y')
GET_UW_MASTER_MENU=SELECT hum.UW_ID, hum.UW_DESCRIPTION, hum.DISPLAY_ORDER, hum.DISPLAY_TYPE, hum.DROPDOWN_KEY, hum.DROPDOWN_VALUE, hum.DROPDOWN_TABLE, hum.VALIDATION_TYPE, hum.DEST_TABLE, hum.DEST_COLUMN, hum.MANDATORY, hum.EXPECTED_RESULT FROM HOME_UW_MASTER hum WHERE AMEND_ID=(SELECT AMEND_ID FROM HOME_UW_MASTER WHERE hum.UW_ID=UW_ID) AND STATUS='Y' ORDER BY DISPLAY_ORDER
UPD_HOME_QUOTE_SAVE=UPDATE HOME_POSITION_MASTER SET STATUS=? WHERE QUOTE_NO=?
GET_HOME_ADMIN_SCHEMEID=select scheme_id, CONTENT_TYPE_ID from home_position_master where quote_no=?
UPD_HOME_REF_STATUS=UPDATE HOME_POSITION_MASTER SET EFFECTIVE_DATE=SYSDATE+30,REMARKS=?,SUMMARY_REMARKS= ?,ADMIN_REFERRAL_STATUS = ?, REFERRAL_DESCRIPTION = ?, APPLICATION_ID=? WHERE QUOTE_NO = ?
GET_BUSINESS_TYPE_RATE = SELECT RATE FROM HOME_BUSINESS_TYPE_LOADING BTL WHERE BTL.BUSINESS_TYPE_ID=? AND BTL.COVERAGE_ID=? AND BTL.SUB_COVERAGE_ID=? AND BTL.STATUS='Y' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM HOME_BUSINESS_TYPE_LOADING BTL1 WHERE BTL1.BUSINESS_TYPE_ID=BTL.BUSINESS_TYPE_ID AND BTL1.COVERAGE_ID=BTL.COVERAGE_ID AND BTL1.SUB_COVERAGE_ID=BTL.SUB_COVERAGE_ID AND BTL1.STATUS=BTL.STATUS)
GET_CONTENT_TYPE_LIST = SELECT * FROM OFS_CONTENT_MASTER WHERE PRODUCT_ID=? AND SCHEME_ID=? ORDER BY MINIMUM_PREMIUM ASC
GET_OFS_CONTENT_TYPE_NAME = SELECT CONTENT_DESCRIPTION FROM OFS_CONTENT_MASTER WHERE PRODUCT_ID=? AND SCHEME_ID=? AND CONTENT_TYPE_ID=?
GET_FARM_PATCOVER_STATUS = SELECT {0} FROM OFS_DATA OD WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OFS_DATA OD1 WHERE OD1.QUOTE_NO=OD.QUOTE_NO)
GET_FARMHOME_PREMIUM = Select (NVL((SELECT sum(Premium_Amount) from Ofs_Data_Sub_Details Where Quote_no=?),0)+NVL((Select sum(Premium_Amount) from Ofs_Data_Details Where Quote_no=?),0)) HOME_PREMIUM FROM DUAL
GET_FARMHOME_REFERRALREMARKS = SELECT REFERRAL_REMARKS FROM OFS_DATA WHERE QUOTE_NO=?
GET_HOME_REFERRALREMARKS = SELECT SUMMARY_REMARKS FROM HOME_POSITION_MASTER WHERE QUOTE_NO=?
GET_CONTANT_PATRACTOR_OPTION = SELECT STATUS FROM CONSTANT_DETAIL WHERE CATEGORY_ID='194' AND CATEGORY_DETAIL_ID=? AND BRANCH_CODE=?
############Home Farmer Insurance - End ########################################################
################################################################################################
#### Farmer Insurance | PA Cover - Start #######################################################
CNT_FARMPA_DETAILS = SELECT COUNT(*) FROM PA_DETAILS WHERE APPLICATION_NO=?
INS_FARMPA_DETAILS = INSERT INTO PA_DETAILS (APPLICATION_NO,QUOTE_NO,AMEND_ID,POLICY_TYPE,ISROLLPOLICYYN,PREVPOLICYNO,PREVEXPIRYDATE,PREVINSURANCE,PREVCLAIMAMT) VALUES(?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?)
UPD_FARMPA_DETAILS = UPDATE PA_DETAILS SET QUOTE_NO\=?,AMEND_ID\=?,POLICY_TYPE\=?,ISROLLPOLICYYN\=?,PREVPOLICYNO\=?,PREVEXPIRYDATE\=TO_DATE(?,'DD/MM/YYYY'),PREVINSURANCE\=?,PREVCLAIMAMT\=? WHERE APPLICATION_NO\=?
GET_FARMPA_INSURED_DETAILS = SELECT APPLICATION_NO,QUOTE_NO,AMEND_ID,INSURED_ID,INSURED_NAME,TO_CHAR(DOB,'DD/MM/YYYY') DOB,INSURER_NAME,RELATIONSHIP,FATHERFIRSTNAME,FATHERMIDDLENAME,FATHERLASTNAME,OCCUPATION,TABLEOFBENEFITS,SUMINSURED,ANNUALINCOME,PREEXISTING_YN,DISABILITY_DESC,OPTIONTYPE,MEDICAL_EXTENSION,TRAVEL_COST_YN,SUPPORTITEM_EXTENSION_YN FROM PA_INSURED_DETAILS WHERE APPLICATION_NO=? AND INSURED_ID=?
GET_FARMPA_MAXINSURED_ID = SELECT NVL(MAX(INSURED_ID),0)+1 FROM  PA_INSURED_DETAILS WHERE APPLICATION_NO=?
INS_FARMPA_INSURED_DETAILS = INSERT INTO PA_INSURED_DETAILS(APPLICATION_NO,QUOTE_NO,AMEND_ID,INSURED_ID,INSURED_NAME,DOB,INSURER_NAME,RELATIONSHIP,FATHERFIRSTNAME,FATHERMIDDLENAME,FATHERLASTNAME,OCCUPATION,TABLEOFBENEFITS,SUMINSURED,ANNUALINCOME,PREEXISTING_YN,DISABILITY_DESC,OPTIONTYPE,MEDICAL_EXTENSION,TRAVEL_COST_YN,SUPPORTITEM_EXTENSION_YN) VALUES (?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
DEL_FARMPA_INSURED_DETAILS = DELETE FROM PA_INSURED_DETAILS WHERE APPLICATION_NO=? AND INSURED_ID=?
GET_FARMPA_INSURED_DETAILS_LIST =  SELECT APPLICATION_NO,QUOTE_NO,AMEND_ID,INSURED_ID,INSURED_NAME,TO_CHAR (DOB, 'DD/MM/YYYY') DOB,INSURER_NAME,RELATIONSHIP,(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE LIV WHERE LIV.ITEM_CODE=RID.RELATIONSHIP AND LIV.ITEM_TYPE='RELATIONSHIP') RELATIONNAME, FATHERFIRSTNAME,FATHERMIDDLENAME,FATHERLASTNAME,OCCUPATION,(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE LIV WHERE LIV.ITEM_CODE=RID.OCCUPATION AND LIV.ITEM_TYPE='OCCUPATION') OCCUPATIONNAME, TABLEOFBENEFITS,(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE LIV WHERE LIV.ITEM_CODE=RID.TABLEOFBENEFITS AND LIV.ITEM_TYPE='TABLEBENIFITS') TABLEBENIFITSNAME,NVL (SUMINSURED, 0) SUMINSURED,NVL (ANNUALINCOME, 0) ANNUALINCOME,RATE,PREMIUM,MEDICAL_EXTENSION_RATE,MEDICAL_EXTENSION_PREMIUM,TRAVEL_COST_RATE,TRAVEL_COST_PREMIUM,SUPPORTITEM_EXTENSION_RATE,SUPPORTITEM_EXTENSION_PREMIUM FROM PA_INSURED_DETAILS RID WHERE APPLICATION_NO = ? ORDER BY INSURED_ID ASC
GET_FARMPA_DETAILS = SELECT POLICY_TYPE,ISROLLPOLICYYN,PREVPOLICYNO,TO_CHAR(PREVEXPIRYDATE,'DD/MM/YYYY') PREVEXPIRYDATE,PREVINSURANCE,PREVCLAIMAMT,TOTAL_PREMIUM FROM PA_DETAILS WHERE APPLICATION_NO=?
GET_FARMPA_PREMIUM = SELECT TOTAL_PREMIUM FROM PA_DETAILS WHERE QUOTE_NO=?
GET_FARMPA_REFERRALREMARKS = SELECT REFERAL_REMARKS FROM PA_DETAILS WHERE QUOTE_NO=?
#### Farmer Insurance | PA Cover - End #########################################################
################################################################################################
#### Farmer Insurance | Motor Start ############################################################
GET_FARMMOTOR_DATA_DTLS = SELECT HPM.QUOTE_NO, TO_CHAR (HPM.INCEPTION_DATE, 'DD/MM/YYYY') INCEPTION_DATE, TO_CHAR (HPM.EXPIRY_DATE, 'DD/MM/YYYY') EXPIRY_DATE, HPM.CUSTOMER_ID, HPM.BROKER_CODE, HPM.AC_EXECUTIVE_ID, HPM.LOGIN_ID FROM HOME_POSITION_MASTER HPM WHERE HPM.APPLICATION_NO=? AND HPM.PRODUCT_ID=? AND HPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO = HPM.APPLICATION_NO AND PRODUCT_ID = HPM.PRODUCT_ID)
DEL_FARMMOTOR_VEHICLE_DETAILS = DELETE FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=? AND VEHICLE_ID=?
GET_FARMMOTOR_DTL_CNT = SELECT COUNT(*) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?
INS_FARMMOTOR_DATA_DTLS=INSERT INTO MOTOR_DATA_DETAIL (QUOTE_NO,CUSTOMER_ID,PRODUCT_ID,AMEND_ID,ENTRY_DATE,APPLICATION_NO,STATUS,MAKE_ID,MODEL_ID,BODY,MANUFACTURE_YEAR,CUBIC_CAPACITY,SEATING_CAPACITY,SUMINSURED_VALUE_LOCAL,AGENCY_REPAIR,NO_OF_CYLINDER,VEHICLE_TYPE,DRIVER_UAE_LICENCE,CLAIMYN,CLAIM_AMOUNT,NO_CLAIM_BONUS,AREA_COVERAGE,DRIVER_DOB,INCEPTION_DATE,EXPIRY_DATE,THIRD_PARTY_LIABILITY,EXCESS,DRIVER_NATIONALITY,DRIVER_UAE_LIC_EXP_DT,VOLUNTARY_DISC,BIFUELKITSI,RESTRICT_TPPD,NO_OF_TRAILER,VEHICLE_ID) values(?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'dd/mm/yyyy'),TO_DATE(TO_CHAR(ADD_MONTHS(TO_DATE(NVL(?,SYSDATE),'DD/MM/YYYY'),13)-1,'DD-MM-YYYY')||' 23:59:59','DD-MM-YYYY HH24:MI:SS'),?,?,?,TO_DATE(?,'dd/mm/yyyy'),?,?,?,?,?)
UPD_FARMMOTOR_DATA_DTLS=UPDATE MOTOR_DATA_DETAIL SET CUSTOMER_ID=?,MAKE_ID=?,MODEL_ID=?,BODY=?,MANUFACTURE_YEAR=?,CUBIC_CAPACITY=?,SEATING_CAPACITY=?,SUMINSURED_VALUE_LOCAL=?,AGENCY_REPAIR=?,NO_OF_CYLINDER=?,VEHICLE_TYPE=?,DRIVER_UAE_LICENCE=?,CLAIMYN=?,CLAIM_AMOUNT=?,NO_CLAIM_BONUS=?,AREA_COVERAGE=?,DRIVER_DOB=TO_DATE(?,'DD/MM/YYYY'),INCEPTION_DATE=TO_DATE(?,'DD/MM/YYYY'),EXPIRY_DATE=TO_DATE(TO_CHAR(ADD_MONTHS(TO_DATE(NVL(?,SYSDATE),'DD/MM/YYYY'),13)-1,'DD-MM-YYYY')||' 23:59:59','DD-MM-YYYY HH24:MI:SS'),THIRD_PARTY_LIABILITY=?,EXCESS=?,DRIVER_NATIONALITY=?,DRIVER_UAE_LIC_EXP_DT=TO_DATE(?,'dd/mm/yyyy') WHERE APPLICATION_NO=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?)
UPD_FARMMOTOR_ADDVEHICLE_DTLS = UPDATE MOTOR_DATA_DETAIL SET VEHICLE_COLOR=?,LEASED=?,BANK_ID=?,REGISTRATION_NO=?,CHASSIS_NO=?,ENGINE_NUMBER=?,INSURED_NAME_ARABIC=?,INSURED_ADDRESS_ARABIC=?,REGISTER_LOCATION=?,PLATE_COLOR=?,REGISTRATION_YEAR=?,MANUFACTUREDATE=TO_DATE(?,'DD/MM/YYYY'),LAMPSYN=?,TRAILER1IDVSI=?,TRAILER1DATE=TO_DATE(?,'DD/MM/YYYY'),POLICYTYPE=?,TRAILER2IDVSI=?,TRAILER2DATE=TO_DATE(?,'DD/MM/YYYY'),OWNDRIVEROPTED=?,NOOFUNNAMED=?,UNNAMEDSI=?,NOOFDRIVERS=?,PAIDDRIVERSSI=?,LIABILITYCOVEROPTED=?,DRIVERCLEAN=?,NONFAREPAYING=?,EMPOPERATE=?,LT_FINANCE=?,TRAILER1_REG_NO=?,TRAILER2_REG_NO=? WHERE APPLICATION_NO=? AND VEHICLE_ID=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?)
GET_FARMMOTOR_MULTI_DATA_DETAILS = select * from table(Farmer_Vehicle_Data_Details(?,?,?))
GET_FARMMOTOR_COVER_DETAILS = Select A.Coverages_Id,A.coverages_sub_id,A.COVERAGES_NAME,nvl(B.STATUS,'N') STATUS From ((Select TCM.Coverages_Id,TCM.coverages_sub_id,TCM.COVERAGES_NAME,Status From  Tractor_Coverages_Master TCM  Where  TCM.COVERAGES_TYPE=1 and TCM.Status='Y') A left outer join (Select Coverages_Id,coverages_sub_id,COVERAGES_NAME,COVERAGES_OPTED STATUS from MOTOR_COVERAGES_DETAILS mcd Where  MCD.APPLICATION_NO=?) B on A.coverages_sub_id=B.coverages_sub_id) Order by coverages_sub_id ASC
INS_FARMMOTOR_HOME_POS_DTLS_REF=INSERT INTO HOME_POSITION_MASTER (QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,AMEND_ID,APPLICATION_NO,STATUS,COMPANY_ID,EFFECTIVE_DATE,ENTRY_DATE,FLEET_NO,BRANCH_CODE,APPLICATION_ID,ADMIN_REFERRAL_STATUS,REMARKS,REFERRAL_DESCRIPTION,BROKER_CODE,AC_EXECUTIVE_ID,SCHEME_ID,CONTENT_TYPE_ID) VALUES(?,?,?,?,?,?,?,?,SYSDATE+30,SYSDATE,?,?,?,'Y','Referal',?,?,?,?,?)
INS_FARMMOTOR_HOME_POS_DTLS=INSERT INTO HOME_POSITION_MASTER (QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,AMEND_ID,APPLICATION_NO,STATUS,COMPANY_ID,EFFECTIVE_DATE,ENTRY_DATE,FLEET_NO,BRANCH_CODE,APPLICATION_ID,ADMIN_REMARKS,BROKER_CODE,AC_EXECUTIVE_ID,SCHEME_ID,CONTENT_TYPE_ID) VALUES(?,?,?,?,?,?,?,?,SYSDATE+30,SYSDATE,?,?,?,?,?,?,?,?)
UPD_FARMMOTOR_HOME_POS_REF=UPDATE HOME_POSITION_MASTER SET EFFECTIVE_DATE=SYSDATE+30,REFERRAL_DESCRIPTION=?,REMARKS='Referal',ADMIN_REFERRAL_STATUS='Y',STATUS=?,PREMIUM=NULL,OVERALL_PREMIUM=NULL,BROKER_CODE=?,AC_EXECUTIVE_ID=?, APPLICATION_ID=? WHERE APPLICATION_NO=?
UPD_FARMMOTOR_HOME_POS_DTLS=UPDATE HOME_POSITION_MASTER SET EFFECTIVE_DATE=SYSDATE+30,REFERRAL_DESCRIPTION=?,REMARKS=NULL,ADMIN_REFERRAL_STATUS=NULL,STATUS=?,BROKER_CODE=?,AC_EXECUTIVE_ID=?, APPLICATION_ID=? WHERE APPLICATION_NO=?
DEL_FARMMOTOR_COVER_DETAIL = DELETE FROM MOTOR_COVERAGES_DETAILS WHERE APPLICATION_NO=?
INS_FARMMOTOR_COVER_DETAIL = INSERT INTO MOTOR_COVERAGES_DETAILS (APPLICATION_NO,QUOTE_NO,COVERAGES_SUB_ID,COVERAGES_NAME,COVERAGES_VALUE,COVERAGES_OPTED) VALUES (?,?,?,?,?,?)
GET_FARMMOTOR_PREMIUM = SELECT PREMIUM FROM MOTOR_DATA_DETAIL MDD WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL MDD1 WHERE MDD1.QUOTE_NO=MDD.QUOTE_NO)
GET_FARMMOTOR_REFERRALREMARKS = SELECT REFERRAL_REMARKS FROM MOTOR_DATA_DETAIL WHERE QUOTE_NO=?
GET_FARMMOTOR_PREMIUM_INFO = SELECT   TPCD.Coverages_Id,TPCD.COVERAGES_SUB_ID, TCM.Coverages_Name, ORGSUMINSURED, ORGRATE, NVL (Premium, 0) Premium, Decode(TCM.REFERRAL_TYPE,'R','Y','N') DISPLAY_STATUS FROM   Tractor_Prem_Coverages_Details  TPCD,Tractor_Coverages_master tcm WHERE   Application_No =? and TPCD.COVERAGES_SUB_ID=TCM.COVERAGES_SUB_ID AND TCm.STATUS='Y' ORDER BY   Coverages_sub_Id ASC
UPD_FARMMOTOR_COVER_RATE = UPDATE Tractor_Prem_Coverages_Details SET ORGRATE=? WHERE Application_No = ? AND COVERAGES_SUB_ID=?
GET_BROKER_COMMISSION=SELECT NVL(LUD.COMMISSION,0) FROM   LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM,HOME_POSITION_MASTER HPM WHERE   LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID=HPM.LOGIN_ID AND HPM.APPLICATION_NO =? AND LUD.PRODUCT_ID = HPM.PRODUCT_ID AND HPM.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=HPM.APPLICATION_NO) and HPM.PRODUCT_ID=?  AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE PRODUCT_ID=LUD.PRODUCT_ID AND LOGIN_ID=LUD.LOGIN_ID)
GET_POLICY_FEE=SELECT NVL(POLICY_FEE,'0') POLICY_FEE FROM BROKER_MASTER WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=(SELECT LOGIN_ID FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?)) AND POLICY_FEE_STATUS='Y' AND STATUS='Y' AND BRANCH_CODE=? AND EFFECTIVE_DATE<=SYSDATE ORDER BY EFFECTIVE_DATE DESC
#UPD_TRAVEL_HEADER_PREMIUM=UPDATE TRAVEL_HEADER TH SET TH.TOTAL_PREMIUM= ? WHERE TH.APPLICATION_NO = ? AND TH.AMEND_ID=( SELECT MAX(AMEND_ID) FROM TRAVEL_HEADER WHERE APPLICATION_NO = TH.APPLICATION_NO)
UPD_TRAVEL_HEADER_PREMIUM=UPDATE TRAVEL_HEADER SET TRAVEL_HEADER.TOTAL_PREMIUM= ? WHERE TRAVEL_HEADER.APPLICATION_NO = ? AND TRAVEL_HEADER.AMEND_ID=( SELECT MAX(AMEND_ID) FROM TRAVEL_HEADER WHERE APPLICATION_NO = TRAVEL_HEADER.APPLICATION_NO)
UPD_TRAVEL_HEADER_OPTCOVER=UPDATE TRAVEL_HEADER TH SET SCHEME_ID=?,OPTIONAL_COVER=? WHERE TH.APPLICATION_NO = ? AND TH.AMEND_ID=( SELECT MAX(AMEND_ID) FROM TRAVEL_HEADER WHERE APPLICATION_NO = TH.APPLICATION_NO)
UPD_HOME_POS_PREMIUM=UPDATE HOME_POSITION_MASTER SET PREMIUM = ? ,OVERALL_PREMIUM= ?,POLICY_FEE=?,COMMISSION = ? WHERE APPLICATION_NO  = ?
CAL_TRAVEL_PREMIUM_CALC={CALL TRAVEL_PREMIUM_CALC_ENDT(?,?,?,?,?,?)}
##INS_TRAVEL_DTL=INSERT INTO TRAVEL_DETAIL(APPLICATION_NO,QUOTE_NO,SERIAL_NO,PASSENGER_NAME,DOB,AMEND_ID,STATUS,RELATION,GENDER,NATIONALITY,AGE,TYPE,PASSPORT_NO,PASSPORT_EXP_DATE,PASSANGER_LAST_NAME) VALUES(?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,(CASE WHEN ? <= 2 THEN 'C' WHEN ? BETWEEN 3 AND 18 THEN 'C' WHEN ? >=19 THEN 'A' END),?,TO_DATE(?,'DD/MM/YYYY'),?)
##UPD_TRAVEL_DTL=UPDATE TRAVEL_DETAIL SET PASSENGER_NAME=?,DOB=TO_DATE(?,'DD/MM/YYYY'),AMEND_ID=?,STATUS=?,RELATION=?,GENDER=?,NATIONALITY=?,AGE=?,QUOTE_NO=?,TYPE=(CASE WHEN ? <= 2 THEN 'C' WHEN ? BETWEEN 3 AND 18 THEN 'C' WHEN ? >=19 THEN 'A' END),PASSPORT_NO=?,PASSPORT_EXP_DATE=TO_DATE(?,'DD/MM/YYYY'),PASSANGER_LAST_NAME=? WHERE APPLICATION_NO=? AND SERIAL_NO=?
INS_TRAVEL_DTL=INSERT INTO TRAVEL_DETAIL(APPLICATION_NO,QUOTE_NO,SERIAL_NO,PASSENGER_NAME,DOB,AMEND_ID,STATUS,RELATION,GENDER,NATIONALITY,AGE,TYPE,PASSPORT_NO,PASSPORT_EXP_DATE,PASSANGER_LAST_NAME) VALUES(?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),?,?,?,?,?,?,(CASE WHEN ? <= 2 THEN 'C' WHEN ? BETWEEN 3 AND 18 THEN 'C' WHEN ? >=19 THEN 'A' END),?,TO_DATE(?,'DD/MM/YYYY'),?)
UPD_TRAVEL_DTL=UPDATE TRAVEL_DETAIL SET PASSENGER_NAME=?,DOB=TO_DATE(?,'DD/MM/YYYY'),AMEND_ID=?,STATUS=?,RELATION=?,GENDER=?,NATIONALITY=?,AGE=?,QUOTE_NO=?,TYPE=(CASE WHEN ? <= 2 THEN 'C' WHEN ? BETWEEN 3 AND 18 THEN 'C' WHEN ? >=19 THEN 'A' END),PASSPORT_NO=?,PASSPORT_EXP_DATE=TO_DATE(?,'DD/MM/YYYY'),PASSANGER_LAST_NAME=? WHERE APPLICATION_NO=? AND SERIAL_NO=?
GET_SLNO_TRAVEL_DTL=SELECT NVL(MAX(SERIAL_NO),'0')+1 FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?
DEL_TRAVEL_DTL=DELETE FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND SERIAL_NO=?
GET_COVERAGES_NAMES=SELECT DISTINCT SCHEME_ID,SCHEME_NAME,PREMIUM,NVL(REF_STATUS,'N') REFYN from TRAVEL_POLICY_COVERAGE WHERE  APPLICATION_NO=? AND OPTION_ID=? AND STATUS='Y' AND GROUP_ID=0  ORDER BY PREMIUM DESC
GET_COVERAGES_DTLS=SELECT Y_ID,Y_DATA_NAME,PREMIUM,IS_SELECTED,IS_ADDON,DELETABLE,GROUP_ID,NVL(REF_STATUS,'N') REFYN from TRAVEL_POLICY_COVERAGE WHERE  APPLICATION_NO=? AND SCHEME_ID=? AND  OPTION_ID=? AND STATUS='Y' ORDER BY GROUP_ID
DEL_TRAVEL_DTL_ALL=DELETE FROM TRAVEL_DETAIL WHERE APPLICATION_NO\=? AND SERIAL_NO NOT IN( 
#UPD_TRAVEL_DTL_ADMIN=UPDATE TRAVEL_DETAIL SET PREMIUM=? WHERE APPLICATION_NO=? AND SERIAL_NO=?
UPD_TRAVEL_DTL_ADMIN=UPDATE TRAVEL_DETAIL SET PREMIUM=?,PASSENGER_NAME=?,DOB=?,RELATION=?,GENDER=?,NATIONALITY=?,AGE=?,TYPE=(CASE WHEN ? <= 2 THEN 'C' WHEN ? BETWEEN 3 AND 18 THEN 'C' WHEN ? >=19 THEN 'A' END),PASSPORT_NO=?,PASSPORT_EXP_DATE=TO_DATE(?,'DD/MM/YYYY') WHERE APPLICATION_NO=? AND SERIAL_NO=?
GET_TRAVEL_DTL=SELECT TD.APPLICATION_NO,TD.QUOTE_NO,TD.SERIAL_NO,TD.PASSENGER_NAME,TD.PASSANGER_LAST_NAME,TO_CHAR(TD.DOB,'DD/MM/YYYY') DOB,TD.RELATION,TD.GENDER,TD.NATIONALITY,TD.PREMIUM,TD.PASSPORT_NO,TO_CHAR(TD.PASSPORT_EXP_DATE,'DD/MM/YYYY') PASSPORT_EXP_DATE,PASSANGER_LAST_NAME FROM TRAVEL_DETAIL TD WHERE TD.APPLICATION_NO=? AND TD.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=TD.APPLICATION_NO) ORDER BY TD.SERIAL_NO
GET_TRAVEL_DTL_CNT=SELECT COUNT(*) CT FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND SERIAL_NO=?
#INS_TRAVEL_HEADER=INSERT INTO TRAVEL_HEADER(APPLICATION_NO,QUOTE_NO,TOTAL_ADULT_PASSENGERS,TOTAL_CHILD_PASSENGERS,TOTAL_NO_OF_PEOPLE_COVERED,POLICY_TERM,CLAIM_Y_N,CLAIM_REMARKS,CLAIM_AMOUNT,INSURANCE_START_DATE,INSURANCE_END_DATE,ENTRY_DATE,EFFECTIVE_DATE,AMEND_ID,CUSTOMER_ID,LOGIN_ID,STATUS,PRODUCTID,SCHEME_COVER,COUNTRY_ORIGIN,COUNTRY_DESTN,SCHEME_ID,OPTION_ID,DISCOUNT_TYPE) VALUES(?,?,(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A'),(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C')),(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?),?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),SYSDATE,SYSDATE,?,?,?,?,?,?,?,?,?,?,(CASE WHEN ((SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND AGE<=65 AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND AGE<=65 AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C') AND RELATION='3')>=2) THEN 'F' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND AGE<=65 AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND AGE<=65 AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)=(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND AGE<=65 AND (RELATION IN('1','2'))) THEN 'S' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)>10 THEN 'G' ELSE '' END))
INS_TRAVEL_HEADER=INSERT INTO TRAVEL_HEADER(APPLICATION_NO,QUOTE_NO,TOTAL_ADULT_PASSENGERS,TOTAL_CHILD_PASSENGERS,TOTAL_NO_OF_PEOPLE_COVERED,POLICY_TERM,CLAIM_Y_N,CLAIM_REMARKS,CLAIM_AMOUNT,INSURANCE_START_DATE,INSURANCE_END_DATE,ENTRY_DATE,EFFECTIVE_DATE,AMEND_ID,CUSTOMER_ID,LOGIN_ID,STATUS,PRODUCTID,SCHEME_COVER,COUNTRY_ORIGIN,COUNTRY_DESTN,SCHEME_ID,OPTION_ID,DISCOUNT_TYPE) VALUES(?,?,(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A'),(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C')),(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?),?,?,?,?,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),SYSDATE,SYSDATE,?,?,?,?,?,?,?,?,?,?,(CASE WHEN ('4'=? AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C','A') AND RELATION='3')>0) THEN 'F' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)=(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND (RELATION IN('1','2'))) THEN '' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)>100 THEN 'G' ELSE '' END))
#UPD_TRAVEL_HEADER=UPDATE TRAVEL_HEADER SET TOTAL_ADULT_PASSENGERS = (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A'),TOTAL_CHILD_PASSENGERS = (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C')) ,TOTAL_NO_OF_PEOPLE_COVERED = (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?) ,POLICY_TERM =  ? ,CLAIM_Y_N = ? ,CLAIM_REMARKS = ?,CLAIM_AMOUNT = ?,INSURANCE_START_DATE = TO_DATE(?,'DD/MM/YYYY'),INSURANCE_END_DATE = TO_DATE(?,'DD/MM/YYYY') ,EFFECTIVE_DATE =SYSDATE,PRODUCTID = ? ,AMEND_ID = 0 ,SCHEME_COVER = ?,COUNTRY_ORIGIN=?,COUNTRY_DESTN=?,QUOTE_NO=?,SCHEME_ID=?,OPTION_ID=?,DISCOUNT_TYPE=(CASE WHEN ((SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND AGE<=65 AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND AGE<=65 AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C') AND RELATION='3')>=2) THEN 'F' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND AGE<=65 AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND AGE<=65 AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)=(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND AGE<=65 AND (RELATION IN('1','2'))) THEN 'S' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)>10 THEN 'G' ELSE '' END) WHERE  APPLICATION_NO= ? AND STATUS = 'Y'
UPD_TRAVEL_HEADER=UPDATE TRAVEL_HEADER SET TOTAL_ADULT_PASSENGERS = (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A'),TOTAL_CHILD_PASSENGERS = (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C')) ,TOTAL_NO_OF_PEOPLE_COVERED = (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?) ,POLICY_TERM =  ? ,CLAIM_Y_N = ? ,CLAIM_REMARKS = ?,CLAIM_AMOUNT = ?,INSURANCE_START_DATE = TO_DATE(?,'DD/MM/YYYY'),INSURANCE_END_DATE = TO_DATE(?,'DD/MM/YYYY') ,EFFECTIVE_DATE =SYSDATE,PRODUCTID = ? ,AMEND_ID = 0 ,SCHEME_COVER = ?,COUNTRY_ORIGIN=?,COUNTRY_DESTN=?,QUOTE_NO=?,SCHEME_ID=?,OPTION_ID=?,DISCOUNT_TYPE=(CASE WHEN ('4'=? AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C','A') AND RELATION='3')>0) THEN 'F' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)=(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND (RELATION IN('1','2'))) THEN '' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)>100 THEN 'G' ELSE '' END),OPTIONAL_COVER='' WHERE  APPLICATION_NO= ? AND STATUS = 'Y'
GET_TRAVEL_HEADER=SELECT POLICY_TERM,TO_CHAR(INSURANCE_START_DATE,'DD/MM/YYYY') INSURANCE_START_DATE,TO_CHAR(INSURANCE_END_DATE,'DD/MM/YYYY') INSURANCE_END_DATE,SCHEME_COVER,NVL(TOTAL_PREMIUM,'0') TOTAL_PREMIUM,SCHEME_ID,OPTION_ID,NVL(DISCOUNTED_VALUE,'0') DISCOUNTED_VALUE, CASE WHEN DISCOUNT_TYPE='F' THEN 'Family' ELSE 'None' END DISCOUNT_TYPE,OPTIONAL_COVER FROM TRAVEL_HEADER WHERE APPLICATION_NO=?
INS_HOME_POS_MASTER_REF=INSERT INTO HOME_POSITION_MASTER(APPLICATION_NO,QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,BRANCH_CODE,POLICY_TERM,AMEND_ID,EFFECTIVE_DATE,EXPIRY_DATE,INCEPTION_DATE,ENTRY_DATE,STATUS,APPLICATION_ID,AGE_ABOVE_SIXTY_FIVE,EXISTING_MEDICAL_CONDITION,SCHEME_ID,REMARKS,REFERRAL_DESCRIPTION,PROPOSAL_NO,ADMIN_REFERRAL_STATUS,COMPANY_ID) VALUES(?,?,?,?,?,?,?,?,SYSDATE+30,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),SYSDATE,?,?,?,?,?,'Referal',?,?,'Y','1')
INS_HOME_POS_MASTER=INSERT INTO HOME_POSITION_MASTER(APPLICATION_NO,QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,BRANCH_CODE,POLICY_TERM,AMEND_ID,EFFECTIVE_DATE,EXPIRY_DATE,INCEPTION_DATE,ENTRY_DATE,STATUS,APPLICATION_ID,AGE_ABOVE_SIXTY_FIVE,EXISTING_MEDICAL_CONDITION,SCHEME_ID,ADMIN_REMARKS,PROPOSAL_NO,COMPANY_ID,BROKER_CODE,AC_EXECUTIVE_ID) VALUES(?,?,?,?,?,?,?,?,SYSDATE+30,TO_DATE(?,'DD/MM/YYYY'),TO_DATE(?,'DD/MM/YYYY'),SYSDATE,?,?,?,?,?,?,?,'1',?,?)
UPD_HOME_POS_MASTER_REF=UPDATE HOME_POSITION_MASTER SET AGE_ABOVE_SIXTY_FIVE = ?, INCEPTION_DATE =TO_DATE(?,'DD/MM/YYYY'), EXISTING_MEDICAL_CONDITION = ?, EXPIRY_DATE =TO_DATE(?,'DD/MM/YYYY'), EFFECTIVE_DATE = SYSDATE+30 , SCHEME_ID = ?, POLICY_TERM = ? ,PRODUCT_ID = ?, REFERRAL_DESCRIPTION = ?,ADMIN_REFERRAL_STATUS='Y',REMARKS = 'Referal',PREMIUM=NULL,OVERALL_PREMIUM=NULL,PROPOSAL_NO = ?,QUOTE_NO=?,STATUS=? WHERE  APPLICATION_NO = ?
UPD_HOME_POS_MASTER=UPDATE HOME_POSITION_MASTER SET AGE_ABOVE_SIXTY_FIVE = ? ,INCEPTION_DATE=TO_DATE(?,'DD/MM/YYYY'),EXISTING_MEDICAL_CONDITION = ? ,EXPIRY_DATE=TO_DATE(?,'DD/MM/YYYY'),EFFECTIVE_DATE=SYSDATE+30,SCHEME_ID = ? ,POLICY_TERM= ? ,PRODUCT_ID = ? ,ADMIN_REMARKS = ? ,REFERRAL_DESCRIPTION=NULL,REMARKS=NULL,ADMIN_REFERRAL_STATUS=NULL,PREMIUM=NULL,OVERALL_PREMIUM=NULL,PROPOSAL_NO = ?,QUOTE_NO=?,STATUS=?,BROKER_CODE=?,AC_EXECUTIVE_ID=?  WHERE  APPLICATION_NO = ?
UPD_HOME_POS_MASTER_ADMIN=UPDATE HOME_POSITION_MASTER SET AGE_ABOVE_SIXTY_FIVE = ? ,INCEPTION_DATE=TO_DATE(?,'DD/MM/YYYY'),EXISTING_MEDICAL_CONDITION = ? ,EXPIRY_DATE=TO_DATE(?,'DD/MM/YYYY'),EFFECTIVE_DATE=SYSDATE+30,SCHEME_ID = ? ,POLICY_TERM= ? ,PRODUCT_ID = ? ,APPROVED_BY = ?,PROPOSAL_NO = ?,QUOTE_NO=?,STATUS=?  WHERE  APPLICATION_NO = ?
DEL_TRAVEL_COVER_DTLS=DELETE FROM TRAVEL_COVERAGES_DETAIL WHERE APPLICATION_NO=? AND COVERAGES_ID NOT IN(
DEL_ALL_TRAVEL_COVER_DTLS=DELETE FROM TRAVEL_COVERAGES_DETAIL WHERE APPLICATION_NO\=? 
GET_TRAVEL_COVER_CNT=SELECT COUNT(*) CNT FROM TRAVEL_COVERAGES_DETAIL WHERE APPLICATION_NO=? AND COVERAGES_ID=?
INS_TRAVEL_COVER_DTLS=INSERT INTO TRAVEL_COVERAGES_DETAIL(APPLICATION_NO,QUOTE_NO,PRODUCT_ID,COVERAGES_ID,COVER_NAME,STATUS) VALUES(?,?,?,?,?,?)
UPD_TRAVEL_COVER_DTLS=UPDATE TRAVEL_COVERAGES_DETAIL SET QUOTE_NO=?,PRODUCT_ID=?,COVER_NAME=?,STATUS=? WHERE APPLICATION_NO=? AND COVERAGES_ID=?
UPD_TRAVEL_COVER_DTLS_ADMIN=UPDATE TRAVEL_COVERAGES_DETAIL SET PREMIUM=? WHERE APPLICATION_NO=? AND COVERAGES_ID=?
GET_TRAVEL_COVER_DTLS=SELECT STATUS,COVERAGES_ID,PREMIUM FROM TRAVEL_COVERAGES_DETAIL WHERE APPLICATION_NO=? ORDER BY COVERAGES_ID
GET_SEQ_ID1=SELECT SEQ_NAME,POLICY_PREFIX FROM SEQUENCE_MASTER WHERE SEQ_ID\=(SELECT 
GET_SEQ_ID2=FROM BRANCH_DETAIL BD WHERE BRANCH_CODE=? AND PRODUCT_ID=? AND BD.AMEND_ID =(SELECT MAX(AMEND_ID) FROM BRANCH_DETAIL WHERE BRANCH_CODE=BD.BRANCH_CODE AND PRODUCT_ID=BD.PRODUCT_ID )) AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS='Y'
GET_MAX_SEQ_ID1=SELECT 
GET_MAX_SEQ_ID2=.NEXTVAL FROM DUAL
GET_COVER_NAME_TRAVEL=SELECT SC.SCHEME_NAME,OP.OPTION_NAME FROM TRAVEL_SCHEME_COVERS SC,TRAVEL_OPTION_COVERS OP WHERE SC.SCHEME_ID\=? AND OP.OPTION_ID\=? AND SC.BRANCH_CODE \=? AND SC.STATUS \= 'Y' AND SC.PRODUCT_CODE\=? AND OP.BRANCH_CODE \=? AND OP.STATUS\='Y' AND SC.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM TRAVEL_SCHEME_COVERS WHERE SCHEME_ID \= SC.SCHEME_ID) AND SC.EFFECTIVE_DATE < SYSDATE and SC.AMEND_ID\=(select max(amend_id) from travel_scheme_covers where SCHEME_ID \= sc.SCHEME_ID ) and OP.AMEND_ID\=(select max(amend_id) from TRAVEL_OPTION_COVERS where OPTION_ID \= OP.OPTION_ID ) 
GET_TRAVELCOVERAGES=SELECT TMC.COVERAGES_ID,TMC.COVERAGES_VALUE, TMC.COVERAGES_NAME,TSOC.COVER_ID FROM TRAVEL_MAS_COVERAGES TMC, TRAVEL_LINK_COVERAGES TLC, TRAVEL_SCHEME_OPTION_COVERS TSOC WHERE TMC.COVERAGES_ID = TLC.COVERAGES_ID AND TLC.COVER_ID = TSOC.COVER_ID AND TSOC.SCHEME_ID = ? AND TSOC.OPTION_ID = ? AND TSOC.PRODUCT_CODE = ? AND TLC.PRODUCT_CODE = ? AND TSOC.BRANCH_CODE=? AND TLC.BRANCH_CODE=? AND TLC.STATUS='Y' AND TLC.amend_id=(SELECT MAX(amend_id) FROM TRAVEL_LINK_COVERAGES WHERE BRANCH_CODE=TLC.BRANCH_CODE AND PRODUCT_CODE=TLC.PRODUCT_CODE AND COVER_ID=TLC.COVER_ID AND EFF_DATE<=SYSDATE)  AND TMC.BRANCH_CODE=? AND TMC.STATUS='Y' AND TSOC.STATUS ='Y' AND TMC.AMEND_ID = (SELECT   MAX (amend_id) FROM   TRAVEL_MAS_COVERAGES WHERE       BRANCH_CODE = TMC.BRANCH_CODE AND PRODUCT_CODE = TMC.PRODUCT_CODE AND COVERAGES_ID = TMC.COVERAGES_ID AND EFF_DATE <= SYSDATE)AND TMC.AMEND_ID =(SELECT MAX(AMEND_ID) FROM TRAVEL_MAS_COVERAGES WHERE COVERAGES_ID=TMC.COVERAGES_ID) ORDER BY COVERAGES_ID
UPD_HOME_POS_MASTER_MODEOFPAY=UPDATE HOME_POSITION_MASTER SET SUMMARY_CLAUSES=?,AIRMILES_NO=?, INSURANCE_DETAILS=?,PAYMENT_MODE=?,CSH_ID_TYP_CODE=?,EFFECTIVE_DATE=SYSDATE+30 WHERE QUOTE_NO=?
UPD_REF_STATUS=UPDATE HOME_POSITION_MASTER SET EFFECTIVE_DATE=SYSDATE+30,REMARKS=?,SUMMARY_REMARKS= ?,ADMIN_REFERRAL_STATUS = ?, REFERRAL_DESCRIPTION = ? WHERE QUOTE_NO = ?
GET_HOME_POS_DET=SELECT PI.CUSTOMER_ID,PI.FIRST_NAME||' '||NVL(PI.LAST_NAME,'') CUS_NAME,PI.MOBILE, PI.EMAIL,HPM.APPLICATION_NO, HPM.SUMMARY_REMARKS,NVL(HPM.PAYMENT_MODE,'Cash') PAYMENT_MODE,HPM.PREMIUM,HPM.EXCESS_PREMIUM,HPM.EXCESS_SIGN,HPM.OVERALL_PREMIUM,(CASE WHEN (HPM.STATUS='Y') THEN CASE WHEN HPM.REMARKS IN ('Referal') THEN 'A' ELSE 'Y' END ELSE 'N' END) ADMIN_REFERRAL_STATUS,NVL(HPM.ADMIN_REFERRAL_STATUS,'N') ADMIN_REFERRAL_YN,HPM.ADMIN_REMARKS,HPM.POLICY_FEE,HPM.REMARKS,HPM.POLICY_NO,HPM.ENDT_PREMIUM,HPM.AMEND_ID,HPM.REFERRAL_DESCRIPTION FROM HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE PI.CUSTOMER_ID=HPM.CUSTOMER_ID AND HPM.QUOTE_NO=? AND HPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE QUOTE_NO=HPM.QUOTE_NO) AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
UPD_EXCESS_PREMIUM=UPDATE TRAVEL_HEADER SET DISCOUNTED_VALUE=?,TOTAL_PREMIUM=? WHERE QUOTE_NO=?
UPD_ADMIN_REFSTATUS=UPDATE HOME_POSITION_MASTER SET REMARKS=?,ADMIN_REMARKS=?,EXCESS_PREMIUM=?,ADMIN_REFERRAL_STATUS='N',STATUS=?,EXCESS_SIGN=?,EFFECTIVE_DATE=SYSDATE+30,OVERALL_PREMIUM=?,COMMISSION=?,APPROVED_BY=(SELECT NVL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?),PREMIUM=?,DISCOUNT_PREMIUM=?,ENDT_PREMIUM=?,ENDT_COMMISSION=? WHERE QUOTE_NO=?
GET_COVER_INFO=SELECT a.SECTION_ID,a.CURRENCY_NAME,a.STATUS, a.VALUE, a.CLAUSES_DESCRIPTION,a.DISTINATION_VALUE  FROM TRAVEL_CLAUSES_MASTER a, TRAVEL_SCHEME_OPTION_COVERS b  WHERE a.status IN ('Y', 'PS', 'ES', 'GS', 'WS')  AND a.product_id = ?  AND b.cover_id = A.COVER_ID  AND B.SCHEME_ID = ?  AND B.OPTION_ID = ? AND B.BRANCH_CODE=? AND B.PRODUCT_CODE=?  ORDER BY   display_order
GET_QUOTE_COUNT=select count(*) from Home_position_master where INCEPTION_DATE > SYSDATE and quote_no=?
UPDATE_QUOTE_C=update Home_position_master set STATUS=?,cancelled_reason=?,cancelled_date=SYSDATE,cancelled_by=? where POLICY_NO=?
UPDATE_QUOTE_I=UPDATE Home_position_master SET status = 'I' WHERE quote_no = ? AND amend_id=(SELECT MAX(amend_id) FROM Home_position_master where QUOTE_NO = ? )
INS_PERSONAL_INFO = INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,FIRST_NAME,EMAIL,ENTRY_DATE,LOGIN_ID,AMEND_ID,AGENCY_CODE,OA_CODE) VALUES(?,'1',?,?,TO_DATE(SYSDATE,'DD/MM/YYYY'),?,'0','','')
UPDATE_PERSONAL_INFO = UPDATE PERSONAL_INFO SET ADDRESS1=?,POBOX=?,EMIRATE=?,TELEPHONE=?,MOBILE=?,OCCUPATION=?,CUSTOMER_SOURCE=?,STATUS='Y' WHERE CUSTOMER_ID=?
UPD_CUSTOMER_INFO = UPDATE PERSONAL_INFO SET FIRST_NAME=?,EMAIL=? WHERE CUSTOMER_ID=?
#GET_B2CTRAVEL_USERLIST_ISSUER=SELECT DISTINCT PM.LOGIN_ID LOGIN_ID,PM.LOGIN_ID FIRST_NAME,BCM.COMPANY_NAME || ' ( ' || PM.LOGIN_ID || ' ) ' USERNAME FROM HOME_POSITION_MASTER PM,LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE PM.APPLICATION_ID != ? AND LM.LOGIN_ID=PM.LOGIN_ID AND LM.OA_CODE=BCM.AGENCY_CODE AND PM.STATUS in ('Y') AND PM.PRODUCT_ID = ?
GET_B2CTRAVEL_USERLIST_ISSUER=SELECT LM.LOGIN_ID LOGIN_ID, LM.LOGIN_ID FIRST_NAME, BCM.COMPANY_NAME || ' ( ' || LM.LOGIN_ID || ' ) ' USERNAME FROM LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE LM.AGENCY_CODE IN (SELECT DISTINCT LM.OA_CODE FROM HOME_POSITION_MASTER PM, LOGIN_MASTER LM WHERE PM.APPLICATION_ID != ? AND LM.LOGIN_ID = PM.LOGIN_ID AND PM.STATUS IN ('Y','P') AND PM.PRODUCT_ID = ?) AND LM.OA_CODE = BCM.AGENCY_CODE
GET_MONTH_COUNT_PASSPORTEXPDATE =SELECT  CATEGORY_DETAIL_ID FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=162 
###Motor User Registration - End

#### COMMON QUERIES ##################
LOG_BRANCH_FROM_BCM=SELECT ISNULL(BRANCH_CODE,'020') FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?)
LOG_BRANCH_FROM_LM=select nvl(BRANCH_CODE,'020') from LOGIN_master where login_id=?
GET_DEFAULT_BRANCH=SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID='116' AND CATEGORY_DETAIL_ID=1 AND STATUS='Y' and branch_code=?
GET_PROD_BROK=SELECT PRODUCT_ID, PRODUCT_NAME FROM PRODUCT_MASTER WHERE STATUS='Y' AND BRANCH_CODE=(SELECT   BELONGING_BRANCH FROM   BRANCH_MASTER BM WHERE   BRANCH_CODE = ? AND STATUS = 'Y'  AND AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   BRANCH_MASTER BM1 WHERE   BM1.BRANCH_CODE = BM.BRANCH_CODE  AND BM1.STATUS = BM.STATUS)) AND PRODUCT_ID IN (SELECT PRODUCT_ID FROM LOGIN_USER_DETAILS WHERE AGENCY_CODE=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE  LOGIN_ID=?) AND STATUS='Y') ORDER BY DISPLAY_ORDER ASC
GET_BROKUSER_DET=SELECT CURRENCY_ABBREVIATION,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,CURRENCY_ABBREVIATION,DECIMAL_PLACES,nvl(TAX,'0') TAX,EMAIL,LANG_YN FROM BRANCH_MASTER WHERE BRANCH_CODE=?
GET_ADMIN_PROD=SELECT PRODUCT_ID FROM LOGIN_MASTER WHERE LOGIN_ID=?
GET_PROD_LIST=SELECT PRODUCT_ID, PRODUCT_NAME FROM PRODUCT_MASTER WHERE STATUS=''Y'' AND BRANCH_CODE=(SELECT   BELONGING_BRANCH FROM   BRANCH_MASTER BM WHERE   BRANCH_CODE = ? AND STATUS = ''Y''  AND AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   BRANCH_MASTER BM1 WHERE   BM1.BRANCH_CODE = BM.BRANCH_CODE  AND BM1.STATUS = BM.STATUS)) AND PRODUCT_ID IN (''{0}'') ORDER BY DISPLAY_ORDER ASC
GET_OFSPROD_SCHEM=SELECT S.SCHEME_ID,(P.PRODUCT_NAME||' - '||S.SCHEME_NAME) SCHEME_NAME, P.PRODUCT_ID FROM PRODUCT_MASTER P,OFS_SCHEME_MASTER S WHERE P.STATUS=S.STATUS AND S.STATUS='Y' AND P.BRANCH_CODE=S.BRANCH_CODE AND S.BRANCH_CODE=? AND S.PRODUCT_ID=P.PRODUCT_ID AND S.SCHEME_ID IN (SELECT SCHEME_ID FROM LOGIN_USER_DETAILS WHERE SCHEME_ID IS NOT NULL AND AGENCY_CODE=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND STATUS='Y') ORDER BY S.SCHEME_ID
GET_CUST_RIGHT=SELECT PRODUCT_ID,CUSTOMER_QUOTE,CUSTOMER_SCHEDULE,CUSTOMER_DEBIT,CUSTOMER_CUSTOMERDEBIT,CUSTOMER_POLICY,CUSTOMER_CERTIFICATE,FREIGHT_DEBIT_OPTION FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? ORDER BY PRODUCT_ID
GET_BROKDC=select count(*) from LOGIN_USER_DETAILS where oa_code=(select oa_code from login_master where login_id=?) and CUSTOMER_CERTIFICATE='Y' and product_id='11'
GET_LOGIN_BRANCH=select BRANCH_CODE , BRANCH_NAME from branch_master where STATUS='Y' AND REGION_CODE=? ORDER BY TO_NUMBER(BRANCH_CODE)
GET_LOGIN_REGION=select REGION_CODE , REGION_NAME from REGION_MASTER where STATUS='Y'
GET_MAX_ID1=SELECT nvl(POLICY_PREFIX,'') PREFIX,nvl(CURRENT_NO+1,START_NO) MAXNO FROM POLICYNO_GENERATE WHERE TYPE_ID\=(SELECT 
GET_MAX_ID2=FROM BRANCH_DETAIL WHERE BRANCH_CODE=? AND PRODUCT_ID=?) AND STATUS='Y' AND BRANCH_CODE=? AND PRODUCT_ID=?
UPD_MAX_ID1=UPDATE POLICYNO_GENERATE SET CURRENT_NO\=?,REMARKS\=? WHERE TYPE_ID\=(SELECT  
UPD_MAX_ID2=FROM BRANCH_DETAIL WHERE BRANCH_CODE\=? AND PRODUCT_ID\=?) AND STATUS\='Y' AND BRANCH_CODE\=? AND PRODUCT_ID\=?
GET_STAMP_STATUS=select nvl(home.PDF_Stamp_Status,' ') from POSITION_MASTER home where 
GET_MXT_AMD=select nvl(max(amend_id),'0')+1 from draft_pdf_tracking where quote_no=?

GET_MAILBEAN=select application_no,login_id,product_id,nvl(open_cover_no,''0''),quote_no from position_master where {0}
################################################################################################


### NIJM AUTHENTICATION########
 
NIJM_USERNAME=WalaaMotor
NIJM_PASSWORD=Ivox@walaa
NIJM_SVC_FILENAME=https://ic.najm.sa:8089/InsuranceInquiry.svc


############### NIJM ############################
NIJM_MAX_LIMT=select  DETAIL_NAME from constant_Detail where CATEGORY_ID=157 and CATEGORY_DETAIL_ID='1'
NIJM_REC_COUNT=select count(*) from  nijm_accidental_details where DriverID=?
NIJM_LIAB_LIMT=select  DETAIL_NAME from constant_Detail where CATEGORY_ID=157 and CATEGORY_DETAIL_ID='2'
NIJM_LIB_SUM= select nvl(sum(to_number(Liability)),0)  FROM nijm_accidental_details  WHERE   DriverID = ? and to_date(AccidentDate,'dd/mm/yyyy')>to_date(add_months(SYSDATE,-12),'dd/mm/yyyy')
NIJM_ACCDINT_DET=select CaseNumber,AccidentDate,Liability,CityName,DriverAge,CarModel,CarType,DriverID,SequenceNumber,OwnerID,EstimatedAmount,DamageParts ,CauseOfAccident,CaseDetails_Id from  nijm_accidental_details where DriverID=?
NJIM_LIB_INSERT=insert into nijm_accidental_details (CaseNumber,AccidentDate,Liability,CityName,DriverAge,CarModel,CarType,DriverID,SequenceNumber,OwnerID,EstimatedAmount,DamageParts,CauseOfAccident,recived_date) values (?,?,?,?,?,?,?,?,?,?,?,?,?,SYSTIMESTAMP)
##upload 
DEL_DOCUMENTS=delete  from DOCUMENT_UPLOAD_DETAILS Where FILE_PATH_NAME=?
GET_DOCUMENTS_COUNT_HOME=select count(*) from DOCUMENT_UPLOAD_DETAILS Where QUOTE_NO\=? 
GET_DOCUMENTS_COUNT_MOTOR=select count(*) from DOCUMENT_UPLOAD_DETAILS Where QUOTE_NO=?  AND VTYPE_ID=?
INS_DOCUMENTS =INSERT INTO DOCUMENT_UPLOAD_DETAILS(QUOTE_NO,DOC_TYPE_ID,FILE_PATH_NAME,DESCRIPTION,STATUS,FILE_NAME,PRODUCT_ID,VTYPE_ID)VALUES(?,?,?,?,?,?,?,?)
GET_UPLOAD_DOCUMENTS_LIST_HOME= SELECT  DM.DOCUMENT_ID, DM.DOCUMENT_DESC, DUD.FILE_PATH_NAME, DUD.FILE_NAME, DUD.DESCRIPTION FROM DOCUMENT_UPLOAD_DETAILS DUD,DOCUMENT_MASTER DM where DUD.QUOTE_NO=? and DUD.PRODUCT_ID=? AND  DUD.DOC_TYPE_ID=DM.DOCUMENT_ID
GET_UPLOAD_DOCUMENTS_LIST_MOTOR= SELECT  DM.DOCUMENT_ID, DM.DOCUMENT_DESC, DUD.FILE_PATH_NAME, DUD.FILE_NAME, DUD.DESCRIPTION FROM DOCUMENT_UPLOAD_DETAILS DUD,DOCUMENT_MASTER DM where DUD.QUOTE_NO=? and DUD.PRODUCT_ID=? and VTYPE_ID=? AND  DUD.DOC_TYPE_ID=DM.DOCUMENT_ID
########################################

################################################################################################
################################################################################################

############### Kindly Add the query below the specific product / Menu / Master ################
############### Please Dont Add Below This ############################################################
################################################################################################
################################################################################################
GET_CUSTOMER_INFORMATION=SELECT   PI.CUSTOMER_ID,PI.TITLE,NVL (PI.FIRST_NAME, PI.COMPANY_NAME) NAME,PI.MOBILE,PI.EMAIL,PI.ADDRESS1,PI.ADDRESS2,PI.POBOX,PI.EMIRATE,PI.MISSIPPI_CUSTOMER_CODE,PI.CLIENT_CUSTOMER_ID,PI.CUST_AR_NO,PI.LAST_NAME,PI.NRC,PI.PASSPORT_NUMBER,TO_CHAR (PI.DOB, 'DD/MM/YYYY') CUST_DOB,PI.DOB_AR CUST_DOB_AR,PI.ALTERNATE_MOBILE,PI.TELEPHONE,PI.CUSTOMER_TYPE,PI.COMPANY_REG_NO,PI.CUST_NAME_ARABIC,PI.GENDER,PI.OCCUPATION,PI.CUST_NAME_ARABIC,PI.DOB_AR,HPM.AC_EXECUTIVE_ID,HPM.BROKER_CODE FROM   HOME_POSITION_MASTER HPM, PERSONAL_INFO PI WHERE





#######################################################################################################################
################################################### OPEN COVER ########################################################
######################################################################################################################@

getBrokerDetail=select nvl(company_name,'0'), nvl(contact_person,'0') from broker_company_master where agency_code \= (select oa_code from login_master where login_id \= (select broker_id from open_cover_master where proposal_no\= ?  and amend_id \= (select max(amend_id) from open_cover_master where proposal_no\= ? )))
getDetails=select a.proposal_no,nvl(a.open_cover_no,'0'),nvl(to_char(b.policy_start_date,'DD-mm-YYYY'),' '),nvl(to_char(b.policy_end_date,'DD-mm-YYYY'),' '),nvl(first_name,nvl(company_name,' ')) from open_cover_position_master a, open_cover_master b,personal_info c where a.status='Y' and a.proposal_no = b.proposal_no and b.amend_id = (select max(amend_id) from open_cover_master b where b.proposal_no = a.proposal_no) and c.customer_id =b.customer_id order by a.proposal_no
getDetailsApproved=select a.proposal_no,nvl(a.open_cover_no,'0'),nvl(to_char(b.policy_start_date,'DD-mm-YYYY'),' '),nvl(to_char(b.policy_end_date,'DD-mm-YYYY'),' '),nvl(first_name,nvl(company_name,' ')) from open_cover_position_master a, open_cover_master b,personal_info c where a.status='P' and a.proposal_no = b.proposal_no and b.amend_id = (select max(amend_id) from open_cover_master b where b.proposal_no = a.proposal_no) and c.customer_id =b.customer_id order by a.proposal_no
balanceAmount = trim(to_char(nvl(d.CROSS_VOYAGE_TURNOVER,0)-nvl(d.UTILIZED_AMOUNT,0),'999G999G999G999G999G999G999G999G990'))
getportfolioDetails=SELECT DISTINCT (A.PROPOSAL_NO), NVL (A.OPEN_COVER_NO, '0'), NVL (TO_CHAR (B.OPEN_COVER_START_DATE, 'DD-mm-YYYY'), ' '), NVL (TO_CHAR (B.OPEN_COVER_END_DATE, 'DD-mm-YYYY'), ' '), NVL (C.FIRST_NAME, C.COMPANY_NAME), D.CUSTOMER_ID, B.AMEND_ID, D.MISSIPPI_OPENCOVER_NO,A.STATUS, A.ENDT_STATUS, A.ORIGINAL_POLICY_NO, D.debit_note_no, D.credit_note_no,trim(to_char(nvl(d.CROSS_VOYAGE_TURNOVER,0)-nvl(d.UTILIZED_AMOUNT,0),'999G999G999G999G999G999G999G999G990'))  FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_DETAIL B, PERSONAL_INFO C, OPEN_COVER_MASTER D WHERE (A.STATUS = 'P' OR (A.STATUS='Y' AND ORIGINAL_POLICY_NO IS NOT NULL)) AND A.PROPOSAL_NO = B.PROPOSAL_NO AND TRUNC(A.EXPIRY_DATE) >= TRUNC(SYSDATE) AND B.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND A.PROPOSAL_NO IN (SELECT (PROPOSAL_NO) FROM OPEN_COVER_MASTER WHERE BROKER_ID = D.BROKER_ID) AND D.PROPOSAL_NO = A.PROPOSAL_NO AND C.CUSTOMER_ID = D.CUSTOMER_ID AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND D.BROKER_ID=? ORDER BY A.PROPOSAL_NO DESC
getportfolioDetails_NOTEMPTY=SELECT DISTINCT (A.PROPOSAL_NO), NVL (A.OPEN_COVER_NO, '0'), NVL (TO_CHAR (B.OPEN_COVER_START_DATE, 'DD-mm-YYYY'), ' '), NVL (TO_CHAR (B.OPEN_COVER_END_DATE, 'DD-mm-YYYY'), ' '), NVL (C.FIRST_NAME, C.COMPANY_NAME), D.CUSTOMER_ID, B.AMEND_ID, D.MISSIPPI_OPENCOVER_NO,A.STATUS, A.ENDT_STATUS, A.ORIGINAL_POLICY_NO, D.debit_note_no, D.credit_note_no,trim(to_char(nvl(d.CROSS_VOYAGE_TURNOVER,0)-nvl(d.UTILIZED_AMOUNT,0),'999G999G999G999G999G999G999G999G990')) FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_DETAIL B, PERSONAL_INFO C, OPEN_COVER_MASTER D WHERE (A.STATUS = 'P' OR (A.STATUS='Y' AND ORIGINAL_POLICY_NO IS NOT NULL)) AND A.PROPOSAL_NO = B.PROPOSAL_NO AND TRUNC(A.EXPIRY_DATE) >= TRUNC(SYSDATE) AND B.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND A.PROPOSAL_NO IN (SELECT (PROPOSAL_NO) FROM OPEN_COVER_MASTER WHERE BROKER_ID = D.BROKER_ID) AND D.PROPOSAL_NO = A.PROPOSAL_NO AND C.CUSTOMER_ID = D.CUSTOMER_ID AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND A.OPEN_COVER_NO LIKE ? ORDER BY A.PROPOSAL_NO DESC
getportfolioDetails_EMPTY=SELECT DISTINCT (A.PROPOSAL_NO), NVL (A.OPEN_COVER_NO, '0'), NVL (TO_CHAR (B.OPEN_COVER_START_DATE, 'DD-mm-YYYY'), ' '), NVL (TO_CHAR (B.OPEN_COVER_END_DATE, 'DD-mm-YYYY'), ' '), NVL (C.FIRST_NAME, C.COMPANY_NAME), D.CUSTOMER_ID, B.AMEND_ID, D.MISSIPPI_OPENCOVER_NO,A.STATUS, A.ENDT_STATUS, A.ORIGINAL_POLICY_NO, D.debit_note_no, D.credit_note_no,trim(to_char(nvl(d.CROSS_VOYAGE_TURNOVER,0)-nvl(d.UTILIZED_AMOUNT,0),'999G999G999G999G999G999G999G999G990')) FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_DETAIL B, PERSONAL_INFO C, OPEN_COVER_MASTER D WHERE (A.STATUS = 'P' OR (A.STATUS='Y' AND ORIGINAL_POLICY_NO IS NOT NULL)) AND A.PROPOSAL_NO = B.PROPOSAL_NO AND TRUNC(A.EXPIRY_DATE) >= TRUNC(SYSDATE) AND B.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND A.PROPOSAL_NO IN (SELECT (PROPOSAL_NO) FROM OPEN_COVER_MASTER WHERE BROKER_ID = D.BROKER_ID) AND D.PROPOSAL_NO = A.PROPOSAL_NO AND C.CUSTOMER_ID = D.CUSTOMER_ID AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND D.BROKER_ID=? AND (A.OPEN_COVER_NO LIKE ? or A.ORIGINAL_POLICY_NO LIKE ? ) ORDER BY A.PROPOSAL_NO DESC
getQuoteDetails=select distinct(a.proposal_no),nvl(a.open_cover_no,'0'),nvl(to_char(b.policy_start_date,'DD-mm-YYYY'),' '),nvl(to_char(b.policy_end_date,'DD-mm-YYYY'),' '),nvl(first_name,company_name),RENEWAL_STATUS,b.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_master b,personal_info c where a.status='Y' and a.original_policy_no is null and a.proposal_no = b.proposal_no and b.amend_id = (select max(amend_id) from open_cover_master b where b.proposal_no = a.proposal_no) and a.proposal_no in (select proposal_no from open_cover_master where broker_id=?) and c.customer_id =b.customer_id order by a.proposal_no desc
getQuoteDetails1=select a.proposal_no,nvl(to_char(b.open_cover_start_date,'DD-mm-YYYY'),' '),nvl(to_char(b.open_cover_end_date,'DD-mm-YYYY'),' ') from open_cover_position_master a,open_cover_detail b where a.status='Y' and a.original_policy_no is null and b.proposal_no=a.proposal_no and b.amend_id=(select max(amend_id) from open_cover_detail where proposal_no=a.proposal_no)
getAdminLapsedPortfolioDetails=select distinct(a.proposal_no),nvl(a.open_cover_no,'0'),nvl(to_char(b.open_cover_start_date,'DD-mm-YYYY'),' '),nvl(to_char(b.open_cover_end_date,'DD-mm-YYYY'),' '),nvl(c.first_name,c.company_name),d.customer_id,b.amend_id,d.MISSIPPI_OPENCOVER_NO,a.admin_status from open_cover_position_master a, open_cover_detail b,personal_info c,open_cover_master d where a.status in('P') and a.proposal_no = b.proposal_no and ((trunc(a.expiry_date)-trunc(sysdate))<=7 or a.admin_status='N') and nvl(a.renewal_status,' ')!='R' and  b.amend_id = (select max(amend_id) from open_cover_detail  where proposal_no = a.proposal_no) and a.proposal_no in (select (proposal_no) from open_cover_master where broker_id=?) and d.proposal_no=a.proposal_no and c.customer_id =d.customer_id and d.amend_id=(select max(amend_id) from open_cover_master where proposal_no=a.proposal_no) And A.amend_id=(Select max(Amend_id) from open_cover_position_master oc WHere nvl(A.original_policy_no,A.open_Cover_no)=nvl(oc.original_policy_no,oc.open_cover_no) and a.status=oc.status) order by a.proposal_no desc
openCoverActiveDeactive=update open_cover_position_master set expiry_date=(select add_months(sysdate,12)-1 from dual) where Proposal_no= ?
openCoverActiveDeactive1=update OPEN_COVER_DETAIL set OPEN_COVER_END_DATE=(select add_months(sysdate,12)-1 from dual) where Proposal_no= ?
openCoverActiveDeactive2=update open_cover_master set POLICY_END_DATE=(select add_months(sysdate,12)-1 from dual) where Proposal_no=? and AMEND_ID = (select max(amend_id) from OPEN_COVER_MASTER where Proposal_no = ?)
opencoverDeactive=update open_cover_position_master set status='D' where Proposal_no = ?
getDeActvatedPortfolioDetails=select distinct(a.proposal_no),nvl(a.open_cover_no,'0'),nvl(to_char(b.open_cover_start_date,'DD-mm-YYYY'),' '),nvl(to_char(b.open_cover_end_date,'DD-mm-YYYY'),' '),nvl(c.first_name,c.company_name),d.customer_id,b.amend_id,d.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_detail b,personal_info c,open_cover_master d where a.status='D' and a.proposal_no = b.proposal_no and b.amend_id = (select max(amend_id) from open_cover_detail  where proposal_no = a.proposal_no) and a.proposal_no in (select (proposal_no) from open_cover_master where broker_id=?) and d.proposal_no=a.proposal_no and c.customer_id =d.customer_id and d.amend_id=(select max(amend_id) from open_cover_master where proposal_no=a.proposal_no) order by a.proposal_no desc
openCoverDeactivate=update OPEN_COVER_POSITION_MASTER set admin_status='N' where PROPOSAL_NO=?
openCoverDeactivate1=select status from open_cover_position_master where PROPOSAL_NO=?
openCoverDeactivate2=Select original_policy_no,amend_id-1  from OPEN_COVER_POSITION_MASTER where proposal_no=?
openCoverDeactivate3=update OPEN_COVER_POSITION_MASTER set endt_status='' where  OPEN_COVER_NO=? and amend_id=?
openCoverDeactivate4=update OPEN_COVER_POSITION_MASTER set endt_status='' where  original_policy_no=? and amend_id=?
openCoverActivate=update OPEN_COVER_POSITION_MASTER set admin_status\='Y' where PROPOSAL_NO\=?
getBrokers=select a.company_name,b.login_id,a.agency_code from broker_company_master a,login_master b where b.agency_code=a.agency_code order by a.company_name
getBrokersQuoteRegister=select distinct a.company_name,b.login_id from broker_company_master a,login_master b,open_cover_master c where b.agency_code=a.agency_code and c.broker_id=b.login_id and c.proposal_no in (select proposal_no from open_cover_position_master where open_cover_no is  null and status='Y') order by a.company_name
getBrokersHasCover=select distinct a.company_name,b.login_id from broker_company_master a,login_master b,open_cover_master c where b.agency_code=a.agency_code and c.broker_id=b.login_id and c.proposal_no in (select proposal_no from open_cover_position_master where open_cover_no is not null and status='P') order by a.company_name
getCountrys=select cm.COUNTRY_ID,cm.COUNTRY_NAME,cm.sno__,cm.amend_id from COUNTRY_MASTER cm where cm.status in ('Y','R') and cm.amend_id||cm.COUNTRY_ID in (select  max(amend_id)||COUNTRY_ID from COUNTRY_MASTER where  to_date(effective_date,'dd-MON-YYYY')<=to_date(SYSDATE,'dd-MON-YYYY') and status in('Y','R')  group by COUNTRY_ID) and to_date(cm.effective_date,'dd-MON-YYYY')<=to_date(SYSDATE,'dd-MON-YYYY')  group by cm.COUNTRY_ID,cm.COUNTRY_NAME,cm.amend_id,cm.sno__ order by cm.COUNTRY_NAME
getContientList=select * from constant_detail where CATEGORY_ID=? AND BRANCH_CODE=? AND STATUS=?
getTransports=select distinct TRANSPORT_DESCRIPTION ,MODE_TRANSPORT_ID from MODE_OF_TRANSPORT
getOPCRAI=select nvl(COUNTRY_REMARKS,''),ADDITIONAL_INSURED,ADDITIONAL_INSURED_NAME from open_cover_master where proposal_no=? and amend_id=(select max(amend_id)  from open_cover_master where proposal_no=? )
getDELOC=delete from open_cover_master where proposal_no=? and product_id=?
GETMAXOCAMD=select nvl(max(amend_id)+1,'0') from open_cover_master where proposal_no=?
INSTOCM=insert into open_cover_master(proposal_no,amend_id,product_id,broker_id,broker_user_id,customer_id,branch_code,cross_voyage,cross_voyage_turnover,cross_voyage_suminsured_limit,back_date_days,commission,free_text_allowed,no_of_insurance_company,status,cross_voyage_percentage,effective_date,rsa_shared_percentage,type,min_premium,missippi_opencover_no,business_type,MISSISSIPI_OPEN_POLICY_ID,IMPORT_MIN_PREMIUM_AMOUNT,EXPORT_MIN_PREMIUM_AMOUNT,WRSC_YN,CROSS_MIN_PREMIUM_AMOUNT,POLICY_START_DATE,POLICY_END_DATE,COUNTRY_REMARKS,CURRENCY_ID,EXCHANGE_RATE,ISSUANCE_FEE,MIN_PREMIUM_ISSUANCE_FEE,FOREIGN_TURNOVER,MIN_PRE_MUL_TYPE,MIN_PRE_MUL,ADDITIONAL_INSURED,ADDITIONAL_INSURED_NAME,LOSS_DETAIL,CLAIM_RATIO,ADDITIONAL_INFO,PROPOSAL_STATUS,CONFIRM_STATUS,login_id,CLAUSES_YN,EXECUTIVE_ID,DEBIT_NOTE,UTILIZED_AMOUNT,DECLARATIONTYPE,NO_OF_VEHICLES,HAULIER_PREMIUM,DEBIT_TO_ID,CREDIT_TO_ID)values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,to_date(?,'dd-mm-yyyy'),to_date(?,'dd-mm-yyyy'),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
UPDGUEST=UPDATE OPEN_COVER_MASTER SET GUEST_LOGIN_STATUS=? WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
UPDOCDETAIL=UPDATE OPEN_COVER_DETAIL SET OPEN_COVER_START_DATE=TO_DATE(?,'dd-mm-yyyy'), OPEN_COVER_END_DATE=TO_DATE(?,'dd-mm-yyyy') WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO=?)
checkmisscodeProce=call VALIDATE_CIMS_POLICY(?,?)
getCOUNTOCP=select count(*) from open_cover_position_master where proposal_no=?
INSTOCP=insert into open_cover_position_master(proposal_no,amend_id,status,ckey,INCEPTION_DATE,EXPIRY_DATE,CERT_NO)values(?,?,?,?,TO_DATE(?,'dd-mm-yyyy'),TO_DATE(?,'dd-mm-yyyy'),?)
UPDTOCP=UPDATE OPEN_COVER_POSITION_MASTER SET INCEPTION_DATE=TO_DATE(?,'dd-mm-yyyy'), EXPIRY_DATE=TO_DATE(?,'dd-mm-yyyy'),CKEY=?,CERT_NO=? WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER WHERE PROPOSAL_NO=?)
UPDTOCPM=UPDATE OPEN_COVER_POSITION_MASTER SET INCEPTION_DATE=TO_DATE(?,'dd-mm-yyyy'), EXPIRY_DATE=TO_DATE(?,'dd-mm-yyyy'),CERT_NO=? WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER WHERE PROPOSAL_NO=?)
SELCTOCPD=select a.broker_id,nvl(b.first_name,b.company_name),a.type,a.customer_id,a.back_date_days,a.FOREIGN_TURNOVER,a.RSA_SHARED_PERCENTAGE,a.NO_OF_INSURANCE_COMPANY,a.cross_voyage,a.cross_voyage_percentage,a.free_text_allowed,a.commission,nvl(min_premium,'0'),nvl(missippi_opencover_no,''),nvl(business_type,'0'),nvl(MISSISSIPI_OPEN_POLICY_ID,''),nvl(IMPORT_MIN_PREMIUM_AMOUNT,'0'),nvl(EXPORT_MIN_PREMIUM_AMOUNT,'0'),nvl(Pro_commission,'0'),to_char(pro_start_date,'dd-mm-yyyy'),to_char(pro_expiry_date,'dd-mm-yyyy'),nvl(WRSC_YN,'N'),a.BROKER_USER_ID,nvl(a.CROSS_MIN_PREMIUM_AMOUNT,0),TO_CHAR(POLICY_START_DATE,'dd') AS DAYS,TO_CHAR(POLICY_START_DATE,'mm') AS MONTHS,TO_CHAR(POLICY_START_DATE,'YYYY') AS YEARS,TO_CHAR(POLICY_END_DATE,'dd') AS DAYS,TO_CHAR(POLICY_END_DATE,'mm') AS DAYS,TO_CHAR(POLICY_END_DATE,'YYYY') AS YEARS,CURRENCY_ID,EXCHANGE_RATE,ISSUANCE_FEE,MIN_PREMIUM_ISSUANCE_FEE,MIN_PRE_MUL_TYPE,MIN_PRE_MUL,C.RENEWAL_STATUS,C.ENDT_STATUS,A.LOSS_DETAIL,A.CLAIM_RATIO,A.ADDITIONAL_INFO,A.GUEST_LOGIN_STATUS,A.EXECUTIVE_ID,A.DEBIT_NOTE,A.UTILIZED_AMOUNT,A.DECLARATIONTYPE,A.NO_OF_VEHICLES,A.HAULIER_PREMIUM,C.CERT_NO from open_cover_master a ,personal_info b,OPEN_COVER_POSITION_MASTER C where a.proposal_no=? and a.amend_id=(select max(a.amend_id) from open_cover_master a where a.proposal_no=?) and b.customer_id=a.customer_id AND C.PROPOSAL_NO=A.PROPOSAL_NO
CHCKMISPICODE=select count(*) from open_cover_master where missippi_opencover_no in (''{0}'') and proposal_no not in (''{1}'')
PROPSEQ=SELECT PROPOSAL_NUMBER_SEQ.NEXTVAL FROM DUAL
getLCs=select OPEN_COVER_NO,BANK_ID,LC_NUMBER,LC_DATE,LC_AMOUNT,ENTRY_DATE,EXPIRY_DATE,EFFECTIVE_DATE,AMEND_ID,REMARKS,STATUS,LC_ID,LC_CURRENCY_ID from OPEN_COVER_LC_MASTER  where  OPEN_COVER_NO=? and status='Y' and LC_NUMBER not in ('None','NONE')
getBname=select bank_name from open_cover_bank_master where bank_id=? and status='Y' and BELONGING_COUNTRY_ID=?
getLcDetails=select OPEN_COVER_NO,BANK_ID,LC_NUMBER,to_char(LC_DATE,'DD') DAY,to_char(LC_DATE,'MM') MONTH,to_char(LC_DATE,'YYYY') YEAR,LC_CURRENCY_ID,LC_AMOUNT,ENTRY_DATE,EXPIRY_DATE,EFFECTIVE_DATE,AMEND_ID,REMARKS,STATUS,LC_ID,to_char(EXPIRY_DATE,'DD') DAY,to_char(EXPIRY_DATE,'MM') MONTH,to_char(EXPIRY_DATE,'YYYY') from OPEN_COVER_LC_MASTER  where  OPEN_COVER_NO=? and  LC_ID=?
getCName=select currency_name from currency_master where currency_id=? and status='Y' and amend_id=(select max(amend_id) from currency_master where currency_id=? and COUNTRY_ID=? and status='Y')
getsLCDetailsByOpenCover=select  OPEN_COVER_NO,BANK_ID,LC_NUMBER,LC_DATE,LC_AMOUNT,ENTRY_DATE,EXPIRY_DATE,EFFECTIVE_DATE,AMEND_ID,REMARKS,STATUS,LC_ID from open_cover_lc_master where lc_id=? and open_Cover_no=?
getCertificates=select a.open_cover_no,a.policy_no,b.total_sum_insured,b.exchange_rate,b.total_sum_insured*b.exchange_rate suminsured,b.open_lc_id,a.login_id,c.lc_number,c.LC_AMOUNT from position_master a,marine_Data b,open_Cover_lc_master c where a.application_no=b.application_no and b.open_lc_id=c.lc_id and a.open_cover_no=c.open_cover_no and a.open_cover_no=? and c.lc_number=? and  a.status='P'
GET_BROKER_CMPY=SELECT BCM.COMPANY_NAME,PI.LOGIN_ID FROM BROKER_COMPANY_MASTER BCM,PERSONAL_INFO PI,LOGIN_MASTER LM,LOGIN_USER_DETAILS LUD WHERE BCM.AGENCY_CODE=PI.AGENCY_CODE AND BCM.STATUS='Y' AND PI.STATUS=BCM.STATUS AND PI.APPLICATION_ID = '2' AND PI.LOGIN_ID=LM.LOGIN_ID AND LM.STATUS!='N' AND LM.OA_CODE=LUD.OA_CODE AND LUD.PRODUCT_ID='11' AND LUD.AGENCY_CODE=BCM.AGENCY_CODE AND BCM.BRANCH_CODE=?
GET_DIR_LOGIN=select remarks from constant_detail where category_id='129' and branch_code=?
GETEXECUTEVLIST=SELECT AC_EXECUTIVE_ID, AC_EXECUTIVE_NAME FROM LOGIN_EXECUTIVE_DETAILS WHERE STATUS='Y' ORDER BY AC_EXECUTIVE_NAME
getBrokersQuoteRegister_C=select bcm.company_name,pi.login_id from BROKER_COMPANY_MASTER bcm,personal_info pi where bcm.agency_code=pi.agency_code  and bcm.status=''Y'' and pi.status=bcm.status and pi.APPLICATION_ID=''2'' and pi.login_id in(select distinct ocm.broker_id from OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm where ocm.broker_id in(select login_id from login_master where status!='''N'' and oa_code in(select agency_code from broker_company_master where branch_code in(''{0}''))) and ocpm.STATUS=''Y'' and ocm.PROPOSAL_NO=ocpm.PROPOSAL_NO) order by lower(bcm.COMPANY_NAME)
getBrokersHasCover_C=select  bcm.company_name,pi.login_id from BROKER_COMPANY_MASTER bcm,personal_info pi where bcm.agency_code=pi.agency_code  and bcm.status=''Y'' and pi.status=bcm.status and pi.APPLICATION_ID=''2'' and pi.login_id in(select distinct ocm.broker_id from OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm where ocm.broker_id in(select login_id from login_master where status!=''N'' and oa_code in(select agency_code from broker_company_master where branch_code in({0}))) and ocpm.STATUS in(''P'',''D'') and ocm.PROPOSAL_NO=ocpm.PROPOSAL_NO) order by lower(bcm.COMPANY_NAME)
getDeactivateOpencCoverBrokersHasCover=select  bcm.company_name,pi.login_id from BROKER_COMPANY_MASTER bcm,personal_info pi where bcm.agency_code=pi.agency_code  and bcm.status=''Y'' and pi.status=bcm.status and pi.APPLICATION_ID=''2'' and pi.login_id in(select distinct ocm.broker_id from OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm where ocm.broker_id in(select login_id from login_master where status!=''N'' and oa_code in(select agency_code from broker_company_master where branch_code in({0}))) and ocpm.STATUS in(''D'',''P'') and ocm.PROPOSAL_NO=ocpm.PROPOSAL_NO) order by lower(bcm.COMPANY_NAME)
GET_CURRECY=SELECT CURRENCY_ABBREVIATION,DECIMAL_PLACES from BRANCH_MASTER where BRANCH_CODE=?
GET_SALTERM=select sale_term_id,sale_term_name from sale_term_master where branch_code=? and status=? order by sale_term_name
GET_STM=select sale_term_id,sale_term_name from sale_term_master where branch_code=? and status=? and sale_term_id in ({0}) and sale_term_id not in (205) order by sale_term_name
GET_ANAUNAL=SELECT NVL(A.CROSS_VOYAGE_TURNOVER,0) FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
GETOCPMCOUNT=SELECT COUNT(*) FROM OPEN_COVER_POSITION_MASTER WHERE PROPOSAL_NO!=? AND CKEY=?
GETOCTYPELIST=Select Product_id,Product_name from open_cover_product_Details Where  status='Y' and  Branch_code=? order by product_id asc
GETOCTYPPLEIST=SELECT CATEGORY_DETAIL_ID, DETAIL_NAME FROM CONSTANT_DETAIL Where Branch_code=? and CATEGORY_ID = 163  Order by to_number(CATEGORY_DETAIL_ID) Asc
GETMISISPICID=select MISSIPPI_CUSTOMER_CODE from personal_info where customer_id=?
GETBCMAGECY=SELECT RSA_BROKER_CODE FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GETLEXDET=SELECT RSACODE FROM LOGIN_EXECUTIVE_DETAILS WHERE AC_EXECUTIVE_ID=?
GETCONTDETYT=Select decode(Count(*),0,'N','Y') direct_status from constant_detail cd Where cd.branch_code \= ? and  Cd.remarks \=?
getLoginExecutiveDetails=select AC_EXECUTIVE_ID, AC_EXECUTIVE_NAME from login_executive_details where status='Y' and (oa_code=(select agency_code from login_master where login_id=?) or oa_code=(select oa_code from login_master where login_id=?))
getCurrencyCoverInfo=select em.exchange_id,em.currency_id,cm.currency_name from exchange_master em,currency_master cm where em.currency_id=cm.currency_id and em.status=cm.status and em.status='Y' and cm.status='Y' and em.currency_id=? and em.amend_id=(select max(amend_id) from exchange_master where currency_id=? and status='Y')
getCurrencyCoverInfo1=select cm.cover_id,cm.cover_name,cm.mode_transport_id from cover_master cm where cm.mode_transport_id=? and cm.cover_id=? and  cm.status='Y'
getCurrencyCoverInfo2=select * from login_executive_details where ac_executive_id=? and Status='Y'
getCountryCityInfo=select ct.country_id,ct.city_id,ct.city_name,cm.country_name from city_master ct,country_master cm where lower(ct.city_name)=? and ct.country_id=cm.country_id
getCountryCityInfo1=select ct.country_id,ct.city_id as cityId,ct.city_name,cm.country_name from city_master ct,country_master cm where lower(ct.city_name)=lower(''{0}'') and cm.country_id=''{1}'' and ct.country_id=cm.country_id
getLCNumbers=select bank_id,lc_id,lc_number from open_cover_lc_master where status='Y' and open_cover_no=? order by lc_id
getBankNames=select bank_id,bank_name,amend_id from open_cover_bank_master where amend_id||'-'||bank_id in (select max(amend_id)||'-'||bank_id from open_cover_bank_master where to_date(effective_date,'dd-mm-yyyy')<=to_date(SYSDATE,'dd-mm-yyyy') and status in('N','Y') and BELONGING_COUNTRY_ID=? and bank_id in(select bank_id from OPEN_COVER_LC_MASTER where open_cover_no =?) group by bank_id) and status='Y' and BELONGING_COUNTRY_ID=? order by bank_name
getSaleTermValue=select sale_term_value from sale_term_master where sale_term_id=? and branch_code=? and status='Y'
getToleranceValue=select TOLERANCE_VALUE from TOLERANCE_MASTER where TOLERANCE_ID=? and branch_code=? and status='Y'
getModeMaster=select mp.mode_transport_ID, md.transport_description,(mp.SUM_INSURED_LIMIT * mp.EXCHANGE_RATE) from mode_of_transport md, open_cover_detail mp where mp.status\='Y' and mp.proposal_no \= ? and md.BRANCH_CODE\=? and mp.amend_id \= (select max(amend_id) from open_cover_detail where proposal_no \= ?) and md.mode_transport_ID\=mp.mode_transport_ID order by mp.mode_transport_ID
getCoverMaster=select a.mode_transport_id,a.cover_id,b.cover_name from open_cover_sub_detail a,cover_master b  where b.cover_id\=a.cover_id and b.BRANCH_CODE\=? and a.proposal_no\=? and a.amend_id\=(select max(amend_id) from open_cover_sub_detail where proposal_no \=?)
getCommodity=select commodity_id,commodity_name from commoditymaster cm where cm.status in ('Y','R') and BRANCH_CODE=? and cm.amend_id||'-'||cm.commodity_id in(select max(amend_id)||'-'||commodity_id from commoditymaster where to_date(effective_date,'dd-MON-YYYY') <=to_date(SYSDATE,'dd-MON-YYYY') and BRANCH_CODE=? group by commodity_id) order by cm.commodity_name
getExtraCover=select md.sea_options,md.mode_transport_id, md.cover_id from open_cover_sub_detail md  where  md.status\='Y' and md.proposal_no \= ? and md.sea_options \!\= null
getExistingMode=select a.mode_transport_id,a.cover_id,a.sea_options,to_char(a.effective_date,'dd') as days,to_char(a.effective_date,'mm') as months,to_char(a.effective_date,'YYYY') as years,nvl(b.sum_insured_limit,'0'),B.CURRENCY_ID,B.EXCHANGE_RATE,A.COVER_TYPE_ID,location_limit from open_cover_sub_detail a,open_cover_detail b where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and b.proposal_no=a.proposal_no and  b.amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?) and b.mode_transport_id=a.mode_transport_id
getExistingCountry=select to_char(open_cover_start_date,'dd') as days,to_char(open_cover_start_date,'mm') as months,to_char(open_cover_start_date,'YYYY') as years,to_char(open_cover_end_date,'dd') as days,to_char(open_cover_end_date,'mm') as days,to_char(open_cover_end_date,'YYYY') as years,to_char(effective_date,'dd') as days,to_char(effective_date,'mm') as months,to_char(effective_date,'YYYY') as years from open_cover_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?)
getExistingCountry1=select nvl(open_cover_country_id_org,'0'),nvl(open_cover_country_id_dest,'0') from open_cover_country_master  where proposal_no=? and amend_id=(select max(amend_id) from open_cover_country_master where proposal_no=?)
getExistingCountry2=select cm.country_id,cm.country_name from country_master cm where cm.country_id in({0}) and  cm.amend_id||cm.COUNTRY_ID in (select  max(amend_id)||COUNTRY_ID from COUNTRY_MASTER where  to_date(effective_date,''dd-MM-YYYY'')<=to_date(SYSDATE,''dd-MM-YYYY'') and status in(''Y'','''R'')  group by COUNTRY_ID) order by country_id
getExistingCountry3=select SALE_TERM_ID,TOLERANCE_ID,TOLERANCE_NAME from open_cover_sale_term_master where proposal_no=? and PROPOSAL_NO||amend_id in(select PROPOSAL_NO||max(amend_id) from open_cover_sale_term_master where PROPOSAL_NO=? group by PROPOSAL_NO)
getExistingCountry4=select stm.sale_term_id,stm.sale_term_name from sale_term_master stm where stm.sale_term_id in({0}) and stm.status=? and stm.branch_code=?
getExistingCountry5=select nvl(COUNTRY_REMARKS,'') from open_cover_master where proposal_no=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=? )
getExistingCountry6=SELECT TO_CHAR(POLICY_START_DATE,'dd') AS DAYS,TO_CHAR(POLICY_START_DATE,'mm') AS MONTHS,TO_CHAR(POLICY_START_DATE,'YYYY') AS YEARS,TO_CHAR(POLICY_START_DATE,'dd') AS DAYS,TO_CHAR(POLICY_START_DATE,'mm') AS MONTHS,TO_CHAR(POLICY_START_DATE,'YYYY') AS YEARS FROM OPEN_COVER_MASTER A WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
getExistingCountry7=select a.commodity_id,nvl(a.commodity_name_desc,' '),a.fragile,b.commodity_name, a.commodity_type_id from open_cover_commodity_master a,commoditymaster b where a.proposal_no=? and b.BRANCH_CODE=? and a.amend_id=(select max(amend_id) from open_cover_commodity_master where proposal_no=?) and b.commodity_id=a.commodity_id and b.amend_id=(select max(amend_id) from commoditymaster where commodity_id=a.commodity_id and BRANCH_CODE=?) order by commodity_id
storeValue1=SELECT TO_CHAR(POLICY_START_DATE,'dd') AS DAYS,TO_CHAR(POLICY_START_DATE,'mm') AS MONTHS,TO_CHAR(POLICY_START_DATE,'YYYY') AS YEARS,TO_CHAR(POLICY_END_DATE,'dd') AS DAYS,TO_CHAR(POLICY_END_DATE,'mm') AS DAYS,TO_CHAR(POLICY_END_DATE,'YYYY') AS YEARS FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
storeValue2=update open_cover_master set policy_start_date=?,policy_end_date=?,wrsc_YN=?,COUNTRY_REMARKS=?,ADDITIONAL_INSURED=?,ADDITIONAL_INSURED_NAME=?,PROPOSAL_STATUS=? where proposal_no=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
storeValue3=delete from open_cover_detail where proposal_no=?
storeValue4=delete from open_cover_sub_detail where proposal_no=?
storeValue5=delete from open_cover_commodity_master where proposal_no=?
storeValue6=insert into open_cover_detail(open_cover_detail_id,proposal_no,amend_id,mode_transport_id,sum_insured_limit,exchange_id,currency_id,exchange_rate,currency_name,status,effective_date,open_cover_start_date,open_cover_end_date,CONVEYANCE,location_limit)values(?,?,(select nvl(max(amend_id)+1,''0'') from open_cover_detail where proposal_no=''{0}''),?,?,?,?,?,?,?,?,?,?,?,?)
storeValue7=select nvl(max(open_cover_detail_id)+1,'1') from open_cover_detail
storeValue8=select nvl(max(open_cover_sub_detail_id)+1,'1') from open_cover_sub_detail
storeValue9=update open_cover_position_master set inception_date=(select distinct(open_cover_start_date) from open_cover_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?)),expiry_date=(select distinct(open_cover_end_date) from open_cover_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?)) where proposal_no=?
storeValue10=insert into open_cover_sub_detail(open_cover_sub_detail_id,proposal_no,amend_id,mode_transport_id,cover_id,sea_options,status,effective_date,COVER_TYPE_ID)values(?,?,(select nvl(max(amend_id)+1,''0'') from open_cover_sub_detail where proposal_no=''{0}''),?,?,?,?,?,?)
storeValue11=select war_rate from open_cover_country_master where proposal_no=''{0}'' and amend_id=(select max(amend_id) from open_cover_country_master where proposal_no=''{1}'')
storeValue12=insert into open_cover_country_master (open_cover_country_id,proposal_no,amend_id,open_cover_country_id_org,open_cover_country_id_dest,effective_date,status,war_rate)values((select nvl(max(open_cover_country_id)+1,''1'') from open_cover_country_master),?,(select nvl(max(amend_id)+1,''0'') from open_cover_country_master where proposal_no=''{0}''),?,?,?,?,?)
storeValue13=insert into OPEN_COVER_SALE_TERM_MASTER (PROPOSAL_NO,SALE_TERM_ID,AMEND_ID,STATUS,EFFECTIVE_DATE,TOLERANCE_ID,TOLERANCE_NAME) values(?,?,(select nvl(max(amend_id)+1,''0'') from open_cover_sale_term_master where proposal_no=''{0}''),?,?,?,?)
storeValue14=insert into open_cover_commodity_master(proposal_no,amend_id,commodity_id,commodity_name_desc,fragile,effective_date,status,commodity_type_id)values(?,(select nvl(max(amend_id)+1,''0'') from open_cover_commodity_master where proposal_no=''{0}''),?,?,?,?,?,?)
getCommodityTypeId=select CATEGORY_DETAIL_ID,DETAIL_NAME from CONSTANT_DETAIL where CATEGORY_ID=42 and STATUS='Y' and branch_code=?
getWSRCOpt=select nvl(wrsc_YN,'N') from OPEN_COVER_MASTER where PROPOSAL_NO=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
getDefaultClauses=select nvl(CLAUSES_YN,'N') from OPEN_COVER_MASTER where PROPOSAL_NO=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
getFreeTextStatus=select nvl(FREE_TEXT_ALLOWED,'N') from OPEN_COVER_MASTER where PROPOSAL_NO=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
getValueBasis=SELECT CODEDESC FROM TABLE(SELECT OPENCOVERSCHEDULE('basisofvaluation',?,?) FROM DUAL)
getOpenCoverDate=SELECT TO_CHAR(POLICY_START_DATE,'dd') AS DAYS,TO_CHAR(POLICY_START_DATE,'mm') AS MONTHS,TO_CHAR(POLICY_START_DATE,'YYYY') AS YEARS,TO_CHAR(POLICY_END_DATE,'dd') AS DAYS,TO_CHAR(POLICY_END_DATE,'mm') AS DAYS,TO_CHAR(POLICY_END_DATE,'YYYY') AS YEARS FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
getAdditionalInsuredInfo=SELECT BROKER_ID,ADDITIONAL_INSURED,ADDITIONAL_INSURED_NAME,CUSTOMER_ID FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
getConveyance=SELECT OCD.MODE_TRANSPORT_ID,MOT.TRANSPORT_DESCRIPTION,REPLACE(REPLACE(OCD.CONVEYANCE,CHR(10),' '), CHR(13),' ')  FROM OPEN_COVER_DETAIL OCD,MODE_OF_TRANSPORT MOT WHERE OCD.PROPOSAL_NO\=? AND OCD.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO\=OCD.PROPOSAL_NO AND STATUS\='Y' AND TO_DATE(EFFECTIVE_DATE,'DD-MM-YY') <\= TO_DATE(SYSDATE,'DD-MM-YY')) AND OCD.MODE_TRANSPORT_ID\=MOT.MODE_TRANSPORT_ID AND MOT.BRANCH_CODE\=? AND OCD.STATUS\='Y' AND TO_DATE(OCD.EFFECTIVE_DATE,'DD-MM-YY') <\= TO_DATE(SYSDATE,'DD-MM-YY')
getEndtTypeInfo=SELECT ORIGINAL_POLICY_NO, ENDT_TYPE FROM OPEN_COVER_POSITION_MASTER WHERE PROPOSAL_NO=?
updateEndtType=UPDATE OPEN_COVER_POSITION_MASTER SET ENDT_TYPE=? WHERE PROPOSAL_NO=?
getProposalStatus=SELECT NVL(PROPOSAL_STATUS,'Normal'),NVL(CONFIRM_STATUS,'NO') FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
updateApprovedStatus=update open_cover_master set PROPOSAL_STATUS=? where proposal_no=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
updateConfirmStatus=update open_cover_master set CONFIRM_STATUS=? where proposal_no=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
getSelCommodityTypeId=SELECT COMMODITY_ID,COMMODITY_NAME_DESC,FRAGILE,COMMODITY_TYPE_ID ,'OP' FROM OPEN_COVER_COMMODITY_MASTER OCCM WHERE  PROPOSAL_NO=? and OCCM.Amend_id=(select max(amend_id) from OPEN_COVER_COMMODITY_MASTER OC where  occm.proposal_no=oc.proposal_no) and   COMMODITY_ID IN (SELECT COMMODITY_ID FROM COMMODITYMASTER  cm where cm.amend_id=(Select max(amend_id) from commoditymaster c where c.commodity_id=cm.commodity_id and status='Y')) union all SELECT COMMODITY_ID,COMMODITY_NAME,FRAGILE,COMMODITY_TYPE_ID,'COM' FROM commoditymaster CM where status='Y'and COMMODITY_ID not in (SELECT COMMODITY_ID FROM OPEN_COVER_COMMODITY_MASTER OCCM where PROPOSAL_NO=? and OCCM.Amend_id=(select max(amend_id) from OPEN_COVER_COMMODITY_MASTER OC where occm.proposal_no=oc.proposal_no)) and cm.amend_id=(Select max(amend_id) from  commoditymaster c where c.commodity_id=cm.commodity_id and status='Y')
saveCommodity=insert into open_cover_commodity_master(proposal_no,amend_id,commodity_id,commodity_name_desc,fragile,effective_date,status,commodity_type_id)values(?,(select nvl(max(amend_id)+1,'0') from open_cover_commodity_master where proposal_no=''{0}''),?,?,?,?,?,?)
clauesINsert=call CLAUSES_INSERT(?,?)
getSharedLevel1=select a.no_of_insurance_company,a.rsa_shared_percentage,b.insurance_company_id,b.insurance_company_name from open_cover_master a,open_cover_insurance b where a.proposal_no=? and a.status='Y' and a.product_id=? and a.amend_id=(select max(amend_id) from open_cover_master where proposal_no=?) AND b.amend_id = (SELECT MAX(amend_id) FROM open_cover_insurance c WHERE c.INSURANCE_COMPANY_ID = b.INSURANCE_COMPANY_ID) AND b.status = 'Y' and b.INSURANCE_COMPANY_ID!='27' order by b.INSURANCE_COMPANY_ID
getSharedLevel2=select open_cover_country_id_org ,nvl(open_cover_wsrcc_org,'0'),nvl(open_cover_warehouse_org,'0'),open_cover_country_id_dest,nvl(open_cover_wsrcc_dest,'0'),nvl(open_cover_warehouse_dest,'0'),nvl(war_rate,'0') from open_cover_country_master where proposal_no=? and amend_id=(select max(amend_id) from open_cover_country_master where proposal_no=?)
getSharedLevel3=select a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name,A.COVER_TYPE_ID from open_cover_sub_detail a,mode_of_transport b,cover_master c where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and a.status='Y' and b.BRANCH_CODE = c.BRANCH_CODE and c.BRANCH_CODE=? and c.cover_id=a.cover_id and b.mode_transport_id=a.mode_transport_id group by a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name,A.COVER_TYPE_ID order by a.mode_transport_id ,a.cover_id
getSharedLevel4=select a.commodity_id,a.commodity_name_desc,b.commodity_name,b.COMMODITY_RATE from open_cover_commodity_master a,commoditymaster b where a.proposal_no=? and b.BRANCH_CODE=? and a.amend_id=(select max(amend_id) from open_cover_commodity_master where proposal_no=?) and a.status='Y' and b.commodity_id=a.commodity_id and  b.commodity_id=a.commodity_id and b.amend_id=(select max(amend_id) from commoditymaster where commodity_id=a.commodity_id and BRANCH_CODE=?)
getSharedLevel5=SELECT COMMODITY_ID FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO=?) AND STATUS ='Y'
getSharedLevel6=select commodity_id,cover_id,commodity_base_rate,to_char(effective_date,'dd')as days,to_char(effective_date,'mm')as months,to_char(effective_date,'YYYY')as years,COVER_TYPE_ID,NVL(DISCOUNT_PERCENT,'0'),NVL(DISCOUNT_VALUE,'0'),EXCESS_DESCRIPTION from open_cover_commodity_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_commodity_detail where proposal_no=?) order by commodity_id
getSharedLevel7=SELECT CROSS_VOYAGE_TURNOVER FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
getSharedLevel8=SELECT PERCENT FROM CONSTANT_DETAIL WHERE CATEGORY_ID='150' AND  CATEGORY_DETAIL_ID='1'
getSharedLevel9=SELECT PERCENT FROM CONSTANT_DETAIL WHERE CATEGORY_ID='150' AND  CATEGORY_DETAIL_ID='2'
getSharedLevel10=SELECT PERCENT FROM CONSTANT_DETAIL WHERE CATEGORY_ID='150' AND  CATEGORY_DETAIL_ID='3'
getSharedLevel11=SELECT COMMODITY_ID,COVER_ID,COMMODITY_RATE-(COMMODITY_RATE*{0}/100) COMMODITY_RATE,TO_CHAR(EFFECTIVE_DATE,''dd'')  AS DAYS,TO_CHAR(EFFECTIVE_DATE,''mm'')  AS MONTHS,TO_CHAR(EFFECTIVE_DATE,''YYYY'')AS YEARS,COVER_TYPE_ID,NVL(DISCOUNT_PERCENT,''0''),NVL(DISCOUNT_VALUE,''0'') FROM OPEN_COVER_COMMODITY_RATE OCCR WHERE  COMMODITY_ID IN (''{1}'') AND BRANCH_CODE=''{2}''  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_COMMODITY_RATE OCC WHERE  OCC.COMMODITY_ID=OCCR.COMMODITY_ID AND  OCC.COVER_ID=OCCR.COVER_ID AND BRANCH_CODE=''{3}'') ORDER BY  COMMODITY_ID
getSharedLevel12=select nvl(insurance_company_id,'0'),nvl(share_percentage,'0'),LEADER_YN from open_cover_share_percentage where insurance_company_id!='27' and proposal_no=? and amend_id=(select max(amend_id) from open_cover_share_percentage where proposal_no=?)
getSharedLevel13=SELECT DISTINCT(COVER_ID) FROM OPEN_COVER_CLAUSES WHERE PROPOSAL_NO=? AND EXTRA_COVER_ID=0
getSharedLevel14=select count(warranty_id) from open_cover_warranties where proposal_no=?
getSharedLevel15=select count(exclusion_id) from open_cover_exclusions where proposal_no=?
getSharedLevel16=select extra_cover_id,clauses_id from open_cover_clauses where proposal_no=? and extra_cover_id not in('0') and amend_id in(select max(amend_id) from open_cover_clauses where proposal_no=? and extra_cover_id not in('0')group by cover_id)
getSharedLevel17=select nvl(percent,0) from constant_detail where category_id=10 and category_detail_id=1 and status='Y'
getSharedLevel18=select nvl(percent,0), (select distinct TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT m where m.mode_transport_id=category_detail_id),category_detail_id from constant_detail where category_id=130  and status=''Y'' and branch_code=''{0}'' order by category_detail_id asc
getSharedLevel19=select open_cover_country_id_org ,nvl(open_cover_wsrcc_org,'0'),nvl(open_cover_warehouse_org,'0'),open_cover_country_id_dest,nvl(open_cover_wsrcc_dest,'0'),nvl(open_cover_warehouse_dest,'0'),nvl(war_rate,'0') from open_cover_country_master where proposal_no=? and amend_id=(select max(amend_id) from open_cover_country_master where proposal_no=?)
getSharedLevel20=select nvl(insurance_company_id,'0'),nvl(share_percentage,'0'),LEADER_YN from open_cover_share_percentage where insurance_company_id='27' and proposal_no=? and amend_id=(select max(amend_id) from open_cover_share_percentage where proposal_no=?)
storedRates1=delete from open_cover_commodity_detail where proposal_no=?
storedRates2=delete from open_cover_deductible_master where open_cover_proposal_no=?
storedRates3=update open_cover_deductible_master set status='N' where open_cover_proposal_no=?
storedRates4=select nvl(max(amend_id)+1,'0') from open_cover_deductible_master where open_cover_proposal_no=?
storedRates5=insert into open_cover_deductible_master(sno,open_cover_proposal_no,start_range,end_range,excess_amount,amend_id,effective_date,currency_id,currency_name,status,EXCESS_PERCENT) values((select nvl(max(sno)+1,''1'') from open_cover_deductible_master where open_cover_proposal_no=''{0}''),?,?,?,?,?,''{1}'',?,?,''Y'',?)
storedRates6=select b.SHORT_name from currency_master b where b.COUNTRY_ID=1 AND b.CURRENCY_ID=''{0}'' and b.status=''Y'' and b.amend_id||b.currency_id  in(select max(amend_id)||currency_id from currency_master where effective_date <=SYSDATE+10/24  and status=''Y'' and COUNTRY_ID=1 group by currency_id)
storedRates7=insert into open_cover_commodity_detail(proposal_no,amend_id,commodity_id,cover_id,commodity_base_rate,effective_date,status,COVER_TYPE_ID)values(?,(select nvl(max(amend_id)+1,''0'') from open_cover_commodity_detail where proposal_no=''{0}''),?,?,?,''{1}'',?,?)
storedRates8=UPDATE OPEN_COVER_COMMODITY_DETAIL SET DISCOUNT_PERCENT=? WHERE PROPOSAL_NO=? AND COVER_ID=? AND COMMODITY_ID=? AND COVER_TYPE_ID=?
storedRates9=UPDATE OPEN_COVER_COMMODITY_DETAIL SET DISCOUNT_VALUE=? WHERE PROPOSAL_NO=? AND COVER_ID=? AND COMMODITY_ID=? AND COVER_TYPE_ID=?
storedRates10=UPDATE OPEN_COVER_COMMODITY_DETAIL SET EXCESS_DESCRIPTION=? WHERE PROPOSAL_NO=? AND COVER_ID=? AND COMMODITY_ID=?
storedRates11=delete from open_cover_share_percentage where proposal_no=?
storedRates12=insert into open_cover_share_percentage(proposal_no,amend_id,insurance_company_id,share_percentage,effective_date,status,LEADER_YN)values(?,(select nvl(max(amend_id)+1,''0'') from open_cover_share_percentage where proposal_no=''{0}''),?,?,''{1}'',?,?)
storedRates13=update open_cover_country_master set war_rate=? where proposal_no=? and amend_id=(select max(amend_id) from open_cover_country_master where proposal_no=?)
getWARClause=select clauses_id,clauses_description,extra_cover_id from clauses_master where status in (''Y'', ''R'')  and extra_cover_id in (''{0}'') and BRANCH_CODE=''{1}''
getDeductibles=select START_RANGE, END_RANGE, EXCESS_AMOUNT,CURRENCY_ID,EXCESS_PERCENT from open_cover_deductible_master where amend_id= (select max(amend_id) from open_cover_deductible_master   where open_cover_proposal_no=? and trunc(effective_date) <= to_date(?,'dd/mm/yyyy')) and open_cover_proposal_no=? and status='Y' and trunc(effective_date) <= to_date(?,'dd/mm/yyyy')
getRangeValidation=select 'yes' from dual where {0} between {1} and {2}
updateConfirmYN=update open_cover_master set CONFIRM_STATUS=? where Proposal_no=? and AMEND_ID = (select max(amend_id) from OPEN_COVER_MASTER where Proposal_no = ?)
getConfirmInfo=SELECT DECODE(CONFIRM_STATUS, NULL, 'NO',CONFIRM_STATUS) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? and AMEND_ID = (select max(amend_id) from OPEN_COVER_MASTER where Proposal_no = ?)
insertMOPDetails=SELECT TYPE,CROSS_VOYAGE_TURNOVER,NO_OF_VEHICLES,HAULIER_PREMIUM,COMMISSION FROM OPEN_COVER_MASTER OCM WHERE PROPOSAL_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=OCM.PROPOSAL_NO)
insertMOPDetails1=select max(COMMODITY_BASE_RATE) from open_cover_commodity_detail where PROPOSAL_NO=?
insertMOPDetails2=SELECT COUNT(*) FROM OPEN_COVER_MOP_DETAILS WHERE PROPOSAL_NO=?
insertMOPDetails3=UPDATE OPEN_COVER_MOP_DETAILS SET SUMINSURED=?,MARINE_RATE=?,MARINE_PREMIUM=?,WAR_RATE=?,WAR_PREMIUM=?,TOTAL_PREMIUM=?,COMMISSION_PERCENT=? WHERE PROPOSAL_NO=?
insertMOPDetails4=INSERT INTO OPEN_COVER_MOP_DETAILS(AMEND_ID,SUMINSURED,MARINE_RATE,MARINE_PREMIUM,WAR_RATE,WAR_PREMIUM,TOTAL_PREMIUM,COMMISSION_PERCENT,PROPOSAL_NO) VALUES('0',?,?,?,?,?,?,?,?)
getMopPremiumDetails=SELECT SUMINSURED,MARINE_RATE,MARINE_PREMIUM,WAR_RATE,WAR_PREMIUM,TOTAL_PREMIUM,NVL(POLICY_FEE,0),NVL(INSPECTION_FEE,0),FINAL_PREMIUM,PAYABLE_YN,PERCENTAGE,PAYABLE_PREMIUM,NVL(COMMISSION_PERCENT,0) FROM OPEN_COVER_MOP_DETAILS WHERE PROPOSAL_NO=?
updateMopPremiumDetails=UPDATE OPEN_COVER_MOP_DETAILS SET INSPECTION_FEE=?,PAYABLE_YN=?,PERCENTAGE=?,POLICY_FEE=? WHERE PROPOSAL_NO=?
mopPremiumCalc=UPDATE OPEN_COVER_MOP_DETAILS SET FINAL_PREMIUM=?,PAYABLE_PREMIUM=?,COMMISSION=? WHERE PROPOSAL_NO=?
mopPremiumCalc1=UPDATE OPEN_COVER_MOP_DETAILS SET PAYABLE_MARINE_PREMIUM=NVL(MARINE_PREMIUM,0)*PERCENTAGE/100,PAYABLE_WAR_PREMIUM=NVL(WAR_PREMIUM,0)*PERCENTAGE/100,PAYABLE_TOTAL_PREMIUM=NVL(TOTAL_PREMIUM,0)*PERCENTAGE/100,PAYABLE_INSPECTION_FEE=NVL(INSPECTION_FEE,0)*PERCENTAGE/100,PAYABLE_POLICY_FEE=NVL(POLICY_FEE,0)*PERCENTAGE/100 WHERE PROPOSAL_NO=?
calcPolicyFee=SELECT A.MIN_PREMIUM_ISSUANCE_FEE POLICY_FEE_DEFAULT,A.ISSUANCE_FEE POLICY_FEE_PERCENT,A.COMMISSION COMMISSION FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = A.PROPOSAL_NO)
getOpenCoverType=SELECT TYPE FROM OPEN_COVER_MASTER OCM WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=OCM.PROPOSAL_NO)
getWarrantiesFromMaster=select warranty_id,warranty_description from warranty_master wm  where wm.WARRANTY_ID not in (select WARRANTY_ID from open_cover_warranties ocw where wm.WARRANTY_ID\=ocw.WARRANTY_ID and proposal_no\=? and cover_id is not null) and   status in ('Y', 'R') and BRANCH_CODE \= ? order by DISPLAY_ORDER
getExclusionsFromMaster=select exclusion_id,exclusion_description from exclusion_master em where EM.EXCLUSION_ID not in (select EXCLUSION_ID from open_cover_exclusions oce where em.EXCLUSION_ID\=oce.EXCLUSION_ID and proposal_no\=?  and cover_id is not null ) and  status in ('Y', 'R') and BRANCH_CODE \= ? order by EXCLUSION_ID
getConditionsFromMaster=select distinct description from cover_master where branch_code = {0} and cover_id = {1}
getConditionsFromMaster1=SELECT CM.CLAUSES_ID CLAUSES_ID,CM.CLAUSES_DESCRIPTION CLAUSES_DESCRIPTION,TO_CHAR(SYSDATE,'DD-MM-YYYY'),CM.RSACODE  RSACODE FROM CLAUSES_MASTER CM WHERE CM.BRANCH_CODE=? AND CM.COVER_ID=?  AND extra_cover_id='0' order by CM.CLAUSES_ID
getConditionsFromMaster2=select CLAUSES_ID,CLAUSES_DESCRIPTION from  table(commodity_clauses(?,?,'Clauses',?))
getWarrantyFromOpenCoverMaster=select occmss.warranty_id,occmss.warranty_description,to_char(occmss.EFFECTIVE_DATE,'dd-mm-yyyy') as effectDate  from open_cover_warranties occmss,open_cover_position_master ocpmss where ocpmss.proposal_no = ? and ocpmss.proposal_no=occmss.proposal_no and occmss.amend_id in (select max(occms.amend_id) from open_cover_warranties occms, open_cover_position_master ocpms where ocpms.proposal_no = ?  and ocpms.proposal_no=occms.proposal_no)
getExclusionFromOpenCoverMaster=select occmss.exclusion_id,occmss.exclusion_description,to_char(occmss.EFFECTIVE_DATE,'dd-mm-yyyy') as effectDate,COMMODITY_IDS  from open_cover_exclusions occmss,open_cover_position_master ocpmss where ocpmss.proposal_no \= ? and ocpmss.proposal_no\=occmss.proposal_no and occmss.amend_id in (select max(occms.amend_id) from open_cover_exclusions occms,open_cover_position_master ocpms where ocpms.proposal_no \= ? and ocpms.proposal_no\=occms.proposal_no)
getWsrccFromOpenCoverMasterResult=select occmss.clauses_id,occmss.clauses_description,to_char(occmss.EFFECTIVE_DATE,''dd-mm-yyyy'') as effectDate,occmss.COVER_ID from open_cover_clauses occmss,open_cover_position_master ocpmss where ocpmss.proposal_no = ? and ocpmss.proposal_no=occmss.proposal_no and occmss.amend_id in(select max(amend_id) from open_cover_clauses where proposal_no = ? and cover_id not in(0) and extra_cover_id in ({0})) and cover_id not in(0) and occmss.extra_cover_id in ({1})
getConditionsFromOpenCoverMaster=select occmss.clauses_id,occmss.clauses_description,to_char(occmss.EFFECTIVE_DATE,'dd-mm-yyyy') as effectDate  from open_cover_clauses occmss,open_cover_position_master ocpmss where ocpmss.proposal_no = ? and ocpmss.proposal_no=occmss.proposal_no  and occmss.cover_id = ? and occmss.amend_id in (select max(occms.amend_id) from open_cover_clauses occms,open_cover_position_master ocpms where ocpms.proposal_no = ? and occms.cover_id = ? and ocpms.proposal_no=occms.proposal_no and occms.extra_cover_id='0') and occmss.extra_cover_id='0'
insertUpdateConditions=delete from open_cover_clauses where proposal_no = ? and cover_id = ?
insertUpdateConditions1=insert into open_cover_clauses (proposal_no,mode_transport_id,cover_id,extra_cover_id,clauses_id,clauses_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,TO_DATE(''{0}'',''dd/MM/yyyy HH24:MI:SS''),?,?)
insertUpdateWarranties=delete from open_cover_warranties where proposal_no = ?
insertUpdateWarranties1=insert into open_cover_warranties (proposal_no,mode_transport_id,cover_id,extra_cover_id,warranty_id,warranty_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,TO_DATE(''{0}'',''dd/MM/yyyy HH24:MI:SS''),?,?)
getOpencoverFreeText=delete from open_cover_free_text where proposal_no = ?  and cover_id = ?
getOpencoverFreeText1=select free_text_id, free_text_description, to_char(effective_date,'dd-mm-yyyy'),COMMODITY_IDS from open_cover_free_text where proposal_no = ? and cover_id = ? and amend_id =(select max(amend_id) from open_cover_free_text where proposal_no = ? and cover_id = ?)
insertUpdateWSRCCText=delete from open_cover_clauses where proposal_no = ? and extra_cover_id != 0  and cover_id = ? and amend_id = ?
insertUpdateWSRCCText1= insert into open_cover_clauses (proposal_no,mode_transport_id,cover_id,extra_cover_id,clauses_id,clauses_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,TO_DATE(''{0}'',''dd/MM/yyyy HH24:MI:SS''),?,?)
insertUpdateFreeText=delete from open_cover_free_text where proposal_no = ?  and cover_id = ?
insertUpdateFreeText1=delete from open_cover_free_text where proposal_no = ?  and cover_id = ?
insertUpdateFreeText2=insert into open_cover_free_text (proposal_no,AMEND_ID,mode_of_transport,cover_id,extra_cover_id,free_text_id,free_text_description,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,TO_DATE(''{0}'',''dd/MM/yyyy HH24:MI:SS''),?,?)
insertUpdateExclusions=delete from open_cover_exclusions where proposal_no = ?
insertUpdateExclusions1=insert into open_cover_exclusions (proposal_no,mode_transport_id,cover_id,extra_cover_id,exclusion_id,exclusion_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,TO_DATE(''{0}'',''dd/MM/yyyy HH24:MI:SS''),?,?)
getMaximumProposalNo=select max(proposal_no) from open_cover_clauses
getExtracoverID=select extra_cover_id from clauses_master where clauses_id = ? and BRANCH_CODE= ?
getMaximumWarrantiesAmendId=select max(amend_id) from open_cover_position_master where proposal_No = ?
getMaximumtextamendId=select max(amend_id) from open_cover_position_master where proposal_No = ?
getMaximumWSRCCID=select max(amend_id) from open_cover_position_master where proposal_No = ?
getMaximumExclusionsAmendId=select max(amend_id) from open_cover_position_master where proposal_No = ?
getProposalNoDetails=select a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name from open_cover_sub_detail a,mode_of_transport b,cover_master c where a.proposal_no = ? and c.BRANCH_CODE=b.BRANCH_CODE and c.BRANCH_CODE = ? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no = ?) and a.status='Y' and c.cover_id=a.cover_id and b.mode_transport_id=a.mode_transport_id group by a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name order by a.mode_transport_id ,a.cover_id
getExtraCoverIds=SELECT RTRIM(XMLAGG(XMLELEMENT(E,A.MODE_TRANSPORT_ID || ',')).EXTRACT('//text()'),',') MODE_TRANSPORT_ID FROM OPEN_COVER_DETAIL A WHERE   A.PROPOSAL_NO = ? AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   OPEN_COVER_DETAIL WHERE   PROPOSAL_NO = A.PROPOSAL_NO)
insertUpdateWarrantiesNew=delete from open_cover_warranties where proposal_no = ? and cover_id {0}
insertUpdateWarrantiesNew1=insert into open_cover_warranties (proposal_no,mode_transport_id,cover_id,extra_cover_id,warranty_id,warranty_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS,COMMODITY_IDS)values(?,?,?,?,?,?,?,TO_DATE(''{0}'',''dd/MM/yyyy HH24:MI:SS''),?,?,?)
insertUpdateWarrantiesNew2=select commodity_id from open_cover_commodity_master where proposal_no=? order by COMMODITY_NAME_DESC
insertUpdateExclusionsNew=delete from open_cover_exclusions where proposal_no = ? and cover_id {0}
insertUpdateExclusionsNew1=insert into open_cover_exclusions (proposal_no,mode_transport_id,cover_id,extra_cover_id,exclusion_id,exclusion_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS,COMMODITY_IDS)values(?,?,?,?,?,?,?,TO_DATE(''{0}'',''dd/MM/yyyy HH24:MI:SS''),?,?,?)
insertUpdateExclusionsNew2=select commodity_id from open_cover_commodity_master where proposal_no=? order by COMMODITY_NAME_DESC
getWarrantyFromOpenCoverMasterNew=select occmss.warranty_id,occmss.warranty_description,to_char(occmss.EFFECTIVE_DATE,''dd-mm-yyyy'') as effectDate,COMMODITY_IDS  from open_cover_warranties occmss,open_cover_position_master ocpmss where ocpmss.proposal_no = ? and ocpmss.proposal_no=occmss.proposal_no and occmss.amend_id in (select max(occms.amend_id) from open_cover_warranties occms, open_cover_position_master ocpms where ocpms.proposal_no = ?  and ocpms.proposal_no=occms.proposal_no) {0}
insertUpdateWSRCCTextNew=delete from open_cover_clauses where proposal_no = ? and extra_cover_id != 0  and cover_id = ? and amend_id = ?
insertUpdateWSRCCTextNew1=insert into open_cover_clauses (proposal_no,mode_transport_id,cover_id,extra_cover_id,clauses_id,clauses_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,TO_DATE(''{0}'',''dd/MM/yyyy HH24:MI:SS''),?,?)
insertUpdateFreeTextNew=delete from open_cover_free_text where proposal_no = ?  and cover_id = ? and type='F'
insertUpdateFreeTextNew1=insert into open_cover_free_text (proposal_no,AMEND_ID,mode_of_transport,cover_id,extra_cover_id,free_text_id,free_text_description,EFFECTIVE_DATE,REMARKS,STATUS,type,COMMODITY_IDS)values(?,?,?,?,?,?,?,TO_DATE(''{0}'',''dd/MM/yyyy HH24:MI:SS''),?,?,?,?)
insertUpdateConditionsNew=delete from open_cover_clauses where proposal_no = ? and cover_id = ? and EXTRA_COVER_ID=0
insertUpdateConditionsNew1=insert into open_cover_clauses (proposal_no,mode_transport_id,cover_id,extra_cover_id,clauses_id,clauses_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS,COMMODITY_IDS)values(?,?,?,?,?,?,?,TO_DATE(''{0}'',''dd/MM/yyyy HH24:MI:SS''),?,?,?)
getConditionsFromMasterNew=select distinct description from cover_master where branch_code = ? and cover_id = ?
getConditionsFromMasterNew1=SELECT CM.CLAUSES_ID CLAUSES_ID,CM.CLAUSES_DESCRIPTION CLAUSES_DESCRIPTION,TO_CHAR(SYSDATE,'DD-MM-YYYY'),CM.RSACODE  RSACODE  FROM CLAUSES_MASTER CM WHERE CM.BRANCH_CODE=(select BELONGING_BRANCH from branch_master where BRANCH_CODE=? ) AND CM.COVER_ID=?  AND extra_cover_id='0' order by CM.CLAUSES_ID
getConditionsFromMasterNew2=select CLAUSES_ID,CLAUSES_DESCRIPTION,'~'||COMMODITY_IDS||'~' from  table(commodity_clauses(?,?,'Clauses',?))
getConditionsFromOpenCoverMasterNew=select occmss.clauses_id,occmss.clauses_description,to_char(occmss.EFFECTIVE_DATE,'dd-mm-yyyy') as effectDate,commodity_ids  from open_cover_clauses occmss,open_cover_position_master ocpmss where ocpmss.proposal_no = ? and ocpmss.proposal_no=occmss.proposal_no  and occmss.cover_id = ? and occmss.amend_id in (select max(occms.amend_id) from open_cover_clauses occms,open_cover_position_master ocpms where ocpms.proposal_no = ? and occms.cover_id = ? and ocpms.proposal_no=occms.proposal_no and occms.extra_cover_id='0') and occmss.extra_cover_id='0'
getExclusionsFromMaster1=select exclusion_id,exclusion_description from exclusion_master em where EM.EXCLUSION_ID not in (select EXCLUSION_ID from open_cover_exclusions oce where em.EXCLUSION_ID=oce.EXCLUSION_ID and proposal_no=? and cover_id is null ) and  status in ('Y', 'R') and BRANCH_CODE = ? order by EXCLUSION_ID
getOpencoverFreeTextNew=delete from open_cover_free_text where proposal_no = ?  and cover_id = ?
getOpencoverFreeTextNew1=select free_text_id, free_text_description, to_char(effective_date,'dd-mm-yyyy'),COMMODITY_IDS from open_cover_free_text where proposal_no = ? and cover_id = ? and  TYPE = 'F' and amend_id =(select max(amend_id) from open_cover_free_text where proposal_no = ? and cover_id = ? and type='F')
getWarrantiesFromMaster1=select warranty_id,warranty_description from warranty_master wm  where wm.WARRANTY_ID not in (select WARRANTY_ID from open_cover_warranties ocw where wm.WARRANTY_ID=ocw.WARRANTY_ID and proposal_no=? and cover_id is null) and   status in ('Y', 'R') and BRANCH_CODE = ? order by DISPLAY_ORDER
getWSRCCFromMaster=select clauses_id,clauses_description,extra_cover_id,cover_id,RSACODE from clauses_master where status in (''Y'',''R'') and BRANCH_CODE = ? and extra_cover_id in (''{0}''}) group by extra_cover_id,clauses_id,clauses_description,cover_id,RSACODE order by clauses_id
getWSRCCFromMaster1=select CLAUSES_ID,CLAUSES_DESCRIPTION from  table(commodity_clauses(?,?,'War',?))
getWsrccFromOpenCoverMaster=SELECT OCCMSS.CLAUSES_ID, OCCMSS.CLAUSES_DESCRIPTION, TO_CHAR (OCCMSS.EFFECTIVE_DATE, ''dd-mm-yyyy'') AS EFFECTDATE FROM OPEN_COVER_CLAUSES OCCMSS, OPEN_COVER_POSITION_MASTER OCPMSS WHERE OCPMSS.PROPOSAL_NO \= ? AND OCPMSS.PROPOSAL_NO \= OCCMSS.PROPOSAL_NO AND OCCMSS.AMEND_ID IN ( SELECT MAX (AMEND_ID) FROM OPEN_COVER_CLAUSES WHERE PROPOSAL_NO \= OCPMSS.PROPOSAL_NO AND COVER_ID NOT IN (0) AND EXTRA_COVER_ID IN ({0})) AND COVER_ID NOT IN (0) AND OCCMSS.EXTRA_COVER_ID IN ({1})
getAdminBranch=select nvl(BRANCH_CODE,'020') from LOGIN_MASTER where login_id\=?  
getOpenCoversByExpiryDate=SELECT ROWNUM SNO,X.* FROM (SELECT NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, A.PROPOSAL_NO PROPOSAL_NO, E.COMPANY_NAME BROKER, NVL (C.FIRST_NAME, C.COMPANY_NAME) CUSTOMER, NVL (TO_CHAR (A.INCEPTION_DATE, 'DD-mm-YYYY'), ' ') INCEPTION_DATE, NVL (TO_CHAR (A.EXPIRY_DATE, 'DD-mm-YYYY'), ' ') EXPIRY_DATE FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO C, OPEN_COVER_MASTER D, BROKER_COMPANY_MASTER E WHERE A.STATUS = 'P' AND (TRUNC (A.EXPIRY_DATE) - TRUNC (SYSDATE)) BETWEEN 0 AND 60 AND MOD ( (TRUNC (A.EXPIRY_DATE) - TRUNC (SYSDATE)), 10) = 0 AND A.PROPOSAL_NO = D.PROPOSAL_NO AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = D.PROPOSAL_NO) AND C.CUSTOMER_ID = D.CUSTOMER_ID AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND E.AGENCY_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = D.BROKER_ID) AND D.BRANCH_CODE=? ORDER BY EXPIRY_DATE) X
getOpenCoversByStartDate=SELECT ROWNUM SNO,X.* FROM (SELECT NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, A.PROPOSAL_NO PROPOSAL_NO, E.COMPANY_NAME BROKER, NVL (C.FIRST_NAME, C.COMPANY_NAME) CUSTOMER, NVL (TO_CHAR (A.INCEPTION_DATE, 'DD-mm-YYYY'), ' ') INCEPTION_DATE, NVL (TO_CHAR (A.EXPIRY_DATE, 'DD-mm-YYYY'), ' ') EXPIRY_DATE FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO C, OPEN_COVER_MASTER D, BROKER_COMPANY_MASTER E WHERE A.STATUS = 'P' AND (TRUNC(A.INCEPTION_DATE+((EXTRACT (YEAR FROM SYSDATE)-EXTRACT (YEAR FROM A.INCEPTION_DATE))*365))-TRUNC(SYSDATE)) BETWEEN 0 AND 60 AND MOD ( (TRUNC(A.INCEPTION_DATE+((EXTRACT (YEAR FROM SYSDATE)-EXTRACT (YEAR FROM A.INCEPTION_DATE))*365))-TRUNC(SYSDATE)), 10) = 0 AND TRUNC (A.EXPIRY_DATE) >= TRUNC (SYSDATE) AND A.PROPOSAL_NO = D.PROPOSAL_NO AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = D.PROPOSAL_NO) AND C.CUSTOMER_ID = D.CUSTOMER_ID AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND E.AGENCY_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = D.BROKER_ID) AND D.BRANCH_CODE=? ORDER BY EXPIRY_DATE) X
getBranchInfoByOpenCoverExpiryDate=SELECT DISTINCT D.BRANCH_CODE, F.EMAIL_TO, F.EMAIL_CC,B.BRANCH_NAME FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_MASTER D, MAIL_DETAILS F, BRANCH_MASTER B WHERE A.STATUS = 'P' AND (TRUNC (A.EXPIRY_DATE) - TRUNC (SYSDATE)) BETWEEN 0 AND 60 AND MOD ( (TRUNC (A.EXPIRY_DATE) - TRUNC (SYSDATE)), 10) = 0 AND A.PROPOSAL_NO = D.PROPOSAL_NO AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = D.PROPOSAL_NO) AND F.BRANCH_CODE = D.BRANCH_CODE AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND B.BRANCH_CODE=D.BRANCH_CODE ORDER BY D.BRANCH_CODE
getBranchInfoByOpenCoverStartDate=SELECT DISTINCT D.BRANCH_CODE, F.EMAIL_TO, F.EMAIL_CC, B.BRANCH_NAME FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_MASTER D, MAIL_DETAILS F, BRANCH_MASTER B WHERE A.STATUS = 'P' AND ( trunc(A.INCEPTION_DATE + ((EXTRACT (YEAR FROM SYSDATE) - EXTRACT (YEAR FROM A.INCEPTION_DATE)) * 365)) - trunc(SYSDATE)) BETWEEN 0 AND 60 AND mod((trunc(A.INCEPTION_DATE+((EXTRACT (YEAR FROM SYSDATE)-EXTRACT (YEAR FROM A.INCEPTION_DATE))*365))-trunc(SYSDATE)),10) = 0 AND TRUNC (A.EXPIRY_DATE) >= TRUNC (SYSDATE) AND A.PROPOSAL_NO = D.PROPOSAL_NO AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = D.PROPOSAL_NO) AND F.BRANCH_CODE = D.BRANCH_CODE AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND B.BRANCH_CODE = D.BRANCH_CODE ORDER BY D.BRANCH_CODE
getBranchCode=SELECT BRANCH_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?
getBranchPrefix=SELECT BRANCH_PREFIX FROM BRANCH_MASTER WHERE BRANCH_CODE\=?
getCurrencyRates=select a.exchange_rate,b.currency_name,a.amend_id,a.effective_date,a.currency_id from exchange_master a, currency_master b where a.currency_id=b.currency_id and a.COUNTRY_ID=b.COUNTRY_ID and a.COUNTRY_ID=? and a.amend_id||a.exchange_id||a.currency_id in(select max(amend_id)||exchange_id||currency_id from exchange_master where effective_date <=SYSDATE+10/24 and status='Y' and COUNTRY_ID=? group by exchange_id,currency_id)  and a.effective_date <=SYSDATE+10/24 and a.status='Y' and b.status='Y' and b.status='Y' and a.status='Y' and b.currency_id=? and  b.amend_id||b.currency_id in(select max(amend_id)||currency_id from currency_master where effective_date <=SYSDATE+10/24 and status='Y' and COUNTRY_ID=? group by currency_id)
getCurrencyDetails=SELECT em.exchange_rate,cm.currency_name, em.amend_id, em.effective_date, em.currency_id FROM currency_master cm,exchange_master em WHERE cm.country_id\=? and cm.status\='Y' AND cm.amend_id\=(SELECT MAX(amend_id) FROM currency_master WHERE status\='Y' and currency_id\=cm.currency_id AND TRUNC(effective_date)<\=TRUNC(SYSDATE)) AND TRUNC(cm.effective_date)<\=TRUNC(SYSDATE) AND cm.currency_id\=em.currency_id and cm.country_id\=em.country_id AND em.amend_id\=(SELECT MAX(amend_id) FROM exchange_master WHERE currency_id\=em.currency_id and country_id\=em.country_id AND TRUNC(effective_date)<\=TRUNC(SYSDATE)) AND TRUNC(em.effective_date)<\=TRUNC(SYSDATE) order by  cm.currency_name
getExistingCustomers=SELECT NVL (PI.FIRST_NAME, PI.COMPANY_NAME),NVL (PI.LAST_NAME, '0'),NVL (PI.EMAIL, '0'),NVL (MOBILE, ''),PI.CUSTOMER_ID,NVL (PI.MISSIPPI_CUSTOMER_CODE, 0),nvl(PI.cust_ar_no,'') FROM PERSONAL_INFO PI,BROKER_COMPANY_MASTER BCM,LOGIN_MASTER LM WHERE PI.LOGIN_ID=LM.LOGIN_ID AND LM.OA_CODE=BCM.AGENCY_CODE AND LM.LOGIN_ID=? AND PI.APPLICATION_ID='1'
settingValues=select title,gender,nvl(first_name,company_name),last_name,nationality,to_char(dob,'DD') as dobday,to_char(dob,'MM') as dobmonth,to_char(dob,'YYYY') as dobyear,telephone,mobile,fax,email,address1,address2,occupation,emirate,country,pobox,company_name,nvl(missippi_customer_code,0),city,cust_ar_no,cust_name from personal_info where customer_id\=?
storedValues=insert into personal_info(customer_id,application_id,title,first_name,last_name,amend_id,nationality,dob,gender,telephone,mobile,fax,email,address1,address2,occupation,pobox,country,emirate,status,entry_date,login_id,company_name,missippi_customer_code,city,client_customer_id,cust_ar_no,cust_name) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select sysdate from dual),?,?,?,?,?,?,?)
storedValues1=SELECT CUSTOMER_NUMBER_SEQ.NEXTVAL FROM DUAL
storedValues2=update personal_info set application_id=?,title=?,first_name=?,last_name=?,amend_id=?,nationality=?,dob=?,gender=?,telephone=?,mobile=?,fax=?,email=?,address1=?,address2=?,occupation=?,pobox=?,country=?,emirate=?,status=?,effective_date=(select sysdate from dual),company_name = ?,missippi_customer_code=?,city=?,client_customer_id=?,cust_ar_no=?,cust_name=?  where customer_id=?
getExistingCustomerss=select customer_id,first_name,last_name,email,mobile,login_id from personal_info where login_id=? and (lower(trim(first_name)) like ? or  lower(trim(last_name)) like ?) and application_id=1 order by customer_id
getMissippiCustomerCode=select nvl(missippi_customer_code,0) from personal_info where customer_id\=? 
getCustomer=select customer_id from position_master where application_no=?
getErrors=select error_desc from error_master where error_id in ({0}) order by error_id
checkingSysDates=select to_date(sysdate,''DD-MM-YYYY'')-to_date(''{0}'',''DD-MM-YYYY'') from dual
checkingDates=select to_date(''{0}'',''DD-MM-YYYY'')-to_date(''{1}'',''DD-MM-YYYY'') from dual
getReferralStatus=SELECT COUNT(*) FROM COMMODITYMASTER WHERE STATUS='Y' AND COMMODITY_ID=? AND BRANCH_CODE=?
sendMail=SELECT DISTINCT BRANCH_CODE, EMAIL_TO, EMAIL_CC FROM  MAIL_DETAILS WHERE BRANCH_CODE=?
getProposalInfo=SELECT ROWNUM SNO,X.* FROM (SELECT NVL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, A.PROPOSAL_NO PROPOSAL_NO, E.COMPANY_NAME BROKER, NVL (C.FIRST_NAME, C.COMPANY_NAME) CUSTOMER, NVL (TO_CHAR (A.INCEPTION_DATE, 'DD-MON-YYYY'), ' ') INCEPTION_DATE, NVL (TO_CHAR (A.EXPIRY_DATE, 'DD-MON-YYYY'), ' ') EXPIRY_DATE FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO C, OPEN_COVER_MASTER D, BROKER_COMPANY_MASTER E WHERE A.PROPOSAL_NO =? AND A.PROPOSAL_NO = D.PROPOSAL_NO AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = D.PROPOSAL_NO) AND C.CUSTOMER_ID = D.CUSTOMER_ID AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND E.AGENCY_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = D.BROKER_ID) AND D.BRANCH_CODE=? ORDER BY EXPIRY_DATE) X
CONTROLLER1=SELECT COUNT(*) FROM OPEN_COVER_CLAUSES WHERE PROPOSAL_NO=? AND COVER_ID=?
CONTROLLER2=select distinct description from cover_master where branch_code = ? and cover_id = ?
CONTROLLER3=SELECT DISTINCT CM.CLAUSES_ID CLAUSES_ID,CM.CLAUSES_DESCRIPTION CLAUSES_DESCRIPTION,TO_CHAR(SYSDATE,''DD-MM-YYYY'') FROM CLAUSES_MASTER CM,COMMODITYMASTER C WHERE CM.BRANCH_CODE=? AND CM.COVER_ID=? AND CM.RSACODE IN (SELECT REGEXP_SUBSTR ((SUBSTR({0},1,(INSTR({1},''~'',1,1)-1))), ''[^,]+'', 1, LEVEL) AS CLAUSESID FROM DUAL CONNECT BY LEVEL <=LENGTH ((SUBSTR({2},1,(INSTR({3},''~'',1,1)-1))))- LENGTH(REPLACE ((SUBSTR({4},1,(INSTR({5},''~'',1,1)-1))), '','', ''''))+ 1) AND CM.EXTRA_COVER_ID=''0'' AND CM.STATUS IN (''Y'',''R'') AND CM.BRANCH_CODE=C.BRANCH_CODE AND C.COMMODITY_ID IN (SELECT COMMODITY_ID FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO=?)) ORDER BY CM.CLAUSES_ID
CONTROLLER4=SELECT DISTINCT(COVER_ID) FROM OPEN_COVER_CLAUSES WHERE PROPOSAL_NO=?
CONTROLLER5=SELECT COUNT(*) FROM OPEN_COVER_CLAUSES WHERE PROPOSAL_NO=? AND EXTRA_COVER_ID IN (1) AND COVER_ID=?
CONTROLLER6=SELECT CLAUSES_ID,CLAUSES_DESCRIPTION,EXTRA_COVER_ID,COVER_ID FROM CLAUSES_MASTER WHERE STATUS IN (''Y'',''R'') AND BRANCH_CODE = ? AND EXTRA_COVER_ID IN (1) AND COVER_ID IN ({0}) GROUP BY EXTRA_COVER_ID,CLAUSES_ID,CLAUSES_DESCRIPTION,COVER_ID ORDER BY CLAUSES_ID
CONTROLLER7=Select policy_generate(?,?,?) from dual
CONTROLLER8=SELECT DECODE(GUEST_LOGIN_STATUS, NULL, 'NO',GUEST_LOGIN_STATUS),PROPOSAL_STATUS FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? and AMEND_ID = (select max(amend_id) from OPEN_COVER_MASTER where Proposal_no = ?)
CONTROLLER9=Select decode(count(*),0,'N','Y') CKECK_YN from  open_cover_commodity_detail where proposal_no=?
CONTROLLER10=select DETAIL_NAME from constant_detail where CATEGORY_ID\=158 and CATEGORY_DETAIL_ID\=1
getDatas=select distinct(to_char(md.INCEPTION_DATE,'DD-MM-YYYY')), to_char(md.EXPIRY_DATE,'DD-MM-YYYY'), mc.cross_voyage, pc.product_name,mc.min_premium, mc.IMPORT_MIN_PREMIUM_AMOUNT,mc.EXPORT_MIN_PREMIUM_AMOUNT,nvl(mc.CROSS_MIN_PREMIUM_AMOUNT,'0'), mc.TYPE, nvl(mc.COUNTRY_REMARKS,''), md.OPEN_COVER_NO,NVL (MD.RATE_PRINT_STATUS,'N'),NVL (MD.CANCELLATION_CLAUSE,''),NVL(MD.AMENDED_CLAUSE_PRINT_STATUS,'N'),RENEWAL_STATUS,ORIGINAL_POLICY_NO,ENDT_TYPE,(Select Product_name from open_cover_product_Details WHERE PRODUCT_ID=MC.TYPE AND BRANCH_CODE=?) OPEN_COVER_TYPE_NAME from OPEN_COVER_POSITION_MASTER md, open_cover_master mc, product_master pc where md.proposal_no =? and mc.amend_id = (select max(amend_id) from open_cover_master where proposal_no = ?) and md.proposal_no = mc.proposal_no and pc.product_id =?
getcheckInsuranceId=select no_of_insurance_company from open_cover_master where amend_id = (select max(amend_id) from open_cover_master where proposal_no=?) and proposal_no = ?
getInsuranceCompanyId=select  a.insurance_company_id,a.proposal_no, a.share_percentage from open_cover_share_percentage a where amend_id = (select max(amend_id) from open_cover_share_percentage a where a.proposal_no = ? ) and a.proposal_no=?
getInsuranceCompanyName=select insurance_company_name from open_cover_insurance where insurance_company_id in ()
getModeofTransport=SELECT  MD.TRANSPORT_DESCRIPTION, CC.COVER_NAME,(OC.SUM_INSURED_LIMIT*OC.EXCHANGE_RATE) FROM OPEN_COVER_DETAIL OC, MODE_OF_TRANSPORT MD, COVER_MASTER CC,OPEN_COVER_SUB_DETAIL OCS WHERE OC.PROPOSAL_NO =?  AND OC.AMEND_ID = (SELECT MAX(AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO =?) AND MD.BRANCH_CODE=CC.BRANCH_CODE AND CC.BRANCH_CODE=? AND OC.MODE_TRANSPORT_ID = MD.MODE_TRANSPORT_ID AND CC.COVER_ID = OCS.COVER_ID AND OCS.PROPOSAL_NO=OC.PROPOSAL_NO AND OCS.MODE_TRANSPORT_ID=OC.MODE_TRANSPORT_ID AND OCS.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_SUB_DETAIL WHERE PROPOSAL_NO =OC.PROPOSAL_NO)  ORDER BY MD.MODE_TRANSPORT_ID,CC.COVER_ID
getOpenCoverInformation=select a.title, a.first_name, nvl(a.company_name,0), b.back_date_days,b.cross_voyage_turnover, b.rsa_shared_percentage,b.no_of_insurance_company,b.cross_voyage,b.cross_voyage_percentage, b.commission,b.MISSISSIPI_OPEN_POLICY_ID,b.BUSINESS_TYPE,b.MISSIPPI_OPENCOVER_NO from personal_info a, open_cover_master b where a.customer_id =  ( select b.customer_id from open_cover_master b where b.proposal_no = ? and b.amend_id = (select max(b.amend_id) from open_cover_master b where b.proposal_no =?))  and b.proposal_no = ? and b.amend_id = (select max(b.amend_id) from open_cover_master b where b.proposal_no =?) and a.customer_id = b.customer_id
getOpenCoverDepostDetails=SELECT DECODE(OCM.EXISTING_DEPOSIT_YN,'Y','Old','Yes'),(select detail_name from constant_detail cd where cd.category_id='139' and cd.branch_code=? and cd.CATEGORY_DETAIL_ID=ocm.DEPOSIT_TYPE),OCM.DEBIT_NOTE_NO, OCM.CREDIT_NOTE_NO, OCM.MARINE_PREMIUM, OCM.WAR_PREMIUM, OCM.REMARKS FROM OPEN_COVER_MASTER OCM WHERE OCM.PROPOSAL_NO=? AND OCM.DEPOSIT_PREMIUM_YN='Y' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER OCM1 WHERE OCM1.PROPOSAL_NO=OCM.PROPOSAL_NO)
getAdditionalCustomer=SELECT REPLACE((PI.TITLE||'. '||PI.FIRST_NAME||', '||'PO BOX '||PI.POBOX||', '||PI.EMIRATE||', '||PI.ADDRESS1||', '||PI.ADDRESS2),', ,',NULL) FROM PERSONAL_INFO PI WHERE PI.CUSTOMER_ID IN ({0}) ORDER BY INSTR({1}, PI.CUSTOMER_ID)
getColumnWise=select b.transport_description,c.cover_name, a.mode_transport_id,a.cover_id from open_cover_sub_detail a,mode_of_transport b,cover_master c where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and a.status='Y' and c.cover_id=a.cover_id and b.BRANCH_CODE=? and b.BRANCH_CODE=c.BRANCH_CODE and b.mode_transport_id=a.mode_transport_id order by a.cover_id
getCountryList=select country_name from country_master where country_id in ({0})
getCommodityId=select  max(amend_id),commodity_id from open_cover_commodity_master where commodity_id in(select distinct(commodity_id) from open_cover_commodity_master  where proposal_no=? group by commodity_id) group by commodity_id
getCoverId=select distinct a.amend_id,a.cover_id from open_cover_commodity_detail a where a.proposal_no=? and  a.amend_id in(select max(amend_id) from open_cover_commodity_detail a where a.proposal_no=?)
getCommodityName=select a.commodity_id,b.commodity_name,a.commodity_name_desc from open_cover_commodity_master a,commoditymaster b where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_commodity_master where proposal_no=? )  and a.status='Y' and b.commodity_id=a.commodity_id and  b.commodity_id=a.commodity_id and b.BRANCH_CODE=? and b.amend_id=(select max(amend_id) from commoditymaster where commodity_id=a.commodity_id and BRANCH_CODE=?)
getCommodityList=select a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name,A.COVER_TYPE_ID from open_cover_sub_detail a,mode_of_transport b,cover_master c where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and a.status='Y' and c.cover_id=a.cover_id and b.BRANCH_CODE=c.BRANCH_CODE and c.BRANCH_CODE=? and b.mode_transport_id=a.mode_transport_id group by a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name,A.COVER_TYPE_ID order by a.mode_transport_id,a.cover_id
getCommodityList1=select a.commodity_id,a.commodity_name_desc,b.commodity_name from open_cover_commodity_master a,commoditymaster b where a.proposal_no=? and b.BRANCH_CODE=? and a.amend_id=(select max(amend_id) from open_cover_commodity_master where proposal_no=?) and a.status='Y' and b.commodity_id=a.commodity_id and  b.commodity_id=a.commodity_id and b.amend_id=(select max(amend_id) from commoditymaster where commodity_id=a.commodity_id and BRANCH_CODE=?)
getCommodityList2=select commodity_id,cover_id,commodity_base_rate,COVER_TYPE_ID from open_cover_commodity_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_commodity_detail where proposal_no=?) order by commodity_id
getCommodityList11=select commodity_base_rate,amend_id,cover_id from open_cover_commodity_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_commodity_detail where proposal_no=?) order by commodity_id
getCountryDetails=select open_cover_country_id_dest,  war_rate from open_cover_country_master where proposal_no =? and amend_id = (select max(amend_id) from open_cover_country_master where proposal_no = ?)
getClausesInformation=select clauses_id,clauses_description from open_cover_clauses where status='Y' and cover_id=? and proposal_no = ?  and amend_id = (select max(amend_id) from open_cover_clauses where status='Y' and cover_id=? and proposal_no = ?)
getCoverName=select a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name from open_cover_sub_detail a,mode_of_transport b,cover_master c where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and a.status='Y' and  c.cover_id=a.cover_id and b.BRANCH_CODE = c.BRANCH_CODE and c.BRANCH_CODE=? and b.mode_transport_id=a.mode_transport_id group by a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name order by a.mode_transport_id,a.cover_id
getWSRCC=select clauses_id, clauses_description, extra_cover_id from clauses_master where extra_cover_id in ({0},{1}) and BRANCH_CODE={2} order by extra_cover_id desc
getWSRCC1=select warranty_id,warranty_description,extra_cover_id from open_cover_warranties where proposal_no=? and amend_id=(select max(amend_id) from open_cover_warranties where proposal_no=?)
getExclusions=select exclusion_id,exclusion_description,extra_cover_id from open_cover_exclusions where proposal_no=? and amend_id=(select max(amend_id) from open_cover_exclusions where proposal_no=?)
getFreeText=select free_text_id,nvl(free_text_description,'9999') from open_cover_free_text where proposal_no=? and cover_id=? and amend_id=(select max(amend_id) from open_cover_free_text where proposal_no=? and cover_id=?)
getFreeTextSummary=select free_text_id,free_text_description from open_cover_free_text where proposal_no=?  and amend_id=(select max(amend_id) from open_cover_free_text where proposal_no=?)
openCoverNumber=select open_cover_no from open_cover_position_master where proposal_no=?
openCoverNumber1=SELECT A.MISSIPPI_OPENCOVER_NO FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
openCoverNumber2=UPDATE OPEN_COVER_MASTER A SET A.MISSIPPI_OPENCOVER_NO=? WHERE A.PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
openCoverNumber3=update open_cover_position_master set admin_status='',open_cover_no=?,inception_date=(select distinct(open_cover_start_date) from open_cover_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?)),expiry_date=(select distinct(open_cover_end_date) from open_cover_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?)),status=?,RATE_PRINT_STATUS=?,CANCELLATION_CLAUSE=?,AMENDED_CLAUSE_PRINT_STATUS=?,CKEY=? where proposal_no=?
updateConveyance=UPDATE OPEN_COVER_DETAIL OCD SET OCD.CONVEYANCE=? WHERE OCD.PROPOSAL_NO=? AND OCD.MODE_TRANSPORT_ID=? AND OCD.STATUS='Y' AND TO_DATE(OCD.EFFECTIVE_DATE,'DD-MM-YY')<= TO_DATE(SYSDATE,'DD-MM-YY') AND OCD.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO=OCD.PROPOSAL_NO AND MODE_TRANSPORT_ID= OCD.MODE_TRANSPORT_ID AND STATUS='Y' AND TO_DATE(EFFECTIVE_DATE,'DD-MM-YY')<= TO_DATE(SYSDATE,'DD-MM-YY'))
updaterateYN=update open_cover_position_master set RATE_PRINT_STATUS=?,CANCELLATION_CLAUSE=?,AMENDED_CLAUSE_PRINT_STATUS=? where proposal_no=?
showCoverages=select a.amend_id,a.cover_id,a.sea_options,b.cover_name,a.mode_transport_id from open_cover_sub_detail a,cover_master b where a.proposal_no=? and b.amend_id=(select max(amend_id) from cover_master c where b.cover_id=c.cover_id and c.branch_code=b.branch_code) and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and b.cover_id=a.cover_id and b.BRANCH_CODE=? order by a.mode_transport_id
insertintoLcMaster=insert into open_cover_lc_master (lc_number,lc_amount,bank_id,AMEND_ID,LC_DATE,EFFECTIVE_DATE,Expiry_DATE,REMARKS,STATUS,open_cover_no,lc_id)values(?,?,?,?,SYSDATE,SYSDATE,SYSDATE,?,?,?,?)
getBranchFullDetail=select address1,address2,address3,city,country from branch_master where branch_code=?
getMOCGoodsName=SELECT SUBSTR (SYS_CONNECT_BY_PATH (commodity_name_desc , ','), 2) csv FROM (SELECT a.commodity_name_desc , ROW_NUMBER () OVER (ORDER BY b.commodity_id ) rn,COUNT (*) OVER () cnt from open_cover_commodity_master a,commoditymaster b where a.proposal_no=? and b.BRANCH_CODE=? and a.amend_id=(select max(amend_id) from open_cover_commodity_master where proposal_no=?) and a.status='Y' and b.commodity_id=a.commodity_id and  b.commodity_id=a.commodity_id and b.amend_id= (select max(amend_id) from commoditymaster where commodity_id=a.commodity_id and BRANCH_CODE=?) ) WHERE rn = cnt START WITH rn = 1 CONNECT BY rn = PRIOR rn + 1
getDebitDetails=select category_detail_id,detail_name from constant_detail where category_id=? and branch_code=?
getInstallmentDetails=select category_detail_id,detail_name from constant_detail where category_id=? and branch_code=?
getCommission=SELECT NVL(A.COMMISSION,0) FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
getNoteNo=SELECT A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
getDepositInfo=SELECT A.AMEND_ID,(SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID=139 AND CATEGORY_DETAIL_ID=A.DEPOSIT_TYPE AND BRANCH_CODE=A.BRANCH_CODE) DEPOSIT_TYPE,(SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID=140 AND CATEGORY_DETAIL_ID=A.INSTALLMENT_TYPE AND BRANCH_CODE=A.BRANCH_CODE) INSTALLMENT_TYPE,A.DEPOSIT_AMOUNT,A.ISSUANCE_FEE_DEBIT,A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO,TO_CHAR(A.DEBIT_NOTE_DATE,'DD/MM/YYYY') DEBIT_NOTE_DATE,TO_CHAR(A.CREDIT_NOTE_DATE,'DD/MM/YYYY') CREDIT_NOTE_DATE,A.EXISTING_DEPOSIT_YN FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.DEPOSIT_PREMIUM_YN='Y' ORDER BY A.AMEND_ID
getOpenCoverPolicyInfo=SELECT BM.BRANCH_CODE,BM.BRANCH_NAME,NVL(BM.ORIGINATION_COUNTRY_ID,0) ORIGINATION_COUNTRY_ID,BM.CURRENCY_ABBREVIATION,NVL(BM.DECIMAL_PLACES,0) DECIMAL_PLACES,BM.HEADER_IMG,BM.FOOTER_IMG,BM.SIGN_IMG,BM.STAMP,BM.CURRENCY_NAME,BM.CURRENCY_ABBREVIATION,NVL(BM.CURRENCY_ACRONYM,' ') CURRENCY_ACRONYM,BM.CURRENCY_DECIMAL_NAME,BM.CURRENCY_DECIMAL_DIGIT,BM.ADDRESS1,BM.REMARKS,OCM.DEBIT_NOTE_NO,OCM.CREDIT_NOTE_NO,TO_CHAR(OCM.DEBIT_NOTE_DATE,'DD/MM/YYYY') DEBIT_NOTE_DATE,TO_CHAR(OCM.CREDIT_NOTE_DATE,'DD/MM/YYYY') CREDIT_NOTE_DATE, OCPM.OPEN_COVER_NO,PM.PRODUCT_NAME,UPPER(PI.TITLE||' '||PI.FIRST_NAME) CUST_FIRST_NAME,TO_CHAR(OCPM.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE,TO_CHAR(OCPM.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,NVL(OCM.COMMISSION,0) COMMISSION, ROUND(NVL(OCM.DEPOSIT_AMOUNT,0),NVL(CM.RFACTOR,0)) DEPOSIT_AMOUNT,OCM.DEBIT_NOTE_NAME, ROUND((NVL(OCM.COMMISSION,0)*NVL(OCM.DEPOSIT_AMOUNT,0)/100),NVL(CM.RFACTOR,0)) COMMISSION_AMOUNT, NVL(LM.CORE_LOGIN_ID,LM.LOGIN_ID) CORE_LOGIN_ID,(SELECT UPPER(DETAIL_NAME) FROM CONSTANT_DETAIL WHERE CATEGORY_ID=139 AND CATEGORY_DETAIL_ID=OCM.DEPOSIT_TYPE AND BRANCH_CODE=OCM.BRANCH_CODE) DEPOSIT_TYPE,ROUND(NVL(OCM.ISSUANCE_FEE_DEBIT,0),NVL(CM.RFACTOR,0)) ISSUANCE_FEE_DEBIT,OCM.MIN_PREMIUM_ISSUANCE_FEE,PI.CUSTOMER_ID,PI.POBOX CUST_POBOX,UPPER(PI.COMPANY_NAME) CUST_COMPANY,UPPER(PI.LAST_NAME) CUST_LAST_NAME,CM.CURRENCY_ID,CM.SUB_CURRENCY, UPPER(PI.ADDRESS1) CUST_ADDR1,UPPER(PI.ADDRESS2) CUST_ADDR2,PI.TELEPHONE CUST_TEL,UPPER(PI.COUNTRY) CUST_COUNTRY,UPPER(NVL(PI.CITY,PI.EMIRATE)) CUST_CITY,PI.CUST_AR_NO,(SELECT CUST_AR_NO FROM PERSONAL_INFO WHERE CUSTOMER_ID=BCM.CUSTOMER_ID)BROKER_AR_NO,BCM.CONTACT_PERSON,UPPER(BCM.ADDRESS1) BROKER_ADDR1,UPPER(BCM.ADDRESS2) BROKER_ADDR2,UPPER(BCM.CITY) BROKER_CITY,UPPER(BCM.COUNTRY) BROKER_COUNTRY,BCM.PHONE BROKER_PHONE,BCM.POBOX BROKER_POBOX,UPPER(NVL(BCM.CITY,BCM.EMIRATE)) BROKER_CITY,UPPER(BCM.COMPANY_NAME) BROKER_COMPANY,ROUND((NVL(OCM.DEPOSIT_AMOUNT,0)+NVL(OCM.ISSUANCE_FEE_DEBIT,0)),NVL(CM.RFACTOR,0)) NET_AMOUNT,OCM.MIN_PREMIUM_ISSUANCE_FEE ISSUANCE_FEE,OCM.TYPE OPEN_COVER_TYPE,OCM.BROKER_ID FROM BRANCH_MASTER BM, OPEN_COVER_POSITION_MASTER OCPM, PRODUCT_MASTER PM, OPEN_COVER_MASTER OCM,LOGIN_MASTER LM,PERSONAL_INFO PI,CURRENCY_MASTER CM, BROKER_COMPANY_MASTER BCM WHERE BM.BRANCH_CODE=OCM.BRANCH_CODE AND OCPM.OPEN_COVER_NO=? AND PM.PRODUCT_ID=OCM.PRODUCT_ID AND OCM.PROPOSAL_NO=OCPM.PROPOSAL_NO AND LM.LOGIN_ID=? AND PI.CUSTOMER_ID=OCM.CUSTOMER_ID AND OCM.AMEND_ID=? AND PM.BRANCH_CODE=BM.BRANCH_CODE AND OCPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO=OCPM.OPEN_COVER_NO) AND CM.CURRENCY_ID=1 AND BCM.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=OCM.BROKER_ID) AND CM.COUNTRY_ID=BM.ORIGINATION_COUNTRY_ID
getOpenCoverCommodityInfo=SELECT OCCM.COMMODITY_ID,UPPER(OCCM.COMMODITY_NAME_DESC) COMMODITY_NAME_DESC FROM OPEN_COVER_COMMODITY_MASTER OCCM, OPEN_COVER_POSITION_MASTER OCPM WHERE OCCM.PROPOSAL_NO=OCPM.PROPOSAL_NO AND OCCM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO=OCCM.PROPOSAL_NO) AND OCPM.OPEN_COVER_NO=? ORDER BY OCCM.COMMODITY_ID
updateDepositInfo=SELECT NVL(A.RFACTOR,0), B.ISSUANCE_FEE, B.MIN_PREMIUM_ISSUANCE_FEE FROM CURRENCY_MASTER A, OPEN_COVER_MASTER B, BRANCH_MASTER C WHERE A.CURRENCY_ID=1 AND A.COUNTRY_ID=C.ORIGINATION_COUNTRY_ID AND C.BRANCH_CODE=B.BRANCH_CODE AND B.PROPOSAL_NO=? AND B.AMEND_ID=(SELECT MAX(AMEND_ID)FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=B.PROPOSAL_NO)
updateDepositInfo1=UPDATE OPEN_COVER_MASTER A SET A.DEPOSIT_PREMIUM_YN=?,A.DEPOSIT_TYPE=?,A.INSTALLMENT_TYPE=?,A.DEPOSIT_AMOUNT=ROUND(?,{0}),A.DEBIT_NOTE_NO=?{1},A.CREDIT_NOTE_NO=?{2},A.DEBIT_NOTE_NAME=?,A.ISSUANCE_FEE_DEBIT=(SELECT CASE WHEN ({3}*{4})/100<={5} THEN {6} ELSE ROUND(({7}*{8})/100,{9}) END FROM DUAL),A.REMARKS=?,A.EXISTING_DEPOSIT_YN=?,A.MARINE_PREMIUM=?, A.WAR_PREMIUM=? WHERE A.PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
getDeductible=SELECT OCCM.START_RANGE,OCCM.END_RANGE,OCCM.EXCESS_AMOUNT,OCCM.CURRENCY_NAME,OCCM.EXCESS_PERCENT FROM OPEN_COVER_DEDUCTIBLE_MASTER OCCM WHERE OCCM.STATUS='Y' AND OCCM.OPEN_COVER_PROPOSAL_NO=? AND TO_DATE(OCCM.effective_date,'dd-MM-YY') <= TO_DATE(SYSDATE,'dd-MM-YY') AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_DEDUCTIBLE_MASTER WHERE OPEN_COVER_PROPOSAL_NO=OCCM.OPEN_COVER_PROPOSAL_NO AND TO_DATE(effective_date,'dd-MM-YY') <= TO_DATE(SYSDATE,'dd-MM-YY') )
GET_FREETEXT1=select free_text_id,nvl(free_text_description,'9999') from open_cover_free_text where proposal_no=? and cover_id=? and amend_id=(select max(amend_id) from open_cover_free_text where proposal_no=? and cover_id=?)
GET_FREETEXT2=select free_text_id,nvl(free_text_description,'9999') from open_cover_free_text where proposal_no=? and cover_id=? and amend_id=(select max(amend_id) from open_cover_free_text where proposal_no=? and cover_id=? and type='F')
showCoveragesWithMode=select a.amend_id,a.cover_id,a.sea_options,b.cover_name,a.mode_transport_id, ( C.TRANSPORT_DESCRIPTION || ' - ' || b.cover_name ) DESCRIPTION from open_cover_sub_detail a,cover_master b, mode_of_transport C where a.proposal_no\=? and a.amend_id\=(select max(amend_id) from open_cover_sub_detail where proposal_no\=?)and b.cover_id\=a.cover_id and b.BRANCH_CODE\=? AND C.MODE_TRANSPORT_ID\=A.MODE_TRANSPORT_ID and c.BRANCH_CODE\=B.BRANCH_CODE order by a.mode_transport_id
getOpenCoverAdditionalInsured=SELECT CASE WHEN A.ADDITIONAL_INSURED IS NULL THEN TO_CHAR(A.CUSTOMER_ID) ELSE TO_CHAR(A.CUSTOMER_ID)||','||A.ADDITIONAL_INSURED END FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
COMMAMED=select ISNULL(max(amend_id)+1,'0') from open_cover_commodity_master where proposal_no=?
OCSUBDET=select ISNULL(max(amend_id)+1,'0') from open_cover_sub_detail where proposal_no\=? 
AMDOCD=select ISNULL(max(amend_id)+1,'0') from open_cover_detail where proposal_no=?
AMDOCCD=select ISNULL(max(amend_id)+1,'0') from open_cover_commodity_detail where proposal_no={0}
AMDOCSP=select NULLIF(max(amend_id)+1,'0') from open_cover_share_percentage where proposal_no=?
#27 05
getLapsedOpenCoversSearch=select nvl(open_cover_no,'0') from LOGIN_USER_DETAILS where login_id=? and  product_id='11'
getLapsedOpenCoversSearch1=SELECT DISTINCT nvl(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, ''dd'') AS days, TO_CHAR (ocpm.inception_date, ''MM'') AS months, TO_CHAR (ocpm.inception_date, ''YYYY') AS years, TO_CHAR (ocpm.expiry_date, 'dd') AS days, TO_CHAR (ocpm.expiry_date, 'MM') AS months, TO_CHAR (ocpm.expiry_date, 'YYYY') AS years, NVL (pi.COMPANY_NAME, pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, (TRUNC (SYSDATE) - TRUNC (ocpm.expiry_date)) expiry_days FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE {0}  AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and ocpm.amend_id=(Select max(Amend_id) from open_cover_position_master ocp Where nvl(ocpm.original_policy_no,ocpm.open_cover_no)=nvl(ocp.original_policy_no,ocp.open_cover_no)) AND (TO_DATE (ocpm.expiry_date, 'dd-mm-YYYY') <= TO_DATE (SYSDATE, 'dd-mm-YYYY') OR ocpm.admin_status = 'N') ORDER BY nvl(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch2=SELECT DISTINCT nvl(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd') AS days, TO_CHAR (ocpm.inception_date, 'MM') AS months, TO_CHAR (ocpm.inception_date, 'YYYY') AS years, TO_CHAR (ocpm.expiry_date, 'dd') AS days, TO_CHAR (ocpm.expiry_date, 'MM') AS months, TO_CHAR (ocpm.expiry_date, 'YYYY') AS years, NVL (pi.COMPANY_NAME, pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, (TRUNC (SYSDATE) - TRUNC (ocpm.expiry_date)) expiry_days FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.status = 'Y' And not exists (select 'Y' from login_master lm where ocm.broker_id=lm.login_id and agency_code in  (Select BROKER_CODE from login_rsauser_details lud where lud.LOGIN_ID=''{0}'' and product_id=11)) AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and (lower(trim(pi.company_name)) like '%"+searchValue.trim().toLowerCase()+"%' or lower(trim(pi.first_name)) like '%"+searchValue.trim().toLowerCase()+"%') and ocpm.amend_id=(Select max(Amend_id) from open_cover_position_master ocp Where nvl(ocpm.original_policy_no,ocpm.open_cover_no)=nvl(ocp.original_policy_no,ocp.open_cover_no)) AND (TO_DATE (ocpm.expiry_date, 'dd-mm-YYYY') <= TO_DATE (SYSDATE, 'dd-mm-YYYY') OR ocpm.admin_status = 'N') ORDER BY nvl(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch3=SELECT DISTINCT nvl(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd') AS days, TO_CHAR (ocpm.inception_date, 'MM') AS months, TO_CHAR (ocpm.inception_date, 'YYYY') AS years, TO_CHAR (ocpm.expiry_date, 'dd') AS days, TO_CHAR (ocpm.expiry_date, 'MM') AS months, TO_CHAR (ocpm.expiry_date, 'YYYY') AS years, NVL (pi.COMPANY_NAME, pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, (TRUNC (SYSDATE) - TRUNC (ocpm.expiry_date)) expiry_days FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE "+condition+" AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and (lower(trim(pi.company_name)) like '%"+searchValue.trim().toLowerCase()+"%' or lower(trim(pi.first_name)) like '%"+searchValue.trim().toLowerCase()+"%') and ocpm.amend_id=(Select max(Amend_id) from open_cover_position_master ocp Where nvl(ocpm.original_policy_no,ocpm.open_cover_no)=nvl(ocp.original_policy_no,ocp.open_cover_no)) AND (TO_DATE (ocpm.expiry_date, 'dd-mm-YYYY') <= TO_DATE (SYSDATE, 'dd-mm-YYYY') OR ocpm.admin_status = 'N') ORDER BY nvl(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch4=SELECT DISTINCT nvl(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd') AS days, TO_CHAR (ocpm.inception_date, 'MM') AS months, TO_CHAR (ocpm.inception_date, 'YYYY') AS years, TO_CHAR (ocpm.expiry_date, 'dd') AS days, TO_CHAR (ocpm.expiry_date, 'MM') AS months, TO_CHAR (ocpm.expiry_date, 'YYYY') AS years, NVL (pi.COMPANY_NAME, pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, (TRUNC (SYSDATE) - TRUNC (ocpm.expiry_date)) expiry_days FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.status = 'Y' And not exists (select 'Y' from login_master lm where ocm.broker_id=lm.login_id and agency_code in  (Select BROKER_CODE from login_rsauser_details lud where lud.LOGIN_ID='"+loginId+"' and product_id=11)) AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and  (ocpm.open_cover_no like '%"+searchValue+"%') and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and ocpm.amend_id=(Select max(Amend_id) from open_cover_position_master ocp Where nvl(ocpm.original_policy_no,ocpm.open_cover_no)=nvl(ocp.original_policy_no,ocp.open_cover_no)) AND (TO_DATE (ocpm.expiry_date, 'dd-mm-YYYY') <= TO_DATE (SYSDATE, 'dd-mm-YYYY') OR ocpm.admin_status = 'N') ORDER BY nvl(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch5=SELECT DISTINCT nvl(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd') AS days, TO_CHAR (ocpm.inception_date, 'MM') AS months, TO_CHAR (ocpm.inception_date, 'YYYY') AS years, TO_CHAR (ocpm.expiry_date, 'dd') AS days, TO_CHAR (ocpm.expiry_date, 'MM') AS months, TO_CHAR (ocpm.expiry_date, 'YYYY') AS years, NVL (pi.COMPANY_NAME, pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, (TRUNC (SYSDATE) - TRUNC (ocpm.expiry_date)) expiry_days FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE "+condition+" AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and  (ocpm.open_cover_no like '%"+searchValue+"%') and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and ocpm.amend_id=(Select max(Amend_id) from open_cover_position_master ocp Where nvl(ocpm.original_policy_no,ocpm.open_cover_no)=nvl(ocp.original_policy_no,ocp.open_cover_no)) AND (TO_DATE (ocpm.expiry_date, 'dd-mm-YYYY') <= TO_DATE (SYSDATE, 'dd-mm-YYYY') OR ocpm.admin_status = 'N') ORDER BY nvl(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch6=SELECT DISTINCT nvl(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd') AS days, TO_CHAR (ocpm.inception_date, 'MM') AS months, TO_CHAR (ocpm.inception_date, 'YYYY') AS years, TO_CHAR (ocpm.expiry_date, 'dd') AS days, TO_CHAR (ocpm.expiry_date, 'MM') AS months, TO_CHAR (ocpm.expiry_date, 'YYYY') AS years, NVL (pi.COMPANY_NAME, pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, (TRUNC (SYSDATE) - TRUNC (ocpm.expiry_date)) expiry_days FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.status = 'Y' And not exists (select 'Y' from login_master lm where ocm.broker_id=lm.login_id and agency_code in  (Select BROKER_CODE from login_rsauser_details lud where lud.LOGIN_ID='"+loginId+"' and product_id=11)) AND ocpm.status IN ('P', 'R') AND TO_CHAR (ocpm.inception_date, 'dd/MM/YYYY') = '"+searchValue+"' AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and ocpm.amend_id=(Select max(Amend_id) from open_cover_position_master ocp Where nvl(ocpm.original_policy_no,ocpm.open_cover_no)=nvl(ocp.original_policy_no,ocp.open_cover_no)) AND (TO_DATE (ocpm.expiry_date, 'dd-mm-YYYY') <= TO_DATE (SYSDATE, 'dd-mm-YYYY') OR ocpm.admin_status = 'N') ORDER BY nvl(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch7=SELECT DISTINCT nvl(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,TO_CHAR (ocpm.inception_date, 'dd') AS days, TO_CHAR (ocpm.inception_date, 'MM') AS months, TO_CHAR (ocpm.inception_date, 'YYYY') AS years, TO_CHAR (ocpm.expiry_date, 'dd') AS days, TO_CHAR (ocpm.expiry_date, 'MM') AS months, TO_CHAR (ocpm.expiry_date, 'YYYY') AS years, NVL (pi.COMPANY_NAME, pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, (TRUNC (SYSDATE) - TRUNC (ocpm.expiry_date)) expiry_days FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE "+condition+"  AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND TO_CHAR (ocpm.inception_date, 'dd/MM/YYYY') = '"+searchValue+"' AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and ocpm.amend_id=(Select max(Amend_id) from open_cover_position_master ocp Where nvl(ocpm.original_policy_no,ocpm.open_cover_no)=nvl(ocp.original_policy_no,ocp.open_cover_no)) AND (TO_DATE (ocpm.expiry_date, 'dd-mm-YYYY') <= TO_DATE (SYSDATE, 'dd-mm-YYYY') OR ocpm.admin_status = 'N') ORDER BY nvl(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getCreatedOpenCoversSearch=trim(to_char(nvl(ocm.CROSS_VOYAGE_TURNOVER,0)-nvl(ocm.UTILIZED_AMOUNT,0),'999G999G999G999G999G999G999G999G990'))
getCreatedOpenCoversSearch1=select nvl(open_cover_no,'0') from LOGIN_USER_DETAILS where login_id=? and  product_id='11'
getCreatedOpenCoversSearch2=select distinct(ocpm.open_cover_no),ocm.customer_id,to_char(ocpm.inception_date,'dd')as days,to_char(ocpm.inception_date,'MM')as months,to_char(ocpm.inception_date,'YYYY')as years,to_char(ocpm.expiry_date,'dd')as days,to_char(ocpm.expiry_date,'MM')as months,to_char(ocpm.expiry_date,'YYYY')as years,nvl(pi.COMPANY_NAME,pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,NVL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),"+balanceAmount+" from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where "+condition+" and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no and to_date(ocpm.expiry_date,'dd-MM-YYYY')+30 >= to_date(sysdate,'dd-MM-YYYY') and (ocpm.admin_status is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
getCreatedOpenCoversSearch3=select distinct(ocpm.open_cover_no),ocm.customer_id,to_char(ocpm.inception_date,'dd')as days,to_char(ocpm.inception_date,'MM')as months,to_char(ocpm.inception_date,'YYYY')as years,to_char(ocpm.expiry_date,'dd')as days,to_char(ocpm.expiry_date,'MM')as months,to_char(ocpm.expiry_date,'YYYY')as years,nvl(pi.COMPANY_NAME,pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,NVL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),"+balanceAmount+" from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and (lower(trim(pi.company_name)) like '%"+searchValue.trim().toLowerCase()+"%' or lower(trim(pi.first_name)) like '%"+searchValue.trim().toLowerCase()+"%') and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no and to_date(ocpm.expiry_date,'dd-MM-YYYY')+30 >= to_date(sysdate,'dd-MM-YYYY') and (ocpm.admin_status is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
getCreatedOpenCoversSearch4=select distinct(ocpm.open_cover_no),ocm.customer_id,to_char(ocpm.inception_date,'dd')as days,to_char(ocpm.inception_date,'MM')as months,to_char(ocpm.inception_date,'YYYY')as years,to_char(ocpm.expiry_date,'dd')as days,to_char(ocpm.expiry_date,'MM')as months,to_char(ocpm.expiry_date,'YYYY')as years,nvl(pi.COMPANY_NAME,pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,NVL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),"+balanceAmount+" from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where "+condition+" and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and (lower(trim(pi.company_name)) like '%"+searchValue.trim().toLowerCase()+"%' or lower(trim(pi.first_name)) like '%"+searchValue.trim().toLowerCase()+"%') and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no and to_date(ocpm.expiry_date,'dd-MM-YYYY')+30 >= to_date(sysdate,'dd-MM-YYYY') and (ocpm.admin_status is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
getCreatedOpenCoversSearch5=select distinct(ocpm.open_cover_no),ocm.customer_id,to_char(ocpm.inception_date,'dd')as days,to_char(ocpm.inception_date,'MM')as months,to_char(ocpm.inception_date,'YYYY')as years,to_char(ocpm.expiry_date,'dd')as days,to_char(ocpm.expiry_date,'MM')as months,to_char(ocpm.expiry_date,'YYYY')as years,nvl(pi.COMPANY_NAME,pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,NVL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),"+balanceAmount+" from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and (ocpm.open_cover_no like '%"+searchValue+"%') and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no and to_date(ocpm.expiry_date,'dd-MM-YYYY')+30 >= to_date(sysdate,'dd-MM-YYYY') and (ocpm.admin_status is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
getCreatedOpenCoversSearch6=select distinct(ocpm.open_cover_no),ocm.customer_id,to_char(ocpm.inception_date,'dd')as days,to_char(ocpm.inception_date,'MM')as months,to_char(ocpm.inception_date,'YYYY')as years,to_char(ocpm.expiry_date,'dd')as days,to_char(ocpm.expiry_date,'MM')as months,to_char(ocpm.expiry_date,'YYYY')as years,nvl(pi.COMPANY_NAME,pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,NVL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),"+balanceAmount+" from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where "+condition+" and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and (ocpm.open_cover_no like '%"+searchValue+"%') and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no and to_date(ocpm.expiry_date,'dd-MM-YYYY')+30 >= to_date(sysdate,'dd-MM-YYYY') and (ocpm.admin_status is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
getCreatedOpenCoversSearch7=select distinct(ocpm.open_cover_no),ocm.customer_id,to_char(ocpm.inception_date,'dd')as days,to_char(ocpm.inception_date,'MM')as months,to_char(ocpm.inception_date,'YYYY')as years,to_char(ocpm.expiry_date,'dd')as days,to_char(ocpm.expiry_date,'MM')as months,to_char(ocpm.expiry_date,'YYYY')as years,nvl(pi.COMPANY_NAME,pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,NVL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),"+balanceAmount+" from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and to_char(ocpm.inception_date,'dd/MM/YYYY')='"+searchValue+"' and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no and to_date(ocpm.expiry_date,'dd-MM-YYYY')+30 >= to_date(sysdate,'dd-MM-YYYY') and (ocpm.admin_status is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
getCreatedOpenCoversSearch8=select distinct(ocpm.open_cover_no),ocm.customer_id,to_char(ocpm.inception_date,'dd')as days,to_char(ocpm.inception_date,'MM')as months,to_char(ocpm.inception_date,'YYYY')as years,to_char(ocpm.expiry_date,'dd')as days,to_char(ocpm.expiry_date,'MM')as months,to_char(ocpm.expiry_date,'YYYY')as years,nvl(pi.COMPANY_NAME,pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,NVL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),"+balanceAmount+" from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where "+condition+" and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and to_char(ocpm.inception_date,'dd/MM/YYYY')='"+searchValue+"' and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no and to_date(ocpm.expiry_date,'dd-MM-YYYY')+30 >= to_date(sysdate,'dd-MM-YYYY') and (ocpm.admin_status is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
getCreatedOpenCoversSearch9=select distinct(ocpm.open_cover_no),ocm.customer_id,to_char(ocpm.inception_date,'dd')as days,to_char(ocpm.inception_date,'MM')as months,to_char(ocpm.inception_date,'YYYY')as years,to_char(ocpm.expiry_date,'dd')as days,to_char(ocpm.expiry_date,'MM')as months,to_char(ocpm.expiry_date,'YYYY')as years,nvl(pi.COMPANY_NAME,pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,NVL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),"+balanceAmount+" from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where "+condition+" and ocm.status\='Y' and ocpm.status\='P' and ocm.proposal_no\=ocpm.proposal_no and pi.customer_id\=ocm.customer_id and pi.status\='Y' and to_char(ocpm.inception_date,'dd/MM/YYYY')\='"+searchValue+"' and ocm.amend_id||'-'||ocm.proposal_no in (select max(ocms.amend_id)||'-'||ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no\=ocms.proposal_no and to_date(ocpm.expiry_date,'dd-MM-YYYY')+30 >\= to_date(sysdate,'dd-MM-YYYY') and (ocpm.admin_status is null or ocpm.admin_status\='Y') group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
saveOptionalCovers=select nvl(max(amend_id)+1,0) from OPEN_COVER_FREE_TEXT where PROPOSAL_NO\=? and cover_id\=?
getBrokersList=SELECT l.login_id, b.company_name, b.agency_code, b.AC_EXECUTIVE_ID FROM login_master l, BROKER_COMPANY_MASTER b WHERE b.agency_code \= l.agency_code AND l.login_id NOT IN ('NON', 'NONE') AND l.status IN ('Y','T') AND l.login_id IS NOT NULL AND b.agency_code IS NOT NULL AND b.branch_code \= ? AND b.agency_code not IN (SELECT DISTINCT broker_code FROM LOGIN_RSAUSER_DETAILS WHERE login_id \= ?  AND trunc(START_DATE) <\= TRUNC (SYSDATE) AND trunc(END_DATE) >\= TRUNC (SYSDATE) AND (amend_id || broker_code) IN (SELECT MAX (amend_id) || broker_code FROM LOGIN_RSAUSER_DETAILS WHERE login_id \=? AND trunc(START_DATE) <\= trunc(sysdate) AND trunc(END_DATE) >\=trunc(sysdate) GROUP BY broker_code) AND status \= 'Y') ORDER BY b.company_name
getPortfolioByDate1=select * from table(policy_report('','','','','',?,?))
getPortfolioByDate2=select * from table(policy_report(?,?,?,?,?,'',''))

#Declaration
declaration.getcustomerId=SELECT FIRST_NAME || NVL(LAST_NAME,'') FROM PERSONAL_INFO WHERE CUSTOMER_ID IN( SELECT CUSTOMER_ID FROM OPEN_COVER_MASTER WHERE  MISSIPPI_OPENCOVER_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO\=?))
declaration.getDeclarationList=SELECT PM.POLICY_NO, PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(NVL (MD. PREMIUM, 0) + NVL (MD.EXCESS_PREMIUM, 0)) PREMIUM,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) = 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID=MPD.SETTLING_AGENT_ID AND BRANCH_CODE=?) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_POLICY_DETAILS MPD WHERE PM.OPEN_COVER_NO = ?  AND PM.STATUS = 'P' AND PM.REMARKS IN ('Normal', 'Admin') AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > ( SELECT SYSDATE FROM DUAL) AND PM.LOGIN_ID = ? AND PM.APPLICATION_ID = NVL(?,'1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO=PM.APPLICATION_NO AND MPD.QUOTE_NO=PM.QUOTE_NO and PM.POLICY_NO = ? ORDER BY PM.QUOTE_NO
declaration.getDeclarationList1=SELECT DISTINCT TR.TRANSACTION_ID, TO_CHAR (TR.TRANSACTION_DATE, 'DD/MM/YYYY') TRN_DATE, TR.USER_NAME, TR.FILE_NAME, TR.TOTAL_NO_OF_RECORDS, TR.UPLOADED_COUNT, TR.PENDING_COUNT FROM XL_TRANSACTION_DETAILS TR  WHERE TR.OPENCOVER_POLICY_NUMBER = ? AND TR.transaction_id IS NOT NULL AND tr.issuer IS NULL ORDER BY TR.transaction_id DESC
declaration.getDeclarationList2=SELECT A.QUOTE_NO, NVL (B.COMPANY_NAME, B.FIRST_NAME) FIRST_NAME ,M.TOTAL_SUM_INSURED TOTAL_SUM_INSURED,(NVL (M.PREMIUM, 0) + NVL (M.EXCESS_PREMIUM, 0) + NVL (M.GOVT_TAX, 0) +NVL (M.EMERGENCY_FUND, 0 ) + NVL (M.POLICY_FEE, 0)) PREMIUM,( select count(*) from WEBSERVICE_MARINE_QUOTE  WHERE APPLICATION_NO = M.APPLICATION_NO and TRANSACTION_ID is not null ) PACKAGE_DESCRIPTION FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M   WHERE A.LOGIN_ID =? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > = SYSDATE AND A.STATUS  = 'Y' AND (A.REMARKS NOT IN ('Admin', 'Referal', 'NORMAL_EXCESS_PRICE')) AND M.APPLICATION_NO  = A.APPLICATION_NO AND NVL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y')      AND B.CUSTOMER_ID = A.CUSTOMER_ID AND A.PRODUCT_ID = ?  AND A.APPLICATION_ID = NVL(?,'1') AND NVL(A.OPEN_COVER_NO,'0') like NVL(? ||'%','0') ORDER BY QUOTE_NO DESC
TRANID_SEQ=SELECT TRANSACTION_CODE.NEXTVAL FROM DUAL
declaration.insertTransactionDetails=INSERT INTO XL_TRANSACTION_DETAILS (TRANSACTION_ID,TRANSACTION_DATE,USER_NAME,FILE_NAME,PATH,ACTIVE,MOVEMENT_DETAIL_ID,OPENCOVER_POLICY_NUMBER,TRANSACTION_DESCRIPTION,ISSUER) VALUES(?,SYSDATE,?,?,?,'Y',?,?,?,?)
declaration.checkProposal=UPDATE {0} SET VALIDATION_ERROR=VALIDATION_ERROR||'',BROKER CODE INVALID'' WHERE BROKER_CODE NOT IN ( SELECT OA_CODE FROM LOGIN_MASTER WHERE STATUS=''Y'' AND LOGIN_ID=''{1}'') AND TRANSACTION_ID=?
declaration.checkProposal1=UPDATE {0} SET VALIDATION_ERROR=VALIDATION_ERROR||'',OPEN COVER NO INVALID'' WHERE MOC_NUMBER NOT IN ( SELECT MISSIPPI_OPENCOVER_NO FROM OPEN_COVER_MASTER WHERE STATUS=''Y'' and broker_id =''{1}'') AND TRANSACTION_ID=?
declaration.updateOpenCoverDetail=UPDATE WEBSERVICE_MARINE_QUOTE_RAW SET VALIDATION_ERROR=VALIDATION_ERROR||',BROKER CODE INVALID' WHERE BROKER_CODE NOT IN ( SELECT AGENCY_CODE FROM BROKER_COMPANY_MASTER WHERE STATUS='Y' ) AND TRANSACTION_ID=?
declaration.updateREsponse=update WEBSERVICE_MARINE_QUOTE_RAW set RESPONSE_TIME=sysdate where transaction_id = ?
declaration.updateComm=update webservice_marine_commodity_rw wr set RESPONSE_TIME\=sysdate where transaction_id \= ?


#Bulk Print Report
GET_OP_BP_COUNT = select  distinct (select username from login_master  where login_id=APPLICATION_ID) username,sum(total_policy) total_policy,APPLICATION_ID from table(Schedule_generation(?,?,?,?,'',?,?,'',?))  where APPLICATION_ID !='1' group by APPLICATION_ID
GET_OP_OPEN_BP_COUNT = SELECT  DISTINCT (SELECT username FROM login_master WHERE login_id = APPLICATION_ID) username,APPLICATION_ID,COUNT (Open_Cover_No) TOTAL_OPEN_COVER FROM   (  SELECT   APPLICATION_ID,Open_Cover_No,LOGIN_ID,company_name,total_policy FROM table (Schedule_generation (?,?,?,?,'',?,?,'',?)) WHERE   APPLICATION_ID != '1' GROUP BY   APPLICATION_ID,Open_Cover_No,LOGIN_ID,company_name,total_policy) GROUP BY   APPLICATION_ID
GET_BR_BP_LIST = select * from table(Schedule_generation(?,?,?,?,'',?,?,?,?))
GET_BR_OPEN_BP_LIST = select company_name,LOGIN_ID,count(Open_Cover_No) TOTAL_OPEN_COVER from ( SELECT   APPLICATION_ID,LOGIN_ID,company_name,Open_Cover_No FROM table (Schedule_generation (?,?,?,?,'',?,?,?,?)) WHERE   APPLICATION_ID = '1'  GROUP BY   APPLICATION_ID,LOGIN_ID,company_name,Open_Cover_No) group by  company_name,LOGIN_ID
GET_BR_OP_BP_LIST = select * from table(Schedule_generation(?,?,?,?,'',?,?,?,''))
ET_BR_OP_OPEN_BP_LIST = select Open_Cover_No,LOGIN_ID,company_name,total_policy,application_id from table(Schedule_generation( ?,?,?,?,'',?,?,?,?)) group by Open_Cover_No,LOGIN_ID,company_name,total_policy,application_id
GET_OP_USERNAME = select USERNAME from login_master where login_id=?
GET_CANCEL_REMARKS=select nvl(ENDT_REMARKS,CANCEL_REMARKS) ENDT_REMARKS from position_master pm where pm.QUOTE_NO=? and pm.AMEND_ID=(select max(AMEND_ID) from position_master where  QUOTE_NO=pm.QUOTE_NO )
GET_LOG_USERTYPE=select USERTYPE from LOGIN_MASTER where LOGIN_ID=?
GET_LATEST_APPLICATION_NO= select BM.COMPANY_NAME,Lm.LOGIN_ID,PI.FIRST_NAME,PM.QUOTE_NO,PM.APPLICATION_NO from  position_master PM,broker_company_master BM,personaL_Info PI,login_master LM where pm.login_id=lm.login_id and lm.oa_code=BM.AGENCY_CODE and pm.customer_id=pi.customer_id and pm.policy_no=?
SEARCH_REFFERRAL=SELECT CASE WHEN PM.APPLICATION_ID='1' THEN  PM.LOGIN_ID ELSE PM.APPLICATION_ID END  QUOTE_CREATED,PM.APPLICATION_NO,PM.LOGIN_ID,PM.QUOTE_NO,MD.REMARKS,PM.APPLICATION_ID ,CASE WHEN PM.STATUS='E' THEN 'Endt' ELSE 'Normal' END STATUS, C.CUSTOMER_ID, C.CUST_NAME, D.COMPANY_NAME BROKERNAME ,PM.PRODUCT_ID PRODUCT_ID  FROM POSITION_MASTER PM,MARINE_DATA MD, PERSONAL_INFO C,BROKER_COMPANY_MASTER D  WHERE C.CUSTOMER_ID=PM.CUSTOMER_ID AND PM.APPLICATION_NO=MD.APPLICATION_NO  AND PM.REMARKS IN ('Admin','NORMAL_EXCESS_PRICE','Referal') AND MD.ADMIN_REFERRAL_STATUS='N'  AND PM.STATUS IN('Y','E') AND PM.FREIGHT_STATUS IS NULL AND  PM.QUOTE_NO=?  and D.AGENCY_CODE =(Select OA_CODE from login_master Where login_id=PM.LOGIN_ID)
getYetToStratMOC=select ocpms.open_cover_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no and to_date(ocpms.inception_date,''dd-MM-YYYY'') > to_date(sysdate,''dd-MM-YYYY'') and ocpms.status=''P'' and (ocpms.admin_status is null or ocpms.admin_status=''Y'') and ocpms.open_cover_no in({0}) group by ocpms.open_cover_no

GET_QUOTATION_DETAIL = SELECT HPM.QUOTE_REF_NO,HPM.POLICY_NO,HPM.OVERALL_PREMIUM PREMIUM, HPM.QUOTE_NO,HPM.PRODUCT_ID||'' PRODUCT_ID ,HPM.APPLICATION_NO ,TO_CHAR(HPM.INCEPTION_DATE ,'dd/MM/YYYY') INCEPTION_DATE, TO_CHAR(HPM.EXPIRY_DATE ,'dd/MM/YYYY') EXPIRY_DATE ,DECODE(HPM.PRODUCT_ID,'40','Yacht','42','JetSki')||'-'|| DECODE(YRI.RSI_POLICY_TYPE , '1','Comprehensive Insurance' , '2','Third-party Liability Insurance')POLICY_TYPE , PI.FIRST_NAME ,YVI.VESI_NAME , YEI.ENGI_SERIAL_NO, YVI.VESI_COAST_GAURD, YVI.VESI_REG_NO , YEI.ENGI_CHASSIS_NO , DECODE(HPM.STATUS , 'P','Active' , 'D','Cancelled')STATUS FROM HOME_POSITION_MASTER HPM , YACT_RISK_INFO YRI ,YACT_ENGINE_INFO YEI,PERSONAL_INFO PI , YACT_VESSEL_INFO YVI WHERE HPM.QUOTE_NO = YRI.QUOTE_NO AND YRI.QUOTE_NO = YEI.QUOTE_NO AND HPM.CUSTOMER_ID = PI.CUSTOMER_ID AND HPM.QUOTE_NO = YVI.QUOTE_NO AND HPM.VERIFICATION_CODE = ? AND HPM.POLICY_NO = ?
GET_QUOTATION_DETAIL_MARINE =  SELECT PM.POLICY_NO,PM.PRODUCT_ID,DECODE(PM.PRODUCT_ID , '3','Marine Cargo Individual Policy','11','Marine Cargo Certificate')POLICY_TYPE , WMQ.CUSTOMER_NAME FIRST_NAME, DECODE(PM.STATUS , 'P','Active' , 'D','Cancelled')STATUS , (SELECT DISTINCT(INITCAP(CM.COUNTRY_NAME)||' '||DECODE(MD.TRANSIT_FROM,null,'',','||MD.TRANSIT_FROM)) FROM MARINE_DATA MD, COUNTRY_MASTER CM WHERE MD.TRANSIT_FROM_COUNTRY_ID = CM.COUNTRY_ID AND MD.APPLICATION_NO = PM.APPLICATION_NO AND CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID=CM.COUNTRY_ID) AND ROWNUM=1 ) VOYAGE_ORGIN_COUNTRY, (SELECT DISTINCT(INITCAP(CM.COUNTRY_NAME)||' '||DECODE(MD.FINAL_DESTINATION,null,'',','||MD.FINAL_DESTINATION)) FROM MARINE_DATA MD, COUNTRY_MASTER CM WHERE MD.FINAL_DESTINATION_COUNTRY_ID = CM.COUNTRY_ID AND CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID=CM.COUNTRY_ID) AND MD.APPLICATION_NO = PM.APPLICATION_NO AND ROWNUM=1) TO_DEST_COUNTRY ,TO_CHAR(PM.INCEPTION_DATE ,'dd/MM/YYYY') INCEPTION_DATE,TO_CHAR(PM.EXPIRY_DATE ,'dd/MM/YYYY') EXPIRY_DATE , MRD.DESCRIPTION,MRD.INVOICE_NUMBER FROM POSITION_MASTER PM ,WEBSERVICE_MARINE_QUOTE WMQ, marine_result_details MRD WHERE PM.QUOTE_NO = WMQ.QUOTE_NO AND MRD.APPLICATION_NO=PM.APPLICATION_NO AND PM.VERIFICATION_CODE = ? AND PM.POLICY_NO = ?
GET_MARINE_PREMIA_VERIFY=SELECT D.PROD_DESC "POLICY_TYPE",POL_ASSR_NAME "FIRST_NAME",POL_NO "POLICY_NO",TO_CHAR(POL_FM_DT,'DD/MM/YYYY') "INCEPTION_DATE",TO_CHAR(NVL(POL_END_EFF_TO_DT, POL_TO_DT),'DD/MM/YYYY') "EXPIRY_DATE",  C.PRS_DECL_SI_FC "DESCRIPTION",B.PRAI_DATA_01 "VOYAGE_ORGIN_COUNTRY",B.PRAI_DATA_02 "TO_DEST_COUNTRY",A.POL_FLEX_03 "INVOICE_NUMBER",CASE WHEN NVL(POL_END_EFF_TO_DT, POL_TO_DT) > SYSDATE AND POL_END_TYPE<>'004' THEN 'ACTIVE' ELSE 'NOT ACTIVE' END STATUS FROM   AWNICLIVE.PGIT_POLICY A, AWNICLIVE.PGIT_POL_RISK_ADDL_INFO B, AWNICLIVE.PGIT_POL_RISK_SMI C,  AWNICLIVE.PGIM_PRODUCT D WHERE  POL_NO = ? AND A.POL_SYS_ID = B.PRAI_POL_SYS_ID  AND A.POL_END_NO_IDX = B.PRAI_END_NO_IDX  AND C.PRS_POL_SYS_ID = B.PRAI_POL_SYS_ID AND C.PRS_END_NO_IDX = B.PRAI_END_NO_IDX AND C.PRS_LVL1_SYS_ID = B.PRAI_LVL1_SYS_ID AND A.POL_PROD_CODE=D.PROD_CODE AND B.PRAI_RISK_LVL_NO = 1 AND B.PRAI_RISK_SR_NO = 1
GET_YACHT_PREMIA_VERIFY=SELECT D.PROD_DESC "POLICY_TYPE",POL_ASSR_NAME "FIRST_NAME",POL_NO "POLICY_NO",TO_CHAR(POL_FM_DT,'DD/MM/YYYY') "INCEPTION_DATE",TO_CHAR(NVL(POL_END_EFF_TO_DT, POL_TO_DT),'DD/MM/YYYY') "EXPIRY_DATE",B.PRAI_DATA_17 "VESI_NAME",C.PRAI_DATA_10 "ENGI_SERIAL_NO",B.PRAI_DATA_10 "VESI_COAST_GAURD", B.PRAI_DATA_12 "VESI_REG_NO", CASE WHEN NVL(POL_END_EFF_TO_DT, POL_TO_DT) > SYSDATE AND POL_END_TYPE<>'004' THEN 'ACTIVE' ELSE 'NOT ACTIVE' END STATUS FROM   AWNICLIVE.PGIT_POLICY A, AWNICLIVE.PGIT_POL_RISK_ADDL_INFO B,AWNICLIVE.PGIT_POL_RISK_ADDL_INFO C,AWNICLIVE.PGIM_PRODUCT D WHERE  POL_NO = ? AND A.POL_SYS_ID = B.PRAI_POL_SYS_ID AND A.POL_END_NO_IDX = B.PRAI_END_NO_IDX AND C.PRAI_LVL1_SYS_ID=B.PRAI_SYS_ID AND c.PRAI_RISK_LVL_NO = 2 AND c.PRAI_RISK_SR_NO = 1 AND A.POL_PROD_CODE=D.PROD_CODE AND B.PRAI_RISK_LVL_NO = 1 AND B.PRAI_RISK_SR_NO = 1
GET_JETSKI_PREMIA_VERIFY=SELECT D.PROD_DESC "POLICY_TYPE",POL_ASSR_NAME "FIRST_NAME",POL_NO "POLICY_NO",TO_CHAR(POL_FM_DT,'DD/MM/YYYY') "INCEPTION_DATE",TO_CHAR(NVL(POL_END_EFF_TO_DT, POL_TO_DT),'DD/MM/YYYY') "EXPIRY_DATE", B.PRAI_DATA_17 "VESI_NAME", C.PRAI_DATA_10 "ENGI_SERIAL_NO", B.PRAI_DATA_10 "VESI_COAST_GAURD", B.PRAI_DATA_12 "VESI_REG_NO",B.PRAI_DATA_01 "ENGI_CHASSIS_NO", CASE WHEN NVL(POL_END_EFF_TO_DT, POL_TO_DT) > SYSDATE AND POL_END_TYPE<>'004' THEN 'ACTIVE' ELSE 'NOT ACTIVE' END STATUS FROM   AWNICLIVE.PGIT_POLICY A, AWNICLIVE.PGIT_POL_RISK_ADDL_INFO B,AWNICLIVE.PGIT_POL_RISK_ADDL_INFO C,AWNICLIVE.PGIM_PRODUCT D WHERE  POL_NO = ? AND A.POL_SYS_ID = B.PRAI_POL_SYS_ID AND A.POL_END_NO_IDX = B.PRAI_END_NO_IDX AND C.PRAI_LVL1_SYS_ID=B.PRAI_SYS_ID  AND c.PRAI_RISK_LVL_NO = 2 AND c.PRAI_RISK_SR_NO = 1  AND A.POL_PROD_CODE=D.PROD_CODE  AND B.PRAI_RISK_LVL_NO = 1 AND B.PRAI_RISK_SR_NO = 1

DC_MARINE_ISSUER_QUOTE = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2)PREMIUM FROM LOGIN_MASTER LM, POSITION_MASTER PM,BROKER_COMPANY_MASTER BM,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE  AND PM.QUOTE_NO IS NOT NULL AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = ? AND  LM.BRANCH_CODE=? AND PM.AMEND_ID = 0 AND TO_CHAR(PM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') GROUP BY BM.COMPANY_NAME ORDER BY BM.COMPANY_NAME ASC
DC_MARINE_ISSUER_POLICY = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2)PREMIUM FROM LOGIN_MASTER LM, POSITION_MASTER PM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND PM.INTEGRATION_STATUS = 'S' AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = ? AND  LM.BRANCH_CODE=? AND PM.AMEND_ID = 0 AND TO_CHAR(PM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') GROUP BY BM.COMPANY_NAME ORDER BY BM.COMPANY_NAME ASC
DC_MARINE_ISSUER_QUOTE_PROD = SELECT   DECODE(HPM.PRODUCT_ID,'3','MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')NAME, HPM.PRODUCT_ID, COUNT ( * ) COUNT,ROUND (SUM (HPM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2) PREMIUM  FROM   POSITION_MASTER HPM ,LOGIN_MASTER LM,MARINE_DATA MD WHERE HPM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = HPM.LOGIN_ID AND HPM.QUOTE_NO IS NOT NULL AND TO_CHAR (HPM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY') AND HPM.PRODUCT_ID = ? AND HPM.APPLICATION_ID = ? AND  LM.BRANCH_CODE=? GROUP BY   HPM.PRODUCT_ID ORDER BY   NAME ASC
DC_MARINE_ISSUER_POLICY_PROD = SELECT   DECODE(HPM.PRODUCT_ID,'3','MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')NAME, HPM.PRODUCT_ID, COUNT ( * ) COUNT,ROUND (SUM (HPM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2) PREMIUM  FROM   POSITION_MASTER HPM,LOGIN_MASTER LM,MARINE_DATA MD WHERE HPM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = HPM.LOGIN_ID AND HPM.STATUS = 'P' AND HPM.INTEGRATION_STATUS = 'S' AND POLICY_NO IS NOT NULL AND TO_CHAR (HPM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY') AND HPM.PRODUCT_ID = ? AND HPM.APPLICATION_ID = ? AND  LM.BRANCH_CODE=? GROUP BY   HPM.PRODUCT_ID ORDER BY   NAME ASC
DC_MARINE_ISSUER_REFERRAL_PEND = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2)PREMIUM FROM LOGIN_MASTER LM, POSITION_MASTER PM,BROKER_COMPANY_MASTER BM,MARINE_DATA MD WHERE LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'Y' AND PM.QUOTE_NO IS NOT NULL AND PM.APPLICATION_NO=MD.APPLICATION_NO AND ((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y')) AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = ? AND  LM.BRANCH_CODE=? AND PM.AMEND_ID = 0 AND TO_CHAR(PM.REFERRAL_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') GROUP BY BM.COMPANY_NAME ORDER BY BM.COMPANY_NAME ASC
DC_MARINE_ISSUER_REFERRAL_COMP = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2)PREMIUM FROM LOGIN_MASTER LM, POSITION_MASTER PM,BROKER_COMPANY_MASTER BM,MARINE_DATA MD WHERE LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'Y' AND PM.QUOTE_NO IS NOT NULL AND PM.APPLICATION_NO=MD.APPLICATION_NO AND UPPER (PM.REMARKS) = 'ADMIN' AND MD.ADMIN_REFERRAL_STATUS  = 'N' AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = ? AND  LM.BRANCH_CODE=? AND PM.AMEND_ID = 0 AND TO_CHAR(PM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') GROUP BY BM.COMPANY_NAME ORDER BY BM.COMPANY_NAME ASC  
DC_MARINE_ISSUER_REFERRAL_REJECT = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2)PREMIUM FROM LOGIN_MASTER LM, POSITION_MASTER PM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'R' AND PM.QUOTE_NO IS NOT NULL AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = ? AND  LM.BRANCH_CODE=? AND PM.AMEND_ID = 0 AND TO_CHAR(PM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') GROUP BY BM.COMPANY_NAME ORDER BY BM.COMPANY_NAME ASC   

DC_MARINE_BROKER_QUOTE_PROD=SELECT DECODE(HPM.PRODUCT_ID,'3','MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')NAME, HPM.PRODUCT_ID, COUNT(*) COUNT, ROUND(SUM(HPM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER HPM, LOGIN_MASTER LM  ,MARINE_DATA MD WHERE HPM.APPLICATION_NO=MD.APPLICATION_NO AND  LM.LOGIN_ID = HPM.LOGIN_ID  AND HPM.QUOTE_NO IS NOT NULL AND TO_CHAR(HPM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND HPM.PRODUCT_ID = ? AND HPM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY HPM.PRODUCT_ID ORDER BY NAME ASC
DC_MARINE_BROKER_POLICY_PROD=SELECT DECODE(HPM.PRODUCT_ID,'3','MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')NAME, HPM.PRODUCT_ID, COUNT(*) COUNT, ROUND(SUM(HPM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER HPM, LOGIN_MASTER LM ,MARINE_DATA MD WHERE HPM.APPLICATION_NO=MD.APPLICATION_NO AND  LM.LOGIN_ID = HPM.LOGIN_ID AND HPM.STATUS = 'P' AND HPM.INTEGRATION_STATUS = 'S' AND POLICY_NO IS NOT NULL AND TO_CHAR(HPM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND HPM.PRODUCT_ID = ? AND HPM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY HPM.PRODUCT_ID ORDER BY NAME ASC
DC_MARINE_BROKER_QUOTE =SELECT CASE WHEN LM.AGENCY_CODE=LM.OA_CODE THEN INITCAP (BM.COMPANY_NAME) ELSE  INITCAP (BM.COMPANY_NAME||' - '||LM.USERNAME) END NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE  AND PM.QUOTE_NO IS NOT NULL AND TO_CHAR(PM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY LM.LOGIN_ID,LM.AGENCY_CODE,LM.OA_CODE,LM.USERNAME, BM.COMPANY_NAME ORDER BY NAME ASC
DC_MARINE_BROKER_POLICY =SELECT CASE WHEN LM.AGENCY_CODE=LM.OA_CODE THEN INITCAP (BM.COMPANY_NAME) ELSE  INITCAP (BM.COMPANY_NAME||' - '||LM.USERNAME) END NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE  AND PM.STATUS = 'P' AND PM.INTEGRATION_STATUS = 'S' AND POLICY_NO IS NOT NULL AND TO_CHAR(PM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY LM.LOGIN_ID,LM.AGENCY_CODE,LM.OA_CODE,LM.USERNAME, BM.COMPANY_NAME ORDER BY NAME ASC
DC_MARINE_BROKER_REFERRAL_PEND =SELECT CASE WHEN LM.AGENCY_CODE=LM.OA_CODE THEN INITCAP (BM.COMPANY_NAME) ELSE  INITCAP (BM.COMPANY_NAME||' - '||LM.USERNAME) END NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE  AND PM.STATUS = 'Y' AND ((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y')) AND QUOTE_NO IS NOT NULL AND PM.APPLICATION_NO=MD.APPLICATION_NO AND TO_CHAR(PM.REFERRAL_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY LM.LOGIN_ID,LM.AGENCY_CODE,LM.OA_CODE,LM.USERNAME, BM.COMPANY_NAME ORDER BY NAME ASC
DC_MARINE_BROKER_REFERRAL_COMP =SELECT CASE WHEN LM.AGENCY_CODE=LM.OA_CODE THEN INITCAP (BM.COMPANY_NAME) ELSE  INITCAP (BM.COMPANY_NAME||' - '||LM.USERNAME) END NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'Y' AND UPPER (PM.REMARKS) = 'ADMIN' AND MD.ADMIN_REFERRAL_STATUS  = 'N' AND QUOTE_NO IS NOT NULL AND PM.APPLICATION_NO=MD.APPLICATION_NO AND TO_CHAR(PM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY LM.LOGIN_ID,LM.AGENCY_CODE,LM.OA_CODE,LM.USERNAME, BM.COMPANY_NAME ORDER BY NAME ASC
DC_MARINE_BROKER_REFERRAL_REJECT =SELECT CASE WHEN LM.AGENCY_CODE=LM.OA_CODE THEN INITCAP (BM.COMPANY_NAME) ELSE  INITCAP (BM.COMPANY_NAME||' - '||LM.USERNAME) END NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND BM.AGENCY_CODE=LM.OA_CODE AND LM.LOGIN_ID = PM.LOGIN_ID AND PM.STATUS = 'R' AND QUOTE_NO IS NOT NULL AND TO_CHAR(PM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY LM.LOGIN_ID,LM.AGENCY_CODE,LM.OA_CODE,LM.USERNAME, BM.COMPANY_NAME ORDER BY NAME ASC

#DC_MARINE_BROKER_QUOTE = SELECT INITCAP(LM.USERNAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID  AND PM.QUOTE_NO IS NOT NULL AND TO_CHAR(PM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY PM.LOGIN_ID,LM.USERNAME ORDER BY NAME ASC
#DC_MARINE_BROKER_POLICY = SELECT INITCAP(LM.USERNAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND PM.STATUS = 'P' AND PM.INTEGRATION_STATUS = 'S' AND POLICY_NO IS NOT NULL AND TO_CHAR(PM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY PM.LOGIN_ID,LM.USERNAME ORDER BY NAME ASC
#DC_MARINE_BROKER_REFERRAL_PEND = SELECT INITCAP(LM.USERNAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,MARINE_DATA MD WHERE LM.LOGIN_ID = PM.LOGIN_ID AND PM.STATUS = 'Y' AND ((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y')) AND QUOTE_NO IS NOT NULL AND PM.APPLICATION_NO=MD.APPLICATION_NO AND TO_CHAR(PM.REFERRAL_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY PM.LOGIN_ID,LM.USERNAME ORDER BY NAME ASC
#DC_MARINE_BROKER_REFERRAL_COMP = SELECT INITCAP(LM.USERNAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,MARINE_DATA MD WHERE LM.LOGIN_ID = PM.LOGIN_ID AND PM.STATUS = 'Y' AND UPPER (PM.REMARKS) = 'ADMIN' AND MD.ADMIN_REFERRAL_STATUS  = 'N' AND QUOTE_NO IS NOT NULL AND PM.APPLICATION_NO=MD.APPLICATION_NO AND TO_CHAR(PM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY PM.LOGIN_ID,LM.USERNAME ORDER BY NAME ASC
#DC_MARINE_BROKER_REFERRAL_REJECT = SELECT INITCAP(LM.USERNAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND PM.STATUS = 'R' AND QUOTE_NO IS NOT NULL AND TO_CHAR(PM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID = ?) AND  LM.BRANCH_CODE=? GROUP BY PM.LOGIN_ID,LM.USERNAME ORDER BY NAME ASC

DC_MARINE_USER_QUOTE_PROD=SELECT DECODE(HPM.PRODUCT_ID,'3','MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')NAME, HPM.PRODUCT_ID, COUNT(*) COUNT, ROUND(SUM(HPM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER HPM, LOGIN_MASTER LM  ,MARINE_DATA MD WHERE HPM.APPLICATION_NO=MD.APPLICATION_NO AND  LM.LOGIN_ID = HPM.LOGIN_ID  AND HPM.QUOTE_NO IS NOT NULL AND TO_CHAR(HPM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND HPM.PRODUCT_ID = ? AND HPM.APPLICATION_ID = '1' AND LM.LOGIN_ID=? AND  LM.BRANCH_CODE=? GROUP BY HPM.PRODUCT_ID ORDER BY NAME ASC
DC_MARINE_USER_POLICY_PROD=SELECT DECODE(HPM.PRODUCT_ID,'3','MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')NAME, HPM.PRODUCT_ID, COUNT(*) COUNT, ROUND(SUM(HPM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER HPM, LOGIN_MASTER LM ,MARINE_DATA MD WHERE HPM.APPLICATION_NO=MD.APPLICATION_NO AND  LM.LOGIN_ID = HPM.LOGIN_ID AND HPM.STATUS = 'P' AND HPM.INTEGRATION_STATUS = 'S' AND POLICY_NO IS NOT NULL AND TO_CHAR(HPM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND HPM.PRODUCT_ID = ? AND HPM.APPLICATION_ID = '1' AND LM.LOGIN_ID=? AND  LM.BRANCH_CODE=? GROUP BY HPM.PRODUCT_ID ORDER BY NAME ASC
DC_MARINE_USER_QUOTE = SELECT INITCAP(LM.USERNAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID  AND PM.QUOTE_NO IS NOT NULL AND TO_CHAR(PM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.LOGIN_ID=? AND  LM.BRANCH_CODE=? GROUP BY PM.LOGIN_ID,LM.USERNAME ORDER BY NAME ASC
DC_MARINE_USER_POLICY = SELECT INITCAP(LM.USERNAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND PM.STATUS = 'P' AND PM.INTEGRATION_STATUS = 'S' AND POLICY_NO IS NOT NULL AND TO_CHAR(PM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.LOGIN_ID=? AND  LM.BRANCH_CODE=? GROUP BY PM.LOGIN_ID,LM.USERNAME ORDER BY NAME ASC
DC_MARINE_USER_REFERRAL_PEND =SELECT CASE WHEN LM.AGENCY_CODE=LM.OA_CODE THEN INITCAP (BM.COMPANY_NAME) ELSE  INITCAP (BM.COMPANY_NAME||' - '||LM.USERNAME) END NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'Y' AND ((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y')) AND QUOTE_NO IS NOT NULL AND PM.APPLICATION_NO=MD.APPLICATION_NO AND TO_CHAR(PM.REFERRAL_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.LOGIN_ID=? AND  LM.BRANCH_CODE=? GROUP BY LM.LOGIN_ID,LM.AGENCY_CODE,LM.OA_CODE,LM.USERNAME, BM.COMPANY_NAME ORDER BY NAME ASC
DC_MARINE_USER_REFERRAL_COMP = SELECT CASE WHEN LM.AGENCY_CODE=LM.OA_CODE THEN INITCAP (BM.COMPANY_NAME) ELSE  INITCAP (BM.COMPANY_NAME||' - '||LM.USERNAME) END NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'Y' AND UPPER (PM.REMARKS) = 'ADMIN' AND MD.ADMIN_REFERRAL_STATUS  = 'N' AND QUOTE_NO IS NOT NULL AND PM.APPLICATION_NO=MD.APPLICATION_NO AND TO_CHAR(PM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.LOGIN_ID=? AND  LM.BRANCH_CODE=? GROUP BY LM.LOGIN_ID,LM.AGENCY_CODE,LM.OA_CODE,LM.USERNAME, BM.COMPANY_NAME ORDER BY NAME ASC
DC_MARINE_USER_REFERRAL_REJECT = SELECT CASE WHEN LM.AGENCY_CODE=LM.OA_CODE THEN INITCAP (BM.COMPANY_NAME) ELSE  INITCAP (BM.COMPANY_NAME||' - '||LM.USERNAME) END NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND BM.AGENCY_CODE=LM.OA_CODE AND LM.LOGIN_ID = PM.LOGIN_ID AND PM.STATUS = 'R' AND QUOTE_NO IS NOT NULL AND TO_CHAR(PM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.LOGIN_ID=? AND  LM.BRANCH_CODE=? GROUP BY LM.LOGIN_ID,LM.AGENCY_CODE,LM.OA_CODE,LM.USERNAME, BM.COMPANY_NAME ORDER BY NAME ASC

DC_ADMIN_MARINE_QUOTE = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM ,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE  AND PM.QUOTE_NO IS NOT NULL AND TO_CHAR(PM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND  LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY BM.COMPANY_NAME ORDER BY NAME ASC
DC_ADMIN_MARINE_POLICY = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM ,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'P' AND PM.INTEGRATION_STATUS = 'S' AND POLICY_NO IS NOT NULL AND TO_CHAR(PM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY')  AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY BM.COMPANY_NAME ORDER BY NAME ASC
DC_ADMIN_MARINE_QUOTE_PROD=SELECT DECODE(HPM.PRODUCT_ID,'3','MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')NAME, HPM.PRODUCT_ID, COUNT(*) COUNT, ROUND(SUM(HPM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER HPM, LOGIN_MASTER LM  ,MARINE_DATA MD WHERE HPM.APPLICATION_NO=MD.APPLICATION_NO AND  LM.LOGIN_ID = HPM.LOGIN_ID  AND HPM.QUOTE_NO IS NOT NULL AND TO_CHAR(HPM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY')  AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY HPM.PRODUCT_ID ORDER BY NAME ASC
DC_ADMIN_MARINE_POLICY_PROD=SELECT DECODE(HPM.PRODUCT_ID,'3','MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')NAME, HPM.PRODUCT_ID, COUNT(*) COUNT, ROUND(SUM(HPM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER HPM, LOGIN_MASTER LM  ,MARINE_DATA MD WHERE HPM.APPLICATION_NO=MD.APPLICATION_NO AND  LM.LOGIN_ID = HPM.LOGIN_ID AND HPM.STATUS = 'P' AND HPM.INTEGRATION_STATUS = 'S' AND POLICY_NO IS NOT NULL AND TO_CHAR(HPM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY')  AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY HPM.PRODUCT_ID ORDER BY NAME ASC
DC_ADMIN_MARINE_REFERRAL_PEND = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM,MARINE_DATA MD WHERE LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'Y' AND ((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y')) AND QUOTE_NO IS NOT NULL AND PM.APPLICATION_NO=MD.APPLICATION_NO AND TO_CHAR(PM.REFERRAL_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY')   AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY BM.COMPANY_NAME ORDER BY NAME ASC
DC_ADMIN_MARINE_REFERRAL_COMP = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM,MARINE_DATA MD WHERE LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'Y' AND UPPER (PM.REMARKS) = 'ADMIN' AND MD.ADMIN_REFERRAL_STATUS  = 'N' AND QUOTE_NO IS NOT NULL AND PM.APPLICATION_NO=MD.APPLICATION_NO AND TO_CHAR(PM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY')  AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY BM.COMPANY_NAME ORDER BY NAME ASC
DC_ADMIN_MARINE_REFERAL_REJECT = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'R' AND QUOTE_NO IS NOT NULL AND TO_CHAR(PM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY')   AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY  BM.COMPANY_NAME ORDER BY NAME ASC
DC_ADMIN_MARINE_REFERRAL_REJECT = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)),2) PREMIUM FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'R' AND QUOTE_NO IS NOT NULL AND TO_CHAR(PM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY')   AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY  BM.COMPANY_NAME ORDER BY NAME ASC

GET_MARINE_REF_ISSUER_LIST=SELECT NAME, REFERRAL_STATUS, TIME_DIFF, QUOTE_REF_NO,CUST_NAME ,PRODUCT,REFERRAL_UPDATE,LOGIN_ID FROM (SELECT INITCAP (PI.FIRST_NAME || ''|| PI.LAST_NAME) CUST_NAME,  INITCAP (BM.COMPANY_NAME) NAME,CASE WHEN ((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y')) THEN 'Pending' WHEN UPPER (PM.REMARKS)= 'ADMIN' AND MD.ADMIN_REFERRAL_STATUS  = 'N' THEN 'Approved' WHEN PM.STATUS = 'R' THEN 'Rejected' END  REFERRAL_STATUS,DECODE(ABS(EXTRACT(Day FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)),0,'' , ABS(EXTRACT(Day FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE))|| ' days ')||''||ABS(EXTRACT(HOUR FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)) || ' hr ' || ABS(EXTRACT(MINUTE FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)) ||  ' m' AS TIME_DIFF,PM.QUOTE_NO QUOTE_REF_NO,DECODE(PM.PRODUCT_ID,'3', 'MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')PRODUCT,TO_CHAR(PM.REFERRAL_UPDATE,'DD/MM/YYYY HH24:MI:SS')REFERRAL_UPDATE,DECODE(PM.APPLICATION_ID,'1',PM.LOGIN_ID,PM.LOGIN_ID)LOGIN_ID,ROW_NUMBER() OVER(PARTITION BY REFERRAL_UPDATE ORDER BY REFERRAL_UPDATE  DESC) RN FROM   LOGIN_MASTER LM, POSITION_MASTER PM ,BROKER_COMPANY_MASTER BM,PERSONAL_INFO PI,MARINE_DATA MD WHERE   LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.CUSTOMER_ID=PI.CUSTOMER_ID  AND MD.APPLICATION_NO  = PM.APPLICATION_NO  AND  PM.QUOTE_NO IS NOT NULL AND (((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y')) OR UPPER (PM.REMARKS)= 'ADMIN' OR PM.STATUS = 'R') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = ? AND PM.AMEND_ID = 0 AND  LM.BRANCH_CODE=? AND TO_CHAR (PM.REFERRAL_UPDATE, 'MM/YYYY') = TO_CHAR (SYSDATE, 'MM/YYYY') ORDER BY   REFERRAL_UPDATE  DESC ) WHERE RN<=10
GET_MARINE_REF_BROKER_LIST=SELECT NAME, REFERRAL_STATUS, TIME_DIFF, QUOTE_REF_NO,CUST_NAME ,PRODUCT,REFERRAL_UPDATE,LOGIN_ID FROM (SELECT INITCAP (PI.FIRST_NAME || ''|| PI.LAST_NAME) CUST_NAME,   INITCAP (LM.USERNAME) NAME, CASE  WHEN ((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y')) THEN 'Pending' WHEN UPPER (PM.REMARKS) = 'ADMIN' AND MD.ADMIN_REFERRAL_STATUS  = 'N' THEN 'Approved' WHEN PM.STATUS = 'R' THEN 'Rejected' END REFERRAL_STATUS,DECODE(ABS(EXTRACT(Day FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)),0,'' , ABS(EXTRACT(Day FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE))|| ' days ')||''||ABS(EXTRACT(HOUR FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)) || ' hr ' || ABS(EXTRACT(MINUTE FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)) ||  ' m' AS TIME_DIFF,PM.QUOTE_NO QUOTE_REF_NO,DECODE(PM.PRODUCT_ID,'3', 'MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')PRODUCT,TO_CHAR(PM.REFERRAL_UPDATE,'DD/MM/YYYY HH24:MI:SS')REFERRAL_UPDATE,DECODE(PM.APPLICATION_ID,'1',PM.LOGIN_ID,PM.LOGIN_ID)LOGIN_ID,ROW_NUMBER() OVER(PARTITION BY REFERRAL_UPDATE ORDER BY REFERRAL_UPDATE  DESC) RN  FROM   POSITION_MASTER PM, LOGIN_MASTER LM,PERSONAL_INFO PI,MARINE_DATA MD   WHERE   LM.LOGIN_ID = PM.LOGIN_ID AND PM.CUSTOMER_ID=PI.CUSTOMER_ID AND  MD.APPLICATION_NO  = PM.APPLICATION_NO AND  (((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y'))  OR UPPER (PM.REMARKS) = 'ADMIN' OR PM.STATUS = 'R') AND QUOTE_NO IS NOT NULL AND TO_CHAR (PM.REFERRAL_UPDATE, 'MM/YYYY') = TO_CHAR (SYSDATE, 'MM/YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT   OA_CODE FROM   LOGIN_MASTER LM1 WHERE   LM1.LOGIN_ID =?) AND  LM.BRANCH_CODE=? ORDER BY   REFERRAL_UPDATE  DESC ) WHERE RN<=10
GET_MARINE_REF_USER_LIST=SELECT NAME, REFERRAL_STATUS, TIME_DIFF, QUOTE_REF_NO,CUST_NAME ,PRODUCT,REFERRAL_UPDATE,LOGIN_ID FROM (SELECT INITCAP (PI.FIRST_NAME || ''|| PI.LAST_NAME) CUST_NAME,  INITCAP (LM.USERNAME) NAME, CASE  WHEN ((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y')) THEN 'Pending' WHEN UPPER (PM.REMARKS) = 'ADMIN' AND MD.ADMIN_REFERRAL_STATUS  = 'N' THEN 'Approved' WHEN PM.STATUS = 'R' THEN 'Rejected' END REFERRAL_STATUS,DECODE(ABS(EXTRACT(Day FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)),0,'' , ABS(EXTRACT(Day FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE))|| ' days ')||''||ABS(EXTRACT(HOUR FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)) || ' hr ' || ABS(EXTRACT(MINUTE FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)) ||  ' m' AS TIME_DIFF,PM.QUOTE_NO QUOTE_REF_NO,DECODE(PM.PRODUCT_ID,'3', 'MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')PRODUCT,TO_CHAR(PM.REFERRAL_UPDATE,'DD/MM/YYYY HH24:MI:SS')REFERRAL_UPDATE,DECODE(PM.APPLICATION_ID,'1',PM.LOGIN_ID,PM.LOGIN_ID)LOGIN_ID,ROW_NUMBER() OVER(PARTITION BY REFERRAL_UPDATE ORDER BY REFERRAL_UPDATE  DESC) RN  FROM   POSITION_MASTER PM, LOGIN_MASTER LM ,PERSONAL_INFO PI,MARINE_DATA MD  WHERE   LM.LOGIN_ID = PM.LOGIN_ID AND  PM.CUSTOMER_ID=PI.CUSTOMER_ID AND  MD.APPLICATION_NO  = PM.APPLICATION_NO AND  (((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y'))  OR UPPER (PM.REMARKS) = 'ADMIN' OR PM.STATUS = 'R') AND QUOTE_NO IS NOT NULL AND TO_CHAR (PM.REFERRAL_UPDATE, 'MM/YYYY') =TO_CHAR (SYSDATE, 'MM/YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.LOGIN_ID=? AND  LM.BRANCH_CODE=? ORDER BY   REFERRAL_UPDATE  DESC ) WHERE RN<=10
GET_MARINE_REF_ADMIN_LIST=SELECT NAME, REFERRAL_STATUS, TIME_DIFF, QUOTE_REF_NO,CUST_NAME ,PRODUCT,REFERRAL_UPDATE,LOGIN_ID FROM (SELECT INITCAP (PI.FIRST_NAME || ''|| PI.LAST_NAME) CUST_NAME,  INITCAP (BM.COMPANY_NAME) NAME,CASE  WHEN ((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y')) THEN 'Pending' WHEN UPPER (PM.REMARKS) = 'ADMIN' AND MD.ADMIN_REFERRAL_STATUS  = 'N' THEN 'Approved' WHEN PM.STATUS = 'R' THEN 'Rejected' END REFERRAL_STATUS,DECODE(ABS(EXTRACT(Day FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)),0,'' , ABS(EXTRACT(Day FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE))|| ' days ')||''||ABS(EXTRACT(HOUR FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)) || ' hr ' || ABS(EXTRACT(MINUTE FROM NVL(PM.REFERRAL_APP_UPDATE,SYSDATE)-PM.REFERRAL_UPDATE)) ||  ' m' AS TIME_DIFF,PM.QUOTE_NO QUOTE_REF_NO,DECODE(PM.PRODUCT_ID,'3', 'MARINE CARGO INDIVIDUAL POLICY','MARINE CARGO - OPEN COVER')PRODUCT,TO_CHAR(PM.REFERRAL_UPDATE,'DD/MM/YYYY HH24:MI:SS')REFERRAL_UPDATE,DECODE(PM.APPLICATION_ID,'1',PM.LOGIN_ID,PM.LOGIN_ID)LOGIN_ID ,ROW_NUMBER() OVER(PARTITION BY REFERRAL_UPDATE ORDER BY REFERRAL_UPDATE  DESC) RN  FROM   POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM,PERSONAL_INFO PI,MARINE_DATA MD   WHERE   LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.CUSTOMER_ID=PI.CUSTOMER_ID  AND MD.APPLICATION_NO  = PM.APPLICATION_NO AND  (((PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  = 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  = 'Y'))  OR UPPER (PM.REMARKS) = 'ADMIN' OR PM.STATUS = 'R') AND QUOTE_NO IS NOT NULL AND TO_CHAR (PM.REFERRAL_UPDATE, 'MM/YYYY') =TO_CHAR (SYSDATE, 'MM/YYYY')   AND LM.OA_CODE IN (SELECT   OA_CODE FROM   LOGIN_MASTER LM1 WHERE   LM1.BRANCH_CODE =?) AND  LM.BRANCH_CODE=? ORDER BY   REFERRAL_UPDATE  DESC ) WHERE RN<=10

GET_MARINE_BRO_ISSUER_LIST=SELECT * FROM(SELECT INITCAP (BM.COMPANY_NAME) NAME, ROUND (SUM (PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2) TOTAL FROM LOGIN_MASTER LM, POSITION_MASTER PM,BROKER_COMPANY_MASTER BM,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = ? AND  LM.BRANCH_CODE=? AND PM.AMEND_ID = 0 AND TO_CHAR (PM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY') GROUP BY BM.COMPANY_NAME ORDER BY TOTAL DESC) WHERE ROWNUM<=10 UNION ALL SELECT * FROM(SELECT 'SUB TOTAL' NAME, ROUND (SUM (PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2) TOTAL FROM LOGIN_MASTER LM, POSITION_MASTER PM,BROKER_COMPANY_MASTER BM,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = ? AND  LM.BRANCH_CODE=? AND PM.AMEND_ID = 0 AND TO_CHAR (PM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY')  ORDER BY TOTAL DESC) WHERE ROWNUM<=10
GET_MARINE_BRO_CUST_LIST=SELECT * FROM(SELECT INITCAP (PI.FIRST_NAME) NAME, ROUND (SUM (PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2) TOTAL FROM POSITION_MASTER PM, LOGIN_MASTER LM,PERSONAL_INFO PI,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND PM.CUSTOMER_ID=PI.CUSTOMER_ID AND PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND TO_CHAR (PM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID =?) AND  LM.BRANCH_CODE=? GROUP BY PM.LOGIN_ID, PI.FIRST_NAME ORDER BY TOTAL DESC)WHERE ROWNUM<=10 UNION ALL SELECT * FROM(SELECT 'SUB TOATL' NAME, SUM(ROUND (SUM (PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2)) TOTAL FROM POSITION_MASTER PM, LOGIN_MASTER LM,PERSONAL_INFO PI,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND PM.CUSTOMER_ID=PI.CUSTOMER_ID AND PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND TO_CHAR (PM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.LOGIN_ID =?) AND  LM.BRANCH_CODE=? GROUP BY PM.LOGIN_ID, PI.FIRST_NAME ORDER BY TOTAL DESC)WHERE ROWNUM<=10
GET_MARINE_BRO_BROKER_LIST=SELECT * FROM(SELECT CASE WHEN LM.AGENCY_CODE=LM.OA_CODE THEN INITCAP (BM.COMPANY_NAME) ELSE  INITCAP (BM.COMPANY_NAME||' - '||LM.USERNAME) END NAME, ROUND (SUM (PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2) TOTAL FROM LOGIN_MASTER LM, POSITION_MASTER PM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT   OA_CODE FROM   LOGIN_MASTER LM1 WHERE   LM1.LOGIN_ID =?) AND  LM.BRANCH_CODE=? AND PM.AMEND_ID = 0 AND TO_CHAR (PM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY') GROUP BY LM.LOGIN_ID,LM.AGENCY_CODE,LM.OA_CODE,LM.USERNAME, BM.COMPANY_NAME ORDER BY TOTAL DESC) WHERE ROWNUM<=10 UNION ALL SELECT * FROM(SELECT 'SUB TOTAL' NAME, SUM(ROUND (SUM (PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2)) TOTAL FROM LOGIN_MASTER LM, POSITION_MASTER PM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.OA_CODE IN (SELECT   OA_CODE FROM   LOGIN_MASTER LM1 WHERE   LM1.LOGIN_ID =?) AND  LM.BRANCH_CODE=? AND PM.AMEND_ID = 0 AND TO_CHAR (PM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY') GROUP BY LM.LOGIN_ID,LM.AGENCY_CODE,LM.OA_CODE,LM.USERNAME, BM.COMPANY_NAME ORDER BY TOTAL DESC) WHERE ROWNUM<=10
GET_MARINE_USER_CUST_LIST=SELECT * FROM(SELECT INITCAP (PI.FIRST_NAME) NAME, ROUND (SUM (PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2) TOTAL FROM POSITION_MASTER PM, LOGIN_MASTER LM,PERSONAL_INFO PI ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND PM.CUSTOMER_ID=PI.CUSTOMER_ID AND PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND TO_CHAR (PM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.LOGIN_ID=? AND  LM.BRANCH_CODE=? GROUP BY PM.LOGIN_ID, PI.FIRST_NAME ORDER BY TOTAL DESC)WHERE ROWNUM<=10 UNION ALL SELECT * FROM(SELECT 'SUB TOTAOL' NAME, SUM(ROUND (SUM (PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2)) TOTAL FROM POSITION_MASTER PM, LOGIN_MASTER LM,PERSONAL_INFO PI ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND PM.CUSTOMER_ID=PI.CUSTOMER_ID AND PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND TO_CHAR (PM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY') AND PM.PRODUCT_ID = ? AND PM.APPLICATION_ID = '1' AND LM.LOGIN_ID=? AND  LM.BRANCH_CODE=? GROUP BY PM.LOGIN_ID, PI.FIRST_NAME ORDER BY TOTAL DESC)WHERE ROWNUM<=10
GET_MARINE_BRO_ADMIN_LIST=SELECT * FROM(SELECT '0' CODE, INITCAP (BM.COMPANY_NAME) NAME, ROUND (SUM (PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2) TOTAL,LM.OA_CODE FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND TO_CHAR (PM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY')   AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE =?) GROUP BY  BM.COMPANY_NAME,LM.OA_CODE ORDER BY TOTAL DESC)WHERE ROWNUM<=10 UNION ALL SELECT * FROM(SELECT '1' CODE, INITCAP (LM.USERNAME) NAME, ROUND (SUM (PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2) TOTAL,LM.OA_CODE  FROM POSITION_MASTER PM, LOGIN_MASTER LM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND  PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND TO_CHAR (PM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY')   AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE =?)  GROUP BY  LM.USERNAME,LM.OA_CODE ORDER BY TOTAL DESC) UNION ALL SELECT * FROM(SELECT '0' CODE, 'SUB TOTAL' NAME, SUM(ROUND (SUM (PM.PREMIUM-NVL(MD.VAT_TAX_AMT,0)), 2)) TOTAL,'0'OA_CODE FROM POSITION_MASTER PM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM ,MARINE_DATA MD WHERE PM.APPLICATION_NO=MD.APPLICATION_NO AND LM.LOGIN_ID = PM.LOGIN_ID AND BM.AGENCY_CODE=LM.OA_CODE AND PM.STATUS = 'P' AND PM.POLICY_NO IS NOT NULL AND TO_CHAR (PM.ENTRY_DATE, 'YYYY') = TO_CHAR (SYSDATE, 'YYYY')   AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE =?) GROUP BY  BM.COMPANY_NAME,LM.OA_CODE ORDER BY TOTAL DESC)WHERE ROWNUM<=10

DC_ADMIN_QUOTE = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(HPM.OVERALL_PREMIUM-NVL(VAT_PREMIUM,0)),2) PREMIUM FROM HOME_POSITION_MASTER HPM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM WHERE HPM.LOGIN_ID =LM.LOGIN_ID AND  BM.AGENCY_CODE=LM.OA_CODE   AND HPM.QUOTE_NO IS NOT NULL AND TO_CHAR(HPM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND HPM.PRODUCT_ID = ?  AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE =? ) GROUP BY BM.COMPANY_NAME ORDER BY NAME ASC
DC_ADMIN_POLICY = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(HPM.OVERALL_PREMIUM-NVL(VAT_PREMIUM,0)),2) PREMIUM FROM HOME_POSITION_MASTER HPM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM WHERE HPM.LOGIN_ID =LM.LOGIN_ID AND  BM.AGENCY_CODE=LM.OA_CODE AND HPM.STATUS = 'P' AND HPM.INTEGRATION_STATUS = 'S' AND POLICY_NO IS NOT NULL AND TO_CHAR(HPM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND HPM.PRODUCT_ID = ? AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY BM.COMPANY_NAME ORDER BY NAME ASC
DC_ADMIN_QUOTE_PROD = SELECT DECODE(YR.RSI_POLICY_TYPE, '1','Comprehensive', '2', 'Tpl') NAME, YR.RSI_POLICY_TYPE, COUNT(*) COUNT, ROUND(SUM(HPM.OVERALL_PREMIUM-NVL(VAT_PREMIUM,0)),2) PREMIUM FROM HOME_POSITION_MASTER HPM, LOGIN_MASTER LM, YACT_RISK_INFO YR WHERE HPM.QUOTE_NO = YR.QUOTE_NO AND LM.LOGIN_ID = HPM.LOGIN_ID AND HPM.QUOTE_NO IS NOT NULL AND TO_CHAR(HPM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND HPM.PRODUCT_ID = ?  AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY YR.RSI_POLICY_TYPE ORDER BY NAME ASC
DC_ADMIN_POLICY_PROD = SELECT DECODE(YR.RSI_POLICY_TYPE, '1','Comprehensive', '2', 'Tpl') NAME, YR.RSI_POLICY_TYPE, COUNT(*) COUNT, ROUND(SUM(HPM.OVERALL_PREMIUM-NVL(VAT_PREMIUM,0)),2) PREMIUM FROM HOME_POSITION_MASTER HPM, LOGIN_MASTER LM, YACT_RISK_INFO YR WHERE HPM.QUOTE_NO = YR.QUOTE_NO AND LM.LOGIN_ID = HPM.LOGIN_ID AND HPM.STATUS = 'P' AND HPM.INTEGRATION_STATUS = 'S' AND POLICY_NO IS NOT NULL AND TO_CHAR(HPM.ENTRY_DATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND HPM.PRODUCT_ID = ?  AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY YR.RSI_POLICY_TYPE ORDER BY NAME ASC
DC_ADMIN_REFERRAL_PEND = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(HPM.OVERALL_PREMIUM-NVL(VAT_PREMIUM,0)),2) PREMIUM FROM HOME_POSITION_MASTER HPM, LOGIN_MASTER LM,BROKER_COMPANY_MASTER BM WHERE HPM.LOGIN_ID =LM.LOGIN_ID AND  BM.AGENCY_CODE=LM.OA_CODE AND HPM.STATUS = 'Y' AND UPPER(HPM.REMARKS) = 'REFERAL' AND QUOTE_NO IS NOT NULL AND TO_CHAR(HPM.REFERRAL_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND HPM.PRODUCT_ID = ?  AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY BM.COMPANY_NAME ORDER BY NAME ASC
DC_ADMIN_REFERRAL_COMP = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(HPM.OVERALL_PREMIUM-NVL(VAT_PREMIUM,0)),2) PREMIUM FROM HOME_POSITION_MASTER HPM, LOGIN_MASTER LM ,BROKER_COMPANY_MASTER BM WHERE HPM.LOGIN_ID =LM.LOGIN_ID AND  BM.AGENCY_CODE=LM.OA_CODE AND HPM.STATUS = 'Y' AND UPPER(HPM.REMARKS) = 'ADMIN' AND QUOTE_NO IS NOT NULL AND TO_CHAR(HPM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND HPM.PRODUCT_ID = ? AND  LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY BM.COMPANY_NAME ORDER BY NAME ASC
DC_ADMIN_REFERRAL_REJECT = SELECT INITCAP(BM.COMPANY_NAME) NAME, COUNT(*) COUNT, ROUND(SUM(HPM.OVERALL_PREMIUM-NVL(VAT_PREMIUM,0)),2) PREMIUM FROM HOME_POSITION_MASTER HPM, LOGIN_MASTER LM ,BROKER_COMPANY_MASTER BM WHERE HPM.LOGIN_ID =LM.LOGIN_ID AND  BM.AGENCY_CODE=LM.OA_CODE AND HPM.STATUS = 'R' AND QUOTE_NO IS NOT NULL AND TO_CHAR(HPM.REFERRAL_APP_UPDATE,'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND HPM.PRODUCT_ID = ?  AND LM.OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LM1.BRANCH_CODE = ?) GROUP BY BM.COMPANY_NAME ORDER BY NAME ASC
#

getbaseOpenCoverNo=select case when NVL(ENDT_TYPE,'') is null then OPEN_COVER_NO else ORIGINAL_POLICY_NO end base_open_cover_no from OPEN_COVER_POSITION_MASTER where proposal_no=?
GET_TRANSACTION_LIST1=select policy_no, tran_id,TO_CHAR(ENTRY_DATE,'DD/MM/YYYY')ENTRY_DATE,upload_file_name,total_no_of_records,Status, floor(premium) as premium  from marine_vehicle_trans_details where BASE_OPENCOVER_NO=? and Status in ('N')
GET_TRANSACTION_LIST2=select policy_no, tran_id,TO_CHAR(ENTRY_DATE,'DD/MM/YYYY')ENTRY_DATE,upload_file_name,total_no_of_records,Status, floor(premium) as premium  from marine_vehicle_trans_details where BASE_OPENCOVER_NO=? and Status in ('Y','D') and policy_no is not null
GET_HAULIER_DETAILS=SELECT PROPOSAL_NO,HAULIER_CATEGORY,FLOOR(END_LIMIT)END_LIMIT, NO_OF_VEHICLES,FLOOR(HAULIER_PREMIUM)HAULIER_PREMIUM,FLOOR(TOTAL_PREMIUM),FLOOR(START_LIMIT)START_LIMIT FROM OPEN_COVER_HAULIER_DETAILS where PROPOSAL_NO=? order by SNO
GET_VEHICLE_TRANS_SEQ=select marine_vehicle_tran_seq.nextval from dual
GET_DB_COLUMS=SELECT DB_COLUMN_NAME,EXCEL_HEADER_NAME,DATA_TYPE FROM TMAS_VALIDATION WHERE ACTIVE='Y'
GET_VAT_TAX_PERCENT=select NVL(VAT_TAX_PERCENT,5) from open_cover_master ocm where ocm.MISSIPPI_OPENCOVER_NO=? and ocm.AMEND_ID=(select max(AMEND_ID) from open_cover_master where MISSIPPI_OPENCOVER_NO=?)
UPDATE_RANGE_VALIDATION=UPDATE MARINE_VEHICLE_DETAILS_RAW SET  ERROR_MSG= NVL(ERROR_MSG,'') || '~Limit ' || TO_CHAR(MARINE_VEHICLE_DETAILS_RAW.LIMIT)|| ' is Not in a Range for Sno '||  TO_CHAR(MARINE_VEHICLE_DETAILS_RAW.SNO) ,ERROR_STATUS='Y' WHERE  SNO NOT IN( SELECT A.SNO FROM (SELECT MVD.SNO FROM MARINE_VEHICLE_DETAILS_RAW MVD,OPEN_COVER_HAULIER_DETAILS OCHS,CONSTANT_DETAIL CD WHERE MVD.LIMIT    BETWEEN OCHS.START_LIMIT AND OCHS.END_LIMIT AND OCHS.PROPOSAL_NO=? AND CD.DETAIL_NAME=MVD.HAULIER_CATEGORY_ID AND RSACODE='HAULIERCATG' AND TRAN_ID=? AND CD.CATEGORY_DETAIL_ID=OCHS.HAULIER_CATEGORY_ID) A ) AND TRAN_ID=?
UPDATE_EFEECTIVE_DATE_VALIDATION=update marine_vehicle_details_raw mvd set ERROR_MSG= (NVL(ERROR_MSG,'') ||'~Effective Date '||TO_CHAR(mvd.INCEPTION_DATE,'DD/MM/YYYY')||' Must be in a Range of policy Start Date and Policy End Date for Sno  '||mvd.SNO) , ERROR_STATUS='Y' where  mvd.tran_id=? and   mvd.proposal_no=? and   exists (select 1 from open_cover_master ocm where  ocm.proposal_no=? and mvd.proposal_no=ocm.proposal_no and TO_DATE(mvd.INCEPTION_DATE,'DD/MM/YYYY')  not between TO_DATE(ocm.POLICY_START_DATE,'DD/MM/YYYY')  and TO_DATE(ocm.POLICY_END_DATE,'DD/MM/YYYY') and ocm.AMEND_ID=(select max(amend_id) from OPEN_COVER_MASTER where proposal_no=? ) )
GET_VEHICLE_RAW_COUNT=select count(*)  from  marine_vehicle_details_raw where ERROR_STATUS='Y' and tran_id=?
UPDATE_RAW_ACTUAL_PREMIUM=UPDATE marine_vehicle_details_raw SET ACTUAL_PREMIUM=ROUND(to_char((SELECT HAULIER_PREMIUM FROM   OPEN_COVER_HAULIER_DETAILS OCHD WHERE  marine_vehicle_details_raw.LIMIT BETWEEN START_LIMIT AND END_LIMIT AND proposal_no =? AND HAULIER_CATEGORY_ID =(SELECT   CATEGORY_DETAIL_ID FROM   constant_detail  WHERE  DETAIL_NAME = marine_vehicle_details_raw.HAULIER_CATEGORY_ID AND RSACODE = 'HAULIERCATG' AND CATEGORY_ID = 167))/365 * CHARGEBLE_DAYS),3)  where marine_vehicle_details_raw.tran_id=?
UPDATE_RAW_VAT_PREMIUM=UPDATE marine_vehicle_details_raw SET VAT_TAX_AMT = ROUND((NVL(ACTUAL_PREMIUM,0) * NVL(VAT_TAX_PERCENT,0))/100,0) where marine_vehicle_details_raw.tran_id=?
INSERT_VEHICLE_TRANS=INSERT INTO marine_vehicle_trans_details (tran_id,entry_date,upload_file_name,total_no_of_records,error_records,status,proposal_no,BASE_OPENCOVER_NO) VALUES(?,SYSDATE,?,?,?,?,?,?)
GET_ERROR_MSG=select ERROR_MSG  from  marine_vehicle_details_raw where ERROR_STATUS='Y' and  tran_id = ?
GET_RAW_DATA_COUNT=select count(*) from marine_vehicle_details_raw where tran_id=?
UPDATE_DUPLICATE_VEHICLE=update marine_vehicle_trans_details set status='R' where tran_id=?
GET_REFUND_CHARGE_AMOUNT=select SUM(NVL(actual_premium,0)) from marine_vehicle_details where tran_id=? and Status in ( 'Y','N')
GET_REFUND_VAT_AMOUNT=select SUM(NVL(VAT_TAX_AMT,0)) from marine_vehicle_details where tran_id=? and Status in ( 'Y','N')
GET_VEHICLE_TRAN_DET=SELECT c.open_cover_no, ocmp.SUMINSURED,  ocmp.MARINE_RATE,ocmp.MARINE_PREMIUM,   ocmp.WAR_RATE,ocmp.WAR_PREMIUM,ocmp.TOTAL_PREMIUM ,  NVL (ocmp.POLICY_FEE, 0)POLICY_FEE,NVL (ocmp.INSPECTION_FEE, 0)INSPECTION_FEE,  FINAL_PREMIUM,  PAYABLE_YN,  PERCENTAGE,  PAYABLE_PREMIUM,  NVL (COMMISSION_PERCENT, 0)COMMISSION_PERCENT,  C.ENDT_STATUS ENDT_STATUS,  c.PROPOSAL_NO, (  NVL (ocmp.TOTAL_MARINE_PREMIUM, 0)  - NVL (ocmp.Recevied_Til_Date, 0)  - NVL (ocmp.POLICY_FEE_RECEIVED, 0)  - NVL (ocmp.INSPECTION_FEE_RECEIVED, 0) )total_amount,  oc.MISSIPPI_OPENCOVER_NO,  oc.debit_note_no,  oc.credit_note_no,  (  NVL (ocmp.Recevied_Til_Date, 0)  + NVL (ocmp.POLICY_FEE_RECEIVED, 0)  + NVL (ocmp.INSPECTION_FEE_RECEIVED, 0) )total_amount1,NVL (ocmp.TOTAL_MARINE_PREMIUM, 0)TOTAL_MARINE_PREMIUM,  NVL (POLICY_FEE_PAID, 0)POLICY_FEE_PAID,  NVL (INSPECTION_FEE_PAID, 0)INSPECTION_FEE_PAID FROM OPEN_COVER_MOP_DETAILS ocmp,  OPEN_COVER_POSITION_MASTER C,  open_cover_master oc  WHERE C.ORIGINAL_POLICY_NO IS NULL  AND c.open_cover_no = (SELECT original_policy_NO FROM OPEN_COVER_POSITION_MASTER  WHERE PROPOSAL_NO = ?)  AND ocmp.PROPOSAL_NO = c.PROPOSAL_NO  AND oc.PROPOSAL_NO = c.PROPOSAL_NO  AND oc.amend_id =  (SELECT MAX (amend_id) FROM open_cover_master  WHERE ocmp.PROPOSAL_NO = PROPOSAL_NO)   UNION ALL SELECT c.open_cover_no, ocmp.SUMINSURED,  ocmp.MARINE_RATE,ocmp.MARINE_PREMIUM, ocmp.WAR_RATE,ocmp.WAR_PREMIUM,TOTAL_PREMIUM ,  NVL (ocmp.POLICY_FEE, 0),NVL (ocmp.INSPECTION_FEE, 0),  FINAL_PREMIUM,  PAYABLE_YN,  PERCENTAGE,  PAYABLE_PREMIUM,  NVL (COMMISSION_PERCENT, 0),  C.ENDT_STATUS ENDT_STATUS,  c.PROPOSAL_NO, (  NVL (ocmp.TOTAL_MARINE_PREMIUM, 0)  - NVL (ocmp.Recevied_Til_Date, 0)  - NVL (ocmp.POLICY_FEE_RECEIVED, 0)  - NVL (ocmp.INSPECTION_FEE_RECEIVED, 0) ),  oc.MISSIPPI_OPENCOVER_NO,  oc.debit_note_no,  oc.credit_note_no,  (  NVL (ocmp.Recevied_Til_Date, 0)  + NVL (ocmp.POLICY_FEE_RECEIVED, 0)  + NVL (ocmp.INSPECTION_FEE_RECEIVED, 0) ), NVL (ocmp.TOTAL_MARINE_PREMIUM, 0),  NVL (POLICY_FEE_PAID, 0),  NVL (INSPECTION_FEE_PAID, 0) FROM OPEN_COVER_MOP_DETAILS ocmp,  OPEN_COVER_POSITION_MASTER C,  open_cover_master oc  WHERE C.ORIGINAL_POLICY_NO = (SELECT DISTINCT ORIGINAL_POLICY_NO  FROM OPEN_COVER_POSITION_MASTER WHERE PROPOSAL_NO = ?)  AND c.open_cover_no IS NOT NULL  AND ocmp.PROPOSAL_NO = c.PROPOSAL_NO  AND oc.PROPOSAL_NO = c.PROPOSAL_NO  AND oc.amend_id =  (SELECT MAX (amend_id) FROM open_cover_master  WHERE ocmp.PROPOSAL_NO = PROPOSAL_NO)order by PROPOSAL_NO
GET_PREMIUM_DETAIL=SELECT SUMINSURED,MARINE_RATE,WAR_RATE,TOTAL_PREMIUM,NVL(POLICY_FEE,0)POLICY_FEE,NVL(INSPECTION_FEE,0)INSPECTION_FEE,NVL(FINAL_PREMIUM,0)FINAL_PREMIUM,NVL(Recevied_Til_Date,0)Recevied_Til_Date ,NVL(POLICY_FEE_RECEIVED,0)POLICY_FEE_RECEIVED,NVL(INSPECTION_FEE_RECEIVED,0)INSPECTION_FEE_RECEIVED,NVL(Recevied_Til_Date,0)+NVL(POLICY_FEE_RECEIVED,0)+NVL(INSPECTION_FEE_RECEIVED,0) PREMIUM_REC,PAYABLE_YN, FLOOR(abs(PAYABLE_MARINE_PREMIUM))PAYABLE_MARINE_PREMIUM,FLOOR(abs(POLICY_FEE_paid))POLICY_FEE_paid,FLOOR(abs(INSPECTION_FEE_paid))INSPECTION_FEE_paid,FLOOR ((ABS (PAYABLE_MARINE_PREMIUM))+FLOOR (ABS (POLICY_FEE_paid))+FLOOR (ABS (INSPECTION_FEE_paid)))TOTAL,(TOTAL_PREMIUM-NVL (Recevied_Til_Date, 0)) BALANCEAMT , (NVL (POLICY_FEE, 0)-NVL (POLICY_FEE_RECEIVED, 0))POLICYFEEBAL, (NVL (INSPECTION_FEE, 0)-NVL (INSPECTION_FEE_RECEIVED, 0))INCEPTIONFEEBAL, (NVL (FINAL_PREMIUM, 0)-(NVL (Recevied_Til_Date, 0) + NVL (POLICY_FEE_RECEIVED, 0) + NVL (INSPECTION_FEE_RECEIVED, 0)))  RECEVIEDTOT  FROM OPEN_COVER_MOP_DETAILS ocmp,OPEN_COVER_POSITION_MASTER C WHERE ocmp.PROPOSAL_NO=? AND C.PROPOSAL_NO = ocmp.PROPOSAL_NO
GET_PREMIUM_TRAN_DET=select * from marine_vehicle_trans_details where tran_id=?
get.marine.vehicle.details=select SNO,TRAN_ID,PROPOSAL_NO,ASSERT_NO,PLATE_NO,CHASSIS_NO,MAKE,DESCRIPTION,SEQUENCE_NO,MANUFACTURE_YEAR,LIMIT,TO_DATE(ENTRY_DATE,'DD/MM/RRRR')ENTRY_DATE,INCEPTION_DATE,EXPIRY_DATE,STATUS,BASE_OPEN_COVER_NO,ACTUAL_PREMIUM,REFUND_PREMIUM, VAT_TAX_REFUND, VAT_TAX_AMT from MARINE_VEHICLE_DETAILS where tran_id\=? or deleted_tran_id\= ? and status\=? order by SNO
SEQ_GET_CREDIT_NO = SELECT CREDIT_NUMBER_SEQ_01.NEXTVAL FROM DUAL
SEQ_GET_DEBIT_NO =SELECT DEBIT_NUMBER_SEQ_01.NEXTVAL FROM DUAL
GET_CERT_NO=Select  Cert_no from open_cover_position_master Where Open_cover_no=?
UPD_CERT_NO=update open_cover_position_master set Cert_no=NVL(Cert_no,0)+1 where Open_cover_no=?
UPD_VEHICLE_STATUS=update marine_vehicle_details set status=? where  tran_id=?  or deleted_tran_id= ?
UPD_VEH_POLICY_DETAIL=update marine_vehicle_trans_details set POLICY_NO=?, LOGIN_ID=?,CUSTOMER_ID=?,PRODUCT_ID='13',CREDIT_NOTE_DATE=TO_DATE(?,'DD/MM/YYYY'),DEBIT_NOTE_DATE=TO_DATE(?,'DD/MM/YYYY'),CREDIT_TO=?,DEBIT_TO=?,CREDIT_TO_ID=?,DEBIT_TO_ID=?,CREDIT_NOTE_NO=?,DEBIT_NOTE_NO=?, OPEN_COVER_NO=?,BASE_OPENCOVER_NO=?,PREMIUM=?,policy_fee=?,COMMISSION=?,COMISSION_PERCENTAGE=?,status=?,broker_id=? ,CONDITION_DESC=?,POLICY_EFFECTIVE_DATE=TO_DATE(?,'DD/MM/YYYY'),VAT_TAX_PERCENT=?,VAT_TAX_AMT=? ,VAT_COMMISSION=?,VAT_COMMISSION_PERCENT=? where tran_id=?
GET_MAX_SNO_DUE1=select Nvl(max(sno),0) from OPEN_COVER_Payment_terms where POLICY_NO = ?
DEL_PAYMENT_TERMS=delete from OPEN_COVER_Payment_terms where  PROPOSAL_NO=?
INS_PAYMENT_TERMS = INSERT INTO OPEN_COVER_Payment_terms (PROPOSAL_NO, POLICY_NO,DUE_DATE,DUE_AMOUNT,DUE_Percentage,sno,EFFECTIVE_DATE,AMEND_ID,STATUS,ENTRY_DATE,OPEN_COVER_NO,MISSIPPI_OPENCOVER_NO,PRODUCT_TYPE,FRZ_FLAG)  VALUES (?,?,to_Date(?,'dd/mm/yyyy'),?,?,?,to_Date(?,'dd/mm/yyyy'),?,?,SYSDATE,?,?,?,?)
CAL_DR_CR_TABLE_INSERT = {CALL cr_dr_insert(?,?,?)} 
getMarinevehicledeletedetails=select SNO,TRAN_ID,PROPOSAL_NO,ASSERT_NO,PLATE_NO,CHASSIS_NO,MAKE,DESCRIPTION,SEQUENCE_NO,MANUFACTURE_YEAR,LIMIT,TO_DATE(ENTRY_DATE,'DD/MM/YYYY')ENTRY_DATE,INCEPTION_DATE,EXPIRY_DATE,STATUS,BASE_OPEN_COVER_NO,ACTUAL_PREMIUM,REFUND_PREMIUM from MARINE_VEHICLE_DETAILS where BASE_OPEN_COVER_NO\=? and status\=?
GETPAYMENT_TERMS_LT= SELECT   PM.TRAN_ID QUOTE_NO, pm.POLICY_NO ,PI.FIRST_NAME CUS_NAME,TO_CHAR(pm.ENTRY_DATE,'dd/mm/yyyy') INCEPTION_DATE FROM   marine_vehicle_trans_details PM,PERSONAL_INFO PI WHERE   pi.AMEND_ID \= (SELECT   MAX (AMEND_ID)  FROM   personal_info per WHERE   per.CUSTOMER_ID \= pi.CUSTOMER_ID)  AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND POLICY_NO \= ?
GET_DUE_INFO = select to_char(ocpt.DUE_DATE,'dd/mm/yyyy') DUE_DATE,to_char(ocpt.EFFECTIVE_DATE,'dd/mm/yyyy') EFFECTIVE_DATE,ocpt.DUE_AMOUNT ,ocpt.DUE_Percentage ,ocpt.AMEND_ID,ocpt.SNO,ocpt.MISSIPPI_OPENCOVER_NO from OPEN_COVER_Payment_terms ocpt where ocpt.POLICY_NO = ?  and OCPT.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_Payment_terms OCT WHERE OCT.POLICY_NO=OCPT.POLICY_NO AND OCPT.sno=OCT.sno) AND OCPT.STATUS='Y' ORDER BY SNO
GET_MAX_EFFECTIVE_DATE=select count(*) from dual  where to_date(?,'dd/mm/yyyy') >= (select to_date(max(INCEPTION_DATE),'dd/mm/yyyy') from MARINE_VEHICLE_DETAILS where BASE_OPEN_COVER_NO=?)
GET_VEHICLE_REFUND_PREMIUM=select actual_premium PREMIUM from marine_vehicle_details where BASE_OPEN_COVER_NO=? and sno=? and TRAN_ID=?
GET_CHARGABLE_DAYS=select CHARGEBLE_DAYS from marine_vehicle_details where BASE_OPEN_COVER_NO=? and sno=? and TRAN_ID=?
GET_DELETE_DIFF_DATE=select (TRUNC(POLICY_END_DATE) - TO_DATE(?,'dd/mm/yyyy'))+1 from open_cover_master where PROPOSAL_NO=? and AMEND_ID=(select max(AMEND_ID) from open_cover_master where PROPOSAL_NO=?)
UPDATE_DELETE_STATUS=update marine_vehicle_details set status='Y' ,delete_proposal_date=to_date(?,'dd/mm/yyyy'),REFUND_PREMIUM=ROUND(?,3),delete_proposal_no=?,deleted_tran_id=? ,REFUND_DAYS=? where PROPOSAL_NO=? and sno=? and TRAN_ID=?
UPDATE_DELETE_TAX=UPDATE marine_vehicle_details SET VAT_TAX_REFUND = ROUND((NVL(REFUND_PREMIUM,0) * NVL(VAT_TAX_PERCENT,0))/100,3) where deleted_tran_id=?
GET_REFUND_VAT_AMOUNT1=select SUM(VAT_TAX_REFUND) from marine_vehicle_details where BASE_OPEN_COVER_NO=? and Status='Y' and deleted_tran_id=?
GET_REFUND_AMOUNT=select SUM(REFUND_PREMIUM) from marine_vehicle_details where BASE_OPEN_COVER_NO=? and Status='Y' and deleted_tran_id=?
GET_DUPLICATE_RECORD=select SNO,TRAN_ID,PROPOSAL_NO,ASSERT_NO,PLATE_NO,CHASSIS_NO,MAKE,DESCRIPTION,SEQUENCE_NO,MANUFACTURE_YEAR,LIMIT,TO_DATE(ENTRY_DATE,'dd/mm/yyyy')ENTRY_DATE,INCEPTION_DATE,EXPIRY_DATE,BASE_OPEN_COVER_NO   from marine_vehicle_details_raw  where tran_id=?
POLICY_EFF_DATE_CT =  select (case when count(*) = 0 then  (SELECT DATENAME(month,convert(date,?,103) ) ) else 'success' end) MSG  from T_TRN_CLOSING where  PRODUCT_CORE_CODE=1 and   BRANCH_CODE = ?  and (convert(date,?,103) between CLO_DATE_OPENED and  CLO_DATE_CLOSED or  convert(date,?,103) >= CLO_MONTHEND_DT)

GET_VAT_INFO = select bcm.COMMISSION_VAT_YN, md.INCEPTION_DATE POL_START_DATE,md.VAT_APPLICABLE,nvl(md.PREMIUM,0)+nvl(md.Policy_fee,'0')+nvl(md.EXCESS_PREMIUM,'0') NET_PREMIUM,nvl(md.Policy_fee,'0') POLICY_FEE, md.FINAL_DESTINATION_COUNTRY_ID,md.TRANSIT_FROM_COUNTRY_ID, pm.COMMISSION  COMMISSION,(select COUNTRY_NAME from country_master cm where COUNTRY_ID= md.FINAL_DESTINATION_COUNTRY_ID and AMEND_ID = (select max(AMEND_ID) from country_master cm1 where cm1.COUNTRY_ID=cm.COUNTRY_ID ))ORG_COUNTRY,( select COUNTRY_NAME from country_master cm where COUNTRY_ID= md.TRANSIT_FROM_COUNTRY_ID and AMEND_ID = (select max(AMEND_ID) from country_master cm1 where cm1.COUNTRY_ID=cm.COUNTRY_ID )) DEST_COUNTRY,md.AC_EXECUTIVE_ID,bcm.RSA_BROKER_CODE ,bcm.VAT_REG_NO BROKER_VAT_REG_NO,pi.MISSIPPI_CUSTOMER_CODE,pi.VAT_REG_NO CUST_VAT_REG_NO,pi.CUST_VAT_YN, led.RSACODE  BDM_CODE,led.VAT_REG_NO BDM_VAT_REG_NO from marine_data md,personal_info pi,broker_company_master bcm,position_master pm,login_executive_details led where bcm.AGENCY_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=pm.LOGIN_ID) and pm.application_no=md.application_no  and  pm.CUSTOMER_ID=pi.CUSTOMER_ID and  md.AC_EXECUTIVE_ID=led.AC_EXECUTIVE_ID and pm.quote_no=?
GET_VAT_PERCENT = SELECT PERCENTRATE VAT_TAX FROM CONSTANT_DETAIL  WHERE CATEGORY_DETAIL_ID=1 and CATEGORY_ID=204 AND STATUS='Y' and  to_date(RSACODE,'dd/MM/yyyy')<= to_date(?,'dd/MM/yyyy')
declaration.getDeclarationList3=SELECT DISTINCT tran_id, to_char(INCEPTION_DATE , 'dd/MM/yyyy') INCEPTION_DATE,(SELECT nvl(PI.FIRST_NAME,'') || ' ' || nvl(PI.LAST_NAME,'') FROM PERSONAL_INFO PI WHERE PI.CUSTOMER_ID = pm.CUSTOMER_ID AND AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO P WHERE P.CUSTOMER_ID = PI.CUSTOMER_ID)) CUSTOMER_NAME, CERTIFICATE_NO, COUNT ( *) NO_OF_RECORDS, ROUND(sum(PREMIUM),2) PREMIUM FROM POSITION_MASTER pm WHERE OPEN_COVER_NO = ? AND LOGIN_ID = ? AND CERTIFICATE_NO IS NOT NULL AND tran_id IS NOT NULL GROUP BY CERTIFICATE_NO, CUSTOMER_ID, to_char(INCEPTION_DATE , 'dd/MM/yyyy'), tran_id