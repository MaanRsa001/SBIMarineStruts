#									Marine Queries (MS SQL)																					#	
#																																			#
#############################################################################################################################################
#Common and List Page Queries
quotation.option=SELECT CODE, CODEDESC, CODEVALUE FROM  QUOTATIONDATA(?,?,?,?,?,?,?,?,?,?,?,?,?) 
quotation.option.motor = SELECT CODE, CODEDESC, CODEVALUE FROM MOTOR_QUOTATION_DATA(?,?,?,?,?,?,?,?)
broker=SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?
##customer.selection=SELECT FIRST_NAME FIRST_NAME, EMAIL, POBOX, MOBILE, UPPER(EMIRATE) as CITY_NAME,UPPER(EMIRATE) as EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.'  + ' ' + ISNULL (POBOX, ' ') + ' ' + ISNULL (ADDRESS1, ' ') + ' ' + ISNULL (ADDRESS2, ' ') + ' ' + ISNULL (EMIRATE , ' '), 'select', '') ADDRESS FROM PERSONAL_INFO pd WHERE pd.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?)) AND APPLICATION_ID \= '1' and AMEND_ID\=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID\=pd.CUSTOMER_ID)
customer.selection=SELECT FIRST_NAME FIRST_NAME, EMAIL, POBOX, MOBILE, UPPER(EMIRATE) as CITY_NAME,UPPER(EMIRATE) as EMIRATE, CUSTOMER_ID, VAT_REG_NO, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.'  + ' ' + ISNULL (POBOX, ' ') + ' ' + ISNULL (ADDRESS1, ' ') + ' ' + ISNULL (ADDRESS2, ' ') + ' ' + ISNULL (EMIRATE , ' '), 'select', '') ADDRESS FROM PERSONAL_INFO pd WHERE pd.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?)) AND APPLICATION_ID \= '1' and AMEND_ID\=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID\=pd.CUSTOMER_ID)
EXIST_BROKER_SELECTION = SELECT  ISNULL(EMP.BRANCH,'''')BRANCH,ISNULL(EMP.EMGROUP,'''')EMGROUP,ISNULL(EMP.EMCODE,'''')EMCODE,ISNULL(Replace(EMP.EMPDES, '''''''', ''''),'''')EMPDES,ISNULL(EMP.FGROUP,'''')FGROUP ,ISNULL(EMP.EMACCODE,'''')EMACCODE,ISNULL(EMP.AREMPDES,'''')AREMPDES,ISNULL(EMP.COMMISSION,'''')COMMISSION,ISNULL(EMP.PER,'''') PER ,ISNULL( CMP.[TITLE],'''') TITLE,ISNULL(CMP.[COMPANY NAME],'''') COMPANY_NAME,ISNULL(CMP.[COMPANYARA],'''') COMPANY_NAME_ARABIC,ISNULL( CMP.[CONTPERSON],'''') CONTACT_PERSON ,ISNULL(CMP.[CONTPERSONNO],'''')CONTACT_PERSON_NO,ISNULL(CMP.[CPOSITION],'''')CONTACT_OCCUPATION,ISNULL(CMP.[ADDRESS1],'''') ADDRESS1,ISNULL(CMP.[ADDRESS2],'''') ADDRESS2, ISNULL( CMP.[CITY],'''') CITY,ISNULL(CMP.[COUNTRY],'''') COUNTRY,ISNULL(CMP.[PHONE],'''') PHONE,ISNULL(CMP.[FAX],'''') FAX,ISNULL(CMP.[MOBILE],'''') MOBILENO,ISNULL(CMP.[EMAIL],'''') EMAIL  FROM [COMPANY MASTER] CMP,EMPCODE EMP WHERE EMP.FACTIVE=''1'' AND CMP.BRKCODE=EMP.EMCODE AND CMP.[COMPANY ID] =EMP.EMACCODE  {0} ORDER BY EMP.EMPDES
report.transaction=SELECT A.TRANSACTION_ID,(SELECT COUNT (1) FROM WEBSERVICE_MARINE_QUOTE WHERE STATUS \= 'Q' AND TRANSACTION_ID \= A.TRANSACTION_ID AND OPENCOVER_POLICY_NUMBER \= A.OPENCOVER_POLICY_NUMBER) VALID_RECORDS, (SELECT COUNT (1) FROM XL_OPENCOVER_RAW WHERE TRANSACTION_ID \= A.TRANSACTION_ID AND OPENCOVER_POLICY_NUMBER \= A.OPENCOVER_POLICY_NUMBER) INVALID_RECORDS FROM XL_TRANSACTION_DETAILS A WHERE A.OPENCOVER_POLICY_NUMBER like ? order by A.TRANSACTION_ID desc
#report.declaration=SELECT PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(ISNULL (MD. PREMIUM, 0) + ISNULL (MD.EXCESS_PREMIUM, 0)) PREMIUM,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) = 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID=MPD.SETTLING_AGENT_ID AND (BRANCH_CODE=? or BRANCH_CODE='01')) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_POLICY_DETAILS MPD,WEBSERVICE_MARINE_QUOTE WMQ WHERE PM.OPEN_COVER_NO = ? AND PM.STATUS = 'Y' AND PM.REMARKS IN ('Normal', 'Admin') AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND convert(date,PM.EFFECTIVE_DATE,103) > convert(date,sysdatetime(),103) AND PM.LOGIN_ID = ? AND PM.APPLICATION_ID = ISNULL(?,'1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO=PM.APPLICATION_NO AND MPD.QUOTE_NO=PM.QUOTE_NO 
#report.declaration=SELECT PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(ISNULL (MD. PREMIUM, 0) + ISNULL (MD.EXCESS_PREMIUM, 0)) PREMIUM,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) = 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID=MPD.SETTLING_AGENT_ID AND (BRANCH_CODE=? or BRANCH_CODE='01')) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_POLICY_DETAILS MPD,WEBSERVICE_MARINE_QUOTE WMQ WHERE PM.OPEN_COVER_NO = ? AND PM.STATUS = 'Y'  AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND (PM.LOGIN_ID = ? or  WMQ.LOGIN_ID=?)  AND MD.APPLICATION_NO=PM.APPLICATION_NO AND MPD.QUOTE_NO=PM.QUOTE_NO
report.declaration=select count1,VESSEL_NAME, SUPPLIER_NAME, TRANSACTION_ID, OPEN_COVER_NO,(select sum(premium) from POSITION_MASTER pm where A.OPEN_COVER_NO=pm.OPEN_COVER_NO) premium from ( SELECT (select count(*) from WEBSERVICE_MARINE_QUOTE WMQ1 where WMQ.TRANSACTION_ID=WMQ1.TRANSACTION_ID) count1, WMQ.VESSEL_NAME,MRD.SUPPLIER_NAME, WMQ.TRANSACTION_ID, PM. QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(ISNULL (MD. PREMIUM, 0) + ISNULL (MD.EXCESS_PREMIUM, 0)) PREMIUM,( SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) = 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID=MPD.SETTLING_AGENT_ID AND BRANCH_CODE=?) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO)) PACKAGE_DESCRIPTION,PM.OPEN_COVER_NO FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_RESULT_DETAILS MRD,WEBSERVICE_MARINE_QUOTE WMQ, MARINE_POLICY_DETAILS MPD WHERE PM.OPEN_COVER_NO = ? and MRD.APPLICATION_NO=PM.APPLICATION_NO AND WMQ.APPLICATION_NO=PM.APPLICATION_NO AND PM.STATUS = 'Y' AND PM.REMARKS IN ('Normal', 'Admin') AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > ( SELECT GETDATE() FROM DUAL) AND PM.LOGIN_ID =? AND ltrim(PM.APPLICATION_ID) = nullif(?,'1') AND nullif(PM.DISCOUNT_PREMIUM,0) IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO=PM.APPLICATION_NO AND MPD.QUOTE_NO=PM.QUOTE_NO and pi.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=pi.CUSTOMER_ID)
report_declaration_policy=SELECT (A.POLICY_NO), ISNULL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, SUM (A.PREMIUM) PREMIUM, COUNT (A.POLICY_NO) POLICY_COUNT, OCM.MISSIPPI_OPENCOVER_NO OPENCOVER_NO, ISNULL (PI.COMPANY_NAME, PI.FIRST_NAME + ' ' + ' ' + ' ' + PI.LAST_NAME) OPENCOVER_CUST_NAME, OCM.AMEND_ID,A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO FROM POSITION_MASTER A,OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM, PERSONAL_INFO PI WHERE A.LOGIN_ID =? and pi.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=pi.CUSTOMER_ID) AND A.STATUS = 'P' AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) IN ('LINKED') AND A.PRODUCT_ID = ? AND A.APPLICATION_ID = ISNULL(?,'1') AND A.OPEN_COVER_NO=OCPM.OPEN_COVER_NO AND OCPM.OPEN_COVER_NO = ? AND OCPM.PROPOSAL_NO = OCM.PROPOSAL_NO AND PI.CUSTOMER_ID = OCM.CUSTOMER_ID AND PI.STATUS = 'Y' AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO = ? AND OCPMS.PROPOSAL_NO = OCMS.PROPOSAL_NO convert(date,OCMS.EFFECTIVE_DATE, 103) <= convert(date,SYSDATETIME(), 103)) GROUP BY A.POLICY_NO, A.LOGIN_ID, A.OPEN_COVER_NO,OCM.MISSIPPI_OPENCOVER_NO, ISNULL (PI.COMPANY_NAME, PI.FIRST_NAME + ' ' + ' ' + ' ' + PI.LAST_NAME), PI.COMPANY_NAME, OCM.AMEND_ID,A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO ORDER BY SUBSTR (A.POLICY_NO, 9, 16) DESC
copyquote.quoteNo=SELECT PM.QUOTE_NO,PI.FIRST_NAME,Cast(MD.PREMIUM as decimal(18,2)) as PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO=PM.APPLICATION_NO and pi.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=pi.CUSTOMER_ID) AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND QUOTE_NO = ? AND PM.PRODUCT_ID=? AND LM.LOGIN_ID=PM.LOGIN_ID
copyquote.policyNo=	SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO=PM.APPLICATION_NO and pi.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=pi.CUSTOMER_ID) AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND POLICY_NO = ?  AND PM.PRODUCT_ID=? AND LM.LOGIN_ID=PM.LOGIN_ID
copyquote.custName=SELECT PM.QUOTE_NO,PI.FIRST_NAME,MD.PREMIUM FROM POSITION_MASTER PM,MARINE_DATA MD,LOGIN_MASTER LM,PERSONAL_INFO PI WHERE MD.APPLICATION_NO\=PM.APPLICATION_NO and pi.AMEND_ID\=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID\=pi.CUSTOMER_ID) AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND UPPER(PI.FIRST_NAME) like UPPER('%'+ ' ' +?+ ' ' +'%') AND PM.PRODUCT_ID\=? AND LM.LOGIN_ID\=PM.LOGIN_ID
#report.policy=SELECT distinct(B.APPLICATION_NO), A.POLICY_NO,A.INCEPTION_DATE, CONVERT(VARCHAR(10),A.INCEPTION_DATE, 103) POLICY_ISSUE_DATE, B.MODE_OF_TRANSPORT, H.TRANSPORT_DESCRIPTION FORM_OF_TRANSPORT, E.SALE_TERM_NAME BASIS_OF_VALUATION, B.TOTAL_SUM_INSURED SUM_INSURED_LOCAL, A.PREMIUM BASIC_PREMIUM, ISNULL(B.PREMIUM,0)+ISNULL(B.EXCESS_PREMIUM,0) TOTAL_PREMIUM, ISNULL(A.COMMISSION, '0') COMMISSION, B.TOTAL_WAR_CHARGES WSRCC_PREMIUM, A.DEBIT_NOTE_NO,A.CREDIT_NOTE_NO, A.CERTIFICATE_NO, ISNULL (G.FIRST_NAME, G.COMPANY_NAME) INSURED_NAME, ISNULL (MP.BANK_NAME, ' ') BANK_NAME, ISNULL (MP.CARRIER_NAME, ' ') CARRIER_NAME, A.EXCESS_PREMIUM EXCESS_PREMIUM, B.CURRENCY_NAME CURRENCY_TYPE, CONVERT(VARCHAR(10),B.INCEPTION_DATE, 103) INCEPTION_DATE, (CASE WHEN B.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN B.TRANSIT_FROM + ' ' + ',' + ' ' + CNM.COUNTRY_NAME + ' ' + ', WAREHOUSE' ELSE CNM.COUNTRY_NAME + ' ' + ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN B.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN B.FINAL_DESTINATION + ' ' + ',' + ' ' + CN1.COUNTRY_NAME + ' ' + ', WAREHOUSE' ELSE CN1.COUNTRY_NAME + ' ' + ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= B.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, B.TOTAL_SUM_INSURED SUM_INSURED_FOREIGN, STUFF((SELECT ', '+CONVERT(varchar, W.PACKAGE_DESCRIPTION)  AS[text()] FROM MARINE_RESULT_DETAILS W where APPLICATION_NO\=B.APPLICATION_NO FOR XML PATH('')), 1, 2, '') as  GOODS_DESCRIPTION, (B.EQUIVALENT_USD + ISNULL(B.TOTAL_SALE_TERM_CHARGES, 0) + ISNULL (B.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT_DH,( B.EQUIVALENT_USD + ISNULL (B.TOTAL_SALE_TERM_CHARGES, 0) + ISNULL (B.TOTAL_TOLERANCE_CHARGES, 0)) / B.EXCHANGE_RATE EQUIVALENT_USD,( ISNULL (B.PREMIUM, 0) - ISNULL (B.TOTAL_WAR_CHARGES, 0) - ISNULL (b.POLICY_FEE, '0')) MARINE_PREMIUM, B.POLICY_FEE, TM.TOLERANCE_NAME  FROM POSITION_MASTER A, MARINE_DATA B, COVER_MASTER D, SALE_TERM_MASTER E, EXTRA_COVER_MASTER F, PERSONAL_INFO G, MODE_OF_TRANSPORT H, MARINE_POLICY_DETAILS MP, COUNTRY_MASTER CNM, TOLERANCE_MASTER TM WHERE B.COVER_ID \= D.COVER_ID AND B.SALE_TERM_ID \= E.SALE_TERM_ID AND D.BRANCH_CODE \= TM.BRANCH_CODE AND B.TOLERANCE_ID \= TM.TOLERANCE_ID and F.EXTRA_COVER_ID \= B.EXTRA_COVER_ID AND D.BRANCH_CODE \= E.BRANCH_CODE AND D.BRANCH_CODE \= F.BRANCH_CODE AND D.BRANCH_CODE \= H.BRANCH_CODE AND A.APPLICATION_NO \= B.APPLICATION_NO AND G.CUSTOMER_ID \= A.CUSTOMER_ID AND B.MODE_OF_TRANSPORT \= H.MODE_TRANSPORT_ID AND CONVERT (date, A.INCEPTION_DATE, 103) BETWEEN CONVERT (date,?,103) AND  DATEADD(DAY,1,CONVERT (date,?,103)) AND CNM.COUNTRY_ID \= B.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND convert(date,CNM.EFFECTIVE_DATE, 103) <\= convert(date,SYSDATETIME(), 103) AND G.APPLICATION_ID \= '1' AND G.APPLICATION_ID \= A.APPLICATION_ID AND (case ? when 'ALL' then 'A' else A.LOGIN_ID end) \=  (case ? when 'ALL' then 'A' else ? end)  AND MP.QUOTE_NO \= A.QUOTE_NO AND A.STATUS \= 'P' AND A.PRODUCT_ID \= ? ORDER BY A.INCEPTION_DATE DESC
report.policy=select * from ISSUER_REPORTS(?,?,?,?,?,?,'broker',?)
report.policyissuer=select * from ISSUER_REPORTS(?,?,?,?,?,?,'RSAIssuer',?)
report.declaration.vessel.list=SELECT PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(ISNULL (MD.PREMIUM, 0) + ISNULL (MD.EXCESS_PREMIUM, 0)) PREMIUM,(  SELECT  CASE WHEN UPPER (SETTLING_AGENT_NAME) = 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID=MPD.SETTLING_AGENT_ID AND BRANCH_CODE=?) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_POLICY_DETAILS MPD, WEBSERVICE_MARINE_QUOTE WMQ,WEBSERVICE_MARINE_COMMODITY WMC WHERE PM.OPEN_COVER_NO = ? AND PM.STATUS = 'Y' AND PM.REMARKS IN ('Normal', 'Admin') AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > (SELECT GETDATE() FROM DUAL) AND PM.LOGIN_ID = ? AND PM.APPLICATION_ID = ISNULL(?,'1')  AND WMQ.APPLICATION_NO=PM.APPLICATION_NO and WMC.APPLICATION_NO=PM.APPLICATION_NO AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO=PM.APPLICATION_NO AND MPD.QUOTE_NO=PM.QUOTE_NO and WMQ.TRANSACTION_ID=? and WMC.SUPPLIER_NAME=? and WMQ.VESSEL_NAME=? and pi.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=pi.CUSTOMER_ID) ORDER BY PM.QUOTE_NO
#SELECT distinct(B.APPLICATION_NO), A.POLICY_NO,A.INCEPTION_DATE, convert(varchar(10), A.INCEPTION_DATE, 103) POLICY_ISSUE_DATE, B.MODE_OF_TRANSPORT, H.TRANSPORT_DESCRIPTION FORM_OF_TRANSPORT, E.SALE_TERM_NAME BASIS_OF_VALUATION, B.TOTAL_SUM_INSURED SUM_INSURED_LOCAL, A.PREMIUM BASIC_PREMIUM, ISNULL(B.PREMIUM,0)+ISNULL(B.EXCESS_PREMIUM,0) TOTAL_PREMIUM, ISNULL(A.COMMISSION, '0') COMMISSION, B.TOTAL_WAR_CHARGES WSRCC_PREMIUM, A.DEBIT_NOTE_NO,A.CREDIT_NOTE_NO, A.CERTIFICATE_NO, ISNULL (G.FIRST_NAME, G.COMPANY_NAME) INSURED_NAME, ISNULL (MP.BANK_NAME, ' ') BANK_NAME, ISNULL (MP.CARRIER_NAME, ' ') CARRIER_NAME, A.EXCESS_PREMIUM EXCESS_PREMIUM, B.CURRENCY_NAME CURRENCY_TYPE, convert (varchar(10),B.INCEPTION_DATE, 103) INCEPTION_DATE, (CASE WHEN B.WAREHOUSE_TO_WAREHOUSE \= 'YES' THEN B.TRANSIT_FROM + ' ' + ',' + ' ' + CNM.COUNTRY_NAME + ' ' + ', WAREHOUSE' ELSE CNM.COUNTRY_NAME + ' ' + ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN B.WARE_TO_WARE_FINAL_DEST \= 'YES' THEN B.FINAL_DESTINATION + ' ' + ',' + ' ' + CN1.COUNTRY_NAME + ' ' + ', WAREHOUSE' ELSE CN1.COUNTRY_NAME + ' ' + ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID \= B.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CN1.COUNTRY_ID)) DEST_COUNTRY, B.TOTAL_SUM_INSURED SUM_INSURED_FOREIGN, (SELECT RTRIM(XMLAGG(XMLELEMENT(E,PACKAGE_DESCRIPTION + ' ' + ',')).EXTRACT('//text()'),',') PACKAGE_DESCRIPTION FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=B.APPLICATION_NO AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=B.APPLICATION_NO)) GOODS_DESCRIPTION, (B.EQUIVALENT_USD + ISNULL(B.TOTAL_SALE_TERM_CHARGES, 0) + ISNULL (B.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT_DH,( B.EQUIVALENT_USD + ISNULL (B.TOTAL_SALE_TERM_CHARGES, 0) + ISNULL (B.TOTAL_TOLERANCE_CHARGES, 0)) / B.EXCHANGE_RATE EQUIVALENT_USD,( ISNULL (B.PREMIUM, 0) - ISNULL (B.TOTAL_WAR_CHARGES, 0) - ISNULL (b.POLICY_FEE, '0')) MARINE_PREMIUM, B.POLICY_FEE, TM.TOLERANCE_NAME FROM POSITION_MASTER A, MARINE_DATA B, COVER_MASTER D, SALE_TERM_MASTER E, EXTRA_COVER_MASTER F, PERSONAL_INFO G, MODE_OF_TRANSPORT H, MARINE_POLICY_DETAILS MP, COUNTRY_MASTER CNM, TOLERANCE_MASTER TM WHERE B.COVER_ID \= D.COVER_ID AND B.SALE_TERM_ID \= E.SALE_TERM_ID AND D.BRANCH_CODE \= TM.BRANCH_CODE AND B.TOLERANCE_ID \= TM.TOLERANCE_ID AND F.EXTRA_COVER_ID \= B.EXTRA_COVER_ID AND D.BRANCH_CODE \= E.BRANCH_CODE AND D.BRANCH_CODE \= F.BRANCH_CODE AND D.BRANCH_CODE \= H.BRANCH_CODE AND A.APPLICATION_NO \= B.APPLICATION_NO AND G.CUSTOMER_ID \= A.CUSTOMER_ID AND B.MODE_OF_TRANSPORT \= H.MODE_TRANSPORT_ID AND (convert(date,A.INCEPTION_DATE,103) BETWEEN convert(date,?, 103) AND convert(date,?, 103) + 1) AND CNM.COUNTRY_ID \= B.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= CNM.COUNTRY_ID) AND convert(date,CNM.EFFECTIVE_DATE, 103) <\= convert(date,SYSDATETIME(), 103) AND A.APPLICATION_ID \= ? AND A.LOGIN_ID IN (?) AND MP.QUOTE_NO \= A.QUOTE_NO AND A.STATUS \= 'P' AND A.PRODUCT_ID \= ? ORDER BY A.INCEPTION_DATE DESC   
executive=SELECT LED.AC_EXECUTIVE_ID FROM LOGIN_EXECUTIVE_DETAILS LED,BROKER_COMPANY_MASTER BCM WHERE LED.AC_EXECUTIVE_ID=BCM.AC_EXECUTIVE_ID AND BCM.AGENCY_CODE=?
executive_oc=Select Executive_Id From Open_Cover_Master Ocm Where Proposal_No =(Select Proposal_No From  Open_Cover_Position_Master Ocpm Where Ocpm.Proposal_No=Ocm.Proposal_No And Open_Cover_No=? and status='P' ) And Ocm.Amend_Id=(Select Max(Amend_Id) From Open_Cover_Master Oc Where Ocm.Proposal_No=Oc.Proposal_No)
lapsed.reason=SELECT CATEGORY_DETAIL_ID,DETAIL_NAME FROM CONSTANT_DETAIL WHERE BRANCH_CODE=? AND CATEGORY_ID = (SELECT CATEGORY_ID FROM CONSTANT_MASTER WHERE CATEGORY_NAME = 'LAPSED_QUOTE_REASON' AND BRANCH_CODE=?)
quote.detail=SELECT A.CUSTOMER_ID, A.QUOTE_NO,CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTE_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, ISNULL (B.FIRST_NAME, B.COMPANY_NAME) CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.QUOTE_NO = ? AND A.CUSTOMER_ID = B.CUSTOMER_ID and B.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=B.CUSTOMER_ID)
lapsed.update=UPDATE POSITION_MASTER SET STATUS \= 'D',EFFECTIVE_DATE \=convert(date, SYSDATETIME(),103),LAPSED_REMARKS \=?,LAPSED_DATE \= convert(date,SYSDATETIME(),103), LAPSED_UPDATED_BY \=? WHERE QUOTE_NO \=?
active.lapsed=UPDATE POSITION_MASTER SET ENTRY_DATE=getdate()+8/24,EFFECTIVE_DATE=dateadd(month,1,getdate())-1 WHERE QUOTE_NO=?
##customer.opencover=SELECT UPPER (ISNULL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX,MOBILE,  UPPER(EMIRATE) as CITY_NAME ,UPPER(EMIRATE) as EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE,TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' + ' ' +ISNULL (POBOX, ' ') + ' ' + ISNULL (ADDRESS1, ' ') + ' ' + ISNULL (ADDRESS2, ' ') + ' ' + ISNULL (EMIRATE , ' '), 'select', '') ADDRESS FROM PERSONAL_INFO PI,(SELECT ITEM as ADDITIONAL_INSURED  FROM FN_Split_SV((SELECT CASE WHEN NULLIF(A.ADDITIONAL_INSURED,'') IS NULL THEN convert(varchar,A.CUSTOMER_ID) ELSE  CONCAT(convert(varchar,A.CUSTOMER_ID) ,',' , A.ADDITIONAL_INSURED) END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO =? AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO = A.MISSIPPI_OPENCOVER_NO)),',')) AI WHERE PI.CUSTOMER_ID = AI.ADDITIONAL_INSURED and pi.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=pi.CUSTOMER_ID)
customer.opencover=SELECT UPPER (ISNULL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX,MOBILE,  UPPER(EMIRATE) as CITY_NAME ,UPPER(EMIRATE) as EMIRATE, CUSTOMER_ID,VAT_REG_NO, MISSIPPI_CUSTOMER_CODE,TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' + ' ' +ISNULL (POBOX, ' ') + ' ' + ISNULL (ADDRESS1, ' ') + ' ' + ISNULL (ADDRESS2, ' ') + ' ' + ISNULL (EMIRATE , ' '), 'select', '') ADDRESS FROM PERSONAL_INFO PI,(SELECT ITEM as ADDITIONAL_INSURED  FROM FN_Split_SV((SELECT CASE WHEN NULLIF(A.ADDITIONAL_INSURED,'') IS NULL THEN convert(varchar,A.CUSTOMER_ID) ELSE  CONCAT(convert(varchar,A.CUSTOMER_ID) ,',' , A.ADDITIONAL_INSURED) END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO =? AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO = A.MISSIPPI_OPENCOVER_NO)),',')) AI WHERE PI.CUSTOMER_ID = AI.ADDITIONAL_INSURED and pi.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=pi.CUSTOMER_ID)
##customer.opencover.byname=SELECT UPPER (ISNULL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX,MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE,TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' + ' ' +ISNULL (POBOX, ' ') + ' ' + ISNULL (ADDRESS1, ' ') + ' ' + ISNULL (ADDRESS2, ' ') + ' ' + ISNULL (EMIRATE , ' '), 'select', '') ADDRESS FROM PERSONAL_INFO PI,(SELECT ITEM as ADDITIONAL_INSURED  FROM FN_Split_SV((SELECT CASE WHEN NULLIF(A.ADDITIONAL_INSURED,'') IS NULL THEN A.CUSTOMER_ID ELSE A.CUSTOMER_ID + ' ' + ',' + ' ' + A.ADDITIONAL_INSURED END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO =? AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO = A.MISSIPPI_OPENCOVER_NO)),',')) AI WHERE PI.CUSTOMER_ID = AI.ADDITIONAL_INSURED and pi.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=pi.CUSTOMER_ID) AND UPPER(FIRST_NAME) LIKE UPPER(?) ORDER BY FIRST_NAME
customer.opencover.byname=SELECT UPPER (ISNULL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX,MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, VAT_REG_NO, MISSIPPI_CUSTOMER_CODE,TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' + ' ' +ISNULL (POBOX, ' ') + ' ' + ISNULL (ADDRESS1, ' ') + ' ' + ISNULL (ADDRESS2, ' ') + ' ' + ISNULL (EMIRATE , ' '), 'select', '') ADDRESS FROM PERSONAL_INFO PI,(SELECT ITEM as ADDITIONAL_INSURED  FROM FN_Split_SV((SELECT CASE WHEN NULLIF(A.ADDITIONAL_INSURED,'') IS NULL THEN A.CUSTOMER_ID ELSE A.CUSTOMER_ID + ' ' + ',' + ' ' + A.ADDITIONAL_INSURED END ADDITIONAL_INSURED FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO =? AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO = A.MISSIPPI_OPENCOVER_NO)),',')) AI WHERE PI.CUSTOMER_ID = AI.ADDITIONAL_INSURED and pi.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=pi.CUSTOMER_ID) AND UPPER(FIRST_NAME) LIKE UPPER(?) ORDER BY FIRST_NAME
customer.selection.common=SELECT UPPER(ISNULL(FIRST_NAME,COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2, REPLACE ( 'P.O.BOX.' + ' ' + ISNULL (POBOX, ' ') + ' ' + ISNULL (ADDRESS1, ' ') + ' ' + ISNULL ( ADDRESS2, ' ') + ' ' + ISNULL ((EMIRATE), ' '), 'select', '' ) ADDRESS FROM PERSONAL_INFO WHERE LOGIN_ID IN ( SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= ( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \=?)) AND APPLICATION_ID \='1' and AMEND_ID\=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID\=CUSTOMER_ID)
##customer.selection.byname=SELECT UPPER(FIRST_NAME) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2, REPLACE ( 'P.O.BOX.' + ' ' + ISNULL (POBOX, ' ') + ' ' + ISNULL (ADDRESS1, ' ') + ' ' + ISNULL ( ADDRESS2, ' ') + ' ' + ISNULL ((EMIRATE), ' '), 'select', '' ) ADDRESS FROM PERSONAL_INFO WHERE LOGIN_ID IN ( SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE \= ( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \=?)) AND APPLICATION_ID \='1' AND UPPER(FIRST_NAME) LIKE UPPER(?) ORDER BY FIRST_NAME
customer.selection.byname=SELECT CMP.[TITLE] TITLE,CMP.[BRKCODE]BROKERCODE,CMP.[COMPANY ID] MISSIPPI_CUSTOMER_CODE,CMP.[COMPANY NAME] FIRST_NAME,CMP.[COMPANYARA]COMPANYARABIC,CMP.[CONTPERSON]CONTACTPERSON,CMP.[CONTPERSONNO]CONTACTPERSONNO,CMP.[CPOSITION]OCCUPATION,CMP.[ADDRESS1] ADDRESS1,CMP.[ADDRESS2] ADDRESS2,CMP.[ADDRESS3]ADDRESS3,CMP.[ARADDRESS]ARABICADDRESS,CMP.[CITY] EMIRATE,CMP.[CITY] CITY_NAME,CMP.[ARCITY]ARABICCITY,CMP.[COUNTRY]COUNTRY,CMP.[ARCOUNTRY]ARABICCOUNTRY,CMP.[PHONE]PHONE,CMP.[FAX]FAX,'' MOBILE,CMP.[EMAIL] EMAIL,CMP.[DOB]DOB,CMP.[DOB_BL] DOB_BL,'' POBOX,'' CUST_AR_NO,'0' CUSTOMER_ID FROM [COMPANY MASTER] CMP,EMPCODE EMP WHERE CMP.[COMPANY NAME] LIKE(?) AND CMP.[COMPANY ID] NOT IN(EMP.EMACCODE) AND CMP.BRKCODE\=EMP.EMCODE 
customer.selection.coreAppCode=AND MISSIPPI_CUSTOMER_CODE LIKE ? ORDER BY FIRST_NAME
customer.selection.mobileNo=AND MOBILE LIKE ? ORDER BY FIRST_NAME
customer.selection.email=AND EMAIL LIKE ? ORDER BY FIRST_NAME
report.searchByQuote=select distinct * from search_list(?,?,?,?,?,?)
report.searchByPolicy=SELECT  distinct A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE,convert(varchar(10),M.INCEPTION_DATE,103) POLICY_START_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, convert(varchar(10),A.EFFECTIVE_DATE,103), ISNULL (M.OPEN_COVER_NO, '0'), (ISNULL (M.PREMIUM, 0) + ISNULL (M.EXCESS_PREMIUM, 0)) PREMIUM,convert(varchar(10),A.INCEPTION_DATE,103) INCEPTION_DATE,A.POLICY_NO,CASE WHEN A.STATUS\='Y' AND A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  \= 'N' THEN 'RA' ELSE A.STATUS END AS STATUS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND convert(varchar(10),A.EFFECTIVE_DATE,103) > \= convert(date,SYSDATETIME(),103) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND B.CUSTOMER_ID \= A.CUSTOMER_ID and B.AMEND_ID\=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID\=B.CUSTOMER_ID) AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND POLICY_NO LIKE ? ORDER BY QUOTE_NO DESC
report.searchByCustomer=select * from table(search_list(?,?,?,?,?,?))
search.issuer.brokerList=SELECT DISTINCT(A.LOGIN_ID) LOGIN_ID,D.USERNAME FROM POSITION_MASTER A,PERSONAL_INFO B,MARINE_DATA MD,BROKER_COMPANY_MASTER C, LOGIN_MASTER D WHERE A.PRODUCT_ID = ? AND (A.FREIGHT_STATUS NOT IN('F','B') OR A.FREIGHT_STATUS IS NULL) AND MD.APPLICATION_NO=A.APPLICATION_NO AND convert(varchar(10),A.EFFECTIVE_DATE,103) >= convert(varchar(10), SYSDATETIME(),103) AND A.APPLICATION_ID NOT IN (?,'1') AND C.AGENCY_CODE=D.OA_CODE AND C.BRANCH_CODE=? AND D.LOGIN_ID=A.LOGIN_ID
report.searchByQuoteOthers=SELECT  distinct A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE,convert(varchar(10),M.INCEPTION_DATE,103) POLICY_START_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, ISNULL (M.OPEN_COVER_NO, '0'), (ISNULL (M.PREMIUM, 0) + ISNULL (M.EXCESS_PREMIUM, 0)) PREMIUM,A.INCEPTION_DATE,A.POLICY_NO,CASE WHEN A.STATUS\='Y' AND A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  \= 'N' THEN 'RA' ELSE A.STATUS END AS STATUS,M.LC_NUMBER FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \=  SYSDATETIME()  AND M.APPLICATION_NO  \= A.APPLICATION_NO AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID NOT IN (?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND QUOTE_NO LIKE ? ORDER BY QUOTE_NO DESC
quotation.brokerloginId=SELECT LOGIN_ID FROM LOGIN_MASTER LM,BROKER_COMPANY_MASTER BCM WHERE LM.AGENCY_CODE\=BCM.AGENCY_CODE AND BCM.AGENCY_CODE\=?
GET_COUNT_LTSYSDATETIME()=SELECT COUNT(*) FROM DUAL WHERE SYSDATETIME()<dateadd(day,1,convert(date,?,103))
GET_B2C_LOGINID = SELECT REMARKS FROM CONSTANT_DETAIL WHERE CATEGORY_ID='154' AND CATEGORY_DETAIL_ID='1' AND BRANCH_CODE=?
GET_AGENCYCODE = SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=? 
GET_BROKERUSES=select ISNULL(BRANCH_CODE,'020') from BROKER_COMPANY_MASTER where AGENCY_CODE=(select oa_code FROM login_master where login_id=?)
GET_BROKERUSERDEF=select ISNULL(BRANCH_CODE,'020') from LOGIN_master where login_id=?
GET_DEFAULT_ID=select DETAIL_NAME from CONSTANT_DETAIL where CATEGORY_ID='116' and CATEGORY_DETAIL_ID=1 and status='Y'and branch_code=?
GET_BROKER_USERSDET=SELECT CURRENCY_ABBREVIATION,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,CURRENCY_ABBREVIATION,DECIMAL_PLACES,ISNULL(tax,'0') TAX,email,LANG_YN from BRANCH_MASTER where BRANCH_CODE=?
GET_LOG_USERTYPE=select USERTYPE from LOGIN_MASTER where LOGIN_ID=?
GET_PRODUCT_LIST_BRO=select product_id, product_name from product_master where status='Y' and branch_code=(SELECT   belonging_branch FROM   branch_master bm WHERE   branch_code = ? AND STATUS = 'Y'  AND amend_id =(SELECT   MAX (amend_id) FROM   branch_master bm1 WHERE   bm1.branch_code = bm.branch_code  AND bm1.status = bm.status)) and product_id in (select product_id from login_user_details where agency_code=(select agency_code from login_master where  login_id=?) and status='Y') order by DISPLAY_ORDER ASC
GET_PRODUCT_GET=select product_id from login_master where login_id\=? 
#TRAVEL & TRAVEL STANDARD
INS_HOME_CUS_DTL=INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,MOBILE,EMAIL,ADDRESS1,ADDRESS2,POBOX,EMIRATE,STATUS,ENTRY_DATE,LOGIN_ID,COMPANY_NAME,AGENCY_CODE,OA_CODE,MISSIPPI_CUSTOMER_CODE,CLIENT_CUSTOMER_ID,CUST_AR_NO,CUST_NAME) VALUES (?,'1',?,?,?,'0',?,?,?,?,?,?,'Y',SYSDATETIME(),?,?,(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),?,?,?,?)
UPD_HOME_CUS_DTL=UPDATE PERSONAL_INFO  SET APPLICATION_ID='1',TITLE=?,FIRST_NAME=?,LAST_NAME=?,MOBILE=?,STATUS='Y',EFFECTIVE_DATE=SYSDATETIME(),COMPANY_NAME=?,AGENCY_CODE=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),OA_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),CUST_NAME=?,CUSTOMER_TYPE=?,COMPANY_REG_NO=?,EMAIL=?,CUST_NAME_ARABIC=? WHERE CUSTOMER_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=CUSTOMER_ID)
INS_CUS_DTL=INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,NATIONALITY,DOB,GENDER,TELEPHONE,MOBILE,FAX,EMAIL,ADDRESS1,OCCUPATION,POBOX,COUNTRY,EMIRATE,STATUS,ENTRY_DATE,LOGIN_ID, COMPANY_NAME,ADDRESS2,CUSTOMER_SOURCE,AGENCY_CODE,OA_CODE)VALUES(?,'1',?,?,?,'0',?,CONVERT(DATE,?,103),?,?,?,?,?,?,?,?,?,?,'Y',CONVERT(VARCHAR,SYSDATETIME(),120),?, ?,?,?,'','')
UPD_CUS_DTL=UPDATE PERSONAL_INFO SET APPLICATION_ID='1',TITLE=?,FIRST_NAME=?,LAST_NAME=?,NATIONALITY=?,DOB=CONVERT(DATE,?,103),GENDER=?,TELEPHONE=?,MOBILE=?,FAX=?,EMAIL=?,ADDRESS1=?,OCCUPATION=?,POBOX=?,COUNTRY=?,EMIRATE=?,STATUS='Y',EFFECTIVE_DATE=convert(date,SYSDATETIME(),103),COMPANY_NAME=?,ADDRESS2=?,CUSTOMER_SOURCE=?,AGENCY_CODE='',OA_CODE='' WHERE CUSTOMER_ID=? AND AMEND_ID=?
GET_CUS_DTL_MAX_AMEND_ID=SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=?
GET_TODAY_DT=SELECT DATEPART(YEAR,SYSDATETIME()) YEAR,DATEPART(MONTH,SYSDATETIME()) MONTH,DATEPART(DAY,SYSDATETIME()) DAY
GET_AGE_CALC=SELECT DATEDIFF(YEAR,CONVERT(DATE,?,103),CONVERT(DATE,SYSDATETIME(),103 )) YEARS,DATEDIFF(MONTH,CONVERT(DATE,?,103),CONVERT(DATE,SYSDATETIME(),103 )) MONTHS,DATEDIFF(DAY,CONVERT(DATE,?,103),CONVERT(DATE,SYSDATETIME(),103 )) DAYS,? DAY 
GET_MINIUM_PREMIUM=SELECT  ISNULL(MIN_PREMIUM_AMOUNT, '0') FROM LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM,HOME_POSITION_MASTER HPM WHERE   LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID=HPM.LOGIN_ID AND HPM.APPLICATION_NO =? AND LUD.PRODUCT_ID = HPM.PRODUCT_ID AND HPM.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?) AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE PRODUCT_ID=LUD.PRODUCT_ID AND LOGIN_ID=LUD.LOGIN_ID)
GET_BROKER_COMMISSION=SELECT ISNULL(LUD.COMMISSION,0) FROM   LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM,HOME_POSITION_MASTER HPM WHERE   LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID=HPM.LOGIN_ID AND HPM.APPLICATION_NO =? AND LUD.PRODUCT_ID = HPM.PRODUCT_ID AND HPM.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=HPM.APPLICATION_NO) and HPM.PRODUCT_ID=?  AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE PRODUCT_ID=LUD.PRODUCT_ID AND LOGIN_ID=LUD.LOGIN_ID)
GET_POLICY_FEE=SELECT ISNULL(POLICY_FEE,'0') POLICY_FEE FROM BROKER_MASTER WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=(SELECT LOGIN_ID FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?)) AND POLICY_FEE_STATUS='Y' AND STATUS='Y' AND BRANCH_CODE=? AND EFFECTIVE_DATE<=SYSDATETIME() ORDER BY EFFECTIVE_DATE DESC
GET_NAJM_FEE=select isnull(NAJM_FEE,0)  from BROKER_MASTER  where AGENCY_CODE=(select lm.oa_code from home_position_master hpm,login_master lm where lm.login_id=hpm.login_id and hpm.application_no=? and hpm.PRODUCT_ID=?)

GET_POLICY_FEE_MOTOR=SELECT ISNULL(POLICY_FEE,'0') POLICY_FEE FROM BROKER_COMMISSION_DETAIL WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=(SELECT LOGIN_ID FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?)) AND POLICYTYPE=(SELECT ISSELECTCOVER FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO=?)
GET_NAJM_FEE_MOTOR=SELECT ISNULL(NAJM_FEE,'0') NAJM_FEE FROM BROKER_COMMISSION_DETAIL WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=(SELECT LOGIN_ID FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?)) AND POLICYTYPE=(SELECT ISSELECTCOVER FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO=?)

GET_POLICYFEE_PERCENT = SELECT PERCENTRATE FROM CONSTANT_DETAIL WHERE   CATEGORY_DETAIL_ID=1 AND BRANCH_CODE=? AND CATEGORY_ID=131
GET_DEBITNO_SEQ = Select policy_generate(''{1}'',''{0}'',''Debit'') from dual
GET_CERDITNO_SEQ = Select policy_generate(''{1}'',''{0}'',''Credit'') from dual
GET_SEQUENCE = policy_generate
UPD_TRAVEL_HEADER_PREMIUM=UPDATE TRAVEL_HEADER SET TRAVEL_HEADER.TOTAL_PREMIUM= ? WHERE TRAVEL_HEADER.APPLICATION_NO = ? AND TRAVEL_HEADER.AMEND_ID=( SELECT MAX(AMEND_ID) FROM TRAVEL_HEADER WHERE APPLICATION_NO = TRAVEL_HEADER.APPLICATION_NO)
UPD_TRAVEL_HEADER_OPTCOVER=UPDATE TH  SET SCHEME_ID=?,OPTIONAL_COVER=? FROM TRAVEL_HEADER TH WHERE TH.APPLICATION_NO = ? AND AMEND_ID=( SELECT MAX(AMEND_ID) FROM TRAVEL_HEADER TH1 WHERE TH1.APPLICATION_NO = TH.APPLICATION_NO)
UPD_HOME_POS_PREMIUM=UPDATE HOME_POSITION_MASTER SET PREMIUM = ? ,OVERALL_PREMIUM=isnull(?,0),POLICY_FEE=NULLIF(?,0),COMMISSION = ?,COMMISSION_PERCENTAGE=(SELECT ISNULL (COMMISSION, '0') COMMISSION FROM LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM WHERE LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID = ? AND LM.STATUS = 'Y' AND LUD.STATUS = 'Y' AND LUD.PRODUCT_ID =  ? AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=LUD.LOGIN_ID AND PRODUCT_ID=LUD.PRODUCT_ID)) WHERE APPLICATION_NO  = ?
CAL_TRAVEL_PREMIUM_CALC={CALL TRAVEL_PREMIUM_CALC_ENDT(?,?,?,?,?,?)}
UPD_HOME_POS_PREMIUM_TR=UPDATE HOME_POSITION_MASTER SET PREMIUM = ? ,OVERALL_PREMIUM=isnull(?,0),VAT_PREMIUM=0,POLICY_FEE=NULLIF(?,0),COMMISSION = ?,COMMISSION_PERCENTAGE=? WHERE APPLICATION_NO  = ?

##INS_TRAVEL_DTL=INSERT INTO TRAVEL_DETAIL(APPLICATION_NO,QUOTE_NO,SERIAL_NO,PASSENGER_NAME,DOB,AMEND_ID,STATUS,RELATION,GENDER,NATIONALITY,AGE,TYPE) VALUES(?,?,?,?,CONVERT(DATE,?,103),?,?,?,?,?,?,(CASE WHEN ? <= 2 THEN 'C' WHEN ? BETWEEN 3 AND 18 THEN 'C' WHEN ? >=19 THEN 'A' END))
##UPD_TRAVEL_DTL=UPDATE TRAVEL_DETAIL SET PASSENGER_NAME=?,DOB=CONVERT(DATE,?,103),AMEND_ID=?,STATUS=?,RELATION=?,GENDER=?,NATIONALITY=?,AGE=?,QUOTE_NO=?,TYPE=(CASE WHEN ? <= 2 THEN 'C' WHEN ? BETWEEN 3 AND 18 THEN 'C' WHEN ? >=19 THEN 'A' END) WHERE APPLICATION_NO=? AND SERIAL_NO=?
INS_TRAVEL_DTL=INSERT INTO TRAVEL_DETAIL(APPLICATION_NO,QUOTE_NO,SERIAL_NO,PASSENGER_NAME,DOB,AMEND_ID,STATUS,RELATION,GENDER,NATIONALITY,AGE,TYPE,PASSPORT_NO,PASSPORT_EXP_DATE,PASSANGER_LAST_NAME) VALUES(?,?,?,?,CONVERT(DATE,?,103),?,?,?,?,?,?,(CASE WHEN ? <= 2 THEN 'C' WHEN ? BETWEEN 3 AND 18 THEN 'C' WHEN ? >=19 THEN 'A' END),?,CONVERT(DATE,?,103),?)
UPD_TRAVEL_DTL=UPDATE TRAVEL_DETAIL SET PASSENGER_NAME=?,DOB=CONVERT(DATE,?,103),AMEND_ID=?,STATUS=?,RELATION=?,GENDER=?,NATIONALITY=?,AGE=?,QUOTE_NO=?,TYPE=(CASE WHEN ? <= 2 THEN 'C' WHEN ? BETWEEN 3 AND 18 THEN 'C' WHEN ? >=19 THEN 'A' END),PASSPORT_NO=?,PASSPORT_EXP_DATE=CONVERT(DATE,?,103),PASSANGER_LAST_NAME=? WHERE APPLICATION_NO=? AND SERIAL_NO=?
GET_SLNO_TRAVEL_DTL=SELECT ISNULL(MAX(SERIAL_NO),'0')+1 FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?
DEL_TRAVEL_DTL=DELETE FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND SERIAL_NO IN(select * from FN_Split_SV(?,','))
GET_COVERAGES_NAMES=SELECT DISTINCT SCHEME_ID,SCHEME_NAME,PREMIUM,ISNULL(REF_STATUS,'N') REFYN from TRAVEL_POLICY_COVERAGE WHERE  APPLICATION_NO=? AND OPTION_ID=? AND STATUS='Y' AND GROUP_ID=0  ORDER BY PREMIUM DESC
GET_COVERAGES_DTLS=SELECT Y_ID,Y_DATA_NAME,PREMIUM,IS_SELECTED,IS_ADDON,DELETABLE,GROUP_ID,ISNULL(REF_STATUS,'N') REFYN from TRAVEL_POLICY_COVERAGE WHERE  APPLICATION_NO=? AND SCHEME_ID=? AND  OPTION_ID=? AND STATUS='Y' ORDER BY GROUP_ID
DEL_TRAVEL_DTL_ALL=DELETE FROM TRAVEL_DETAIL WHERE APPLICATION_NO\=? AND SERIAL_NO NOT IN( 
UPD_TRAVEL_DTL_ADMIN=UPDATE TRAVEL_DETAIL SET PREMIUM=?,PASSENGER_NAME=?,DOB=CONVERT(DATE,?,103),RELATION=?,GENDER=?,NATIONALITY=?,AGE=?,TYPE=(CASE WHEN ? <= 2 THEN 'C' WHEN ? BETWEEN 3 AND 18 THEN 'C' WHEN ? >=19 THEN 'A' END),PASSPORT_NO=?,PASSPORT_EXP_DATE=CONVERT(DATE,?,103),PASSANGER_LAST_NAME=? WHERE APPLICATION_NO=? AND SERIAL_NO=?
GET_TRAVEL_DTL=SELECT TD.APPLICATION_NO,TD.QUOTE_NO,TD.SERIAL_NO,TD.PASSENGER_NAME,TD.PASSANGER_LAST_NAME,convert(varchar(10),TD.DOB,103) DOB,TD.RELATION,TD.GENDER,TD.NATIONALITY,TD.PREMIUM,TD.PASSPORT_NO,convert(varchar(10),TD.PASSPORT_EXP_DATE,103) PASSPORT_EXP_DATE,PASSANGER_LAST_NAME FROM TRAVEL_DETAIL TD WHERE TD.APPLICATION_NO=? AND TD.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=TD.APPLICATION_NO) ORDER BY TD.SERIAL_NO
GET_TRAVEL_DTL_CNT=SELECT COUNT(*) CT FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND SERIAL_NO=?
INS_TRAVEL_HEADER=INSERT INTO TRAVEL_HEADER(APPLICATION_NO,QUOTE_NO,TOTAL_ADULT_PASSENGERS,TOTAL_CHILD_PASSENGERS,TOTAL_NO_OF_PEOPLE_COVERED,POLICY_TERM,CLAIM_Y_N,CLAIM_REMARKS,CLAIM_AMOUNT,INSURANCE_START_DATE,INSURANCE_END_DATE,ENTRY_DATE,EFFECTIVE_DATE,AMEND_ID,CUSTOMER_ID,LOGIN_ID,STATUS,PRODUCTID,SCHEME_COVER,COUNTRY_ORIGIN,COUNTRY_DESTN,SCHEME_ID,OPTION_ID,DISCOUNT_TYPE) VALUES(?,?,(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A'),(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C')),(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?),?,?,?,?,CONVERT(DATE,?,103),CONVERT(DATE,?,103),SYSDATETIME(),SYSDATETIME(),?,?,?,?,?,?,?,?,?,?,(CASE WHEN ('4'=? AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C','A') AND RELATION='3')>0 AND (select COUNT(*) from TRAVEL_DETAIL td WHERE APPLICATION_NO=? and RELATION='3' and AGE > 18 ) <= 0) THEN 'F' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)=(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND (RELATION IN('1','2'))) THEN '' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)>100 THEN 'G' ELSE '' END))
UPD_TRAVEL_HEADER=UPDATE TRAVEL_HEADER SET TOTAL_ADULT_PASSENGERS = (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A'),TOTAL_CHILD_PASSENGERS = (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C')) ,TOTAL_NO_OF_PEOPLE_COVERED = (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?) ,POLICY_TERM =  ? ,CLAIM_Y_N = ? ,CLAIM_REMARKS = ?,CLAIM_AMOUNT = ?,INSURANCE_START_DATE = CONVERT(DATE,?,103),INSURANCE_END_DATE = CONVERT(DATE,?,103) ,EFFECTIVE_DATE =convert(date,SYSDATETIME(),103),PRODUCTID = ? ,AMEND_ID = 0 ,SCHEME_COVER = ?,COUNTRY_ORIGIN=?,COUNTRY_DESTN=?,QUOTE_NO=?,SCHEME_ID=?,OPTION_ID=?,DISCOUNT_TYPE=(CASE WHEN ('4'=? AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE IN ('I','C','A') AND RELATION='3')>0 AND (select COUNT(*) from TRAVEL_DETAIL td WHERE APPLICATION_NO=? and RELATION='3' and AGE > 18 ) <= 0 ) THEN 'F' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='1')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND RELATION='2')>=1 AND (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)=(SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=? AND TYPE='A' AND (RELATION IN('1','2'))) THEN '' WHEN (SELECT COUNT(*) FROM TRAVEL_DETAIL WHERE APPLICATION_NO=?)>100 THEN 'G' ELSE '' END),OPTIONAL_COVER='' WHERE  APPLICATION_NO= ? AND STATUS = 'Y'
GET_TRAVEL_HEADER=SELECT POLICY_TERM,convert(varchar(10),INSURANCE_START_DATE,103) INSURANCE_START_DATE,convert(varchar(10),INSURANCE_END_DATE,103) INSURANCE_END_DATE,SCHEME_COVER,ISNULL(TOTAL_PREMIUM,'0') TOTAL_PREMIUM,SCHEME_ID,OPTION_ID,ISNULL(DISCOUNTED_VALUE,'0') DISCOUNTED_VALUE, CASE WHEN DISCOUNT_TYPE='F' THEN 'Family' ELSE 'None' END DISCOUNT_TYPE,OPTIONAL_COVER FROM TRAVEL_HEADER WHERE APPLICATION_NO=?
INS_HOME_POS_MASTER_REF=INSERT INTO HOME_POSITION_MASTER(APPLICATION_NO,QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,BRANCH_CODE,POLICY_TERM,AMEND_ID,EFFECTIVE_DATE,EXPIRY_DATE,INCEPTION_DATE,ENTRY_DATE,STATUS,APPLICATION_ID,AGE_ABOVE_SIXTY_FIVE,EXISTING_MEDICAL_CONDITION,SCHEME_ID,REMARKS,REFERRAL_DESCRIPTION,PROPOSAL_NO,ADMIN_REFERRAL_STATUS,COMPANY_ID,BROKER_CODE,AC_EXECUTIVE_ID,Linked_brnch_code) VALUES(?,?,?,?,?,?,?,?,DATEADD(DAY,30,SYSDATETIME()),CONVERT(DATE,?,103),CONVERT(DATE,?,103),SYSDATETIME(),?,?,?,?,?,'Referal',?,?,'Y','1',?,?,(select SUB_BRANCH from login_master where AGENCY_CODE=(select OA_CODE from LOGIN_MASTER where LOGIN_ID=?)))
INS_HOME_POS_MASTER=INSERT INTO HOME_POSITION_MASTER(APPLICATION_NO,QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,BRANCH_CODE,POLICY_TERM,AMEND_ID,EFFECTIVE_DATE,EXPIRY_DATE,INCEPTION_DATE,ENTRY_DATE,STATUS,APPLICATION_ID,AGE_ABOVE_SIXTY_FIVE,EXISTING_MEDICAL_CONDITION,SCHEME_ID,ADMIN_REMARKS,PROPOSAL_NO,COMPANY_ID,BROKER_CODE,AC_EXECUTIVE_ID,Linked_brnch_code) VALUES(?,?,?,?,?,?,?,?,DATEADD(DAY,30,SYSDATETIME()),CONVERT(DATE,?,103),CONVERT(DATE,?,103),SYSDATETIME(),?,?,?,?,?,?,?,'1',?,?,(select SUB_BRANCH from login_master where AGENCY_CODE=(select OA_CODE from LOGIN_MASTER where LOGIN_ID=?)))
UPD_HOME_POS_MASTER_REF=UPDATE HOME_POSITION_MASTER SET AGE_ABOVE_SIXTY_FIVE = ?, INCEPTION_DATE =CONVERT(DATE,?,103), EXISTING_MEDICAL_CONDITION = ?, EXPIRY_DATE =CONVERT(DATE,?,103), EFFECTIVE_DATE = DATEADD(DAY,30,SYSDATETIME()) , SCHEME_ID = ?, POLICY_TERM = ? ,PRODUCT_ID = ?, REFERRAL_DESCRIPTION = ?,ADMIN_REFERRAL_STATUS='Y',REMARKS = 'Referal',PREMIUM=NULL,OVERALL_PREMIUM=NULL,PROPOSAL_NO = ?,QUOTE_NO=?,STATUS=? WHERE  APPLICATION_NO = ?
UPD_HOME_POS_MASTER=UPDATE HOME_POSITION_MASTER SET AGE_ABOVE_SIXTY_FIVE = ? ,INCEPTION_DATE=CONVERT(DATE,?,103),EXISTING_MEDICAL_CONDITION = ? ,EXPIRY_DATE=CONVERT(DATE,?,103),EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),SCHEME_ID = ? ,POLICY_TERM= ? ,PRODUCT_ID = ? ,ADMIN_REMARKS = ? ,REFERRAL_DESCRIPTION=NULL,REMARKS=NULL,ADMIN_REFERRAL_STATUS=NULL,PREMIUM=NULL,OVERALL_PREMIUM=NULL,PROPOSAL_NO = ?,QUOTE_NO=?,STATUS=?,BROKER_CODE=?,AC_EXECUTIVE_ID=?  WHERE  APPLICATION_NO = ?
UPD_HOME_POS_MASTER_ADMIN=UPDATE HOME_POSITION_MASTER SET AGE_ABOVE_SIXTY_FIVE = ? ,INCEPTION_DATE=CONVERT(DATE,?,103),EXISTING_MEDICAL_CONDITION = ? ,EXPIRY_DATE=CONVERT(DATE,?,103),EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),SCHEME_ID = ? ,POLICY_TERM= ? ,PRODUCT_ID = ? ,APPROVED_BY = ?,PROPOSAL_NO = ?,QUOTE_NO=?,STATUS=?  WHERE  APPLICATION_NO = ?
DEL_TRAVEL_COVER_DTLS=DELETE FROM TRAVEL_COVERAGES_DETAIL WHERE APPLICATION_NO=? AND COVERAGES_ID NOT IN(
DEL_ALL_TRAVEL_COVER_DTLS=DELETE FROM TRAVEL_COVERAGES_DETAIL WHERE APPLICATION_NO\=? 
GET_TRAVEL_COVER_CNT=SELECT COUNT(*) CNT FROM TRAVEL_COVERAGES_DETAIL WHERE APPLICATION_NO=? AND COVERAGES_ID=?
INS_TRAVEL_COVER_DTLS=INSERT INTO TRAVEL_COVERAGES_DETAIL(APPLICATION_NO,QUOTE_NO,PRODUCT_ID,COVERAGES_ID,COVER_NAME,STATUS) VALUES(?,?,?,?,?,?)
UPD_TRAVEL_COVER_DTLS=UPDATE TRAVEL_COVERAGES_DETAIL SET QUOTE_NO=?,PRODUCT_ID=?,COVER_NAME=?,STATUS=? WHERE APPLICATION_NO=? AND COVERAGES_ID=?
UPD_TRAVEL_COVER_DTLS_ADMIN=UPDATE TRAVEL_COVERAGES_DETAIL SET PREMIUM=? WHERE APPLICATION_NO=? AND COVERAGES_ID=?
GET_TRAVEL_COVER_DTLS=SELECT STATUS,COVERAGES_ID,PREMIUM FROM TRAVEL_COVERAGES_DETAIL WHERE APPLICATION_NO=? ORDER BY COVERAGES_ID
GET_SEQ_ID1=SELECT SEQ_NAME,POLICY_PREFIX FROM SEQUENCE_MASTER WHERE SEQ_ID\=(SELECT 
GET_SEQ_ID2=FROM BRANCH_DETAIL BD WHERE BRANCH_CODE=? AND PRODUCT_ID=? AND BD.AMEND_ID =(SELECT MAX(AMEND_ID) FROM BRANCH_DETAIL WHERE BRANCH_CODE=BD.BRANCH_CODE AND PRODUCT_ID=BD.PRODUCT_ID )) AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS='Y'
GET_MAX_SEQ_ID1=SELECT 
GET_MAX_SEQ_ID2=.NEXTVAL FROM DUAL
GET_MAX_ID1=SELECT ISNULL(POLICY_PREFIX,'') PREFIX,ISNULL(CURRENT_NO+1,START_NO) MAXNO FROM POLICYNO_GENERATE WHERE TYPE_ID\=(SELECT 
GET_MAX_ID2=FROM BRANCH_DETAIL WHERE BRANCH_CODE=? AND PRODUCT_ID=?) AND STATUS='Y' AND BRANCH_CODE=? AND PRODUCT_ID=?
UPD_MAX_ID1=UPDATE POLICYNO_GENERATE SET CURRENT_NO\=?,REMARKS\=? WHERE TYPE_ID\=(SELECT  
UPD_MAX_ID2=FROM BRANCH_DETAIL WHERE BRANCH_CODE\=? AND PRODUCT_ID\=?) AND STATUS\='Y' AND BRANCH_CODE\=? AND PRODUCT_ID\=?
GET_SEARCH1=SELECT PI.CUSTOMER_ID,PI.TITLE,PI.GENDER,PI.FIRST_NAME,PI.LAST_NAME,PI.NATIONALITY,replace(convert(varchar(10),PI.DOB,103),'01/01/1900','') AS DOB,PI.TELEPHONE,PI.MOBILE,PI.FAX,PI.EMAIL,PI.ADDRESS1,PI.OCCUPATION,PI.EMIRATE,PI.COUNTRY,PI.POBOX,PI.COMPANY_NAME,PI.ADDRESS2,PI.CUSTOMER_SOURCE FROM PERSONAL_INFO PI ,LOGIN_MASTER LM1 ,LOGIN_MASTER LM2 WHERE LM1.OA_CODE=LM2.OA_CODE AND LM2.LOGIN_ID=? AND LM1.LOGIN_ID NOT IN ('NONE', 'NON') AND PI.LOGIN_ID=LM1.LOGIN_ID AND (LOWER(PI.FIRST_NAME) LIKE ISNULL(LOWER(?),'(%') OR LOWER(PI.COMPANY_NAME) LIKE ISNULL(LOWER(?),'(%') OR PI.EMAIL LIKE ISNULL(LOWER(?),'(%') OR PI.MOBILE LIKE ISNULL(LOWER(?),'(%') OR PI.TELEPHONE LIKE ISNULL(LOWER(?),'(%') OR PI.DOB=CONVERT(DATE,?,103) OR PI.CUSTOMER_SOURCE LIKE ISNULL(LOWER(?),'(%')) AND PI.APPLICATION_ID='1' AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
GET_SEARCH2=SELECT PI.CUSTOMER_ID,PI.TITLE,PI.GENDER,PI.FIRST_NAME,PI.LAST_NAME,PI.NATIONALITY,replace(convert(varchar(10),PI.DOB,103),'01/01/1900','') AS DOB,PI.TELEPHONE,PI.MOBILE,PI.FAX,PI.EMAIL,PI.ADDRESS1,PI.OCCUPATION,PI.EMIRATE,PI.COUNTRY,PI.POBOX,PI.COMPANY_NAME,PI.ADDRESS2,PI.CUSTOMER_SOURCE FROM PERSONAL_INFO PI ,LOGIN_MASTER LM1 ,LOGIN_MASTER LM2 WHERE LM1.OA_CODE=LM2.OA_CODE AND LM2.LOGIN_ID=? AND LM1.LOGIN_ID NOT IN ('NONE', 'NON') AND PI.LOGIN_ID=LM1.LOGIN_ID AND PI.CUSTOMER_SOURCE=?  AND PI.CUSTOMER_ID<> ? AND PI.APPLICATION_ID='1' AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
GET_SEARCH3=SELECT CUSTOMER_ID,TITLE,GENDER,FIRST_NAME,LAST_NAME,NATIONALITY,CONVERT(VARCHAR,PI.DOB,103) AS DOB,TELEPHONE,MOBILE,FAX,EMAIL,ADDRESS1,OCCUPATION,EMIRATE,COUNTRY,POBOX,COMPANY_NAME,ADDRESS2,CUSTOMER_SOURCE FROM PERSONAL_INFO PI WHERE CUSTOMER_ID=? AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
GET_BACK_DATE_ALLOWED=SELECT distinct(BACK_DATE_ALLOWED) FROM LOGIN_USER_DETAILS LUD WHERE AGENCY_CODE IN(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID =?) AND PRODUCT_ID =? AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=LUD.LOGIN_ID AND PRODUCT_ID=LUD.PRODUCT_ID)
GET_COVER_NAME_TRAVEL=SELECT SC.SCHEME_NAME,OP.OPTION_NAME FROM TRAVEL_SCHEME_COVERS SC,TRAVEL_OPTION_COVERS OP WHERE SC.SCHEME_ID\=? AND OP.OPTION_ID\=? AND SC.BRANCH_CODE \=? AND SC.STATUS \= 'Y' AND SC.PRODUCT_CODE\=? AND OP.BRANCH_CODE \=? AND OP.STATUS\='Y' and SC.AMEND_ID\=(select max(amend_id) from travel_scheme_covers where SCHEME_ID \= sc.SCHEME_ID and status\='Y' ) and OP.AMEND_ID\=(select max(amend_id) from TRAVEL_OPTION_COVERS where OPTION_ID \= OP.OPTION_ID and status\='Y' ) 
##AND SC.EFFECTIVE_DATE < sysdatetime()
GET_REFERAL_YN=SELECT ISNULL(REFERAL,'N') REFERAL FROM LOGIN_MASTER WHERE AGENCY_CODE=(select OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GET_TRAVELCOVERAGES=SELECT TMC.COVERAGES_ID,TMC.COVERAGES_VALUE, TMC.COVERAGES_NAME,TSOC.COVER_ID FROM TRAVEL_MAS_COVERAGES TMC, TRAVEL_LINK_COVERAGES TLC, TRAVEL_SCHEME_OPTION_COVERS TSOC WHERE TMC.COVERAGES_ID \= TLC.COVERAGES_ID AND TLC.COVER_ID \= TSOC.COVER_ID AND TSOC.SCHEME_ID \= ? AND TSOC.OPTION_ID \= ? AND TSOC.PRODUCT_CODE \= ? AND TLC.PRODUCT_CODE \= ? AND TSOC.BRANCH_CODE\=? AND TLC.BRANCH_CODE\=? AND TLC.STATUS\='Y' AND TLC.amend_id\=(SELECT MAX(amend_id) FROM TRAVEL_LINK_COVERAGES WHERE BRANCH_CODE\=TLC.BRANCH_CODE AND PRODUCT_CODE\=TLC.PRODUCT_CODE AND COVER_ID\=TLC.COVER_ID) AND TMC.AMEND_ID \=(SELECT MAX(AMEND_ID) FROM TRAVEL_MAS_COVERAGES WHERE COVERAGES_ID\=TMC.COVERAGES_ID)  AND TMC.BRANCH_CODE\=? AND TMC.STATUS\='Y'  ORDER BY COVERAGES_ID 
UPD_HOME_POS_MASTER_MODEOFPAY=UPDATE HOME_POSITION_MASTER SET SUMMARY_CLAUSES=?,AIRMILES_NO=?, INSURANCE_DETAILS=?,PAYMENT_MODE=?,CSH_ID_TYP_CODE=?,EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()) WHERE QUOTE_NO=?
GET_POLICY_STATUS=SELECT ISNULL(STATUS,'Y') STATUS,POLICY_NO,RECEIPT_NO,DEBIT_NOTE_NO,CREDIT_NO,DEBIT_TO,CREDIT_TO,DEBIT_TO_ID,CREDIT_TO_ID FROM HOME_POSITION_MASTER WHERE QUOTE_NO=? AND (PRODUCT_ID=? OR PROPOSAL_NO=?)
##UPD_POLICY_NO=UPDATE HOME_POSITION_MASTER SET POLICY_NO=?,RECEIPT_NO=?,DEBIT_NOTE_NO=?,DEBIT_NOTE_DATE=SYSDATETIME(),RECEIPT_DATE=SYSDATETIME(),STATUS='P',EFFECTIVE_DATE=SYSDATETIME(),PAYMENT_MODE=?,CREDIT_NO=?,CREDIT_DATE=SYSDATETIME() WHERE QUOTE_NO=?
UPD_POLICY_NO=UPDATE HOME_POSITION_MASTER SET POLICY_NO=?,RECEIPT_NO=?,DEBIT_NOTE_NO=?,DEBIT_NOTE_DATE=SYSDATETIME(),RECEIPT_DATE=SYSDATETIME(),STATUS=?, EFFECTIVE_DATE=SYSDATETIME(),PAYMENT_MODE=?,CREDIT_NO=?,CREDIT_DATE= SYSDATETIME(),DEBIT_TO=?, CREDIT_TO=?, DEBIT_TO_ID=?, CREDIT_TO_ID= ? WHERE QUOTE_NO=?
GET_POLICY_STATUS_COUNT = SELECT COUNT(*) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=? AND QUOTE_NO=? AND STATUS='P' AND POLICY_NO IS NOT NULL
GET_RSACODE=SELECT ISNULL(PM.RSACODE,0) FROM PRODUCT_MASTER PM,HOME_POSITION_MASTER HPM WHERE HPM.QUOTE_NO=? AND PM.STATUS='Y' AND PM.BRANCH_CODE=? AND PM.PRODUCT_ID=ISNULL(HPM.PROPOSAL_NO,HPM.PRODUCT_ID) AND PM.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PRODUCT_MASTER where PRODUCT_ID=pm.PRODUCT_ID AND BRANCH_CODE = PM.BRANCH_CODE )
GET_CLOSE_TRNRSACODE=SELECT CONVERT (varchar (4), DATEPART (year, TRN.CLO_DATE_OPENED))  OPEN_YEARS, convert(varchar(4),DATEPART(year,TRN.CLO_DATE_CLOSED) ) CLOSE_YEARS, Convert(varchar(2),DATEPART(MONTH,TRN.CLO_DATE_CLOSED) ) CLOSE_MONTHS,Convert(varchar(2),DATEPART(DAY,TRN.CLO_DATE_CLOSED))   CLOSE_DAYS,convert(varchar(4),DATEPART(year,TRN.CLO_DATE_OPENED) ),Convert(varchar(2),DATEPART(MONTH, TRN.CLO_DATE_OPENED))  OPEN_MONTHS,Convert(varchar(2),DATEPART(MONTH,TRN.CLO_DATE_OPENED)) OPEN_DAYS FROM T_TRN_CLOSING TRN,PRODUCT_MASTER PM,HOME_POSITION_MASTER HPM WHERE PM.BRANCH_CODE=TRN.BRANCH_CODE AND TRN.BRANCH_CODE=? AND PM.PRODUCT_ID=ISNULL(HPM.PROPOSAL_NO,HPM.PRODUCT_ID) AND  PM.RSACODE=TRN.PRODUCT_CORE_CODE AND PM.RSACODE=? AND HPM.QUOTE_NO=? AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PRODUCT_MASTER WHERE PRODUCT_ID=PM.PRODUCT_ID AND BRANCH_CODE = PM.BRANCH_CODE )
GET_CLOSE_TRN=SELECT EXTRACT(YEAR AS TRN.CLO_DATE_CLOSED) AS CLOSE_YEARS,EXTRACT(MONTH AS TRN.CLO_DATE_CLOSED) AS CLOSE_MONTHS,EXTRACT(DAY AS TRN.CLO_DATE_CLOSED) AS CLOSE_DAYS,EXTRACT(YEAR AS TRN.CLO_DATE_OPENED) AS OPEN_YEARS,EXTRACT(MONTH AS TRN.CLO_DATE_OPENED) AS OPEN_MONTHS,EXTRACT(DAY ASTRN.CLO_DATE_OPENED) AS OPEN_DAYS FROM T_TRN_CLOSING TRN, PRODUCT_MASTER PM, HOME_POSITION_MASTER HPM WHERE PM.BRANCH_CODE = TRN.BRANCH_CODE AND TRN.BRANCH_CODE = ? AND PM.PRODUCT_ID = ISNULL (HPM.PROPOSAL_NO, HPM.PRODUCT_ID) AND PM.RSACODE = TRN.PRODUCT_CORE_CODE AND HPM.QUOTE_NO IN (?) AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PRODUCT_MASTER WHERE PRODUCT_ID = PM.PRODUCT_ID AND EFFECTIVE_DATE = PM.EFFECTIVE_DATE ) AND (PM.EFFECTIVE_DATE) <= (SYSDATETIME()) AND PM.STATUS='Y'
UPD_HPMDATE_QUOTENO=UPDATE HOME_POSITION_MASTER SET POLICY_DATE=CONVERT(VARCHAR,?,103),EFFECTIVE_DATE=CONVERT(VARCHAR,?,103)  WHERE  QUOTE_NO=?
UPD_HPMDATE_POLICYNO=UPDATE HOME_POSITION_MASTER SET POLICY_DATE=CONVERT(VARCHAR,?,103)),EFFECTIVE_DATE=CONVERT(VARCHAR,?,103)  WHERE  POLICY_NO=?
GET_POLICYINFO=SELECT HPM.CREDIT_NO CREDIT_NOTE_NO,HPM.QUOTE_NO,CASE WHEN HPM.STATUS\='D' THEN NULL ELSE HPM.POLICY_NO END POLICY_NO,HPM.RECEIPT_NO,HPM.DEBIT_NOTE_NO,CONVERT(VARCHAR,DATEADD(DAY,30,HPM.ENTRY_DATE),103) QUOTE_DATE,CONVERT(VARCHAR,HPM.ENTRY_DATE,103) POL_DATE,PI.FIRST_NAME + ' ' +' '+ ' ' +ISNULL(PI.LAST_NAME,'') PROPOSER_NAME,CONVERT(VARCHAR,HPM.INCEPTION_DATE,103) COVER_START_DATE,CONVERT(VARCHAR,HPM.EXPIRY_DATE,103) COVER_END_PERIODS,(CASE WHEN (HPM.STATUS IN ('Y','E') AND ((HPM.REMARKS IN ('Referal') AND HPM.ADMIN_REFERRAL_STATUS \= 'N') OR (HPM.REMARKS IN ('Admin','Normal', 'Referal') AND HPM.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN 'Y' ELSE 'N' END) STATUS,HPM.STATUS SHOW_STATUS,CASE WHEN HPM.AMEND_ID\=0 THEN HPM.OVERALL_PREMIUM ELSE HPM.ENDT_PREMIUM+HPM.POLICY_FEE END PREMIUM,HPM.LOGIN_ID,MPD.ISSELECTCOVER ISSELECTCOVER FROM  HOME_POSITION_MASTER HPM,PERSONAL_INFO PI,MOTOR_POLICY_DETAILS MPD WHERE HPM.QUOTE_NO\=? AND PI.CUSTOMER_ID\=HPM.CUSTOMER_ID AND PI.STATUS\='Y' AND PI.AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) and MPD. APPLICATIONNO\=HPM.APPLICATION_NO
GET_POLICYINFO_TRAVEL=SELECT HPM.CREDIT_NO CREDIT_NOTE_NO,HPM.QUOTE_NO,CASE WHEN HPM.STATUS\='D' THEN HPM.POLICY_NO ELSE HPM.POLICY_NO END POLICY_NO,HPM.RECEIPT_NO,HPM.DEBIT_NOTE_NO,CONVERT(VARCHAR,DATEADD(DAY,30,HPM.EFFECTIVE_DATE),103) QUOTE_DATE,CONVERT(VARCHAR,HPM.EFFECTIVE_DATE,103) POL_DATE,PI.FIRST_NAME + ' ' +' '+ ' ' +ISNULL(PI.LAST_NAME,'') PROPOSER_NAME,CONVERT(VARCHAR,HPM.INCEPTION_DATE,103) COVER_START_DATE,CONVERT(VARCHAR,HPM.EXPIRY_DATE,103) COVER_END_PERIODS,(CASE WHEN (HPM.STATUS IN ('Y','E') AND ((HPM.REMARKS IN ('Referal') AND HPM.ADMIN_REFERRAL_STATUS \= 'N') OR (HPM.REMARKS IN ('Admin','Normal', 'Referal') AND HPM.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN 'Y' ELSE 'N' END) STATUS,HPM.STATUS SHOW_STATUS,CASE WHEN HPM.AMEND_ID\=0 THEN HPM.OVERALL_PREMIUM ELSE HPM.ENDT_PREMIUM+HPM.POLICY_FEE END PREMIUM,HPM.LOGIN_ID FROM  HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE HPM.QUOTE_NO\=? AND PI.CUSTOMER_ID\=HPM.CUSTOMER_ID AND PI.STATUS\='Y' AND PI.AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID)
UPD_REF_STATUS=UPDATE HOME_POSITION_MASTER SET EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),REMARKS=?,SUMMARY_REMARKS= ?,ADMIN_REFERRAL_STATUS = ?, REFERRAL_DESCRIPTION = ? WHERE QUOTE_NO = ?
GET_HOME_POS_DET=SELECT PI.CUSTOMER_ID,PI.FIRST_NAME+ ' ' +' '+ ' ' +ISNULL(PI.LAST_NAME,'') CUS_NAME,PI.MOBILE, PI.EMAIL,HPM.APPLICATION_NO, HPM.SUMMARY_REMARKS,ISNULL(HPM.PAYMENT_MODE,'Cash') PAYMENT_MODE,HPM.PREMIUM,HPM.EXCESS_PREMIUM,HPM.EXCESS_SIGN,HPM.OVERALL_PREMIUM,hpm.VAT_PREMIUM,(CASE WHEN (HPM.STATUS='Y') THEN CASE WHEN HPM.REMARKS IN ('Referal') THEN 'A' ELSE 'Y' END ELSE 'N' END) ADMIN_REFERRAL_STATUS,ISNULL(HPM.ADMIN_REFERRAL_STATUS,'N') ADMIN_REFERRAL_YN,HPM.ADMIN_REMARKS,HPM.POLICY_FEE,HPM.REMARKS REMARKS,HPM.POLICY_NO,HPM.ENDT_PREMIUM,HPM.AMEND_ID,HPM.REFERRAL_DESCRIPTION,HPM.STATUS STATUS FROM HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE PI.CUSTOMER_ID=HPM.CUSTOMER_ID AND HPM.QUOTE_NO=? AND HPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE QUOTE_NO=HPM.QUOTE_NO) AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
UPD_EXCESS_PREMIUM=UPDATE TRAVEL_HEADER SET DISCOUNTED_VALUE=?,TOTAL_PREMIUM=? WHERE QUOTE_NO=?
UPD_ADMIN_REFSTATUS=UPDATE HOME_POSITION_MASTER SET REMARKS=?,ADMIN_REMARKS=?,EXCESS_PREMIUM=?,ADMIN_REFERRAL_STATUS='N',STATUS=?,EXCESS_SIGN=?,EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),OVERALL_PREMIUM=?,COMMISSION=?,APPROVED_BY=(SELECT ISNULL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?),PREMIUM=?,DISCOUNT_PREMIUM=?,ENDT_PREMIUM=?,ENDT_COMMISSION=?,COMMISSION_PERCENTAGE=? WHERE QUOTE_NO=?
GET_LOGIN_PROD_ID=SELECT ISNULL(RATE_LOGIN_ID,LOGIN_ID) LOGIN_ID,ISNULL(PROPOSAL_NO,PRODUCT_ID) PROD_ID FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?
GET_COMM=SELECT ISNULL (COMMISSION, '0') COMMISSION FROM LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM WHERE LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID = ? AND LM.STATUS = 'Y' AND LUD.STATUS = 'Y' AND LUD.PRODUCT_ID =  ? AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=LUD.LOGIN_ID AND PRODUCT_ID=LUD.PRODUCT_ID)
GET_CONSTRANCT_DTLS=SELECT CATEGORY_DETAIL_ID FROM CONSTANT_DETAIL WHERE CATEGORY_ID=? AND BRANCH_CODE=? AND STATUS='Y'
GET_COVER_INFO=SELECT a.SECTION_ID,a.CURRENCY_NAME,a.STATUS, a.VALUE, a.CLAUSES_DESCRIPTION,a.DISTINATION_VALUE  FROM TRAVEL_CLAUSES_MASTER a, TRAVEL_SCHEME_OPTION_COVERS b  WHERE a.status IN ('Y', 'PS', 'ES', 'GS', 'WS')  AND a.product_id = ?  AND b.cover_id = A.COVER_ID  AND B.SCHEME_ID = ?  AND B.OPTION_ID = ? AND B.BRANCH_CODE=? AND B.PRODUCT_CODE=?  ORDER BY   display_order
GET_QUOTE_COUNT=select count(*) from Home_position_master where INCEPTION_DATE > SYSDATETIME() and quote_no=?
UPDATE_QUOTE_C=update Home_position_master set STATUS=?,cancelled_reason=?,cancelled_date=SYSDATETIME(),cancelled_by=? where POLICY_NO=?
UPDATE_QUOTE_I=UPDATE Home_position_master SET status = 'I' WHERE quote_no = ? AND amend_id=(SELECT MAX(amend_id) FROM Home_position_master where QUOTE_NO = ? )
##travel.quoteregister.existing=SELECT A.APPLICATION_NO, a.quote_no, A.CONTENT_TYPE_ID, a.customer_id,CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE,  B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, B.EMAIL, A.INCEPTION_DATE, null OPEN_COVER_NO, ISNULL(a.OVERALL_PREMIUM,''0'') PREMIUM FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.login_id =? AND A.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.status = ''Y''  AND NULLIF(a.remarks,'''') IS NULL  AND NULLIF(a.ADMIN_REFERRAL_STATUS,'''') IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ? AND a.APPLICATION_ID IN (''{0}'')  AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.quote_no IS NOT NULL AND B.STATUS=''Y'' AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID)
travel.quoteregister.existing=SELECT A.APPLICATION_NO, a.quote_no, A.CONTENT_TYPE_ID, a.customer_id,CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE,  B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, B.EMAIL, A.INCEPTION_DATE, null OPEN_COVER_NO, ISNULL(a.OVERALL_PREMIUM,''0'') PREMIUM FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.login_id =? AND A.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.status = ''Y''  AND NULLIF(a.remarks,'''') IS NULL   AND b.customer_id = a.customer_id  AND a.product_id = ? {0}  AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.quote_no IS NOT NULL AND B.STATUS=''Y'' AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID)
motor.quoteregister.existing=SELECT A.APPLICATION_NO, a.quote_no, A.CONTENT_TYPE_ID, (SELECT SUM(PREMIUM) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=A.APPLICATION_NO) BASE_PREMIUM,a.customer_id,CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE,  B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, B.EMAIL, A.INCEPTION_DATE, null OPEN_COVER_NO, ISNULL(a.OVERALL_PREMIUM,''0'') PREMIUM FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.login_id =? AND A.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.status = ''Y''  AND NULLIF(a.remarks,'''') IS NULL   AND b.customer_id = a.customer_id  AND a.product_id = ? {0}  AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.quote_no IS NOT NULL AND B.STATUS=''Y'' AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID)
travel.quoteregister.saved=SELECT A.APPLICATION_NO, a.quote_no, a.customer_id,CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE, CONVERT(VARCHAR,A.INCEPTION_DATE,103)  VALIDITY_DATE,  B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.INCEPTION_DATE, null OPEN_COVER_NO, ISNULL(a.OVERALL_PREMIUM, ''0'') PREMIUM FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.login_id =? AND a.status = ''S''  AND NULLIF(a.remarks,'''') IS NULL  AND NULLIF(a.ADMIN_REFERRAL_STATUS,'''') IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ? AND a.APPLICATION_ID IN (''{0}'')  AND NULLIF(a.payment_status,'''') IS NULL AND A.quote_no IS NOT NULL AND B.STATUS=''Y'' AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID)
travel.quotereg.existingQuoteNo=AND A.QUOTE_NO LIKE ?
travel.quotereg.existingCustomerName=AND  (LOWER(LTRIM(RTRIM(B.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(B.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?)))) 
travel.quotereg.existingOrderBy=ORDER BY quote_no DESC
##travel.report.userlist=SELECT DISTINCT LM1.LOGIN_ID,LM1.USERNAME FROM LOGIN_MASTER LM1, LOGIN_MASTER LM2,HOME_POSITION_MASTER HPM, PERSONAL_INFO PI WHERE LM1.OA_CODE=LM2.OA_CODE AND LM2.LOGIN_ID = ? AND LM2.USERTYPE NOT IN ( 'Customer','User','Freight') AND LM1.USERTYPE != 'Freight' AND LM1.LOGIN_ID=HPM.LOGIN_ID AND HPM.PRODUCT_ID = ? AND HPM.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND HPM.CUSTOMER_ID = PI.CUSTOMER_ID AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) AND PI.STATUS='Y' ORDER BY LM1.USERNAME
##travel.report.userlist=SELECT DISTINCT LM1.LOGIN_ID,LM1.USERNAME FROM LOGIN_MASTER LM1, LOGIN_MASTER LM2,HOME_POSITION_MASTER HPM, PERSONAL_INFO PI WHERE LM1.OA_CODE=LM2.OA_CODE AND LM2.LOGIN_ID = ? AND LM2.USERTYPE NOT IN ( 'Customer','User','Freight') AND LM1.USERTYPE != 'Freight' AND LM1.LOGIN_ID=HPM.LOGIN_ID AND HPM.PRODUCT_ID = ? AND HPM.CUSTOMER_ID = PI.CUSTOMER_ID AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) AND PI.STATUS='Y' ORDER BY LM1.USERNAME
travel.report.userlist=SELECT DISTINCT LM1.LOGIN_ID,LM1.USERNAME FROM LOGIN_MASTER LM1, LOGIN_MASTER LM2,HOME_POSITION_MASTER HPM, PERSONAL_INFO PI WHERE LM1.OA_CODE=LM2.OA_CODE AND LM2.LOGIN_ID = ? AND LM2.USERTYPE NOT IN ( 'Customer','User','Freight') AND LM1.USERTYPE != 'Freight' AND LM1.LOGIN_ID=HPM.LOGIN_ID AND HPM.PRODUCT_ID = ? AND HPM.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND HPM.CUSTOMER_ID = PI.CUSTOMER_ID AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) AND PI.STATUS='Y' ORDER BY LM1.USERNAME

travel.report.quoteregister.lapsed= SELECT a.quote_no, a.LAPSED_REMARKS,CONVERT(VARCHAR,A.LAPSED_DATE,103)  LAPSED_DATE, a.customer_id,CONVERT(DATE,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103)  QUOTATION_DATE,CONVERT(VARCHAR(10),A.EFFECTIVE_DATE,103) VALIDITY_DATE, isnull(nullif(pi.COMPANY_NAME,''''), pi.FIRST_NAME+'' ''+pi.last_name) CUSTOMER_NAME  FROM   HOME_POSITION_MASTER a, personal_info PI  WHERE a.login_id =? AND a.EFFECTIVE_DATE < CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.product_id =? and a.APPLICATION_ID IN(''{0}'') AND a.status=''Y''  AND PI.customer_id = a.customer_id AND A.quote_no IS NOT NULL AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS=''Y''
travel.quotereg.lapsedQuoteNo=AND A.QUOTE_NO LIKE ?
travel.quotereg.lapsedCustomerName=AND  (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.quotereg.lapsedOrderBy=ORDER BY a.quote_no DESC
GET_B2C_EXISTINGQUOTE_LIST = SELECT A.APPLICATION_NO, a.quote_no, A.CONTENT_TYPE_ID, a.customer_id,CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, B.EMAIL, A.INCEPTION_DATE, null OPEN_COVER_NO, ISNULL(a.OVERALL_PREMIUM,''0'') PREMIUM FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.login_id IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)) AND A.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.status = ''Y'' AND NULLIF(a.remarks,'''') IS NULL  AND NULLIF(a.ADMIN_REFERRAL_STATUS,'''') IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ?  AND A.APPLICATION_ID NOT IN (''{0}'')  AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.quote_no IS NOT NULL AND B.STATUS=''Y'' AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID)
GET_MOTOR_ISSUERQUOTE_LIST = SELECT A.APPLICATION_NO, a.quote_no, A.CONTENT_TYPE_ID, a.customer_id,CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, B.EMAIL, A.INCEPTION_DATE, null OPEN_COVER_NO, ISNULL(a.OVERALL_PREMIUM,''0'') PREMIUM FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.login_id IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)) AND A.EFFECTIVE_DATE <= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.status = ''Y'' AND NULLIF(a.remarks,'''') IS NULL  AND NULLIF(a.ADMIN_REFERRAL_STATUS,'''') IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ?  {0}  AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.quote_no IS NOT NULL AND B.STATUS=''Y'' AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID)
GET_MOTOR_EXISTINGQUOTE_LIST = SELECT A.APPLICATION_NO, a.quote_no, A.CONTENT_TYPE_ID, a.customer_id,CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, B.EMAIL, A.INCEPTION_DATE, null OPEN_COVER_NO, ISNULL(a.OVERALL_PREMIUM,''0'') PREMIUM FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.login_id =? AND A.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.status = ''Y''  AND NULLIF(a.remarks,'''') IS NULL  AND NULLIF(a.ADMIN_REFERRAL_STATUS,'''') IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ?  {0}  AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.quote_no IS NOT NULL AND B.STATUS=''Y'' AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID)
GET_MOTOR_ISSUERPORTFOLIO=SELECT HPM.RECEIPT_NO,HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,CONVERT(VARCHAR,HPM.EFFECTIVE_DATE,103)  QUOTATION_DATE,PI.FIRST_NAME CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,NULL CREDIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME,mpd.ISSELECTCOVER ISSELECTCOVER FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM,MOTOR_POLICY_DETAILS mpd WHERE HPM.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?)) AND HPM.STATUS \= ''P'' AND HPM.AMEND_ID\=''0'' AND PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \= ? {0} AND PI.STATUS\=''Y'' AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) AND HPM.LOGIN_ID\=LM.LOGIN_ID AND LM.OA_CODE \= BCM.AGENCY_CODE and hpm.APPLICATION_NO\=mpd.APPLICATIONNO  
GET_MOTOR_PORTFOLIO=SELECT HPM.RECEIPT_NO,HPM.CREDIT_NO CREDIT_NOTE_NO,HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,CONVERT(VARCHAR,HPM.EFFECTIVE_DATE,103) QUOTATION_DATE,PI.FIRST_NAME CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME,''N/A'' LC_DATE,''N/A'' LC_NUMBER,''N/A'' BL_AWB_DATE, ''N/A'' BL_AWB_NO,''N/A'' GOODS_DESCRIPTION,''N/A'' PO_NUMBER,(select USERNAME from login_master lm where lm.login_id\=(CASE WHEN HPM.APPLICATION_ID \= ''1'' THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) )   USERNAME, ''N/A'' INVOICE_NO FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.STATUS \= ''P'' AND HPM.AMEND_ID\=''0'' AND PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \= ?   {0} AND PI.STATUS\=''Y'' AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) AND HPM.LOGIN_ID\=LM.LOGIN_ID AND LM.OA_CODE \= BCM.AGENCY_CODE
GET_TRAVEL_PORTFOLIO=SELECT HPM.RECEIPT_NO,HPM.CREDIT_NO CREDIT_NOTE_NO,HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,CONVERT(VARCHAR,HPM.EFFECTIVE_DATE,103) QUOTATION_DATE,PI.FIRST_NAME CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME,''N/A'' LC_DATE,''N/A'' LC_NUMBER,''N/A'' BL_AWB_DATE, ''N/A'' BL_AWB_NO,''N/A'' GOODS_DESCRIPTION,''N/A'' PO_NUMBER,(select USERNAME from login_master lm where lm.login_id\=(CASE WHEN HPM.APPLICATION_ID \= ''1'' THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) )   USERNAME, ''N/A'' INVOICE_NO FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.STATUS IN(''P'',''D'') AND HPM.AMEND_ID\=''0'' AND PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \= ?   {0} AND PI.STATUS\=''Y'' AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) AND HPM.LOGIN_ID\=LM.LOGIN_ID AND LM.OA_CODE \= BCM.AGENCY_CODE
GET_MOTOR_PORTFOLIO_ALTR=SELECT HPM.RECEIPT_NO,HPM.CREDIT_NO CREDIT_NOTE_NO,HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,CONVERT(VARCHAR,HPM.EFFECTIVE_DATE,103) QUOTATION_DATE,PI.FIRST_NAME CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME,''N/A'' LC_DATE,''N/A'' LC_NUMBER,''N/A'' BL_AWB_DATE, ''N/A'' BL_AWB_NO,''N/A'' GOODS_DESCRIPTION,''N/A'' PO_NUMBER,(select USERNAME from login_master lm where lm.login_id\=(CASE WHEN HPM.APPLICATION_ID \= ''1'' THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) )   USERNAME, ''N/A'' INVOICE_NO,mpd.ISSELECTCOVER ISSELECTCOVER FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM,MOTOR_POLICY_DETAILS mpd  WHERE HPM.STATUS \= ''P'' AND HPM.AMEND_ID\=''0'' AND PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \= ?   {0} AND PI.STATUS\=''Y'' AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) AND HPM.LOGIN_ID\=LM.LOGIN_ID AND LM.OA_CODE \= BCM.AGENCY_CODE and hpm.APPLICATION_NO\=mpd.APPLICATIONNO   
GET_MOTOR_PENDING_POLICY=SELECT HPM.RECEIPT_NO,HPM.CREDIT_NO CREDIT_NOTE_NO,HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,CONVERT(VARCHAR,HPM.EFFECTIVE_DATE,103) QUOTATION_DATE,PI.FIRST_NAME CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,HPM.AMEND_ID,(case HPM.STATUS when  ''N'' then  ''Najm Status Verfication Pending'' end) STATUS ,BCM.COMPANY_NAME BROKER_NAME,''N/A'' LC_DATE,''N/A'' LC_NUMBER,''N/A'' BL_AWB_DATE, ''N/A'' BL_AWB_NO,''N/A'' GOODS_DESCRIPTION,''N/A'' PO_NUMBER,(select USERNAME from login_master lm where lm.login_id\=(CASE WHEN HPM.APPLICATION_ID \= ''1'' THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) )   USERNAME, ''N/A'' INVOICE_NO FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.STATUS \= ''N'' AND HPM.AMEND_ID\=''0'' AND PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \= ?   {0} AND PI.STATUS\=''Y'' AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) AND HPM.LOGIN_ID\=LM.LOGIN_ID AND LM.OA_CODE \= BCM.AGENCY_CODE
GET_MOTOR_CANCEL_POLICY=SELECT HPM.RECEIPT_NO,HPM.CREDIT_NO CREDIT_NOTE_NO,HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,CONVERT(VARCHAR,HPM.EFFECTIVE_DATE,103) QUOTATION_DATE,PI.FIRST_NAME CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME,''N/A'' LC_DATE,''N/A'' LC_NUMBER,''N/A'' BL_AWB_DATE, ''N/A'' BL_AWB_NO,''N/A'' GOODS_DESCRIPTION,''N/A'' PO_NUMBER,(select USERNAME from login_master lm where lm.login_id\=(CASE WHEN HPM.APPLICATION_ID \= ''1'' THEN HPM.LOGIN_ID ELSE HPM.APPLICATION_ID END) )   USERNAME, ''N/A'' INVOICE_NO,mpd.ISSELECTCOVER ISSELECTCOVER FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM,MOTOR_POLICY_DETAILS mpd  WHERE HPM.STATUS \= ''D'' AND HPM.AMEND_ID\=''0'' AND PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \= ?   {0} AND PI.STATUS\=''Y'' AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) AND HPM.LOGIN_ID\=LM.LOGIN_ID AND LM.OA_CODE \= BCM.AGENCY_CODE  and hpm.APPLICATION_NO\=mpd.APPLICATIONNO
GET_MOTOR_ISSUER_RUQUOTE_LIST=SELECT a.quote_no,a.customer_id, a.CONTENT_TYPE_ID, CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE,B.FIRST_NAME  CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, null OPEN_COVER_NO  FROM   home_position_master a, personal_info b   WHERE       a.login_id IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?))  AND a.status \= ''Y''  AND b.customer_id \= a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id \=? {0}  AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.QUOTE_NO IS NOT NULL AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) and B.STATUS\=''Y'' 
GET_MOTOR_RUQUOTE_LIST=SELECT a.quote_no,a.customer_id, a.CONTENT_TYPE_ID, CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE,B.FIRST_NAME  CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, null OPEN_COVER_NO  FROM   home_position_master a, personal_info b   WHERE       a.login_id =?  AND a.status = ''Y''  AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id =? {0}  AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.QUOTE_NO IS NOT NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y''
GET_TRAVEL_CANCELLED_POLICIES =SELECT HPM.RECEIPT_NO,HPM.CREDIT_NO CREDIT_NOTE_NO,HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,CONVERT(VARCHAR,HPM.EFFECTIVE_DATE,103) QUOTATION_DATE,PI.FIRST_NAME CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.STATUS \= ? AND HPM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE QUOTE_NO\=HPM.QUOTE_NO) AND PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \= ?   {0} AND PI.STATUS\=''Y'' AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) AND HPM.LOGIN_ID\=LM.LOGIN_ID AND LM.OA_CODE \= BCM.AGENCY_CODE 

GET_OPEN_COVER_EXPIRTY_DATE = select  CONVERT(VARCHAR(10),ocm.POLICY_END_DATE, 103) from open_cover_master ocm where PROPOSAL_NO=( select PROPOSAL_NO from OPEN_COVER_POSITION_MASTER a where a.open_cover_no=? and status='P' AND AMEND_ID=(SELECT MAX(AMEND_ID)  FROM OPEN_COVER_POSITION_MASTER WHERE A.OPEN_COVER_NO=OPEN_COVER_NO))

report.report=SELECT (CASE WHEN APPLICATION_ID \= '1' AND CUSTOMER_LOGIN_ID IS NOT NULL THEN (CUSTOMER_LOGIN_ID) ELSE LOGIN_ID END) + ' ' + '(' + ' ' + (SELECT USERTYPE FROM LOGIN_MASTER WHERE LOGIN_ID \= PI.LOGIN_ID) + ' ' + ')' USERNAME, (CASE WHEN APPLICATION_ID \= '1' AND CUSTOMER_LOGIN_ID IS NOT NULL THEN (CUSTOMER_LOGIN_ID) ELSE LOGIN_ID END) FIRST_NAME FROM PERSONAL_INFO PI WHERE (LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?)) OR CUSTOMER_LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= ?))) AND LOGIN_ID \!\= 'NONE' AND APPLICATION_ID IN ('2', '3', '5') AND OA_CODE IS NOT NULL AND AGENCY_CODE IS NOT NULL ORDER BY APPLICATION_ID
travel.report.referral.unapproved=SELECT a.quote_no,a.customer_id, a.CONTENT_TYPE_ID, CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE,B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, null OPEN_COVER_NO  FROM   home_position_master a, personal_info b   WHERE       a.login_id =?  AND a.status = ''Y''  AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id =? and a.APPLICATION_ID IN (''{0}'')  AND NULLIF(a.PAYMENT_STATUS,'') IS NULL AND A.QUOTE_NO IS NOT NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y''
travel.report.referral.unapprovedQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.referral.unapprovedCustomerName=AND  (LOWER(LTRIM(RTRIM(B.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(B.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.referral.unapprovedOrderBy=ORDER BY   a.quote_no DESC 
travel.report.referral.approved=SELECT a.quote_no, a.CONTENT_TYPE_ID, a.customer_id,CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, null OPEN_COVER_NO FROM   home_position_master a, personal_info b  WHERE       a.login_id =?  AND a.status = ''Y''  AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Admin''))  AND a.product_id =? and a.APPLICATION_ID IN (''{0}'')   AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.QUOTE_NO IS NOT NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y''
REPORT_REFERRAL_APPORVED_B2C=SELECT A.QUOTE_NO, A.CONTENT_TYPE_ID, A.CUSTOMER_ID,CONVERT(VARCHAR,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NULL OPEN_COVER_NO FROM   HOME_POSITION_MASTER A, PERSONAL_INFO B  WHERE A.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?))  AND A.STATUS = ''Y'' AND B.CUSTOMER_ID = A.CUSTOMER_ID  AND (A.REMARKS IN (''ADMIN''))  AND A.PRODUCT_ID =?  {0}   AND NULLIF(A.PAYMENT_STATUS,'''') IS NULL AND A.QUOTE_NO IS NOT NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) AND B.STATUS=''Y''
travel.report.referralQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.referral.CustomerName=AND  (LOWER(LTRIM(RTRIM(b.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(b.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.referral.approvedOrderBy=ORDER BY   a.quote_no DESC 
travel.report.referral.reject=SELECT   a.quote_no, a.LAPSED_REMARKS,CONVERT(VARCHAR,A.LAPSED_DATE,103) LAPSED_DATE, a.customer_id, CONVERT(DATE,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) AS QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NULL OPEN_COVER_NO FROM   home_position_master a, personal_info b WHERE a.login_id = ? AND (A.STATUS IN (''R'')) AND b.customer_id = a.customer_id AND a.product_id = ? and a.APPLICATION_ID IN (''{0}'') AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y''
B2C_REPORT_REFERRAL_REJECT = SELECT   a.quote_no, a.LAPSED_REMARKS,CONVERT(VARCHAR,A.LAPSED_DATE,103) LAPSED_DATE, a.customer_id, CONVERT(DATE,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103) AS QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, NULL OPEN_COVER_NO FROM   home_position_master a, personal_info b WHERE a.login_id IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?))  AND (A.STATUS IN (''R'')) AND b.customer_id \= a.customer_id AND a.product_id \= ? {0} AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) and B.STATUS\=''Y'' 
travel.report.referral.rejectQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.referral.rejectCustomerName=AND  (LOWER(LTRIM(RTRIM(B.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(B.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.referral.rejectOrderBy=ORDER BY a.quote_no DESC 
travel.report.lapsedquote=SELECT A.QUOTE_NO,a.LAPSED_REMARKS,CONVERT(VARCHAR,A.LAPSED_DATE,103) LAPSED_DATE,A.APPLICATION_NO, A.CUSTOMER_ID, CONVERT(DATE,DATEADD(DAY,-30,A.EFFECTIVE_DATE),103)  QUOTATION_DATE, CONVERT(VARCHAR(10),A.EFFECTIVE_DATE,103) VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME,   ''Rejected''  REJECT_DESC  FROM HOME_POSITION_MASTER A, PERSONAL_INFO B WHERE A.LOGIN_ID =?  AND (A.STATUS IN (''D''))  AND B.CUSTOMER_ID  = A.CUSTOMER_ID  AND A.PRODUCT_ID = ? AND A.APPLICATION_ID IN (''{0}'') AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID) and B.STATUS=''Y''
travel.report.rejectedQuoteNo=AND A.QUOTE_NO LIKE ?
travel.report.rejectedCustomerName=AND  (LOWER(LTRIM(RTRIM(B.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(B.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.rejectedOrderBy=ORDER BY A.QUOTE_NO DESC
##travel.userlist.issuer=SELECT DISTINCT PM.LOGIN_ID LOGIN_ID,PM.LOGIN_ID FIRST_NAME,BCM.COMPANY_NAME USERNAME FROM HOME_POSITION_MASTER PM,LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE PM.APPLICATION_ID = ? AND LM.LOGIN_ID=PM.LOGIN_ID AND LM.OA_CODE=BCM.AGENCY_CODE AND PM.STATUS in ('P','Y') AND PM.PRODUCT_ID = ?
travel.userlist.issuer = SELECT DISTINCT LM.LOGIN_ID LOGIN_ID,BCM.COMPANY_NAME USERNAME FROM LOGIN_MASTER LM,BROKER_COMPANY_MASTER BCM WHERE LM.AGENCY_CODE = BCM.AGENCY_CODE AND LM.AGENCY_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER LM1 WHERE LOGIN_ID IN (SELECT LOGIN_ID FROM HOME_POSITION_MASTER PM WHERE PM.APPLICATION_ID=? AND PM.STATUS IN ('P', 'Y') AND PM.PRODUCT_ID=?))
travel.issuer.brokerList=SELECT DISTINCT(A.LOGIN_ID) LOGIN_ID,D.USERNAME FROM HOME_POSITION_MASTER A,PERSONAL_INFO B,BROKER_COMPANY_MASTER C, LOGIN_MASTER D WHERE A.PRODUCT_ID = ? AND A.INCEPTION_DATE <= SYSDATETIME() AND A.APPLICATION_ID NOT IN (?,'1') AND C.AGENCY_CODE=D.OA_CODE AND C.BRANCH_CODE=? AND D.LOGIN_ID=A.LOGIN_ID
travel.report.portfolio=SELECT HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,CONVERT(VARCHAR,HPM.EFFECTIVE_DATE,103)  QUOTATION_DATE,PI.FIRST_NAME CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,NULL CREDIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?)) AND HPM.STATUS \= ''P'' AND HPM.AMEND_ID\=''0'' AND PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \= ? AND scheme_id \= ? {0} AND PI.STATUS\=''Y'' AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) AND HPM.LOGIN_ID\=LM.LOGIN_ID AND LM.OA_CODE \= BCM.AGENCY_CODE

travel.report.portfolioQuoteNo=AND  HPM.QUOTE_NO LIKE ? 
travel.report.portfolioPolicyNo=AND  HPM.POLICY_NO LIKE ?
travel.report.portfolioCustomerName=AND  (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.report.portfolioissuer=SELECT HPM.POLICY_NO,HPM.APPLICATION_NO,HPM.CUSTOMER_ID,HPM.OVERALL_PREMIUM,CONVERT(VARCHAR,HPM.EFFECTIVE_DATE,103)  QUOTATION_DATE,PI.FIRST_NAME CUSTOMER_NAME,PI.LAST_NAME,HPM.LOGIN_ID,HPM.QUOTE_NO,HPM.EXCESS_PREMIUM,PI.COMPANY_NAME,HPM.INCEPTION_DATE,NULL OPEN_COVER_NO,DEBIT_NOTE_NO,NULL CREDIT_NOTE_NO,HPM.AMEND_ID,BCM.COMPANY_NAME BROKER_NAME FROM HOME_POSITION_MASTER HPM, PERSONAL_INFO PI ,BROKER_COMPANY_MASTER BCM ,LOGIN_MASTER LM WHERE HPM.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?)) AND HPM.STATUS \= ''P'' AND HPM.AMEND_ID\=''0'' AND PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.PRODUCT_ID \= ? {0} AND PI.STATUS\=''Y'' AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) AND HPM.LOGIN_ID\=LM.LOGIN_ID AND LM.OA_CODE \= BCM.AGENCY_CODE
travel.report.portfolioOrderBy=ORDER BY HPM.EFFECTIVE_DATE DESC
travel.customer.selection=SELECT PI.CUSTOMER_ID, PI.TITLE TITLE,PI.FIRST_NAME FIRST_NAME, PI.LAST_NAME,convert(VARCHAR,PI.DOB,103) DOB, PI.GENDER, PI.TELEPHONE,PI.MOBILE, PI.FAX, PI.EMAIL EMAIL,PI.ADDRESS1, PI.ADDRESS2, PI.OCCUPATION, PI.POBOX POBOX, PI.COUNTRY, PI.EMIRATE,PI.AC_EXECUTIVE_ID,PI.AGENCY_CODE, PI.OA_CODE, PI.COMPANY_NAME,PI.MISSIPPI_CUSTOMER_CODE MISSIPPI_CUSTOMER_CODE, PI.CITY CITY_NAME, PI.FREIGHT_FORWARD_USER, PI.CUSTOMER_LOGIN_ID, PI.CUSTOMER_SOURCE, PI.FD_CODE,PI.CLIENT_CUSTOMER_ID, PI.CUST_AR_NO, PI.CUST_NAME,PI.PASSPORT_NUMBER, PI.NRC,PI.ALTERNATE_MOBILE, PI.CUSTOMER_TYPE, PI.COMPANY_REG_NO, PI.CUST_NAME_ARABIC, CONVERT(VARCHAR,CONVERT(DATE,PI.DOB_AR,120),103) DOB_AR,REPLACE ('P.O.BOX.'+ ' '+ ISNULL (PI.POBOX, ' ')+ ' '+ ISNULL (PI.ADDRESS1, ' ')+ ' '+ ISNULL (PI.ADDRESS2, ' ')+ ' '+ ISNULL (PI.EMIRATE, ' '),'select','')ADDRESS FROM PERSONAL_INFO PI,LOGIN_MASTER LM1, LOGIN_MASTER LM2 WHERE       PI.LOGIN_ID \= LM1.LOGIN_ID AND LM1.OA_CODE \= LM2.OA_CODE AND LM2.LOGIN_ID \= ? AND pi.APPLICATION_ID \= '1' AND PI.STATUS \= 'Y' AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID)
travel.customer.selectionCustomerId=AND  PI.CUSTOMER_ID LIKE ?
travel.customer.selectionCusCivilId=AND  PI.CUSTOMER_SOURCE LIKE ?
travel.customer.selectionMobileNo=AND  PI.MOBILE LIKE ? 
travel.customer.selectionCustomerName=AND  (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM( ? ))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?))))
travel.customer.selectionOrderBy=ORDER BY PI.FIRST_NAME
##travel.report.policy = SELECT A.CREDIT_NO,A.POLICY_NO,convert(varchar(10), A.INCEPTION_DATE,103) INCEPTION_DATE, A.OVERALL_PREMIUM,A.REMARKS,A.LOGIN_ID, A.QUOTE_NO,A.DEBIT_NOTE_NO,A.RECEIPT_NO, isnull(nullif(B.COMPANY_NAME,''),B.FIRST_NAME)   INSURED_NAME,A.COMMISSION,ISNULL(A.PAYMENT_MODE,'-') PAYMENT_MODE,CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) EFFECTIVE_DATE,CONVERT(VARCHAR,A.EXPIRY_DATE,103) EXPIRY_DATE,PM.PRODUCT_DESCRIPTION,ISNULL(PM.BROKER_ID,'Travel')  FROM HOME_POSITION_MASTER A,PERSONAL_INFO B,HOME_PRODUCT_MASTER PM       WHERE convert(date,A.EFFECTIVE_DATE,103)  BETWEEN CONVERT(DATE,?,103)AND dateadd(day,1,CONVERT(DATE,?,103))  AND(CASE ? WHEN  'ALL' THEN 'A' ELSE  A.LOGIN_ID END )\=(CASE ? WHEN  'ALL' THEN 'A' ELSE ? END)  AND A.STATUS\='P' AND  A.PRODUCT_ID\=?  AND A.DEBIT_NOTE_NO IS NOT NULL AND A.CUSTOMER_ID\=B.CUSTOMER_ID AND PM.PRODUCT_ID \= A.PRODUCT_ID  AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) and B.STATUS\='Y'  and PM.STATUS\='Y'
travel.report.policy = select * from travel_policy_report(?,?,?,?)      
MOTOR_REPORT_POLICY = SELECT A.CREDIT_NO, A.POLICY_NO, convert(varchar(10), A.INCEPTION_DATE,103) INCEPTION_DATE, A.OVERALL_PREMIUM, A.POLICY_FEE, A.REMARKS, A.LOGIN_ID, A.QUOTE_NO, A.DEBIT_NOTE_NO, A.RECEIPT_NO, B.FIRST_NAME INSURED_NAME, A.COMMISSION, ISNULL(A.PAYMENT_MODE,'-') PAYMENT_MODE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) EFFECTIVE_DATE, CONVERT(VARCHAR,A.EXPIRY_DATE,103) EXPIRY_DATE, PM.PRODUCT_NAME, ISNULL(PM.PRODUCT_NAME,'Travel') BROKER_ID FROM HOME_POSITION_MASTER A,PERSONAL_INFO B,PRODUCT_MASTER PM WHERE convert(date,A.EFFECTIVE_DATE,103) BETWEEN CONVERT(DATE,?,103) AND dateadd(day,1,CONVERT(DATE,?,103)) AND(CASE ?  WHEN  'ALL' THEN 'A' ELSE  A.LOGIN_ID END )= (CASE  ? WHEN  'ALL' THEN 'A' ELSE  ? END) AND A.STATUS='P' AND A.PRODUCT_ID= ? AND nullif(A.DEBIT_NOTE_NO,'') IS NOT NULL AND A.CUSTOMER_ID=B.CUSTOMER_ID AND PM.PRODUCT_ID = A.PRODUCT_ID AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
##travel.report.policy=SELECT A.POLICY_NO,convert(varchar(10),A.INCEPTION_DATE,103) INCEPTION_DATE,A.OVERALL_PREMIUM,A.REMARKS,A.LOGIN_ID,A.QUOTE_NO,A.DEBIT_NOTE_NO,A.RECEIPT_NO,ISNULL(B.COMPANY_NAME,B.FIRST_NAME) INSURED_NAME,A.COMMISSION,ISNULL(A.PAYMENT_MODE,'-') PAYMENT_MODE,CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) EFFECTIVE_DATE,CONVERT(VARCHAR,A.EXPIRY_DATE,103) EXPIRY_DATE,PM.PRODUCT_DESCRIPTION,ISNULL(PM.BROKER_ID,'Travel') FROM HOME_POSITION_MASTER A,PERSONAL_INFO B,HOME_PRODUCT_MASTER PM WHERE A.EFFECTIVE_DATE BETWEEN CONVERT(DATE,?,103) AND CONVERT(DATE,?,103)+1 AND A.LOGIN_ID IN (?) AND A.STATUS\='P' AND  A.PRODUCT_ID\=? AND A.DEBIT_NOTE_NO IS NOT NULL AND A.CUSTOMER_ID\=B.CUSTOMER_ID AND PM.PRODUCT_ID \= A.PRODUCT_ID  AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) and B.STATUS\='Y'  and PM.STATUS\='Y' 
##travel.report.searchByQuote=SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,hpm.CUSTOMER_ID,CONVERT(VARCHAR,hpm.EFFECTIVE_DATE-30,103) QUOTATION_DATE, CONVERT(VARCHAR,hpm.EFFECTIVE_DATE,103) VALIDITY_DATE, PI.FIRST_NAME CUSTOMER_NAME,hpm.LOGIN_ID,pi.COMPANY_NAME,CONVERT(VARCHAR,hpm.INCEPTION_DATE,103) INCEPTION_DATE, ISNULL (hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE  WHEN     hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') THEN 'RA' ELSE case when hpm.STATUS = 'Y' AND (HPM.EFFECTIVE_DATE) >= (SYSDATETIME()) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL then 'Q' else hpm.STATUS END end AS STATUS  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI   WHERE  hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID  AND hpm.PRODUCT_ID =?   AND hpm.APPLICATION_ID = ISNULL(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID)  AND QUOTE_NO LIKE ? AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC
##travel.report.searchByPolicy=SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,hpm.CUSTOMER_ID,CONVERT(VARCHAR,hpm.EFFECTIVE_DATE-30,103) QUOTATION_DATE, CONVERT(VARCHAR,hpm.EFFECTIVE_DATE,103) VALIDITY_DATE, PI.FIRST_NAME CUSTOMER_NAME,hpm.LOGIN_ID,pi.COMPANY_NAME, CONVERT(VARCHAR,hpm.INCEPTION_DATE,103) INCEPTION_DATE, ISNULL (hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE  WHEN     hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') THEN 'RA' ELSE case when hpm.STATUS = 'Y' AND (HPM.EFFECTIVE_DATE) >= (SYSDATETIME()) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL then 'Q' else hpm.STATUS END end AS STATUS  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI   WHERE       hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID  AND hpm.PRODUCT_ID =?   AND hpm.APPLICATION_ID = ISNULL(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID)  AND POLICY_NO LIKE ? AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC
##travel.report.searchByCustomer=SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,hpm.CUSTOMER_ID,CONVERT(VARCHAR,hpm.EFFECTIVE_DATE-30,103) QUOTATION_DATE, CONVERT(VARCHAR,hpm.EFFECTIVE_DATE,103) VALIDITY_DATE, PI.FIRST_NAME CUSTOMER_NAME,hpm.LOGIN_ID,pi.COMPANY_NAME, CONVERT(VARCHAR,hpm.INCEPTION_DATE,103) INCEPTION_DATE, ISNULL (hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE  WHEN     hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') THEN 'RA' ELSE case when hpm.STATUS = 'Y' AND (HPM.EFFECTIVE_DATE) >= (SYSDATETIME()) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL then 'Q' else hpm.STATUS END end AS STATUS  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI   WHERE       hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID  AND hpm.PRODUCT_ID =?   AND hpm.APPLICATION_ID = ISNULL(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID) AND (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?)))) AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC

##travel.report.searchByQuote		=  SELECT hpm.APPLICATION_NO,hpm.QUOTE_NO,nullif(hpm.CONTENT_TYPE_ID,'') CONTENT_TYPE_ID, hpm.CUSTOMER_ID,CONVERT(VARCHAR,DATEADD(DAY,-30,HPM.EFFECTIVE_DATE),103) QUOTATION_DATE,CONVERT(VARCHAR,HPM.ENTRY_DATE,103) ENTRY_DATE, CONVERT(VARCHAR,hpm.EFFECTIVE_DATE,103) VALIDITY_DATE, isnull(nullif(pi.COMPANY_NAME,''), pi.FIRST_NAME+' '+isnull(pi.last_name,'')) CUSTOMER_NAME, hpm.LOGIN_ID,pi.COMPANY_NAME, CONVERT(VARCHAR,hpm.INCEPTION_DATE,103) POLICY_START_DATE, ISNULL(hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin') THEN 'RA' WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Referral') THEN 'RU' WHEN hpm.STATUS = 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'RR' WHEN  hpm.STATUS = 'Y' AND CAST(HPM.EFFECTIVE_DATE AS DATE)>=CAST(GETDATE() AS DATE) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'QL' WHEN  hpm.STATUS = 'Y' then 'QE' WHEN (hpm.STATUS = 'D' OR hpm.STATUS = 'R') AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'R' ELSE hpm.STATUS END AS STATUS_TYPE,CASE WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin') THEN 'Referral Approved' WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Referral') THEN 'Referral Unapproved' WHEN hpm.STATUS = 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'Referral Reject' WHEN  hpm.STATUS = 'Y' AND CAST(HPM.EFFECTIVE_DATE AS DATE) >= CAST(GETDATE() AS DATE) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'Quote Lapsed' ELSE (CASE  hpm.STATUS WHEN 'Y' THEN 'Pending Quotes' WHEN 'R' THEN 'Rejected' WHEN 'P' THEN 'Portfolio' WHEN 'D' THEN 'Canceled Policy' WHEN 'L' THEN 'Lapsed Quote' ELSE 'Pending Policies' END ) END AS STATUS_TYPE_NAME  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI   WHERE     hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID  AND hpm.PRODUCT_ID =?   AND hpm.APPLICATION_ID = ISNULL(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID)  AND QUOTE_NO LIKE ? AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC
travel.report.searchByQuote		= SELECT APPLICATION_NO,QUOTE_NO,CONTENT_TYPE_ID,CUSTOMER_ID,QUOTATION_DATE,ENTRY_DATE,VALIDITY_DATE, CUSTOMER_NAME,LOGIN_ID,COMPANY_NAME,POLICY_START_DATE,PREMIUM,EFFECTIVE_DATE,POLICY_NO,STATUS_TYPE, STATUS_TYPE_NAME, (SELECT  ARABIC_TEXT  FROM CONSTANT_DETAIL WHERE DETAIL_NAME\=STATUS_TYPE_NAME AND CATEGORY_ID\='202') STATUS_TYPE_NAME_AR FROM ( SELECT hpm.APPLICATION_NO ,hpm.QUOTE_NO ,nullif(hpm.CONTENT_TYPE_ID, '') CONTENT_TYPE_ID ,hpm.CUSTOMER_ID ,CONVERT(VARCHAR, DATEADD(DAY, - 30, HPM.EFFECTIVE_DATE), 103) QUOTATION_DATE ,CONVERT(VARCHAR, HPM.ENTRY_DATE, 103) ENTRY_DATE ,CONVERT(VARCHAR, hpm.EFFECTIVE_DATE, 103) VALIDITY_DATE ,isnull(nullif(pi.COMPANY_NAME, ''), pi.FIRST_NAME + ' ' + isnull(pi.last_name, '')) CUSTOMER_NAME ,hpm.LOGIN_ID ,pi.COMPANY_NAME ,CONVERT(VARCHAR, hpm.INCEPTION_DATE, 103) POLICY_START_DATE ,ISNULL(hpm.PREMIUM, 0) PREMIUM ,hpm.EFFECTIVE_DATE ,hpm.POLICY_NO ,CASE WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Admin') THEN 'RA' WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Referral') THEN 'RU' WHEN hpm.STATUS \= 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'RR' WHEN hpm.STATUS \= 'Y' AND CAST(HPM.EFFECTIVE_DATE AS DATE) >\= CAST(GETDATE() AS DATE) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'QL' WHEN hpm.STATUS \= 'Y' THEN 'QE' WHEN ( hpm.STATUS \= 'D' OR hpm.STATUS \= 'R' ) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'R' ELSE hpm.STATUS END AS STATUS_TYPE ,CASE WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Admin') THEN 'Referral Approved' WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Referral') THEN 'Referral Unapproved' WHEN hpm.STATUS \= 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'Referral Reject' WHEN hpm.STATUS \= 'Y' AND CAST(HPM.EFFECTIVE_DATE AS DATE) >\= CAST(GETDATE() AS DATE) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'Quote Lapsed' ELSE ( CASE hpm.STATUS WHEN 'Y' THEN 'Pending Quotes' WHEN 'R' THEN 'Rejected' WHEN 'P' THEN 'Portfolio' WHEN 'D' THEN 'Canceled Policy' WHEN 'L' THEN 'Existing Quote' ELSE 'Pending Policies' END ) END AS STATUS_TYPE_NAME FROM HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI WHERE hpm.LOGIN_ID \= ? AND hpm.CUSTOMER_ID \= pi.CUSTOMER_ID AND hpm.PRODUCT_ID \= ? AND hpm.APPLICATION_ID \= ISNULL(CASE HPM.APPLICATION_ID WHEN ? THEN NULL ELSE '1' END, HPM.APPLICATION_ID) AND QUOTE_NO LIKE  ? AND PI.AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID \= PI.CUSTOMER_ID ) AND PI.STATUS \= 'Y' ) X ORDER BY QUOTE_NO DESC 
##travel.report.searchByPolicy    =  SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,nullif(hpm.CONTENT_TYPE_ID,'') CONTENT_TYPE_ID,hpm.CUSTOMER_ID, convert(varchar, DATEADD(day,-30, HPM.EFFECTIVE_DATE),103) QUOTATION_DATE, convert(varchar,HPM.ENTRY_DATE,103) ENTRY_DATE, convert(varchar,hpm.EFFECTIVE_DATE,103) VALIDITY_DATE, isnull(nullif(pi.COMPANY_NAME,''), pi.FIRST_NAME+' '+isnull(pi.last_name,'')) CUSTOMER_NAME, hpm.LOGIN_ID,pi.COMPANY_NAME, convert(varchar,hpm.INCEPTION_DATE,103) POLICY_START_DATE, isnull(hpm.PREMIUM, 0)  PREMIUM,convert(varchar, hpm.EFFECTIVE_DATE,103) EFFECTIVE_DATE, hpm.POLICY_NO, CASE WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin') THEN 'RA' WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Referral') THEN 'RU' WHEN hpm.STATUS = 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'RR' WHEN  hpm.STATUS = 'Y' AND cast(HPM.EFFECTIVE_DATE as date) >= cast(getdate() as date) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'QL' WHEN  hpm.STATUS = 'Y' then 'QE' WHEN (hpm.STATUS = 'D' OR hpm.STATUS = 'R') AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'R' ELSE hpm.STATUS END AS STATUS_TYPE,CASE WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin') THEN 'Referral Approved' WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Referral') THEN 'Referral Unapproved' WHEN hpm.STATUS = 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'Referral Reject' WHEN  hpm.STATUS = 'Y' AND cast(HPM.EFFECTIVE_DATE as date) >= cast (getdate() as date) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'Quote Lapsed' ELSE (case  hpm.STATUS  when 'Y'  then 'Pending Quotes' when 'R' then 'Rejected'  when 'P' then 'Portfolio' when 'D' then 'Canceled Policy' when 'L' then 'Lapsed Quote' else 'Pending Policies' END) end AS STATUS_TYPE_NAME  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI WHERE       hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID AND hpm.PRODUCT_ID =?   AND hpm.APPLICATION_ID = isnull(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID) AND POLICY_NO LIKE ? AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC ;
travel.report.searchByPolicy = SELECT APPLICATION_NO,QUOTE_NO,CONTENT_TYPE_ID,CUSTOMER_ID,QUOTATION_DATE,ENTRY_DATE,VALIDITY_DATE, CUSTOMER_NAME,LOGIN_ID,COMPANY_NAME,POLICY_START_DATE,PREMIUM,EFFECTIVE_DATE,POLICY_NO,STATUS_TYPE, STATUS_TYPE_NAME, (SELECT  ARABIC_TEXT  FROM CONSTANT_DETAIL WHERE DETAIL_NAME\=STATUS_TYPE_NAME AND CATEGORY_ID\='202') STATUS_TYPE_NAME_AR FROM (SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,nullif(hpm.CONTENT_TYPE_ID,'') CONTENT_TYPE_ID,hpm.CUSTOMER_ID, convert(varchar, DATEADD(day,-30, HPM.EFFECTIVE_DATE),103) QUOTATION_DATE, convert(varchar,HPM.ENTRY_DATE,103) ENTRY_DATE, convert(varchar,hpm.EFFECTIVE_DATE,103) VALIDITY_DATE, isnull(nullif(pi.COMPANY_NAME,''), pi.FIRST_NAME+' '+isnull(pi.last_name,'')) CUSTOMER_NAME, hpm.LOGIN_ID,pi.COMPANY_NAME, convert(varchar,hpm.INCEPTION_DATE,103) POLICY_START_DATE, isnull(hpm.PREMIUM, 0)  PREMIUM,convert(varchar, hpm.EFFECTIVE_DATE,103) EFFECTIVE_DATE, hpm.POLICY_NO, CASE WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Admin') THEN 'RA' WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Referral') THEN 'RU' WHEN hpm.STATUS \= 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'RR' WHEN  hpm.STATUS \= 'Y' AND cast(HPM.EFFECTIVE_DATE as date) >\= cast(getdate() as date) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'QL' WHEN  hpm.STATUS \= 'Y' then 'QE' WHEN (hpm.STATUS \= 'D' OR hpm.STATUS \= 'R') AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'R' ELSE hpm.STATUS END AS STATUS_TYPE,CASE WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Admin') THEN 'Referral Approved' WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Referral') THEN 'Referral Unapproved' WHEN hpm.STATUS \= 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'Referral Reject' WHEN  hpm.STATUS \= 'Y' AND cast(HPM.EFFECTIVE_DATE as date) >\= cast (getdate() as date) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'Quote Lapsed' ELSE (case  hpm.STATUS  when 'Y'  then 'Pending Quotes' when 'R' then 'Rejected'  when 'P' then 'Portfolio' when 'D' then 'Canceled Policy' when 'L' then 'Existing Quote' else 'Pending Policies' END) end AS STATUS_TYPE_NAME  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI WHERE       hpm.LOGIN_ID\=? AND hpm.CUSTOMER_ID \= pi.CUSTOMER_ID AND hpm.PRODUCT_ID \=?   AND hpm.APPLICATION_ID \= isnull(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID) AND POLICY_NO LIKE ? AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) and PI.STATUS\='Y')X ORDER BY QUOTE_NO DESC
##travel.report.searchByCustomer  =  SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,nullif(hpm.CONTENT_TYPE_ID,'') CONTENT_TYPE_ID,hpm.CUSTOMER_ID,convert(varchar,dateadd(day,-30,HPM.EFFECTIVE_DATE),103) QUOTATION_DATE, convert(varchar,HPM.ENTRY_DATE,103) ENTRY_DATE, convert(varchar,hpm.EFFECTIVE_DATE,103) VALIDITY_DATE, isnull(nullif(pi.COMPANY_NAME,''), pi.FIRST_NAME+' '+isnull(pi.last_name,'')) CUSTOMER_NAME, hpm.LOGIN_ID,pi.COMPANY_NAME, convert(varchar,hpm.INCEPTION_DATE,103) POLICY_START_DATE, isnull(hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin') THEN 'RA' WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Referral') THEN 'RU' WHEN hpm.STATUS = 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'RR' WHEN  hpm.STATUS = 'Y' AND cast(HPM.EFFECTIVE_DATE as date) >= cast(getdate() as date) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'QL' WHEN  hpm.STATUS = 'Y' then 'QE' WHEN (hpm.STATUS = 'D' OR hpm.STATUS = 'R') AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'R' ELSE hpm.STATUS END AS STATUS_TYPE,CASE WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Admin') THEN 'Referral Approved' WHEN hpm.STATUS = 'Y' AND hpm.REMARKS IN ('Referral') THEN 'Referral Unapproved' WHEN hpm.STATUS = 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'Referral Reject' WHEN  hpm.STATUS = 'Y' AND cast(HPM.EFFECTIVE_DATE as date) >= cast(getdate() as date) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'Quote Lapsed' ELSE (case  hpm.STATUS when 'Y' then 'Pending Quotes' when 'R' then 'Rejected' when 'P' then  'Portfolio' when 'D' then 'Canceled Policy' when 'L' then'Lapsed Quote' else'Pending Policies' end) END AS STATUS_TYPE_NAME  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI WHERE    hpm.LOGIN_ID=? AND hpm.CUSTOMER_ID = pi.CUSTOMER_ID  AND hpm.PRODUCT_ID =? AND hpm.APPLICATION_ID = isnull(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID) AND (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?)))) AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and PI.STATUS='Y' ORDER BY QUOTE_NO DESC;
travel.report.searchByCustomer  = SELECT APPLICATION_NO,QUOTE_NO,CONTENT_TYPE_ID,CUSTOMER_ID,QUOTATION_DATE,ENTRY_DATE,VALIDITY_DATE, CUSTOMER_NAME,LOGIN_ID,COMPANY_NAME,POLICY_START_DATE,PREMIUM,EFFECTIVE_DATE,POLICY_NO,STATUS_TYPE, STATUS_TYPE_NAME, (SELECT  ARABIC_TEXT  FROM CONSTANT_DETAIL WHERE DETAIL_NAME\=STATUS_TYPE_NAME AND CATEGORY_ID\='202') STATUS_TYPE_NAME_AR FROM (SELECT   hpm.APPLICATION_NO,hpm.QUOTE_NO,nullif(hpm.CONTENT_TYPE_ID,'') CONTENT_TYPE_ID,hpm.CUSTOMER_ID,convert(varchar,dateadd(day,-30,HPM.EFFECTIVE_DATE),103) QUOTATION_DATE, convert(varchar,HPM.ENTRY_DATE,103) ENTRY_DATE, convert(varchar,hpm.EFFECTIVE_DATE,103) VALIDITY_DATE, isnull(nullif(pi.COMPANY_NAME,''), pi.FIRST_NAME+' '+isnull(pi.last_name,'')) CUSTOMER_NAME, hpm.LOGIN_ID,pi.COMPANY_NAME, convert(varchar,hpm.INCEPTION_DATE,103) POLICY_START_DATE, isnull(hpm.PREMIUM, 0)  PREMIUM, hpm.EFFECTIVE_DATE, hpm.POLICY_NO, CASE WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Admin') THEN 'RA' WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Referral') THEN 'RU' WHEN hpm.STATUS \= 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'RR' WHEN  hpm.STATUS \= 'Y' AND cast(HPM.EFFECTIVE_DATE as date) >\= cast(getdate() as date) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'QL' WHEN  hpm.STATUS \= 'Y' then 'QE' WHEN (hpm.STATUS \= 'D' OR hpm.STATUS \= 'R') AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'R' ELSE hpm.STATUS END AS STATUS_TYPE,CASE WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Admin') THEN 'Referral Approved' WHEN hpm.STATUS \= 'Y' AND hpm.REMARKS IN ('Referral') THEN 'Referral Unapproved' WHEN hpm.STATUS \= 'D' AND hpm.remarks IS NOT NULL AND hpm.ADMIN_REFERRAL_STATUS IS NOT NULL THEN 'Referral Reject' WHEN  hpm.STATUS \= 'Y' AND cast(HPM.EFFECTIVE_DATE as date) >\= cast(getdate() as date) AND hpm.remarks IS NULL AND hpm.ADMIN_REFERRAL_STATUS IS NULL THEN 'Quote Lapsed' ELSE (case  hpm.STATUS when 'Y' then 'Pending Quotes' when 'R' then 'Rejected' when 'P' then  'Portfolio' when 'D' then 'Canceled Policy' when 'L' then'Existing Quote' else'Pending Policies' end) END AS STATUS_TYPE_NAME  FROM   HOME_POSITION_MASTER HPM ,PERSONAL_INFO PI WHERE    hpm.LOGIN_ID\=? AND hpm.CUSTOMER_ID \= pi.CUSTOMER_ID  AND hpm.PRODUCT_ID \=? AND hpm.APPLICATION_ID \= isnull(CASE HPM.APPLICATION_ID WHEN ? THEN  NULL ELSE  '1' END,HPM.APPLICATION_ID) AND (LOWER(LTRIM(RTRIM(PI.COMPANY_NAME))) LIKE LOWER(LTRIM(RTRIM(?))) OR LOWER(LTRIM(RTRIM(PI.FIRST_NAME))) LIKE LOWER(LTRIM(RTRIM(?)))) AND PI.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID) and PI.STATUS\='Y' )X ORDER BY QUOTE_NO DESC




travel.report.searchByQuoteOthers=SELECT  distinct A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR(10),A.EFFECTIVE_DATE-30,103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, ISNULL (M.OPEN_COVER_NO, '0'), (ISNULL (M.PREMIUM, 0) + ISNULL (M.EXCESS_PREMIUM, 0)) PREMIUM,CONVERT(VARCHAR(10),A.INCEPTION_DATE,103) INCEPTION_DATE,A.POLICY_NO,CASE WHEN A.STATUS='Y' AND A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND M.ADMIN_REFERRAL_STATUS  = 'N' THEN 'RA' ELSE A.STATUS END AS STATUS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID =? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND (A.EFFECTIVE_DATE) > =(SYSDATETIME()) AND M.APPLICATION_NO  = A.APPLICATION_NO AND B.CUSTOMER_ID = A.CUSTOMER_ID AND A.PRODUCT_ID = ? AND A.APPLICATION_ID NOT IN (?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') = ISNULL(?,'0') AND QUOTE_NO LIKE ? AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID) and B.STATUS='Y' ORDER BY QUOTE_NO DESC
travel.copyquote.quoteNo=SELECT PM.QUOTE_NO, PI.FIRST_NAME, (ISNULL(pm.PREMIUM,0) + ISNULL(pm.POLICY_FEE,0)) PREMIUM FROM HOME_POSITION_MASTER PM, LOGIN_MASTER LM, PERSONAL_INFO PI WHERE       PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.QUOTE_NO\=? AND LM.LOGIN_ID \= PM.LOGIN_ID  AND (PM.LOGIN_ID\=?  OR PM.APPLICATION_ID\=?) AND PM.PRODUCT_ID\=? AND PI.STATUS \= 'Y' AND nullif(PM.REMARKS,'') is null AND nullif(PM.ADMIN_REFERRAL_STATUS,'') is null AND PM.PAYMENT_STATUS IS NULL AND PM.QUOTE_NO IS NOT NULL  AND ((PM.EFFECTIVE_DATE) >\= (SYSDATETIME())  OR PM.STATUS \!\= 'Y') AND (PM.STATUS \= 'Y' OR PM.STATUS \= 'N' OR PM.STATUS \= 'P') AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY   PM.EFFECTIVE_DATE DESC                             
travel.copyquote.policyNo=SELECT PM.QUOTE_NO, PI.FIRST_NAME, (ISNULL(pm.PREMIUM,0) + ISNULL(pm.POLICY_FEE,0)) PREMIUM FROM HOME_POSITION_MASTER PM, LOGIN_MASTER LM, PERSONAL_INFO PI WHERE    PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.POLICY_NO\=? AND LM.LOGIN_ID \= PM.LOGIN_ID AND (PM.LOGIN_ID\=? OR PM.APPLICATION_ID\=?) AND PM.PRODUCT_ID\=? AND PI.STATUS \= 'Y' AND nullif(PM.REMARKS,'') is null AND nullif(PM.ADMIN_REFERRAL_STATUS,'') is null AND nullif(PM.PAYMENT_STATUS,'') IS NULL AND PM.QUOTE_NO IS NOT NULL AND ((PM.EFFECTIVE_DATE) >\= (SYSDATETIME())  OR PM.STATUS \!\= 'Y') AND (PM.STATUS \= 'N' OR PM.STATUS \= 'P') AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY   PM.EFFECTIVE_DATE DESC 
travel.copyquote.custName=SELECT PM.QUOTE_NO, PI.FIRST_NAME, (ISNULL(pm.PREMIUM,0) + ISNULL(pm.POLICY_FEE,0)) PREMIUM FROM HOME_POSITION_MASTER PM, LOGIN_MASTER LM, PERSONAL_INFO PI WHERE   PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND UPPER (PI.FIRST_NAME) \= UPPER (?) AND LM.LOGIN_ID \= PM.LOGIN_ID AND PI.STATUS \= 'Y' AND nullif(PM.REMARKS,'') is null AND nullif(PM.ADMIN_REFERRAL_STATUS,'') is null AND nullif(PM.PAYMENT_STATUS,'') IS NULL AND PM.QUOTE_NO IS NOT NULL AND (PM.LOGIN_ID\=? OR PM.APPLICATION_ID\=?) AND PM.PRODUCT_ID\=? AND ((PM.EFFECTIVE_DATE) >\= (SYSDATETIME()) OR PM.STATUS \!\= 'Y') AND (PM.STATUS \= 'Y' OR PM.STATUS \= 'N' OR PM.STATUS \= 'P')   AND PI.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   PERSONAL_INFO WHERE   CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY   PM.EFFECTIVE_DATE DESC
travel.quote.detail=SELECT A.CUSTOMER_ID, A.QUOTE_NO,convert(varchar,A.EFFECTIVE_DATE-30,103) QUOTE_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, ISNULL (B.FIRST_NAME, B.COMPANY_NAME) CUSTOMER_NAME FROM HOME_POSITION_MASTER A, PERSONAL_INFO B WHERE A.QUOTE_NO = ? AND A.CUSTOMER_ID = B.CUSTOMER_ID AND B.STATUS = 'Y' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.lapsed.update=UPDATE HOME_POSITION_MASTER SET STATUS= 'D',LAPSED_REMARKS=?,LAPSED_DATE=SYSDATETIME(), LAPSED_UPDATED_BY=? WHERE QUOTE_NO=?
travel.active.lapsed=UPDATE HOME_POSITION_MASTER SET EFFECTIVE_DATE\=DATEADD(DAY,30,SYSDATETIME()),INCEPTION_DATE\=SYSDATETIME() WHERE QUOTE_NO\=? 
travel.update.correction = UPDATE TRAVEL_DETAIL SET PREMIUM=?,PASSENGER_NAME=?,DOB=CONVERT(DATE,?,103),RELATION=?,GENDER=?,NATIONALITY=?,AGE=?,TYPE=(CASE WHEN ? <= 2 THEN 'C' WHEN ? BETWEEN 3 AND 18 THEN 'C' WHEN ? >=19 THEN 'A' END),PASSPORT_NO=?,PASSPORT_EXP_DATE=CONVERT(DATE,?,103),PASSANGER_LAST_NAME=? WHERE APPLICATION_NO=? AND SERIAL_NO=?
TRAVEL_CORRECTION_CHECK=select APPLICATION_NO from Home_position_master where INCEPTION_DATE>SYSDATETIME() AND quote_no=?
TRAVEL_GET_CUSTOMER_DETAILS = SELECT pi.CUSTOMER_ID, pi.TITLE ,ISNULL(pi.FIRST_NAME,'') + ' ' +' '+ ' ' + ISNULL(pi.LAST_NAME,'') CUS_NAME, pi.NATIONALITY, convert(date,pi.DOB,103) DOB, pi.GENDER, pi.TELEPHONE, pi.MOBILE, pi.FAX, pi.EMAIL, (pi.ADDRESS1+ ' ' +''+ ' ' + pi.ADDRESS2) address, pi.OCCUPATION,pi.POBOX, pi.COUNTRY, pi.EMIRATE,pi.CUSTOMER_SOURCE,pi.NATIONALITY,pi.AGENCY_CODE,pi.AC_EXECUTIVE_ID FROM PERSONAL_INFO pi, HOME_POSITION_MASTER hpm WHERE pi.CUSTOMER_ID = hpm.CUSTOMER_ID and hpm.qUOTE_NO =? AND hpm.PRODUCT_ID = ? and pi.status='Y' AND pi.amend_id=(select max(amend_id) from PERSONAL_INFO where CUSTOMER_ID=PI.CUSTOMER_ID)
TRAVEL_GET_PASSENGER_DETAILS = SELECT A.PASSENGER_NAME,convert(varchar(10),A.DOB,103) DOB,A.RELATION,A.NATIONALITY,A.GENDER,B.DETAIL_NAME FROM TRAVEL_DETAIL A,CONSTANT_DETAIL B WHERE B.CATEGORY_ID ='53'  AND A.RELATION=B.CATEGORY_DETAIL_ID AND B.BRANCH_CODE=? AND A.QUOTE_NO=?
TRAVEL_GET_CUSTOMER_POLICY_DETAILS = SELECT POLICY_NO, PREMIUM, convert(varchar(10),EXPIRY_DATE,103) EXPIRY_DATE,convert(varchar(10),INCEPTION_DATE,103)  EFFECTIVE_DATE, POLICY_TERM, REMARKS, LAPSED_REMARKS, convert(varchar(10),LAPSED_DATE,103) LAPSED_DATE, LAPSED_UPDATED_BY FROM HOME_POSITION_MASTER WHERE QUOTE_NO =?
INS_PERSONAL_INFO = INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,FIRST_NAME,EMAIL,ENTRY_DATE,LOGIN_ID,AMEND_ID,AGENCY_CODE,OA_CODE) VALUES(?,'1',?,?,SYSDATETIME(),?,'0','','')
UPDATE_PERSONAL_INFO = UPDATE PERSONAL_INFO SET ADDRESS1=?,POBOX=?,EMIRATE=?,TELEPHONE=?,MOBILE=?,OCCUPATION=?,CUSTOMER_SOURCE=?,STATUS='Y' WHERE CUSTOMER_ID=?
UPD_CUSTOMER_INFO = UPDATE PERSONAL_INFO SET FIRST_NAME=?,EMAIL=? WHERE CUSTOMER_ID=?
GET_B2CTRAVEL_USERLIST_ISSUER=SELECT LM.LOGIN_ID LOGIN_ID, LM.LOGIN_ID FIRST_NAME, BCM.COMPANY_NAME + ' ' + ' ( ' + ' ' + LM.LOGIN_ID + ' ' + ' ) ' USERNAME FROM LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE LM.AGENCY_CODE IN (SELECT DISTINCT LM.OA_CODE FROM HOME_POSITION_MASTER PM, LOGIN_MASTER LM WHERE PM.APPLICATION_ID != ? AND LM.LOGIN_ID = PM.LOGIN_ID AND PM.STATUS IN ('Y','P') AND PM.PRODUCT_ID = ?) AND LM.OA_CODE = BCM.AGENCY_CODE

##PROMO CODE
GET_MOTOR_PROMO_CODE_DETAILS=select PROMOCODE,EMPCODE,PROMO_YN,HAVEPROMO_YN from HOME_POSITION_MASTER where QUOTE_NO=?
GET_VALID_PROMOCODE = SELECT COUNT(*) FROM   MOTOR_PROMOCODE_MASTER WHERE PROMOCODE=? AND BRANCH_CODE=? AND STATUS='Y'
GET_VALID_PROMOCODE_EXPIRY = SELECT COUNT(*) FROM   MOTOR_PROMOCODE_MASTER WHERE PROMOCODE=? AND BRANCH_CODE=? AND STATUS='Y' AND CONVERT(smalldatetime,GETDATE()) BETWEEN  PERIOD_FROM AND PERIOD_TO
GET_EMPCODE_LENGTH = SELECT DISTINCT EMP_LENGTH FROM MOTOR_PROMOCODE_MASTER WHERE PROMOCODE=? AND BRANCH_CODE=? AND STATUS='Y' AND CONVERT(smalldatetime,GETDATE()) BETWEEN  PERIOD_FROM AND PERIOD_TO
GET_EMPCODE_LENGTH_BETWEEN = SELECT COUNT(*) FROM MOTOR_PROMOCODE_MASTER WHERE PROMOCODE=? AND BRANCH_CODE=? AND STATUS='Y' AND CONVERT(smalldatetime,GETDATE()) BETWEEN  PERIOD_FROM AND PERIOD_TO AND ISNULL(NULLIF(?,''),0) BETWEEN  ISNULL(EMP_LENGTH_MIN,-1) AND ISNULL(EMP_LENGTH_MAX,-1)
#GET_MOTOR_PROMO_CODE_COUNT=select COUNT(*) from HOME_POSITION_MASTER WHERE APPLICATION_NO=? AND PROMOCODE IS NOT NULL AND PROMO_YN='Y' AND HAVEPROMO_YN='Y'
GET_MOTOR_PROMO_CODE_COUNT=SELECT COUNT(*) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=? AND PROMOCODE IS NOT NULL AND PROMO_YN='Y' AND HAVEPROMO_YN='Y'
GET_PROMO_DETAILS_AGREE=SELECT AGREE_TITLE,AGREE_TITLE_AR,AGREE_DESC,AGREE_DESC_AR,AGENCY_CODE,PROMOCODE,PROMOCODE_DESC,PROMO_VALUE,STATUS, PERIOD_FROM,PERIOD_TO,EMP_LENGTH_MIN,EMP_LENGTH_MAX,(SELECT LG.USERNAME FROM LOGIN_MASTER LG WHERE MTR.AGENCY_CODE = LG.AGENCY_CODE ) BROKER_NAME FROM MOTOR_PROMOCODE_MASTER MTR WHERE PROMOCODE=? AND BRANCH_CODE=? AND STATUS='Y'



GET_PROMO_CODE_LIST = Select AGENCY_CODE,promo_id, Promocode,promocode_desc,promo_value,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) status,period_from,period_to,EMP_LENGTH_MIN,EMP_LENGTH_MAX,(select LG.USERNAME from login_master LG where MTR.AGENCY_CODE = LG.AGENCY_CODE ) BROKER_NAME from MOTOR_PROMOCODE_MASTER MTR where branch_code=?
GET_EDIT_PROMO_CODE_MASTER = select AGENCY_CODE,Promocode,promocode_desc,promo_value,status, period_from, period_to,EMP_LENGTH_MIN,EMP_LENGTH_MAX,(select LG.USERNAME from login_master LG where MTR.AGENCY_CODE = LG.AGENCY_CODE ) BROKER_NAME from MOTOR_PROMOCODE_MASTER MTR where promo_id =? and branch_code=?
INS_PROMO_CODE_MASTER = insert into MOTOR_PROMOCODE_MASTER (AGENCY_CODE,promo_id,Promocode,promocode_desc,period_from,period_to,EMP_LENGTH_MIN,EMP_LENGTH_MAX,promo_value,status,amend_id,product_id,branch_code) values (?,(select max(promo_id)+1 from MOTOR_PROMOCODE_MASTER),?,?,CONVERT(varchar(500),?,121),CONVERT(varchar(500),?,121),?,?,?,?,'0','65','01')
UPD_PROMO_CODE_MASTER = UPDATE MOTOR_PROMOCODE_MASTER SET Promocode=?,promocode_desc=?,period_from=?,period_to= ?,EMP_LENGTH_MIN=?,EMP_LENGTH_MAX=?,promo_value=?,status=? where promo_id=?
GET_USERNAME_LOGIN_DPDWN = select agency_code,username from login_master Where usertype='Broker' and agency_code not in (select distinct agency_code from MOTOR_TYPE_THIRD_PARTY)  order by agency_code desc

#TRAVEL REPORT CHART 
travel.report.chart.portfolio= SELECT  COUNT( a.quote_no) FROM HOME_POSITION_MASTER a, personal_info b    WHERE  A.EFFECTIVE_DATE <= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) and {0}  a.status= ''P'' AND a.AMEND_ID=''0'' AND b.customer_id= a.customer_id  AND a.product_id=? and a.APPLICATION_ID=?  AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.chart.quoteregister.lapsed=SELECT COUNT(a.quote_no)  FROM HOME_POSITION_MASTER a, personal_info PI WHERE  A.EFFECTIVE_DATE < CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) and A.effective_Date+30 >=SYSDATETIME() and {0} a.product_id =? and a.APPLICATION_ID=? AND a.status=''Y''  AND PI.customer_id = a.customer_id  AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
travel.quoteregister.chart.existing=SELECT COUNT( a.quote_no) FROM HOME_POSITION_MASTER a, personal_info b  WHERE {0}   A.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME)  AND a.status = ''Y'' AND NULLIF(a.remarks,'''') IS NULL  AND NULLIF(a.ADMIN_REFERRAL_STATUS,'''') IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ? AND a.APPLICATION_ID = ? AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.quote_no IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.unapproved=SELECT COUNT( a.quote_no) FROM home_position_master a, personal_info b   WHERE {0}  A.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.status = ''Y'' AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id =? AND a.APPLICATION_ID = ? AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.approved=SELECT COUNT( a.quote_no) FROM home_position_master a, personal_info b  WHERE {0}  A.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.status = ''Y'' AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Admin''))  AND a.product_id =?  and a.APPLICATION_ID=? AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.reject=SELECT COUNT( a.quote_no) FROM home_position_master a, personal_info b  WHERE {0}  A.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.status = ''R'' AND b.customer_id = a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id =?  and a.APPLICATION_ID=? AND  NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.chart.portfolio.amount= SELECT  sum( a.OVERALL_PREMIUM) FROM HOME_POSITION_MASTER a, personal_info b  WHERE  A.EFFECTIVE_DATE <= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND {0}  a.status= ''P'' AND a.AMEND_ID=''0'' AND b.customer_id= a.customer_id  AND a.product_id=? and a.APPLICATION_ID=? AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.chart.quoteregister.lapsed.amount=SELECT sum(NULLIF(a.OVERALL_PREMIUM,0))  FROM HOME_POSITION_MASTER a, personal_info PI WHERE  A.EFFECTIVE_DATE < CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) and A.effective_Date+30 >= SYSDATETIME() and  {0} a.product_id =? and a.APPLICATION_ID=?  AND  a.status=''Y''  AND PI.customer_id = a.customer_id AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
travel.quoteregister.chart.existing.amount=SELECT sum(NULLIF(a.OVERALL_PREMIUM,0)) FROM HOME_POSITION_MASTER a, personal_info b  WHERE {0}   A.EFFECTIVE_DATE >= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME)  AND a.status = ''Y'' AND NULLIF(a.remarks,'''') IS NULL  AND NULLIF(a.ADMIN_REFERRAL_STATUS,'''') IS NULL  AND b.customer_id = a.customer_id  AND a.product_id =? AND a.APPLICATION_ID = ? AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.quote_no IS NOT NULL AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
travel.report.referral.chart.unapproved.amount=SELECT sum(NULLIF(a.OVERALL_PREMIUM,0)) FROM home_position_master a, personal_info b   WHERE {0}  A.EFFECTIVE_DATE >\= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND (a.REMARKS IN (''Referal''))  AND a.product_id \=? AND a.APPLICATION_ID \= ? AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)  
travel.report.referral.chart.approved.amount=SELECT sum(NULLIF(a.OVERALL_PREMIUM,0)) FROM home_position_master a, personal_info b  WHERE {0}  A.EFFECTIVE_DATE >\= CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND (a.REMARKS IN (''Admin''))  AND a.product_id \=?  and a.APPLICATION_ID\=? AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.QUOTE_NO IS NOT NULL AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) 
travel.report.referral.chart.reject.amount=SELECT sum(NULLIF(a.OVERALL_PREMIUM,0)) FROM home_position_master a, personal_info b  WHERE {0} (A.STATUS IN (''D'', ''R'')) AND b.customer_id = a.customer_id AND a.product_id =?  and a.APPLICATION_ID=? AND NULLIF(a.PAYMENT_STATUS,'''') IS NULL AND A.effective_Date  >= SYSDATETIME() AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)


#HEALTH INSURANCE 
INS_POL_DTL=INSERT INTO HEALTH_POLICY_DETAIL(APPLICATION_NO,QUOTE_NO,SERIAL_NO,TITLE,CUST_NAME,CIVIL_ID,DOB,AGE,GENDER,MARTIAL_STATUS,OCCUPATION,RELATION,NATIONALITY,SPONSOR_ID,SPONSOR_NAME,SPONSOR_CITY,SPONSOR_MOBILE,AMEND_ID,STATUS) VALUES(?,?,?,?,?,?,CONVERT(DATE,?,103),?,?,?,?,?,?,?,?,?,?,?,?)
UPD_POL_DTL=UPDATE HEALTH_POLICY_DETAIL SET QUOTE_NO=?,TITLE=?,CUST_NAME=?,CIVIL_ID=?,DOB=CONVERT(DATE,?,103),AGE=?,GENDER=?,MARTIAL_STATUS=?,OCCUPATION=?,RELATION=?,NATIONALITY=?,SPONSOR_ID=?,SPONSOR_NAME=?,SPONSOR_CITY=?,SPONSOR_MOBILE=? WHERE APPLICATION_NO=? AND STATUS = 'Y'
INS_POL_MSTR=INSERT INTO HEALTH_POLICY_MASTER (APPLICATION_NO, QUOTE_NO, LOGIN_ID, CUSTOMER_ID, PRODUCTID,CLASS_ID, POLICY_TERM,INSURANCE_START_DATE, INSURANCE_END_DATE, ENTRY_DATE, EFFECTIVE_DATE,AMEND_ID,STATUS) VALUES(?,?,?,?,?,?,?,CONVERT(DATE,?,103),CONVERT(DATE,?,103),SYSDATETIME(),SYSDATETIME(),?,?)
UPD_POL_MSTR=UPDATE HEALTH_POLICY_MASTER SET QUOTE_NO=?, LOGIN_ID=?, CUSTOMER_ID=?, PRODUCTID=?,CLASS_ID=?, POLICY_TERM=?,INSURANCE_START_DATE=CONVERT(DATE,?,103), INSURANCE_END_DATE=CONVERT(DATE,?,103), EFFECTIVE_DATE=SYSDATETIME() WHERE APPLICATION_NO=? AND STATUS='Y'
INS_HOME_POS_MSTR_REF=INSERT INTO HOME_POSITION_MASTER(APPLICATION_NO,QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,BRANCH_CODE,POLICY_TERM,AMEND_ID,EFFECTIVE_DATE,EXPIRY_DATE,INCEPTION_DATE,ENTRY_DATE,STATUS,APPLICATION_ID,AGE_ABOVE_SIXTY_FIVE,EXISTING_MEDICAL_CONDITION,CLASS_ID,REMARKS,REFERRAL_DESCRIPTION,PROPOSAL_NO,ADMIN_REFERRAL_STATUS,COMPANY_ID) VALUES(?,?,?,?,?,?,?,?,DATEADD(DAY,30,SYSDATETIME()),CONVERT(DATE,?,103),CONVERT(DATE,?,103),SYSDATETIME(),?,?,?,?,?,'Referal',?,?,'Y','1')
INS_HOME_POS_MSTR=INSERT INTO HOME_POSITION_MASTER(APPLICATION_NO,QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,BRANCH_CODE,POLICY_TERM,AMEND_ID,EFFECTIVE_DATE,EXPIRY_DATE,INCEPTION_DATE,ENTRY_DATE,STATUS,APPLICATION_ID,AGE_ABOVE_SIXTY_FIVE,EXISTING_MEDICAL_CONDITION,CLASS_ID,ADMIN_REMARKS,PROPOSAL_NO,COMPANY_ID) VALUES(?,?,?,?,?,?,?,?,DATEADD(DAY,30,SYSDATETIME()),CONVERT(DATE,?,103),CONVERT(DATE,?,103),SYSDATETIME(),?,?,?,?,?,?,?,'1')
UPD_HOME_POS_MSTR_REF=UPDATE HOME_POSITION_MASTER SET AGE_ABOVE_SIXTY_FIVE = ?, INCEPTION_DATE = CONVERT(DATE,?,103), EXISTING_MEDICAL_CONDITION = ?, EXPIRY_DATE = CONVERT(DATE,?,103), EFFECTIVE_DATE = DATEADD(DAY,30,SYSDATETIME()) , CLASS_ID = ?, POLICY_TERM = ? ,PRODUCT_ID = ?, REFERRAL_DESCRIPTION = ?,ADMIN_REFERRAL_STATUS='Y',REMARKS = 'Referal',PREMIUM=null,OVERALL_PREMIUM=null,PROPOSAL_NO = ?,QUOTE_NO=?,STATUS=? WHERE  APPLICATION_NO = ?
UPD_HOME_POS_MSTR=UPDATE HOME_POSITION_MASTER SET AGE_ABOVE_SIXTY_FIVE = ? ,INCEPTION_DATE=CONVERT(DATE,?,103),EXISTING_MEDICAL_CONDITION = ? ,EXPIRY_DATE=CONVERT(DATE,?,103),EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),CLASS_ID = ? ,POLICY_TERM= ? ,PRODUCT_ID = ? ,ADMIN_REMARKS = ? ,REFERRAL_DESCRIPTION=null,REMARKS=null,ADMIN_REFERRAL_STATUS=null,PREMIUM=null,OVERALL_PREMIUM=null,PROPOSAL_NO = ?,QUOTE_NO=?,STATUS=?  WHERE  APPLICATION_NO = ?
UPD_HOME_POS_MSTR_ADMIN=UPDATE HOME_POSITION_MASTER SET AGE_ABOVE_SIXTY_FIVE = ? ,INCEPTION_DATE=CONVERT(DATE,?,103),EXISTING_MEDICAL_CONDITION = ? ,EXPIRY_DATE=CONVERT(DATE,?,103),EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),CLASS_ID = ? ,POLICY_TERM= ? ,PRODUCT_ID = ? ,APPROVED_BY = ?,PROPOSAL_NO = ?,QUOTE_NO=?,STATUS=?  WHERE  APPLICATION_NO = ?
CAL_HEALTH_PREMIUM_CALC={CALL HEALTH_PREMIUM_CALC(?,?,?,?,?,?)}
UPD_HEALTH_MSTR_PREMIUM=UPDATE HEALTH_POLICY_MASTER  SET TOTAL_PREMIUM=? WHERE APPLICATION_NO =? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM HEALTH_POLICY_MASTER WHERE APPLICATION_NO = HEALTH_POLICY_MASTER.APPLICATION_NO)
GET_POL_DTL=SELECT HPD.TITLE,HPD.CUST_NAME,HPD.CIVIL_ID,convert(varchar(10),HPD.DOB,103) DOB,HPD.GENDER,HPD.MARTIAL_STATUS,HPD.OCCUPATION,HPD.RELATION,HPD.NATIONALITY,HPD.SPONSOR_ID,HPD.SPONSOR_NAME,HPD.SPONSOR_CITY,HPD.SPONSOR_MOBILE,HPD.QUOTE_NO FROM HEALTH_POLICY_DETAIL HPD WHERE HPD.APPLICATION_NO=? AND HPD.AMEND_ID=(SELECT MAX(AMEND_ID) FROM HEALTH_POLICY_DETAIL WHERE APPLICATION_NO=HPD.APPLICATION_NO)
GET_POL_MSTR=SELECT HPM.POLICY_TERM,convert(varchar(10),HPM.INSURANCE_START_DATE,103) INSURANCE_START_DATE,convert(varchar(10),HPM.INSURANCE_END_DATE,103) INSURANCE_END_DATE,ISNULL(HPM.TOTAL_PREMIUM,'0') TOTAL_PREMIUM,CLASS_ID,DISCOUNT_PREMIUM FROM HEALTH_POLICY_MASTER  HPM WHERE HPM.APPLICATION_NO=? AND HPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM HEALTH_POLICY_DETAIL WHERE APPLICATION_NO=HPM.APPLICATION_NO)
GET_REQUIRED_DOC_LIST=SELECT HDM.DOC_ID,HDM.DOC_NAME FROM HEALTH_DOCUMENT_MASTER HDM WHERE HDM.PRODUCT_ID=? AND HDM.CLASS_ID=? AND EFF_DATE<=SYSDATETIME() AND HDM.STATUS='Y' AND HDM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM HEALTH_DOCUMENT_MASTER WHERE PRODUCT_ID=HDM.PRODUCT_ID AND CLASS_ID=HDM.CLASS_ID AND EFF_DATE<=SYSDATETIME() AND STATUS='Y') ORDER BY HDM.DOC_ID
GET_UPLOADED_DOC_LIST=SELECT HDD.APPLICATION_NO, HDD.DOC_ID,HDD.DOC_SNO , HDD.ORG_FILE_NAME, HDD.OUR_FILE_NAME,  HDD.FILE_LOCATION, HDD.DOC_DESC, HDD.UPLOAD_BY, convert(varchar(10),EFF_DATE,103) EFF_DATE, UPLOAD_BY,STATUS FROM HEALTH_DOC_UPLOAD_DETAIL HDD WHERE HDD.APPLICATION_NO=? AND HDD.DOC_ID=? AND HDD.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID), 0) FROM HEALTH_DOC_UPLOAD_DETAIL WHERE APPLICATION_NO=HDD.APPLICATION_NO AND DOC_ID=HDD.DOC_ID)
DOCUMENT_UPLOAD_MAX_ID = SELECT ISNULL(MAX(HDD.DOC_SNO), 0) FROM HEALTH_DOC_UPLOAD_DETAIL HDD WHERE HDD.APPLICATION_NO=? AND HDD.DOC_ID=? AND HDD.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID), 0) FROM HEALTH_DOC_UPLOAD_DETAIL WHERE APPLICATION_NO=HDD.APPLICATION_NO AND DOC_ID=HDD.DOC_ID)
INS_DOCUMENT_UPLOAD =INSERT INTO HEALTH_DOC_UPLOAD_DETAIL (APPLICATION_NO, DOC_ID, DOC_SNO, ORG_FILE_NAME, OUR_FILE_NAME, FILE_LOCATION, DOC_DESC, UPLOAD_BY, EFF_DATE,ENTRY_DATE, AMEND_ID,STATUS) VALUES ( ?, ?, ?+?, ?, ?, ?, ?, ?, SYSDATETIME(),SYSDATETIME(),'0','Y')
DEL_UPLOADED_DOC_DETAILS = DELETE FROM HEALTH_DOC_UPLOAD_DETAIL WHERE APPLICATION_NO=? AND DOC_ID=? AND DOC_SNO=?
ARRANGE_UPLOADED_DOC_LIST =UPDATE HEALTH_DOC_UPLOAD_DETAIL SET DOC_SNO=DOC_SNO-1 WHERE APPLICATION_NO = ? AND DOC_ID =? AND DOC_SNO>?
UPD_POL_MSTR_EXCESS_PREMIUM=UPDATE HEALTH_POLICY_MASTER SET DISCOUNT_PREMIUM=?,TOTAL_PREMIUM=? WHERE QUOTE_NO=?
GET_HEALTH_PDF_DTLS=SELECT HPM.QUOTE_NO,HPM.POLICY_NO,convert(varchar(10),HPM.EFFECTIVE_DATE,103) EFFECTIVE_DT,ISNULL(PI.FIRST_NAME,PI.COMPANY_NAME) PROP_NAME,PI.TELEPHONE,PI.CUSTOMER_SOURCE,PI.MOBILE,PI.FAX,HOM.OCCUPATION_NAME,PI.EMAIL,HD.TITLE,HD.CUST_NAME INS_NAME,HD.CIVIL_ID,HD.DOB,HD.AGE,HD.GENDER,HD.MARTIAL_STATUS,HD.OCCUPATION,HD.RELATION,HD.NATIONALITY,convert(varchar(10),HM.INSURANCE_START_DATE,103) INCEPTION_DT,convert(varchar(10),HM.INSURANCE_END_DATE,103) EXPIRY_DT,HM.CLASS_ID,ISNULL(HPM.PREMIUM,'0') PREMIUM,EXCESS_SIGN,ISNULL(EXCESS_PREMIUM,'0') EXCESS_PREMIUM,ISNULL(POLICY_FEE,'0') POLICY_FEE,ISNULL(OVERALL_PREMIUM,'0') OVERALL_PREMIUM FROM HOME_POSITION_MASTER HPM,PERSONAL_INFO PI,HEALTH_POLICY_MASTER HM, HEALTH_POLICY_DETAIL HD,HOME_OCCUPATION_MASTER HOM WHERE CAST(HPM.QUOTE_NO AS VARCHAR)=? AND HM.QUOTE_NO=HPM.QUOTE_NO AND HD.QUOTE_NO=HPM.QUOTE_NO AND PI.CUSTOMER_ID=HPM.CUSTOMER_ID AND HOM.OCCUPATION_ID=PI.OCCUPATION

#Motor Insurance
#INS_MOTOR_QUICK_CUS_DTL = INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,MOBILE,STATUS,ENTRY_DATE,LOGIN_ID,COMPANY_NAME,AGENCY_CODE,OA_CODE,CUST_NAME,CUSTOMER_TYPE,COMPANY_REG_NO,EMAIL,CUST_NAME_ARABIC,INSUREDID_VER_TYPE,INSURED_ID,DOB) VALUES (?,'1',?,?,?,'0',?,'Y',SYSDATETIME(),?,?,(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),?,?,?,?,?,?,?,CONVERT(DATE,nullif(?,''),103))
#INS_MOTOR_QUICK_CUS_DTL =INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,CUST_NAME_ARABIC,DOB,EMAIL,MOBILE,COMPANY_REG_NO,AMEND_ID,STATUS,ENTRY_DATE,LOGIN_ID,AGENCY_CODE,OA_CODE,CUST_NAME,CUSTOMER_TYPE,dob_ar,INSURED_ID) VALUES (?,'1',?,?,?,CONVERT(DATE,nullif(?,''),103),?,?,?,'0',?,SYSDATETIME(),?,(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),?,?,convert(varchar,format(convert(date,?,103),'yyyy-MM-dd','ar'),131),?)
INS_MOTOR_QUICK_CUS_DTL =INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,CUST_NAME_ARABIC,DOB,EMAIL,MOBILE,COMPANY_REG_NO,AMEND_ID,STATUS,ENTRY_DATE,LOGIN_ID,AGENCY_CODE,OA_CODE,CUST_NAME,CUSTOMER_TYPE,dob_ar,INSURED_ID) VALUES (?,'1',?,?,?,CONVERT(DATE,nullif(?,''),103),?,?,?,'0',?,SYSDATETIME(),?,(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?),?,?,FORMAT(convert(date,?,103),'yyyy-MM-dd','en-gb'),?)

#INS_MOTOR_CUS_DTL=INSERT INTO PERSONAL_INFO(CUSTOMER_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID, MOBILE,EMAIL,ADDRESS1,ADDRESS2,POBOX,EMIRATE,STATUS,ENTRY_DATE,LOGIN_ID, COMPANY_NAME,AGENCY_CODE,OA_CODE,MISSIPPI_CUSTOMER_CODE, CLIENT_CUSTOMER_ID,CUST_AR_NO,CUST_NAME,NRC,PASSPORT_NUMBER , DOB, DOB_AR, ALTERNATE_MOBILE,TELEPHONE,CUSTOMER_TYPE,COMPANY_REG_NO,CUST_NAME_ARABIC ,APPLICATION_ID,OCCUPATION,NATIONALITY,BUILDING_NO,ADDITIONAL_NO,ZIPCODE,NEIGHBORHOOD,UNITNO,STREET,ADDRESS_IDENTIFIER,INS_POCODE,INS_POBOX,INS_CITY,WASEEL_BUILDINGNO,WASEEL_ADDITIONAL_NO,WASEEL_ZIPCODE,WASEEL_CITY,WASEEL_NEIGHBORHOOD,INSUREDID_VER_TYPE,INSURED_ID,QUOTE_TYPE) VALUES (?,?,?,?,'0',?,?,?,?,?,?,'Y',SYSDATETIME(),?,?,( SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?),( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?),?,?,?,?,?,? ,CONVERT(DATE,nullif(?,''),103) ,FORMAT(CONVERT(DATE,? ,103), 'dd/MM/yyyy', 'ar-SA'),?,?,?,?,? ,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
INS_MOTOR_CUS_DTL=INSERT INTO PERSONAL_INFO(CUSTOMER_ID,TITLE,FIRST_NAME,LAST_NAME,OCCUPATION,NATIONALITY,BUILDING_NO,ADDITIONAL_NO,ZIPCODE,EMIRATE,NEIGHBORHOOD,UNITNO,STREET,ADDRESS_IDENTIFIER,INS_POCODE,INS_POBOX,INS_CITY,WASEEL_BUILDINGNO,WASEEL_ADDITIONAL_NO,WASEEL_ZIPCODE,WASEEL_CITY,WASEEL_NEIGHBORHOOD,AMEND_ID,STATUS,ENTRY_DATE,LOGIN_ID,AGENCY_CODE,OA_CODE,CUST_NAME,APPLICATION_ID,QUOTE_TYPE) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,'0','Y',SYSDATETIME(),?,( SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?),( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?),?,?,?)  
#UPD_MOTOR_CUS_DTL=UPDATE PERSONAL_INFO  SET TITLE\=?,FIRST_NAME\=?,LAST_NAME\=?,MOBILE\=?,EMAIL\=?,ADDRESS1\=?,ADDRESS2\=?,POBOX\=?,EMIRATE\=?,STATUS\='Y',EFFECTIVE_DATE\=SYSDATETIME(),COMPANY_NAME\=?,AGENCY_CODE\=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?),OA_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?),MISSIPPI_CUSTOMER_CODE\=NULLIF(?,'0'),CLIENT_CUSTOMER_ID\=?,CUST_AR_NO\=?,CUST_NAME\=?, NRC\=?, PASSPORT_NUMBER\=?, DOB\=CONVERT(DATE,nullif(?,''),103), DOB_AR\=FORMAT(CONVERT(DATE,? ,103), 'dd/MM/yyyy', 'ar-SA'), ALTERNATE_MOBILE\=?, TELEPHONE\=?,CUSTOMER_TYPE\=?,COMPANY_REG_NO\=?,CUST_NAME_ARABIC\=?,APPLICATION_ID\=?,OCCUPATION\=?,LOGIN_ID\=? ,NATIONALITY\=?,BUILDING_NO\=? ,ADDITIONAL_NO\=?,ZIPCODE\=?,NEIGHBORHOOD\=?,UNITNO\=?,STREET\=?,ADDRESS_IDENTIFIER\=?,INS_POCODE\=?,INS_POBOX\=?,INS_CITY\=?,WASEEL_BUILDINGNO\=?,WASEEL_ADDITIONAL_NO\=?,WASEEL_ZIPCODE\=?,WASEEL_CITY\=?,WASEEL_NEIGHBORHOOD\=?,INSUREDID_VER_TYPE \= ?,INSURED_ID\=?,QUOTE_TYPE \= ? WHERE CUSTOMER_ID\=?
UPD_MOTOR_CUS_DTL=UPDATE PERSONAL_INFO  SET TITLE\=?,FIRST_NAME\=?,LAST_NAME\=?,OCCUPATION\=?,NATIONALITY\=?,BUILDING_NO\=?,ADDITIONAL_NO\=?,ZIPCODE\=?,EMIRATE\=?,NEIGHBORHOOD\=?,UNITNO\=?,STREET\=?,ADDRESS_IDENTIFIER\=?,INS_POCODE\=?,INS_POBOX\=?,INS_CITY\=?,WASEEL_BUILDINGNO\=?,WASEEL_ADDITIONAL_NO\=?,WASEEL_ZIPCODE\=?,WASEEL_CITY\=?,WASEEL_NEIGHBORHOOD\=?,STATUS\='Y',ENTRY_DATE\=SYSDATETIME(),LOGIN_ID\=?,AGENCY_CODE\=( SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?),OA_CODE\=( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?),CUST_NAME\=?,QUOTE_TYPE\=?,POBOX\=? WHERE CUSTOMER_ID\=? 
UPD_MOTOR_YAKEEN_CUS_DTL=UPDATE PERSONAL_INFO  SET BUILDING_NO=?,ADDITIONAL_NO=?,ZIPCODE=?,EMIRATE=?,NEIGHBORHOOD=?,UNITNO=?,STREET=?,ADDRESS_IDENTIFIER=?,INS_POCODE=?,INS_POBOX=?,INS_CITY=?,WASEEL_BUILDINGNO=?,WASEEL_ADDITIONAL_NO=?,WASEEL_ZIPCODE=?,WASEEL_CITY=?,WASEEL_NEIGHBORHOOD=?,STATUS='Y',CITY_CODE=(SELECT   AREACOVER_CODE FROM   MOTOR_AREACOVERAGE_MASTER  MAM WHERE   STATUS = 'Y' AND BRANCH_CODE = '01' AND AMEND_ID =( SELECT   MAX (AMEND_ID) FROM   MOTOR_AREACOVERAGE_MASTER WHERE  AREACOVER_CODE=MAM.AREACOVER_CODE AND  BRANCH_CODE=MAM.BRANCH_CODE) AND UPPER(AREACOVER_DESC_ENGLISH) = UPPER(?)),WASEEL_CITY_CODE=(SELECT   AREACOVER_CODE FROM   MOTOR_AREACOVERAGE_MASTER  MAM WHERE   STATUS = 'Y' AND BRANCH_CODE = '01' AND AMEND_ID =( SELECT   MAX (AMEND_ID) FROM   MOTOR_AREACOVERAGE_MASTER WHERE  AREACOVER_CODE=MAM.AREACOVER_CODE AND  BRANCH_CODE=MAM.BRANCH_CODE) AND UPPER(AREACOVER_DESC_ENGLISH) = UPPER(?) ) WHERE CUSTOMER_ID=?
UPD_CUSTOMER_ID_HPM = UPDATE HOME_POSITION_MASTER SET CUSTOMER_ID=? WHERE APPLICATION_NO=?
UPD_CUSTOMER_ID_MD =  UPDATE MOTOR_DATA_DETAIL SET CUSTOMER_ID=? WHERE APPLICATION_NO=?
UPD_APPLICATION_NO=UPDATE PERSONAL_INFO SET APPLICATION_ID='2' WHERE CUSTOMER_ID=?
UPD_LOGIN_PERSONAL_INFO=UPDATE PERSONAL_INFO SET LOGIN_ID=? WHERE CUSTOMER_ID=(SELECT CUSTOMER_ID FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?)
UPD_LOGIN_HOME_POSITION_MASTER=UPDATE HOME_POSITION_MASTER SET LOGIN_ID=? WHERE APPLICATION_NO=?
# For Temp Purpose  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO P WHERE P.CUSTOMER_ID=CUSTOMER_ID)
GET_MOTOR_CUS_CNT = SELECT COUNT(*) FROM PERSONAL_INFO WHERE CUSTOMER_ID=?
GET_HOM_POS_CNT = SELECT COUNT(*) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?
#GET_MOTOR_DTL_CNT = SELECT COUNT(*) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=? AND VEHICLE_ID=?
GET_MOTOR_DTL_CNT = SELECT COUNT(*) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?
GET_MOTOR_DTL_VEHICLE_COUNT = SELECT COUNT(*) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO\=? 
INS_MOTOR_HOME_POS_DTLS=INSERT INTO HOME_POSITION_MASTER (QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,APPLICATION_NO,STATUS,COMPANY_ID,EFFECTIVE_DATE,ENTRY_DATE,FLEET_NO,BRANCH_CODE,APPLICATION_ID,ADMIN_REMARKS,BROKER_CODE,AC_EXECUTIVE_ID,PROMOCODE,EMPCODE,PROMO_YN,HAVEPROMO_YN,SMS_YN,LANG) VALUES(?,?,?,?,?,CONVERT(DATE,?,103),CONVERT(DATE,?,103),?,?,?,DATEADD(DAY,30,SYSDATETIME()),SYSDATETIME(),?,?,?,?,?,?,?,?,?,?,?,?)
UPD_MOTOR_HOME_POS_DTLS=UPDATE HOME_POSITION_MASTER SET INCEPTION_DATE=CONVERT(DATE,?,103),EXPIRY_DATE=CONVERT(DATE,?,103),EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),REFERRAL_DESCRIPTION=?,REMARKS=NULL,ADMIN_REFERRAL_STATUS=NULL,STATUS=?,BROKER_CODE=?,AC_EXECUTIVE_ID=?, APPLICATION_ID=?,CUSTOMER_ID=?,PROMOCODE=?,EMPCODE=?,PROMO_YN=?,HAVEPROMO_YN=?,ENTRY_DATE=SYSDATETIME(),LANG=? WHERE APPLICATION_NO=?
UPD_MOTOR_HOME_POS_DTLS_ADMIN=UPDATE HOME_POSITION_MASTER SET INCEPTION_DATE=CONVERT(DATE,?,103),EXPIRY_DATE=CONVERT(DATE,?,103),EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),APPROVED_BY = ?,STATUS=?,BROKER_CODE=?,AC_EXECUTIVE_ID=?,CUSTOMER_ID=? WHERE APPLICATION_NO=?
UPD_MOTOR_ADMIN_REFSTATUS=UPDATE HOME_POSITION_MASTER SET REMARKS=?,ADMIN_REMARKS=?,EXCESS_PREMIUM=?,ADMIN_REFERRAL_STATUS='N',STATUS=?,EXCESS_SIGN=?,EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),OVERALL_PREMIUM=?,COMMISSION=?,APPROVED_BY=(SELECT ISNULL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?),PREMIUM=? WHERE QUOTE_NO=?
UPD_MOTOR_REFSTATUS = UPDATE HOME_POSITION_MASTER SET REFERRAL_DESCRIPTION=?,REMARKS=?,ADMIN_REFERRAL_STATUS=? WHERE APPLICATION_NO=?

GET_POLICY_POLICY_PERIOD_COUNT=SELECT COUNT(*) FROM DUAL  WHERE CONVERT(DATE,?,103) BETWEEN CAST(GETDATE()+1 AS DATE)   AND CAST(GETDATE()+16 AS DATE)

##INS_MOTOR_DATA_DTLS=INSERT INTO MOTOR_DATA_DETAIL (QUOTE_NO,CUSTOMER_ID,PRODUCT_ID,AMEND_ID,ENTRY_DATE,APPLICATION_NO,STATUS,MAKE_ID,MODEL_ID,BODY,MANUFACTURE_YEAR,CUBIC_CAPACITY,SEATING_CAPACITY,SUMINSURED_VALUE_LOCAL,AGENCY_REPAIR,NO_OF_CYLINDER,VEHICLE_TYPE,DRIVER_UAE_LICENCE,CLAIMYN,CLAIM_AMOUNT,NO_OF_CLAIMS,NO_CLAIM_BONUS,SEQUENCE_NO,DRIVER_DOB,INCEPTION_DATE,EXPIRY_DATE,THIRD_PARTY_LIABILITY,EXCESS,DRIVER_NATIONALITY,DRIVER_UAE_LIC_EXP_DT,REFERRAL_REMARKS,DEDUCTIBLE_ID,DRIVER_ID,VEHICLE_ID,DRIVER_NAME_ENG,DRIVER_NAME_ARABIC,HIJRI_ISSUE_DATE,HIJRI_EFF_DATE,HIJRI_EXPIRE_DATE,GRE_ISSUE_DATE, GRE_EFF_DATE,GRE_EXPIRE_DATE,VEHICLE_ISSUE_DATE,VEHICLE_INCEPTION_DATE,VEHICLE_EXPIRY_DATE,NCD_YN,Customs_Id,owner_id,TRANSFEROWNER,TRANSFEROWNERID,OWNERDRIVERYN) values(?,?,?,?,SYSDATETIME(),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,CONVERT(DATE,?,103),CONVERT(DATE,?,103),CONVERT(DATE,?,103),?,?,?,CONVERT(DATE,?,103),?,?,?,?,?,?,convert(date,FORMAT(getdate(),'dd/MM/yyyy','ar'),103),CONVERT(DATE,?,103),CONVERT(DATE,?,103),SYSDATETIME(),CONVERT(DATE,?,103),CONVERT(DATE,?,103),SYSDATETIME(),CONVERT(DATE,?,103),CONVERT(DATE,?,103),?,?,?,?,?,?)
##UPD_MOTOR_DATA_DTLS=UPDATE MOTOR_DATA_DETAIL SET CUSTOMER_ID\=?,MAKE_ID\=?,MODEL_ID\=?,BODY\=?,MANUFACTURE_YEAR\=?,CUBIC_CAPACITY\=?,SEATING_CAPACITY\=?,SUMINSURED_VALUE_LOCAL\=?,AGENCY_REPAIR\=?,NO_OF_CYLINDER\=?,VEHICLE_TYPE\=?,DRIVER_UAE_LICENCE\=?,CLAIMYN\=?,CLAIM_AMOUNT\=?,NO_OF_CLAIMS\=?,NO_CLAIM_BONUS\=?,SEQUENCE_NO\=?,DRIVER_DOB\=CONVERT(DATE,?,103),INCEPTION_DATE\=CONVERT(DATE,?,103),EXPIRY_DATE\=CONVERT(DATE,?,103),THIRD_PARTY_LIABILITY\=?,EXCESS\=?,DRIVER_NATIONALITY\=?,DRIVER_UAE_LIC_EXP_DT\=CONVERT(DATE,?,103),REFERRAL_REMARKS\=?,DEDUCTIBLE_ID\=?,DRIVER_ID\=?,DRIVER_NAME_ENG\=?,DRIVER_NAME_ARABIC\=?,HIJRI_ISSUE_DATE\=convert(date,FORMAT(getdate(),'dd/MM/yyyy','ar'),103),HIJRI_EFF_DATE\=CONVERT(DATE,?,103),HIJRI_EXPIRE_DATE\=CONVERT(DATE,?,103),GRE_ISSUE_DATE \=SYSDATETIME(), GRE_EFF_DATE \=CONVERT(DATE,?,103) ,GRE_EXPIRE_DATE \=CONVERT(DATE,?,103),VEHICLE_ISSUE_DATE \=SYSDATETIME(),VEHICLE_INCEPTION_DATE\=CONVERT(DATE,?,103),VEHICLE_EXPIRY_DATE\=CONVERT(DATE,?,103),NCD_YN\=?,Customs_Id\=?,TRANSFEROWNER\=?,TRANSFEROWNERID\=?,OWNERDRIVERYN\=?,owner_id\=?   WHERE APPLICATION_NO\=? AND VEHICLE_ID\=?
INS_MOTOR_DATA_DTLS=INSERT INTO MOTOR_DATA_DETAIL (QUOTE_NO,CUSTOMER_ID,PRODUCT_ID,AMEND_ID,ENTRY_DATE,APPLICATION_NO,STATUS,MAKE_ID,MODEL_ID,BODY,MANUFACTURE_YEAR,CUBIC_CAPACITY,SEATING_CAPACITY,SUMINSURED_VALUE_LOCAL,AGENCY_REPAIR,NO_OF_CYLINDER,VEHICLE_TYPE,DRIVER_UAE_LICENCE,CLAIMYN,CLAIM_AMOUNT,NO_OF_CLAIMS,NO_CLAIM_BONUS,SEQUENCE_NO,DRIVER_DOB,INCEPTION_DATE,EXPIRY_DATE,THIRD_PARTY_LIABILITY,EXCESS,DRIVER_NATIONALITY,DRIVER_UAE_LIC_EXP_DT,REFERRAL_REMARKS,DEDUCTIBLE_ID,DRIVER_ID,VEHICLE_ID,DRIVER_NAME_ENG,DRIVER_NAME_ARABIC,HIJRI_ISSUE_DATE,HIJRI_EFF_DATE,HIJRI_EXPIRE_DATE,GRE_ISSUE_DATE, GRE_EFF_DATE,GRE_EXPIRE_DATE,VEHICLE_ISSUE_DATE,VEHICLE_INCEPTION_DATE,VEHICLE_EXPIRY_DATE,NCD_YN,Customs_Id,owner_id,TRANSFEROWNER,TRANSFEROWNERID,OWNERDRIVERYN) values(?,?,?,?,SYSDATETIME(),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,CONVERT(DATE,?,103),CONVERT(DATE,?,103),CONVERT(DATE,?,103),?,?,?,CONVERT(DATE,?,103),?,?,?,?,?,?,FORMAT(CONVERT(DATE,getdate(),103),'yyyy-MM-dd','AR'),FORMAT(CONVERT(DATE,?,103),'yyyy-MM-dd','AR'),FORMAT(CONVERT(DATE,?,103),'yyyy-MM-dd','AR'),SYSDATETIME(),CONVERT(DATE,?,103),CONVERT(DATE,?,103),SYSDATETIME(),CONVERT(DATE,?,103),CONVERT(DATE,?,103),?,?,?,?,?,?)
UPD_MOTOR_DATA_DTLS=UPDATE MOTOR_DATA_DETAIL SET CUSTOMER_ID\=?,MAKE_ID\=?,MODEL_ID\=?,BODY\=?,MANUFACTURE_YEAR\=?,CUBIC_CAPACITY\=?,SEATING_CAPACITY\=?,SUMINSURED_VALUE_LOCAL\=?,AGENCY_REPAIR\=?,NO_OF_CYLINDER\=?,VEHICLE_TYPE\=?,DRIVER_UAE_LICENCE\=?,CLAIMYN\=?,CLAIM_AMOUNT\=?,NO_OF_CLAIMS\=?,NO_CLAIM_BONUS\=?,SEQUENCE_NO\=?,DRIVER_DOB\=CONVERT(DATE,?,103),INCEPTION_DATE\=CONVERT(DATE,?,103),EXPIRY_DATE\=CONVERT(DATE,?,103),THIRD_PARTY_LIABILITY\=?,EXCESS\=?,DRIVER_NATIONALITY\=?,DRIVER_UAE_LIC_EXP_DT\=CONVERT(DATE,?,103),REFERRAL_REMARKS\=?,DEDUCTIBLE_ID\=?,DRIVER_ID\=?,DRIVER_NAME_ENG\=?,DRIVER_NAME_ARABIC\=?,HIJRI_ISSUE_DATE\=FORMAT(CONVERT(DATE,getdate(),103),'yyyy-MM-dd','AR'),HIJRI_EFF_DATE\=FORMAT(CONVERT(DATE,?,103),'yyyy-MM-dd','AR'),HIJRI_EXPIRE_DATE\=FORMAT(CONVERT(DATE,?,103),'yyyy-MM-dd','AR'),GRE_ISSUE_DATE \=SYSDATETIME(), GRE_EFF_DATE \=CONVERT(DATE,?,103) ,GRE_EXPIRE_DATE \=CONVERT(DATE,?,103),VEHICLE_ISSUE_DATE \=SYSDATETIME(),VEHICLE_INCEPTION_DATE\=CONVERT(DATE,?,103),VEHICLE_EXPIRY_DATE\=CONVERT(DATE,?,103),NCD_YN\=?,Customs_Id\=?,TRANSFEROWNER\=?,TRANSFEROWNERID\=?,OWNERDRIVERYN\=?,owner_id\=?   WHERE APPLICATION_NO\=? AND VEHICLE_ID\=?
UPD_MOTOR_DATA_DTLS_DATE=UPDATE MOTOR_DATA_DETAIL SET HIJRI_ISSUE_DATE\=FORMAT(CONVERT(DATE,getdate(),103),'yyyy-MM-dd','AR'),GRE_ISSUE_DATE \=SYSDATETIME(), VEHICLE_ISSUE_DATE \=SYSDATETIME() WHERE APPLICATION_NO\=? AND VEHICLE_ID\=?
### DELETE INSERT  
DEL_MOTOR_DTL_CNT = DELETE FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO\=? 

GET_DATE_CONVERT =SELECT   DBO.DATE_CONVERT(?,?)  FROM DUAL
UPD_STATUS_MOTOR_DATA_DETAILS = UPDATE MOTOR_DATA_DETAIL SET STATUS\=? WHERE QUOTE_NO \= ?
GET_MOTOR_DATA_DTLS = SELECT HPM.QUOTE_NO,CONVERT (VARCHAR,HPM.ENTRY_DATE,103) ENTRY_DATE, CONVERT (VARCHAR,HPM.INCEPTION_DATE,103) INCEPTION_DATE, CONVERT(VARCHAR,HPM.EXPIRY_DATE,103) EXPIRY_DATE, HPM.CUSTOMER_ID, HPM.BROKER_CODE, HPM.AC_EXECUTIVE_ID, HPM.LOGIN_ID,HPM.PROMOCODE,HPM.EMPCODE,HPM.PROMO_YN,HPM.HAVEPROMO_YN FROM HOME_POSITION_MASTER HPM WHERE HPM.APPLICATION_NO=? AND HPM.PRODUCT_ID=? AND HPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO = HPM.APPLICATION_NO AND PRODUCT_ID = HPM.PRODUCT_ID)
GET_MOTOR_POL_TYPE_IDS=SELECT SUBSTR (SYS_CONNECT_BY_PATH (POLICYTYPE_IDS,','),2) POLICYTYPE_IDS FROM (SELECT POLICYTYPE_IDS,ROW_NUMBER () OVER (ORDER BY POLICYTYPE_IDS) RN,COUNT(*) OVER() CNT FROM MOTOR_BROKER_POLICYTYPE_MASTER MP WHERE BROKER_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_BROKER_POLICYTYPE_MASTER WHERE BROKER_ID=MP.BROKER_ID AND BRANCH_CODE=MP.BRANCH_CODE AND PRODUCT_ID=MP.PRODUCT_ID AND POLICYTYPE_IDS=MP.POLICYTYPE_IDS)) WHERE RN=CNT START WITH RN=1 CONNECT BY RN = PRIOR RN+1
GET_MOTOR_POL_MSTR=SELECT POLICYTYPE_ID,POLICYTYPE_DESC_ENGLISH FROM MOTOR_POLICYTYPE_MASTER WHERE BRANCH_CODE=? AND POLICYTYPE_ID+ ' ' +AMEND_ID IN (SELECT POLICYTYPE_ID+ ' ' +MAX(AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE BRANCH_CODE=? GROUP BY POLICYTYPE_ID) {0}
GET_MOTOR_COVERAGE_DTLS=SELECT POLICYTYPE_COVERID,GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE FROM MOTOR_POLICY_COVER_DETAIL A WHERE POLICYTYPE_ID=? AND POLICYCOVER_ID=0 AND BRANCH_CODE=? AND TYPE_OF_BODY=? AND STATUS='Y' AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_ID=A.POLICYTYPE_ID AND POLICYCOVER_ID=0 AND BRANCH_CODE=A.BRANCH_CODE AND TYPE_OF_BODY=A.TYPE_OF_BODY AND POLICYTYPE_COVERID=A.POLICYTYPE_COVERID)
GET_MOTOR_POL_COVERAGE_ALL_DTLS=SELECT Y_ID,DESCRIPTION, SUM(DATA_VALUE) DATA_VALUE,IS_SELECTED,IS_ADDON,DELETABLE FROM MOTOR_POLICY_COVERAGE MPC WHERE     STATUS = 'Y' AND APPLICATION_NO = ? AND GROUP_ID = ? AND X_ID = ? GROUP BY Y_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE ORDER BY Y_ID
GET_MOTOR_BRPOLTYPEMSTR_RATE=SELECT RATE_ONE,RATE_TWO,RATE_THREE,RATE_FOUR FROM MOTOR_BROKER_POLICYTYPE_MASTER MP WHERE MP.PRODUCT_ID = ? AND MP.BROKER_ID = (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE UPPER (USERTYPE) = 'BROKER' AND OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = ?)) AND MP.BRANCH_CODE = ? AND MP.POLICYTYPE_IDS=?
DEL_MOTOR_POL_COV1=DELETE FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND X_ID=? AND Y_ID NOT IN(?)
GET_MOTOR_POL_COV_CNT=SELECT COUNT(*) FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND X_ID=? AND Y_ID=?
INS_MOTOR_POL_COV=INSERT INTO MOTOR_POLICY_COVERAGE (APPLICATION_NO,X_ID,X_DATA_NAME,Y_ID,Y_DATA_NAME,DATA_VALUE,ENTRY_DATE,UPDATED_DATE,REMARKS,STATUS,GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE,RATE,BASE_RATE,MIN_PREMIUM) VALUES (?,?,?,?,(SELECT GROUP_DESC_ENGLISH FROM MOTOR_GROUP_MASTER WHERE GROUP_ID=0 AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_GROUP_MASTER WHERE GROUP_ID=0)),?,SYSDATETIME(),SYSDATETIME(),NULL,'Y',?,?,?,?,?,?,?,?)
UPD_MOTOR_POL_COV=UPDATE MOTOR_POLICY_COVERAGE SET (DATA_VALUE,GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE,RATE,BASE_RATE,MIN_PREMIUM) = ( select ?,?,?,?,?,?,?,?,? ) WHERE APPLICATION_NO=? AND X_ID=? AND Y_ID=?
DEL_MOTOR_POL_COV2=DELETE FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND X_ID=?
GET_MOTOR_AGENCY_CODE=SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE UPPER(USERTYPE)='BROKER' AND OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=(SELECT LOGIN_ID FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?))
GET_MOTOR_AG_CODE=SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE UPPER(USERTYPE)='BROKER' AND OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GET_MOTOR_DRIVER_AGE_CNT=SELECT COUNT(*) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND (SELECT  round(floor(datediff(month,SYSDATETIME(),convert(date,?,103)))/12) FROM DUAL) BETWEEN DRIVER_START_AGE AND DRIVER_END_AGE AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? AND (AGENCY_CODE IN (''{0}'') OR AGENCY_CODE IS NULL) AND TYPEID+ ' ' +AMEND_ID IN (SELECT TYPEID+ ' ' +MAX(AMEND_ID) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? GROUP BY TYPEID)
GET_MOTOR_UAE_LICENCE_CNT=SELECT COUNT(*) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND ? BETWEEN UAE_LICENCE_START AND UAE_LICENCE_END AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? AND (AGENCY_CODE IN (''{0}'') OR AGENCY_CODE IS NULL) AND TYPEID+ ' ' +AMEND_ID IN (SELECT TYPEID+ ' ' +MAX(AMEND_ID) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? GROUP BY TYPEID)
GET_MOTOR_VEHICLE_TYPE_CNT=SELECT COUNT(*) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND VEHICLE_TYPE=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? AND (AGENCY_CODE IN (''{0}'') OR AGENCY_CODE IS NULL) AND TYPEID+ ' ' +AMEND_ID IN (SELECT TYPEID+ ' ' +MAX(AMEND_ID) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? GROUP BY TYPEID)
GET_MOTOR_TYPE_INFO1=SELECT TYPEID,MODEL_ID,ISNULL(AGENCY_CODE,'None') AG_CODE FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=?
GET_MOTOR_TYPE_INFO2= AND (SELECT  ROUND(FLOOR(MONTHS_BETWEEN(SYSDATETIME(),convert(date,''{0}'',103))) / 12) ) BETWEEN DRIVER_START_AGE AND DRIVER_END_AGE
GET_MOTOR_TYPE_INFO3= AND ''{0}'' BETWEEN UAE_LICENCE_START AND UAE_LICENCE_END
GET_MOTOR_TYPE_INFO4= AND VEHICLE_TYPE=''{0}''
GET_MOTOR_TYPE_INFO5= AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? AND (AGENCY_CODE IN (''{0}'') OR AGENCY_CODE IS NULL) AND TYPEID+ ' ' +AMEND_ID IN (SELECT TYPEID+ ' ' +MAX(AMEND_ID) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=? GROUP BY TYPEID)
GET_MOTOR_YEAR_CNT=SELECT ROUND(MONTHS_BETWEEN(SYSDATETIME(),DATEPART(YEAR,?) YEAR FROM DUAL
GET_MOTOR_POL_COV_DTLS=SELECT A.POLICYTYPE_COVERID,B.OPCOVER_DESC_ENGLISH,A.POLICYCOVER_ID,A.CALC_TYPE FROM MOTOR_POLICY_COVER_DETAIL A,MOTOR_OPCOVER_MASTER B WHERE B.OPCOVER_ID=A.POLICYCOVER_ID AND B.OPCOVER_ID!=0 AND A.POLICYTYPE_ID=? AND A.TYPE_OF_BODY=? AND A.AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_ID=A.POLICYTYPE_ID AND BRANCH_CODE=A.BRANCH_CODE AND TYPE_OF_BODY=A.TYPE_OF_BODY AND POLICYTYPE_COVERID=A.POLICYTYPE_COVERID) AND B.AMEND_ID IN(SELECT MAX(D.AMEND_ID) FROM MOTOR_OPCOVER_MASTER D WHERE D.OPCOVER_ID=B.OPCOVER_ID AND B.BRANCH_CODE=D.BRANCH_CODE)  AND A.BRANCH_CODE=? AND A.BRANCH_CODE=B.BRANCH_CODE AND A.STATUS='Y' AND B.STATUS='Y' ORDER BY A.POLICYTYPE_COVERID
INS_MOTOR_POL_COV_DTL=INSERT INTO MOTOR_POLICY_COVERAGE (APPLICATION_NO,X_ID,X_DATA_NAME,Y_ID,Y_DATA_NAME,DATA_VALUE,ENTRY_DATE,UPDATED_DATE,REMARKS,STATUS,GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE,RATE,BASE_RATE) (SELECT ?,?,?,?,?,((CASE WHEN (POLICYCOVER_ID=2 OR POLICYCOVER_ID=14 OR POLICYCOVER_ID=16) THEN {0} ELSE 1 END)*({1})),SYSDATETIME(),SYSDATETIME(),NULL,''Y'',GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE{2} FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=?))
UPD_MOTOR_POL_COV_DTL=UPDATE MOTOR_POLICY_COVERAGE MC SET (DATA_VALUE,GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE,RATE,BASE_RATE)= (SELECT ((CASE WHEN (POLICYCOVER_ID=2 OR POLICYCOVER_ID=14 OR POLICYCOVER_ID=16) THEN {0} ELSE 1 END)*({1})),GROUP_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE {2} FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=MC.Y_ID AND BRANCH_CODE=? AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=?)), UPDATED_DATE=SYSDATETIME() WHERE APPLICATION_NO=? AND X_ID=? AND Y_ID=?
GET_MOTOR_VEHICLE_AGE=SELECT COUNT(*) FROM MOTOR_BODYTYPE_MASTER M WHERE BRANCH_CODE=? AND PRODUCT_ID=? AND TYPE_OF_BODY_ID=? AND STATUS='Y' AND NO_OF_YEARS_ALLOWED>? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_MASTER WHERE BRANCH_CODE=M.BRANCH_CODE AND PRODUCT_ID=M.PRODUCT_ID AND TYPE_OF_BODY_ID=M.TYPE_OF_BODY_ID)
GET_MOTOR_COMPREHENSIVE_RATE=SELECT RATE,(CASE WHEN MINIMUM_PREMIUM<(SELECT MIN_PREMIUM_AMOUNT FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=?  AND PRODUCT_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? AND PRODUCT_ID=?)) THEN (SELECT MIN_PREMIUM_AMOUNT FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? AND PRODUCT_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? AND PRODUCT_ID=?)) ELSE MINIMUM_PREMIUM END) PREMIUM FROM MOTOR_TYPE_BODY_RATE WHERE AGENCY_REPAIR_YEAR=? AND ? BETWEEN  SEATING_TON_START AND SEATING_TON_END  AND ? BETWEEN START_SUMINSURED AND END_SUMINSURED AND TYPEID=?  AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS='Y' AND POLICYTYPE_ID=? AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM  MOTOR_TYPE_BODY_RATE  WHERE AGENCY_REPAIR_YEAR=? AND TYPEID=?  AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS='Y' AND POLICYTYPE_ID=?)
GET_MOTOR_THIRD_PARTY_RATE=SELECT THIRD_PARTY_RATE RATE FROM MOTOR_TYPE_THIRD_PARTY WHERE TYPEID=? AND SEATING_CYLINDER=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS='Y' AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE TYPEID=? AND SEATING_CYLINDER=? AND BRANCH_CODE=? AND PRODUCT_ID=?)
GET_MOTOR_POL_COVER_DATA_RATE=SELECT ISNULL(RATE,0) RATE FROM MOTOR_POLICY_COVER_DATA WHERE APPLICATION_NO=? AND POLICYTYPE_COVERID=?
DEL_MOTOR_POL_COVERAGE=DELETE FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND X_ID NOT IN (''{0}'')
GET_MOTOR_POL_COV_COUNT=SELECT COUNT(*) FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND X_ID=?
GET_MOTOR_QUOTE_INFO=SELECT CONVERT(VARCHAR,MPD.POLICYSTARTDATE,103) POLICYSTARTDATE, CONVERT(VARCHAR,MPD.POLICYENDDATE,103) POLICYENDDATE,MPD.POLICYSTARTDATE_AR,MPD.POLICYENDDATE_AR,MPD.POLICYTYPE, E.PRODUCT_NAME, F.PREMIUM,  CONVERT(VARCHAR,F.ENTRY_DATE,103) ENTRY_DATE, F.PAYMENT_MODE, ISNULL (F.ADMIN_REFERRAL_STATUS, 'N') ADMIN_REFERRAL_YN, F.EXCESS_PREMIUM, F.EXCESS_SIGN, (CASE WHEN (F.STATUS = 'Y') THEN CASE WHEN F.REMARKS IN ('Referal') THEN 'A' ELSE 'Y' END ELSE 'N' END) ADMIN_REFERRAL_STATUS, F.ADMIN_REMARKS, F.LOGIN_ID, F.BROKER_CODE, F.PROMOCODE,F.AC_EXECUTIVE_ID, F.CHQ_INV_NO, PI.CUSTOMER_ID, PI.TITLE, ISNULL (PI.FIRST_NAME, PI.COMPANY_NAME) NAME, PI.MOBILE, PI.EMAIL, PI.ADDRESS1, PI.ADDRESS2, PI.POBOX, PI.EMIRATE, PI.MISSIPPI_CUSTOMER_CODE, PI.CLIENT_CUSTOMER_ID, PI.CUST_AR_NO, PI.LAST_NAME, PI.NRC, PI.PASSPORT_NUMBER, CASE WHEN ISNULL(PI.DOB,0)=0 THEN '' ELSE CONVERT(VARCHAR,PI.DOB,103) END CUST_DOB, CONVERT(VARCHAR,CONVERT(DATE,PI.DOB_AR,120),103) CUST_DOB_AR, PI.ALTERNATE_MOBILE, PI.TELEPHONE, PI.CUSTOMER_TYPE, PI.COMPANY_REG_NO,PI.CUST_NAME_ARABIC FROM PRODUCT_MASTER E, HOME_POSITION_MASTER F, PERSONAL_INFO PI, MOTOR_POLICY_DETAILS MPD WHERE F.APPLICATION_NO=? AND F.PRODUCT_ID=? AND F.BRANCH_CODE=? AND PI.CUSTOMER_ID = F.CUSTOMER_ID AND MPD.APPLICATIONNO=F.APPLICATION_NO and e.product_id=f.product_id
GET_MOTOR_PREMIUM_INFO = SELECT GROUP_ID,POLICYTYPE_COVERID,SUM(SUM_INSURED) SUM_INSURED,ISNULL(AVG(RATE),0) RATE,SUM(PREMIUM) PREMIUM,OPCOVER_DESC OPCOVER_DESC_ENGLISH,DESCRIPTION,GROUP_DESC GROUP_DESC_ENGLISH FROM  MOTOR_POLICY_COVER_DATA MPCD WHERE APPLICATION_NO=? AND BRANCH_CODE=?  GROUP BY POLICYTYPE_COVERID,DESCRIPTION,OPCOVER_DESC,GROUP_DESC,GROUP_ID ORDER BY POLICYTYPE_COVERID
GET_MOTOR_PREMIUM_BASED_ON_VEHILCE = SELECT GROUP_ID,POLICYTYPE_COVERID,SUM_INSURED,ISNULL(RATE,0) RATE,PREMIUM,OPCOVER_DESC OPCOVER_DESC_ENGLISH,DESCRIPTION,GROUP_DESC GROUP_DESC_ENGLISH FROM  MOTOR_POLICY_COVER_DATA MPCD WHERE APPLICATION_NO\=? AND BRANCH_CODE\=? AND VEHICLE_ID\=?  ORDER BY DISPLAY_ORDER,GROUP_ID,POLICYTYPE_COVERID
GET_MOTOR_RATE_MODYN=SELECT ISNULL(PROVISION_FOR_RATE,'N') PROVISION_FOR_RATE FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? AND PRODUCT_ID=?
GET_MOTOR_POL_TYPE_ID=SELECT DISTINCT POLICYSUBTYPE POLICYTYPE_ID FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? and Branch_code=? Order by POLICYSUBTYPE asc
GET_MOTOR_POL_TYPE=SELECT DISTINCT X_ID,X_DATA_NAME,SUM(RATE) RATE,SUM(BASE_RATE) BASE_RATE,SUM(DATA_VALUE) DATA_VALUE,SUM(MIN_PREMIUM) MIN_PREMIUM FROM MOTOR_POLICY_COVERAGE  WHERE APPLICATION_NO=? AND STATUS='Y' AND GROUP_ID=0 GROUP BY  X_ID,X_DATA_NAME ORDER BY X_ID asc
GET_MOTOR_POL_GROUP=SELECT DISTINCT MP.GROUP_ID,GROUP_DESC_ENGLISH,MG.DISPLAY_ORDER FROM MOTOR_POLICY_COVERAGE MP,MOTOR_GROUP_MASTER MG WHERE APPLICATION_NO\=? AND MG.BRANCH_CODE\=? AND MP.STATUS\='Y'  AND MP.GROUP_ID\=MG.GROUP_ID AND MG.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_GROUP_MASTER  WHERE GROUP_ID\=MG.GROUP_ID) Group by MP.GROUP_ID,MG.GROUP_DESC_ENGLISH,DISPLAY_ORDER ORDER BY MG.DISPLAY_ORDER
GET_MOTOR_POLGROUP_REF_CNT = SELECT COUNT(*) FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO\=? AND X_ID\=? AND STATUS\='Y' AND GROUP_ID\=0 AND REFERAL_STATUS\='Y' 
GET_MOTOR_POL_COVERAGE=SELECT DISTINCT Y_DATA_NAME FROM MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? AND STATUS='Y' AND GROUP_ID=?
GET_MOTOR_POL_COVERAGE_DTLS=SELECT Y_ID,DESCRIPTION,SUM(ISNULL(DATA_VALUE,'0')) DATA_VALUE,IS_SELECTED,IS_ADDON,DELETABLE FROM MOTOR_POLICY_COVERAGE MPC WHERE STATUS='Y' AND APPLICATION_NO=? AND GROUP_ID=?  AND X_ID=? AND Y_DATA_NAME=? GROUP BY Y_ID,DESCRIPTION,IS_SELECTED,IS_ADDON,DELETABLE
GET_MOTOR_RATES=SELECT ISNULL(RATE_ONE, 0) RATE_ONE,ISNULL(RATE_TWO, 0) RATE_TWO,ISNULL(RATE_THREE, 0) RATE_THREE,ISNULL(RATE_FOUR, 0) RATE_FOUR,MP.PROVISION_FOR_RATE FROM LOGIN_USER_DETAILS LUD, MOTOR_BROKER_POLICYTYPE_MASTER MP WHERE LUD.PRODUCT_ID = ? AND LUD.LOGIN_ID = (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE UPPER (USERTYPE) = 'BROKER' AND OA_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = ?)) AND LUD.PRODUCT_ID = MP.PRODUCT_ID AND MP.BRANCH_CODE = ? AND MP.POLICYTYPE_IDS=? AND MP.BROKER_ID=LUD.LOGIN_ID
UPD_MOTOR_DATA_DTLS_OPT_COVPOLTYPE=UPDATE MOTOR_DATA_DETAIL SET POLICYTYPE=?,OPTIONAL_COVER=? WHERE APPLICATION_NO=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?)
DEL_MOTOR_POL_COV_DATA=DELETE FROM MOTOR_POLICY_COVER_DATA WHERE APPLICATION_NO=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DATA WHERE APPLICATION_NO=?)
GET_MOTOR_POL_COV_DTL_POLCOVID_CLCTYPE=SELECT POLICYCOVER_ID,CALC_TYPE FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=?)
INS_AMD_MOTOR_POL_COV_DATA=INSERT INTO MOTOR_POLICY_COVER_DATA (APPLICATION_NO,QUOTE_NO,POLICYTYPE_COVERID,SUM_INSURED,RATE,PREMIUM,STATUS,AMEND_ID,BRANCH_CODE)(SELECT ?,?,?,?,{0},{1},''Y'',0,? FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_POLICY_COVER_DETAIL WHERE POLICYTYPE_COVERID=? AND BRANCH_CODE=?))
INS_MOTOR_POL_COV_DATA=INSERT INTO MOTOR_POLICY_COVER_DATA (APPLICATION_NO,QUOTE_NO,POLICYTYPE_COVERID,SUM_INSURED,RATE,PREMIUM,STATUS,AMEND_ID,BRANCH_CODE) VALUES(?,?,?,?,?,?,?,?,?)
UPD_MOTOR_REF_STATUS=UPDATE HOME_POSITION_MASTER SET EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),REMARKS=?,SUMMARY_REMARKS= ?,ADMIN_REFERRAL_STATUS = ?, REFERRAL_DESCRIPTION = ?,PREMIUM=?,POLICY_FEE=?,NAJM_FEE=?,OVERALL_PREMIUM=?,COMMISSION=?,COMMISSION_PERCENTAGE=? WHERE QUOTE_NO = ?
UPD_MOTOR_HOME_POS_MASTER_MODEOFPAY=UPDATE HOME_POSITION_MASTER SET SUMMARY_CLAUSES=?,AIRMILES_NO=?, INSURANCE_DETAILS=?,PAYMENT_MODE=?,CSH_ID_TYP_CODE=?,PREMIUM=?,POLICY_FEE=?,NAJM_FEE=?,OVERALL_PREMIUM=?,COMMISSION=?,EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),STATUS=?,CHQ_INV_NO=?,COMMISSION_PERCENTAGE=? WHERE QUOTE_NO=?
UPD_MOTOR_HOME_POS_MASTER_MODEOFPAY_SHA=UPDATE HOME_POSITION_MASTER SET SUMMARY_CLAUSES=?,AIRMILES_NO=?, INSURANCE_DETAILS=?,PAYMENT_MODE=?,CSH_ID_TYP_CODE=?,POLICY_FEE=?,NAJM_FEE=?,COMMISSION=?,EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),STATUS=?,CHQ_INV_NO=?,COMMISSION_PERCENTAGE=? WHERE QUOTE_NO=?
#UPD_MOTOR_POLICY_COVER_RATEPR=UPDATE MOTOR_POLICY_COVER_DATA SET RATE=nullif(CONVERT(decimal(20,2), CAST(? AS FLOAT)),0),PREMIUM=((CASE WHEN (GROUP_ID != '0') THEN 1 ELSE ISNULL(SUM_INSURED,'0') end ) * (Case When Group_Id='0' And (Select Isselectcover From Motor_Policy_Details Where Applicationno=Application_No)!='5' Then CONVERT(decimal(20,2), CAST(? AS FLOAT))/100 Else nullif(CONVERT(decimal(20,2), CAST(? AS FLOAT)),0) End)) WHERE APPLICATION_NO=? AND POLICYTYPE_COVERID=? AND  BRANCH_CODE=? AND AMEND_ID=( SELECT MAX(AMEND_ID) FROM  MOTOR_POLICY_COVER_DATA MP WHERE MP.POLICYTYPE_COVERID=POLICYTYPE_COVERID AND MP.APPLICATION_NO=APPLICATION_NO  AND MP.BRANCH_CODE=BRANCH_CODE) AND VEHICLE_ID=?
UPD_MOTOR_POLICY_COVER_RATEPR=UPDATE MOTOR_POLICY_COVER_DATA SET RATE=nullif(CONVERT(decimal(20,2), CAST(? AS FLOAT)),0) WHERE APPLICATION_NO=? AND POLICYTYPE_COVERID=? AND  BRANCH_CODE=? AND AMEND_ID=( SELECT MAX(AMEND_ID) FROM  MOTOR_POLICY_COVER_DATA MP WHERE MP.POLICYTYPE_COVERID=POLICYTYPE_COVERID AND MP.APPLICATION_NO=APPLICATION_NO  AND MP.BRANCH_CODE=BRANCH_CODE) AND VEHICLE_ID=?
##UPD_MOTOR_POLICY_COVER_RATEPR=UPDATE MOTOR_POLICY_COVER_DATA SET RATE=nullif(CONVERT(decimal(20,2), CAST(? AS FLOAT)),0),PREMIUM=(ISNULL(SUM_INSURED,'0') * (Case When Group_Id='0' And (Select Isselectcover From Motor_Policy_Details Where Applicationno=Application_No)!='5' Then CONVERT(decimal(20,2), CAST(? AS FLOAT))/100 Else nullif(CONVERT(decimal(20,2), CAST(? AS FLOAT)),0) End)) WHERE APPLICATION_NO=? AND POLICYTYPE_COVERID=? AND  BRANCH_CODE=? AND AMEND_ID=( SELECT MAX(AMEND_ID) FROM  MOTOR_POLICY_COVER_DATA MP WHERE MP.POLICYTYPE_COVERID=POLICYTYPE_COVERID AND MP.APPLICATION_NO=APPLICATION_NO AND MP.BRANCH_CODE=BRANCH_CODE) AND VEHICLE_ID=?
GET_MOTOR_MAKE_REF_STATUS=SELECT ISNULL(REFERRAL_STATUS,'N') REF_STATUS FROM MOTOR_MAKE_MASTER WHERE MAKE_ID=? AND BRANCH_CODE=? AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_MAKE_MASTER WHERE MAKE_ID=? AND BRANCH_CODE=?)
GET_MOTOR_MODEL_REF_STATUS=SELECT ISNULL(REFERRAL_STATUS,'N') REF_STATUS FROM MOTOR_MODEL_MASTER WHERE MODEL_ID=? AND MAKE_ID=? AND BRANCH_CODE=? AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_MODEL_MASTER WHERE MODEL_ID=? AND MAKE_ID=? AND BRANCH_CODE=?)
GET_MOTOR_TYPE_BODY_CNT=SELECT COUNT(*) FROM MOTOR_TYPE_BODY_LIMIT WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=? AND PRODUCT_ID=? AND STATUS=''Y'' AND (AGENCY_CODE IN (''{0}'',''None'') OR AGENCY_CODE IS NULL)
GET_SI_LIMIT=SELECT  ISNULL(LUD.INSURANCE_END_LIMIT,0) INSURANCE_END_LIMIT FROM LOGIN_USER_DETAILS LUD WHERE AGENCY_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE   LOGIN_ID = ?) AND PRODUCT_ID = ? AND LUD.AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   LOGIN_USER_DETAILS WHERE LOGIN_ID = LUD.LOGIN_ID AND PRODUCT_ID = LUD.PRODUCT_ID)
GET_SI_LIMIT_APPNO=SELECT  ISNULL(LUD.INSURANCE_END_LIMIT,0) INSURANCE_END_LIMIT FROM LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM,HOME_POSITION_MASTER HPM WHERE   LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID=HPM.LOGIN_ID AND HPM.APPLICATION_NO =? AND LUD.PRODUCT_ID = HPM.PRODUCT_ID AND HPM.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM HOME_POSITION_MASTER WHERE APPLICATION_NO=?) AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE PRODUCT_ID=LUD.PRODUCT_ID AND LOGIN_ID=LUD.LOGIN_ID)
GET_MOTOR_CUST_INFO=SELECT PI.TITLE,PI.FIRST_NAME NAME,PI.CUST_NAME_ARABIC,PI.EMAIL,PI.POBOX,PI.MOBILE,PI.EMIRATE,PI.CUSTOMER_ID,PI.MISSIPPI_CUSTOMER_CODE,PI.CLIENT_CUSTOMER_ID,PI.ADDRESS1,PI.ADDRESS2,PI.CUST_AR_NO,PI.CUSTOMER_TYPE,PI.COMPANY_REG_NO FROM PERSONAL_INFO PI  WHERE PI.CUSTOMER_ID=? AND PI.APPLICATION_ID = '1' AND PI.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID AND APPLICATION_ID=PI.APPLICATION_ID)
GET_MOTOR_COV_PRE_SUM=SELECT SUM(ISNULL (A.PREMIUM, '0')) PREMIUM FROM  MOTOR_POLICY_COVER_DATA A WHERE APPLICATION_NO =?  AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_POLICY_COVER_DATA WHERE QUOTE_NO = A.QUOTE_NO)
UPD_MOTOR_PRE=UPDATE HOME_POSITION_MASTER SET PREMIUM=?,POLICY_FEE=?,NAJM_FEE=?,EXCESS_SIGN=?,EXCESS_PREMIUM=?,OVERALL_PREMIUM=?,TRAN_ID=?,VAT_PREMIUM=0 WHERE APPLICATION_NO=?
UPD_NAJM_FEE = UPDATE MOTOR_DATA_DETAIL  SET NIJAM_FEE=(SELECT convert(decimal(5,2) ,?)/COUNT(*) FROM MOTOR_DATA_DETAIL MD WHERE MD.APPLICATION_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL MDD WHERE MDD.APPLICATION_NO=MD.APPLICATION_NO))  WHERE APPLICATION_NO=?
GET_MOTOR_HELP_LIST = SELECT HELP_ID, DESCRIPTION, REMARKS FROM MOTOR_HELP_MASTER WHERE HELP_TYPE=? AND STATUS='Y' AND BRANCH_CODE=? ORDER BY DISPLAY_ORDER ASC
#UPD_MOTOR_ADDVEHICLE_DTLS = UPDATE MOTOR_DATA_DETAIL SET VEHICLE_COLOR=?,LEASED=?,BANK_ID=?,REGISTRATION_NO=?,CHASSIS_NO=?,ENGINE_NUMBER=?,INSURED_NAME_ARABIC=?,INSURED_ADDRESS_ARABIC=?,REGISTER_LOCATION=?,PLATE_COLOR=?,ENGLISH_PLATE_LETTER1=?,ENGLISH_PLATE_LETTER2=?,ENGLISH_PLATE_LETTER3=?,NUMERIC_PLATE=?,REGISTRATION_YEAR=?,SEQUENCE_NO=?,ISTAMARA_GRE_EXP_DATE = CONVERT(DATE,?,103), ISTAMARA_HIJRI_EXP_DATE = CONVERT(DATE,?,103),HIJRI_ISSUE_DATE=convert(date,FORMAT(getdate(),'dd/MM/yyyy','ar'),103),GRE_ISSUE_DATE =SYSDATETIME(),VEHICLE_ISSUE_DATE =SYSDATETIME() WHERE APPLICATION_NO=? AND VEHICLE_ID=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?)
#UPD_MOTOR_ADDVEHICLE_DTLS = UPDATE MOTOR_DATA_DETAIL SET HIJRI_ISSUE_DATE=convert(date,FORMAT(getdate(),'dd/MM/yyyy','ar'),103),GRE_ISSUE_DATE =SYSDATETIME(),LEASED=?,BANK_ID=?,IBAN_NO=?,IBANK_ID=?,IBANK_NAME=?,RESTRICTION_OF_USE='',SAAEDYN='Y' WHERE APPLICATION_NO=? AND VEHICLE_ID=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?)
UPD_MOTOR_ADDVEHICLE_DTLS = UPDATE MOTOR_DATA_DETAIL SET HIJRI_ISSUE_DATE=convert(date,FORMAT(getdate(),'dd/MM/yyyy','ar'),103),GRE_ISSUE_DATE =SYSDATETIME(),LEASED=?,BANK_ID=?,IBAN_NO=?,IBANK_ID=?,IBANK_NAME=?,RESTRICTION_OF_USE='',SAAEDYN='Y' WHERE APPLICATION_NO=? AND VEHICLE_ID=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?)
GET_MOTOR_MULTI_DATA_DETAILS = SELECT * FROM MOTOR_VEHICLE_DATA_DETAILS(?,?,?)
GET_MOTOR_MULTI_DATA_DETAILS_FN = SELECT * FROM MOTOR_VEHICLE_DATA_DETAILS_FN(?,?,?)
GET_MOTOR_PREMIUM_VAT_DETAILS = SELECT * FROM  VAT_DETAILS(?,?)
GET_MOTOR_DTL_VEHICLEID = SELECT ISNULL (MAX (VEHICLE_ID), 0)+1 FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?
DEL_MOTOR_VEHICLE_DETAILS_ALL = DELETE FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?
DEL_MOTOR_VEHICLE_DETAILS = DELETE FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=? AND VEHICLE_ID=?
CAL_MOTOR_PREMIUM_CALC ={CALL Motor_Premium_calc(?,?,?,?,?)}
CAL_MOTOR_VEHICLE_INFO = {CALL YAKEEN_UPDATE(?,?,?)}
UPD_MOTOR_SIREFERRAL_DTLS =UPDATE MOTOR_DATA_DETAIL SET REFERRAL_REMARKS\=CASE WHEN REFERRAL_REMARKS is NULL THEN 'Sum Insured Limit Referral' ELSE REFERRAL_REMARKS+'~Sum Insured Limit Referral' END WHERE SUMINSURED_VALUE_LOCAL>(Select NULLIF(Insurance_End_Limit,0) From Login_User_Details Where Login_Id \= (Select Login_Id From Login_Master Where Agency_Code\=(Select Oa_Code From Login_Master Where Login_Id\=?)) And Product_Id\=?) AND APPLICATION_NO\=? 
GET_MOTOR_REFERRALMSGS = SELECT 'Vehicle '+ ' ' +Cast( VEHICLE_ID As VARCHAR)+ ' ' +'-'+ ' ' +REFERRAL_REMARKS REFERRAL_REMARKS FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=? AND REFERRAL_REMARKS IS NOT NULL
GET_MOTOR_REFERAL_MESSAGES_VEHICLE = select REFERRAL_REMARKS from MOTOR_DATA_DETAIL where APPLICATION_NO=? and VEHICLE_ID=?
GET_MOTOR_REFERRAL_SELECTED_COVER=select REFERAL_DESC from MOTOR_POLICY_COVERAGE WHERE APPLICATION_NO=? and X_ID=?  and GROUP_ID='0' and REFERAL_STATUS='Y'
GET_USER_MOTOR_CUSTOMER_DETAILS = SELECT   PI.TITLE,PI.FIRST_NAME NAME,PI.EMAIL,PI.POBOX,PI.MOBILE,PI.EMIRATE,PI.MISSIPPI_CUSTOMER_CODE,PI.CLIENT_CUSTOMER_ID,PI.ADDRESS1,PI.ADDRESS2,PI.CUST_AR_NO,PI.CUSTOMER_TYPE,PI.COMPANY_REG_NO FROM   PERSONAL_INFO PI WHERE   PI.LOGIN_ID = ? AND PI.CUSTOMER_ID = (SELECT   MIN (CUSTOMER_ID) FROM   PERSONAL_INFO WHERE   LOGIN_ID = PI.LOGIN_ID)
GET_MOTOR_POLICY_REFERRALMSGS=SELECT REFERRAL_REMARKS FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO=?
INS_MOTOR_POLICY_DETAILS = INSERT INTO MOTOR_POLICY_DETAILS (APPLICATIONNO,QUOTENO,POLICYTYPE,POLICYSTARTDATE,POLICYENDDATE,POLICYSTARTDATE_AR,POLICYENDDATE_AR) VALUES (?,?,?,CONVERT(DATE,?,103),CONVERT(DATE,?,103),FORMAT(CONVERT(DATE,?,103),'yyyy-MM-dd','AR'),FORMAT(CONVERT(DATE,?,103),'yyyy-MM-dd','AR'))
CNT_MOTOR_POLICY_DETAILS = SELECT COUNT(*) FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO=?
UPD_MOTOR_POLICY_DETAILS = UPDATE MOTOR_POLICY_DETAILS SET POLICYSTARTDATE=CONVERT(DATE,?,103),POLICYENDDATE=CONVERT(DATE,?,103),POLICYSTARTDATE_AR=FORMAT(CONVERT(DATE,?,103),'yyyy-MM-dd','AR'),POLICYENDDATE_AR=FORMAT(CONVERT(DATE,?,103),'yyyy-MM-dd','AR'),POLICYTYPE=? WHERE APPLICATIONNO=?
GET_MOTOR_POLICY_DETAILS = SELECT APPLICATIONNO, QUOTENO, POLICYTYPE, ISSELECTCOVER, OPTIONAL_COVER, CONVERT(VARCHAR,POLICYSTARTDATE,103) POLICYSTARTDATE, CONVERT(VARCHAR,POLICYENDDATE,103) POLICYENDDATE,POLICYSTARTDATE_AR,POLICYENDDATE_AR, PREMIUM FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO=?
UPD_MOTOR_POLICY_DTLS_OPT_COVPOLTYPE = UPDATE MOTOR_POLICY_DETAILS SET ISSELECTCOVER=?,OPTIONAL_COVER=?,REFERRAL_REMARKS=? WHERE APPLICATIONNO=?
GET_MOTOR_THIRDPARTY_PREMIUMINFO = SELECT DISTINCT REFERAL_STATUS,X_ID,X_DATA_NAME,SUM(RATE) RATE,SUM(BASE_RATE) BASE_RATE,SUM(DATA_VALUE) DATA_VALUE,SUM(MIN_PREMIUM) MIN_PREMIUM FROM MOTOR_POLICY_COVERAGE  WHERE APPLICATION_NO=? AND STATUS='Y' AND GROUP_ID=0 AND X_ID=5 GROUP BY  X_ID,X_DATA_NAME,REFERAL_STATUS ORDER BY DATA_VALUE Desc
INS_MOTOR_DOCUMENTS = INSERT INTO MOTOR_VEHICLE_DOCUMENTS (APPLIATION_NO,QUOTE_NO,VEHICLE_ID,DOCUMENT_ID,DOCUMENT_PATH) VALUES (?,?,?,?,?)
DEL_MOTOR_DOCUMENTS = DELETE FROM MOTOR_VEHICLE_DOCUMENTS WHERE APPLIATION_NO=? AND VEHICLE_ID=? AND DOCUMENT_ID=?
GET_MOTOR_DOCUMENTS = SELECT DOCUMENT_ID,DOCUMENT_PATH FROM MOTOR_VEHICLE_DOCUMENTS WHERE APPLIATION_NO=? AND VEHICLE_ID=?
CNT_MOTOR_DOCUMENTS = SELECT COUNT(*) FROM MOTOR_VEHICLE_DOCUMENTS WHERE APPLIATION_NO=? AND VEHICLE_ID=?
GET_MOTOR_SELECTED_POLICY = SELECT ISSELECTCOVER FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO=?
GET_MOTOR_SELECTED_POLICY_TYPE = SELECT DISTINCT POLICYTYPE FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?

GET_POLICY_FEE_LOGIN=SELECT POLICY_FEE FROM BROKER_MASTER BM WHERE BM.AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?) AND BM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM BROKER_MASTER WHERE  BM.AGENCY_CODE\=AGENCY_CODE)
GET_NAJM_FEE_LOGIN=SELECT isnull(nullif(NAJM_FEE,''),8) NAJM_FEE FROM BROKER_MASTER BM WHERE BM.AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=?) AND BM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM BROKER_MASTER WHERE  BM.AGENCY_CODE\=AGENCY_CODE)
INSERT_BROKER_COMM=INSERT INTO BROKER_COMMISSION_DETAIL (AGENCY_CODE, AMEND_ID, ENTRY_DATE,POLICYTYPE, COMMISSION_PERCENTAGE, MIN_PREMIUM, SUMINSURED_START,SUMINSURED_END,CHECKER_YN,POLICY_FEE,NAJM_FEE,PRODUCT_ID)VALUES(?,'0',getdate(),?,?,?,'1000',?,?,?,?,?)
DEL_BROKER_COMM=DELETE FROM  BROKER_COMMISSION_DETAIL WHERE AGENCY_CODE \= ?
BROKER_COMMISSION_DET=SELECT POLICY_SUBTYPE_ID, POLICYTYPE_DESC_ENGLISH,isnull(bcd.COMMISSION_PERCENTAGE,0) COMMISSION,isnull(bcd.MIN_PREMIUM,0) MIN_PREMIUM,isnull(bcd.SUMINSURED_END,0) SUM_INSURED,isnull(bcd.CHECKER_YN,'N') CHECKER_YN,isnull(bcd.POLICY_FEE,0) POLICY_FEE,isnull(bcd.NAJM_FEE,0) NAJM_FEE  FROM      motor_policytype_master mpm LEFT OUTER JOIN broker_commission_detail bcd ON mpm.POLICYTYPE_ID = bcd.policytype AND mpm.status = 'Y' and bcd.AGENCY_CODE=? order by mpm.POLICYTYPE_ID

UPD_PRODUCT_MOTOR_DET=update login_user_details set COMMISSION=NULLIF(?,''),INSURANCE_END_LIMIT=NULLIF(?,''),STATUS=?,DISCOUNT_OF_PREMIUM=NULLIF(?,''),MIN_PREMIUM_AMOUNT=NULLIF(?,'') ,BACK_DATE_ALLOWED=NULLIF(?,''),LOADING_OF_PREMIUM=NULLIF(?,''),pay_receipt_status=?,FREIGHT_DEBIT_OPTION=?,PROVISION_FOR_PREMIUM=NULLIF(?,''), RECEIPT_STATUS=?, open_cover_no=?, SPECIAL_DISCOUNT=NULLIF(?,''),POLICY_TYPE=?,CHECKER_YN=? where AGENCY_CODE=? and product_id=?
UPD_PRODUCT_DET_MOTOR_LM=update login_master set referal=? where AGENCY_CODE=?

#Motor Cancel Start
GET_POLICY_MOBILE_COUNT = SELECT COUNT(*) FROM HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE UPPER(ISNULL(NULLIF( HPM.ORIGINAL_POLICY_NO,''), HPM.POLICY_NO))\=UPPER(?) AND HPM.STATUS IN ('P','N','D','Y') AND HPM.CUSTOMER_ID \= PI.CUSTOMER_ID AND PI.MOBILE\=? AND  HPM.AMEND_ID\=(SELECT max(HPM1.AMEND_ID) FROM HOME_POSITION_MASTER HPM1 WHERE ISNULL(NULLIF( HPM.ORIGINAL_POLICY_NO,''), HPM.POLICY_NO)\=ISNULL(NULLIF(HPM1.ORIGINAL_POLICY_NO,''), HPM1.POLICY_NO))
GET_POLICY_MOBILE_COUNT_OTHER = SELECT COUNT(*) FROM HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE UPPER(ISNULL(NULLIF( HPM.ORIGINAL_POLICY_NO,''), HPM.POLICY_NO))\=UPPER(?) AND HPM.STATUS IN ('P','N','D','Y') AND HPM.CUSTOMER_ID \= PI.CUSTOMER_ID AND PI.TELEPHONE\=? AND  HPM.AMEND_ID\=(SELECT max(HPM1.AMEND_ID) FROM HOME_POSITION_MASTER HPM1 WHERE ISNULL(NULLIF( HPM.ORIGINAL_POLICY_NO,''), HPM.POLICY_NO)\=ISNULL(NULLIF(HPM1.ORIGINAL_POLICY_NO,''), HPM1.POLICY_NO))
GET_POLICY_SEQ_CHAS_COUNT = SELECT COUNT(*) FROM HOME_POSITION_MASTER HPM,MOTOR_DATA_DETAIL MDD WHERE UPPER(ISNULL(NULLIF( HPM.ORIGINAL_POLICY_NO,''), HPM.POLICY_NO))\=UPPER(?) AND HPM.STATUS IN ('P','N','D','Y') AND HPM.QUOTE_NO \= MDD.QUOTE_NO AND MDD.SEQUENCE_NO\=? AND MDD.CHASSIS_NO \= ? AND  HPM.AMEND_ID\=(SELECT max(HPM1.AMEND_ID) FROM HOME_POSITION_MASTER HPM1 WHERE ISNULL(NULLIF( HPM.ORIGINAL_POLICY_NO,''), HPM.POLICY_NO)\=ISNULL(NULLIF(HPM1.ORIGINAL_POLICY_NO,''), HPM1.POLICY_NO))
#GET_EXIT_CANCEL_REF_NO = SELECT REF_NO FROM MOTOR_CANCEL_DETAILS MCD WHERE UPPER(POLICY_NO)=UPPER(?) AND MOBILE_NO = ? AND REF_NO=(SELECT MAX(MCD1.REF_NO) FROM MOTOR_CANCEL_DETAILS MCD1 WHERE MCD.POLICY_NO=MCD1.POLICY_NO)
#GET_EXIT_CANCEL_REF_NO_COUNT = SELECT COUNT(*) FROM MOTOR_CANCEL_DETAILS MCD WHERE UPPER(POLICY_NO)=UPPER(?) AND MOBILE_NO = ? AND REF_NO=(SELECT MAX(MCD1.REF_NO) FROM MOTOR_CANCEL_DETAILS MCD1 WHERE MCD.POLICY_NO=MCD1.POLICY_NO)
GET_CANCEL_POLICY_INFO = SELECT HPM.POLICY_NO,convert(varchar,MDD.GRE_ISSUE_DATE,103) ISSUE_DATE,convert(varchar,MDD.GRE_EFF_DATE,103) POLICY_START_DATE,convert(varchar,MDD.GRE_EXPIRE_DATE,103) POLICY_END_DATE,hpm.PREMIUM,pi.COMPANY_REG_NO, hpm.OVERALL_PREMIUM,PI.FIRST_NAME+''+pi.LAST_NAME CUST_NAME,HPM.QUOTE_NO,HPM.APPLICATION_NO,HPM.PRODUCT_ID,hpm.BRANCH_CODE,(SELECT RES_NNPID FROM NAJAM_POLICY_DETAILS NPD WHERE NPD.POLICYNUMBER=HPM.POLICY_NO) NNPID,(SELECT RES_NNVID FROM NAJAM_VEHICLE_DETAILS NVD WHERE NVD.SUBPOLICYNUMBER=HPM.POLICY_NO) NNVID,HPM.STATUS FROM HOME_POSITION_MASTER HPM,PERSONAL_INFO PI,MOTOR_DATA_DETAIL MDD WHERE UPPER(ISNULL(NULLIF( HPM.ORIGINAL_POLICY_NO,''), HPM.POLICY_NO))=UPPER(?) AND HPM.STATUS IN ('P','N','D','Y') AND HPM.CUSTOMER_ID = PI.CUSTOMER_ID AND (PI.MOBILE=? OR PI.TELEPHONE = ?) AND  HPM.AMEND_ID=(SELECT max(HPM1.AMEND_ID) FROM HOME_POSITION_MASTER HPM1 WHERE ISNULL(NULLIF( HPM.ORIGINAL_POLICY_NO,''), HPM.POLICY_NO)=ISNULL(NULLIF(HPM1.ORIGINAL_POLICY_NO,''), HPM1.POLICY_NO)) AND HPM.QUOTE_NO = MDD.QUOTE_NO
GET_CANCEL_REASON_LIST = SELECT ITEM_CODE CODE,ITEM_VALUE CODEDESC FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE='CANCELREASON' ORDER BY ITEM_CODE ASC
#INS_MOTOR_CANCEL_DETAILS = INSERT INTO MOTOR_CANCEL_DETAILS(REF_NO,POLICY_NO,MOBILE_NO,ENTRY_DATE,RES_DATE,IQAMA_ID,EMAIL_ID,REASON,BANK,IBAN_NO,STATUS,REMARKS,CUST_NAME)VALUES(?,?,?,GETDATE(),GETDATE(),?,?,?,?,?,?,?,?)
#GET_CANCEL_REF_NO = SELECT NEXT VALUE FOR CANCEL_REF_NO
#UPD_MOTOR_CANCEL_DETAILS = UPDATE MOTOR_CANCEL_DETAILS SET RES_DATE = GETDATE(),STATUS=?,ADMIN_STATUS=?,ADMIN_REMARKS=?,ADMIN_BY=? WHERE REF_NO = ?
INS_ADMIN_CANCEL_STATUS = INSERT INTO MOTOR_CANCEL_ADMIN_STATUS(REF_NO,POLICY_NO,MOBILE_NO,ENTRY_DATE,REASON,ADMIN_STATUS,ADMIN_REMARKS,ADMIN_BY,ADMIN_REASON) VALUES (?,?,?,getDate(),?,?,?,?,?)
GET_CANCEL_ADMIN_STATUS = SELECT REF_NO,POLICY_NO,MOBILE_NO,FORMAT(ENTRY_DATE,'dd/MM/yyyy HH\:mm\:ss') ENTRY_DATE,REASON,ADMIN_STATUS,ADMIN_REMARKS,ADMIN_REASON FROM MOTOR_CANCEL_ADMIN_STATUS WHERE REF_NO\=? AND POLICY_NO \= ? 
#GET_CANCEL_DETAILS = SELECT REF_NO,POLICY_NO,CUST_NAME,MOBILE_NO,FORMAT(ENTRY_DATE,'dd/MM/yyyy HH\:mm\:ss') ENTRY_DATE,RES_DATE,IQAMA_ID,EMAIL_ID,(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE\='CANCELREASON' AND ITEM_CODE\=REASON) REASON,(SELECT UPPER(BANK_NAME_ENGLISH) FROM MOTOR_FINANCE_BANK_MASTER MFB  WHERE MFB.BANK_ID\=BANK  AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_FINANCE_BANK_MASTER  WHERE BANK_ID\=MFB.BANK_ID )) BANK,IBAN_NO,STATUS STATUS_EDIT,(case STATUS when  'CP' then  'PENDING' when 'CA' then 'APPROVED' when 'CR' then 'REJECTED'  end) STATUS,REMARKS,ADMIN_STATUS ADMIN_STATUS_EDIT,(case ADMIN_STATUS when  'CP' then  'PENDING' when 'CA' then 'APPROVED' when 'CR' then 'REJECTED'  end) ADMIN_STATUS,ADMIN_REMARKS,DOCUMENT_UPLOAD FROM MOTOR_CANCEL_DETAILS WHERE POLICY_NO\=? 

UPD_CANCEL_OTHER_MOBILE = UPDATE PERSONAL_INFO SET TELEPHONE\=? WHERE CUSTOMER_ID\=(SELECT HPM.CUSTOMER_ID FROM HOME_POSITION_MASTER HPM WHERE UPPER(ISNULL(NULLIF( HPM.ORIGINAL_POLICY_NO,''), HPM.POLICY_NO))\=UPPER(?))

GET_CANCEL_MOBILE_NO = SELECT PI.MOBILE FROM HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE PI.CUSTOMER_ID=HPM.CUSTOMER_ID AND HPM.POLICY_NO=? AND HPM.STATUS IN ('P','N','D','Y') AND HPM.PRODUCT_ID='65'
GET_CANCEL_REASON = SELECT ITEM_CODE CODE,ITEM_DESC CODEDESC,ITEM_VALUE CODEVALUE,ITEM_DESC_AR CODEDESCAR FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE='CANCELREASON' AND STATUS='Y' ORDER BY ITEM_CODE ASC

GET_EXIT_CANCEL_REF_NO_COUNT = SELECT COUNT(*) FROM POLICYCANCELLATIONREQUEST MCD WHERE UPPER(FPOLICY)=UPPER(?) AND FSID=(SELECT MAX(MCD1.FSID) FROM POLICYCANCELLATIONREQUEST MCD1 WHERE MCD.FPOLICY=MCD1.FPOLICY)
GET_EXIT_CANCEL_REF_NO = SELECT FSID FROM POLICYCANCELLATIONREQUEST MCD WHERE UPPER(FPOLICY)=UPPER(?) AND FSID=(SELECT MAX(MCD1.FSID) FROM POLICYCANCELLATIONREQUEST MCD1 WHERE MCD.FPOLICY=MCD1.FPOLICY)
#INS_MOTOR_CANCEL_DETAILS = INSERT INTO POLICYCANCELLATIONREQUEST (FPOLICY,FREQTYPE,FREQUSER,FREQDATE,FENDOR,FRISKID,FREASON,FREMARKS,FSTATUS,FACTIVE,FBANKCODE,FBANKNAME,FIBANNO) VALUES (?,?,?,GETDATE(),?,?,?,?,?,?, (SELECT BANK_CODE FROM MOTOR_FINANCE_BANK_MASTER MFB WHERE  UPPER(BANK_NAME_ENGLISH) = UPPER(?) AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_FINANCE_BANK_MASTER WHERE BANK_ID=MFB.BANK_ID)),?,?)
INS_MOTOR_CANCEL_DETAILS = INSERT INTO POLICYCANCELLATIONREQUEST (FPOLICY,FREQTYPE,FREQUSER,FREQDATE,FENDOR,FRISKID,FREASON,FREMARKS,FSTATUS,FACTIVE,FBANKCODE,FBANKNAME,FIBANNO) VALUES (upper(?),?,?,GETDATE(),?,?,?,?,?,?,(select COREAPPCODE from bank_master bm where bm.BANK_ID=? and  bm.AMEND_ID=(SELECT MAX(AMEND_ID) FROM bank_master WHERE BANK_ID=bm.BANK_ID)),(select BANK_NAME from bank_master bm where bm.BANK_ID=? and  bm.AMEND_ID=(SELECT MAX(AMEND_ID) FROM bank_master WHERE BANK_ID=bm.BANK_ID)),?)
UPD_MOTOR_CANCEL_DETAILS =  UPDATE POLICYCANCELLATIONREQUEST SET FSTATUS=?,FREJECTREASON=?,FREJECTEDBY=?,FREJECTEDDATE=GETDATE(),FACTIVE=? WHERE FPOLICY = ? AND FSID=?
GET_CANCEL_DETAILS = SELECT FSID,FPOLICY,FREQTYPE,FREQUSER,FORMAT(FREQDATE,'dd/MM/yyyy HH\:mm\:ss') FREQDATE,FENDOR,FRISKID,FREASON,FREMARKS,FSTATUS,FREJECTREASON,FREJECTEDBY,FORMAT(FREJECTEDDATE,'dd/MM/yyyy HH\:mm\:ss') FREJECTEDDATE,FACTIVE,FBANKCODE,FBANKNAME,FIBANNO FROM POLICYCANCELLATIONREQUEST WHERE FPOLICY \= ?

GET_MOTOR_DOCUMENTS_LIST_CANCEL = SELECT DOCUMENT_ID,DOCUMENT_DESC,DOCUMENT_DESC_AR,MANDATORY_STATUS FROM DOCUMENT_MASTER WHERE  STATUS\='Y'  and PRODUCT_ID \=? AND  ISNULL(DOC_APPLICABLE,'') IN ('CANCEL') AND POLICY_TYPE  LIKE '%,'+?+',%' AND DOCUMENT_ID NOT IN (SELECT FREQUESTID FROM POLICYCANCELLATIONDOCUMENTS WHERE FPOLICY\=?) ORDER BY DISPLAY_ORDER
GET_MOTOR_DOCUMENTS_LIST_CANCEL_OTHERS = SELECT DOCUMENT_ID,DOCUMENT_DESC,DOCUMENT_DESC_AR,MANDATORY_STATUS FROM DOCUMENT_MASTER WHERE  STATUS\='Y'  and PRODUCT_ID \=? AND  ISNULL(DOC_APPLICABLE,'') IN ('CANCEL') AND UPPER(DOCUMENT_DESC) \= UPPER('OTHERS') AND POLICY_TYPE  LIKE '%,'+?+',%' ORDER BY DISPLAY_ORDER

INS_MOTOR_CANCEL_DOCUMENT = INSERT INTO POLICYCANCELLATIONDOCUMENTS (FPOLICY,FURL,FFILENAME,FFILETYPE,FUPLOADDATE,FUPLOADBY,FREMARKS,FREQUESTID) VALUES (?,?,?,?,GETDATE(),?,?,NULLIF(?,''))
UPD_MOTOR_CANCEL_DOCUMENT = UPDATE POLICYCANCELLATIONDOCUMENTS SET FVERIFIED=? ,FVERIFIEDDATE=GETDATE() ,FVERIFIEDBY =? WHERE FPOLICY=? AND FSID=?
GET_MOTOR_CANCEL_DOCUMENT = SELECT F.FSID,F.FPOLICY,replace(F.FURL,'\\','/') FURL,F.FFILENAME,F.FFILETYPE,FORMAT(F.FUPLOADDATE,'dd/MM/yyyy HH\:mm\:ss') FUPLOADDATE,F.FUPLOADBY,(case F.FVERIFIED when  '0' then  'No' when '1' then 'Yes'  end) FVERIFIED_EDIT,(case F.FVERIFIED when  '0' then  '0' when '1' then '1'  end) FVERIFIED,FORMAT(F.FVERIFIEDDATE,'dd/MM/yyyy HH\:mm\:ss') FVERIFIEDDATE ,F.FVERIFIEDBY,F.FREMARKS,F.FREQUESTID,DM.DOCUMENT_DESC, DM.DOCUMENT_DESC_AR FROM POLICYCANCELLATIONDOCUMENTS F,DOCUMENT_MASTER DM WHERE FPOLICY\=? AND DM.DOCUMENT_ID \= F.FREQUESTID ORDER BY FSID
DEL_DOCUMENTS_CANCEL	  = DELETE  FROM POLICYCANCELLATIONDOCUMENTS WHERE FURL=? AND FFILENAME=?
##DOCUMENT_MAND_VALIDATE_CANCEL = WITH E (COUNTS) AS ( SELECT COUNT(*) COUNTS FROM (SELECT DOCUMENT_ID FROM DOCUMENT_MASTER MDM WHERE STATUS = 'Y' AND POLICY_TYPE LIKE ('%,121,%') AND MANDATORY_STATUS='Y' AND ISNULL(DOC_APPLICABLE,'') IN ('CANCEL')) AS AD) , E1 ( SELECTED) AS  ( SELECT COUNT( DISTINCT fRequestID) SELECTED FROM POLICYCANCELLATIONDOCUMENTS WHERE fRequestID IN( SELECT DOCUMENT_ID FROM DOCUMENT_MASTER MDM WHERE STATUS = 'Y' AND POLICY_TYPE LIKE ('%,121,%') AND MANDATORY_STATUS='Y') AND fpolicy=? ) SELECT ( CASE WHEN COUNTS=SELECTED THEN 1 ELSE 0 END) FROM E,E1
DOCUMENT_MAND_VALIDATE_CANCEL = WITH E (COUNTS,PARCOUNTS) AS (SELECT SUM((CASE  WHEN MANDATORY_STATUS='Y'  THEN 1 ELSE 0 END)) COUNTS, SUM((CASE  WHEN MANDATORY_STATUS='P'  THEN 1 ELSE 0 END)) PARCOUNTS  FROM (SELECT DOCUMENT_ID,MANDATORY_STATUS FROM DOCUMENT_MASTER MDM WHERE STATUS = 'Y' AND POLICY_TYPE LIKE ('%,121,%') AND MANDATORY_STATUS IN ('P','Y') AND ISNULL(DOC_APPLICABLE,'') IN ('CANCEL')) AS AD ) , E1 (SELECTED) AS ( SELECT COUNT(DISTINCT fRequestID) SELECTED FROM POLICYCANCELLATIONDOCUMENTS WHERE fRequestID IN (SELECT DOCUMENT_ID FROM DOCUMENT_MASTER MDM WHERE STATUS = 'Y' AND  POLICY_TYPE LIKE ('%,121,%') AND MANDATORY_STATUS='Y'  AND ISNULL(DOC_APPLICABLE,'') IN ('CANCEL')) AND fpolicy=?  ),  E2  (PARSELECTED)  AS  (  SELECT COUNT(DISTINCT fRequestID) PARSELECTED FROM POLICYCANCELLATIONDOCUMENTS  WHERE fRequestID IN  (SELECT DOCUMENT_ID FROM DOCUMENT_MASTER MDM WHERE STATUS = 'Y' AND  POLICY_TYPE LIKE ('%,121,%') AND MANDATORY_STATUS='P') AND fpolicy=?  ) SELECT (CASE WHEN COUNTS=SELECTED AND PARCOUNTS>=PARSELECTED AND PARSELECTED>0 THEN 1 ELSE 0 END) FROM E,E1,E2


GET_CANCEL_DATE_COUNT = SELECT  CONVERT (VARCHAR(10), A.FREQDATE, 103) FREQDATE ,COUNT(A.FREQDATE) COUNT_POLICY FROM POLICYCANCELLATIONREQUEST A WHERE A.FSTATUS= ? GROUP BY  CONVERT (VARCHAR(10), A.FREQDATE, 103) ORDER BY  CONVERT (VARCHAR(10), A.FREQDATE, 103) DESC
GET_CANCEL_DETAIL_ADMIN = SELECT FSID,FPOLICY,FREQTYPE,FREQUSER,FORMAT(FREQDATE,'dd/MM/yyyy HH\:mm\:ss') FREQDATE,FENDOR,FRISKID,FREASON,FREMARKS,FSTATUS,FREJECTREASON,FREJECTEDBY,FORMAT(FREJECTEDDATE,'dd/MM/yyyy HH\:mm\:ss') FREJECTEDDATE,FACTIVE,FBANKCODE,FBANKNAME,FIBANNO FROM POLICYCANCELLATIONREQUEST WHERE FSTATUS \= ? AND SUBSTRING(CONVERT(VARCHAR,FREQDATE,103),1,10)\=?
#GET_CANCEL_DETAIL_ADMIN = SELECT REF_NO,CUST_NAME,POLICY_NO,MOBILE_NO,CONVERT(VARCHAR,ENTRY_DATE,103) ENTRY_DATE,CONVERT(VARCHAR,RES_DATE,103) RES_DATE,IQAMA_ID,EMAIL_ID,(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE\='CANCELREASON' AND ITEM_CODE\=REASON) REASON,(SELECT UPPER(BANK_NAME_ENGLISH) FROM MOTOR_FINANCE_BANK_MASTER MFB  WHERE MFB.BANK_ID\=BANK  AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_FINANCE_BANK_MASTER  WHERE BANK_ID\=MFB.BANK_ID )) BANK,IBAN_NO,STATUS STATUS_EDIT,(CASE STATUS WHEN  'CP' THEN  'PENDING' WHEN 'CA' THEN 'APPROVED' WHEN 'CR' THEN 'REJECTED'  END) STATUS,REMARKS,ADMIN_STATUS ADMIN_STATUS_EDIT,(CASE ADMIN_STATUS WHEN  'CP' THEN  'PENDING' WHEN 'CA' THEN 'APPROVED' WHEN 'CR' THEN 'REJECTED'  END) ADMIN_STATUS,ADMIN_REMARKS,DOCUMENT_UPLOAD FROM MOTOR_CANCEL_DETAILS WHERE STATUS \= ? AND SUBSTRING(CONVERT(VARCHAR,ENTRY_DATE,103),1,10)\=?
GET_CANCEL_SEARCH_DETAIL_ADMIN = SELECT FSID,FPOLICY,FREQTYPE,FREQUSER,FORMAT(FREQDATE,'dd/MM/yyyy HH:mm:ss') FREQDATE,FENDOR,FRISKID,FREASON,FREMARKS,FSTATUS,FREJECTREASON,FREJECTEDBY,FORMAT(FREJECTEDDATE,'dd/MM/yyyy HH:mm:ss') FREJECTEDDATE,FACTIVE,FBANKCODE,FBANKNAME,FIBANNO FROM POLICYCANCELLATIONREQUEST WHERE FSTATUS in('Rejected','Cancelled','Pending')
GET_CANCEL_POLICY_STATUS = SELECT FSID,FPOLICY,FREQTYPE,FREQUSER,FORMAT(FREQDATE,'dd/MM/yyyy HH:mm:ss') FREQDATE,FENDOR,FRISKID,FREASON,FREMARKS,FSTATUS,FREJECTREASON,FREJECTEDBY,FORMAT(FREJECTEDDATE,'dd/MM/yyyy HH:mm:ss') FREJECTEDDATE,FACTIVE,FBANKCODE,FBANKNAME,FIBANNO FROM POLICYCANCELLATIONREQUEST WHERE FPOLICY=?

GET_COUNT_NAJAM_POLICY_CANCEL=SELECT COUNT(*) from NAJAM_POLICY_DETAILS WHERE POLICYNUMBER=? and RES_STATUS is NULL
UPD_NAJAM_POLICY_CANCEL=UPDATE NAJAM_POLICY_DETAILS SET RES_STATUS='Cancel Request',ERROR_REMARKS='Customer Send Request for Cancel the Policy' WHERE POLICYNUMBER=? and RES_STATUS is NULL

GET_COUNT_NAJAM_VEHICLE_CANCEL=SELECT COUNT(*) from NAJAM_VEHICLE_DETAILS WHERE SUBPOLICYNUMBER=? and RES_STATUS is NULL
UPD_NAJAM_VEHICLE_CANCEL=UPDATE NAJAM_VEHICLE_DETAILS SET RES_STATUS='Cancel Request',ERROR_REMARKS='Customer Send Request for Cancel the Policy' WHERE SUBPOLICYNUMBER=? and RES_STATUS is NULL

GET_COUNT_NAJAM_DRIVER_CANCEL=SELECT COUNT(*) from NAJAM_DRIVER_DETAILS WHERE POLICY_NO=? and RES_STATUS is NULL
UPD_NAJAM_DRIVER_CANCEL=UPDATE NAJAM_DRIVER_DETAILS SET RES_STATUS='Cancel Request',ERROR_REMARKS='Customer Send Request for Cancel the Policy' WHERE POLICY_NO=? and RES_STATUS is NULL

###Motor User Registration - Start
INS_USERREG_PERSONAL_INFO = insert into personal_info(customer_id,application_id,title,first_name,last_name,amend_id,nationality,dob,gender,telephone,mobile,fax,email,address1,address2,occupation,pobox,country,emirate,status,entry_date,login_id,AGENCY_CODE,OA_CODE,city,fd_code)values(?,?,?,?,?,?,?, CONVERT(DATE,?,103),?,?,?,?,?,?,?,?,?,?,?,?,SYSDATETIME(),?,?,?,?,?)
INS_USERREG_LOGIN_MASTER = insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,ACCESSTYPE,RIGHTS,LPASS1,LPASS2,LPASS3,PASSDATE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,REFERAL, APP_ID, PWD_COUNT, USER_MAIL, branch_code, COUNTRY_ID,SUB_BRANCH) values(?,?,?,?,?,?,?,?,?,?,?,?,SYSDATETIME(),?,?,?,?,?,?,'16','0',?,?,?,(SELECT SUB_BRANCH FROM LOGIN_MASTER WHERE AGENCY_CODE=?))
GET_USERREG_COMMISSION = select pm.product_name uproductName, pm.product_id uproductId, lud.SPECIAL_DISCOUNT specialDis, lud.FREIGHT_DEBIT_OPTION freight, lud.INSURANCE_END_LIMIT insEndLimit, lud.pay_receipt_status receipt, lud.open_cover_no, (case lud.login_id when '' then 'N' else 'Y') product from PRODUCT_MASTER pm left outer join LOGIN_USER_DETAILS lud on PM.PRODUCT_ID = LUD.PRODUCT_ID and LUD.AGENCY_CODE = ? and LUD.OA_CODE = ? where PM.BRANCH_CODE = (SELECT BELONGING_BRANCH FROM BRANCH_MASTER WHERE BRANCH_CODE=?)
GET_BROKER_USERREG_DETAILS=select pi.TITLE,pi.GENDER,pi.FIRST_NAME,pi.LAST_NAME,(select NATIONALITY_NAME from COUNTRY_MASTER where amend_id+ ' ' +country_id in( select max(amend_id)+ ' ' +country_id from country_master group by country_id) and COUNTRY_ID\=pi.nationality) nationality_name, pi.NATIONALITY, convert(varchar(10),pi.DOB,103) DOB,pi.TELEPHONE,pi.MOBILE,pi.FAX,pi.EMAIL,pi.ADDRESS1,pi.ADDRESS2,pi.OCCUPATION,pi.EMIRATE,pi.COUNTRY,(select COUNTRY_NAME from country_master where COUNTRY_ID\=pi.COUNTRY and AMEND_ID\=(SELECT max(AMEND_ID) FROM country_master WHERE COUNTRY_ID\=pi.COUNTRY)) country_name,pi.POBOX,lm.agency_code,pi.entry_date,pi.status,pi.city,lm.BRANCH_CODE,lm.login_id,(select COMPANY_NAME from broker_company_master where AGENCY_CODE\=lm.OA_CODE) bname, lm.usertype, PI.CUST_NAME,PI.CUST_AR_NO,pi.customer_id, (select distinct(USERNAME) from login_master where  AGENCY_CODE\=lm.OA_CODE)borganization, lm.OA_CODE from personal_info pi, login_master lm where pi.agency_code\=lm.agency_code and pi.LOGIN_ID\=lm.LOGIN_ID and  pi.agency_code\=? and PI.AMEND_ID\=(select max(amend_id) from personal_info where pi.agency_code \= lm.agency_code)
UPD_USER_APPLICATIONS = UPDATE HOME_POSITION_MASTER SET LOGIN_ID=? WHERE APPLICATION_NO=?
GET_USER_OA_CODE = SELECT RSACODE FROM CONSTANT_DETAIL WHERE CATEGORY_ID='154' AND CATEGORY_DETAIL_ID='1' AND BRANCH_CODE=?
UPD_B2CUSER_PERSONAL_INFO = update personal_info set title=?, first_name=?, last_name=?, nationality=?, dob=CONVERT(DATE,?,103), gender=?, telephone=?, mobile=?, fax=?, email=?, address1=?, address2=?, occupation=?, pobox=?, country=?, emirate=?, status=?, city=? where agency_code=?
UPD_B2CUSER_LOGIN_MASTER = update login_master set USERNAME=?, STATUS=?, USER_MAIL=? where AGENCY_CODE=?
UPD_CUSTOMER_ID_MOTOR_DATA_DETAILS = update MOTOR_DATA_DETAIL set CUSTOMER_ID=? where APPLICATION_NO =?
GET_MOTOR_NEW_USER_CUST_ID = SELECT CUSTOMER_ID FROM HOME_POSITION_MASTER HPM  WHERE HPM.APPLICATION_NO \=?
MOTOR_USER_VALIDATE_MOBILE = SELECT COUNT(*) FROM PERSONAL_INFO WHERE MOBILE=?
MOTOR_NEW_USER_EXIST_CUS_INFO = SELECT PI.CUSTOMER_ID,PI.APPLICATION_ID,PI.TITLE,PI.FIRST_NAME,PI.LAST_NAME,PI.NATIONALITY,CONVERT(VARCHAR,PI.DOB,103) DOB,PI.GENDER,PI.TELEPHONE,PI.MOBILE,PI.FAX,PI.EMAIL,PI.ADDRESS1,PI.ADDRESS2,PI.OCCUPATION,PI.POBOX,pi.COUNTRY,pi.LOGIN_ID,pi.COMPANY_NAME,PI.CITY FROM   PERSONAL_INFO PI ,home_position_master HPM WHERE   PI.CUSTOMER_ID = HPM.CUSTOMER_ID AND HPM.APPLICATION_NO =?
MOTOR_NEW_USER_CUS_UPD = UPDATE PERSONAL_INFO SET TITLE =?,FIRST_NAME=?,LAST_NAME=?,GENDER=?,DOB=CONVERT(DATE,?,103),OCCUPATION=?,ADDRESS1=?,ADDRESS2=?,POBOX=?,CITY=?,EMIRATE=?,COUNTRY=?,TELEPHONE=?,MOBILE=?,EMAIL=?,LOGIN_ID=?,AGENCY_CODE=?,OA_CODE=? Where customer_id=(Select Customer_id from HOME_POSITION_MASTER HPM  Where HPM .APPLICATION_NO =?)
SELECT_MOTOR_EXIT_USER_PER = SELECT PI.LAST_NAME,PI.NATIONALITY,CONVERT(VARCHAR,PI.DOB,103)DOB,PI.GENDER,PI.TELEPHONE,PI.MOBILE,PI.FAX,PI.EMAIL,PI.ADDRESS1,PI.ADDRESS2,PI.OCCUPATION,PI.POBOX,PI.COUNTRY,PI.EMIRATE,PI.LOGIN_ID,PI.AGENCY_CODE,PI.OA_CODE,PI.COMPANY_NAME,PI.CITY,PI.CUST_NAME,PI.PASSPORT_NUMBER FROM personal_info pi, login_master lm WHERE pi.agency_code = lm.agency_code AND pi.LOGIN_ID = ? and PI.AMEND_ID=(select max(amend_id) from personal_info where pi.agency_code = lm.agency_code)
MOTOR_EXIT_USER_PER_UPD = UPDATE PERSONAL_INFO SET LAST_NAME=?,NATIONALITY=?,DOB=CONVERT(DATE,?,103),GENDER=?,TELEPHONE=?,MOBILE=?,FAX=?,EMAIL=?,ADDRESS1=?,ADDRESS2=?,OCCUPATION=?,POBOX=?,COUNTRY=?,EMIRATE=?,LOGIN_ID=?,AGENCY_CODE=?,OA_CODE=?,COMPANY_NAME=?,CITY=?,CUST_NAME=?,PASSPORT_NUMBER=? WHERE CUSTOMER_ID=(SELECT CUSTOMER_ID FROM HOME_POSITION_MASTER HPM  WHERE HPM .APPLICATION_NO =?)
GET_USER_EMAIL_COUNT = SELECT COUNT (*) FROM   LOGIN_MASTER LM, PERSONAL_INFO PI WHERE LM.LOGIN_ID\=(select PI1.EMAIL FROM PERSONAL_INFO PI1, HOME_POSITION_MASTER HPM WHERE  HPM.APPLICATION_NO \=? AND PI1.CUSTOMER_ID\=HPM.CUSTOMER_ID) AND pi.agency_code \= lm.agency_code AND pi.LOGIN_ID \= lm.LOGIN_ID AND APPLICATION_ID \!\='1'  
GET_CUSTOMER_DETAILS_ON_EMAIL =SELECT  PI.CUSTOMER_ID,PI.APPLICATION_ID,PI.TITLE,PI.FIRST_NAME,PI.LAST_NAME,PI.NATIONALITY,convert(varchar(10),PI.DOB, 103) DOB,PI.GENDER,PI.TELEPHONE,PI.MOBILE,PI.FAX,PI.EMAIL,PI.ADDRESS1,PI.ADDRESS2,PI.OCCUPATION,PI.POBOX,pi.COUNTRY,pi.LOGIN_ID,pi.COMPANY_NAME,PI.CITY FROM   PERSONAL_INFO PI WHERE   PI.EMAIL = ?
INS_B2CLOGIN_USER_DETAILS = INSERT INTO LOGIN_USER_DETAILS (USER_ID,OA_CODE,PRODUCT_ID,SCHEME_ID,COMPANY_ID,RELATIVE_USER_ID,AMEND_ID,INCEPTION_DATE,ENTRY_DATE,STATUS,LOGIN_ID,AGENCY_CODE) SELECT (SELECT MAX(USER_ID)+1 FROM LOGIN_USER_DETAILS),AGENCY_CODE,PRODUCT_ID,SCHEME_ID,COMPANY_ID,RELATIVE_USER_ID,AMEND_ID,SYSDATETIME(),SYSDATETIME(),STATUS,?,? FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=?
###Motor User Registration - End

##Motor Payment Details start
GET_PAYMENT_TRANID_SEQ = SELECT PAYMENT_TRAN_ID.NEXTVAL FROM DUAL
GET_ONLINE_PAYMENT_STATUS = select PAYMENT_YN from PRODUCT_MASTER where PRODUCT_ID=? and status='Y'
INS_MOTOR_PAY_DETAILS = INSERT INTO MOTOR_PAYMENT_DETAIL(APPLICATION_NO,QUOTE_NO,PRODUCT_ID,PAYMENT_TYPE,PREMIUM,CHEQUE_NO,BANK_NAME,MICR_CODE,CHEQUE_AMOUNT,CHEQUE_DATE,REQUEST_TIME,MERCHANT_REFERENCE,CUSTOMER_EMAIL,CUSTOMER_NAME) VALUES (?,?,?,?,?,?,?,?,?, CONVERT(DATE,?,103),SYSDATETIME(),?,?,substring(?,1,40))
UPD_MOTOR_PAY_DETAILS_REF = UPDATE MOTOR_PAYMENT_DETAIL SET PRODUCT_ID=?,PAYMENT_TYPE=?,PREMIUM=?,CHEQUE_NO=?,BANK_NAME=?,MICR_CODE=?,CHEQUE_AMOUNT=?,CHEQUE_DATE=CONVERT(DATE,?,103),REQUEST_TIME=SYSDATETIME(),CUSTOMER_EMAIL=?,CUSTOMER_NAME=? where APPLICATION_NO=? AND QUOTE_NO=? AND MERCHANT_REFERENCE=?
UPD_MOTOR_PAY_DETAILS = UPDATE MOTOR_PAYMENT_DETAIL SET RESPONSE_TIME=SYSDATETIME(),RESPONSE_MESSAGE=?,RESPONSE_STATUS=?,CARD_NUMBER_MASKED=?,RESPONSE_CODE=?,RESPONSE_TRAN_NO=?,RESPONSE_AMT=?,RESPONSE_CUSTOMER_IP=?,RESPONSE_SIGNATURE=? WHERE MERCHANT_REFERENCE=?
GET_MOTOR_PAY_DETAILS = SELECT * FROM MOTOR_PAYMENT_DETAIL WHERE MERCHANT_REFERENCE=?
GET_PAYMENTQUOTENO = SELECT QUOTE_NO FROM MOTOR_PAYMENT_DETAIL WHERE MERCHANT_REFERENCE=?
GET_PAYMENTAPPLICATIONNO = SELECT APPLICATION_NO FROM MOTOR_PAYMENT_DETAIL WHERE MERCHANT_REFERENCE=?
GET_PAYMENT_STATUS=SELECT count(*) COUNT FROM MOTOR_PAYMENT_DETAIL WHERE MERCHANT_REFERENCE=? and  RESPONSE_CODE='14000'
CHECK_USER_TYPE = select COUNT(*) from LOGIN_MASTER where LOGIN_ID=? and OA_CODE=?
GET_PAYMENT_SOURCE_DETAIL=SELECT PAYMENT_ID,SOURCE_ENVIRONMENT, ACCESS_CODE, MERCHANT_IDENTIFIER,CURRENCY_TYPE,LANGUAGE, ORDER_DESCRIPTION,ECI,RETURN_URL,COMMAND,STATUS,REMARKS,REQUESTPASSPHRASE FROM PAYMENT_MASTER WHERE SOURCE_ENVIRONMENT=? and STATUS='Y'
PAYMENT_STATUS_ONLINE = SELECT COUNT(*) FROM HOME_POSITION_MASTER HPM,MOTOR_PAYMENT_DETAIL MPD WHERE HPM.QUOTE_NO=MPD.QUOTE_NO AND HPM.QUOTE_NO=? AND UPPER(MPD.RESPONSE_MESSAGE)=UPPER('SUCCESS') AND MPD.RESPONSE_STATUS='14' AND MPD.MERCHANT_REFERENCE=(SELECT MAX(MERCHANT_REFERENCE)  MERCHANT_REFERENCE FROM MOTOR_PAYMENT_DETAIL WHERE QUOTE_NO=?) AND HPM.OVERALL_PREMIUM=MPD.PREMIUM
GET_SUCCESS_MERCHANT_ID=SELECT MPD.MERCHANT_REFERENCE FROM HOME_POSITION_MASTER HPM,MOTOR_PAYMENT_DETAIL MPD WHERE HPM.QUOTE_NO=MPD.QUOTE_NO AND HPM.QUOTE_NO=? AND UPPER(MPD.RESPONSE_MESSAGE)=UPPER('SUCCESS') AND MPD.RESPONSE_STATUS='14' AND MPD.MERCHANT_REFERENCE=(SELECT MAX(MERCHANT_REFERENCE)  MERCHANT_REFERENCE FROM MOTOR_PAYMENT_DETAIL WHERE QUOTE_NO=?) AND HPM.OVERALL_PREMIUM=MPD.PREMIUM

GET_SADAAD_STATUS=SELECT COUNT(*) FROM HOME_POSITION_MASTER HPM,MOTOR_PAYMENT_DETAIL MPD WHERE HPM.QUOTE_NO=MPD.QUOTE_NO AND HPM.QUOTE_NO=? AND MPD.RESPONSE_STATUS in (SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID='206' AND STATUS='Y') AND UPPER(MPD.PAYMENT_TYPE)='SADAD' AND MPD.MERCHANT_REFERENCE=(SELECT MAX(MERCHANT_REFERENCE)  MERCHANT_REFERENCE FROM MOTOR_PAYMENT_DETAIL WHERE QUOTE_NO=?) AND HPM.OVERALL_PREMIUM=MPD.PREMIUM
GET_SADAAD_MERCHANT_ID=SELECT MPD.MERCHANT_REFERENCE FROM HOME_POSITION_MASTER HPM,MOTOR_PAYMENT_DETAIL MPD WHERE HPM.QUOTE_NO=MPD.QUOTE_NO AND HPM.QUOTE_NO=? AND MPD.RESPONSE_STATUS in (SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID='206' AND STATUS='Y') AND UPPER(MPD.PAYMENT_TYPE)='SADAD' AND MPD.MERCHANT_REFERENCE=(SELECT MAX(MERCHANT_REFERENCE)  MERCHANT_REFERENCE FROM MOTOR_PAYMENT_DETAIL WHERE QUOTE_NO=?) AND HPM.OVERALL_PREMIUM=MPD.PREMIUM
GET_PAYMENT_SADAD_ARCHIVE = {CALL PAY_ARCH_PROCESS(?,?)}
#End



#Login 
UPD_SESSION_END_TIME=UPDATE SESSION_MASTER SET END_TIME=SYSTIMESTAMP() WHERE SESSION_ID = ? AND LOGIN_ID = ? AND STATUS = ?
UPD_USER_SESSION = UPDATE SESSION_MASTER SET LOGIN_ID=?,START_TIME=SYSDATETIME() WHERE SESSION_ID = ? AND STATUS = ?
GET_BROKER_BRANCH_CODE=SELECT ISNULL(BRANCH_CODE,'01') FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE = (SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID IN (''{0}''))
GET_SESSION_CNT=SELECT COUNT(*) FROM SESSION_MASTER WHERE SESSION_ID = ? AND LOGIN_ID = ? AND SYSDATETIME() >= (END_TIME + ({0}/1440)) AND STATUS = ?
GET_CONSTANT_CNT=SELECT COUNT(*) FROM CONSTANT_DETAIL WHERE CATEGORY_ID='40' AND LOWER(DETAIL_NAME)=(SELECT LOWER(USERTYPE) FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND BRANCH_CODE=(SELECT ISNULL(BRANCH_CODE,'0') FROM LOGIN_MASTER WHERE LOGIN_ID=?)
INS_SESSION_DTL=INSERT INTO SESSION_MASTER(SESSION_ID,LOGIN_ID,START_TIME,END_TIME,STATUS,SYS_IP_ADDRESS)  VALUES(?,?,SYSDATETIME(),SYSDATETIME(),?,?)
UPD_SWAPED_PSW_ID=UPDATE LOGIN_MASTER SET  LPASS5 =  ?,  LPASS4 =  ?, LPASS3=  ?,LPASS2 =  ?,LPASS1 =  ?,PASSWORD =  ?, PASSDATE=SYSDATETIME()+45 ,STATUS = ? WHERE LOGIN_ID = ?
UPD_SWAPED_PSW_USER=UPDATE LOGIN_MASTER SET LPASS5 = ? , LPASS4 = ?,LPASS3 = ? ,LPASS2 = ?,LPASS1 = ? ,PASSWORD = ? ,PASS_DT=SYSDATETIME(), STATUS = ? WHERE USERNAME = ?
GET_BR_CODE_BYOACODE=SELECT ISNULL(BRANCH_CODE,'020') FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GET_BR_CODE_BYLOGINID=SELECT ISNULL(BRANCH_CODE,'020') FROM LOGIN_RSAUSER_DETAILS WHERE LOGIN_ID=?
GET_BR_DTLS=SELECT CURRENCY_ABBREVIATION,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,CURRENCY_ABBREVIATION,DECIMAL_PLACES,ISNULL(TAX,'0'),EMAIL FROM BRANCH_MASTER where BRANCH_CODE\=?

#Marine Insurance
quotation.title=SELECT TITLE_NAME FROM TITLE_MASTER WHERE BRANCH_CODE=? AND STATUS='Y' ORDER BY TITLE_NAME
report.portfolio=SELECT A.POLICY_NO, A.CUSTOMER_ID, (ISNULL(A.PREMIUM,0)+ISNULL(A.EXCESS_PREMIUM,0))PREMIUM, CONVERT (VARCHAR(10),A.INCEPTION_DATE,103) QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, ISNULL (A.OPEN_COVER_NO, ''0''), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME,REPLACE(CONVERT(VARCHAR(10),MPD.LC_DATE,103) ,''01/01/1900'',''N/A'') LC_DATE,MPD.LC_NUMBER LC_NUMBER,REPLACE(CONVERT(VARCHAR(10), MPD.BL_AWB_DATE,103) ,''01/01/1900'',''N/A'') BL_AWB_DATE,MPD.BL_AWB_NO BL_AWB_NO, MRD.DESCRIPTION GOODS_DESCRIPTION,MRD.PO_NUMBER PO_NUMBER ,(select USERNAME from login_master lm where lm.login_id\=(CASE WHEN A.APPLICATION_ID \= ''1'' THEN A.LOGIN_ID ELSE A.APPLICATION_ID END) )   USERNAME,mrd.INVOICE_NUMBER INVOICE_NO  FROM POSITION_MASTER A, PERSONAL_INFO B,MARINE_POLICY_DETAILS mpd,MARINE_RESULT_DETAILS MRD WHERE {0} A.STATUS \= ''P'' AND  MRD.APPLICATION_NO \=A.APPLICATION_NO AND  a.QUOTE_NO\=mpd.QUOTE_NO AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ?  AND ISNULL(A.OPEN_COVER_NO,''0'') \= ISNULL(?,''0'') AND ORIGINAL_POLICY_NO IS NULL  and  MRD.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM  MARINE_RESULT_DETAILS MRD1 WHERE MRD.APPLICATION_NO\=MRD1.APPLICATION_NO)
report.lapsedquote=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, CONVERT(VARCHAR(10), A.LAPSED_DATE,103) LAPSED_DATE,CONVERT(VARCHAR(10),DATEADD(MONTH,1, (A.ENTRY_DATE - 1)),103) VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, C.PREMIUM, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME, (CASE WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Admin' THEN 'Rejected By Admin' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Normal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Referal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND C.REMARKS  \= 'Normal' THEN 'Rejected By Broker' ELSE 'Rejected By Admin' END) REJECT_DESC,A.LAPSED_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA C WHERE C.APPLICATION_NO  \= A.APPLICATION_NO AND A.LOGIN_ID \=? AND (A.STATUS IN ('D')) AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= ISNULL(?,'1')  AND ISNULL(A.OPEN_COVER_NO,'0') like ISNULL(? + '' +'%','0')
premium.quotation.insured_goods_info=SELECT CM.COMMODITY_ID, CM.COMMODITY_NAME, ISNULL(MRD.COMMODITY_EXCESS_PREMIUM,0) POLICY_EXCESS,MRD.POLICY_EXCESS_PERCENT POLICY_EXCESS_PERCENT, MRD.DESCRIPTION,MRD.EXCESS_DESCRIPTION EXCESS_DESCRIPTION, MRD.SUM_INSURED, ISNULL(MRD.RATE,0) RATE, ISNULL(MRD.WARRATE,0)WARRATE,(RATE+WARRATE) MARINE_WAR_RATE, (case MRD.FRAGILE when 'on' then 'YES' when 'off' then 'NO' end) FRAGILE, MRD.PACKAGE_DESCRIPTION, MRD.SUPPLIER_NAME, MRD.INVOICE_NUMBER FROM MARINE_RESULT_DETAILS MRD, COMMODITYMASTER CM WHERE MRD.APPLICATION_NO \= ? AND CM.COMMODITY_ID \= MRD.COMMODITY_ID AND CM.BRANCH_CODE \= ? AND CM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID \= CM.COMMODITY_ID AND BRANCH_CODE \= CM.BRANCH_CODE AND convert(date,EFFECTIVE_DATE,103) <\= convert (date,getdate(), 103)) AND convert(date,CM.EFFECTIVE_DATE, 103) <\= convert (date,getdate(), 103) AND MRD.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO\=MRD.APPLICATION_NO) ORDER BY SNO
#premium.quotation.information=SELECT MT.TRANSPORT_DESCRIPTION,MD.MODE_OF_TRANSPORT, CM.COVER_NAME, CVM.CONVDESC, (CASE WHEN MD.EXTRA_COVER_ID = 0 THEN 'NO' ELSE 'YES' END) WAR_SRCC, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE = 'YES' THEN MD.TRANSIT_FROM + ',' + CNM.COUNTRY_NAME + ', WAREHOUSE' ELSE CNM.COUNTRY_NAME + ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN MD.WARE_TO_WARE_FINAL_DEST = 'YES' THEN MD.FINAL_DESTINATION + ',' + CN1.COUNTRY_NAME + ', WAREHOUSE' ELSE CN1.COUNTRY_NAME + ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID = MD.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID = CN1.COUNTRY_ID)) DEST_COUNTRY, MD.CURRENCY_NAME,CASE WHEN SM.SALE_TERM_VALUE = 0 AND NULLIF (TM.TOLERANCE_NAME, '0') = '0' THEN replace(isnull(nullif(substring(SM.SALE_TERM_NAME,1,dbo.instr(SM.SALE_TERM_NAME,'+',1,1)),''),SM.SALE_TERM_NAME),'+','') WHEN SM.SALE_TERM_VALUE = 0 AND NULLIF (TM.TOLERANCE_NAME, '0') = 'NONE' THEN replace(isnull(nullif(substring(SM.SALE_TERM_NAME,1,dbo.instr(SM.SALE_TERM_NAME,'+',1,1)),''),SM.SALE_TERM_NAME),'+','') WHEN SM.SALE_TERM_VALUE = 0 AND NULLIF (TM.TOLERANCE_NAME, '0') != 'NONE' THEN replace(isnull(nullif(substring(SM.SALE_TERM_NAME,1,dbo.instr(SM.SALE_TERM_NAME,'+',1,1)),''),SM.SALE_TERM_NAME),'+','') + '+' + TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NULLIF (TM.TOLERANCE_NAME, '0') = 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NULLIF (TM.TOLERANCE_NAME, '0') != 'NONE' THEN SM.SALE_TERM_NAME + '+' + TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END SALES_TERM, convert(decimal(10,2),  ((  isnull(MD.EQUIVALENT_USD,0)+ isnull (MD.TOTAL_SALE_TERM_CHARGES, 0)+ isnull (MD.TOTAL_TOLERANCE_CHARGES, 0)))) EQUIVALENT,convert(decimal(20,2) , ((  isnull(MD.EQUIVALENT_USD,0)+ isnull (MD.TOTAL_SALE_TERM_CHARGES, 0) + isnull (MD.TOTAL_TOLERANCE_CHARGES, 0))/MD.EXCHANGE_RATE)) TOTAL_INSURED,convert(decimal(10,2),MARINE_PREMIUM) MARINE_PREMIUM,Isnull (convert(decimal(10,2),MD.WAR_PREMIUM),0) WAR_PREMIUM,REPLACE (ISNULL (convert(decimal(10,2),MD.EXCESS_PREMIUM), 0), '-', '') ADDITIONAL_PREMIUM,ISNULL (convert(decimal(10,2),MD.POLICY_FEE), '0') POLICY_ISSUNCE_FEE,ISNULL (convert(decimal(10,2),MD.INSPECTION_FEE), '0') INSPECTION_FEE,ISNULL(convert(decimal(10,2),MD.PREMIUM),0) TOTAL_PREMIUM,ROUND (convert(decimal(10,2),(ISNULL (MD.PREMIUM, 0)+ ISNULL (MD.EXCESS_PREMIUM, 0)+ ISNULL (MD.POLICY_FEE, 0)+ ISNULL (MD.GOVT_TAX, 0)+ ISNULL (MD.INSPECTION_FEE, 0))),0) NET_PREMIUM,CONVERT(VARCHAR,MD.INCEPTION_DATE,103) POLICY_START_DATE, (SELECT FIRST_NAME FROM PERSONAL_INFO WHERE PM.CUSTOMER_ID = CUSTOMER_ID) CUSTOMER_NAME, MD.EXCHANGE_RATE, (CASE WHEN (PM.STATUS IN ('Y', 'E') AND PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS = 'N') THEN 'Y' ELSE 'N' END) STATUS, (CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS = 'N') OR (PM.REMARKS IN ('Admin','Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS = 'Y'))) THEN MD.REMARKS ELSE NULL END) REFERRAL_DESC, PM.QUOTE_NO QUOTE_NUMBER,MPD.BANK_NAME,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) = 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID = MPD.SETTLING_AGENT_ID and (branch_code=? or branch_code='01')) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID = (SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO)) PACKAGE_DESCRIPTION,MD.COVER_ID,PM.LOGIN_ID,REPLACE(PM.APPLICATION_ID,'1','') ISSUER,PM.DISCOUNT_PREMIUM,MD.ADMIN_REFERRAL_STATUS,(CASE WHEN NULLIF(MD.EXCESS_PREMIUM,0) <0 THEN '-' ELSE '+' END) EXCESS_SIGN,PM.CUSTOMER_ID, PM.ADMIN_REFERRAL_REMARKS, PM.ADMIN_REMARKS,PM.REMARKS,MD.CHANNEL_TYPE,NULLIF (MD.GOVT_TAX, 0) GOVT_TAX FROM MARINE_DATA MD, POSITION_MASTER PM, MARINE_POLICY_DETAILS MPD,MODE_OF_TRANSPORT MT, COVER_MASTER CM, (SELECT CYM.CONV_MEAN,CYM.CONVDESC,CYM.MODE_TRANSPORT_ID,CYM.BRANCH_CODE FROM CONVEYAN_MASTER CYM WHERE CYM.BRANCH_CODE=? AND CYM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN = CYM.CONV_MEAN AND BRANCH_CODE = CYM.BRANCH_CODE AND CONVERT(DATE,EFFECTIVE_DATE,103) <= CONVERT(DATE,GETDATE(),103) AND MODE_TRANSPORT_ID=CYM.MODE_TRANSPORT_ID) AND CONVERT(DATE,CYM.EFFECTIVE_DATE,103) <= CONVERT(DATE,GETDATE(),103) UNION ALL SELECT 0,'NONE',0,? FROM DUAL) CVM, COUNTRY_MASTER CNM, SALE_TERM_MASTER SM, TOLERANCE_MASTER TM WHERE MD.APPLICATION_NO = ? AND MD.APPLICATION_NO = PM.APPLICATION_NO AND PM.QUOTE_NO = MPD.QUOTE_NO AND MPD.AMEND_ID = (SELECT MAX (AMEND_ID) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO = MPD.QUOTE_NO) AND MT.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT AND MT.BRANCH_CODE = ? AND CM.COVER_ID = MD.COVER_ID AND CM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COVER_MASTER  WHERE COVER_ID = CM.COVER_ID  AND BRANCH_CODE = CM.BRANCH_CODE AND CONVERT(DATE,EFFECTIVE_DATE,103) <= CONVERT(DATE,GETDATE(),103) AND CM.BRANCH_CODE = MT.BRANCH_CODE AND CM.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT AND CVM.CONV_MEAN = MD.SEA_OPTIONS AND CVM.BRANCH_CODE = MT.BRANCH_CODE AND CASE WHEN CVM.CONV_MEAN='0' THEN MD.MODE_OF_TRANSPORT  ELSE CVM.MODE_TRANSPORT_ID END = MD.MODE_OF_TRANSPORT AND CNM.COUNTRY_ID = MD.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID = CNM.COUNTRY_ID) AND CONVERT(DATE,CNM.EFFECTIVE_DATE,103) <= CONVERT(DATE,GETDATE(),103) AND SM.SALE_TERM_ID = MD.SALE_TERM_ID AND SM.BRANCH_CODE = MT.BRANCH_CODE AND TM.TOLERANCE_ID = MD.TOLERANCE_ID AND TM.BRANCH_CODE = MT.BRANCH_CODE  AND PM.AMEND_ID=MPD.AMEND_ID AND MD.AMEND_ID=PM.AMEND_ID) 
premium.quotation.information= SELECT round(md.VAT_TAX_AMT,2) VAT_TAX_AMT,md.VAT_TAX_PERCENT,MT.TRANSPORT_DESCRIPTION,MD.MODE_OF_TRANSPORT, CM.COVER_NAME, CVM.CONVDESC, (CASE WHEN MD.EXTRA_COVER_ID = 0 THEN 'NO' ELSE 'YES' END) WAR_SRCC, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE = 'YES' THEN MD.TRANSIT_FROM + ',' + CNM.COUNTRY_NAME + ', WAREHOUSE' ELSE CNM.COUNTRY_NAME + ', ANY PORT' END) ORIGIN_COUNTRY, (SELECT CASE WHEN MD.WARE_TO_WARE_FINAL_DEST = 'YES' THEN MD.FINAL_DESTINATION + ',' + CN1.COUNTRY_NAME + ', WAREHOUSE' ELSE CN1.COUNTRY_NAME + ', ANY PORT' END FROM COUNTRY_MASTER CN1 WHERE CN1.COUNTRY_ID = MD.FINAL_DESTINATION_COUNTRY_ID AND CN1.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID = CN1.COUNTRY_ID)) DEST_COUNTRY, MD.CURRENCY_NAME,CASE WHEN SM.SALE_TERM_VALUE = 0 AND NULLIF (TM.TOLERANCE_NAME, '0') = '0' THEN replace(isnull(nullif(substring(SM.SALE_TERM_NAME,1,dbo.instr(SM.SALE_TERM_NAME,'+',1,1)),''),SM.SALE_TERM_NAME),'+','') WHEN SM.SALE_TERM_VALUE = 0 AND NULLIF (TM.TOLERANCE_NAME, '0') = 'NONE' THEN replace(isnull(nullif(substring(SM.SALE_TERM_NAME,1,dbo.instr(SM.SALE_TERM_NAME,'+',1,1)),''),SM.SALE_TERM_NAME),'+','') WHEN SM.SALE_TERM_VALUE = 0 AND NULLIF (TM.TOLERANCE_NAME, '0') != 'NONE' THEN replace(isnull(nullif(substring(SM.SALE_TERM_NAME,1,dbo.instr(SM.SALE_TERM_NAME,'+',1,1)),''),SM.SALE_TERM_NAME),'+','') + '+' + TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NULLIF (TM.TOLERANCE_NAME, '0') = 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND NULLIF (TM.TOLERANCE_NAME, '0') != 'NONE' THEN SM.SALE_TERM_NAME + '+' + TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END SALES_TERM, convert(decimal(10,2),  ((  isnull(MD.EQUIVALENT_USD,0)+ isnull (MD.TOTAL_SALE_TERM_CHARGES, 0)+ isnull (MD.TOTAL_TOLERANCE_CHARGES, 0)))) EQUIVALENT,convert(decimal(20,2) , ((  isnull(MD.EQUIVALENT_USD,0)+ isnull (MD.TOTAL_SALE_TERM_CHARGES, 0) + isnull (MD.TOTAL_TOLERANCE_CHARGES, 0))/MD.EXCHANGE_RATE)) TOTAL_INSURED,convert(decimal(10,2),MARINE_PREMIUM) MARINE_PREMIUM,Isnull (convert(decimal(10,2),MD.WAR_PREMIUM),0) WAR_PREMIUM,REPLACE (ISNULL (convert(decimal(10,2),MD.EXCESS_PREMIUM), 0), '-', '') ADDITIONAL_PREMIUM,ISNULL (convert(decimal(10,2),MD.POLICY_FEE), '0') POLICY_ISSUNCE_FEE,POLICYFEEYN,ISNULL (convert(decimal(10,2),MD.INSPECTION_FEE), '0') INSPECTION_FEE,ISNULL(convert(decimal(10,2),MD.PREMIUM),0) TOTAL_PREMIUM,ROUND (convert(decimal(10,2),(ISNULL (MD.PREMIUM, 0)+ ISNULL (MD.EXCESS_PREMIUM, 0)+ ISNULL (MD.POLICY_FEE, 0)+ ISNULL (MD.INSPECTION_FEE, 0)+ISNULL (MD.VAT_TAX_AMT, 2))),2) NET_PREMIUM,CONVERT(VARCHAR,MD.INCEPTION_DATE,103) POLICY_START_DATE, (SELECT FIRST_NAME FROM PERSONAL_INFO PI WHERE PM.CUSTOMER_ID = PI.CUSTOMER_ID and AMEND_ID=(select MAX(amend_id) from PERSONAL_INFO pio where pio.CUSTOMER_ID=PI.CUSTOMER_ID)) CUSTOMER_NAME, MD.EXCHANGE_RATE, (CASE WHEN (PM.STATUS IN ('Y', 'E') AND PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS = 'N') THEN 'Y' ELSE 'N' END) STATUS, (CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS = 'N') OR (PM.REMARKS IN ('Admin','Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS = 'Y'))) THEN MD.REMARKS ELSE NULL END) REFERRAL_DESC, PM.QUOTE_NO QUOTE_NUMBER,MPD.BANK_NAME,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) = 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID = MPD.SETTLING_AGENT_ID and (branch_code=? or branch_code='01')) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID = (SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO)) PACKAGE_DESCRIPTION,MD.COVER_ID,PM.LOGIN_ID,REPLACE(PM.APPLICATION_ID,'1','') ISSUER,PM.DISCOUNT_PREMIUM,MD.ADMIN_REFERRAL_STATUS,(CASE WHEN NULLIF(MD.EXCESS_PREMIUM,0) <0 THEN '-' ELSE '+' END) EXCESS_SIGN,PM.CUSTOMER_ID, PM.ADMIN_REFERRAL_REMARKS, PM.ADMIN_REMARKS,PM.REMARKS,MD.CHANNEL_TYPE,NULLIF (MD.GOVT_TAX, 0) GOVT_TAX,len(MD.OPEN_BANK_ID) OPEN_BANK_ID FROM MARINE_DATA MD, POSITION_MASTER PM, MARINE_POLICY_DETAILS MPD,MODE_OF_TRANSPORT MT, COVER_MASTER CM, (SELECT CYM.CONV_MEAN,CYM.CONVDESC,CYM.MODE_TRANSPORT_ID,CYM.BRANCH_CODE FROM CONVEYAN_MASTER CYM WHERE CYM.BRANCH_CODE=? AND CYM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN = CYM.CONV_MEAN AND BRANCH_CODE = CYM.BRANCH_CODE AND CONVERT(DATE,EFFECTIVE_DATE,103) <= CONVERT(DATE,GETDATE(),103) AND MODE_TRANSPORT_ID=CYM.MODE_TRANSPORT_ID) AND CONVERT(DATE,CYM.EFFECTIVE_DATE,103) <= CONVERT(DATE,GETDATE(),103) UNION ALL SELECT 0,'NONE',0,? ) CVM, COUNTRY_MASTER CNM, SALE_TERM_MASTER SM, TOLERANCE_MASTER TM WHERE MD.APPLICATION_NO = ? AND MD.APPLICATION_NO = PM.APPLICATION_NO AND PM.QUOTE_NO = MPD.QUOTE_NO AND MPD.AMEND_ID = (SELECT MAX (AMEND_ID) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO = MPD.QUOTE_NO) AND MT.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT AND MT.BRANCH_CODE = ? AND CM.COVER_ID = MD.COVER_ID AND CM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COVER_MASTER  WHERE COVER_ID = CM.COVER_ID  AND BRANCH_CODE = CM.BRANCH_CODE AND CONVERT(DATE,EFFECTIVE_DATE,103) <= CONVERT(DATE,GETDATE(),103) AND CM.BRANCH_CODE = MT.BRANCH_CODE AND CM.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT AND CVM.CONV_MEAN = MD.SEA_OPTIONS AND CVM.BRANCH_CODE = MT.BRANCH_CODE AND CASE WHEN CVM.CONV_MEAN='0' THEN MD.MODE_OF_TRANSPORT  ELSE CVM.MODE_TRANSPORT_ID END = MD.MODE_OF_TRANSPORT AND CNM.COUNTRY_ID = MD.TRANSIT_FROM_COUNTRY_ID AND CNM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID = CNM.COUNTRY_ID) AND CONVERT(DATE,CNM.EFFECTIVE_DATE,103) <= CONVERT(DATE,GETDATE(),103) AND SM.SALE_TERM_ID = MD.SALE_TERM_ID AND SM.BRANCH_CODE = MT.BRANCH_CODE AND TM.TOLERANCE_ID = MD.TOLERANCE_ID AND TM.BRANCH_CODE = MT.BRANCH_CODE  AND PM.AMEND_ID=MPD.AMEND_ID AND MD.AMEND_ID=PM.AMEND_ID)
quotation.branchInfo=SELECT CURRENCY_ABBREVIATION,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,CURRENCY_ABBREVIATION,DECIMAL_PLACES,ISNULL(TAX,'0'),EMAIL FROM BRANCH_MASTER WHERE BRANCH_CODE=?
GET_SALETERM_VALUE = select sale_term_value from sale_term_master where sale_term_id\=? and branch_code\=? and status\='Y'
GET_SALETERM_VAL = select sale_term_value from sale_term_master where sale_term_id\=? and branch_code\=?
GET_TOLERANCE_PERCENT = SELECT TOLERANCE_VALUE FROM TOLERANCE_MASTER WHERE TOLERANCE_ID=? AND BRANCH_CODE=?
GET_LATEST_APPLICATION_NO= select application_no from position_master where policy_no=?

quotation.commodity=SELECT nullif (B.SELECTED, 'false') SELECTED, A.COMMODITY_ID, nullif (B.COMMODITY_DESCRIPTION, A.COMMODITY_NAME) COMMODITY_NAME, B.SUMINSURED SUM_INSURED, B.PACKAGE_DESCRIPTION PACKAGE_DESC, B.INVOICE_NUMBER, B.INVOICE_DATE, B.INVOICE_DATE1, B.supplier_name, B.FRAGILE, B.FRAGILE_SELECTED, A.COMMODITY_TYPE_ID,B.EXCESS_DESCRIPTION,B.PO_NUMBER PO_NUMBER FROM COMMODITYMASTER A JOIN (SELECT 'true' SELECTED, COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED, PACKAGE_DESCRIPTION, INVOICE_NUMBER, convert (varchar(10),cast(INVOICE_DATE as DATE), 103) INVOICE_DATE, convert (varchar(10),cast(INVOICE_DATE as DATE), 103) INVOICE_DATE1, supplier_name, FRAGILE, (case FRAGILE when 'on' then 'Yes' when 'off' then  'No' end) FRAGILE_SELECTED,EXCESS_DESCRIPTION,PO_NUMBER FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO \= ? AND COMMODITY_CODE \= ?) B ON (B.COMMODITY_CODE \= A.COMMODITY_ID) WHERE A.BRANCH_CODE \= ? AND A.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID \= A.COMMODITY_ID AND BRANCH_CODE \= A.BRANCH_CODE) ORDER BY COMMODITY_NAME
quotation.commodity.oc=SELECT nullif (B.SELECTED, 'false') SELECTED, A.COMMODITY_ID, A.COMMODITY_TYPE_ID, nullif (B.COMMODITY_DESCRIPTION, A.COMMODITY_NAME_DESC) COMMODITY_NAME, B.SUMINSURED SUM_INSURED, B.SUPPLIER_NAME, B.PACKAGE_DESCRIPTION PACKAGE_DESC, B.INVOICE_NUMBER, B.INVOICE_DATE, B.FRAGILE, B.FRAGILE_SELECTED,B.EXCESS_DESCRIPTION,B.PO_NUMBER PO_NUMBER FROM OPEN_COVER_COMMODITY_MASTER A LEFT OUTER JOIN (SELECT 'true' SELECTED, COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED, SUPPLIER_NAME, PACKAGE_DESCRIPTION, INVOICE_NUMBER,  convert (varchar(10),INVOICE_DATE, 103) INVOICE_DATE,FRAGILE,(case FRAGILE when 'on' then 'Yes' when 'off' then  'No' end) FRAGILE_SELECTED,EXCESS_DESCRIPTION,PO_NUMBER FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO \= ?) B ON (B.COMMODITY_CODE \= A.COMMODITY_ID) WHERE A.PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?) AND A.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO\=A.PROPOSAL_NO) AND COMMODITY_ID\=? ORDER BY COMMODITY_NAME
quotation.commodity.total=SELECT '1' TOTAL_COMMODITY, SUMINSURED SUM_INSURED, E.COMMODITY_DESCRIPTION     FROM WEBSERVICE_MARINE_COMMODITY E WHERE REFERENCE_NUMBER\=?
##commodity.add=INSERT INTO WEBSERVICE_MARINE_COMMODITY (COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED,SUPPLIER_NAME,PACKAGE_DESCRIPTION,INVOICE_NUMBER,INVOICE_DATE,FRAGILE,REFERENCE_NUMBER,APPLICATION_NO,EXCESS_DESCRIPTION) VALUES (?,?,?,?,?,?,cast(NULLIF(?,'') AS DATE),?,?,?,?)
commodity.add = INSERT INTO WEBSERVICE_MARINE_COMMODITY (COMMODITY_CODE, COMMODITY_DESCRIPTION, SUMINSURED,SUPPLIER_NAME,PACKAGE_DESCRIPTION,INVOICE_NUMBER,INVOICE_DATE,FRAGILE,REFERENCE_NUMBER,APPLICATION_NO,EXCESS_DESCRIPTION,PO_NUMBER) VALUES (?,?,?,?,?,?,CONVERT(DATE,?,103),?,?,?,?,?)

commodity.update=UPDATE WEBSERVICE_MARINE_COMMODITY SET SUPPLIER_NAME=?,PACKAGE_DESCRIPTION=?,INVOICE_NUMBER=? WHERE APPLICATION_NO=? AND COMMODITY_ID=?
commodity.delete=DELETE FROM WEBSERVICE_MARINE_COMMODITY WHERE APPLICATION_NO\=? AND COMMODITY_CODE\=?
quote.add=INSERT INTO WEBSERVICE_MARINE_QUOTE (BROKER_CODE, REFERENCE_NUMBER, TYPE, OPENCOVER_POLICY_NUMBER, CUSTOMER_NAME, PO_BOX, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGIN_CITY_NAME, DEST_CITY_NAME, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_PERCENT, CURRENCY, SETTLING_AGENT, POLICY_START_DATE, SAILING_DATE, VESSEL_NAME, LC_NUMBER, ISSUING_BANK, LC_DATE, PARTIAL_SHIPMENT, BL_AWB_NUMBER, BL_AWB_DATE, COVERAGES, SEA_COVERAGES, WSRCC, TOLERANCE, BRANCH_CODE, PRODUCT_ID, PACKAGE_TYPE, SALETERM_VALUE,ADDRESS1,ADDRESS2,EMAIL,CUSTOMER_ID,CUST_TITLE,CUST_CORE_APP_CODE,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, LOGIN_ID, ISSUER,SETTLING_AGENT_NAME,AC_EXECUTIVE_ID,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,CUST_AR_NO,VESSEL_ID,APPLICATION_NO, PROMOTIONAL_CODE, CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME,CORE_CUSTOMER_NAME,CHANNEL_TYPE,EXCHANGE_RATE,VIA,VAT_REG_NO,CUSTOMER_NAME_AR) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,CONVERT(DATE,?,103),CONVERT(DATE,?,103),?,?,?,CONVERT(DATE,?,103),?,?,CONVERT(DATE,?,103),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,cast(nullif(? ,'')as decimal(20,4)),?,?,?,?,?,?,?,?,?,?,?,?,?,?) 
quote.update=UPDATE WEBSERVICE_MARINE_QUOTE SET TYPE\=?, CUSTOMER_NAME\=?, PO_BOX\=?, EMIRATE\=?, MOBILE_NUMBER\=?, MODE_OF_TRANSPORT\=?, ORIGINATING_COUNTRY\=?, DESTINATION_COUNTRY\=?, ORIGINATING_COUNTRY_CITY\=?, DESTINATION_COUNTRY_CITY\=?, ORIGIN_CITY_NAME\=?, DEST_CITY_NAME\=?, ORIGINATING_WAREHOUSE_COVERAGE\=?, DESTINATION_WAREHOUSE_COVERAGE\=?, SALETERM_PERCENT\=?, CURRENCY\=?, SETTLING_AGENT\=?, POLICY_START_DATE\=CONVERT(DATE,?,103), SAILING_DATE\=CONVERT(DATE,?,103), VESSEL_NAME\=?, LC_NUMBER\=?, ISSUING_BANK\=?, LC_DATE\=CONVERT(DATE,?,103), PARTIAL_SHIPMENT\=?, BL_AWB_NUMBER\=?, BL_AWB_DATE\=CONVERT(DATE,?,103), COVERAGES\=?, SEA_COVERAGES\=?, WSRCC\=?, TOLERANCE\=?, PACKAGE_TYPE\=?, SALETERM_VALUE\=?,ADDRESS1\=?,ADDRESS2\=?,EMAIL\=?,CUSTOMER_ID\=?,CUST_TITLE\=?,CUST_CORE_APP_CODE\=?,CUST_CONTRACT_NO\=?, CUST_FMS_CASE_NO\=?, CUST_REFERENCE_NO\=?,SETTLING_AGENT_NAME\=?,SHIPMENT_EXPOSURE\=?,EXPOSURE_CURRENCY\=?,AC_EXECUTIVE_ID\=?,CUST_AR_NO\=?,VESSEL_ID\=?,ISSUER\=?,PROMOTIONAL_CODE\=?, CONSIGNEE_DET\=?, SPECIAL_TERM\=?, ADD_CUST_NAME\=?,core_customer_name\=?,EXCHANGE_RATE\=CONVERT(decimal(20,4),?),CHANNEL_TYPE\=?,VIA\=?,VAT_REG_NO\=?,CUSTOMER_NAME_AR\=? WHERE APPLICATION_NO\=?
quote.count=SELECT (CASE WHEN COUNT(1)>0 THEN 'M' ELSE 'F' END) FROM WEBSERVICE_MARINE_QUOTE WHERE APPLICATION_NO\=? OR QUOTE_NO\=nullif(?,0)
##quote.edit=SELECT BROKER_CODE, REFERENCE_NUMBER, TYPE, MOC_NUMBER, CUSTOMER_NAME, PO_BOX, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGIN_CITY_NAME, DEST_CITY_NAME, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_VALUE, CURRENCY, (CASE WHEN SETTLING_AGENT IS NULL AND LEN(RTRIM(SETTLING_AGENT_NAME))>0 THEN '0' ELSE SETTLING_AGENT END) SETTLING_AGENT, convert(varchar(10),POLICY_START_DATE,101) POLICY_START_DATE, replace(convert(varchar(10),SAILING_DATE,101),'01/01/1900','') SAILING_DATE, VESSEL_NAME,LC_NUMBER, ISSUING_BANK, replace(convert(varchar(10),LC_DATE,101),'01/01/1900','') LC_DATE, PARTIAL_SHIPMENT, BL_AWB_NUMBER, replace(convert(varchar(10),BL_AWB_DATE,101),'01/01/1900','') BL_AWB_DATE, QUOTE_NO, COVERAGES, SEA_COVERAGES, WSRCC, TOLERANCE, BRANCH_CODE, PRODUCT_ID, PACKAGE_TYPE, SALETERM_PERCENT,CUST_TITLE,CUST_CORE_APP_CODE,ADDRESS1,ADDRESS2,EMAIL,OPENCOVER_POLICY_NUMBER,APPLICATION_NO,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, LOGIN_ID, ISSUER, SETTLING_AGENT_NAME, AC_EXECUTIVE_ID,CUSTOMER_ID,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,CUST_AR_NO,VESSEL_ID, PROMOTIONAL_CODE, CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME,CORE_CUSTOMER_NAME,CHANNEL_TYPE,EXCHANGE_RATE,VIA FROM WEBSERVICE_MARINE_QUOTE WHERE APPLICATION_NO=? OR QUOTE_NO=?
quote.edit=SELECT BROKER_CODE, REFERENCE_NUMBER, TYPE, MOC_NUMBER, CUSTOMER_NAME, PO_BOX, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGIN_CITY_NAME, DEST_CITY_NAME, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_VALUE, CURRENCY, (CASE WHEN SETTLING_AGENT IS NULL AND LEN(RTRIM(SETTLING_AGENT_NAME))>0 THEN '0' ELSE SETTLING_AGENT END) SETTLING_AGENT, convert(varchar(10),POLICY_START_DATE,101) POLICY_START_DATE, replace(convert(varchar(10),SAILING_DATE,101),'01/01/1900','') SAILING_DATE, VESSEL_NAME,LC_NUMBER, ISSUING_BANK, replace(convert(varchar(10),LC_DATE,101),'01/01/1900','') LC_DATE, PARTIAL_SHIPMENT, BL_AWB_NUMBER, replace(convert(varchar(10),BL_AWB_DATE,101),'01/01/1900','') BL_AWB_DATE, QUOTE_NO, COVERAGES, SEA_COVERAGES, WSRCC, TOLERANCE, BRANCH_CODE, PRODUCT_ID, PACKAGE_TYPE, SALETERM_PERCENT,CUST_TITLE,CUST_CORE_APP_CODE,ADDRESS1,ADDRESS2,EMAIL,OPENCOVER_POLICY_NUMBER,APPLICATION_NO,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, LOGIN_ID, ISSUER, SETTLING_AGENT_NAME, AC_EXECUTIVE_ID,CUSTOMER_ID,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,CUST_AR_NO,VESSEL_ID, PROMOTIONAL_CODE, CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME,CORE_CUSTOMER_NAME,CHANNEL_TYPE,EXCHANGE_RATE,VIA,VAT_REG_NO,CUSTOMER_NAME_AR FROM WEBSERVICE_MARINE_QUOTE WHERE APPLICATION_NO=? OR QUOTE_NO=?
premium.update.policy.info=UPDATE WEBSERVICE_MARINE_QUOTE SET PDF_PRE_SHOW_STATUS=?, PDF_BANKER_STATUS=?, PDF_GENERATE_STATUS=?, PDF_BANKER_ASSURED_STATUS=?, PDF_CURRENCY_STATUS=?,PDF_STAMP_STATUS=?,NOTE_TYPE=?, PAYMENT_MODE=?, BASIS_VAL=?,CERT_CLAUSES_YN=?,DEBIT_CUST_ID=?,ENDT_PREM_YN=?,ENDT_CLAUSES_YN=?,PDF_EXCESS_STATUS=? WHERE APPLICATION_NO=?
premium.update.referral=UPDATE MARINE_DATA  SET ADMIN_REFERRAL_STATUS=?, REMARKS=? WHERE APPLICATION_NO=?
# AND MARINE_DATA.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_DATA WHERE APPLICATION_NO=MARINE_DATA.APPLICATION_NO)
report.quoteregister.lapsed=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, PI.FIRST_NAME CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO PI WHERE A.LOGIN_ID\=? AND A.EFFECTIVE_DATE <  SYSDATETIME()  AND A.CUSTOMER_ID \= PI.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.STATUS \= 'Y' AND A.APPLICATION_ID \= '1' AND A.APPLICATION_ID \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') like ISNULL(? + '' +'%','0')
report.quoteregister.existing= SELECT distinct  A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, ISNULL (M.OPEN_COVER_NO, '0'), (ISNULL (M.PREMIUM, 0) + ISNULL (M.EXCESS_PREMIUM, 0)) PREMIUM, B.EMAIL FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \=  SYSDATETIME()  AND A.STATUS  \= 'Y' AND (A.REMARKS NOT IN ('Admin', 'Referal', 'NORMAL_EXCESS_PRICE')) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND ISNULL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,0) like ISNULL(? + '' +'%','0') 
report.referral.unapproved= SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, (SELECT * FROM INITCAP (B.FIRST_NAME)) CUSTOMER_NAME , A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, ISNULL (MD.OPEN_COVER_NO, '0') OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'Y')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= SYSDATETIME()  AND A.APPLICATION_ID  \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') like ISNULL(? + '' +'%','0') and B.AMEND_ID\= (select max(AMEND_ID) from PERSONAL_INFO pi where pi.CUSTOMER_ID\=B.CUSTOMER_ID)
report.referral.approved= SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, (SELECT * FROM INITCAP (B.FIRST_NAME)) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, ISNULL (MD.OPEN_COVER_NO, '0') FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Admin') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'N')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ?  AND A.APPLICATION_ID  \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') like ISNULL(? + '' +'%','0') and B.AMEND_ID\= (select max(AMEND_ID) from PERSONAL_INFO pi where pi.CUSTOMER_ID\=B.CUSTOMER_ID)
report.referral.reject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) AS QUOTATION_DATE, (SELECT * FROM INITCAP (B.FIRST_NAME)) CUSTOMER_NAME, A.LOGIN_ID, A. APPLICATION_NO, B.COMPANY_NAME, ISNULL (MD.OPEN_COVER_NO, '0'), ISNULL (A.ADMIN_REMARKS,'') ADMIN_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'R' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') and B.AMEND_ID\= (select max(AMEND_ID) from PERSONAL_INFO pi where pi.CUSTOMER_ID\=B.CUSTOMER_ID)    
premium.update.md=UPDATE MARINE_DATA  SET PREMIUM\=nullif(CONVERT(decimal(10,2), CAST(? AS FLOAT)),0),EXCESS_PREMIUM\=nullif(CONVERT(decimal(20,2), CAST(? AS FLOAT)),0),POLICY_FEE\=convert(decimal,nullif(?,0)),GOVT_TAX\=nullif(CONVERT(decimal(20,2), CAST(? AS FLOAT)),0),TOTAL_WAR_CHARGES\=nullif(CONVERT(decimal(20,2), CAST(? AS FLOAT)),0),INSPECTION_FEE\=nullif(CONVERT(decimal(20,2), CAST(? AS FLOAT)),0) ,POLICYFEEYN\=?  WHERE APPLICATION_NO\=? 
premium.update.pm=UPDATE POSITION_MASTER SET PREMIUM=?,EXCESS_PREMIUM=? WHERE APPLICATION_NO=?
premium.getpolicy.info=SELECT PM.QUOTE_NO, convert (varchar(10),PM.ENTRY_DATE, 103) QUOTE_DATE,convert(varchar(10),PM.ENTRY_DATE, 103) POL_DATE,convert(varchar(10),MD.INCEPTION_DATE, 103) COVER_START_DATE, (CASE WHEN PM.STATUS NOT IN('P','C','D') THEN null ELSE nullif(PM.CREDIT_NOTE_NO,null) END) CREDIT_NOTE_NO, (CASE WHEN PM.STATUS NOT IN('P','C','D') THEN null ELSE PM.POLICY_NO END) POLICY_NO, (CASE WHEN PM.STATUS NOT IN('P','C','D') THEN null ELSE PM.DEBIT_NOTE_NO END) DEBIT_NOTE_NO, MD.TOTAL_SUM_INSURED, ISNULL(PM.PREMIUM,0)+ISNULL(PM.EXCESS_PREMIUM,0) PREMIUM, (SELECT ISNULL (FIRST_NAME, COMPANY_NAME) + ' ' + LAST_NAME FROM PERSONAL_INFO PI WHERE CUSTOMER_ID \= PM.CUSTOMER_ID AND PI.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=PI.CUSTOMER_ID)) PROPOSER_NAME, PDF_PRE_SHOW_STATUS, PDF_BANKER_STATUS, PDF_BANKER_ASSURED_STATUS, PDF_CURRENCY_STATUS,PDF_EXCESS_STATUS,PDF_STAMP_STATUS,(CASE WHEN (PM.STATUS IN ('Y','E') AND ( (PM.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (PM.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y'))) THEN 'Y' ELSE 'N' END) STATUS,PM.LOGIN_ID,PM.CERT_CLAUSES_YN,PM.ENDT_PREM_YN,PM.ENDT_CLAUSES_YN,MD.EQUIVALENT_USD,(MD.EQUIVALENT_USD + ISNULL (MD.TOTAL_SALE_TERM_CHARGES, 0) + ISNULL (MD.TOTAL_TOLERANCE_CHARGES, 0)) EQUIVALENT FROM POSITION_MASTER PM, MARINE_DATA MD WHERE PM.APPLICATION_NO \= ? AND PM.APPLICATION_NO \= MD.APPLICATION_NO AND PM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_DATA WHERE APPLICATION_NO \= MD.APPLICATION_NO) AND PM.AMEND_ID\=MD.AMEND_ID     
premium.custAccount=SELECT CUST_AR_NO FROM PERSONAL_INFO pi WHERE pi.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=pi.CUSTOMER_ID) and CUSTOMER_ID=(SELECT A.CUSTOMER_ID FROM POSITION_MASTER A WHERE A.APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO=A.APPLICATION_NO))
premium.clauses.update=UPDATE POSITION_MASTER  SET  PDF_MODIFY_CLAUSE\=?, PDF_MODIFY_WARRANTY\=?, PDF_MODIFY_EXCLUSION\=?, PDF_MODIFY_EXTRACLAUSES\=? WHERE APPLICATION_NO\=?
warOption=SELECT ISNULL(WRSC_YN,'Y') FROM OPEN_COVER_MASTER  ocm WHERE ocm.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER oc  WHERE oc.PROPOSAL_NO\=ocm.PROPOSAL_NO) and  ocm.PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=? and AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?))      
brokerType=SELECT (CASE WHEN COUNT(*)>0 THEN 'GHQ' ELSE '' END) BROKER_TYPE FROM LOGIN_USER_DETAILS WHERE LOGIN_ID \= ? AND  OA_CODE IN (SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=133)
quotation.getvessel=SELECT VESSEL_ID,VESSEL_NAME,VESSEL_TYPE,VESSEL_CLASS,MANUFACTURE_YEAR FROM VESSEL_MASTER WHERE STATUS IN ('Y','R') AND UPPER(VESSEL_NAME) LIKE UPPER(?) ORDER BY VESSEL_NAME                    
loginId=SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE\=? AND USERTYPE\='Broker'
report.userlist=SELECT LOGIN_ID,USERNAME FROM LOGIN_MASTER WHERE OA_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND USERTYPE != 'Customer' AND USERTYPE != 'User' AND USERTYPE != 'Freight') AND USERTYPE != 'Freight' AND LOGIN_ID IN (SELECT DISTINCT (A.LOGIN_ID) FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.PRODUCT_ID = ? AND A.EFFECTIVE_DATE >  SYSDATETIME() AND A.CUSTOMER_ID = B.CUSTOMER_ID AND B.STATUS = 'Y')
report.userlist.p=SELECT LOGIN_ID,USERNAME FROM LOGIN_MASTER WHERE OA_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND USERTYPE != 'Customer' AND USERTYPE != 'User' AND USERTYPE != 'Freight') AND USERTYPE != 'Freight' AND LOGIN_ID IN (SELECT DISTINCT (A.LOGIN_ID) FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.PRODUCT_ID = ? AND A.EFFECTIVE_DATE >  SYSDATETIME() AND A.CUSTOMER_ID = B.CUSTOMER_ID AND B.STATUS = 'Y' and A.STATUS='P')
report.userlist.issuer=SELECT DISTINCT PM.LOGIN_ID LOGIN_ID,PM.LOGIN_ID FIRST_NAME,BCM.CONTACT_PERSON USERNAME FROM POSITION_MASTER PM,LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE PM.APPLICATION_ID \= ? AND LM.LOGIN_ID\=PM.LOGIN_ID AND LM.OA_CODE\=BCM.AGENCY_CODE AND PM.STATUS in ('Y') AND PM.PRODUCT_ID \= ?
report.userlist.issuer.p=SELECT DISTINCT PM.LOGIN_ID LOGIN_ID,PM.LOGIN_ID FIRST_NAME,BCM.CONTACT_PERSON USERNAME FROM POSITION_MASTER PM,LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE  LM.LOGIN_ID\=PM.LOGIN_ID AND LM.OA_CODE\=BCM.AGENCY_CODE AND PM.STATUS in ('P') AND PM.PRODUCT_ID \= ? and pm.LOGIN_ID in ( select LOGIN_ID from LOGIN_MASTER where BRANCH_CODE\=?)
report.travel.userlist = SELECT DISTINCT LOGIN_ID,USERNAME FROM LOGIN_MASTER WHERE OA_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND USERTYPE != 'Customer' AND USERTYPE != 'User' AND USERTYPE != 'Freight') AND USERTYPE != 'Freight' AND LOGIN_ID IN (SELECT DISTINCT (A.LOGIN_ID) FROM HOME_POSITION_MASTER A, PERSONAL_INFO B WHERE A.PRODUCT_ID = ? AND A.EFFECTIVE_DATE >  SYSDATETIME() AND A.CUSTOMER_ID = B.CUSTOMER_ID AND B.STATUS = 'Y')
report.travel.userlist.issuer = SELECT DISTINCT PM.LOGIN_ID LOGIN_ID,PM.LOGIN_ID FIRST_NAME,BCM.CONTACT_PERSON, concat(' ',PM.LOGIN_ID, '(' , CONTACT_PERSON ,')') USERNAME FROM HOME_POSITION_MASTER PM,LOGIN_MASTER LM, BROKER_COMPANY_MASTER BCM WHERE PM.APPLICATION_ID \= ? AND LM.LOGIN_ID\=PM.LOGIN_ID AND LM.OA_CODE\=BCM.AGENCY_CODE AND PM.STATUS in ('Y') AND PM.PRODUCT_ID \= ?
declaration.quote.info=SELECT PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID, CAST (MD.TOTAL_SUM_INSURED AS DECIMAL (18, 2)) AS TOTAL_SUM_INSURED ,CAST (ISNULL (MD.PREMIUM, 0) + ISNULL (MD.EXCESS_PREMIUM, 0) AS DECIMAL (18, 2)) PREMIUM, PM.CERTIFICATE_NO as POLICY_NO, ISNULL(PM.CREDIT_NOTE_NO,0) CREDIT_NOTE_NO, ISNULL(PM.DEBIT_NOTE_NO,0) DEBIT_NOTE_NO FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD WHERE PM.QUOTE_NO IN (\:QUOTE_NOS) AND MD.APPLICATION_NO\=PM.APPLICATION_NO AND PI.CUSTOMER_ID\=PM.CUSTOMER_ID
declaration.update.quote=UPDATE POSITION_MASTER SET PDF_GENERATE_STATUS\=?,PDF_STAMP_STATUS\=?,debit_note_date\=CONVERT(DATE,?,103),POLICY_EFFECTIVE_DATE\=CONVERT(DATE,?,103) WHERE QUOTE_NO IN ({0})
declaratiion_policy_individual=SELECT A.POLICY_NO+ ' ' +'/'+ ' ' +(ROWNUM) POLICY_NO, A.PREMIUM, convert(varchar(10),A.INCEPTION_DATE, 103) AS QUOTE_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, A.QUOTE_NO, ISNULL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO FROM POSITION_MASTER A, PERSONAL_INFO B WHERE A.LOGIN_ID IN (SELECT LOGIN_ID FROM POSITION_MASTER WHERE POLICY_NO \= ?) AND A.STATUS \= 'P' AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) IN ('LINKED') AND A.POLICY_NO \= ? AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= 11 ORDER BY POLICY_NO
quotation.lcnoExist=SELECT CASE WHEN COUNT(LC_NUMBER)=0 THEN 'FALSE' ELSE 'TRUE' END AVAILABLE FROM WEBSERVICE_MARINE_QUOTE WHERE LC_NUMBER=? AND APPLICATION_NO!=? and OPENCOVER_POLICY_NUMBER is null
quotation.invoiceExist=SELECT CASE WHEN COUNT(INVOICE_NUMBER)\=0 THEN 'FALSE' ELSE 'TRUE' END AVAILABLE FROM WEBSERVICE_MARINE_COMMODITY WHERE INVOICE_NUMBER\=?  AND APPLICATION_NO\!\=?
condition1=SELECT CLAUSES_ID CODE,CLAUSES_DESCRIPTION CODE_DESC FROM CLAUSES_MASTER WHERE COVER_ID=:cover AND CLAUSES_ID NOT IN(:id) AND EXTRA_COVER_ID=0 AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY CLAUSES_ID
condition2=SELECT CLAUSES_ID CODE,CLAUSES_DESCRIPTION CODE_DESC FROM CLAUSES_MASTER WHERE COVER_ID=:cover AND CLAUSES_ID NOT IN(:id) AND EXTRA_COVER_ID!=0 AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY CLAUSES_ID
condition3=SELECT EXCLUSION_ID CODE,EXCLUSION_DESCRIPTION CODE_DESC FROM EXCLUSION_MASTER WHERE EXCLUSION_ID NOT IN(:id) AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY EXCLUSION_ID
condition4=SELECT WARRANTY_ID CODE,WARRANTY_DESCRIPTION CODE_DESC FROM WARRANTY_MASTER WHERE WARRANTY_ID NOT IN(:id) AND STATUS IN ('Y','R') AND BRANCH_CODE=:branch ORDER BY WARRANTY_ID
premium.clauses.add=UPDATE POSITION_MASTER SET  PDF_MODIFY_CLAUSE\=PDF_MODIFY_CLAUSE+ ' ' +?, PDF_MODIFY_WARRANTY\=PDF_MODIFY_WARRANTY+ ' ' +?, PDF_MODIFY_EXCLUSION\=PDF_MODIFY_EXCLUSION+ ' ' +?, PDF_MODIFY_EXTRACLAUSES\=PDF_MODIFY_EXTRACLAUSES+ ' ' +? WHERE QUOTE_NO\=?
report.customer= SELECT ISNULL (FIRST_NAME, COMPANY_NAME) CUSTOMER_NAME , EMAIL, MOBILE, MISSIPPI_CUSTOMER_CODE, REPLACE ( 'P.O.BOX.' + ' ' + ISNULL (POBOX, ' ') + ' ' +','+ ' ' + ISNULL (ADDRESS1, ' ') + ' ' + ISNULL (ADDRESS2, ' ') + ' ' +','+ ' ' + ISNULL (EMIRATE, ' '), 'select','') ADDRESS FROM PERSONAL_INFO WHERE LOGIN_ID \=? AND APPLICATION_ID\= 1 ORDER BY CUSTOMER_ID DESC 
arNoStatus=SELECT CUST_AR_NO FROM PERSONAL_INFO WHERE CUSTOMER_ID=?
opencover.customer=SELECT PI.CUST_AR_NO FROM OPEN_COVER_MASTER OCM,OPEN_COVER_POSITION_MASTER OCPM, PERSONAL_INFO PI WHERE OCPM.OPEN_COVER_NO=? AND PI.CUSTOMER_ID=OCM.CUSTOMER_ID AND OCPM.PROPOSAL_NO=OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX(OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO =OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCMS.PROPOSAL_NO AND convert(date,OCMS.EFFECTIVE_DATE,103) <= convert(date,SYSDATETIME(),103))
GET_WAR_SHOW_YN=SELECT ISNULL(WAR_SHOW_YN,'Y') FROM OPEN_COVER_MASTER OCM,OPEN_COVER_POSITION_MASTER OCPM, PERSONAL_INFO PI WHERE OCPM.OPEN_COVER_NO=? AND PI.CUSTOMER_ID=OCM.CUSTOMER_ID AND OCPM.PROPOSAL_NO=OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX(OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO =OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCMS.PROPOSAL_NO AND convert(date,OCMS.EFFECTIVE_DATE,103) <= convert(date,SYSDATETIME(),103))
direct.status=SELECT (case WHEN cd.remarks is NULL then ''N'' else ''Y'' end) direct_status FROM {0} pm LEFT OUTER JOIN constant_detail cd ON  CD.REMARKS = PM.LOGIN_ID AND CD.CATEGORY_ID = 129 AND cd.branch_code = ? AND cd.status = ''Y'' WHERE pm.application_no = ?
premium.basisValList=SELECT CATEGORY_DETAIL_ID, REMARKS FROM CONSTANT_DETAIL WHERE CATEGORY_ID\=135 AND BRANCH_CODE\=? AND STATUS\='Y' ORDER BY CATEGORY_DETAIL_ID
report.searchByPortfolio=SELECT A.POLICY_NO, A.CUSTOMER_ID, A.PREMIUM, convert (varchar(10),A.INCEPTION_DATE,103) QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, ISNULL (A.OPEN_COVER_NO, '0'), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,BCM.COMPANY_NAME FROM POSITION_MASTER A, PERSONAL_INFO B ,BROKER_COMPANY_MASTER BCM,LOGIN_MASTER LM WHERE A.LOGIN_ID=? AND LM.LOGIN_ID=A.LOGIN_ID AND LM.OA_CODE = BCM.AGENCY_CODE AND B.AMEND_ID = (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID ) AND A.STATUS = 'P' AND B.CUSTOMER_ID = A.CUSTOMER_ID AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID = ? AND A.APPLICATION_ID = ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') = ISNULL(?,'0') AND ORIGINAL_POLICY_NO IS NULL AND (case ? when 'policyNo' then A.POLICY_NO when 'quoteNo' then A.QUOTE_NO when 'custName'  then UPPER(B.FIRST_NAME) else A.POLICY_NO end) LIKE UPPER(?) ORDER BY SUBSTR (A.POLICY_NO, 6, 6) DESC,A.INCEPTION_DATE DESC
report.searchByQuoteExisting=SELECT  distinct A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, ISNULL (M.OPEN_COVER_NO, '0'), (ISNULL (M.PREMIUM, 0) + ISNULL (M.EXCESS_PREMIUM, 0)) PREMIUM, B.EMAIL FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= SYSDATETIME()  AND A.STATUS  \= 'Y' AND (A.REMARKS NOT IN ('Admin', 'Referal', 'NORMAL_EXCESS_PRICE')) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND ISNULL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByQuoteLapsed=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, PI.FIRST_NAME CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO PI WHERE A.LOGIN_ID\=? AND A.EFFECTIVE_DATE <  SYSDATETIME()  AND A.CUSTOMER_ID \= PI.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.STATUS \= 'Y' AND A.APPLICATION_ID \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByQuoteReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, convert(varchar(10),dateadd(mm,1,convert(date,A.ENTRY_DATE-1,103)),103) VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, C.PREMIUM, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME, (CASE WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Admin' THEN 'Rejected By Admin' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Normal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Referal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND C.REMARKS  \= 'Normal' THEN 'Rejected By Broker' ELSE 'Rejected By Admin' END) REJECT_DESC, A.LAPSED_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA C WHERE C.APPLICATION_NO  \= A.APPLICATION_NO AND A.LOGIN_ID \=? AND (A.STATUS IN ('D')) AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= '1' AND A.APPLICATION_ID  \= ISNULL(?,'1')  AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByReferralApproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, (SELECT * FROM INITCAP(B.FIRST_NAME)) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, ISNULL (MD.OPEN_COVER_NO, '0') FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Admin') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'N')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATETIME() FROM DUAL) AND A.APPLICATION_ID  \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC 
report.searchByReferralUnapproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, (SELECT * FROM INITCAP(B.FIRST_NAME)) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, ISNULL (MD.OPEN_COVER_NO, '0') OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'Y')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATETIME() FROM DUAL) AND A.APPLICATION_ID  \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC 
report.searchByReferralReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) AS QUOTATION_DATE, (SELECT * FROM INITCAP(B.FIRST_NAME)) CUSTOMER_NAME, A.LOGIN_ID, A. APPLICATION_NO, B.COMPANY_NAME, ISNULL (MD.OPEN_COVER_NO, '0'), ISNULL(A.ADMIN_REMARKS,'') ADMIN_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'R' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND A.QUOTE_NO LIKE ? ORDER BY A.QUOTE_NO DESC
report.searchByCustomerQuoteExisting=SELECT  distinct A.APPLICATION_NO,A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, A.EFFECTIVE_DATE, ISNULL (M.OPEN_COVER_NO, '0'), (ISNULL (M.PREMIUM, 0) + ISNULL (M.EXCESS_PREMIUM, 0)) PREMIUM, B.EMAIL FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \=  SYSDATETIME()  AND A.STATUS  \= 'Y' AND (A.REMARKS NOT IN ('Admin', 'Referal', 'NORMAL_EXCESS_PRICE')) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND ISNULL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y') AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.APPLICATION_ID \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
report.searchByCustomerQuoteLapsed=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) VALIDITY_DATE, PI.FIRST_NAME CUSTOMER_NAME FROM POSITION_MASTER A, PERSONAL_INFO PI WHERE A.LOGIN_ID\=? AND A.EFFECTIVE_DATE <  SYSDATETIME()  AND A.CUSTOMER_ID \= PI.CUSTOMER_ID AND A.PRODUCT_ID \= ? AND A.STATUS \= 'Y' AND A.APPLICATION_ID \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND (UPPER(PI.COMPANY_NAME) like upper(?) OR  UPPER(PI.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
report.searchByCustomerQuoteReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, convert(varchar(10),dateadd(mm,1,convert(date,A.ENTRY_DATE-1,103)),103 VALIDITY_PERIOD, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, C.PREMIUM, A.STATUS, A.APPLICATION_NO, B.COMPANY_NAME, (CASE WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Admin' THEN 'Rejected By Admin' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Normal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND A.REMARKS  \= 'Referal' THEN 'Rejected By Broker' WHEN A.FREIGHT_STATUS  \= 'F' AND C.REMARKS  \= 'Normal' THEN 'Rejected By Broker' ELSE 'Rejected By Admin' END) REJECT_DESC, A.LAPSED_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA C WHERE C.APPLICATION_NO  \= A.APPLICATION_NO AND A.LOGIN_ID \=? AND (A.STATUS IN ('D')) AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= '1' AND A.APPLICATION_ID  \= ISNULL(?,'1')  AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
report.searchByCustomerReferralApproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, ISNULL (MD.OPEN_COVER_NO, '0') FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Admin') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'N')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATETIME() FROM DUAL) AND A.APPLICATION_ID  \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC 
report.searchByCustomerReferralUnapproved=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A.APPLICATION_NO, B.COMPANY_NAME, ISNULL (MD.OPEN_COVER_NO, '0') OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'Y' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS  \= 'N') OR (A.REMARKS IN ('Admin', 'Normal', 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS  \= 'Y')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.EFFECTIVE_DATE > \= ( SELECT SYSDATETIME() FROM DUAL) AND A.APPLICATION_ID  \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC 
report.searchByCustomerReferralReject=SELECT A.QUOTE_NO, A.CUSTOMER_ID, CONVERT(VARCHAR,A.ENTRY_DATE,103) AS QUOTATION_DATE, INITCAP (B.FIRST_NAME) CUSTOMER_NAME, A.LOGIN_ID, A. APPLICATION_NO, B.COMPANY_NAME, ISNULL (MD.OPEN_COVER_NO, '0'), ISNULL(A.ADMIN_REMARKS,'') ADMIN_REMARKS FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.STATUS  \= 'R' AND B.CUSTOMER_ID  \= A.CUSTOMER_ID AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND A.PRODUCT_ID  \= ? AND A.APPLICATION_ID  \= ISNULL(?,'1') AND ISNULL(A.OPEN_COVER_NO,'0') \= ISNULL(?,'0') AND (UPPER(B.COMPANY_NAME) like upper(?) OR  UPPER(B.FIRST_NAME) like upper(?)) ORDER BY A.QUOTE_NO DESC
VIEW_CLAUSES_OPTION = SELECT ISNULL(CLAUSES_YN,'N') FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?))
GET_RSABROKER_CODE = SELECT RSA_BROKER_CODE FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GET_CORECUSTOMER_CODE = SELECT MISSIPPI_CUSTOMER_CODE FROM PERSONAL_INFO PI WHERE CUSTOMER_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PI1 WHERE PI1.CUSTOMER_ID=PI.CUSTOMER_ID)
GET_COREEXECUTIVE_ID = SELECT RSACODE FROM LOGIN_EXECUTIVE_DETAILS WHERE AC_EXECUTIVE_ID=?
marine.exchangeLimit=SELECT ROUND(EM.EXCHANGE_RATE-(EM.EXCHANGE_RATE * (NULLIF (CM.EX_MINLMT, '1') / 100)),2) MIN_LIMIT,ROUND (EM.EXCHANGE_RATE+ (EM.EXCHANGE_RATE * (NULLIF (CM.EX_MAXLMT, '1') / 100)),2)  MAX_LIMIT  FROM   CURRENCY_MASTER CM, EXCHANGE_MASTER EM WHERE   CM.COUNTRY_ID = (SELECT   ORIGINATION_COUNTRY_ID FROM   BRANCH_MASTER  WHERE   BRANCH_CODE = ?) AND CM.CURRENCY_ID = ? AND CM.AMEND_ID =(SELECT   MAX (AMEND_ID)  FROM   CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND CURRENCY_ID = CM.CURRENCY_ID AND CONVERT (DATE,EFFECTIVE_DATE,103) <= CONVERT (DATE,GETDATE(),103)) AND CONVERT (DATE,CM.EFFECTIVE_DATE,103) <= CONVERT (DATE,GETDATE(),103) AND CM.CURRENCY_ID = EM.CURRENCY_ID AND CM.COUNTRY_ID = EM.COUNTRY_ID  AND EM.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   EXCHANGE_MASTER WHERE       CURRENCY_ID = EM.CURRENCY_ID AND COUNTRY_ID = EM.COUNTRY_ID       AND  CONVERT (DATE,EFFECTIVE_DATE,103) <= CONVERT (DATE,GETDATE(),103)) AND CONVERT (DATE,EM.EFFECTIVE_DATE,103) <= CONVERT (DATE,GETDATE(),103)
GET_OPENCOVER_DEBITTO = Select Debit_Note From Open_Cover_Master Ocm Where Ocm.Proposal_No=(Select Proposal_No From Open_Cover_Position_Master Ocpm Where Ocpm.Open_Cover_No= ? and ocpm.status='P') and amend_id=(select max(amend_id) from Open_Cover_Master oc Where ocm.proposal_no=oc.proposal_no)
GET_ENDT_SUMPREMIUM = Select sum(premium) premium From Marine_DaTa Md where md.application_no in (select application_no from position_master where (original_policy_no in (select original_policy_no from position_master where application_no=? and status in ('P','E')) or policy_no in (select original_policy_no from position_master where application_no=? and status in ('P','E'))) and amend_id <= (select amend_id from position_master p where p.application_no=?) and  status in ('P','E') or  application_no=?)
GET_SUM_INSURED_ENDT=SELECT * FROM (SELECT   APPLICATION_NO,(ROUND(ISNULL (EQUIVALENT_USD, 0) + ISNULL (TOTAL_SALE_TERM_CHARGES, 0),0)) suminsured,LAG (ROUND(ISNULL (EQUIVALENT_USD, 0)+ ISNULL (TOTAL_SALE_TERM_CHARGES, 0),0),1,0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO)AS suminsured_PREV FROM   MARINE_DATA_ENDT) a WHERE  a.APPLICATION_NO = ?
GET_SUM_INSURED=select  ROUND ((  ISNULL(MD.EQUIVALENT_USD,0) + ISNULL (MD.TOTAL_SALE_TERM_CHARGES, 0) + ISNULL (MD.TOTAL_TOLERANCE_CHARGES, 0)),0 ) from marine_data md where application_no\=?
UPDATE_OPEN_COVER_UTILIZED_AMOUNT=UPDATE OPEN_COVER_MASTER SET UTILIZED_AMOUNT=ISNULL (CONVERT (numeric (20, 4), CAST (UTILIZED_AMOUNT AS FLOAT)),0)+ISNULL(?,0) WHERE PROPOSAL_NO=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO=?)
validate.sum.insured=select case when ISNULL (CONVERT (numeric (20, 2), CAST (UTILIZED_AMOUNT AS FLOAT)),0)+ISNULL(?,0) > ISNULL(CROSS_VOYAGE_TURNOVER,0) then 'false' else 'true' end STATUS from open_cover_master ocm,open_cover_position_master ocpm where ocm.proposal_no=ocpm.proposal_no and ocpm.open_cover_no=? and ocm.AMEND_ID=(select max(amend_id) from open_cover_master where proposal_no=ocm.proposal_no)
GET_POLICYEXCESS=SELECT SUBSTRing({0},(select dbo.INSTR({1},''~'',1,4))+1,LEN({2})) FROM COMMODITYMASTER A WHERE A.BRANCH_CODE=? AND A.COMMODITY_ID=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE=A.BRANCH_CODE AND COMMODITY_ID=A.COMMODITY_ID)
GET_TRUNC=select ISNULL(round(CONVERT(DECIMAL(10,2),?),CONVERT(INT,?)),0) 
GET_ROUND=select ISNULL(round(CONVERT(DECIMAL(10,2),?),CONVERT(INT,?)),0)
GET_GOVT_TAX=SELECT  ISNULL(GOVT_TAX, 0) GOVT_TAX FROM BROKER_MASTER WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
INSRT_MPD=INSERT INTO MARINE_POLICY_DETAILS(QUOTE_NO,CUSTOMER_ID,BL_AWB_NO,BL_AWB_DATE,SETTLING_AGENT_ID,CARRIER_NAME,LC_NUMBER,LC_DATE,BANK_NAME,PARTIAL_SHIPMENT_ALLOWED,SPECIAL_DISCOUNT,COMPANY_ID,AMEND_ID,ENTRY_DATE,INCEPTION_DATE,SETTLING_AGENT_NAME,STATUS,SAILING_DATE,PACKAGE_CODE,GHQ_CONTRACT_NO,GHQ_FMS_CASE_NO,GHQ_REFERENCE_NO, CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME) VALUES(?,?,?,CONVERT (DATE,''{0}'',103),?,?,?,CONVERT (DATE,''{1}'',103),?,?,NULLIF(?,0),?,?,SYSDATETIME(),SYSDATETIME(),?,''Y'',CONVERT (DATE,''{2}'',103),?,?,?,?,?,?,?)
UPDATE_MPD=UPDATE MARINE_POLICY_DETAILS SET CUSTOMER_ID=?,BL_AWB_NO=?,BL_AWB_DATE=CONVERT (DATE,''{0}'',103),SETTLING_AGENT_ID=?,CARRIER_NAME=?,LC_NUMBER=?,LC_DATE=CONVERT (DATE,''{1}'',103),BANK_NAME=?,PARTIAL_SHIPMENT_ALLOWED=?,SPECIAL_DISCOUNT=CONVERT(numeric(5,2), CAST(? AS FLOAT)),COMPANY_ID=?,SETTLING_AGENT_NAME=?,SAILING_DATE=CONVERT (DATE,''{2}'',103),PACKAGE_CODE=CONVERT(numeric(10,0), CAST(? AS FLOAT)),GHQ_CONTRACT_NO=?,GHQ_FMS_CASE_NO=?,GHQ_REFERENCE_NO=?,CONSIGNEE_DET=?,SPECIAL_TERM=?, ADD_CUST_NAME=? WHERE QUOTE_NO=? AND AMEND_ID=?
#REFERRAL VALIDATION
 UPDATE_UTILIZED_PREMIUM=update open_cover_master set DEPOSIT_UTILISED\=isnull(nullif(DEPOSIT_UTILISED,0),0) +convert(decimal(15,2),cast(? as float))  where  MISSIPPI_OPENCOVER_NO\=? 
referral.deposit=select isnull(nullif(DEPOSIT_AMOUNT,0),0) - isnull(nullif(DEPOSIT_UTILISED,0),0) from open_cover_master where  MISSIPPI_OPENCOVER_NO=? and  AMEND_ID=(select max(AMEND_ID) from open_cover_master where  MISSIPPI_OPENCOVER_NO=?) and Deposit_Premium_Yn='Y'
referral.coverage=SELECT REFERAL_STATUS FROM COVER_MASTER WHERE COVER_ID\=? AND BRANCH_CODE\=?
referral.vessel=SELECT STATUS FROM VESSEL_MASTER WHERE VESSEL_ID=?
referral.policyDate.diff=SELECT DATEDIFF(DAY,CONVERT(DATE,?,103),SYSDATETIME())
referral.policyDate.openCoverDiff= SELECT DATEDIFF(Day,CONVERT(DATE,?,103),convert(date,A.INCEPTION_DATE,103)) FROM OPEN_COVER_POSITION_MASTER A WHERE A.OPEN_COVER_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER WHERE A.OPEN_COVER_NO=OPEN_COVER_NO)
referral.country=SELECT status  FROM country_master  WHERE  (country_id=? and amend_id = (SELECT   MAX (amend_id) FROM   country_master WHERE   country_id = ?)) or (country_id=? AND amend_id = (SELECT   MAX (amend_id) FROM   country_master  WHERE   country_id = ?))
referral.crossVoyageSI=SELECT ISNULL(SUM(MRD.SUMINSUREDLOCAL),0) FROM MARINE_DATA MD,POSITION_MASTER PM,MARINE_RESULT_DETAILS MRD,OPEN_COVER_POSITION_MASTER OCPM WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND MRD.APPLICATION_NO=MD.APPLICATION_NO AND MD.OPEN_COVER_NO=PM.OPEN_COVER_NO AND PM.STATUS='P' AND MD.STATUS='Y' AND MD.TRANSIT_FROM_COUNTRY_ID NOT IN(?) AND MD.FINAL_DESTINATION_COUNTRY_ID NOT IN(?) AND MD.OPEN_COVER_NO=? AND OCPM.OPEN_COVER_NO=PM.OPEN_COVER_NO
referral.crossVoyage=SELECT STATUS FROM COUNTRY_MASTER_DETAIL A WHERE COUNTRY_ID IN(:id) AND BELONGING_COUNTRY_ID=? AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID=A.COUNTRY_ID AND BELONGING_COUNTRY_ID=A.BELONGING_COUNTRY_ID)
referral.land=SELECT COUNT(*) FROM CONSTANT_DETAIL WHERE CATEGORY_ID=8 AND BRANCH_CODE=? AND CATEGORY_DETAIL_ID=? AND STATUS='Y'
referral.policyDate.backDate=SELECT ISNULL(BACK_DATE_ALLOWED,0) FROM LOGIN_USER_DETAILS WHERE AGENCY_CODE IN(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND PRODUCT_ID=?
referral.master=SELECT A.REFERAL_ID,A.STATUS FROM REFERAL_MASTER A WHERE A.BRANCH_CODE=? AND A.EFFECTIVE_START_DATE<SYSDATETIME()  AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM REFERAL_MASTER WHERE BRANCH_CODE=A.BRANCH_CODE AND EFFECTIVE_START_DATE< SYSDATETIME())  ORDER BY REFERAL_ID
referral.suminsured=SELECT nullif(INSURANCE_END_LIMIT,0) SUM_INSURED_LIMIT,nullif(MIN_PREMIUM_AMOUNT,0) MIN_PREMIUM FROM LOGIN_USER_DETAILS  WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND PRODUCT_ID=?
referral.OCsuminsured=SELECT  (OCD.SUM_INSURED_LIMIT*OCD.EXCHANGE_RATE) SUM_INSURED_LIMIT,OCD.MODE_TRANSPORT_ID,OCD.EXCHANGE_ID,OCD.CURRENCY_ID,OCD.EXCHANGE_RATE,OCD.CURRENCY_NAME,OCD.AMEND_ID FROM OPEN_COVER_DETAIL OCD,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO =? AND OCPM.PROPOSAL_NO=OCD.PROPOSAL_NO AND OCD.AMEND_ID IN (SELECT MAX(OCDS.AMEND_ID) FROM OPEN_COVER_DETAIL OCDS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO =OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCDS.PROPOSAL_NO AND convert(date,OCDS.EFFECTIVE_DATE,103) <= convert(date,SYSDATETIME(),103)) AND OCD.MODE_TRANSPORT_ID=?
referral.LCsuminsured=SELECT ISNULL(SUM(MRD.SUMINSUREDLOCAL+MD.TOTAL_SALE_TERM_CHARGES+MD.TOTAL_TOLERANCE_CHARGES),0) SUM_INSURED_LIMIT FROM MARINE_DATA MD,MARINE_RESULT_DETAILS MRD,POSITION_MASTER PM WHERE MD.APPLICATION_NO=PM.APPLICATION_NO AND MD.APPLICATION_NO=MRD.APPLICATION_NO AND MD.OPEN_COVER_NO=PM.OPEN_COVER_NO AND PM.STATUS='P' AND MD.STATUS='Y' AND MD.OPEN_LC_ID=? AND MD.OPEN_BANK_ID=? AND MD.OPEN_COVER_NO=?
referral.basisVal=SELECT A.SALE_TERM_VALUE,B.TOLERANCE_VALUE FROM SALE_TERM_MASTER A, TOLERANCE_MASTER B WHERE A.SALE_TERM_ID=? AND A.BRANCH_CODE=? AND B.TOLERANCE_ID=? AND B.BRANCH_CODE=A.BRANCH_CODE
referral.countryStartPlace=SELECT STARTING_PLACE FROM COUNTRY_MASTER_DETAIL A WHERE A.COUNTRY_ID=? AND A.BELONGING_COUNTRY_ID=? AND A.AMEND_ID=(SELECT MAX(B.AMEND_ID) FROM COUNTRY_MASTER_DETAIL B WHERE B.COUNTRY_ID=A.COUNTRY_ID AND A.BELONGING_COUNTRY_ID=A.BELONGING_COUNTRY_ID)
referral.countryEndPlace=SELECT ENDING_PLACE FROM COUNTRY_MASTER_DETAIL A WHERE A.COUNTRY_ID=? AND A.BELONGING_COUNTRY_ID=? AND A.AMEND_ID=(SELECT MAX(B.AMEND_ID) FROM COUNTRY_MASTER_DETAIL B WHERE B.COUNTRY_ID=A.COUNTRY_ID AND A.BELONGING_COUNTRY_ID=A.BELONGING_COUNTRY_ID)
marine.lc.master=SELECT BM.BANK_NAME,OPLM.LC_NUMBER,(OPLM.LC_AMOUNT*EM.EXCHANGE_RATE) LC_AMOUNT,OPLM.LC_DATE,CM.CURRENCY_NAME,OPLM.LC_CURRENCY_ID,EM.EXCHANGE_RATE,BM.BANK_ID FROM OPEN_COVER_LC_MASTER OPLM,OPEN_COVER_BANK_MASTER BM,CURRENCY_MASTER CM,EXCHANGE_MASTER EM WHERE OPLM.STATUS='Y' AND LC_ID=? AND OPLM.BANK_ID=? AND OPLM.BANK_ID=BM.BANK_ID AND CM.CURRENCY_ID=ISNULL(OPLM.LC_CURRENCY_ID,'0') AND OPEN_COVER_NO=? AND CM.AMEND_ID+ ' ' +'-'+ ' ' +CM.CURRENCY_ID IN (SELECT MAX(CMS.AMEND_ID)+ ' ' +'-'+ ' ' +CMS.CURRENCY_ID FROM CURRENCY_MASTER CMS WHERE convert(date,CMS.EFFECTIVE_DATE,103) <= convert(date,SYSDATETIME(),103) GROUP BY CMS.CURRENCY_ID ) AND BM.AMEND_ID+ ' ' +'-'+ ' ' +BM.BANK_ID IN (SELECT MAX(OCBMS.AMEND_ID)+ ' ' +'-'+ ' ' +OCBMS.BANK_ID FROM OPEN_COVER_BANK_MASTER OCBMS WHERE convert(date,OCBMS.EFFECTIVE_DATE,103) <=convert(date,SYSDATETIME(),103) GROUP BY OCBMS.BANK_ID) AND EM.AMEND_ID+ ' ' +'-'+ ' ' +EM.CURRENCY_ID IN (SELECT MAX(EMS.AMEND_ID)+ ' ' +'-'+ ' ' +EMS.CURRENCY_ID FROM EXCHANGE_MASTER EMS WHERE convert(date,EMS.EFFECTIVE_DATE,103) <= convert(date,SYSDATETIME(),103) GROUP BY EMS.CURRENCY_ID ) AND EM.CURRENCY_ID=OPLM.LC_CURRENCY_ID ORDER BY OPLM.LC_ID
marine.oc.master=SELECT OCM.BROKER_ID,OCM.BROKER_USER_ID,OCM.POLICY_START_DATE,OCM.POLICY_END_DATE,OCM.PRODUCT_ID,OCM.CUSTOMER_ID,OCM.BRANCH_CODE,OCM.CROSS_VOYAGE_TURNOVER,OCM.CROSS_VOYAGE_SUMINSURED_LIMIT,OCM.BACK_DATE_DAYS,OCM.COMMISSION,OCM.NO_OF_INSURANCE_COMPANY,OCM.CROSS_VOYAGE_PERCENTAGE,OCM.RSA_SHARED_PERCENTAGE,OCM.CROSS_VOYAGE,OCM.IMPORT_MIN_PREMIUM_AMOUNT, OCM.CROSS_MIN_PREMIUM_AMOUNT,OCM.EXPORT_MIN_PREMIUM_AMOUNT,OCM.FREE_TEXT_ALLOWED,OCM.AMEND_ID,OCM.BUSINESS_TYPE,OCM.MISSIPPI_OPENCOVER_NO FROM OPEN_COVER_MASTER OCM,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO =? AND OCPM.PROPOSAL_NO=OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX(OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO =OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCMS.PROPOSAL_NO AND convert(date,OCMS.EFFECTIVE_DATE,103) <= convert(date,SYSDATETIME(),103))
marine.commodity=SELECT MRD.APPLICATION_NO,MRD.COMMODITY_ID,MRD.SUM_INSURED,MRD.DESCRIPTION,MRD.FRAGILE,MRD.COMMODITY_TYPE_ID,MRD.COMMODITY_EXCESS_PREMIUM FROM MARINE_RESULT_DETAILS MRD WHERE MRD.APPLICATION_NO=? AND  STATUS='Y' AND MRD.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO=MRD.APPLICATION_NO AND STATUS=MRD.STATUS) ORDER by sno
marine.commodity.OCrate=SELECT ISNULL(OCCD.COMMODITY_BASE_RATE,0) FROM OPEN_COVER_COMMODITY_DETAIL OCCD,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO=? AND OCCD.PROPOSAL_NO=OCPM.PROPOSAL_NO AND OCCD.AMEND_ID IN (SELECT MAX(OCCDS.AMEND_ID) FROM OPEN_COVER_COMMODITY_DETAIL OCCDS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO=OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCCDS.PROPOSAL_NO AND convert(date,OCCDS.EFFECTIVE_DATE,103) <= convert(date,SYSDATETIME(),103)) AND OCCD.COMMODITY_ID=? AND OCCD.COVER_ID=? And (ISNULL(OCCD.COVER_TYPE_ID,0) = CASE WHEN ISNULL(OCCD.COVER_TYPE_ID,0)=0 then 0 else ? end)
marine.loadValue.WTH=SELECT ISNULL(LOAD_VALUE,'0') FROM REFERAL_MASTER WHERE REFERAL_ID='17' AND BRANCH_CODE=?
marine.loadValue.LCL=SELECT ISNULL(LOAD_VALUE,'0') FROM REFERAL_MASTER WHERE REFERAL_ID='16' AND BRANCH_CODE=?
round=SELECT ROUND(?,0) FROM CURRENCY_MASTER A WHERE CURRENCY_ID\=? AND COUNTRY_ID\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=A.CURRENCY_ID AND COUNTRY_ID\=A.COUNTRY_ID)
marine.appNo.max=SELECT NEXT VALUE FOR APLLICATION_NO_SEQ
marine.update.premium.rate=UPDATE MARINE_RESULT_DETAILS SET RATE=?,PREMIUM=CONVERT(numeric(16,2), CAST(? AS FLOAT)),CURRENCY_ID=?,EXCHANGE_ID=?,CURRENCY_NAME=?,EXCHANGE_RATE=?,SALE_TERM_CHARGES=CONVERT(numeric(16,2), CAST(? AS FLOAT)),WAR_CHARGES=CONVERT(numeric(16,2), CAST(? AS FLOAT)),REFERRAL=?,WARRATE=?,SUMINSUREDLOCAL=CONVERT(numeric(16,0), CAST(? AS FLOAT)),SEA_OPTION_LCL=?,WAREHOUSE_WAREHOUSE=?,TOLERANCE_CHARGES=?,AGREED_STATUS=?,COMMODITY_EXCESS_PREMIUM=? ,POLICY_EXCESS_PERCENT=CONVERT(numeric(16,2), CAST(? AS FLOAT)) WHERE  APPLICATION_NO=? AND COMMODITY_ID=? AND STATUS=?
marine.data.count=SELECT COUNT(*) FROM MARINE_DATA WHERE APPLICATION_NO\=? 
#AND AMEND_ID=?
marine.currency.info=SELECT EM.EXCHANGE_ID, EM.EXCHANGE_RATE, EM.CURRENCY_ID, CM.CURRENCY_NAME FROM EXCHANGE_MASTER EM, CURRENCY_MASTER CM WHERE EM.CURRENCY_ID = ? AND EM.CURRENCY_ID = CM.CURRENCY_ID AND EM.STATUS = 'Y' AND CM.STATUS = 'Y' AND EM.COUNTRY_ID = ? AND EM.COUNTRY_ID=CM.COUNTRY_ID AND EM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM EXCHANGE_MASTER WHERE CURRENCY_ID = EM.CURRENCY_ID AND STATUS = 'Y' AND COUNTRY_ID = EM.COUNTRY_ID AND  EFFECTIVE_DATE <=  SYSDATETIME()) AND CM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID AND STATUS = 'Y' AND COUNTRY_ID = CM.COUNTRY_ID AND  (EFFECTIVE_DATE) <=  (SYSDATETIME()))
marine.executive.name=SELECT AC_EXECUTIVE_NAME FROM LOGIN_EXECUTIVE_DETAILS WHERE AC_EXECUTIVE_ID\=? AND STATUS\='Y'
##marine.data.insert=INSERT INTO MARINE_DATA (APPLICATION_NO,MODE_OF_TRANSPORT,WAREHOUSE_TO_WAREHOUSE,TRANSIT_FROM,FINAL_DESTINATION, NO_OF_ITEMS,TOTAL_SUM_INSURED,CURRENCY_ID,EXCHANGE_ID,CURRENCY_NAME,EXCHANGE_RATE,SALE_TERM_ID,COVER_ID,EXTRA_COVER_ID,AC_EXECUTIVE_ID,AC_EXECUTIVE_NAME,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,REMARKS,STATUS,EQUIVALENT_USD,COMPANY_ID,PREMIUM,TRANSIT_FROM_CITY_ID,TRANSIT_FROM_COUNTRY_ID,FINAL_DESTINATION_CITY_ID,FINAL_DESTINATION_COUNTRY_ID,REFERRAL,TOTAL_SALE_TERM_CHARGES,TOTAL_WAR_CHARGES,SEA_OPTIONS,WARE_TO_WARE_FINAL_DEST,PRODUCT_ID,OPEN_COVER_NO,OPEN_BANK_ID,OPEN_LC_ID,OPEN_VESSEL_NAME,OPEN_VESSEL_OPTION,TOLERANCE_ID,TOTAL_TOLERANCE_CHARGES,PARTIAL_SHIPPING,PARTIAL_SUM_INSURED_AMOUNT,EXPOSURE_CURRENCY,OC_VESSEL_ID,POLICY_FEE, GOVT_TAX, EMERGENCY_FUND,EXCESS_PREMIUM,ADMIN_REFERRAL_STATUS,CHANNEL_TYPE,UWGRADE,VIA) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,convert(datetime,?,103),SYSDATETIME(),SYSDATETIME(),SYSDATETIME(),?,?,CAST(? As Decimal),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,NULLIF(?,0),?,?,?,?,?,?,?,?,?,?)
marine.data.insert=INSERT INTO MARINE_DATA (APPLICATION_NO,MODE_OF_TRANSPORT,WAREHOUSE_TO_WAREHOUSE,TRANSIT_FROM,FINAL_DESTINATION,NO_OF_ITEMS,TOTAL_SUM_INSURED,CURRENCY_ID,EXCHANGE_ID,CURRENCY_NAME,EXCHANGE_RATE,SALE_TERM_ID,COVER_ID,EXTRA_COVER_ID,AC_EXECUTIVE_ID,AC_EXECUTIVE_NAME,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,REMARKS,STATUS,EQUIVALENT_USD,COMPANY_ID,PREMIUM,TRANSIT_FROM_CITY_ID,TRANSIT_FROM_COUNTRY_ID,FINAL_DESTINATION_CITY_ID,FINAL_DESTINATION_COUNTRY_ID,REFERRAL,TOTAL_SALE_TERM_CHARGES,TOTAL_WAR_CHARGES,SEA_OPTIONS,WARE_TO_WARE_FINAL_DEST,PRODUCT_ID,OPEN_COVER_NO,OPEN_BANK_ID,OPEN_LC_ID,OPEN_VESSEL_NAME,OPEN_VESSEL_OPTION,TOLERANCE_ID,TOTAL_TOLERANCE_CHARGES,PARTIAL_SHIPPING,PARTIAL_SUM_INSURED_AMOUNT,EXPOSURE_CURRENCY,OC_VESSEL_ID,POLICY_FEE,GOVT_TAX, EMERGENCY_FUND,EXCESS_PREMIUM,ADMIN_REFERRAL_STATUS,CHANNEL_TYPE,UWGRADE,VIA) VALUES (?,?,?,?,?,?, CONVERT(numeric(20,3), CAST(? AS FLOAT)) ,?,?,?,CONVERT(numeric(20,6), CAST(? AS FLOAT)) ,?,?,?,?,?,?,CONVERT(DATETIME,?,103),SYSDATETIME(),SYSDATETIME(),SYSDATETIME(),?,?,CONVERT(decimal(20,2), CAST(? AS FLOAT)) ,?, CONVERT(numeric(20,6), CAST(? AS FLOAT)) ,?,? ,?,?,?, CONVERT(numeric(20,6), CAST(? AS FLOAT)) , CONVERT(numeric(20,6), CAST(? AS FLOAT)),?,?,?,?,?,?,?,?,?, CONVERT(numeric(20,6), CAST(? AS FLOAT)) ,?, CONVERT(numeric(20,6), CAST(? AS FLOAT)),NULLIF(?,0),?, CONVERT(numeric(20,6), CAST(? AS FLOAT)), CONVERT(numeric(20,6), CAST(? AS FLOAT)), CONVERT(numeric(20,6), CAST(? AS FLOAT)),CONVERT(numeric(20,6), CAST(? AS FLOAT)),?,?,?,?)
marine.data.update=UPDATE MARINE_DATA SET MODE_OF_TRANSPORT=?,WAREHOUSE_TO_WAREHOUSE=?,TRANSIT_FROM=?,FINAL_DESTINATION=?,NO_OF_ITEMS=?,TOTAL_SUM_INSURED=CONVERT(numeric(16,2), CAST(? AS FLOAT)),CURRENCY_ID=?,EXCHANGE_ID=?,CURRENCY_NAME=?,EXCHANGE_RATE=CONVERT(numeric(16,4), CAST(? AS FLOAT)),SALE_TERM_ID=?,COVER_ID=?,EXTRA_COVER_ID=?,AC_EXECUTIVE_ID=?,AC_EXECUTIVE_NAME=?,INCEPTION_DATE=convert(datetime,?,105),EXPIRY_DATE=SYSDATETIME(),EFFECTIVE_DATE=SYSDATETIME(),ENTRY_DATE=SYSDATETIME(),EQUIVALENT_USD=CONVERT(numeric(16,2), CAST(? AS FLOAT)),COMPANY_ID=?,PREMIUM=CONVERT(numeric(20,2), CAST(? AS FLOAT)),TRANSIT_FROM_CITY_ID=?,TRANSIT_FROM_COUNTRY_ID=?,FINAL_DESTINATION_CITY_ID=?,FINAL_DESTINATION_COUNTRY_ID=?,REFERRAL=?,TOTAL_SALE_TERM_CHARGES=CONVERT(numeric(20,2), CAST(? AS FLOAT)),TOTAL_WAR_CHARGES=CONVERT(numeric(20,2), CAST(? AS FLOAT)),SEA_OPTIONS=?,WARE_TO_WARE_FINAL_DEST=?,PRODUCT_ID=?,OPEN_COVER_NO=?,OPEN_BANK_ID=?,OPEN_LC_ID=?,OPEN_VESSEL_NAME=?,OPEN_VESSEL_OPTION=?,TOLERANCE_ID=?,TOTAL_TOLERANCE_CHARGES= CONVERT(numeric(20,2), CAST(? AS FLOAT)),PARTIAL_SHIPPING=?,PARTIAL_SUM_INSURED_AMOUNT=CONVERT(numeric(16,2), CAST(? AS FLOAT)),EXPOSURE_CURRENCY=?,OC_VESSEL_ID=?,DEC_EXCESS_PREMIUM=CONVERT(numeric(20,2), CAST('' AS FLOAT)),REMARKS=?,POLICY_FEE= CONVERT(numeric(20,2), CAST(? AS FLOAT)), GOVT_TAX= CONVERT(numeric(20,2), CAST(? AS FLOAT)), EMERGENCY_FUND= CONVERT(numeric(20,2), CAST(? AS FLOAT)),EXCESS_PREMIUM=CONVERT(numeric(20,2), CAST(? AS FLOAT)),ADMIN_REFERRAL_STATUS=?,CHANNEL_TYPE=?,UWGRADE=?,VIA=? WHERE APPLICATION_NO=? AND STATUS=? AND AMEND_ID=?
marine.update.linked.Status=UPDATE POSITION_MASTER  SET OPEN_COVER_INT_STATUS\='' WHERE APPLICATION_NO\=?
marine.tracking.count=SELECT COUNT(*) FROM TRACKING_MASTER WHERE APPLICATION_NO=? AND LOGIN_ID=? AND SESSION_ID=? AND STATUS='Y'
marine.tracking.insert=INSERT INTO TRACKING_MASTER (SERIAL_NO,SESSION_ID,LOGIN_ID,STAGE_ID,APPLICATION_NO,PRODUCT_ID,REMARKS,STATUS,START_TIME) VALUES((SELECT ISNULL(MAX(SERIAL_NO),'0')+1 FROM TRACKING_MASTER),?,?,?,?,?,?,?,SYSDATETIME())
marine.tracking.update=UPDATE TRACKING_MASTER SET STAGE_ID\=?,END_TIME\=SYSDATETIME() WHERE APPLICATION_NO\=? AND STATUS\=? AND SESSION_ID\=? AND LOGIN_ID\=?
marine.customer.count=SELECT COUNT(*) FROM PERSONAL_INFO WHERE CUSTOMER_ID=?
marine.customer.insert=INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,AMEND_ID,MOBILE,EMAIL,ADDRESS1,ADDRESS2,POBOX,EMIRATE,STATUS,ENTRY_DATE,LOGIN_ID,MISSIPPI_CUSTOMER_CODE,CLIENT_CUSTOMER_ID,CUST_AR_NO,CUST_NAME,VAT_REG_NO,CUST_NAME_ARABIC) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATETIME(),?,?,?,?,?,?,?)
marine.customer.update=UPDATE PERSONAL_INFO SET APPLICATION_ID=?,TITLE=?,FIRST_NAME=?,LAST_NAME=?,MOBILE=?,EMAIL=?,ADDRESS1=?,ADDRESS2=?,POBOX=?,EMIRATE=?,STATUS=?,MISSIPPI_CUSTOMER_CODE=?,CLIENT_CUSTOMER_ID=?,CUST_AR_NO=?,CUST_NAME=? ,VAT_REG_NO=? ,CUST_NAME_ARABIC=? WHERE CUSTOMER_ID=?
#marine.policy.fee=SELECT PERCENTRATE POLICY_FEE_DEFAULT,'0' POLICY_FEE_PERCENT FROM CONSTANT_DETAIL  WHERE CATEGORY_DETAIL_ID=1 AND BRANCH_CODE=? AND CATEGORY_ID=131 AND STATUS='Y'
marine.policy.fee=select ISNULL(POLICY_FEE,0) POLICY_FEE_DEFAULT,'0' POLICY_FEE_PERCENT,ISNULL(ENDORSEMENTFEE,0) ENDORSEMENTFEE from broker_master where AGENCY_CODE=(select OA_CODE from LOGIN_MASTER where AGENCY_CODE=?)AND AMEND_ID=(select max(AMEND_ID) from broker_master bk where  bk.AGENCY_CODE=?)
marine.policy.fee.oc=SELECT A.MIN_PREMIUM_ISSUANCE_FEE POLICY_FEE_DEFAULT,A.ISSUANCE_FEE POLICY_FEE_PERCENT,A.ENDORSEMENTFEE ENDORSEMENTFEE FROM OPEN_COVER_MASTER A  WHERE A.MISSIPPI_OPENCOVER_NO=? AND A.BRANCH_CODE=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO=A.MISSIPPI_OPENCOVER_NO)
marine.fee.broker=SELECT (CASE WHEN (POLICY_FEE_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'BROKER')) THEN ISNULL(POLICY_FEE,'0') ELSE 0 END) POLICY_FEE,(CASE WHEN (GOVT_TAX_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'BROKER')) THEN ISNULL(GOVT_TAX,'0') ELSE 0 END)GOVT_TAX,(CASE WHEN (EMERGENCY_FUND_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH'  OR UPPER(TAX_APPLICABLE) = 'BROKER')) THEN ISNULL(EMERGENCY_FUND,'0') ELSE 0 END)EMERGENCY_FUND,POLICY_FEE_STATUS FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND convert(date,EFFECTIVE_DATE,103) <=convert(date,SYSDATETIME(),103) AND AMEND_ID+ ' ' +AGENCY_CODE IN(SELECT MAX(AMEND_ID)+ ' ' +AGENCY_CODE FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND convert(date,EFFECTIVE_DATE,103) <=convert(date,SYSDATETIME(),103) GROUP BY AGENCY_CODE)
marine.fee.issuer=SELECT (CASE WHEN (POLICY_FEE_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'ADNICUSER')) THEN ISNULL(POLICY_FEE,'0') ELSE 0 END) POLICY_FEE,(CASE WHEN (GOVT_TAX_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH' OR UPPER(TAX_APPLICABLE) = 'ADNICUSER')) THEN ISNULL(GOVT_TAX,'0') ELSE 0 END)GOVT_TAX,(CASE WHEN (EMERGENCY_FUND_STATUS='Y' AND (UPPER(TAX_APPLICABLE) = 'BOTH'  OR UPPER(TAX_APPLICABLE) = 'ADNICUSER')) THEN ISNULL(EMERGENCY_FUND,'0') ELSE 0 END)EMERGENCY_FUND,POLICY_FEE_STATUS FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND convert(date,EFFECTIVE_DATE,103) <=convert(date,SYSDATETIME(),103) AND AMEND_ID+ ' ' +AGENCY_CODE IN(SELECT MAX(AMEND_ID)+ ' ' +AGENCY_CODE FROM BROKER_MASTER WHERE BRANCH_CODE=? AND AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND convert(date,EFFECTIVE_DATE,103) <=convert(date,SYSDATETIME(),103) GROUP BY AGENCY_CODE)
marine.quote.count=SELECT COUNT(1) FROM POSITION_MASTER WHERE QUOTE_NO=? AND AMEND_ID=?
marine.quoteNo.max=SELECT NEXT VALUE FOR ONEOFF_QUOTE
marine.quoteNo.max.oc=SELECT NEXT VALUE FOR OPENCOVER_QUOTE
marine.quote.insert=INSERT INTO POSITION_MASTER (PRODUCT_ID,LOGIN_ID,COMPANY_ID,APPLICATION_NO,AMEND_ID,QUOTE_NO,CUSTOMER_ID,APPLICATION_ID,STATUS,ENTRY_DATE,EFFECTIVE_DATE,EXCESS_PREMIUM,BUSINESS_TYPE,OPEN_COVER_NO,MISSIPPI_OPENCOVER_NO,REMARKS,PREMIUM) VALUES(?,?,?,?,?,?,?,?,?,SYSDATETIME(),dateadd(mm,1,DATEDIFF(day,-1,(convert(date,SYSDATETIME(),103)))),NULLIF(convert(decimal,?),0),NULLIF(?,0),?,?,?,NULLIF(convert(decimal,?),0))
marine.quote.update=UPDATE POSITION_MASTER SET CUSTOMER_ID\=?,EXCESS_PREMIUM\=nullif(CONVERT(numeric(16,0), CAST(? AS FLOAT)),0),REMARKS\=?,PREMIUM\=nullif(CONVERT(numeric(16,0), CAST(? AS FLOAT)),0),APPLICATION_ID\=?,OPEN_COVER_NO\=? WHERE APPLICATION_NO\=? AND QUOTE_NO\=? AND AMEND_ID\=?
GET_WAR_OPTION = SELECT EXTRA_COVER_ID FROM MARINE_DATA MD WHERE APPLICATION_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO=MD.APPLICATION_NO)
GET_POLICFEEYN=select POLICY_FEE,POLICYFEEYN from MARINE_DATA where APPLICATION_NO=?
CLOSETRN_BLOCK=SELECT  (CASE WHEN CONVERT(varchar,CLO_DATE_CLOSED,103)  >=  CONVERT(varchar,getdate(),103)  THEN  CONVERT(varchar ,sysdatetime(),120) ELSE   CONVERT(varchar,CLO_MONTHEND_DT,120) END)  FROM T_TRN_CLOSING WHERE BRANCH_CODE = ?
GET_SYSDATECL=SELECT TO_CHAR(SYSDATE,'DD-MM-YYYY HH24:MI:SS') FROM DUAL
GET_DUBAI_TRADE=SELECT (case REMARKS when NULL then 'N' else 'Y' end ) DUBAI_TRADE_STATUS FROM CONSTANT_DETAIL WHERE REMARKS =(SELECT DISTINCT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)  AND CATEGORY_ID=149 AND BRANCH_CODE=? AND STATUS='Y'
GET_PROMOTION=SELECT nullif(DISCOUNT_RATE,0) FROM PROMOTIONAL_RATE_MASTER PRM WHERE PROMOTIONAL_CODE=? AND BRANCH_CODE=? AND  STATUS='Y' AND convert(date,getdate(),103) BETWEEN convert(date,START_DATE,103) AND convert(date,END_DATE,103)  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PROMOTIONAL_RATE_MASTER PRMM WHERE PRMM.PROMOTIONAL_CODE=PRM.PROMOTIONAL_CODE AND PRMM.BRANCH_CODE=PRM.BRANCH_CODE  AND STATUS = 'Y' AND convert(date,getdate(),103) BETWEEN convert(date,START_DATE,103) AND convert(date,END_DATE,103))
UPD_PD_CODE=UPDATE  POSITION_MASTER SET PROMOTIONAL_CODE=?, PROMOTIONAL_DISCOUNT=? WHERE APPLICATION_NO=?
UPD_WSB_CODE=UPDATE WEBSERVICE_MARINE_QUOTE SET PROMOTIONAL_DISCOUNT=? WHERE APPLICATION_NO=?
GET_ENDT_CODE=select distinct(ENDT_TYPE_CATEGORY_ID) from endt_type_master where ENDT_TYPE_ID in ({0})
GET_BLONG_BRANCH=SELECT BELONGING_BRANCH FROM BRANCH_MASTER WHERE BRANCH_CODE=?
get_pd_ENDTYPE=select ENDT_TYPE from position_master where application_no=?
broker.agencyCode=select AGENCY_CODE FROM BROKER_MASTER WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
#COMMODITY INSERT/UPDATE
CAL_PROC_COMM={CALL MARINE_COMMODITY_INSERT(?,?,?)}

#MASTER INFO
GET_LC_MASTER_INFO=SELECT BM.BANK_NAME,OPLM.LC_NUMBER,(OPLM.LC_AMOUNT*EM.EXCHANGE_RATE) LC_AMOUNT,OPLM.LC_DATE,CM.CURRENCY_NAME,OPLM.LC_CURRENCY_ID,EM.EXCHANGE_RATE,BM.BANK_ID FROM OPEN_COVER_LC_MASTER OPLM,OPEN_COVER_BANK_MASTER BM,CURRENCY_MASTER CM,EXCHANGE_MASTER EM WHERE OPLM.STATUS='Y' AND LC_ID=? AND OPLM.BANK_ID=? AND OPLM.BANK_ID=BM.BANK_ID AND CM.CURRENCY_ID=ISNULL(OPLM.LC_CURRENCY_ID,'0') AND OPEN_COVER_NO=? AND CM.AMEND_ID+ ' ' +'-'+ ' ' +CM.CURRENCY_ID IN (SELECT MAX(CMS.AMEND_ID)+ ' ' +'-'+ ' ' +CMS.CURRENCY_ID FROM CURRENCY_MASTER CMS WHERE convert(date,CMS.EFFECTIVE_DATE,103) <= convert(date,SYSDATETIME(),103) GROUP BY CMS.CURRENCY_ID ) AND BM.AMEND_ID+ ' ' +'-'+ ' ' +BM.BANK_ID IN (SELECT MAX(OCBMS.AMEND_ID)+ ' ' +'-'+ ' ' +OCBMS.BANK_ID FROM OPEN_COVER_BANK_MASTER OCBMS WHERE convert(date,OCBMS.EFFECTIVE_DATE,103) <=convert(date,SYSDATETIME(),103) GROUP BY OCBMS.BANK_ID) AND EM.AMEND_ID+ ' ' +'-'+ ' ' +EM.CURRENCY_ID IN (SELECT MAX(EMS.AMEND_ID)+ ' ' +'-'+ ' ' +EMS.CURRENCY_ID FROM EXCHANGE_MASTER EMS WHERE convert(varchar(10),EMS.EFFECTIVE_DATE,103) <= convert(varchar(10),SYSDATETIME(),103) GROUP BY EMS.CURRENCY_ID ) AND EM.CURRENCY_ID=OPLM.LC_CURRENCY_ID ORDER BY OPLM.LC_ID
GET_PREM_LOAD_DISC=SELECT LUD.PRODUCT_ID,ISNULL(LUD.COMMISSION,0)COMMISSION,ISNULL(LUD.LOADING_OF_PREMIUM,0)LOADING_OF_PREMIUM,ISNULL(LUD.DISCOUNT_OF_PREMIUM,0)DISCOUNT_OF_PREMIUM,ISNULL(LUD.MIN_PREMIUM_AMOUNT,0)MIN_PREMIUM_AMOUNT FROM LOGIN_MASTER LM,LOGIN_USER_DETAILS LUD WHERE LM.AGENCY_CODE=LUD.AGENCY_CODE AND LUD.LOGIN_ID=LM.LOGIN_ID AND LUD.AGENCY_CODE =(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND LUD.PRODUCT_ID='3'
GET_CONDITIONS=select CODE,CODEDESC,CODESTATUS FROM SCHEDULE_CLAUSES(?,?,?,?) WHERE CODEDESC IS NOT NULL 
GET_CONSTANT=SELECT CATEGORY_DETAIL_ID, DETAIL_NAME, REMARKS FROM CONSTANT_DETAIL WHERE BRANCH_CODE=? AND CATEGORY_ID=? AND STATUS='Y'

#CUSTOMER
GET_CUST_ID_MAX=SELECT CUSTOMER_NUMBER_SEQ.NEXTVAL FROM DUAL
GET_CUST_SEQ = select CUST_SEQ_CREATION(?,?) FROM DUAL

#MARINE_POLICY_DETAILS
CNT_MARINE_POLICY=SELECT COUNT(*) FROM MARINE_POLICY_DETAILS WHERE QUOTE_NO=? AND AMEND_ID=?
INS_MARINE_POLICY=INSERT INTO MARINE_POLICY_DETAILS(QUOTE_NO,CUSTOMER_ID,BL_AWB_NO,BL_AWB_DATE,SETTLING_AGENT_ID,CARRIER_NAME,LC_NUMBER,LC_DATE,BANK_NAME,PARTIAL_SHIPMENT_ALLOWED,SPECIAL_DISCOUNT,COMPANY_ID,AMEND_ID,ENTRY_DATE,INCEPTION_DATE,SETTLING_AGENT_NAME,STATUS,SAILING_DATE,PACKAGE_CODE,GHQ_CONTRACT_NO,GHQ_FMS_CASE_NO,GHQ_REFERENCE_NO)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATETIME(),SYSDATETIME(),?,'Y',CONVERT(DATE,?,103),?,?,?,?)
UPD_MARINE_POLICY=UPDATE MARINE_POLICY_DETAILS SET CUSTOMER_ID=?,BL_AWB_NO=?,BL_AWB_DATE=?,SETTLING_AGENT_ID=?,CARRIER_NAME=?,LC_NUMBER=?,LC_DATE=?,BANK_NAME=?,PARTIAL_SHIPMENT_ALLOWED=?,SPECIAL_DISCOUNT=CONVERT(numeric(5,2), CAST(? AS FLOAT)),COMPANY_ID=?,SETTLING_AGENT_NAME=?,SAILING_DATE=?,PACKAGE_CODE=CONVERT(numeric(10,0), CAST(? AS FLOAT)),GHQ_CONTRACT_NO=?,GHQ_FMS_CASE_NO=?,GHQ_REFERENCE_NO=? WHERE QUOTE_NO=? AND AMEND_ID=?
CNT_MARINE_RESULT=SELECT COUNT(*) FROM MARINE_RESULT WHERE QUOTE_NO=? AND APPLICATION_NO=? AND AMEND_ID=?
INS_MARINE_RESULT=INSERT INTO MARINE_RESULT(APPLICATION_NO,QUOTE_NO,COMPANY_ID,AMEND_ID,CUSTOMER_ID,TOTAL_SUM_INSURED,PREMIUM,INSURANCE_FEE,NET_PREMIUM,SPECIAL_DISCOUNT,AMOUNT_PAYABLE,ENTRY_DATE) VALUES(?,?,?,?,?,CONVERT(numeric(16,0), CAST(? AS FLOAT)),NULLIF(convert(decimal,?),0),NULLIF(convert(decimal,?),0),NULLIF(?,0),NULLIF(?,0),NULLIF(?,0),SYSDATETIME())
UPD_MARINE_RESULT=UPDATE MARINE_RESULT SET TOTAL_SUM_INSURED=NULLIF (CONVERT (decimal (15, 5),  CAST(? AS FLOAT)), 0),PREMIUM=NULLIF (CONVERT (decimal (15, 5),  CAST(? AS FLOAT)), 0),INSURANCE_FEE=NULLIF (CONVERT (decimal (15, 5),  CAST(? AS FLOAT)), 0.00),NET_PREMIUM=NULLIF (CONVERT (decimal (15, 5),  CAST(? AS FLOAT)), 0),SPECIAL_DISCOUNT=NULLIF (CONVERT (decimal (15, 5),  CAST(? AS FLOAT)), 0),AMOUNT_PAYABLE=NULLIF (CONVERT (decimal (15, 5),  CAST(? AS FLOAT)), 0),CUSTOMER_ID=? WHERE QUOTE_NO=? AND APPLICATION_NO=? AND AMEND_ID=?

#RATE CALCULATION
rate.coveragevalue=SELECT COVERAGE_REFERAL FROM COMMODITYMASTER  WHERE COMMODITY_ID = ? AND BRANCH_CODE = ? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE =? AND COMMODITY_ID=?)
rate.coverreferral=SELECT COUNT(COMMODITY_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID = ? AND {0} IN ({1}) AND BRANCH_CODE = ?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE = ? AND COMMODITY_ID=?)
rate.commodityreferral=SELECT STATUS FROM COMMODITYMASTER WHERE  COMMODITY_ID = ? AND BRANCH_CODE = ? AND AMEND_ID= (SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE = ? AND COMMODITY_ID=?)
rate.coveragereferral=SELECT COUNT(*) FROM COMMODITYMASTER WHERE  COMMODITY_ID = ? AND COVERAGE_REFERAL IN(?) AND BRANCH_CODE = ? AND AMEND_ID= (SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE = ? AND COMMODITY_ID=?)
rate.basevalue=SELECT COVER_RATE FROM COVER_MASTER WHERE COVER_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT max(amend_id) from COVER_MASTER where cover_id=? AND BRANCH_CODE=? AND EFFECTIVE_DATE <= CONVERT(DATE,?,103)) AND STATUS='Y'
rate.fact1value=SELECT RATE FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED<=CONVERT(decimal(20,5), CAST(? AS FLOAT)) AND  END_SUM_INSURED>=CONVERT(decimal(20,5), CAST(? AS FLOAT)) AND BRANCH_CODE=? AND AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED<=CONVERT(decimal(20,5), CAST(? AS FLOAT)) AND  END_SUM_INSURED>=CONVERT(decimal(20,5), CAST(? AS FLOAT)) AND BRANCH_CODE=? AND convert(date,EFFECTIVE_DATE,103) <= CONVERT(DATE,?,103) ) AND STATUS='Y'
rate.fact2value=SELECT MATERIAL_RATE FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_ID =? AND BRANCH_CODE=? and COVER_ID=? AND AMEND_ID=( SELECT ISNULL(MAX(AMEND_ID),0) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_ID=? AND BRANCH_CODE=? and COVER_ID=? AND CONVERT(DATE,EFFECTIVE_DATE,103) <= CONVERT(DATE,?,103)) AND STATUS='Y'
##adnic change
rate.fact3value=SELECT GEO_RATE  FROM  COUNTRY_MASTER WHERE COUNTRY_ID=? AND AMEND_ID=(SELECT  ISNULL(MAX(AMEND_ID),0) FROM COUNTRY_MASTER WHERE COUNTRY_ID=? AND CONVERT(DATE,EFFECTIVE_DATE,103) <= CONVERT(DATE,?,103) ) AND STATUS='Y'
rate.fact4value=SELECT CONV_RATE FROM CONVEYAN_MASTER WHERE SNO =? AND MODE_TRANSPORT_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT  ISNULL(MAX(AMEND_ID),0) FROM CONVEYAN_MASTER WHERE SNO =? AND MODE_TRANSPORT_ID =? AND BRANCH_CODE=? AND CONVERT(DATE,EFFECTIVE_DATE,103) <= CONVERT(DATE,?,103)) AND STATUS='Y'
rate.fact5value=SELECT COMMODITY_RATE FROM COMMODITYMASTER WHERE COMMODITY_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM COMMODITYMASTER WHERE  COMMODITY_ID =? AND BRANCH_CODE=? AND CONVERT(DATE,EFFECTIVE_DATE,103) <= CONVERT(DATE,?,103)) AND STATUS='Y'
rate.fact6value=select PERCENTRATE from package_master where PACKAGE_ID=?  and BRANCH_CODE=? and MODE_TRANSPORT_ID=?
rate.wsrccvalue=SELECT WAR_RATE FROM WAR_RATE_MASTER WHERE MODE_TRANSPORT_ID =? AND BRANCH_CODE=? AND AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM WAR_RATE_MASTER WHERE MODE_TRANSPORT_ID=? AND BRANCH_CODE=? AND CONVERT(DATE,EFFECTIVE_DATE,103) <= CONVERT(DATE,?,103)) AND STATUS='Y'
rate.insertfactor=INSERT INTO COMMODITY_RATE_FACTOR(AMEND_ID, COMMODITY, COVER_RATE, SUM_INSURED_RATE, MATERIAL_RATE, GEO_RATE, CONV_RATE, COMMODITY_RATE, WAR_RATE,RATE,PACKAGE_RATE,APPLICATION_NO) vALUES((SELECT NULLIF((MAX(AMEND_ID)+1),'0') FROM COMMODITY_RATE_FACTOR WHERE COMMODITY=?),?,?,?,?,?,?,?,?,?,?,?)
rate.coverdesc=SELECT DISTINCT DESCRIPTION FROM COVER_MASTER WHERE COVER_ID=?
rate.selectcoverdesc=SELECT SUBSTR(?,INSTR(?,'~',1,4)+1,LENGTH(?)) FROM COMMODITYMASTER A WHERE A.BRANCH_CODE=? AND A.COMMODITY_ID=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE BRANCH_CODE=A.BRANCH_CODE AND COMMODITY_ID=A.COMMODITY_ID)
rate.excessamt=SELECT ISNULL (A.EXCESS_AMOUNT, '0') FROM OPEN_COVER_DEDUCTIBLE_MASTER A, OPEN_COVER_POSITION_MASTER B WHERE ? BETWEEN A.START_RANGE AND A.END_RANGE AND A.OPEN_COVER_PROPOSAL_NO = B.PROPOSAL_NO AND B.OPEN_COVER_NO = ? AND A.STATUS = 'Y' AND convert(date,A.effective_date,103) <= convert(date,SYSDATETIME(),103) AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DEDUCTIBLE_MASTER WHERE convert(date,effective_date,103) <= convert(date,SYSDATETIME(),103) AND OPEN_COVER_PROPOSAL_NO = A.OPEN_COVER_PROPOSAL_NO)
rate.selectdeductibles=SELECT ISNULL(DEDUCTIBLE,'0') FROM COMMODITY_EXCESS_PREMIUM WHERE ? BETWEEN START_SUM_INSURED AND END_SUM_INSURED AND STATUS='Y'
GET_OPENCOVER_EXCESS_DETAILS = select PROPOSAL_NO,COMMODITY_ID,COVER_ID,DISCOUNT_PERCENT,DISCOUNT_VALUE ,EXCESS_DESCRIPTION from OPEN_COVER_COMMODITY_DETAIL OCC where PROPOSAL_NO=(select PROPOSAL_NO from OPEN_COVER_POSITION_MASTER where OPEN_COVER_NO=?) and cover_id=? and commodity_id=? and  (ISNULL(OCC.COVER_TYPE_ID,0) = CASE WHEN ISNULL(OCC.COVER_TYPE_ID,0)=0 then 0 else ? end) and amend_id=(select max(amend_id) from OPEN_COVER_COMMODITY_DETAIL oc where oc.proposal_no=occ.proposal_no)

#WAR RATE
GET_CONVEY_WARRATE=SELECT A.WAR_RATE FROM WAR_RATE_MASTER A WHERE A.MODE_TRANSPORT_ID =? AND A.BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM WAR_RATE_MASTER WHERE MODE_TRANSPORT_ID=A.MODE_TRANSPORT_ID  AND BRANCH_CODE=A.BRANCH_CODE) AND STATUS='Y'
GET_CONVEY_WARRATE_OC=SELECT   SUBSTRING (OCCMSS.WAR_RATE + '#',dbo.instr (OCCMSS.WAR_RATE + '#', '~',dbo.instr(OCCMSS.WAR_RATE,?,1,1),1) + 1,dbo.instr (OCCMSS.WAR_RATE + '#', '#',dbo.instr(OCCMSS.WAR_RATE,?,1,1),1) - dbo.instr (OCCMSS.WAR_RATE + '#', '~',dbo.instr(OCCMSS.WAR_RATE+'#',?,1,1),1) -1) FROM   OPEN_COVER_COUNTRY_MASTER OCCMSS, OPEN_COVER_POSITION_MASTER OCPMSS WHERE   OCPMSS.OPEN_COVER_NO = ? AND OCPMSS.PROPOSAL_NO = OCCMSS.PROPOSAL_NO AND OCCMSS.AMEND_ID IN (SELECT   MAX (OCCMS.AMEND_ID) FROM   OPEN_COVER_COUNTRY_MASTER OCCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE   OCPMS.OPEN_COVER_NO = OCPMSS.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO = OCCMS.PROPOSAL_NO AND CONVERT (date, OCCMS.EFFECTIVE_DATE, 103) <= CONVERT (date, SYSDATETIME (), 103))
#SELECT SUBSTR(OCCMSS.WAR_RATE+ ' ' +'#',INSTR(OCCMSS.WAR_RATE+ ' ' +'#','~',INSTR(OCCMSS.WAR_RATE,?))+1,INSTR(OCCMSS.WAR_RATE+ ' ' +'#','#',INSTR(OCCMSS.WAR_RATE,?))-INSTR(OCCMSS.WAR_RATE+ ' ' +'#','~',INSTR(OCCMSS.WAR_RATE+ ' ' +'#',?))-1) FROM OPEN_COVER_COUNTRY_MASTER OCCMSS,OPEN_COVER_POSITION_MASTER OCPMSS WHERE OCPMSS.OPEN_COVER_NO=? AND OCPMSS.PROPOSAL_NO=OCCMSS.PROPOSAL_NO AND OCCMSS.AMEND_ID IN (SELECT MAX(OCCMS.AMEND_ID) FROM OPEN_COVER_COUNTRY_MASTER OCCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO=OCPMSS.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO=OCCMS.PROPOSAL_NO AND convert(date,OCCMS.EFFECTIVE_DATE,103) <= convert(date,SYSDATETIME(),103))

#POLICY GENERATION
GET_CERT_NO={CALL GET_CERTIFNO(?,?,?)}
GET_POLICY_GENERATE_MARINE =Policy_Generate
GET_POL_NO=SELECT ?+ ' ' +'-' FROM BRANCH_MASTER A, CONSTANT_DETAIL B, CONSTANT_DETAIL C  WHERE A.BRANCH_CODE=? AND B.BRANCH_CODE=A.BRANCH_CODE AND C.BRANCH_CODE=A.BRANCH_CODE AND B.CATEGORY_ID=124 AND B.CATEGORY_DETAIL_ID=1 AND C.CATEGORY_ID=125 AND C.CATEGORY_DETAIL_ID=1
GET_PROD_PREFIX=SELECT RSACODE FROM PRODUCT_MASTER WHERE PRODUCT_ID=? AND BRANCH_CODE=?
GET_OC_NOTE_CNT=SELECT COUNT(1) FROM OPEN_COVER_MASTER A, OPEN_COVER_POSITION_MASTER B WHERE A.PROPOSAL_NO=B.PROPOSAL_NO AND B.OPEN_COVER_NO=? AND A.DEPOSIT_PREMIUM_YN='Y'
GET_OC_CKEY=SELECT CKEY FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO=?
GET_COMMISSION_PERCENT=SELECT ISNULL(COMMISSION,0) FROM LOGIN_USER_DETAILS LUD WHERE LUD.AGENCY_CODE =(SELECT   Case when USERTYPE ='RSAIssuer' then agency_code else oa_code end FROM LOGIN_MASTER WHERE   LOGIN_ID = ?) AND PRODUCT_ID = ? AND amend_id =(SELECT  MAX (amend_id) FROM LOGIN_USER_DETAILS LUD1 WHERE  LUD1.AGENCY_CODE =(SELECT   Case when USERTYPE ='RSAIssuer' then agency_code else oa_code end  FROM  LOGIN_MASTER WHERE LOGIN_ID = ?) AND LUD.PRODUCT_ID = LUD1.PRODUCT_ID)
GET_OC_COMMISSION_PERCENT=SELECT ISNULL(OCM.COMMISSION,0) FROM OPEN_COVER_MASTER OCM,OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO\=? AND OCPM.PROPOSAL_NO\=OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX(OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS,OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO \=OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO\=OCMS.PROPOSAL_NO AND convert(date,OCMS.EFFECTIVE_DATE,103) <\= convert(date,SYSDATETIME(),103))
GET_COMMISSION_PERCENT_ISSUER_ONEOFF=SELECT ISSUER_COMMISSION_ONEOFF FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(select oa_code from login_master where login_id=?)
GET_COMMISSION_PERCENT_ISSUER_OPENCOVER=SELECT ISSUER_COMMISSION_OPENCOVER FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(select oa_code from login_master where login_id=?)
UPD_POLICY_INFO=UPDATE POSITION_MASTER SET POLICY_TERM='1 year',POLICY_NO=?,PDF_PRE_SHOW_STATUS=?,PDF_BANKER_STATUS=?,PDF_GENERATE_STATUS=?,PDF_BANKER_ASSURED_STATUS=?,PDF_CURRENCY_STATUS=?,OPEN_COVER_NO=?,NOTE_TYPE=?,PAYMENT_MODE=?,BASIS_VAL=?,DEBIT_CUST_ID=?,CERT_CLAUSES_YN=?,COMMISSION=?,TAX=?,ENDT_PREM_YN=?,ENDT_CLAUSES_YN=?,PDF_EXCESS_STATUS=?,PDF_STAMP_STATUS=?,DISCOUNT_PREMIUM=? WHERE  QUOTE_NO=? AND AMEND_ID=?
UPD_INCEPTION_DATE=UPDATE POSITION_MASTER SET INCEPTION_DATE=convert(Datetime,?,120),EXPIRY_DATE=convert(Datetime,?,120) WHERE QUOTE_NO=?
UPD_WEBSERVICE_MARINE_QUOTE_POLICY_INFO=update webservice_marine_quote set POLICY_NO=?, status=? where QUOTE_NO=?
GET_EXECUTIVE_PERCENT = SELECT COMMISSION FROM LOGIN_EXECUTIVE_DETAILS LED WHERE AC_EXECUTIVE_ID=? AND EFFECTIVE_DATE <= getdate() AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM LOGIN_EXECUTIVE_DETAILS LED1 WHERE LED1.AC_EXECUTIVE_ID=LED.AC_EXECUTIVE_ID AND convert(date,LED1.EFFECTIVE_DATE,103) <= convert(date,LED.EFFECTIVE_DATE,103))
GET_OPENCOVER_EXECUTIVE_PERCENT = SELECT COMMISSION FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?))
GET_ENDT_COMMISSION_PERCENT = Select ISNULL(discount_premium,0) from position_master pm Where policy_no\=(Select original_policy_no from position_master Where application_no\=?)
GET_EXECUTIVE_ID=SELECT AC_EXECUTIVE_ID FROM MARINE_DATA MD WHERE APPLICATION_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO\=MD.APPLICATION_NO) 
GET_EXECUTIVE_HPM=SELECT AC_EXECUTIVE_ID FROM home_position_master  WHERE APPLICATION_NO\=? 
GET_YEAR_POLICYNO=SELECT DATEPART(yy,getDate()) AS Year
GET_SUBBRANCH=select ISNULL(SUB_BRANCH,'') from login_master where login_Id=?

UPD_POLICY_STS=UPDATE POSITION_MASTER SET DEBIT_NOTE_DATE = POLICY_EFFECTIVE_DATE, MISSIPPI_TRANFER_DATE=convert(date,cast(NULLIF(?,'') AS DATE),103),INCEPTION_DATE=convert(Datetime,?,120), CREDIT_NOTE_DATE=POLICY_EFFECTIVE_DATE, EXPIRY_DATE=convert(date,cast(NULLIF(?,'') AS DATE),103),DEBIT_NOTE_NO=?, CREDIT_NOTE_NO=?,DEBIT_TO=?, CREDIT_TO=?, DEBIT_TO_ID=?, CREDIT_TO_ID=?, STATUS='P'  WHERE QUOTE_NO=? AND AMEND_ID=?
GET_QUOTE_STATUS=SELECT STATUS,POLICY_NO,REMARKS,PREMIUM,ISNULL(A.PREMIUM,'0')+ISNULL(A.EXCESS_PREMIUM,'0') NET_PREMIUM FROM POSITION_MASTER A WHERE QUOTE_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO\=A.QUOTE_NO)
CNT_POLICY_NO=SELECT COUNT(*) FROM POSITION_MASTER WHERE POLICY_NO\=? AND QUOTE_NO \!\=?
GET_LC_INFO=SELECT MD.OPEN_LC_ID,MD.OPEN_BANK_ID,POS.OPEN_COVER_NO FROM MARINE_DATA MD, POSITION_MASTER POS WHERE MD.APPLICATION_NO\=POS.APPLICATION_NO AND POS.QUOTE_NO\=?
GET_TOTAL_USED_SI=SELECT SUM(MRD.SUMINSUREDLOCAL+MD.TOTAL_SALE_TERM_CHARGES+MD.TOTAL_TOLERANCE_CHARGES) FROM MARINE_DATA MD,MARINE_RESULT_DETAILS MRD,POSITION_MASTER PM WHERE MD.APPLICATION_NO\=PM.APPLICATION_NO AND MD.APPLICATION_NO\=MRD.APPLICATION_NO AND MD.OPEN_COVER_NO\=PM.OPEN_COVER_NO AND PM.STATUS\='P' AND MD.STATUS\='Y' AND MD.OPEN_LC_ID\=? AND MD.OPEN_BANK_ID\=? AND MD.OPEN_COVER_NO\=? AND PM.QUOTE_NO\=?
GET_LC_BAL_AMT=SELECT LC_BALANCE_AMOUNT FROM OPEN_COVER_LC_MASTER WHERE LC_ID\=? AND BANK_ID\=? AND OPEN_COVER_NO\=?
UPD_LC_INFO=UPDATE OPEN_COVER_LC_MASTER SET LC_BALANCE_AMOUNT=? WHERE LC_ID=? AND BANK_ID=? AND OPEN_COVER_NO=?
GET_SYSDATETIME()=SELECT CASE WHEN (SYSDATETIME()) BETWEEN (TRN.CLO_DATE_OPENED) AND (TRN.CLO_DATE_CLOSED) THEN SYSDATETIME() ELSE convert(varchar,TRN.CLO_DATE_OPENED, 5) END X FROM T_TRN_CLOSING TRN, PRODUCT_MASTER PM, POSITION_MASTER HPM WHERE PM.BRANCH_CODE \= TRN.BRANCH_CODE AND TRN.BRANCH_CODE \=? AND PM.PRODUCT_ID \= HPM.PRODUCT_ID AND TRN.PRODUCT_CORE_CODE \='1' AND HPM.QUOTE_NO \= ? AND HPM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO\=HPM.QUOTE_NO)
CNT_QUOTE=SELECT COUNT(*) FROM MARINE_DATA MD, MARINE_RESULT_DETAILS MRD, MARINE_RESULT MR, MARINE_POLICY_DETAILS MPD, POSITION_MASTER PM WHERE MD.APPLICATION_NO = PM.APPLICATION_NO AND isnull(MD.OPEN_COVER_NO,0) = isnull(PM.MISSIPPI_OPENCOVER_NO,0) AND MRD.APPLICATION_NO = PM.APPLICATION_NO AND isnull(nullif (MRD.OPEN_COVER_NO,''),0) = isnull(nullif (PM.MISSIPPI_OPENCOVER_NO, ''),0) AND MR.APPLICATION_NO = PM.APPLICATION_NO AND MR.QUOTE_NO = PM.QUOTE_NO AND MR.CUSTOMER_ID = PM.CUSTOMER_ID AND MPD.QUOTE_NO = PM.QUOTE_NO AND MPD.CUSTOMER_ID = PM.CUSTOMER_ID AND PM.QUOTE_NO = ?
GET_COMMISSION=SELECT POS.QUOTE_NO,((ISNULL(MD.MARINE_PREMIUM,'0')+ISNULL(MD.WAR_PREMIUM,'0')+ISNULL(MD.EXCESS_PREMIUM,'0'))*?/100) COMMISSION,(((ISNULL(POS.PREMIUM,'0')-ROUND((ISNULL(MD.POLICY_FEE,'0')+ISNULL(MD.GOVT_TAX,'0')+ISNULL(MD.EMERGENCY_FUND,'0')),0))+ISNULL(POS.EXCESS_PREMIUM,'0'))*?/100)TAX FROM POSITION_MASTER POS,MARINE_DATA MD WHERE POS.APPLICATION_NO=? AND MD.APPLICATION_NO=POS.APPLICATION_NO AND POS.AMEND_ID=(SELECT MAX(AMEND_ID)FROM POSITION_MASTER WHERE APPLICATION_NO=POS.APPLICATION_NO) AND MD.AMEND_ID=POS.AMEND_ID ORDER BY POS.QUOTE_NO
CAL_PROC_INTEG=CALL INTEGRATION_TYPE(?)
GET_NOTE_TYPE=SELECT NOTE_TYPE FROM POSITION_MASTER WHERE APPLICATION_NO=?
GET_PAYMENT_MODE=SELECT ISNULL(PAYMENT_MODE,'CA') FROM POSITION_MASTER WHERE APPLICATION_NO=?

GET_BRANCH_INFO=SELECT CURRENCY_ABBREVIATION CURR_NAME,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,DECIMAL_PLACES,ISNULL(TAX,'0') TAX,EMAIL FROM BRANCH_MASTER WHERE BRANCH_CODE\=?
#GET_POLICY_INFO=SELECT BROKER_CODE, REFERENCE_NUMBER, TYPE, ISNULL(OPENCOVER_POLICY_NUMBER, 0), CUSTOMER_ID, CUSTOMER_NAME, ADDRESS1, ADDRESS2, PO_BOX, COUNTRY, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_PERCENT, CURRENCY, SETTLING_AGENT,TOTAL_SUM_INSURED, convert(varchar(10),POLICY_START_DATE,103), convert(varchar(10),SAILING_DATE,103), VESSEL_NAME, LC_NUMBER, ISSUING_BANK, convert(varchar(10),LC_DATE,10), PARTIAL_SHIPMENT, BL_AWB_NUMBER, convert(varchar(10),BL_AWB_DATE,103), QUOTE_NO, PREMIUM, POLICY_NO, REMARKS, STATUS, ENDORSEMENT, CLAUSES, WARRANTIES, EXCLUSION, convert(varchar(10),RECEIVED_DATE,103), RESPONSE_TIME, POLICY_FILE_PATH, APPLICATION_NO, COVERAGES, SEA_COVERAGES, WSRCC, PRODUCT_ID, TOLERANCE,PDF_PRE_SHOW_STATUS,PDF_BANKER_STATUS,PDF_GENERATE_STATUS,PDF_BANKER_ASSURED_STATUS,PDF_CURRENCY_STATUS, EMAIL, CLIENT_CUSTOMER_ID,ORIGIN_CITY_NAME,DEST_CITY_NAME,NOTE_TYPE, PAYMENT_MODE, BASIS_VAL, PACKAGE_TYPE, PDF_STAMP_STATUS,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, ISSUER, LOGIN_ID,CUST_TITLE,CUST_CORE_APP_CODE,SETTLING_AGENT_NAME,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,AC_EXECUTIVE_ID,ADMIN_REFERRAL_YN,ADMIN_REFERRAL_REMARKS,VESSEL_ID,CUST_AR_NO,CERT_CLAUSES_YN,ISNULL(ADDITIONAL_PREMIUM,0),DEBIT_CUST_ID,ENDT_PREM_YN,ENDT_CLAUSES_YN,PDF_EXCESS_STATUS,PROMOTIONAL_CODE,PROMOTIONAL_DISCOUNT, BRANCH_CODE,CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME FROM WEBSERVICE_MARINE_QUOTE WHERE REFERENCE_NUMBER=?
GET_POLICY_INFO=SELECT BROKER_CODE, REFERENCE_NUMBER, TYPE, nullif(OPENCOVER_POLICY_NUMBER,'0'), CUSTOMER_ID, CUSTOMER_NAME, ADDRESS1, ADDRESS2, PO_BOX, COUNTRY, EMIRATE, MOBILE_NUMBER, MODE_OF_TRANSPORT, ORIGINATING_COUNTRY, DESTINATION_COUNTRY, ORIGINATING_COUNTRY_CITY, DESTINATION_COUNTRY_CITY, ORIGINATING_WAREHOUSE_COVERAGE, DESTINATION_WAREHOUSE_COVERAGE, SALETERM_PERCENT, CURRENCY, SETTLING_AGENT,TOTAL_SUM_INSURED, convert(varchar(10),POLICY_START_DATE,103), convert(varchar(10),SAILING_DATE,103), VESSEL_NAME, LC_NUMBER, ISSUING_BANK, convert(varchar(10),LC_DATE,103), PARTIAL_SHIPMENT, BL_AWB_NUMBER, convert(varchar(10),BL_AWB_DATE,103), QUOTE_NO, PREMIUM, POLICY_NO, REMARKS, STATUS, ENDORSEMENT, CLAUSES, WARRANTIES, EXCLUSION, convert(varchar(10),RECEIVED_DATE,103), RESPONSE_TIME, POLICY_FILE_PATH, APPLICATION_NO, COVERAGES, SEA_COVERAGES, WSRCC, PRODUCT_ID, TOLERANCE,PDF_PRE_SHOW_STATUS,PDF_BANKER_STATUS,PDF_GENERATE_STATUS,PDF_BANKER_ASSURED_STATUS,PDF_CURRENCY_STATUS, EMAIL, CLIENT_CUSTOMER_ID,ORIGIN_CITY_NAME,DEST_CITY_NAME,NOTE_TYPE, PAYMENT_MODE, BASIS_VAL, PACKAGE_TYPE, PDF_STAMP_STATUS,CUST_CONTRACT_NO, CUST_FMS_CASE_NO, CUST_REFERENCE_NO, ISSUER, LOGIN_ID,CUST_TITLE,CUST_CORE_APP_CODE,SETTLING_AGENT_NAME,SHIPMENT_EXPOSURE,EXPOSURE_CURRENCY,AC_EXECUTIVE_ID,ADMIN_REFERRAL_YN,ADMIN_REFERRAL_REMARKS,VESSEL_ID,CUST_AR_NO,CERT_CLAUSES_YN,nullif(ADDITIONAL_PREMIUM,0),DEBIT_CUST_ID,ENDT_PREM_YN,ENDT_CLAUSES_YN,PDF_EXCESS_STATUS,PROMOTIONAL_CODE,PROMOTIONAL_DISCOUNT, BRANCH_CODE,CONSIGNEE_DET, SPECIAL_TERM, ADD_CUST_NAME, core_customer_name,CHANNEL_TYPE,EXCHANGE_RATE,ISSUER,VIA ,VAT_REG_NO ,CUSTOMER_NAME_AR FROM WEBSERVICE_MARINE_QUOTE WHERE REFERENCE_NUMBER=?
GET_BROKER_INFO=SELECT A.LOGIN_ID,B.BRANCH_CODE,A.COMPANY_ID FROM LOGIN_MASTER A, BROKER_COMPANY_MASTER B WHERE A.AGENCY_CODE=? AND B.AGENCY_CODE=A.AGENCY_CODE
GET_COMM_INFO=SELECT A.COMMODITY_ID, B.COMMODITY_DESCRIPTION, B.SUMINSURED, A.COMMODITY_TYPE_ID, A.COMMODITY_EXCESS_PREMIUM, B.FRAGILE,B.SUPPLIER_NAME,B.PACKAGE_DESCRIPTION,B.INVOICE_NUMBER,A.COMMODITY_RATE,B.WSRCC_RATE,B.ENDORSEMENT FROM COMMODITYMASTER A, WEBSERVICE_MARINE_COMMODITY B WHERE B.REFERENCE_NUMBER=? AND A.COMMODITY_ID=B.COMMODITY_CODE AND A.BRANCH_CODE=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID=A.COMMODITY_ID AND BRANCH_CODE=A.BRANCH_CODE) ORDER BY COMMODITY_ID
GET_LOGIN_ID=SELECT LOGIN_ID FROM POSITION_MASTER A WHERE APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO=A.APPLICATION_NO)
GET_AMEND_ID=SELECT ISNULL(MAX(AMEND_ID),0) FROM POSITION_MASTER WHERE APPLICATION_NO=?
GET_POL_COM=SELECT DISCOUNT_PREMIUM FROM POSITION_MASTER A WHERE APPLICATION_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO=A.APPLICATION_NO)
GET_BANK_NAME=SELECT BANK_NAME FROM OPEN_COVER_BANK_MASTER WHERE BANK_ID=?
GET_PORTFOLIO_SEARCH_ISSUER=SELECT A.POLICY_NO, A.CUSTOMER_ID, (ISNULL(A.PREMIUM,0)+ISNULL(A.EXCESS_PREMIUM,0))PREMIUM,  CONVERT(VARCHAR(10),A.INCEPTION_DATE, 103) QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, ISNULL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= A.LOGIN_ID)) BROKER_NAME, convert(varchar(10),MD.INCEPTION_DATE,103) POLICY_START_DATE, (SELECT OCM.CUSTOMER_ID FROM OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO \= A.OPEN_COVER_NO AND OCPM.PROPOSAL_NO \= OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO \= OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO \= OCMS.PROPOSAL_NO AND  CONVERT(DATE,OCMS.EFFECTIVE_DATE, 103) <\=  CONVERT(DATE,SYSDATETIME(),103))) OC_CUST_ID FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT AGENCY_CODE FROM BROKER_COMPANY_MASTER WHERE BRANCH_CODE \= ?)) AND A.STATUS \= 'P' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.OPEN_COVER_NO \= ISNULL(?,'0') AND A.POLICY_NO LIKE UPPER (?) AND ORIGINAL_POLICY_NO IS NULL AND MD.APPLICATION_NO \= A.APPLICATION_NO 
GET_PORTFOLIO_ISSUER=SELECT A.POLICY_NO, A.CUSTOMER_ID, (ISNULL(A.PREMIUM,0)+ISNULL(A.EXCESS_PREMIUM,0))PREMIUM, CONVERT(VARCHAR(10),A.INCEPTION_DATE,103) QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, ISNULL (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID \= A.LOGIN_ID)) BROKER_NAME,  CONVERT(VARCHAR(10),MD.INCEPTION_DATE,103) POLICY_START_DATE, (SELECT OCM.CUSTOMER_ID FROM OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO \= A.OPEN_COVER_NO AND OCPM.PROPOSAL_NO \= OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO \= OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO \= OCMS.PROPOSAL_NO AND  CONVERT(DATE,OCMS.EFFECTIVE_DATE,103) <\=  CONVERT(DATE,SYSDATETIME(), 103))) OC_CUST_ID FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE A.LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN (SELECT AGENCY_CODE FROM BROKER_COMPANY_MASTER WHERE BRANCH_CODE \= ?)) AND A.STATUS \= 'P' AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.POLICY_NO LIKE UPPER (?) AND ORIGINAL_POLICY_NO IS NULL AND MD.APPLICATION_NO \= A.APPLICATION_NO 
GET_PORTFOLIO_OC=SELECT A.POLICY_NO, A.CUSTOMER_ID, (ISNULL(A.PREMIUM,0)+ISNULL(A.EXCESS_PREMIUM,0))PREMIUM,  CONVERT(VARCHAR(10),A.INCEPTION_DATE, 103) QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, ISNULL (A.OPEN_COVER_NO, ''0''), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME,REPLACE(CONVERT(VARCHAR(10),MPD.LC_DATE,103) ,''01/01/1900'',''N/A'') LC_DATE,MPD.LC_NUMBER,REPLACE(CONVERT(VARCHAR(10), MPD.BL_AWB_DATE,103) ,''01/01/1900'',''N/A'') BL_AWB_DATE,MPD.BL_AWB_NO,MRD.DESCRIPTION GOODS_DESCRIPTION,MRD.PO_NUMBER PO_NUMBER, (select USERNAME from login_master lm where lm.login_id\=(CASE WHEN A.APPLICATION_ID \= ''1'' THEN A.LOGIN_ID ELSE A.APPLICATION_ID END))  USERNAME,mrd.INVOICE_NUMBER INVOICE_NO FROM POSITION_MASTER A, PERSONAL_INFO B ,MARINE_POLICY_DETAILS mpd,MARINE_RESULT_DETAILS MRD WHERE {0} A.STATUS \= ''P'' AND  MRD.APPLICATION_NO \=A.APPLICATION_NO  and  a.QUOTE_NO\=mpd.QUOTE_NO  AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ? AND A.OPEN_COVER_NO LIKE ? AND ORIGINAL_POLICY_NO IS NULL and b.AMEND_ID\=(select max(amend_id) from PERSONAL_INFO pi where pi.CUSTOMER_ID\=b.CUSTOMER_ID)  and  MRD.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM  MARINE_RESULT_DETAILS MRD1 WHERE MRD.APPLICATION_NO\=MRD1.APPLICATION_NO)
GET_OC_CUST_ID=SELECT OCM.CUSTOMER_ID FROM OPEN_COVER_MASTER OCM, OPEN_COVER_POSITION_MASTER OCPM WHERE OCPM.OPEN_COVER_NO = ? AND OCPM.PROPOSAL_NO = OCM.PROPOSAL_NO AND OCM.AMEND_ID IN (SELECT MAX (OCMS.AMEND_ID) FROM OPEN_COVER_MASTER OCMS, OPEN_COVER_POSITION_MASTER OCPMS WHERE OCPMS.OPEN_COVER_NO = OCPM.OPEN_COVER_NO AND OCPMS.PROPOSAL_NO = OCMS.PROPOSAL_NO AND  CONVERT(DATE,OCMS.EFFECTIVE_DATE,103) <=  CONVERT(DATE,SYSDATETIME(), 103))
CNT_OC_DEPOSIT=SELECT COUNT(1) FROM OPEN_COVER_MASTER A WHERE A.MISSIPPI_OPENCOVER_NO=? AND A.DEPOSIT_PREMIUM_YN='Y'
GET_ENDT_INFO=SELECT A.APPLICATION_NO, A.QUOTE_NO, (CASE WHEN A.STATUS = 'R' THEN 'RR' WHEN ( (A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS = 'N') OR (A.REMARKS IN ('Admin','Normal','Referal','NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS = 'Y') AND A.STATUS = 'E')  THEN 'RU'  WHEN (    A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS = 'N' AND A.STATUS = 'E') THEN 'RA' ELSE 'N' END) REF_STATUS,A.STATUS,A.ENDT_STATUS FROM   POSITION_MASTER A, MARINE_DATA MD WHERE MD.APPLICATION_NO = A.APPLICATION_NO AND A.LOGIN_ID = ? AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID = ? AND A.ORIGINAL_POLICY_NO = ? AND A.QUOTE_NO=(select max(QUOTE_NO) from POSITION_MASTER where  LOGIN_ID=a.LOGIN_ID AND ISNULL (OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') and PRODUCT_ID=A.PRODUCT_ID and ORIGINAL_POLICY_NO=A.ORIGINAL_POLICY_NO)
GET_MOTOR_ENDT_INFO=SELECT A.APPLICATION_NO, A.QUOTE_NO, (CASE WHEN A.STATUS = 'R' THEN 'RR' WHEN (a.REMARKS IN ('Referal')) THEN 'RU' WHEN (a.REMARKS IN ('Admin') AND A.STATUS = 'E') THEN 'RA' ELSE 'N' END) REF_STATUS, A.STATUS,A.ENDT_STATUS FROM HOME_POSITION_MASTER A WHERE A.PRODUCT_ID=? AND A.ORIGINAL_POLICY_NO=? AND A.QUOTE_NO = (SELECT MAX(QUOTE_NO) FROM HOME_POSITION_MASTER WHERE LOGIN_ID = a.LOGIN_ID AND PRODUCT_ID = A.PRODUCT_ID AND ORIGINAL_POLICY_NO = A.ORIGINAL_POLICY_NO)
GET_PORTFOLIO_CANCELLED_OC=SELECT A.APPLICATION_NO, A.POLICY_NO, A.ENDT_STATUS, A.ENDT_TYPE, A.STATUS, A.CUSTOMER_ID, (ISNULL(A.PREMIUM,0)+ISNULL(A.EXCESS_PREMIUM,0))PREMIUM, convert (VARCHAR(10),A.INCEPTION_DATE, 103) QUOTATION_DATE, ISNULL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, ISNULL (A.OPEN_COVER_NO, '0'), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME,REPLACE(CONVERT(VARCHAR(10),MPD.LC_DATE,103) ,''01/01/1900'',''N/A'') LC_DATE,MPD.LC_NUMBER,REPLACE( CONVERT(VARCHAR(10), MPD.BL_AWB_DATE,103) ,''01/01/1900'',''N/A'') BL_AWB_DATE,MPD.BL_AWB_NO,MRD.DESCRIPTION GOODS_DESCRIPTION,MRD. PO_NUMBER PO_NUMBER, (select USERNAME from login_master lm where lm.login_id\=(  CASE WHEN A.APPLICATION_ID \= ''1'' THEN A.LOGIN_ID  ELSE A.APPLICATION_ID END))  USERNAME,mrd.INVOICE_NUMBER INVOICE_NO  FROM POSITION_MASTER A, PERSONAL_INFO B ,MARINE_POLICY_DETAILS mpd,MARINE_RESULT_DETAILS MRD WHERE {0} A.STATUS in (''{1}'') AND B.CUSTOMER_ID \= A.CUSTOMER_ID and b.amend_id\=(select max(amend_id) from PERSONAL_INFO p where p.CUSTOMER_ID\=b.CUSTOMER_ID) AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ? AND A.OPEN_COVER_NO LIKE ? AND ORIGINAL_POLICY_NO IS  NULL  and A.login_id\=?  AND  MRD.APPLICATION_NO \=A.APPLICATION_NO  and  a.QUOTE_NO\=mpd.QUOTE_NO and  MRD.AMEND_ID\=(  SELECT MAX(AMEND_ID) FROM  MARINE_RESULT_DETAILS MRD1  WHERE MRD.APPLICATION_NO\=MRD1.APPLICATION_NO)
GET_PORTFOLIO_CANCELLED=SELECT A.APPLICATION_NO, A.POLICY_NO, A.ENDT_STATUS, A.ENDT_TYPE, A.STATUS, A.CUSTOMER_ID, (ISNULL(A.PREMIUM,0)+ISNULL(A.EXCESS_PREMIUM,0))PREMIUM, convert (VARCHAR(10),A.INCEPTION_DATE, 103) QUOTATION_DATE, ISNULL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, ISNULL (A.OPEN_COVER_NO, '0'), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME ,REPLACE(CONVERT(VARCHAR(10),MPD.LC_DATE,103) ,''01/01/1900'',''N/A'') LC_DATE,MPD.LC_NUMBER,REPLACE( CONVERT(VARCHAR(10), MPD.BL_AWB_DATE,103) ,''01/01/1900'',''N/A'') BL_AWB_DATE,MPD.BL_AWB_NO,MRD.DESCRIPTION GOODS_DESCRIPTION,MRD. PO_NUMBER PO_NUMBER, (select USERNAME from login_master lm where lm.login_id\=(  CASE WHEN A.APPLICATION_ID \= ''1'' THEN A.LOGIN_ID  ELSE A.APPLICATION_ID END))  USERNAME,mrd.INVOICE_NUMBER INVOICE_NO FROM POSITION_MASTER A, PERSONAL_INFO B,MARINE_DATA MD,MARINE_POLICY_DETAILS mpd,MARINE_RESULT_DETAILS MRD WHERE MD.APPLICATION_NO\=A.APPLICATION_NO AND {0} A.STATUS \= ''{1}'' AND B.CUSTOMER_ID \= A.CUSTOMER_ID and b.amend_id\=(select max(amend_id) from PERSONAL_INFO p where p.CUSTOMER_ID\=b.CUSTOMER_ID) AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ?  AND ISNULL(A.OPEN_COVER_NO,''0'') \= ISNULL(?,''0'') AND ORIGINAL_POLICY_NO IS  NULL    and A.login_id\=?  AND  MRD.APPLICATION_NO \=A.APPLICATION_NO  and  a.QUOTE_NO\=mpd.QUOTE_NO and  MRD.AMEND_ID\=(  SELECT MAX(AMEND_ID) FROM  MARINE_RESULT_DETAILS MRD1  WHERE MRD.APPLICATION_NO\=MRD1.APPLICATION_NO)
GET_PORTFOLIO_CANCELLED_OC_ISSUER=SELECT A.APPLICATION_NO, A.POLICY_NO, A.ENDT_STATUS, A.ENDT_TYPE, A.STATUS, A.CUSTOMER_ID, (ISNULL(A.PREMIUM,0)+ISNULL(A.EXCESS_PREMIUM,0))PREMIUM, convert (VARCHAR(10),A.INCEPTION_DATE, 103) QUOTATION_DATE, ISNULL (B.COMPANY_NAME, B.FIRST_NAME) CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, ISNULL (A.OPEN_COVER_NO, '0'), DEBIT_NOTE_NO, CREDIT_NOTE_NO, A.AMEND_ID,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME,REPLACE(CONVERT(VARCHAR(10),MPD.LC_DATE,103) ,''01/01/1900'',''N/A'') LC_DATE,MPD.LC_NUMBER,REPLACE( CONVERT(VARCHAR(10), MPD.BL_AWB_DATE,103) ,''01/01/1900'',''N/A'') BL_AWB_DATE,MPD.BL_AWB_NO,MRD.DESCRIPTION GOODS_DESCRIPTION,MRD. PO_NUMBER PO_NUMBER, (select USERNAME from login_master lm where lm.login_id\=(  CASE WHEN A.APPLICATION_ID \= ''1'' THEN A.LOGIN_ID  ELSE A.APPLICATION_ID END))  USERNAME,mrd.INVOICE_NUMBER INVOICE_NO  FROM POSITION_MASTER A, PERSONAL_INFO B ,MARINE_POLICY_DETAILS mpd,MARINE_RESULT_DETAILS MRD WHERE {0} A.STATUS in (''{1}'') AND B.CUSTOMER_ID \= A.CUSTOMER_ID and b.amend_id\=(select max(amend_id) from PERSONAL_INFO p where p.CUSTOMER_ID\=b.CUSTOMER_ID) AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND A.PRODUCT_ID \= ? AND A.OPEN_COVER_NO LIKE ? AND ORIGINAL_POLICY_NO IS  NULL    AND  MRD.APPLICATION_NO \=A.APPLICATION_NO  and  a.QUOTE_NO\=mpd.QUOTE_NO and  MRD.AMEND_ID\=(  SELECT MAX(AMEND_ID) FROM  MARINE_RESULT_DETAILS MRD1  WHERE MRD.APPLICATION_NO\=MRD1.APPLICATION_NO)

UPD_WS_QUOTE_APPNO=UPDATE WEBSERVICE_MARINE_QUOTE SET APPLICATION_NO=? WHERE REFERENCE_NUMBER=?
UPD_WS_COMM_APPNO=UPDATE WEBSERVICE_MARINE_COMMODITY SET APPLICATION_NO=? WHERE REFERENCE_NUMBER=?
UPD_WS_QUOTE_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET APPLICATION_NO=?, QUOTE_NO=?, PREMIUM=(SELECT PREMIUM FROM POSITION_MASTER A WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=A.QUOTE_NO)), REMARKS=?, CUSTOMER_ID=?, STATUS=?, QUOTATION_DATE=(SELECT ENTRY_DATE FROM POSITION_MASTER A WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=A.QUOTE_NO)),ADDITIONAL_PREMIUM=(SELECT EXCESS_PREMIUM FROM POSITION_MASTER A WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=A.QUOTE_NO)) WHERE REFERENCE_NUMBER=?
UPD_WS_POLICY_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET POLICY_NO=?, POLICY_FILE_PATH=?, STATUS=? WHERE REFERENCE_NUMBER=?
UPD_WS_PRE_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET PREMIUM=CONVERT(numeric(16,2), CAST(? AS FLOAT)),ADDITIONAL_PREMIUM=CONVERT(numeric(16,2), CAST(? AS FLOAT)), WAR_PREMIUM=CONVERT(numeric(16,2), CAST(? AS FLOAT)),ISSUANCE_FEE=CONVERT(numeric(16,2), CAST(? AS FLOAT)),INSPECTION_FEE=CONVERT(numeric(16,2), CAST(? AS FLOAT)) WHERE APPLICATION_NO=?
UPD_WS_DRAFT_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET DRAFT_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_WS_QUOTE_SCH_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET QUOTE_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_WS_DEBIT_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET DEBIT_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_WS_CREDIT_INFO=UPDATE WEBSERVICE_MARINE_QUOTE SET CREDIT_FILE_PATH=? WHERE REFERENCE_NUMBER=?
UPD_ADMIN_REF_INFO=UPDATE MARINE_DATA SET ADMIN_REFERRAL_STATUS=?, REMARKS=? WHERE APPLICATION_NO=?
UPD_POL_REMARKS=UPDATE POSITION_MASTER SET REMARKS='Normal' WHERE APPLICATION_NO=?
UPD_POLICY_DOC_INFO=UPDATE POSITION_MASTER SET PDF_PRE_SHOW_STATUS=?, PDF_BANKER_STATUS=?, PDF_GENERATE_STATUS=?, PDF_BANKER_ASSURED_STATUS=?, PDF_CURRENCY_STATUS=?,PDF_STAMP_STATUS=?,CERT_CLAUSES_YN=?,ENDT_PREM_YN=?,ENDT_CLAUSES_YN=?,PDF_EXCESS_STATUS=?,BASIS_VAL=? WHERE APPLICATION_NO=?
UPD_PM_APPR_STS=UPDATE POSITION_MASTER SET ADMIN_REFERRAL_REMARKS=?,DISCOUNT_PREMIUM=?,REMARKS='Admin',APPROVED_BY=(SELECT ISNULL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?) WHERE APPLICATION_NO=?
UPD_MD_APPR_STS=UPDATE POSITION_MASTER SET ADMIN_REFERRAL_REMARKS=?,DISCOUNT_PREMIUM=?,REMARKS='Admin',APPROVED_BY=(SELECT ISNULL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?) WHERE APPLICATION_NO=?
UPD_MRD_COMM_INFO=UPDATE MARINE_RESULT_DETAILS SET SUPPLIER_NAME=?,PACKAGE_DESCRIPTION=?,INVOICE_NUMBER=? WHERE APPLICATION_NO=? AND COMMODITY_ID=?
UPD_WS_ADMIN_REFERRAL=UPDATE WEBSERVICE_MARINE_QUOTE SET ADMIN_REFERRAL_YN=?, ADMIN_REFERRAL_REMARKS=? WHERE APPLICATION_NO=?
UPD_PM_ADMIN_APPR=UPDATE POSITION_MASTER SET STATUS=?, ADMIN_REFERRAL_REMARKS=?,DISCOUNT_PREMIUM=CONVERT(decimal(10,2), CAST(? AS FLOAT)),REMARKS='Admin',APPROVED_BY=(SELECT ISNULL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID=?) WHERE APPLICATION_NO=?
UPD_PM_ADMIN_REM=UPDATE POSITION_MASTER SET STATUS=?, REMARKS=? WHERE APPLICATION_NO=?
UPD_PM_ADMIN_REJ=UPDATE POSITION_MASTER SET ADMIN_REMARKS=?,STATUS='R',ENTRY_DATE= SYSDATETIME() ,APPROVED_BY=? WHERE APPLICATION_NO=?
UPD_MD_ADMIN_STS=UPDATE MARINE_DATA SET ADMIN_REFERRAL_STATUS=? WHERE APPLICATION_NO=?
CNT_QUOTE_REFERRAL=SELECT COUNT(1) FROM MARINE_DATA WHERE APPLICATION_NO=? AND REMARKS LIKE '%Referal'
CAL_PROC_UPD_COMM_RATE={CALL UPDATE_COMMODITY_RATE(?,?)}
CAL_PROC_UPD_PREMIUM={CALL UPDATE_PREMIUM(?)}
GET_DEPOSITPREMIUM_STATUS = Select Count(*) From Open_Cover_Master A, Open_Cover_Position_Master B  Where A.Proposal_No = B.Proposal_No And B.Open_Cover_No = ? And B.Status='P' And A.Deposit_Premium_Yn='Y' AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER A1 WHERE A1.Proposal_No=A.Proposal_No)

#ENDORSEMENT
GET_ENDT_TYPE=SELECT ENDT_TYPE_ID, ENDT_TYPE, ENDT_TYPE_DESC, ENDT_TYPE_CATEGORY_ID, ENDT_TYPE_CATEGORY FROM ENDT_TYPE_MASTER WHERE STATUS='Y' AND PRODUCT_ID=? ORDER BY ENDT_TYPE_ID,ENDT_TYPE_CATEGORY_ID
GET_TRAVEL_END_LIST=SELECT HPM.APPLICATION_NO,HPM.QUOTE_NO, isnull(nullif(pi.COMPANY_NAME,''), pi.FIRST_NAME+' '+pi.last_name) CUSTOMER_NAME, convert(varchar(10),DATEDIFF(day,-30,HPM.EFFECTIVE_DATE),103) QUOTATION_DATE ,HPM.ENDT_PREMIUM+HPM.POLICY_FEE PREMIUM ,HPM.POLICY_NO ,HPM.STATUS,(CASE WHEN hpm.STATUS\='R' THEN 'RR' WHEN ((hpm.REMARKS IN ('Referal') AND hpm.ADMIN_REFERRAL_STATUS \= 'N') OR (hpm.REMARKS IN ('Admin', 'Normal' , 'Referal') AND hpm.ADMIN_REFERRAL_STATUS \= 'Y') AND HPM.STATUS \= 'E') THEN 'RU' WHEN (HPM.REMARKS IN ('ADMIN') AND HPM.ADMIN_REFERRAL_STATUS \= 'N' AND HPM.STATUS \= 'E') THEN 'RA' ELSE 'N' END) REF_STATUS,'Y' ENDT_STATUS,HPM.CUSTOMER_ID,HPM.DEBIT_NOTE_NO,HPM.RECEIPT_NO,HPM.ENDT_TYPE_ID ENDT_TYPE FROM HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE HPM.ORIGINAL_POLICY_NO \= ? AND HPM.PRODUCT_ID \= ? AND HPM.CUSTOMER_ID \= PI.CUSTOMER_ID AND PI.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID \= PI.CUSTOMER_ID) ORDER BY HPM.QUOTE_NO DESC
GET_END_LIST=SELECT A.POLICY_NO, A.CUSTOMER_ID, A.PREMIUM, convert (varchar(10),A.INCEPTION_DATE, 103) QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, B.LAST_NAME, A.LOGIN_ID, A.QUOTE_NO, A.EXCESS_PREMIUM, B.COMPANY_NAME, A.INCEPTION_DATE, ISNULL (A.OPEN_COVER_NO, '0'), DEBIT_NOTE_NO, CREDIT_NOTE_NO,ENDT_TYPE,(CASE WHEN A.STATUS\='R' THEN 'Referal Reject' WHEN ((A.REMARKS IN ('Referal') AND MD.ADMIN_REFERRAL_STATUS \= 'N') OR (A.REMARKS IN ('Admin', 'Normal' , 'Referal', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'Y') AND A.STATUS \= 'E') THEN 'ReferalUnapproved' WHEN (A.REMARKS IN ('Admin', 'NORMAL_EXCESS_PRICE') AND MD.ADMIN_REFERRAL_STATUS \= 'N' AND A.STATUS \= 'E') THEN 'ReferalApproved' WHEN A.STATUS \= 'P' THEN 'Policy Converted'  WHEN A.STATUS \= 'E' THEN 'ExistingQuote' WHEN A.STATUS \= 'C' THEN 'Cancelled Policy' ELSE 'N' END) REF_STATUS,A.STATUS,A.APPLICATION_NO,A.ENDT_STATUS,(SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE\=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=A.LOGIN_ID)) BROKER_NAME,(case A.OPEN_COVER_NO  when  '0' then null else A.OPEN_COVER_NO end) FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE MD.APPLICATION_NO\=A.APPLICATION_NO AND A.LOGIN_ID\=? AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID \= ? AND A.ORIGINAL_POLICY_NO \= ?  and B.amend_id\=(select max(amend_id) from personal_info pi where B.CUSTOMER_ID\=pi.customer_id) 
GET_POL_ENDT=SELECT ENDT_TYPE FROM POSITION_MASTER WHERE APPLICATION_NO\=?
GET_ENDT_LIST_ISSUER=SELECT DISTINCT A.POLICY_NO ,A.QUOTE_NO, A.CUSTOMER_ID ,A.PREMIUM, convert(varchar(10),A.INCEPTION_DATE,103) QUOTATION_DATE ,B.FIRST_NAME CUSTOMER_NAME ,B.LAST_NAME ,A.LOGIN_ID ,A.QUOTE_NO ,A.EXCESS_PREMIUM ,B.COMPANY_NAME ,A.INCEPTION_DATE ,ISNULL (A.OPEN_COVER_NO, '0') ,A.DEBIT_NOTE_NO ,A.CREDIT_NOTE_NO ,A.AMEND_ID ,( SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=( SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=A.LOGIN_ID)) BROKER_NAME FROM POSITION_MASTER A ,PERSONAL_INFO B WHERE A.LOGIN_ID= ? AND A.STATUS IN  ('P','E') and A.product_id = a.product_id AND B.CUSTOMER_ID = A.CUSTOMER_ID AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN ('LINKED') AND A.PRODUCT_ID =? AND A.APPLICATION_ID in (isnull(nullif(?,''),'1')) AND ISNULL(A.OPEN_COVER_NO,'0') LIKE ?+ '' +'%'  AND A.ORIGINAL_POLICY_NO IS NOT NULL
#GET_ENDT_PRE_INFO=SELECT * FROM (SELECT ORIGINAL_POLICY_NO,QUOTE_NO, PREMIUM+ISNULL (EXCESS_PREMIUM, 0) PREMIUM, LAG(PREMIUM + ISNULL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS PREMIUM_PREV, (PREMIUM+ISNULL (EXCESS_PREMIUM, 0))-(LAG(PREMIUM + ISNULL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO)) PREMIUM_DIFF, PREMIUM-ISNULL(TOTAL_WAR_CHARGES,0)-ISNULL(POLICY_FEE,0) MARINE_PREMIUM, LAG(PREMIUM-ISNULL(TOTAL_WAR_CHARGES,0)-ISNULL(POLICY_FEE,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS MARINE_PREMIUM_PREV, (PREMIUM-ISNULL(TOTAL_WAR_CHARGES,0)-ISNULL(POLICY_FEE,0))-LAG(PREMIUM-ISNULL(TOTAL_WAR_CHARGES,0)-ISNULL(POLICY_FEE,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) MARINE_PREMIUM_DIFF, TOTAL_WAR_CHARGES WAR_PREMIUM, LAG(TOTAL_WAR_CHARGES, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS WAR_PREMIUM_PREV, TOTAL_WAR_CHARGES-LAG(TOTAL_WAR_CHARGES, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) WAR_PREMIUM_DIFF, EXCESS_PREMIUM, LAG(EXCESS_PREMIUM, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS EXCESS_PREMIUM_PREV, EXCESS_PREMIUM EXCESS_PREMIUM_DIFF, 0 POLICY_FEE, LAG(POLICY_FEE, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO,ENDT_NO) AS POLICY_FEE_PREV, POLICY_FEE POLICY_FEE_DIFF FROM MARINE_DATA_ENDT )A WHERE QUOTE_NO = ?
GET_ENDT_PRE_INFO= SELECT * FROM (SELECT ORIGINAL_POLICY_NO,QUOTE_NO,Round(PREMIUM + ISNULL (EXCESS_PREMIUM, 0) + ISNULL (GOVT_TAX, 0),0) PREMIUM,Round(LAG (PREMIUM + ISNULL (EXCESS_PREMIUM, 0) + ISNULL (GOVT_TAX, 0),1,0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO),0) AS PREMIUM_PREV,Round((  PREMIUM + ISNULL (EXCESS_PREMIUM, 0) + ISNULL (GOVT_TAX, 0)),0) - Round((LAG (PREMIUM + ISNULL (EXCESS_PREMIUM, 0)+ ISNULL (GOVT_TAX, 0),  1,0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO)),0) PREMIUM_DIFF,MARINE_PREMIUM MARINE_PREMIUM,LAG (MARINE_PREMIUM, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) AS MARINE_PREMIUM_PREV,(MARINE_PREMIUM) - LAG (MARINE_PREMIUM, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) MARINE_PREMIUM_DIFF,ISNULL(TOTAL_WAR_CHARGES,0) WAR_PREMIUM,ISNULL(LAG (TOTAL_WAR_CHARGES, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO),0) AS WAR_PREMIUM_PREV,ISNULL(TOTAL_WAR_CHARGES,0) - LAG (ISNULL(TOTAL_WAR_CHARGES,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) WAR_PREMIUM_DIFF,EXCESS_PREMIUM, LAG (ISNULL(EXCESS_PREMIUM,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) AS EXCESS_PREMIUM_PREV,EXCESS_PREMIUM - LAG (ISNULL(EXCESS_PREMIUM,0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) EXCESS_PREMIUM_DIFF, POLICY_FEE,LAG (POLICY_FEE, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) AS POLICY_FEE_PREV,POLICY_FEE - LAG (POLICY_FEE, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) POLICY_FEE_DIFF,GOVT_TAX,LAG (GOVT_TAX, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) AS GOVT_TAX_PREV,GOVT_TAX - LAG (GOVT_TAX, 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) GOVT_TAX_DIFF FROM MARINE_DATA_ENDT) A WHERE QUOTE_NO = ?
#GET_COMM_RATE_INFO=SELECT MRD.COMMODITY_ID, MRD.RATE, MRD.WARRATE, MRD.WAREHOUSE_WAREHOUSE, '0', MRD.COMMODITY_EXCESS_PREMIUM,ISNULL (MRD.POLICY_EXCESS_PERCENT, 0) POLICY_EXCESS_PERCENT FROM MARINE_RESULT_DETAILS MRD WHERE MRD.APPLICATION_NO=(SELECT APPLICATION_NO FROM POSITION_MASTER WHERE PDF_MODIFY_CLAUSE IS NOT NULL AND UPPER(PDF_MODIFY_CLAUSE) != 'NOTHING' AND APPLICATION_NO=?)
GET_COMM_RATE_INFO=SELECT MRD.COMMODITY_ID, MRD.RATE, MRD.WARRATE, MRD.WAREHOUSE_WAREHOUSE, '0', MRD.COMMODITY_EXCESS_PREMIUM,ISNULL (MRD.POLICY_EXCESS_PERCENT, 0) POLICY_EXCESS_PERCENT FROM MARINE_RESULT_DETAILS MRD WHERE MRD.APPLICATION_NO=(SELECT APPLICATION_NO FROM POSITION_MASTER WHERE  APPLICATION_NO=?)
GET_ENDT_SI_DIFF_REF=SELECT ? - ( MD2.EQUIVALENT_USD + ISNULL (MD2.TOTAL_SALE_TERM_CHARGES, 0) + ISNULL (MD2.TOTAL_TOLERANCE_CHARGES, 0)) SUMINSURED_DIFF FROM POSITION_MASTER PM1, POSITION_MASTER PM2, MARINE_DATA MD2 WHERE PM1.QUOTE_NO = ? AND PM1.ORIGINAL_POLICY_NO = ISNULL (PM2.ORIGINAL_POLICY_NO, PM2.POLICY_NO) AND PM1.AMEND_ID = PM2.AMEND_ID + 1 AND MD2.APPLICATION_NO = PM2.APPLICATION_NO AND PM2.AMEND_ID = MD2.AMEND_ID
GET_ENDT_SI_DIFF=SELECT ( MD1.EQUIVALENT_USD + ISNULL (MD1.TOTAL_SALE_TERM_CHARGES, 0) + ISNULL (MD1.TOTAL_TOLERANCE_CHARGES, 0)) - ( MD2.EQUIVALENT_USD + ISNULL (MD2.TOTAL_SALE_TERM_CHARGES, 0) + ISNULL (MD2.TOTAL_TOLERANCE_CHARGES, 0)) SUMINSURED_DIFF FROM POSITION_MASTER PM1, MARINE_DATA MD1, POSITION_MASTER PM2, MARINE_DATA MD2 WHERE PM1.QUOTE_NO = ? AND PM1.ORIGINAL_POLICY_NO = ISNULL (PM2.ORIGINAL_POLICY_NO, PM2.POLICY_NO) AND PM1.AMEND_ID = PM2.AMEND_ID + 1 AND MD1.APPLICATION_NO = PM1.APPLICATION_NO AND PM1.AMEND_ID = MD1.AMEND_ID AND MD2.APPLICATION_NO = PM2.APPLICATION_NO AND PM2.AMEND_ID = MD2.AMEND_ID
GET_QUOTE_ENDT_TYPE=SELECT STUFF((SELECT ', '+CONVERT(varchar, W.ENDT_TYPE)  AS[text()]FROM ENDT_TYPE_MASTER W where w.ENDT_TYPE_ID IN (?) FOR XML PATH('')), 1, 2, '')
GET_POL_ENDT_LIST=SELECT ENDT_TYPE FROM ENDT_TYPE_MASTER WHERE ENDT_TYPE_ID IN (?)
GET_ORIGINAL_POLNO=SELECT ISNULL(ORIGINAL_POLICY_NO, OPEN_COVER_NO) FROM OPEN_COVER_POSITION_MASTER ocpm WHERE ocpm.OPEN_COVER_NO=? and ocpm.amend_Id=(select max(amend_id) from OPEN_COVER_POSITION_MASTER ocpm1 where ocpm1.proposal_no = ocpm.proposal_no)
GET_ENDT_POL_INFO=SELECT A.POLICY_NO, convert (varchar,A.INCEPTION_DATE, 103) QUOTATION_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE = (SELECT OA_CODE  FROM LOGIN_MASTER  WHERE LOGIN_ID = A.LOGIN_ID)) BROKER_NAME, (case A.OPEN_COVER_NO  when  '0' then null else A.OPEN_COVER_NO end) OPEN_COVER_NO FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA MD WHERE MD.APPLICATION_NO = A.APPLICATION_NO AND A.QUOTE_NO = ? AND B.CUSTOMER_ID = A.CUSTOMER_ID  and B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO PI WHERE PI.CUSTOMER_ID=B.CUSTOMER_ID )
GET_ENDT_POL=SELECT PM.CUSTOMER_ID,UPPER(PI.TITLE+ ' ' +' '+ ' ' +PI.FIRST_NAME) CUST_FIRST_NAME,PI.POBOX CUST_POBOX,UPPER(PI.COMPANY_NAME) CUST_COMPANY,UPPER(PI.LAST_NAME) CUST_LAST_NAME, UPPER(PI.ADDRESS1) CUST_ADDR1,UPPER(PI.ADDRESS2) CUST_ADDR2,PI.TELEPHONE CUST_TEL,UPPER(PI.COUNTRY) CUST_COUNTRY,UPPER(ISNULL(PI.CITY,PI.EMIRATE)) CUST_CITY, BM.BRANCH_CODE, BM.BRANCH_NAME, ISNULL (BM.ORIGINATION_COUNTRY_ID, 0) ORIGINATION_COUNTRY_ID, BM.CURRENCY_ABBREVIATION, ISNULL (BM.DECIMAL_PLACES, 0) DECIMAL_PLACES, BM.HEADER_IMG, BM.FOOTER_IMG, BM.SIGN_IMG, BM.STAMP, BM.CURRENCY_NAME, ISNULL (BM.CURRENCY_ACRONYM, ' ') CURRENCY_ACRONYM, BM.CURRENCY_DECIMAL_NAME, BM.CURRENCY_DECIMAL_DIGIT, BM.ADDRESS1, BM.REMARKS, CR.COVER_NAME, (CASE WHEN PM.PRODUCT_ID = '11' AND PM.PDF_BANKER_ASSURED_STATUS = 'YES' THEN SELECT FN_GET_CODE  ('BNAME', MD.OPEN_BANK_ID, NULL, NULL) WHEN PM.PRODUCT_ID = '3' AND PM.PDF_BANKER_ASSURED_STATUS = 'YES' THEN MPD.BANK_NAME ELSE NULL END) ASSURED, PM.ORIGINAL_POLICY_NO, PI.FIRST_NAME CUST_NAME, PM.AMEND_ID ENDT_NO, convert (varchar(10),PM.INCEPTION_DATE, 103) POLICY_DATE, EMD.PREV_SUMINSURED, EMD.SUMINSURED, (CASE WHEN MD.WAREHOUSE_TO_WAREHOUSE = 'YES' THEN convert(varchar,MD.TRANSIT_FROM) + ' ' + ',' + ' ' + (SELECT FN_GET_CODE  ('CNAME', to_char(MD.TRANSIT_FROM_COUNTRY_ID), NULL, NULL)) ELSE (SELECT FN_GET_CODE  ('CNAME', convert(varchar,MD.TRANSIT_FROM_COUNTRY_ID), NULL, NULL) END)) + ' ' + ' To ' + ' ' + (CASE WHEN MD.WARE_TO_WARE_FINAL_DEST = 'YES' THEN convert(varchar,MD.FINAL_DESTINATION) + ' ' + ',' + ' ' + (SELECT FN_GET_CODE  ('CNAME', convert(varchar,MD.FINAL_DESTINATION_COUNTRY_ID), NULL, NULL)) ELSE (SELECT FN_GET_CODE  ('CNAME', convert(varchar,MD.FINAL_DESTINATION_COUNTRY_ID), NULL, NULL)) END) VOYAGE, CASE WHEN SM.SALE_TERM_VALUE = 0 AND ISNULL (TM.TOLERANCE_NAME, '0') = '0' THEN substring(SM.SALE_TERM_NAME,1,(select dbo.INSTR(SM.SALE_TERM_NAME,'+',1,1))) WHEN SM.SALE_TERM_VALUE = 0 AND ISNULL (TM.TOLERANCE_NAME, '0') = 'NONE' THEN substring(SM.SALE_TERM_NAME,1,(select dbo.INSTR(SM.SALE_TERM_NAME,'+',1,1))) WHEN SM.SALE_TERM_VALUE = 0 AND ISNULL (TM.TOLERANCE_NAME, '0') != 'NONE' THEN substring(SM.SALE_TERM_NAME,1,(select dbo.INSTR(SM.SALE_TERM_NAME,'+',1,1))) + ' ' + '+' + ' ' + TM.TOLERANCE_NAME WHEN SM.SALE_TERM_VALUE > 0 AND ISNULL (TM.TOLERANCE_NAME, '0') = 'NONE' THEN SM.SALE_TERM_NAME WHEN SM.SALE_TERM_VALUE > 0 AND ISNULL (TM.TOLERANCE_NAME, '0') != 'NONE' THEN SM.SALE_TERM_NAME + ' ' + '+' + ' ' + TM.TOLERANCE_NAME ELSE SM.SALE_TERM_NAME END BASIS_OF_VAL, CO.CONVDESC CONVEYANCE, CM.CURRENCY_NAME CURRENCY, (CASE WHEN PM.PRODUCT_ID = '11' THEN (select FN_GET_CODE ('LCNO', MD.OPEN_LC_ID, NULL, NULL)) ELSE convert(varchar,MPD.LC_NUMBER) END) LC_NUMBER, (CASE WHEN PM.PRODUCT_ID = '11' THEN (select FN_GET_CODE ('BNAME', MD.OPEN_BANK_ID, NULL, NULL)) ELSE MPD.BANK_NAME END) BANK_NAME, MPD.BL_AWB_NO, (case  isnull(SAM.SETTLING_AGENT_ID,0) when 0 then MPD.SETTLING_AGENT_NAME else AM.SETTLING_AGENT_NAME end) SETTLING_AGENT, MD.EXTRA_COVER_ID, isnull(convert (varchar,MRD.WARRATE), '0.999999') WARRATE, isnull(convert (varchar,MRD.RATE), '0.999999') RATE, EMD.TOTAL_PREMIUM PREMIUM, EMD.MARINE_PREMIUM, EMD.WAR_PREMIUM, EMD.TOTAL_MARINE_WAR TOTAL, EMD.PREV_MARINE_WAR_PREMIUM LESS_PREMIUM, EMD.FINAL_TOTAL_MARINE_WAR FINAL_TOTAL, EMD.EXCESS_PREMIUM, EMD.POLICY_FEE, EMD.NET_PREMIUM, (CASE WHEN MD.EXTRA_COVER_ID != 0 THEN 'Yes with Rate ' + ' ' + isnull(convert (varchar,MRD.WARRATE), '0.999999') + ' ' + '%' ELSE NULL END) WSRCC, PM.PDF_STAMP_STATUS, PM.PRODUCT_ID,PM.ENDT_PREM_YN,PM.ENDT_CLAUSES_YN FROM POSITION_MASTER PM JOIN BRANCH_MASTER BM ON BM.BRANCH_CODE = ? JOIN (SELECT QUOTE_NO, POLICY_NO, APPLICATION_NO, EQUIVALENT_USD + ISNULL (TOTAL_SALE_TERM_CHARGES, 0) + ISNULL (TOTAL_TOLERANCE_CHARGES, 0) SUMINSURED, LAG ( EQUIVALENT_USD + ISNULL (TOTAL_SALE_TERM_CHARGES, 0) + ISNULL (TOTAL_TOLERANCE_CHARGES, 0), 1, 0 ) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) PREV_SUMINSURED, PREMIUM - ISNULL (TOTAL_WAR_CHARGES, 0) - ISNULL (POLICY_FEE, 0) MARINE_PREMIUM, ISNULL (TOTAL_WAR_CHARGES, 0) WAR_PREMIUM, ISNULL (EXCESS_PREMIUM, 0) EXCESS_PREMIUM, ISNULL (POLICY_FEE, 0) POLICY_FEE, PREMIUM - ISNULL (POLICY_FEE, 0) TOTAL_MARINE_WAR, PREMIUM + ISNULL (EXCESS_PREMIUM, 0) TOTAL_PREMIUM, LAG (PREMIUM - ISNULL (POLICY_FEE, 0) - ISNULL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) PREV_MARINE_WAR_PREMIUM, (PREMIUM - ISNULL (POLICY_FEE, 0)) - LAG (PREMIUM - ISNULL (POLICY_FEE, 0) - ISNULL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) FINAL_TOTAL_MARINE_WAR, (PREMIUM - ISNULL (POLICY_FEE, 0)) - LAG (PREMIUM - ISNULL (POLICY_FEE, 0) - ISNULL (EXCESS_PREMIUM, 0), 1, 0) OVER (ORDER BY ORIGINAL_POLICY_NO, ENDT_NO) + ISNULL (EXCESS_PREMIUM, 0) + ISNULL (POLICY_FEE, 0) NET_PREMIUM FROM MARINE_DATA_ENDT) EMD ON EMD.POLICY_NO = PM.POLICY_NO JOIN MARINE_DATA MD ON MD.APPLICATION_NO = PM.APPLICATION_NO AND PM.AMEND_ID = MD.AMEND_ID JOIN MARINE_POLICY_DETAILS MPD ON PM.QUOTE_NO = MPD.QUOTE_NO AND PM.AMEND_ID = MPD.AMEND_ID JOIN ( SELECT APPLICATION_NO, AMEND_ID, SUM (RATE) RATE, SUM (WARRATE) WARRATE FROM MARINE_RESULT_DETAILS GROUP BY APPLICATION_NO, AMEND_ID) MRD ON MRD.APPLICATION_NO = PM.APPLICATION_NO AND PM.AMEND_ID = MRD.AMEND_ID JOIN CURRENCY_MASTER CM ON MD.CURRENCY_ID = CM.CURRENCY_ID JOIN PERSONAL_INFO PI ON PI.CUSTOMER_ID = PM.CUSTOMER_ID JOIN SALE_TERM_MASTER SM ON SM.SALE_TERM_ID = MD.SALE_TERM_ID AND SM.BRANCH_CODE = BM.BRANCH_CODE JOIN TOLERANCE_MASTER TM ON TM.TOLERANCE_ID = MD.TOLERANCE_ID AND TM.BRANCH_CODE = BM.BRANCH_CODE JOIN COVER_MASTER CR ON CR.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT AND CR.COVER_ID = MD.COVER_ID AND CR.BRANCH_CODE = BM.BRANCH_CODE AND  (CR.EFFECTIVE_DATE) <=  (SYSDATETIME()) LEFT OUTER JOIN CONVEYAN_MASTER CO ON CO.SNO = MD.SEA_OPTIONS AND CO.BRANCH_CODE = BM.BRANCH_CODE AND CO.MODE_TRANSPORT_ID = MD.MODE_OF_TRANSPORT LEFT OUTER JOIN SETTLING_AGENT_MASTER SAM ON SAM.SETTLING_AGENT_ID = MPD.SETTLING_AGENT_ID AND SAM.BELONGING_COUNTRY_ID = BM.ORIGINATION_COUNTRY_ID  WHERE PM.POLICY_NO = ? AND CM.AMEND_ID = (SELECT MAX (AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID = CM.CURRENCY_ID) AND PI.AMEND_ID = (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = PI.CUSTOMER_ID) AND CR.AMEND_ID = (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID = CR.COVER_ID AND BRANCH_CODE = CR.BRANCH_CODE AND  (EFFECTIVE_DATE) <=  (SYSDATETIME()))
GET_POL_DEDUCT=SELECT MRD.COMMODITY_EXCESS_PREMIUM, MRD.DESCRIPTION, (SELECT CURRENCY_NAME FROM OPEN_COVER_DEDUCTIBLE_MASTER A, OPEN_COVER_POSITION_MASTER B WHERE ISNULL (SUMINSUREDLOCAL, 0) + ISNULL (SALE_TERM_CHARGES, 0) + ISNULL (TOLERANCE_CHARGES, 0) BETWEEN A.START_RANGE AND A.END_RANGE AND A.OPEN_COVER_PROPOSAL_NO = B.PROPOSAL_NO AND B.OPEN_COVER_NO = PM.OPEN_COVER_NO AND A.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DEDUCTIBLE_MASTER WHERE OPEN_COVER_PROPOSAL_NO = A.OPEN_COVER_PROPOSAL_NO)) CURRENCY_NAME FROM MARINE_RESULT_DETAILS MRD, POSITION_MASTER PM WHERE MRD. APPLICATION_NO =PM.APPLICATION_NO AND PM.APPLICATION_NO=? AND COMMODITY_EXCESS_PREMIUM > 0
CNT_POL_ENDT=SELECT COUNT(1) FROM POSITION_MASTER WHERE APPLICATION_NO\=? AND ENDT_STATUS\='Y'
CNT_ENDT_FINANCIAL=SELECT COUNT(*) FROM ENDT_TYPE_MASTER WHERE ENDT_TYPE_CATEGORY_ID\=2 AND ENDT_TYPE_ID IN (?)
CNT_ENDT_POL_FEE=SELECT COUNT(*) FROM MARINE_DATA WHERE APPLICATION_NO=? AND ISNULL(PREMIUM,0)+ISNULL(EXCESS_PREMIUM,0)!=0
CAL_UPD_ENDT_PRE={CALL ENDT_PREMIUM_CALCULATION(?)}
DEL_ENDT_MD=DELETE FROM MARINE_DATA_ENDT WHERE APPLICATION_NO=?
DEL_ENDT_MRD=DELETE FROM MARINE_RESULT_DETAILS_ENDT WHERE APPLICATION_NO\=?
UPD_ENDT_STS=UPDATE POSITION_MASTER A SET A.ENDT_STATUS = 'N', A.POLICY_NO=NULL WHERE A.APPLICATION_NO = ?
UPD_ENDT_STS_REJ=UPDATE POSITION_MASTER A SET A.ENDT_STATUS \= 'Y' WHERE A.POLICY_NO \= ( SELECT PM1.POLICY_NO FROM POSITION_MASTER PM1,POSITION_MASTER PM2 WHERE PM2.APPLICATION_NO \= ? AND ISNULL(PM2.ORIGINAL_POLICY_NO ,PM2.POLICY_NO) \= ISNULL(PM1.ORIGINAL_POLICY_NO,PM1.POLICY_NO) AND PM1.AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE ENDT_STATUS\='N' AND STATUS\='P' AND ISNULL(ORIGINAL_POLICY_NO ,POLICY_NO)\=ISNULL(PM1.ORIGINAL_POLICY_NO ,PM1.POLICY_NO)))
#UPD_ENDT_MD_FEE=UPDATE MARINE_DATA_ENDT SET PREMIUM=PREMIUM+?, POLICY_FEE=? WHERE APPLICATION_NO=?
UPD_ENDT_MD_FEE=UPDATE MARINE_DATA_ENDT SET POLICY_FEE=?,govt_tax=? WHERE APPLICATION_NO=?
#UPD_MD_FEE=UPDATE MARINE_DATA SET PREMIUM=PREMIUM+?, POLICY_FEE=? WHERE APPLICATION_NO=?
UPD_MD_FEE=UPDATE MARINE_DATA SET POLICY_FEE=?,govt_tax=? WHERE APPLICATION_NO=?
#UPD_PM_FEE=UPDATE POSITION_MASTER SET PREMIUM\=PREMIUM+?+? WHERE APPLICATION_NO\=?
UPD_PM_FEE=UPDATE POSITION_MASTER SET PREMIUM\=PREMIUM+?+? WHERE APPLICATION_NO\=?
GET_QUOTE_ISSUER=SELECT APPLICATION_ID FROM POSITION_MASTER WHERE APPLICATION_NO\=?
GET_OC_INFO=SELECT ISNULL(A.ORIGINAL_POLICY_NO,A.OPEN_COVER_NO) OPEN_COVER_NO,ISNULL(B.FIRST_NAME,B.COMPANY_NAME) CUSTOMER_NAME, (SELECT COMPANY_NAME FROM BROKER_COMPANY_MASTER  WHERE AGENCY_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID =C.BROKER_ID)) BROKER_NAME FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO B, OPEN_COVER_MASTER C  WHERE A.OPEN_COVER_NO=?  AND B.CUSTOMER_ID = C.CUSTOMER_ID AND C.PROPOSAL_NO=A.PROPOSAL_NO  AND C.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO) AND A.AMEND_ID = (SELECT MAX(AMEND_ID) FROM   OPEN_COVER_POSITION_MASTER WHERE   PROPOSAL_NO = A.PROPOSAL_NO)
GET_COMMODITY_LIST_OC=SELECT COMMODITY_NAME_DESC FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO\=(SELECT PROPOSAL_NO FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO\=?)
UPD_XL_OPENCOVER_RAW_UPLOAD=UPDATE xl_opencover_raw SET SR_NO\=?, INTEREST \= ?, CONVEYANCE \= (SELECT distinct(TRANSPORT_DESCRIPTION) FROM MODE_OF_TRANSPORT MOT WHERE MODE_TRANSPORT_ID \= ? AND status \= 'Y' AND MOT.BRANCH_CODE\=?), COVER \= (SELECT distinct(COVER_NAME) FROM COVER_MASTER WHERE COVER_ID \= ? AND STATUS \= 'Y' AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= ?)), VOYAGE_FROM \= ?, VOYAGE_TO \= ?, CURRENCY \= ?, INCOTERMS \= (SELECT DISTINCT SUBSTRING(SALE_TERM_NAME,1,INSTR(SALE_TERM_NAME, '+',1,1)-1) FROM sale_term_master WHERE Branch_code \= ? AND rsacode \= ?), BASIS_OF_VALUATION \=( select SALE_TERM_NAME+ ' ' +TOLERANCE_NAME NAME from (select rownum rn,SALE_TERM_ID,SALE_TERM_NAME from sale_term_master where SALE_TERM_ID\=? and branch_code\=? and status\='Y') left outer join (select rownum rn1,tolerance_id,(case TOLERANCE_NAME when 'NONE' then '' else '+'+' '+TOLERANCE_NAME end) TOLERANCE_NAME from tolerance_master where tolerance_id\=? and branch_code\=? and status\='Y') on rn\=rn1), PACKAGE_DESCRIPTION \= ?, COMMODITY_DESCRIPTION \= ?, WSRCC\=?, VALIDATION_ERROR\=?, VALIDATION_STATUS\='', PACKING_DETAILS\='' WHERE TRANSACTION_ID\=? AND SNO \=?
UPD_XL_OPENCOVER_ARC_UPLOAD=UPDATE xl_opencover_arc SET SR_NO\=?, INTEREST \= ?, CONVEYANCE \= (SELECT distinct(TRANSPORT_DESCRIPTION) FROM MODE_OF_TRANSPORT MOT WHERE MODE_TRANSPORT_ID \= ? AND status \= 'Y' AND MOT.BRANCH_CODE\=?), COVER \= (SELECT distinct(COVER_NAME) FROM COVER_MASTER WHERE COVER_ID \= ? AND STATUS \= 'Y' AND AMEND_ID \= (SELECT MAX (AMEND_ID) FROM COVER_MASTER WHERE COVER_ID \= ?)), VOYAGE_FROM \= ?, VOYAGE_TO \= ?, CURRENCY \= ?, INCOTERMS \= (SELECT DISTINCT SUBSTRING(SALE_TERM_NAME,1,INSTR(SALE_TERM_NAME, '+',1,1)-1) FROM sale_term_master WHERE Branch_code \= ? AND rsacode \= ?), BASIS_OF_VALUATION \=( select SALE_TERM_NAME+ ' ' +TOLERANCE_NAME NAME from (select rownum rn,SALE_TERM_ID,SALE_TERM_NAME from sale_term_master where SALE_TERM_ID\=? and branch_code\=? and status\='Y') left outer join (select rownum rn1,tolerance_id,(case TOLERANCE_NAME when 'NONE' then '' else '+'+' '+TOLERANCE_NAME end) TOLERANCE_NAME from tolerance_master where tolerance_id\=? and branch_code\=? and status\='Y') on rn\=rn1), PACKAGE_DESCRIPTION \= ?, COMMODITY_DESCRIPTION \= ?, WSRCC\=?, VALIDATION_ERROR\=?, VALIDATION_STATUS\='', PACKING_DETAILS\='' WHERE TRANSACTION_ID\=? AND SNO \=?
GET_WARYN_OPENCOVER=select WRSC_YN from OPEN_COVER_MASTER where PROPOSAL_NO=(select PROPOSAL_NO from OPEN_COVER_POSITION_MASTER where OPEN_COVER_NO=?)


#HOME INSURANCE 
INS_OFS_DATA=insert into OFS_DATA(QUOTE_NO,AMEND_ID,CUSTOMER_ID,INSURED_ADDRESS_DIFFERENT,ADDRESS1,POBOX,COUNTRY,EMIRATE,FREEZONE,CONTENT_VALUE,CONTENT_VALUE_OTHERS,CLAIM_STATUS,LAST_YEARS_1,LAST_YEARS_2,LAST_YEARS_3,AMOUNT_1,AMOUNT_2,AMOUNT_3,INCEPTION_DATE,ENTRY_DATE,APPLICATION_NO,STATUS,ACTIVITY_PROFESSION,ACTIVITY_STATUS,EXPIRY_DATE,PROF_OTHERS,FREEZONE_OTHERS,CONTENT_STATUS,NO_OF_CLAIM1,NO_OF_CLAIM2,NO_OF_CLAIM3,TELEPHONE,EMAIL) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATETIME(),SYSDATETIME(),?,?,?,?,dateadd(day,-1,dateadd(month,12,SYSDATETIME())),?,?,?,?,?,?,?,?)
UPD_OFS_DATA=UPDATE OFS_DATA SET AMEND_ID=?, CUSTOMER_ID=?, INSURED_ADDRESS_DIFFERENT=?, ADDRESS1=?, POBOX=?, COUNTRY=?, EMIRATE=?, FREEZONE=?, CONTENT_VALUE=?, CONTENT_VALUE_OTHERS=?, CLAIM_STATUS=?, LAST_YEARS_1=?, LAST_YEARS_2=?, LAST_YEARS_3=?, AMOUNT_1=?, AMOUNT_2=?, AMOUNT_3=?,  INCEPTION_DATE=SYSDATETIME(), ENTRY_DATE=SYSDATETIME(),  APPLICATION_NO=?, STATUS=?, ACTIVITY_PROFESSION=?, ACTIVITY_STATUS=?, EXPIRY_DATE= (ADD_MONTHS (TO_DATE (SYSDATETIME()), 12) - 1), PROF_OTHERS=?, FREEZONE_OTHERS=?, CONTENT_STATUS=?, NO_OF_CLAIM1=?, NO_OF_CLAIM2=?, NO_OF_CLAIM3=?, TELEPHONE=?, EMAIL=? WHERE QUOTE_NO=?
GET_HOME_INFO=SELECT distinct(d.CALC_TYPE) GRID_CALC_TYPE, b.CALC_TYPE, a.coverages_id,a.coverages_name,b.coverages_type,a.coverages_display_name,b.display_order,b.MULTIPLE_ROWS,b.sub_coverages,b.control_type, b.CALC_STATUS, c.coverages_suminsured SUM_INSURED,trim(convert(varchar,ISNULL(c.coverages_suminsured,0),'999G999G999G999G999G999G999G999G999G990')) COVERAGES_SUMINSURED, ISNULL(c.coverages_base_rate,b.BASE_RATE) coverages_base_rate, b.BASE_RATE, b.help_contents_id,c.coverages_y_n_option, b.calc_status,  b.sum_insured_limit,  b.sum_insured_control_type,b.coverages_limit, c.PREMIUM_AMOUNT, d.amend_id, b.UPLOAD_OPTION FROM  OFS_MASTER a JOIN OFS_COVERAGES_MASTER b ON a.COVERAGES_ID = b.COVERAGES_ID AND b.CONTENT_TYPE_ID = ? LEFT OUTER JOIN OFS_DATA_DETAILS c  ON b.content_type_id = c.content_type_id AND a.COVERAGES_ID = c.COVERAGES_ID AND b.scheme_id = c.scheme_id AND b.product_id = c.product_id AND c.quote_no = ISNULL (?, 0) LEFT OUTER JOIN OFS_GRID_MASTER d ON b.content_type_id = d.content_type_id AND b.COVERAGES_ID = d.COVERAGES_ID AND b.scheme_id = d.scheme_id AND coverages_sub_id='0' and d.status='Y' AND b.product_id = d.product_id AND d.amend_id + ' ' + d.coverages_id + ' ' + d.coverages_sub_id IN (SELECT MAX (amend_id) + ' ' + coverages_id + ' ' + coverages_sub_id FROM OFS_GRID_MASTER WHERE CONTENT_TYPE_ID = ? AND product_id = ? AND scheme_id = ? AND coverages_sub_id='0' and status='Y' GROUP BY coverages_id, coverages_sub_id) WHERE   b.product_id =? AND b.scheme_id = ? AND b.status = 'Y' AND B.CONTENT_TYPE_ID = ? AND b.amend_id = (SELECT MAX (amend_id) FROM OFS_COVERAGES_MASTER WHERE product_id = ? AND scheme_id = ? AND CONTENT_TYPE_ID =? AND coverages_id = b.coverages_id) order by COVERAGES_TYPE,display_order
GET_UPLOAD_LIST=SELECT distinct(d.CALC_TYPE) GRID_CALC_TYPE, b.CALC_TYPE, a.coverages_id,a.coverages_name,b.coverages_type,a.coverages_display_name,b.display_order,b.MULTIPLE_ROWS,b.sub_coverages,b.control_type, b.CALC_STATUS, c.coverages_suminsured SUM_INSURED,ISNULL(c.coverages_base_rate,b.BASE_RATE) coverages_base_rate, b.BASE_RATE, b.help_contents_id,c.coverages_y_n_option, b.calc_status,  b.sum_insured_limit,  b.sum_insured_control_type,b.coverages_limit, c.PREMIUM_AMOUNT, d.amend_id, b.UPLOAD_OPTION FROM  OFS_MASTER a JOIN OFS_COVERAGES_MASTER b ON a.COVERAGES_ID = b.COVERAGES_ID AND b.CONTENT_TYPE_ID = ? LEFT OUTER JOIN OFS_DATA_DETAILS c  ON b.content_type_id = c.content_type_id AND a.COVERAGES_ID = c.COVERAGES_ID AND b.scheme_id = c.scheme_id AND b.product_id = c.product_id AND c.quote_no = ISNULL (?, 0) LEFT OUTER JOIN OFS_GRID_MASTER d ON b.content_type_id = d.content_type_id AND b.COVERAGES_ID = d.COVERAGES_ID AND b.scheme_id = d.scheme_id AND coverages_sub_id='0' and d.status='Y' AND b.product_id = d.product_id AND d.amend_id + ' ' + d.coverages_id + ' ' + d.coverages_sub_id IN (SELECT MAX (amend_id) + ' ' + coverages_id + ' ' + coverages_sub_id FROM OFS_GRID_MASTER WHERE CONTENT_TYPE_ID = ? AND product_id = ? AND scheme_id = ? AND coverages_sub_id='0' and status='Y' GROUP BY coverages_id, coverages_sub_id) WHERE   b.product_id =? AND b.scheme_id = ? AND b.status = 'Y' AND B.CONTENT_TYPE_ID = ? AND b.amend_id = (SELECT MAX (amend_id) FROM OFS_COVERAGES_MASTER WHERE product_id = ? AND scheme_id = ? AND CONTENT_TYPE_ID =? AND coverages_id = b.coverages_id) AND b.UPLOAD_OPTION = 'Y' and c.coverages_suminsured is not null order by COVERAGES_TYPE,display_order
GET_SUB_UPLOADCOVER_LIST = SELECT ofm.coverages_name, ofm.COVERAGES_DISPLAY_NAME,ofd.quote_no,ofd.coverages_id,ofd.coverages_sub_id,ofd.premium_amount,ofd.coverages_covered_employees, ofd.coverages_sub_base_rate, ofsm.SUB_COVERAGES_LIMIT, ofsm.SUB_RATE, ofsm.SUB_CONTROL_TYPE, ofsm.CALC_TYPE, ofsm.SUM_INSURED_LIMIT, ofsm.MIN_SUM_INSURED, ofsm.SUB_NEWCONTROL_TYPE, ofgm.CALC_TYPE grid_calc_type, ofsm.MULTIPLE_ROWS, ofsm.UPLOAD_OPTION, ofsm.AMEND_ID FROM ofs_data_sub_details ofd JOIN ofs_master ofm ON ofd.coverages_sub_id \= ofm.coverages_id JOIN ofs_coverages_sub_master ofsm ON ofd.coverages_id \= ofsm.coverages_id AND ofd.COVERAGES_SUB_ID \= ofsm.COVERAGES_SUB_ID AND ofd.SCHEME_ID \= ofsm.SCHEME_ID AND ofd.CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID AND ofsm.UPLOAD_OPTION \= 'Y' AND ofsm.amend_id \= (SELECT MAX (amend_id) FROM ofs_coverages_sub_master WHERE coverages_id \= ofsm.coverages_id AND COVERAGES_SUB_ID \= ofsm.COVERAGES_SUB_ID AND SCHEME_ID \= ofsm.SCHEME_ID AND CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID) AND ofd.quote_no\= ? AND ofd.amend_id \= (SELECT MAX (amend_id) FROM ofs_data_sub_details WHERE quote_no \= ofd.quote_no AND COVERAGES_SUB_ID \= ofd.COVERAGES_SUB_ID) AND ofd.status \= 'Y' LEFT OUTER JOIN (SELECT * FROM ofs_grid_master OFS WHERE amend_id \= (SELECT MAX (amend_id) FROM ofs_grid_master WHERE coverages_id \= OFS.coverages_id AND COVERAGES_SUB_ID \= OFS.COVERAGES_SUB_ID)) ofgm ON ( ofgm.CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID AND ofgm.coverages_id \= ofsm.coverages_id AND ofgm.coverages_SUB_id \= ofsm.coverages_SUB_id AND ofgm.STATUS \= 'Y')  order by SUB_DISPLAY_ORDER
GET_HOME_SUBPREMIUM=SELECT ofm.coverages_name, ofm.COVERAGES_DISPLAY_NAME,ofd.quote_no,ofd.coverages_id,ofd.coverages_sub_id,ofd.premium_amount,ofd.coverages_covered_employees, trim(convert(varchar,ISNULL(ofd.coverages_covered_employees,0),'999G999G999G999G999G999G999G999G999G990')) COVERAGES_COVERED_EMPLOYEES1, ofd.coverages_sub_base_rate, ofsm.SUB_COVERAGES_LIMIT, ofsm.SUB_RATE, ofsm.SUB_CONTROL_TYPE, ofsm.CALC_TYPE, ofsm.SUM_INSURED_LIMIT, ofsm.MIN_SUM_INSURED, ofsm.SUB_NEWCONTROL_TYPE, ofgm.CALC_TYPE grid_calc_type, ofsm.MULTIPLE_ROWS, ofsm.AMEND_ID FROM ofs_data_sub_details ofd JOIN ofs_master ofm ON ofd.coverages_sub_id \= ofm.coverages_id JOIN ofs_coverages_sub_master ofsm ON ofd.coverages_id \= ofsm.coverages_id AND ofd.COVERAGES_SUB_ID \= ofsm.COVERAGES_SUB_ID AND ofd.SCHEME_ID \= ofsm.SCHEME_ID AND ofd.CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID AND ofsm.amend_id \= (SELECT MAX (amend_id) FROM ofs_coverages_sub_master WHERE coverages_id \= ofsm.coverages_id AND COVERAGES_SUB_ID \= ofsm.COVERAGES_SUB_ID AND SCHEME_ID \= ofsm.SCHEME_ID AND CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID) AND ofd.quote_no\= ? AND ofd.amend_id \= (SELECT MAX (amend_id) FROM ofs_data_sub_details WHERE quote_no \= ofd.quote_no AND COVERAGES_SUB_ID \= ofd.COVERAGES_SUB_ID) AND ofd.status \= 'Y' LEFT OUTER JOIN (SELECT * FROM ofs_grid_master OFS WHERE amend_id \= (SELECT MAX (amend_id) FROM ofs_grid_master WHERE coverages_id \= OFS.coverages_id AND COVERAGES_SUB_ID \= OFS.COVERAGES_SUB_ID)) ofgm ON ( ofgm.CONTENT_TYPE_ID \= ofsm.CONTENT_TYPE_ID AND ofgm.coverages_id \= ofsm.coverages_id AND ofgm.coverages_SUB_id \= ofsm.coverages_SUB_id AND ofgm.STATUS \= 'Y') order by SUB_DISPLAY_ORDER 
GET_SUB_HOME_INFO=select a.COVERAGES_SUB_ID,a.COVERAGES_ID,b.COVERAGES_DISPLAY_NAME coverages_name,a.MULTIPLE_ROWS,a.SUB_COVERAGES_LIMIT,a.SUB_RATE, a.PRODUCT_ID,a.SUB_CONTROL_TYPE,a.SUB_DISPLAY_ORDER,a.CALC_TYPE,a.REMARKS,a.SUM_INSURED_LIMIT, c.PREMIUM_AMOUNT, c.COVERAGES_COVERED_EMPLOYEES, c.COVERAGES_SUB_BASE_RATE, d.CALC_TYPE GRID_CALC_TYPE, d.amend_id FROM OFS_MASTER b JOIN OFS_COVERAGES_SUB_MASTER a ON a.COVERAGES_sub_ID \= b.COVERAGES_ID AND a.CONTENT_TYPE_ID \=? LEFT OUTER JOIN OFS_DATA_SUB_DETAILS c ON a.content_type_id \= c.content_type_id AND a.COVERAGES_ID \= c.COVERAGES_ID AND a.COVERAGES_SUB_ID \= c.COVERAGES_SUB_ID AND a.scheme_id \= c.scheme_id AND a.product_id \= c.product_id AND c.quote_no \= ISNULL (?, 0) LEFT OUTER JOIN OFS_GRID_MASTER d ON a.content_type_id \= d.content_type_id AND a.COVERAGES_ID \= d.COVERAGES_ID AND a.COVERAGES_SUB_ID \= d.COVERAGES_SUB_ID AND a.scheme_id \= d.scheme_id AND a.product_id \= d.product_id AND d.amend_id + ' ' + d.coverages_id + ' ' + d.coverages_sub_id IN (SELECT MAX (amend_id) + ' ' + coverages_id + ' ' + coverages_sub_id FROM OFS_GRID_MASTER WHERE CONTENT_TYPE_ID \= ? AND product_id \=? AND scheme_id \=? GROUP BY coverages_id, coverages_sub_id) WHERE a.product_id\=? AND a.scheme_id\=? AND a.status \= 'Y' AND a.CONTENT_TYPE_ID\=? AND a.amend_id \=( SELECT MAX (amend_id) FROM OFS_COVERAGES_SUB_MASTER WHERE product_id\=? AND scheme_id\=? AND CONTENT_TYPE_ID\=? AND coverages_id \= a.coverages_id and COVERAGES_SUB_ID\=a.COVERAGES_SUB_ID) order by SUB_DISPLAY_ORDER
GET_HOME_REFERRAL_STATUS=select ADMIN_REFERRAL_STATUS,REFERRAL_DESCRIPTION from HOME_POSITION_MASTER where quote_no\=? and product_id\=? and scheme_id\=?
GET_HOME_EXIST=select max(amend_id) from OFS_DATA_DETAILS where quote_no=? and product_id=? and scheme_id=?
DELETE_HOME_EXIST=delete from OFS_DATA_DETAILS where  product_id=? and scheme_id=? and quote_no=?  and amend_id=?
INSERT_HOME_DATA=insert into OFS_DATA_DETAILS(quote_no,amend_id,coverages_id,coverages_suminsured,premium_amount,COVERAGES_Y_N_OPTION,COVERAGES_BASE_RATE,status,product_id,scheme_id,content_type_id) values(?,?,?,?,?,?,?,?,?,?,?)
UPDATE_HOME_DATA=UPDATE OFS_DATA_DETAILS SET AMEND_ID=?, COVERAGES_SUMINSURED=?, PREMIUM_AMOUNT=?,COVERAGES_Y_N_OPTION=?,COVERAGES_BASE_RATE=?, STATUS=? where QUOTE_NO=? and COVERAGES_ID=? and SCHEME_ID=? and CONTENT_TYPE_ID=? and PRODUCT_ID=?
GET_HOME_EXIST_OPTIONAL=select max(amend_id) from OFS_DATA_SUB_DETAILS where quote_no=? and product_id=? and scheme_id=?
DELETE_HOME_EXIST_OPTIONAL=delete from OFS_DATA_SUB_DETAILS where  product_id=? and scheme_id=? and quote_no=?  and amend_id=?
INSERT_HOME_DATA_OPTIONAL=insert into OFS_DATA_SUB_DETAILS(quote_no,amend_id,coverages_id,COVERAGES_SUB_ID,coverages_covered_amount,premium_amount,coverages_covered_employees,COVERAGES_SUB_BASE_RATE,status,product_id,scheme_id,content_type_id) values(?,?,?,?,?,?,?,?,?,?,?,?)
GET_HOME_MIN_PREMIUM=select minimum_premium from OFS_CONTENT_MASTER where  product_id=? and scheme_id=? and CONTENT_TYPE_ID=?
GET_HOME_MIN_PREMIUM_BROKER=select c.min_premium_amount from home_position_master a,login_master b,LOGIN_USER_DETAILS c where a.quote_no\=? and a.product_id\=? and c.scheme_id\=? and a.login_id\=b.login_id and b.oa_code\=c.agency_code and c.product_id\=a.product_id 
GET_HOME_APPLICATION_NO=SELECT HOME_APPLICATIONNO_01.NEXTVAL FROM DUAL
GET_HOME_QUOTE_NO=SELECT HOME_QUOTENO_01.NEXTVAL FROM DUAL
INS_HOME_DTL=INSERT INTO HOME_POSITION_MASTER (QUOTE_NO,CUSTOMER_ID,LOGIN_ID,PRODUCT_ID,COMPANY_ID,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,APPLICATION_NO,STATUS,SCHEME_ID,CONTENT_TYPE_ID,APPLICATION_ID) values(?,?,?,?,?,?,SYSDATETIME(),DATEADD(DAY,364,SYSDATETIME()),DATEADD(DAY,30,SYSDATETIME()),SYSDATETIME(),?,?,?,?,?)
UPD_HOME_DTL=UPDATE HOME_POSITION_MASTER SET CUSTOMER_ID=?, LOGIN_ID=?, PRODUCT_ID=?, COMPANY_ID=?, AMEND_ID=?, INCEPTION_DATE=SYSDATETIME(), EXPIRY_DATE=DATEADD(DAY,364,SYSDATETIME()), EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()), ENTRY_DATE=SYSDATETIME(), APPLICATION_NO=?, STATUS=?, SCHEME_ID=?, CONTENT_TYPE_ID=? WHERE QUOTE_NO=?
GET_QUOTE_INFO=SELECT PRODUCT_ID,SCHEME_ID,CONTENT_TYPE_ID FROM HOME_POSITION_MASTER WHERE QUOTE_NO=?
GET_PREMIUM_INFO=SELECT OFM.COVERAGES_DISPLAY_NAME,ODD.COVERAGES_SUMINSURED,ODD.COVERAGES_ID,ODD.PREMIUM_AMOUNT FROM OFS_MASTER OFM,OFS_DATA_DETAILS ODD WHERE ODD.COVERAGES_ID=OFM.COVERAGES_ID AND OFM.COVERAGES_ID IN (SELECT COVERAGES_ID FROM OFS_DATA_DETAILS WHERE QUOTE_NO=? AND AMEND_ID+ ' ' +PRODUCT_ID+ ' ' +SCHEME_ID+ ' ' +CONTENT_TYPE_ID IN (SELECT MAX(AMEND_ID)+ ' ' +PRODUCT_ID+ ' ' +SCHEME_ID+ ' ' +CONTENT_TYPE_ID FROM OFS_DATA_DETAILS WHERE QUOTE_NO= ? AND PRODUCT_ID =? AND SCHEME_ID =? AND COVERAGES_Y_N_OPTION ='Y' GROUP BY PRODUCT_ID,SCHEME_ID,CONTENT_TYPE_ID ) AND COVERAGES_Y_N_OPTION ='Y' GROUP BY PRODUCT_ID,SCHEME_ID,CONTENT_TYPE_ID,COVERAGES_ID ) AND ODD.STATUS='Y' AND ODD.QUOTE_NO= ? AND ODD.PRODUCT_ID =? AND ODD.SCHEME_ID =? AND ODD.COVERAGES_Y_N_OPTION ='Y' AND ODD.CONTENT_TYPE_ID=? ORDER BY ODD.COVERAGES_ID
GET_PREMIUM_DTL=SELECT A.QUOTE_NO, C.TITLE, (C.FIRST_NAME + ' ' + C.COMPANY_NAME) CUSTOMER_NAME, C.LAST_NAME, C.ADDRESS1 ADDRESS1, C.ADDRESS2,ISNULL((SELECT D.CONTENT_DESCRIPTION FROM OFS_CONTENT_MASTER D WHERE A.CONTENT_VALUE \= D.CONTENT_TYPE_ID AND D.PRODUCT_ID \= E.PRODUCT_ID AND D.SCHEME_ID \= E.SCHEME_ID AND D.CONTENT_TYPE_ID \= E.CONTENT_TYPE_ID),' '), (CASE WHEN A.PROF_OTHERS IS NOT NULL THEN (ISNULL((SELECT F.PROFESSION FROM OFS_ACT_PROF_MASTER F WHERE A.ACTIVITY_PROFESSION \= F.ACTIVITY_PROFESSION AND F.SCHEME_ID \= E.SCHEME_ID),' ') + ' ' + '-' + ' ' + A.PROF_OTHERS) ELSE ISNULL((SELECT F.PROFESSION FROM OFS_ACT_PROF_MASTER F WHERE A.ACTIVITY_PROFESSION \= F.ACTIVITY_PROFESSION AND F.SCHEME_ID \= E.SCHEME_ID),' ') END), (CASE WHEN A.FREEZONE_OTHERS IS NOT NULL THEN (ISNULL((SELECT G.FREEZONE_DESCRIPTION FROM OFS_FREEZONE_MASTER G WHERE A.FREEZONE \= G.FREEZONE),' ') + ' ' + '-' + ' ' + A.FREEZONE_OTHERS) ELSE ISNULL((SELECT G.FREEZONE_DESCRIPTION FROM OFS_FREEZONE_MASTER G WHERE A.FREEZONE \= G.FREEZONE),' ') END), I.CONTACT_PERSON, I.COMPANY_NAME, E.PREMIUM,  convert (varchar(10),C.DOB, 103), C.OCCUPATION, (select INITCAP (C.COUNTRY) COUNTRY, A.EMIRATE, A.POBOX, C.TELEPHONE, C.MOBILE, C.FAX, C.EMAIL EMAIL, convert(varchar(10),E.EFFECTIVE_DATE, 103) EFFECTIVE_DATE, convert (varchar(10),E.EXPIRY_DATE, 103) EXPIRY_DATE, E.SUMMARY_REMARKS, E.ADMIN_SUMMARY_STATUS, E.ADMIN_REMARKS,  E.ADMIN_REFERRAL_STATUS, ISNULL (E.REMARKS, ' '), ISNULL((SELECT D.CONTENT_TYPE_ID FROM OFS_CONTENT_MASTER D WHERE A.CONTENT_VALUE \= D.CONTENT_TYPE_ID AND D.PRODUCT_ID \= E.PRODUCT_ID AND D.SCHEME_ID \= E.SCHEME_ID AND D.CONTENT_TYPE_ID \= E.CONTENT_TYPE_ID),'0'), E.REFERRAL_DESCRIPTION, A.ADDRESS1 ADDRESS, A.TELEPHONE, A.EMAIL MAIL FROM OFS_DATA A, PERSONAL_INFO C,  HOME_POSITION_MASTER E, LOGIN_MASTER H, BROKER_COMPANY_MASTER I WHERE  A.QUOTE_NO \= ?  AND A.AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   OFS_DATA WHERE   QUOTE_NO \= ?)  AND A.CUSTOMER_ID \= C.CUSTOMER_ID AND A.QUOTE_NO \= E.QUOTE_NO AND E.LOGIN_ID \= H.LOGIN_ID  AND H.OA_CODE \= I.AGENCY_CODE  AND E.QUOTE_NO \= ?  AND E.LOGIN_ID \= ?
GET_CONTENT_TYPE_LIST = SELECT * FROM OFS_CONTENT_MASTER WHERE PRODUCT_ID=? AND SCHEME_ID=? ORDER BY MINIMUM_PREMIUM ASC
GET_OFS_CONTENT_TYPE_NAME = SELECT CONTENT_DESCRIPTION FROM OFS_CONTENT_MASTER WHERE PRODUCT_ID=? AND SCHEME_ID=? AND CONTENT_TYPE_ID=?
GET_HOME_CALCULATE_PREMIUM = HOME_PREMIUM_CALC

#ADMIN BrokerManagement
GET_ADMIN_Branch_Detail=select BRANCH_CODE,BRANCH_NAME from BRANCH_MASTER where status='Y'
GET_OFSCOMMISSION_DATA=select pm.product_name,lud.PRODUCT_ID,lud.scheme_id,lud.COMMISSION,lud.INSURANCE_END_LIMIT,lud.SPECIAL_DISCOUNT,ISNULL(lm.REFERAL,'N') REFERAL,lud.status,ISNULL(lud.DISCOUNT_OF_PREMIUM,0) DISCOUNT_PREMIUM,lud.MIN_PREMIUM_AMOUNT,lud.BACK_DATE_ALLOWED,ISNULL(PRO_COMMISSION,'0'),CONVERT(VARCHAR(10),PRO_START_DATE,103) PRO_START_DATE,CONVERT(VARCHAR(20),PRO_EXPIRY_DATE,103) PRO_EXPIRY_DATE,ISNULL(lud.LOADING_OF_PREMIUM,0) LOADING_PREMIUM,ISNULL(pay_receipt_status,'N') pay_receipt_status,ISNULL(receipt_status,'N') receipt_status,ISNULL(FREIGHT_DEBIT_OPTION,'Y') FREIGHT_DEBIT_OPTION ,ISNULL(PROVISION_FOR_PREMIUM,'N') PROVISION_FOR_PREMIUM, lm.referal REMARKS from login_master lm,login_user_details lud,product_master pm where lm.agency_code=lud.agency_code and lud.PRODUCT_ID=pm.product_id and  lud.agency_code=?  AND lud.PRODUCT_ID=?
GET_Broker_List=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.RSA_BROKER_CODE,(case lm.STATUS when 'Y' then 'Active' when 'N' then 'DeActive' when 'D' then 'Delete' when 'L' then 'Locked' when 'T' then 'Locked' end) STATUS,convert(varchar(10),pi.ENTRY_DATE,103) cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi,login_master lm where bcm.agency_code=pi.agency_code and pi.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=pi.CUSTOMER_ID) and lm.agency_code = bcm.agency_code and  bcm.branch_code in(?) and APPLICATION_ID=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) order by lower(bcm.COMPANY_NAME)
GET_Broker_Info=select pi.TITLE,pi.GENDER,pi.FIRST_NAME,pi.LAST_NAME,pi.NATIONALITY,(select NATIONALITY_NAME from COUNTRY_MASTER where amend_id+ ' ' +country_id in( select max(amend_id)+ ' ' +country_id from country_master group by country_id) and COUNTRY_ID=pi.nationality) nationalityName,CONVERT(VARCHAR,PI.DOB,103) DOB,pi.TELEPHONE,pi.MOBILE,pi.FAX,pi.EMAIL,pi.ADDRESS1,pi.ADDRESS2,pi.OCCUPATION,pi.EMIRATE,pi.COUNTRY,(CASE WHEN CONVERT(VARCHAR(10),pi.COUNTRY,103)='Y' then (select CONVERT(VARCHAR(10),COUNTRY_NAME,103) from country_master where (COUNTRY_NAME=pi.COUNTRY or COUNTRY_ID=pi.COUNTRY)) else CONVERT(VARCHAR(10),pi.COUNTRY,103) end) country_name, pi.POBOX,lm.company_name,lm.agency_code,pi.entry_date,log.status,lm.ADDRESS3,lm.city,lm.BRANCH_CODE,lm.MISSIPPI_ID,lm.APPROVED_PREPARED_BY,lm.rsa_broker_code,log.login_id,lm.AC_EXECUTIVE_ID,PI.CUST_NAME,PI.CUST_AR_NO,log.LOGIN_ID,lm.customer_id,convert(decimal(5,2),lm.ISSUER_COMMISSION_OPENCOVER,2) ISSUER_COMMISSION_OPENCOVER,convert(decimal(5,2),lm.ISSUER_COMMISSION_ONEOFF,2) ISSUER_COMMISSION_ONEOFF,LM.IMAGE_PATH,log.SUB_BRANCH from personal_info pi,broker_company_master lm,login_master log where log.agency_code=lm.agency_code and pi.agency_code=lm.agency_code and  pi.agency_code=? and lm.branch_code in(?) and application_id in('2','3')
GET_Commission_Data=select distinct(pm.product_name),lud.PRODUCT_ID,isnull(lud.COMMISSION,0) COMMISSION,lud.INSURANCE_END_LIMIT,lud.SPECIAL_DISCOUNT,ISNULL(lm.REFERAL,'N') REFERAL,lud.status,ISNULL(lud.DISCOUNT_OF_PREMIUM,0) DISCOUNT_PREMIUM,lud.MIN_PREMIUM_AMOUNT,isnull(lud.BACK_DATE_ALLOWED,0)BACK_DATE_ALLOWED,ISNULL(PRO_COMMISSION,'0'),CONVERT(VARCHAR(10),PRO_START_DATE,103),CONVERT(VARCHAR(10),PRO_EXPIRY_DATE,103),ISNULL(lud.LOADING_OF_PREMIUM,0) LOADING_PREMIUM,ISNULL(pay_receipt_status,'N') pay_receipt_status,ISNULL(receipt_status,'N') receipt_status,ISNULL(FREIGHT_DEBIT_OPTION,'Y') FREIGHT_DEBIT_OPTION ,ISNULL(PROVISION_FOR_PREMIUM,'N') PROVISION_FOR_PREMIUM, lm.referal REMARKS,lud.POLICY_TYPE POLICY_TYPE,lud.CHECKER_YN CHECKER_YN from login_master lm,login_user_details lud,product_master pm where lm.agency_code=lud.agency_code and lud.PRODUCT_ID=pm.product_id and  lud.agency_code=?
GET_ADMIN_REF_Branch_Detail=SELECT BRANCH_CODE,BRANCH_NAME FROM  BRANCH_MASTER WHERE BRANCH_CODE in  (SELECT Item LC_LOGIN FROM FN_Split_SV (((SELECT ATTACHED_BRANCH LC_LOGIN FROM LOGIN_MASTER WHERE LOGIN_ID=?)),',') where Item IS NOT NULL )
GET_BROKER_LINKED_LOC = SELECT FS_BRANCH_CODE,FS_BRANCH_NAME FROM TRAVEL_LOCATION_LINK WHERE STATUS='Y' ORDER BY FS_BRANCH_NAME ASC
GET_ATTACHED_REGIONS=SELECT BRANCH_CODE, BRANCH_NAME FROM branch_master WHERE   branch_code IN   (SELECT * FROM FN_Split_SV ((SELECT  (case accesstype when 'Super' then nullif(branch_code,branch_code)  else branch_code end ) from login_master WHERE    login_id = ?),',')) ORDER BY   branch_name
GET_Branch_Detail=select BRANCH_CODE,BRANCH_NAME from BRANCH_MASTER where status='Y' and BRANCH_CODE in(?)
GET_Broker_Code=SELECT BROKER_CODE_SEQ.NEXTVAL FROM DUAL
GET_Emirates=select upper(city_id)city_id,upper(city_name)city_name  from city_master where country_id=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and status='Y' order by city_name
GET_Nationalities=select COUNTRY_ID,NATIONALITY_NAME from COUNTRY_MASTER where amend_id+ ' ' +country_id in( select max(amend_id)+ ' ' +country_id from country_master group by country_id) and NATIONALITY_NAME is not null order by NATIONALITY_NAME
GET_Titles=select TITLE_ID,TITLE_NAME from TITLE_MASTER where branch_code=(SELECT BELONGING_BRANCH FROM BRANCH_MASTER BM WHERE BRANCH_CODE=? AND BM.STATUS='Y' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM BRANCH_MASTER BM1 WHERE BM1.BRANCH_CODE=BM.BRANCH_CODE AND BM1.STATUS=BM.STATUS)) and status='Y' order by TITLE_NAME
GET_Executives=select distinct b.AC_EXECUTIVE_ID, b.AC_EXECUTIVE_NAME from LOGIN_EXECUTIVE_DETAILS b where b.status='Y'  and amend_id =(select max(a.amend_id)  from LOGIN_EXECUTIVE_DETAILS a where  a.AC_EXECUTIVE_ID=b.AC_EXECUTIVE_ID)order by b.AC_EXECUTIVE_NAME
INS_Broker_Det=insert into personal_info(customer_id,application_id,title,first_name,last_name,amend_id,nationality,dob,gender,telephone,mobile,fax,email,address1,address2,occupation,pobox,country,emirate,status,entry_date,agency_code,oa_code,CUST_NAME,CUST_AR_NO, LOGIN_ID)values(?,?,?,?,?,?,?,CONVERT(DATE,?,103),?,?,?,?,?,?,?,?,?,?,?,?,SYSDATETIME(),?,?,?,?,?)
GET_Core_Customer=SELECT CIMSNO,(CASE WHEN CUSTCODE IS NULL OR CUSTGRP IS NULL OR CUSTTYPE IS NULL OR CUSTCLAS IS NULL THEN '' ELSE (CUSTCODE + ' ' +'-'+ ' ' + CUSTGRP + ' ' +'-'+ ' ' + CUSTTYPE + ' ' +'-'+ ' ' +CUSTCLAS) END) ARACC, CUSTTITL,CUSTNAME,CUSTADD1,CUSTADD2,CUSTADD3,CUSTADD4 FROM C_CUST@ECARGO_PROD WHERE lower(CUSTNAME) LIKE '%'+ ' ' +lower(?)+ ' ' +'%' AND BRCODE=?
UPD_broker_password=update login_master set password=?,STATUS='Y',PWD_COUNT='0' where agency_code=?
GET_Tax_Info=select ISNULL(POLICY_FEE_STATUS,'N') policy_feestatus,ISNULL(POLICY_FEE,'0') policy_fees,ISNULL(GOVT_TAX_STATUS,'N') gov_taxstatus,ISNULL(GOVT_TAX,'0') govt_tax,ISNULL(EMERGENCY_FUND_STATUS,'N') emergency_fundstatus,ISNULL(EMERGENCY_FUND,'0')emer_fund,CONVERT(VARCHAR(10),EFFECTIVE_DATE,103) effec_date, TAX_APPLICABLE from BROKER_MASTER where BRANCH_CODE=? and AGENCY_CODE=? and status='Y' and AMEND_ID+ ' ' +AGENCY_CODE in(select max(ISNULL(AMEND_ID,'0'))+ ' ' +AGENCY_CODE from BROKER_MASTER where BRANCH_CODE=? and AGENCY_CODE=? and status='Y' group by AGENCY_CODE)
GET_Customer_Id=select ISNULL((max(current_no)+1),max(start_no)) from policyno_generate where type_id=3 and status='Y' and BRANCH_CODE=?
UPD_Customer_Id=update policyno_generate set CURRENT_NO=?, REMARKS=? where type_id=3 and status='Y' and BRANCH_CODE=?
INS_BCM_DET=insert into broker_company_master(AGENCY_CODE,COMPANY_NAME,CONTACT_PERSON,ADDRESS1,ADDRESS2,ADDRESS3,CITY,COUNTRY,PHONE,POBOX,FAX,EMIRATE,REMARKS,STATUS,CUSTOMER_ID,BRANCH_CODE,MISSIPPI_ID,APPROVED_PREPARED_BY,rsa_broker_code,AC_EXECUTIVE_ID, ISSUER_COMMISSION_ONEOFF, ISSUER_COMMISSION_OPENCOVER,IMAGE_PATH) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,CONVERT(NUMERIC(20,2), ?),CONVERT(NUMERIC(20,2), ?),?)
GET_BRO_CODE=SELECT BROKER_CODE_SEQ.NEXTVAL
GET_MAX_BRO_CODE=update policyno_generate set current_no=?,remarks=? where type_id=3 and status='Y' and BRANCH_CODE=?
GET_CUST_ID=select CUSTOMER_ID from broker_company_master where agency_code=? and branch_code=?
UPD_BROKER_DET=update  broker_company_master set COMPANY_NAME=?,CONTACT_PERSON=?,ADDRESS1=?,ADDRESS2=?,ADDRESS3=?,CITY=?,COUNTRY=?,PHONE=?,POBOX=?,FAX=?,EMIRATE=?,CUSTOMER_ID=?,BRANCH_CODE=?,MISSIPPI_ID=?,APPROVED_PREPARED_BY=?,RSA_BROKER_CODE=?,AC_EXECUTIVE_ID=?, ISSUER_COMMISSION_ONEOFF=?, ISSUER_COMMISSION_OPENCOVER=? ,IMAGE_PATH=? where agency_code=? and branch_code=?
UPD_PERSONAL_INFO=update personal_info set title=?,first_name=?,last_name=?,nationality=?,dob=CONVERT(DATE,?,103),gender=?,telephone=?,mobile=?,fax=?,email=?,address1=?,address2=?,occupation=?,pobox=?,country=?,emirate=?,status=?,effective_date=CONVERT(DATE,?,103),CUST_NAME=?,CUST_AR_NO=?  where application_id=? and agency_code=?
GET_MAXAMEND_ID=select max(AMEND_ID) from BROKER_MASTER where BRANCH_CODE=? and AGENCY_CODE=? and status='Y'
INS_TAX_DET=insert into BROKER_MASTER(AGENCY_CODE,BRANCH_CODE,POLICY_FEE_STATUS,GOVT_TAX_STATUS,EMERGENCY_FUND_STATUS, POLICY_FEE,GOVT_TAX,EMERGENCY_FUND,STATUS,REMARKS,AMEND_ID,TAX_APPLICABLE,ENTRY_DATE,EFFECTIVE_DATE)values(?,?,?,?,?,isnull(?,0),isnull(?,0),isnull(?,0),'Y',?,?,?,SYSDATETIME(),CONVERT(DATE,?,103))
UPD_TAX_DET=update BROKER_MASTER set POLICY_FEE_STATUS\=?, GOVT_TAX_STATUS\=?, EMERGENCY_FUND_STATUS\=?, POLICY_FEE\=?, GOVT_TAX\=nullif(?,''), EMERGENCY_FUND\=nullif(?,''), TAX_APPLICABLE\=?, EFFECTIVE_DATE\=CONVERT(DATE,?,103) where agency_code\=? and branch_code\=? and amend_id\=(select max(Amend_id) from BROKER_MASTER B Where B.agency_code\=? and B.branch_code\=?) 
GET_PRODUCT_DET=select RTRIM(LTRIM(PRODUCT_ID)) PRODUCT_ID,PRODUCT_NAME,COMPANY_ID from product_master where status='Y' and branch_code =( select belonging_branch from branch_master bm where branch_code=?  AND STATUS='Y' and amend_id=(select max(amend_id) from branch_master bm1 where bm1.branch_code=bm.branch_code and bm1.status=bm.status))
GET_REF_PRODUCT_DET= select  RTRIM(LTRIM(PRODUCT_ID)) PRODUCT_ID,PRODUCT_NAME,COMPANY_ID from product_master where status='Y' and branch_code =( select belonging_branch from branch_master bm where branch_code=?  AND STATUS='Y' and amend_id=(select max(amend_id) from branch_master bm1 where bm1.branch_code=bm.branch_code and bm1.status=bm.status))
GET_COMP_DET=select bcm.COMPANY_NAME, pi.FIRST_NAME FROM BROKER_COMPANY_MASTER bcm,PERSONAL_INFO pi where pi.AGENCY_CODE=bcm.AGENCY_CODE and pi.AGENCY_CODE=?
GET_MAXUSER_ID=select max(USER_ID)+1 from LOGIN_USER_DETAILS
#INS_PRODUCT_DET=insert into login_user_details(USER_ID,USER_NAME,LOGIN_ID,AGENCY_CODE,OA_CODE, PRODUCT_ID,COMPANY_ID,COMMISSION,INSURANCE_START_LIMIT, INSURANCE_END_LIMIT,DISCOUNT_OF_PREMIUM,RELATIVE_USER_ID,AMEND_ID, INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,REMARKS,STATUS, CUSTOMER_ID,MIN_PREMIUM_AMOUNT,BACK_DATE_ALLOWED,Pro_commission, pro_start_date,pro_expiry_date,LOADING_OF_PREMIUM, PROVISION_FOR_PREMIUM,FREIGHT_DEBIT_OPTION,PAY_RECEIPT_STATUS, RECEIPT_STATUS, open_cover_no, SPECIAL_DISCOUNT,SCHEME_ID) values(?,?,(select LOGIN_ID from login_master where AGENCY_CODE=?),nullif(?,0),nullif(?,0),nullif(?,0),nullif(?,0),isnull(?,0),nullif(?,0),nullif(?,0),nullif(?,0),nullif(?,0),?,SYSDATETIME(),CONVERT(date,?,103),CONVERT(date,?,103),SYSDATETIME(),?,?,nullif(?,0),nullif(?,0),nullif(?,0),nullif(?,0),CONVERT(date,?,103),CONVERT(date,?,103),nullif(?,0),?,?,?,?,?,isnull(?,0),?)
INS_PRODUCT_DET=INSERT INTO LOGIN_USER_DETAILS(USER_ID,USER_NAME,LOGIN_ID,AGENCY_CODE,OA_CODE,PRODUCT_ID,COMPANY_ID,COMMISSION,INSURANCE_START_LIMIT, INSURANCE_END_LIMIT,DISCOUNT_OF_PREMIUM,      RELATIVE_USER_ID,AMEND_ID, INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,REMARKS,STATUS, CUSTOMER_ID, MIN_PREMIUM_AMOUNT,BACK_DATE_ALLOWED,PRO_COMMISSION,PRO_START_DATE,PRO_EXPIRY_DATE,LOADING_OF_PREMIUM, PROVISION_FOR_PREMIUM, FREIGHT_DEBIT_OPTION,PAY_RECEIPT_STATUS,RECEIPT_STATUS, OPEN_COVER_NO, SPECIAL_DISCOUNT,SCHEME_ID) VALUES (?,?,(SELECT LOGIN_ID FROM LOGIN_MASTER WHERE AGENCY_CODE=?),    ?,?,?,CONVERT(DECIMAL(10,2),CAST(? AS FLOAT)) , CONVERT(DECIMAL(10,2),CAST(? AS FLOAT)),CONVERT(DECIMAL(10,2),CAST(? AS FLOAT)),CONVERT(DECIMAL(10,2),CAST(? AS FLOAT)),?,?,?,SYSDATETIME(),CONVERT(DATE,?,103),CONVERT(DATE,?,103),CONVERT(DATE,?,103),?,?,?,CONVERT(DECIMAL(10,2),CAST(? AS FLOAT)),?,CONVERT(DECIMAL(10,2),CAST(? AS FLOAT)),CONVERT(DATE,?,103),CONVERT(DATE,?,103),NULLIF(?,0),?,?,?,?,?,CONVERT(DECIMAL(10,2),CAST(? AS FLOAT)),?)
UPD_PRODUCT_DET=update login_user_details set COMMISSION=NULLIF(?,''),INSURANCE_END_LIMIT=NULLIF(?,''),STATUS=?,DISCOUNT_OF_PREMIUM=NULLIF(?,''),MIN_PREMIUM_AMOUNT=NULLIF(?,'') ,BACK_DATE_ALLOWED=NULLIF(?,''),LOADING_OF_PREMIUM=NULLIF(?,''),pay_receipt_status=?,FREIGHT_DEBIT_OPTION=?,PROVISION_FOR_PREMIUM=NULLIF(?,''), RECEIPT_STATUS=?, open_cover_no=?, SPECIAL_DISCOUNT=NULLIF(?,'') where AGENCY_CODE=? and product_id=?
UPD_PRODUCT_DET_LM=update login_master set referal=? where AGENCY_CODE=?
INS_LOGIN_DET=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,ACCESSTYPE,PASSDATE,BRANCH_CODE,COUNTRY_ID,CORE_LOGIN_ID, APP_ID, PWD_COUNT, USER_MAIL,SUB_BRANCH) values(?,?,?,?,?,?,?,?,?,?,?,?,?,DATEADD(day,0,SYSDATETIME ()) ,?,?,?, '16', '0', ?,?)
UPD_PERSONAL_LOGIN_ID=update personal_info set LOGIN_ID\=? where AGENCY_CODE\=? 
UPD_BROKER_STATUS_LM = update login_master set USERNAME=?, status=?, USER_MAIL=?,SUB_BRANCH=?,PWD_COUNT='0' where agency_code=?
UPD_BROKER_STATUS_BCM = update broker_company_master set status=? where agency_code=?
GET_MAIN_USER_INFO=SELECT lm.LOGIN_ID, lm.USERTYPE, lm.BRANCH_CODE, (select BRANCH_NAME from branch_master where STATUS='Y' and branch_code=lm.branch_code) BRANCH_NAME, lm.COUNTRY_ID, lm.MENU_ID FROM LOGIN_MASTER lm WHERE lm.LOGIN_ID=?
GET_BROKER_LIST_BY_NAME=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.RSA_BROKER_CODE,(case bcm.STATUS when 'Y' then 'Active' when 'N' then 'DeActive' when 'D'then 'Delete' when 'L' then 'Locked' end ) STATUS,convert(varchar(10),pi.ENTRY_DATE,103) cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi where bcm.agency_code=pi.agency_code and  bcm.branch_code in(?) and APPLICATION_ID=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) AND lower(bcm.COMPANY_NAME) like '%'+ ' ' +lower(?)+ ' ' +'%'  order by lower(bcm.COMPANY_NAME)
GET_BROKER_LIST_BY_CODE=select bcm.CUSTOMER_ID,bcm.CONTACT_PERSON,bcm.COMPANY_NAME,pi.AGENCY_CODE,bcm.RSA_BROKER_CODE,(case bcm.STATUS when 'Y' then 'Active' when 'N' then 'DeActive' when 'D' then 'Delete' when 'L' then 'Locked' end) STATUS,CONVERT(VARCHAR(10),pi.ENTRY_DATE,103) cr_date,pi.login_id from BROKER_COMPANY_MASTER bcm, personal_info pi where bcm.agency_code\=pi.agency_code and  bcm.branch_code in(?) and APPLICATION_ID\=? and pi.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) AND bcm.RSA_BROKER_CODE like '%'+ ' ' +?+ ' ' +'%'  order by lower(bcm.COMPANY_NAME)
BRANCH_BCODE_CNT = SELECT COUNT(*) FROM BROKER_COMPANY_MASTER WHERE RSA_BROKER_CODE=? AND BRANCH_CODE=?
BROKER_DELETE_LOGO = UPDATE BROKER_COMPANY_MASTER SET IMAGE_PATH='' WHERE AGENCY_CODE=?

##UnderWriter Management
INS_ISSUER_LOGIN_DET=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,ACCESSTYPE,PASSDATE,BRANCH_CODE,COUNTRY_ID,CORE_LOGIN_ID, APP_ID, PWD_COUNT, USER_MAIL,PRODUCT_ID,ENTRY_DATE,ATTACHED_BRANCH,INCEPTION_DATE,SUB_BRANCH) values(?,?,?,?,?,?,?,?,?,?,?,?,?,dateadd(day,45,SYSDATETIME()),?,?,?, '16', '0', ?,?,SYSDATETIME(),?,CONVERT(DATE, ?, 103),?)
GET_ISSUER_LIST =select username COMPANY_NAME,USERTYPE,login_id,convert(varchar(10),ENTRY_DATE,103) CR_DATE,(case STATUS when 'Y' then 'Active' when 'N' then 'DeActive' when 'D'then 'Delete' when 'L' then 'Locked' end) status from login_master where branch_code\=? and usertype\='RSAIssuer' 
GET_ISSUER_DETAIL =SELECT   broker_code,login_id,(SELECT   company_name FROM   broker_company_master bcm WHERE   bcm.AGENCY_CODE = broker_code) broker_name,lm.product_id,(select distinct(product_name) from product_master pm where pm.product_id=lm.product_id and branch_code=?) product_name,commission,convert(varchar(10),START_DATE, 103) START_DATE,CONVERT(VARCHAR(10),END_DATE,103) END_DATE,convert(varchar(2),START_DATE,103),convert(varchar(2),START_DATE,103), convert(yyyy,START_DATE),convert(varchar(2),END_DATE,103),convert(varchar(2),END_DATE,103) ,datepart(yyyy,end_date),status,convert(varchar(2),CANCEL_DATE,103) ,convert(varchar(2),CANCEL_DATE,101) ,datepart (YYYY,CANCEL_DATE ),type FROM LOGIN_RSAUSER_DETAILS lm WHERE  login_id = ? AND (amend_id + ' ' + broker_code + ' ' + product_id) IN (  SELECT   MAX (amend_id) + ' ' + broker_code + ' ' + product_id FROM   LOGIN_RSAUSER_DETAILS WHERE   login_id = ? GROUP BY   broker_code, product_id)ORDER BY   broker_Code, product_id
GET_INCLUDE_BROKER = SELECT broker_code,(select company_name from broker_company_master bcm where bcm.agency_code\=lm.broker_code) broker_name,product_id,(select distinct(product_name)from product_master pm where pm.product_id\=lm.product_id) product_name,convert(varchar(10),START_DATE, 103) START_DATE,convert(varchar(10),END_DATE, 103) END_DATE,(case status when 'Y' then 'ACTIVE' when 'N' then 'DEACTIVE' end) status FROM LOGIN_RSAUSER_DETAILS lm 
GET_EXCLUDE_BROKER = SELECT broker_code,(select company_name from broker_company_master bcm where bcm.agency_code=lm.broker_code) broker_name,product_id,(select distinct(product_name)from product_master pm where pm.product_id=lm.product_id) product_name,convert(varchar(10),START_DATE, 103) START_DATE,convert(varchar(10),END_DATE, 103) END_DATE,(case status when 'Y' then 'ACTIVE' when 'N' then 'DEACTIVE' end) status FROM LOGIN_RSAUSER_DETAILS lm WHERE TYPE=?
UPDATE_INCLUDE_BROKER =update LOGIN_RSAUSER_DETAILS set type=?,STATUS=? where BROKER_CODE =? and product_id =?
issuer.branch=select BRANCH_CODE CODE,BRANCH_NAME CODEDESC from rsa_branch_details  where branch_code in  (SELECT distinct(REGEXP_SUBSTR(RSA_BRANCH_CODE,'[^,]+',1,LEVEL)) lc_login FROM (select RSA_BRANCH_CODE from login_master where login_id\=?) B  CONNECT BY LEVEL <\= LENGTH(RSA_BRANCH_CODE) - LENGTH(REPLACE(RSA_BRANCH_CODE,',',''))+1) 
issuer.broker=select bcm.AGENCY_CODE CODE, bcm.COMPANY_NAME CODEDESC from broker_company_master bcm,login_master lm  where bcm.agency_code=lm.agency_code and upper(lm.usertype)=upper('Broker') and lm.branch_code=? and bcm.agency_code not in (select broker_code  from login_rsauser_details where login_id=? and branch_code=? and product_id=?)
GET_UW_DETLIST=select sub_branch,username,user_mail,login_id,CORE_LOGIN_ID,product_id,status,ATTACHED_BRANCH,CONVERT(VARCHAR(10),INCEPTION_DATE,103) INCEPTION_DATE from login_master where branch_code=? and usertype='RSAIssuer' and login_id=?
ICLCU_BROKER=insert into LOGIN_RSAUSER_DETAILS (LOGIN_ID, BROKER_CODE, PRODUCT_ID,BRANCH_CODE, AMEND_ID, COMMISSION,ENTRY_DATE, START_DATE,END_DATE, STATUS) values (?,?,?,?,?,?,SYSDATETIME(),SYSDATETIME(),DATEADD(DAY,365,SYSDATETIME()),?)

#USER MANAGEMENT
GET_USER_LIST = select ISNULL(per.first_name+ ' ' +''+ ' ' +per.last_name,per.company_name)company_name,log.usertype,log.LOGIN_ID,per.application_id,per.agency_code,(case log.status when 'Y' then 'Active' when 'N' then 'DeActive' when 'D' then 'Delete' when 'L' then 'Locked' when 'T' then 'Locked' end) status,convert(date,per.ENTRY_DATE,103) cr_date, (select company_name from broker_company_master bcm where log.OA_CODE\=bcm.AGENCY_CODE) brokerName from personal_info per,login_master log where log.usertype\=? and log.agency_code\=per.agency_code and log.login_id not in('NONE') and per.application_id in('2','3') and per.amend_id\= (select (max(amend_id)) from PERSONAL_INFO ap where ap.CUSTOMER_ID\=per.CUSTOMER_ID)
GET_USER_INFO= SELECT LOGIN_ID,PASSWORD,USERTYPE, STATUS, PWD_COUNT FROM LOGIN_MASTER WHERE  LOGIN_ID \= ? AND PASSWORD \= ? AND APP_ID \= ? AND STATUS in ('T','Y')
GET_BROKER_USER_DETAILS=select pi.TITLE,pi.GENDER,pi.FIRST_NAME,pi.LAST_NAME,(select NATIONALITY_NAME from COUNTRY_MASTER where amend_id+ ' ' +country_id in( select max(amend_id)+ ' ' +country_id from country_master group by country_id) and COUNTRY_ID\=pi.nationality) nationality_name, pi.NATIONALITY, convert(varchar(10),pi.DOB,103) DOB,pi.TELEPHONE,pi.MOBILE,pi.FAX,pi.EMAIL,pi.ADDRESS1,pi.ADDRESS2,pi.OCCUPATION,pi.EMIRATE,pi.COUNTRY,(select COUNTRY_NAME from country_master where COUNTRY_ID\=pi.COUNTRY and AMEND_ID\=(SELECT max(AMEND_ID) FROM country_master WHERE COUNTRY_ID\=pi.COUNTRY)) country_name,pi.POBOX,lm.agency_code,pi.entry_date,lm.status,pi.city,lm.BRANCH_CODE,lm.login_id,(select COMPANY_NAME from broker_company_master where AGENCY_CODE\=lm.OA_CODE) bname, lm.usertype, PI.CUST_NAME,PI.CUST_AR_NO,pi.customer_id, (select distinct(USERNAME) from login_master where  AGENCY_CODE\=lm.OA_CODE)borganization, lm.OA_CODE,lm.SUB_BRANCH from personal_info pi, login_master lm where pi.agency_code\=lm.agency_code and pi.LOGIN_ID\=lm.LOGIN_ID and  pi.agency_code\=?  and pi.application_id in('2','3')
GET_OPENCOVER_CERTIFICAE=select distinct(ocpm.open_cover_no),ocpm.proposal_no,ocm.MISSIPPI_OPENCOVER_NO,ocpm.Customer_Schedule,ocpm.Customer_Debit,ocpm.Customer_CustomerDebit,ISNULL(pi.company_name,pi.first_name) name from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.broker_id in(select distinct LOGIN_ID from login_user_details where agency_code=?) and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no AND ocpm.amend_id = (SELECT   MIN (amend_id) FROM   open_cover_position_master oc WHERE ISNULL (oc.ORIGINAL_POLICY_NO, oc.OPEN_COVER_NO) = ISNULL (ocpm.ORIGINAL_POLICY_NO, ocpm.OPEN_COVER_NO)) and pi.customer_id=ocm.customer_id and pi.status='Y' AND CONVERT(varchar(10), ocm.amend_id)+ ' ' +'-'+ ' ' +ocm.proposal_no in (select CONVERT(varchar(10), MAX (ocms.amend_id))+ ' ' +'-'+ ' ' +ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no  group by ocms.proposal_no) order by ocpm.open_cover_no  DESC
GET_USER_AGENCYCODE=select detail_name from constant_detail where CATEGORY_ID=37 and CATEGORY_DETAIL_ID=1 and status='Y' and branch_code=?
INS_USER_PERSONAL_INFO=insert into personal_info(customer_id,application_id,title,first_name,last_name,amend_id,nationality,dob,gender,telephone,mobile,fax,email,address1,address2,occupation,pobox,country,emirate,status,entry_date,login_id,AGENCY_CODE,OA_CODE,city,fd_code)values(?,?,?,?,?,?,?, CONVERT(DATE,?,103),?,?,?,?,?,?,?,?,?,?,?,?,SYSDATETIME(),?,?,?,?,?)
INS_USER_LOGIN_MASTER=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,ACCESSTYPE,RIGHTS,LPASS1,LPASS2,LPASS3,PASSDATE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION,REFERAL, APP_ID, PWD_COUNT, USER_MAIL, branch_code, COUNTRY_ID,ENTRY_DATE,SUB_BRANCH) values(?,?,?,?,?,?,?,?,?,?,?,?,SYSDATETIME(),?,?,?,?,?,?,'16','0',?,?,?,SYSDATETIME(),?)
UPD_USER_PERSONAL_INFO=update personal_info set title=?, first_name=?, last_name=?, nationality=?, dob=CONVERT(DATE,?,103), gender=?, telephone=?, mobile=?, fax=?, email=?, address1=?, address2=?, occupation=?, pobox=?, country=?, emirate=?, status=?, city=? where agency_code=? and application_id in('2','3')
UPD_USER_LOGIN_MASTER=update login_master set USERNAME=?, STATUS=?, USER_MAIL=?,SUB_BRANCH=?,PWD_COUNT='0' where AGENCY_CODE=?
UPD_USER_AGENCYCODE=update constant_detail set detail_name=? where CATEGORY_ID=37 and CATEGORY_DETAIL_ID=1 and status='Y' and branch_code=?
GET_USER_COMMISSION=select pm.product_name uproductName, pm.product_id uproductId, lud.SPECIAL_DISCOUNT specialDis, lud.FREIGHT_DEBIT_OPTION freight, lud.INSURANCE_END_LIMIT insEndLimit, lud.pay_receipt_status receipt, lud.open_cover_no, (case when LUD.PRODUCT_ID=PM.PRODUCT_ID then 'Y'else 'N' end) product  from PRODUCT_MASTER pm left outer join LOGIN_USER_DETAILS lud on PM.PRODUCT_ID = LUD.PRODUCT_ID  and LUD.AGENCY_CODE = ? and LUD.OA_CODE = ? where PM.BRANCH_CODE = (SELECT BELONGING_BRANCH FROM BRANCH_MASTER WHERE BRANCH_CODE=?) and pm.status='Y'
GET_EXIST_PRODUCT_COUNT=select count(*) from LOGIN_USER_DETAILS where PRODUCT_ID\=? and AGENCY_CODE\=?
GET_EXIST_BROK_COUNT=SELECT  count(*) COUNT FROM   LOGIN_USER_DETAILS WHERE   AGENCY_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE AGENCY_CODE = ?)  AND PRODUCT_ID = ?
 
#CUSTOMER MANAGEMENT
GET_CUSTOMER_LIST=SELECT (FIRST_NAME + ' ' + company_name) company_name, ISNULL (CUSTOMER_LOGIN_ID, ''), (select distinct(COMPANY_NAME) from BROKER_COMPANY_MASTER where agency_code=oa_code) broker_name, convert(varchar(10),ENTRY_DATE, 103) ENTRY_DATE,  ISNULL (agency_code, '0'), ISNULL (fd_code, '0') EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME, EMIRATE, CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2, CUST_AR_NO, REPLACE ('P.O.BOX.' + ' ' + ISNULL (POBOX, ' ') + ' ' + ISNULL (ADDRESS1, ' ') + ' ' + ISNULL (ADDRESS2, ' ') + ' ' + ISNULL (EMIRATE, ' '), 'select', '') ADDRESS FROM PERSONAL_INFO WHERE APPLICATION_ID = '1' AND LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE
GET_CUSTOMER_INFO=select * from personal_info where customer_id=?
GET_OPEN_COVER_LIST_CUSTOMER=select distinct(a.proposal_no),ISNULL(a.open_cover_no,'0') open_cover_no, (case a.STATUS when 'Y' then 'Quote' when 'P' then 'Policy' end) STATUS, ISNULL(a.open_cover_no,'0'),ISNULL(convert(varchar(10),b.policy_start_date,103),' ') pol_start_date,ISNULL(convert(varchar(10),b.policy_end_date,103),' ') pol_expire_date,ISNULL(first_name,company_name) name,RENEWAL_STATUS,b.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_master b,personal_info c where a.status\='Y' and a.original_policy_no is null and a.proposal_no \= b.proposal_no and b.amend_id \= (select max(amend_id) from open_cover_master b where b.proposal_no \= a.proposal_no) and a.proposal_no in (select proposal_no from open_cover_master where broker_id\=(select distinct LOGIN_ID from login_user_details where agency_code\=?)) and c.customer_id \=b.customer_id and b.customer_id\=?
GET_CORECUSTOMER_LIST=SELECT CUSTOMER_ID,FIRST_NAME,EMAIL,ADDRESS1+' ,'+ADDRESS2 ADDRESS,EMIRATE FROM PERSONAL_INFO WHERE  APPLICATION_ID = '1' AND MISSIPPI_CUSTOMER_CODE IS null
UPD_CORECUSTOMER_MISSIP=UPDATE PERSONAL_INFO SET MISSIPPI_CUSTOMER_CODE=? WHERE CUSTOMER_ID=?
#Open Cover
GET_OPENCOVER_LIST=select distinct(a.proposal_no),ISNULL(a.open_cover_no,'0'),ISNULL(convert(varchar(10),b.policy_start_date,103),' '),ISNULL(convert(varchar(10),b.policy_end_date,103),' '),ISNULL(first_name,company_name) name,RENEWAL_STATUS,b.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_master b,personal_info c where a.status\='Y' and a.original_policy_no is null and a.proposal_no \= b.proposal_no and b.amend_id \= (select max(amend_id) from open_cover_master b where b.proposal_no \= a.proposal_no) and a.proposal_no in (select proposal_no from open_cover_master where broker_id\=(select distinct LOGIN_ID from login_user_details where agency_code\=?)) and c.customer_id \=b.customer_id order by a.proposal_no desc

#Referal Cases
GET_OCLIST_PENDING=select  CONVERT (VARCHAR(10), A.ENTRY_DATE, 121) ENTERY_DATE ,count(a.ENTRY_DATE) count_entery_date from position_master a,marine_data b, personal_info c where c.CUSTOMER_ID=a.CUSTOMER_ID and ((a.REMARKS in ('Referal') and b.ADMIN_REFERRAL_STATUS='N') or (a.REMARKS in ('Admin','Normal','NORMAL_EXCESS_PRICE') and b.ADMIN_REFERRAL_STATUS='Y')) and a.status in ('Y','E') and a.product_id in(?) and  a.application_no=b.application_no and a.FREIGHT_STATUS is null and a.login_id in(select login_id from login_master where
GET_HOMEOCLIST_PENDING=SELECT  CONVERT (VARCHAR(10), A.ENTRY_DATE, 121) ENTERY_DATE ,COUNT(A.ENTRY_DATE) COUNT_ENTERY_DATE FROM HOME_POSITION_MASTER A WHERE A.REMARKS\= 'Referal' AND A.STATUS IN ('Y','E') AND A.PRODUCT_ID\=? AND A.LOGIN_ID IN(SELECT LOGIN_ID FROM LOGIN_MASTER WHERE  
GET_OCLIST_APPROVED=select  CONVERT (VARCHAR(10), A.ENTRY_DATE, 121) ENTERY_DATE ,count(a.entry_date) count_entery_date,sum(ISNULL(b.premium,'0')+ISNULL(b.excess_premium,'0')) premium from position_master a,marine_data b, personal_info c where c.CUSTOMER_ID=a.CUSTOMER_ID and a.REMARKS in ('Admin','NORMAL_EXCESS_PRICE') and a.application_no=b.application_no and b.ADMIN_REFERRAL_STATUS='N' and a.product_id in (?) and a.status  in('Y','E')  and a.FREIGHT_STATUS is null and a.login_id in(select login_id from login_master where
GET_HOMEOCLIST_APPROVED=select  CONVERT (VARCHAR(10), A.ENTRY_DATE, 121) entery_date,count(a.entry_date) count_entery_date,sum(a.OVERALL_PREMIUM) PREMIUM  from home_position_master a where a.REMARKS='Admin' and a.status in('Y','E')  and a.product_id =? and a.login_id in(select login_id from login_master where
GET_OCLIST_REJECTED=select  CONVERT (VARCHAR(10), A.ENTRY_DATE, 121) entery_date,count(a.entry_date) count_entery_date from position_master a, personal_info c,marine_Data b where c.CUSTOMER_ID\=a.CUSTOMER_ID and b.application_no\=a.application_no and a.status \= 'R' and a.product_id \=? and a.FREIGHT_STATUS is null and a.login_id in(select login_id from login_master where
GET_HOMEOCLIST_REJECTED=select  CONVERT (VARCHAR(10), A.ENTRY_DATE, 121) entery_date,count(a.EFFECTIVE_DATE) count_entery_date from home_position_master a where ADMIN_REFERRAL_STATUS='N' and a.status='R'  and a.product_id=?  and a.login_id in(select login_id from login_master where
GET_POLICIES_LIST=select pm.application_no,(select ISNULL(a.first_name,b.COMPANY_NAME) from personal_info a,broker_company_master b,login_master c where (a.login_id in(select login_id from login_master where oa_code in(select oa_code from login_master where login_id\=pm.login_id) and usertype\='Broker') or a.customer_login_id in(select login_id from login_master where oa_code in(select oa_code from login_master where login_id\=pm.login_id) and usertype\='Broker'))  and b.agency_code\=c.agency_code and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)))) broker_name,(select ISNULL(first_name,COMPANY_NAME) from personal_info where customer_id\=(select customer_id from position_master where application_no\=pm.application_no)) customer_name, pm.login_id,pm.quote_no,md.remarks,pm.application_id,PM.STATUS from position_master pm,marine_data md where SUBSTRING(CONVERT(VARCHAR,PM.ENTRY_DATE,121),1,10)\=? and pm.application_no\=md.application_no and pm.REMARKS in ('Admin','NORMAL_EXCESS_PRICE') and md.ADMIN_REFERRAL_STATUS\='N' and pm.product_id\=? and pm.status in('Y','E') and pm.FREIGHT_STATUS is null and pm.login_id in(select login_id from login_master where
GET_POLICIES_PENDING=select (case pm.application_id when '1' then  pm.login_id else pm.application_id end) quote_Created,pm.application_no,pm.login_id,pm.quote_no,b.remarks,pm.application_id,Case when pm.STATUS='E' then 'Endt' else 'Normal' end status, c.CUSTOMER_ID, c.CUST_NAME,d.COMPANY_NAME brokername from position_master pm,marine_data b, personal_info c, broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and SUBSTRING(CONVERT(VARCHAR,PM.ENTRY_DATE,121),1,10)=? and ((pm.REMARKS in ('Referal') and b.ADMIN_REFERRAL_STATUS='N') or (pm.REMARKS in ('Admin','Normal','NORMAL_EXCESS_PRICE') and b.ADMIN_REFERRAL_STATUS='Y')) and pm.status in ('Y','E') and pm.product_id in(?) and  pm.application_no=b.application_no and pm.FREIGHT_STATUS is null AND D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and pm.login_id in(select login_id from login_master where
GET_HOMEPOLICIES_PENDING=select distinct pm.application_no, CASE WHEN pm.application_id='1' then  pm.login_id else pm.application_id end quote_Created,pm.login_id,pm.quote_no,pm.remarks,pm.REFERRAL_DESCRIPTION,ISNULL(pm.SUMMARY_REMARKS,''),pm.scheme_id,pm.application_id,Case when pm.STATUS='E' then 'Endt' else 'Normal' end status,c.CUSTOMER_ID, ISNULL(c.FIRST_NAME,c.COMPANY_NAME) CUST_NAME,d.COMPANY_NAME brokername,pm.SCHEME_ID  from home_position_master pm, personal_info c,broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and SUBSTRING(CONVERT(VARCHAR,PM.ENTRY_DATE,121),1,10)=? and pm.product_id=? and pm.REMARKS='Referal'  and pm.status in('Y','E') and pm.login_id in(select login_id from login_master where
GET_POLICIES_APPROVED=select CASE WHEN pm.application_id='1' then  pm.login_id else pm.application_id end quote_Created,pm.application_no,pm.login_id,pm.quote_no,md.remarks,pm.application_id,Case when pm.STATUS='E' then 'Endt' else 'Normal' end status, c.CUSTOMER_ID, c.CUST_NAME, d.COMPANY_NAME brokername from position_master pm,marine_data md, personal_info c,broker_company_master d  where c.CUSTOMER_ID=pm.CUSTOMER_ID and CONVERT(char(10), pm.entry_date,126) =? and pm.application_no=md.application_no and pm.REMARKS in ('Admin','NORMAL_EXCESS_PRICE') and md.ADMIN_REFERRAL_STATUS='N' and pm.product_id=? and pm.status in('Y','E') and pm.FREIGHT_STATUS is null AND D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and pm.login_id in(select login_id from login_master where
GET_HOMEPOLICIES_APPROVED=select distinct pm.application_no,CASE WHEN pm.application_id='1' then  pm.login_id else pm.application_id end quote_Created,pm.login_id,pm.quote_no,pm.remarks,pm.REFERRAL_DESCRIPTION,ISNULL(pm.SUMMARY_REMARKS,''),pm.scheme_id,pm.application_id,Case when pm.STATUS='E' then 'Endt' else 'Normal' end status,c.CUSTOMER_ID, ISNULL(c.FIRST_NAME,c.COMPANY_NAME) CUST_NAME,d.COMPANY_NAME brokername,pm.SCHEME_ID from home_position_master pm, personal_info c,broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and SUBSTRING(CONVERT(VARCHAR,PM.ENTRY_DATE,121),1,10)=? and pm.product_id=? and pm.REMARKS='Admin' and pm.status in ('Y','E') and pm.login_id in(select login_id from login_master where
GET_POLICIES_REJECTED=select CASE WHEN pm.application_id='1' then  pm.login_id else pm.application_id end quote_Created,pm.application_no,pm.login_id,pm.quote_no,md.remarks,pm.application_id,Case when pm.STATUS='E' then 'Endt' else 'Normal' end status, c.CUSTOMER_ID,c.CUST_NAME, d.COMPANY_NAME brokername from position_master pm,marine_data md, personal_info c,broker_company_master d  where c.CUSTOMER_ID=pm.CUSTOMER_ID and CONVERT(char(10), pm.entry_date,126) =? and pm.application_no=md.application_no  and pm.product_id=? and pm.status='R' AND D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and pm.login_id in(select login_id from login_master where
GET_HOMEPOLICIES_REJECTED=select distinct pm.application_no,CASE WHEN pm.application_id='1' then  pm.login_id else pm.application_id end quote_Created,pm.login_id,pm.quote_no,PM.remarks,pm.REFERRAL_DESCRIPTION,ISNULL(pm.SUMMARY_REMARKS,''),pm.scheme_id,pm.application_id,Case when pm.STATUS='E' then 'Endt' else 'Normal' end status , c.CUSTOMER_ID,ISNULL(c.FIRST_NAME,c.COMPANY_NAME) CUST_NAME,d.COMPANY_NAME brokername,pm.SCHEME_ID  from home_position_master pm, personal_info c,broker_company_master d where c.CUSTOMER_ID=pm.CUSTOMER_ID and D.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=PM.LOGIN_ID) and SUBSTRING(CONVERT(VARCHAR,PM.ENTRY_DATE,121),1,10)=? and pm.product_id=? and pm.ADMIN_REFERRAL_STATUS='N' and pm.status='R' and pm.login_id in(select login_id from login_master where
SUBSTRING_REFERAL_1=oa_code in(select agency_code from broker_company_master where branch_code in({0}))) and  (Select ISNULL(attached_uw,0) from login_master Where login_id=?) like  ''%'' + UWGRADE + ''%'' group by convert(varchar(10),a.entry_date,121) order by convert(varchar(10),a.entry_date,121) desc
SUBSTRING_REFERAL_2= oa_code=? and (Select attached_uw from login_master Where login_id=?) like  ''%'' + UWGRADE + ''%'') group by convert(varchar(10),a.entry_date,121) order by convert(varchar(10),a.entry_date,121) desc
SUBSTRING_REFERAL_3= oa_code in(select agency_code from broker_company_master where branch_code in({0})))  group by  CONVERT (VARCHAR(10), A.ENTRY_DATE, 121) order by  CONVERT (VARCHAR(10), A.ENTRY_DATE, 121) desc
SUBSTRING_REFERAL_4= oa_code=? group by CONVERT (VARCHAR(10), A.ENTRY_DATE, 121) order by  CONVERT (VARCHAR(10), A.ENTRY_DATE, 121) desc
SUBSTRING_REFERAL_5= oa_code in(select agency_code from broker_company_master where branch_code in({0}))) and  (Select attached_uw from login_master Where login_id\=?) like  ''%'' + UWGRADE + ''%''  order by quote_no desc  
SUBSTRING_REFERAL_6= oa_code\=? and (Select attached_uw from login_master Where login_id\=?) like  ''%'' + UWGRADE + ''%'')   order by quote_no desc 
SUBSTRING_REFERAL_7= oa_code in(select agency_code from broker_company_master where branch_code in({0})))   order by quote_no desc
SUBSTRING_REFERAL_8= oa_code\=?  order by quote_no desc
SEARCH_REFFERRAL=SELECT CASE WHEN PM.APPLICATION_ID='1' THEN  PM.LOGIN_ID ELSE PM.APPLICATION_ID END  QUOTE_CREATED,PM.APPLICATION_NO,PM.LOGIN_ID,PM.QUOTE_NO,MD.REMARKS,PM.APPLICATION_ID ,CASE WHEN PM.STATUS='E' THEN 'Endt' ELSE 'Normal' END STATUS, C.CUSTOMER_ID, C.CUST_NAME, D.COMPANY_NAME BROKERNAME ,PM.PRODUCT_ID PRODUCT_ID  FROM POSITION_MASTER PM,MARINE_DATA MD, PERSONAL_INFO C,BROKER_COMPANY_MASTER D  WHERE C.CUSTOMER_ID=PM.CUSTOMER_ID AND PM.APPLICATION_NO=MD.APPLICATION_NO  AND PM.REMARKS IN ('Admin','NORMAL_EXCESS_PRICE','Referal') AND MD.ADMIN_REFERRAL_STATUS='N'  AND PM.STATUS IN('Y','E') AND PM.FREIGHT_STATUS IS NULL AND  PM.QUOTE_NO=?  and D.AGENCY_CODE =(Select OA_CODE from login_master Where login_id=PM.LOGIN_ID)
MOTOR_SEARCH_REFFERRAL = SELECT PM.REMARKS,CASE WHEN PM.APPLICATION_ID='1' THEN  PM.LOGIN_ID ELSE PM.APPLICATION_ID END  QUOTE_CREATED,PM.APPLICATION_NO,PM.LOGIN_ID,PM.QUOTE_NO,PM.APPLICATION_ID,CASE WHEN PM.STATUS='E' THEN 'Endt' ELSE 'Normal' END STATUS, C.CUSTOMER_ID, C.CUST_NAME, D.COMPANY_NAME BROKERNAME ,PM.PRODUCT_ID PRODUCT_ID FROM HOME_POSITION_MASTER PM,  PERSONAL_INFO C,BROKER_COMPANY_MASTER D WHERE C.CUSTOMER_ID=PM.CUSTOMER_ID  AND PM.REMARKS IN ('Admin','NORMAL_EXCESS_PRICE','Referal')  AND PM.STATUS IN('Y','E') AND  PM.QUOTE_NO=?  and D.AGENCY_CODE =(Select OA_CODE from login_master Where login_id=PM.LOGIN_ID)
SEARCH_DEC_REFFERRAL=SELECT CASE WHEN PM.APPLICATION_ID='1' THEN  PM.LOGIN_ID ELSE PM.APPLICATION_ID END  QUOTE_CREATED,PM.APPLICATION_NO,PM.LOGIN_ID,PM.QUOTE_NO,MD.REMARKS,PM.APPLICATION_ID ,CASE WHEN PM.STATUS='E' THEN 'Endt' ELSE 'Normal' END STATUS, C.CUSTOMER_ID, C.CUST_NAME, D.COMPANY_NAME BROKERNAME ,PM.PRODUCT_ID PRODUCT_ID  FROM POSITION_MASTER PM,MARINE_DATA MD, PERSONAL_INFO C,BROKER_COMPANY_MASTER D  WHERE C.CUSTOMER_ID=PM.CUSTOMER_ID AND PM.APPLICATION_NO=MD.APPLICATION_NO  AND PM.REMARKS IN ('NORMAL_EXCESS_PRICE','Referal') AND MD.ADMIN_REFERRAL_STATUS='N'  AND PM.STATUS IN('Y','E') AND PM.FREIGHT_STATUS IS NULL AND  PM.APPLICATION_NO in  (select APPLICATION_NO from webservice_marine_quote where  TRANSACTION_ID=?)  and D.AGENCY_CODE =(Select OA_CODE from login_master Where login_id=PM.LOGIN_ID)
#Open Cover
GET_QUOTE_REGISTER_LIST=select distinct(a.proposal_no),ISNULL(a.open_cover_no,'0'),ISNULL(convert(varchar(10),b.policy_start_date,103),' ') start_date,ISNULL(convert(varchar(10),b.policy_end_date,103),' ') end_date,ISNULL(first_name,company_name) cust_name,RENEWAL_STATUS,b.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_master b,personal_info c where a.status='Y' and a.original_policy_no is null and a.proposal_no = b.proposal_no and b.amend_id = (select max(amend_id) from open_cover_master b where b.proposal_no = a.proposal_no) and a.proposal_no in (select proposal_no from open_cover_master where broker_id=?) and c.customer_id =b.customer_id order by a.proposal_no desc
GET_PORTFOLIO_LIST=select convert(varchar(10),a.entry_date,101)ENTRY_DATE,count(a.entry_date)as COU from position_master a,marine_data b,personal_info c where  a.entry_date between convert(date,?,101) and convert(date,?,101) and a.remarks in (?) and (b.ADMIN_REFERRAL_STATUS in(?) or b.ADMIN_REFERRAL_STATUS is null) and a.customer_id\=c.customer_id and a.application_no\=b.application_no  and  a.product_id in (11,3) and lower(a.status) in(?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)))  group by convert(varchar(10),a.entry_date,101) order by convert(varchar(10),a.entry_date,101) desc
GET_LCDETAIL_LIST=select A.OPEN_COVER_NO, A.BANK_ID,(SELECT DISTINCT(BANK_NAME) FROM OPEN_COVER_BANK_MASTER WHERE A.BANK_ID=BANK_ID AND STATUS='Y') bank_name, A.LC_NUMBER, CONVERT(VARCHAR,A.LC_DATE,103) LC_DATE, A.LC_AMOUNT, CONVERT(VARCHAR,A.ENTRY_DATE,103) ENTRY_DATE, CONVERT(VARCHAR,A.EXPIRY_DATE,103) EXPIRY_DATE, CONVERT(VARCHAR,A.EFFECTIVE_DATE,103) EFFECTIVE_DATE, A.AMEND_ID, A.REMARKS, A.STATUS, A.LC_ID, A.LC_CURRENCY_ID, (select currency_name from currency_master where currency_id=A.LC_CURRENCY_ID and status='Y' and amend_id=(select max(amend_id) from currency_master where currency_id=A.LC_CURRENCY_ID and COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and status='Y')) currency_name from OPEN_COVER_LC_MASTER A where  A.OPEN_COVER_NO=? and A.LC_NUMBER not in ('None','NONE')
GET_UNDERWRITER_LIST=select login_id, username from login_master where usertype = 'RSAIssuer' and status = 'Y'  and branch_code=?
GET_BROKER_REPORT_LIST=select b.company_name,l.login_id from login_master l,broker_company_master b where l.oa_code=b.agency_code and l.login_id in(select distinct login_id from personal_info where login_id in(select login_id from login_master where USERTYPE='Broker' and agency_code in(select agency_code from login_user_details where product_id in('65','30','75','23','31','100','32') and agency_code in (select agency_code from login_master where oa_code in(select oa_code from login_master where USERTYPE='Broker')))) and login_id!='NONE' and application_id in ('2')) and l.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?))) order by b.company_name
#REPORTS
GET_COMMODITY_LIST=select commodity_name, commodity_id  from commoditymaster cm where cm.status in ('Y','R') and cm.branch_code=? and cm.amend_id+ ' ' +'-'+ ' ' +cm.commodity_id in(select max(amend_id)+ ' ' +'-'+ ' ' +commodity_id from commoditymaster where convert(date,effective_date,103) <=convert(date,SYSDATETIME(),103) and status in ('Y','R') and branch_code=? group by commodity_id) order by cm.commodity_id
GET_TRANSPORT_MODE_LIST=select transport_description, mode_transport_id from mode_of_transport where status = 'Y' and branch_code=?
GET_COVER_LIST=select cover_id,cover_name,mode_transport_id from cover_master where status = 'Y' and branch_code=? and mode_transport_id in(select mode_transport_id from mode_of_transport where status = 'Y' and branch_code=?)

#LC Master
GET_LCNUMBER_OC_COUNT=select * from (select count(oclm.LC_NUMBER) lc_number_count,pi.login_id from BROKER_COMPANY_MASTER bcm,personal_info pi,OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm,OPEN_COVER_LC_MASTER oclm where bcm.agency_code=pi.agency_code and pi.APPLICATION_ID='2' and oclm.LC_NUMBER!='NONE' and ocm.broker_id=pi.login_id and ocm.proposal_no=ocpm.proposal_no and ocpm.STATUS not in('Y') and bcm.branch_code=? and oclm.open_cover_no=ocpm.open_cover_no and ocm.amend_id+ ' ' +'-'+ ' ' +ocm.proposal_no in (select max(ocms.amend_id)+ ' ' +'-'+ ' ' +ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no group by ocms.proposal_no) group by pi.login_id) a right outer join (select count(distinct(ocpm.open_cover_no)) open_cover_count, bcm.company_name,pi.login_id login_id_1 from BROKER_COMPANY_MASTER bcm,personal_info pi,OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm,OPEN_COVER_LC_MASTER oclm where bcm.agency_code=pi.agency_code and pi.APPLICATION_ID='2' and ocm.broker_id=pi.login_id and ocm.proposal_no=ocpm.proposal_no and ocpm.STATUS not in('Y') and bcm.branch_code=? and oclm.open_cover_no=ocpm.open_cover_no and ocm.amend_id+ ' ' +'-'+ ' ' +ocm.proposal_no in (select max(ocms.amend_id)+ ' ' +'-'+ ' ' +ocms.proposal_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no group by ocms.proposal_no) group by bcm.company_name,pi.login_id ) b on a.login_id=b.login_id_1
GET_LCDETAILS_LIST=SELECT distinct(ocpm.open_cover_no), ocm.customer_id,convert (varchar(10),ocpm.inception_date, 103) inception_date, convert (varchar(10),ocpm.expiry_date, 103) expiry_date, PI.FIRST_NAME+ ' ' +ocm.broker_id cust_name, ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ISNULL (OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) FROM BROKER_COMPANY_MASTER bcm, personal_info pi, OPEN_COVER_MASTER ocm, OPEN_COVER_POSITION_MASTER ocpm, OPEN_COVER_LC_MASTER oclm WHERE ocm.broker_id IN (?) and oclm.LC_NUMBER!='NONE' and bcm.agency_code = pi.agency_code AND pi.APPLICATION_ID = '2' AND ocm.broker_id = pi.login_id AND ocm.proposal_no = ocpm.proposal_no AND ocpm.STATUS NOT IN ('Y') AND bcm.branch_code =? AND oclm.open_cover_no = ocpm.open_cover_no AND ocm.amend_id + ' ' + '-' + ' ' + ocm.proposal_no IN ( SELECT MAX (ocms.amend_id) + ' ' + '-' + ' ' + ocms.proposal_no FROM open_cover_master ocms, open_cover_position_master ocpms WHERE ocpms.proposal_no = ocms.proposal_no GROUP BY ocms.proposal_no)
GET_OCDETAILS_LIST=SELECT distinct(ocpm.open_cover_no), oclm.LC_NUMBER, ocm.customer_id,convert (varchar(10),ocpm.inception_date, 103) inception_date, convert (varchar(10),ocpm.expiry_date, 103) expiry_date, PI.FIRST_NAME+ ' ' +ocm.broker_id cust_name, ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ISNULL (OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) FROM BROKER_COMPANY_MASTER bcm, personal_info pi, OPEN_COVER_MASTER ocm, OPEN_COVER_POSITION_MASTER ocpm, OPEN_COVER_LC_MASTER oclm WHERE ocm.broker_id IN (?) and bcm.agency_code = pi.agency_code AND pi.APPLICATION_ID = '2' AND ocm.broker_id = pi.login_id AND ocm.proposal_no = ocpm.proposal_no AND ocpm.STATUS NOT IN ('Y') AND bcm.branch_code = ? AND oclm.open_cover_no = ocpm.open_cover_no AND ocm.amend_id + ' ' + '-' + ' ' + ocm.proposal_no IN ( SELECT MAX (ocms.amend_id) + ' ' + '-' + ' ' + ocms.proposal_no FROM open_cover_master ocms, open_cover_position_master ocpms WHERE ocpms.proposal_no = ocms.proposal_no GROUP BY ocms.proposal_no)
GET_LCOC_DETAILS_LIST=select A.OPEN_COVER_NO,((SELECT EXCHANGE_RATE  FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND amend_id = (SELECT MAX (amend_id) FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID))*A.LC_AMOUNT)-A.LC_BALANCE_AMOUNT used_amt, ((SELECT EXCHANGE_RATE  FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y' AND amend_id = (SELECT MAX (amend_id) FROM exchange_master WHERE currency_id = A.LC_CURRENCY_ID))*A.LC_AMOUNT) ACTUAL_AMT, A.BANK_ID,(SELECT DISTINCT (BANK_NAME) FROM   OPEN_COVER_BANK_MASTER WHERE   A.BANK_ID = BANK_ID AND STATUS = 'Y') bank_name,A.LC_NUMBER,convert(varchar(10),A.LC_DATE,103) LC_DATE,A.LC_AMOUNT,A.ENTRY_DATE,CONVERT(VARCHAR,A.EXPIRY_DATE,103) EXPIRY_DATE,A.EFFECTIVE_DATE,A.AMEND_ID,A.REMARKS,A.STATUS,A.LC_ID,A.LC_CURRENCY_ID, A.LC_BALANCE_AMOUNT, (SELECT currency_name FROM currency_master WHERE currency_id = A.LC_CURRENCY_ID AND status = 'Y'  AND amend_id = (SELECT MAX (amend_id) FROM currency_master WHERE currency_id = A.LC_CURRENCY_ID AND COUNTRY_ID = (SELECT   ORIGINATION_COUNTRY_ID FROM   BRANCH_MASTER WHERE   BRANCH_CODE =?) AND status = 'Y'))currency_name from OPEN_COVER_LC_MASTER A  where  A.OPEN_COVER_NO=? and A.LC_NUMBER not in ('None','NONE')
GET_Bank_List=select bank_id,bank_name,amend_id from open_cover_bank_master where amend_id+ ' ' +'-'+ ' ' +bank_id in (select max(amend_id)+ ' ' +'-'+ ' ' +bank_id from open_cover_bank_master where convert(date,effective_date,103)<=convert(varchar(10),SYSDATETIME(),103) and status in('N','Y') and BELONGING_COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) group by bank_id) and BELONGING_COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) and status='Y' and bank_id not in ('99999') order by bank_name
GET_SALE_LIST=select sale_term_id, sale_term_name from sale_term_master where status='Y' and BRANCH_CODE=? order by sale_term_name
GET_CURRENCY_LIST=select distinct(b.currency_id),b.currency_name,a.amend_id,a.effective_date,a.exchange_rate from exchange_master a, currency_master b where a.COUNTRY_ID=b.COUNTRY_ID and b.COUNTRY_ID='1' and a.currency_id=b.currency_id and a.amend_id+ ' ' +a.exchange_id+ ' ' +a.currency_id in(select max(amend_id)+ ' ' +exchange_id+ ' ' +currency_id from exchange_master where effective_date <=SYSDATETIME() and status='Y' and COUNTRY_ID=(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?) group by exchange_id,currency_id)  and a.effective_date <=SYSDATETIME() and a.status='Y' and b.status='Y' and b.status='Y' and a.status='Y'
INS_LCNEW_VALUE=insert into open_cover_lc_master (lc_number,lc_amount,bank_id,AMEND_ID,LC_DATE,EFFECTIVE_DATE,ENTRY_DATE,Expiry_DATE,REMARKS,STATUS,open_cover_no,lc_currency_id,LC_BALANCE_AMOUNT,LC_ACTUAL_AMOUNT,LC_SALE_TERM_ID) values(?,?,?,?,CONVERT(DATE,?,103),SYSDATETIME(),SYSDATETIME(),CONVERT(DATE,?,103),?,?,?,(select ISNULL(max(lc_id),'0')+1 lc_id from open_cover_lc_master where open_cover_No=?),?,?,?,?)
UPD_LCNEW_VALUE= update open_cover_lc_master set lc_amount=?,bank_id=?,AMEND_ID=?,LC_DATE=CONVERT(VARCHAR(10), ?, 121) ,EXPIRY_DATE=CONVERT(VARCHAR(10), ?, 121),EFFECTIVE_DATE=SYSDATETIME(),ENTRY_DATE=SYSDATETIME(),lc_currency_id=?,status=?,LC_BALANCE_AMOUNT=?,LC_ACTUAL_AMOUNT=?,LC_SALE_TERM_ID=? where open_cover_NO=? and lc_number=? and lc_id=?
GET_EXCHANGE_RATE=select ISNULL(exchange_rate,'0') from exchange_master where currency_id=? and status='Y' and COUNTRY_ID=? and amend_id=(select max(amend_id) from exchange_master where currency_id=? and status='Y' and COUNTRY_ID=?)
GET_COUNTRY_ID=select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE\=?
GET_LCINFO_LIST=select lc_number,lc_amount,bank_id, convert(varchar(10),LC_DATE,103) LC_DATE, convert(varchar(10),Expiry_DATE,103) Expiry_DATE, lc_id, lc_currency_id, LC_SALE_TERM_ID, status from open_cover_lc_master where open_cover_No=? and lc_id=? and lc_number=?
DEL_LC_NUMBER=delete from OPEN_COVER_LC_MASTER where OPEN_COVER_NO\=? and lc_number\=? and LC_ID\=?


##Admin Management
GET_MENU_LIST=select A.CATEGORY_DETAIL_ID, A.DETAIL_NAME, A.REMARKS, A.STATUS, (case STATUS when  'Y' then 'Active' when 'N' then 'DeActive' when 'D' then 'Delete' when 'L' then 'Locked' end) STATUS1, (select DETAIL_NAME from CONSTANT_DETAIL where A.PARENT_MENU= convert(varchar,CATEGORY_DETAIL_ID) AND CATEGORY_ID='41' and BRANCH_CODE=A.BRANCH_CODE) PARENT_MENU_NAME, PARENT_MENU from CONSTANT_DETAIL A where CATEGORY_ID='41' and BRANCH_CODE=?
GET_UTYPE_LIST=select category_detail_id,detail_name from constant_detail where category_id=40 and status='Y' and branch_code=? and remarks=?
GET_ADMIN_LIST=select a.LOGIN_ID, a.USERNAME, a.USERID,userType, a.BRANCH_CODE, (select BRANCH_NAME from branch_master where a.BRANCH_CODE=BRANCH_CODE) branch_name , STATUS, (case STATUS when 'Y' then 'Active' when 'N' then 'DeActive' when 'D' then 'Delete' when 'L' then 'Locked' when 'T' then 'Locked' end) STATUS1, A.PRODUCT_ID, a.MENU_ID, a.BROKER_CODES, a.USER_MAIL,a.ATTACHED_UW ATTACHED_UW,a.ATTACHED_BRANCH ATTACHED_BRANCH from LOGIN_MASTER a where a.USERID in('2','4') and a.BRANCH_CODE=?
GET_RIMASTER=select CATEGORY_DETAIL_ID CODE,DETAIL_NAME CODEDESC  from constant_Detail where CATEGORY_ID = 157 AND STATUS = 'Y' order by CATEGORY_DETAIL_ID
INS_NEW_MENU=INSERT INTO menu_master(menu_id, menu_NAME, menu_url, STATUS, RSACODE, BRANCH_CODE, PARENT_MENU) VALUES ((select max(menu_id)+1 from menu_master where BRANCH_CODE=?), ?, ?, ?, (select max(menu_ID)+1 from menu_master where BRANCH_CODE=?), ?, ?)
UPD_EXIST_MENU=UPDATE menu_master SET menu_NAME=?, menu_url=?, STATUS=?, PARENT_MENU=? WHERE menu_ID=? AND BRANCH_CODE=?
INS_NEW_ADMIN_USER=insert into login_master(LOGIN_ID,PASSWORD,USERTYPE,USERNAME,USERID,AGENCY_CODE,OA_CODE,COMPANY_ID,CREATED_BY,STATUS,USER_ID_CREATION,AC_EXECUTIVE_CREATION, ACCESSTYPE,PASSDATE,BRANCH_CODE,COUNTRY_ID,MENU_ID,PRODUCT_ID,broker_codes, APP_ID, PWD_COUNT, USER_MAIL,ATTACHED_UW,ATTACHED_BRANCH,ENTRY_DATE) values (?,?,?,?,'2',?,?,?,?,?,?,?,?,dateadd(day,45,GETDATE()),?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE\=?),?,?,?,'16','0',?,?,?,SYSDATETIME())
UPD_EXIST_ADMIN_USER=update login_master set USERNAME=?, USERTYPE=?, USERID=?, STATUS=?, PASSDATE=dateadd(day,45,GETDATE()), MENU_ID=?, PRODUCT_ID=?, USER_MAIL=?, broker_codes=?,ATTACHED_UW=?,ATTACHED_BRANCH=?,PWD_COUNT='0' where LOGIN_ID=?
UPD_EXIST_ADMIN_USER_PWD=update login_master set USERNAME=?, PASSWORD=?, USERTYPE=? , USERID=?, STATUS=?, PASSDATE=dateadd(day,45,GETDATE()), MENU_ID=?, PRODUCT_ID=?, USER_MAIL=?, broker_codes=?,ATTACHED_UW=?,ATTACHED_BRANCH=?,PWD_COUNT='0' where LOGIN_ID=?

GET_BRANCH_NAME=SELECT DISTINCT(BRANCH_NAME) FROM BRANCH_MASTER WHERE BRANCH_CODE\=?

##Home by raja
GET_HOME_PREMIUM_DETAILS=select ofm.coverages_display_name,odd.COVERAGES_SUMINSURED,odd.COVERAGES_id,odd.PREMIUM_AMOUNT from ofs_master ofm,ofs_data_details odd where odd.coverages_id=ofm.coverages_id and ofm.coverages_id in (select COVERAGES_ID from OFS_DATA_DETAILS where quote_no=? and amend_id+ ' ' +PRODUCT_ID+ ' ' +SCHEME_ID+ ' ' +CONTENT_TYPE_ID in (select max(amend_id)+ ' ' +PRODUCT_ID+ ' ' +SCHEME_ID+ ' ' +CONTENT_TYPE_ID from OFS_DATA_DETAILS where quote_no= ? and PRODUCT_ID =? and SCHEME_ID =? and COVERAGES_Y_N_OPTION ='Y' group by PRODUCT_ID,SCHEME_ID,CONTENT_TYPE_ID ) and COVERAGES_Y_N_OPTION ='Y' group by PRODUCT_ID,SCHEME_ID,CONTENT_TYPE_ID,COVERAGES_ID ) and odd.status='Y' and odd.quote_no= ? and odd.PRODUCT_ID =? and odd.SCHEME_ID =? and odd.COVERAGES_Y_N_OPTION ='Y' and odd.content_type_id=? order by odd.COVERAGES_id
GET_HOME_SUB_LIST=select DISPLAY_NAME, DISPLAY_TYPE, DISPLAY_ORDER, DEST_TABLE, DEST_COLUMN, DROPDOWN_KEY, DROPDOWN_VALUE, DROPDOWN_TABLE, VALIDATION_TYPE, Mandatory,TOTAL_SUMINSURED_YN from ofs_config_master where coverages_id\=? and coverages_sub_id\=? and product_id\=? and scheme_id\=? and content_type_id\=? and STATUS\='Y' and coverages_id+ ' ' +amend_id\=(select coverages_id+ ' ' +max(amend_id) from ofs_config_master where coverages_id\=? and coverages_sub_id\=? and product_id\=? and scheme_id\=? and content_type_id\=? group by coverages_id) order by display_order,ofs_config_id
GET_HOME_COVERAGES_DETAILS=select * from OFS_TRANSACTION_DETAILS where QUOTE_NO\=? AND COVERAGES_ID\=? AND COVERAGES_SUB_ID\=? AND product_id\=? and scheme_id\=? and content_type_id\=? and AMEND_ID\=(select max(AMEND_ID) from OFS_TRANSACTION_DETAILS where QUOTE_NO\=?)
GET_HOME_MAX_AMENDID_COVERAGE=SELECT MAX(AMEND_ID) FROM OFS_TRANSACTION_DETAILS WHERE QUOTE_NO=?
GET_HOME_UW_MENU=SELECT UW_ID, UW_DESCRIPTION FROM HOME_UW_MASTER WHERE PRODUCT_ID\=? AND SCHEME_ID\=? AND STATUS\='Y' ORDER BY DISPLAY_ORDER
GET_HOME_COVER_ID=select cover_id,cover_description from home_cover_master where product_id=? and cover_id not in(7) and status='Y'
GET_HOME_UW_DETAILS=select QUOTE_NO,    ISNULL(LTRIM(RTRIM(BUILT_OF_CONCRETE)),'N') BUILT_OF_CONCRETE, PRIVATE_LIVING_ACCOMODATION, BUILT_ON_RECLAIMED_LAND, UNATTENDED_60_CONSECUTIVE_DAYS, DECLINED_CANELLED_CONDITIONS, ANY_CLAIM_IN_3YRS, NO_OF_CLAIMS, TYPE_OF_CLAIMS, CLAIM_AMOUNT, PROPERTY_TYPE from HOME_UW_QUESTIONS where QUOTE_NO=?
INS_HOME_UW_DETAILS=Insert into HOME_UW_QUESTIONS (QUOTE_NO, BUILT_OF_CONCRETE, PRIVATE_LIVING_ACCOMODATION, BUILT_ON_RECLAIMED_LAND, UNATTENDED_60_CONSECUTIVE_DAYS, DECLINED_CANELLED_CONDITIONS, ANY_CLAIM_IN_3YRS, NO_OF_CLAIMS, TYPE_OF_CLAIMS, CLAIM_AMOUNT, PROPERTY_TYPE) Values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
UPD_HOME_UW_DETAILS=Update HOME_UW_QUESTIONS set BUILT_OF_CONCRETE=?, PRIVATE_LIVING_ACCOMODATION=?, BUILT_ON_RECLAIMED_LAND=?, UNATTENDED_60_CONSECUTIVE_DAYS=?, DECLINED_CANELLED_CONDITIONS=?, ANY_CLAIM_IN_3YRS=?, NO_OF_CLAIMS=?, TYPE_OF_CLAIMS=?, CLAIM_AMOUNT=?, PROPERTY_TYPE=? where QUOTE_NO=?
GET_HOME_REFERAL_STATUS=select ISNULL(REFERAL,'N') REFERAL from login_master where LOGIN_ID\=?
UPD_HOME_REF_STATUS=UPDATE HOME_POSITION_MASTER SET EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()),REMARKS=?,SUMMARY_REMARKS= ?,ADMIN_REFERRAL_STATUS = ?, REFERRAL_DESCRIPTION = ?, APPLICATION_ID=? WHERE QUOTE_NO = ?
UPD_HOME_MODEOFPAY=UPDATE HOME_POSITION_MASTER SET SUMMARY_CLAUSES=?,AIRMILES_NO=?, INSURANCE_DETAILS=?,PAYMENT_MODE=?,CSH_ID_TYP_CODE=?,EFFECTIVE_DATE=DATEADD(DAY,30,SYSDATETIME()), APPLICATION_ID=? WHERE QUOTE_NO=?
GET_HOME_POLICY_STATUS=SELECT ISNULL(STATUS,'Y') STATUS,POLICY_NO,RECEIPT_NO,DEBIT_NOTE_NO FROM HOME_POSITION_MASTER WHERE QUOTE_NO=? AND (PRODUCT_ID=? OR PROPOSAL_NO=?)
GET_HOME_COUNT_OFS_DATA=select count(1) from OFS_DATA where quote_no=?
GET_HOME_COUNT_POSITION_MASTER=select count(1) from HOME_POSITION_MASTER where quote_no\=?
GET_HOME_BROKER_POLICYFEES=SELECT ISNULL(BM.POLICY_FEE,0) POLICY_FEE FROM LOGIN_MASTER LM,BROKER_MASTER BM WHERE LM.OA_CODE=BM.AGENCY_CODE AND LM.LOGIN_ID=(SELECT LOGIN_ID FROM HOME_POSITION_MASTER WHERE QUOTE_NO=?) AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM BROKER_MASTER B,LOGIN_MASTER L WHERE L.OA_CODE=B.AGENCY_CODE AND L.LOGIN_ID=(SELECT LOGIN_ID FROM HOME_POSITION_MASTER WHERE QUOTE_NO=?) AND B.AGENCY_CODE=L.OA_CODE)
UPD_HOME_REFERRAL_STATUS=UPDATE HOME_POSITION_MASTER SET REMARKS\=?,ADMIN_REMARKS\=?,EXCESS_PREMIUM\=?,ADMIN_REFERRAL_STATUS\='N',STATUS\=?,EXCESS_SIGN\=?, EFFECTIVE_DATE\=DATEADD(DAY,30,SYSDATETIME()),OVERALL_PREMIUM\=?, APPROVED_BY\=(SELECT ISNULL(USERNAME,' ') FROM LOGIN_MASTER WHERE LOGIN_ID\=?),PREMIUM\=?, POLICY_FEE\=? WHERE QUOTE_NO\=?
GET_HOME_BASERATE=select ISNULL((BASE_RATE),'0') BASE_RATE, CALC_TYPE, MINIMUM_PREMIUM from OFS_GRID_MASTER where ? between START_SUMINSURED and END_SUMINSURED and STATUS='Y' AND ( PRODUCT_ID=? and SCHEME_ID=? and CONTENT_TYPE_ID=? and COVERAGES_ID=? and COVERAGES_SUB_ID=?) and AMEND_ID+ ' ' +COVERAGES_ID+ ' ' +COVERAGES_SUB_ID IN (select MAX(AMEND_ID)+ ' ' +COVERAGES_ID+ ' ' +COVERAGES_SUB_ID FROM OFS_GRID_MASTER WHERE PRODUCT_ID=? and SCHEME_ID=? and CONTENT_TYPE_ID=? GROUP BY COVERAGES_ID,COVERAGES_SUB_ID)
GET_HOME_FORMULA_SUM=select formula from formula_master where product_id\=? and scheme_id\=? and coverage_id\=? and status\='Y'
GET_HOME_FORMULA_COUNT=select count(*) from formula_master where product_id=? and scheme_id=? and coverage_id=? and status='Y'
GET_HOME_SUBCOVERAGES=select a.COVERAGES_SUB_ID,a.COVERAGES_ID,b.COVERAGES_DISPLAY_NAME,a.SUB_COVERAGES_LIMIT,a.SUB_RATE, a.PRODUCT_ID,a.SUB_CONTROL_TYPE,a.SUB_DISPLAY_ORDER,a.CALC_TYPE,a.REMARKS,a.SUM_INSURED_LIMIT from OFS_COVERAGES_SUB_MASTER a,OFS_MASTER b where a.COVERAGES_SUB_ID=b.COVERAGES_ID and a.CONTENT_TYPE_ID=? and a.product_id=? and a.scheme_id=? and a.status='Y' and a.amend_id+ ' ' +a.coverages_id+ ' ' +a.coverages_sub_id in (select max(amend_id)+ ' ' +coverages_id+ ' ' +coverages_sub_id from OFS_COVERAGES_SUB_MASTER where CONTENT_TYPE_ID=? and product_id=? and scheme_id=? group by coverages_id,coverages_sub_id) and ( convert(date,(select  convert(varchar(10),inception_date,103) from home_position_master where quote_no=?),103) between convert(date,a.effective_date,103) and convert(date,a.expiry_date,103) order by a.sub_display_order
GET_HOME_REFERRAL_INFO=select ADMIN_REFERRAL_STATUS,REFERRAL_DESCRIPTION from HOME_POSITION_MASTER where quote_no=? and product_id=? and scheme_id=?
GET_HOME_MINIMUM_PREMIUM=select minimum_premium from OFS_CONTENT_MASTER where  product_id=? and scheme_id=? and CONTENT_TYPE_ID=?
GET_HELP_INFO=SELECT (select HELP_DESCRIPTION from OFS_HELP_MASTER WHERE HELP_CONTENTS_ID=?) HELP_DESCRIPTION, COVERAGES_NAME FROM OFS_MASTER WHERE coverages_id=?
GET_HOME_COMM=SELECT ISNULL (COMMISSION, '0') COMMISSION FROM LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM WHERE LUD.AGENCY_CODE = LM.OA_CODE AND LM.LOGIN_ID = ? AND LM.STATUS = 'Y' AND LUD.STATUS = 'Y' AND LUD.PRODUCT_ID =  ? AND LUD.SCHEME_ID=? AND LUD.AMEND_ID = ( SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=LM.LOGIN_ID AND PRODUCT_ID=LUD.PRODUCT_ID)
GET_HOME_POLICYFEE_CALCULATION=select PREMIUM, EXCESS_PREMIUM, EXCESS_SIGN, OVERALL_PREMIUM from HOME_POSITION_MASTER where QUOTE_NO=?
UPD_HOME_PREMIUM_INFO=UPDATE HOME_POSITION_MASTER SET POLICY_FEE\=?, OVERALL_PREMIUM\=? WHERE QUOTE_NO\=?
GET_GRID_MASTER_DETAILS=select distinct(COVERAGES_ID), CALC_TYPE from ofs_grid_master ogm  where PRODUCT_ID=? and SCHEME_ID=? and CONTENT_TYPE_ID=? and amend_id=(select max(amend_id) from ofs_grid_master where ogm.COVERAGES_ID=COVERAGES_ID and status='Y')
UPD_HOME_PREMIUM_DETAILS=update HOME_POSITION_MASTER set overall_premium\=?, premium\=? {0} where quote_no\=? and product_id\=? and scheme_id\=?
UPDATE_HOME_DATA_OPTIONAL=UPDATE OFS_DATA_SUB_DETAILS SET amend_id\=?, coverages_covered_employees\=?, premium_amount\=?, COVERAGES_SUB_BASE_RATE\=?, status\=? WHERE quote_no\=? AND coverages_id\=? AND COVERAGES_SUB_ID\=? AND scheme_id\=? and content_type_id\=? and product_id\=?
GET_COVERAGE_EXIST=select count(1) from ofs_data_details where PRODUCT_ID=? and SCHEME_ID=? and CONTENT_TYPE_ID=? and COVERAGES_ID=? and QUOTE_NO=?
GET_SUB_COVERAGE_EXIST=select count(1) from ofs_data_sub_details where PRODUCT_ID\=? and SCHEME_ID\=? and CONTENT_TYPE_ID\=? and COVERAGES_ID\=? and COVERAGES_SUB_ID\=? and QUOTE_NO\=?
UPD_HOME_QUOTE_SAVE=UPDATE HOME_POSITION_MASTER SET STATUS=? WHERE QUOTE_NO=?
HOME_INS_COVERAGE_DETAILS=Insert into OFS_TRANSACTION_DETAILS(QUOTE_NO, PRODUCT_ID, SCHEME_ID, CONTENT_TYPE_ID, COVERAGES_ID, COVERAGES_SUB_ID, MORE_DETAILS_ID {0},AMEND_ID, STATUS) values (?,?,?,?,?,?,? {1}, ?,?)
UPDATE_HOME_PREMIUM=UPDATE HOME_POSITION_MASTER SET INCEPTION_DATE\=TO_TIMESTAMP(?,''DD/MM/YYYY''), EXPIRY_DATE\=TO_TIMESTAMP(?,''DD/MM/YYYY''), OVERALL_PREMIUM\=?,PREMIUM\=? {0} WHERE QUOTE_NO\=? AND PRODUCT_ID\=? AND SCHEME_ID\=?
HOME_DEL_COVERAGE_DETAILS=delete from OFS_TRANSACTION_DETAILS where quote_no\=? and product_id\=? and scheme_id\=? and CONTENT_TYPE_ID\=? and COVERAGES_ID\=? and COVERAGES_SUB_ID\=?
GET_HOME_ADMIN_SCHEMEID=select scheme_id, CONTENT_TYPE_ID from home_position_master where quote_no=?
GET_HOME_PERSONAL_INFO=SELECT pi.CUSTOMER_ID, pi.FIRST_NAME+ ' ' +pi.LAST_NAME CUST_NAME, pi.EMIRATE, pi.OCCUPATION, (select distinct(OCCUPATION_NAME) from HOME_OCCUPATION_MASTER where OCCUPATION_ID=pi.OCCUPATION) OCCUPATION_NAME, pi.TELEPHONE, pi.MOBILE, pi.FAX, pi.EMAIL from PERSONAL_INFO pi where pi.customer_id=?
GET_UW_MASTER_MENU=SELECT hum.UW_ID, hum.UW_DESCRIPTION, hum.DISPLAY_ORDER, hum.DISPLAY_TYPE, hum.DROPDOWN_KEY, hum.DROPDOWN_VALUE, hum.DROPDOWN_TABLE, hum.VALIDATION_TYPE, hum.DEST_TABLE, hum.DEST_COLUMN, hum.MANDATORY, hum.EXPECTED_RESULT FROM HOME_UW_MASTER hum WHERE AMEND_ID=(SELECT AMEND_ID FROM HOME_UW_MASTER WHERE hum.UW_ID=UW_ID) AND STATUS='Y' ORDER BY DISPLAY_ORDER
GET_HOME_QUOTE_PERSONAL_INFO=SELECT a.quote_no, c.title, c.customer_id, (c.first_name + ' ' + c.company_name) cust_name, c.EMIRATE,a.ACTIVITY_PROFESSION,a.FREEZONE_OTHERS, e.application_no, e.SUMMARY_REMARKS, c.last_name, e.status, e.PAYMENT_MODE, c.address1, c.address2,c.EMIRATE, ISNULL((select d.content_description from OFS_CONTENT_MASTER d where a.content_value \= d.content_type_id AND d.product_id \= e.product_id AND d.scheme_id \= e.scheme_id AND d.content_type_id \= e.content_type_id),' '), (CASE WHEN a.PROF_OTHERS IS NOT NULL THEN (ISNULL((select f.profession from OFS_ACT_PROF_MASTER f where a.activity_profession \= f.activity_profession AND f.scheme_id \= e.scheme_id),' ') + ' ' + '-' + ' ' + a.PROF_OTHERS) ELSE ISNULL((select f.profession from OFS_ACT_PROF_MASTER f where a.activity_profession \= f.activity_profession AND f.scheme_id \= e.scheme_id),' ') END), (CASE WHEN a.freezone_others IS NOT NULL THEN (ISNULL((select g.freezone_description from OFS_FREEZONE_MASTER g where a.freezone \= g.freezone),' ') + ' ' + '-' + ' ' + a.freezone_others) ELSE ISNULL((select g.freezone_description from OFS_FREEZONE_MASTER g where a.freezone \= g.freezone),' ') END), i.CONTACT_PERSON, i.company_name, e.premium, e.OVERALL_PREMIUM,e.EXCESS_SIGN,ISNULL(e.EXCESS_PREMIUM,'0')EXCESS_PREMIUM,E.POLICY_FEE,convert (varchar(10),c.dob, 103) dob, c.OCCUPATION, INITCAP (c.country), c.POBOX, c.TELEPHONE, c.mobile, c.FAX, c.EMAIL, convert (varchar(10),e.effective_date, 103) effective_date, convert (varchar(10),e.expiry_date, 103) expiry_date, e.summary_remarks, e.admin_summary_status, e.admin_remarks,  e.admin_referral_status, ISNULL (e.remarks, ' '), ISNULL((select d.content_type_id from OFS_CONTENT_MASTER d where a.content_value \= d.content_type_id AND d.product_id \= e.product_id AND d.scheme_id \= e.scheme_id AND d.content_type_id \= e.content_type_id),'0'), e.referral_description, convert(varchar(10),e.INCEPTION_DATE,103) INCEPTION_DATE, convert(varchar(10),dateadd(day,-30,e.EFFECTIVE_DATE),103) QUOTATION_DATE, convert(varchar(10),e.INCEPTION_DATE,103) INCEPTION_DATE1 FROM OFS_DATA a, PERSONAL_INFO c,  HOME_POSITION_MASTER e, LOGIN_MASTER h, BROKER_COMPANY_MASTER i WHERE  a.quote_no \= ?  AND a.amend_id IN (SELECT   MAX (amend_id) FROM   OFS_DATA WHERE   quote_no \= ?)  AND a.customer_id \= c.customer_id AND a.quote_no \= e.quote_no AND e.login_id \= h.login_id  AND h.oa_code \= i.agency_code  AND e.quote_no \= ?
UPD_HOME_ADMIN_REMARKS=UPDATE HOME_POSITION_MASTER SET REMARKS=?, ADMIN_REFERRAL_STATUS=?, SUMMARY_REMARKS=? WHERE QUOTE_NO=?

##HomeAdmin Added by Raja.K
GET_HOME_SCHEME_LIST=SELECT sm.SCHEME_ID, sm.SCHEME_NAME, sm.DISPLAY_ORDER, sm.PRODUCT_ID, pm.product_name, sm.REMARKS, sm.RSACODE, sm.BRANCH_CODE,  bm.branch_name, sm.STATUS, (case sm.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) status1 FROM OFS_SCHEME_MASTER sm,product_master pm, branch_master bm WHERE pm.product_id = sm.product_id and bm.BRANCH_CODE = sm.BRANCH_CODE and bm.BRANCH_CODE=?
GET_PRODUCT_LIST=select PRODUCT_ID,PRODUCT_NAME from product_master where PRODUCT_ID in (?) and status='Y'
GET_HOME_BRANCH_LIST=select distinct(branch_code), branch_name from branch_master
GET_HOME_ADMIN_COVERAGES_LIST=select distinct(ofm.COVERAGES_ID),ofm.COVERAGES_NAME,OFM.COVERAGES_DISPLAY_NAME,O.PRODUCT_ID, (SELECT PRODUCT_NAME FROM PRODUCT_MASTER WHERE O.PRODUCT_ID\=PRODUCT_ID) PRODUCT_NAME, O.SCHEME_ID, (SELECT SCHEME_NAME FROM ofs_scheme_master WHERE  O.SCHEME_ID\=SCHEME_ID AND O.PRODUCT_ID\=PRODUCT_ID AND BRANCH_CODE\=?) SCHEME_NAME, O.CONTENT_TYPE_ID, (SELECT CONTENT_DESCRIPTION FROM OFS_CONTENT_MASTER WHERE O.CONTENT_TYPE_ID\=CONTENT_TYPE_ID AND O.SCHEME_ID\=SCHEME_ID AND O.PRODUCT_ID\=PRODUCT_ID) CONTENT_DESCRIPTION from ofs_master ofm left outer join (select ofcm.PRODUCT_ID PRODUCT_ID, OFCM.SCHEME_ID,ofcm.CONTENT_TYPE_ID,ofcm.COVERAGES_ID FROM ofs_coverages_master ofcm  where ofcm.amend_id\=(select max(amend_id) from ofs_coverages_master where ofcm.COVERAGES_ID\=COVERAGES_ID)) O on (ofm.COVERAGES_ID\=o.COVERAGES_ID)
GET_VALID_SCHEME_MASTER=select count(1) from ofs_scheme_master
INS_HOME_SCHEME_MASTER=Insert into OFS_SCHEME_MASTER (SCHEME_ID, SCHEME_NAME, DISPLAY_ORDER, PRODUCT_ID, REMARKS, STATUS, RSACODE, BRANCH_CODE) Values (?, ?, ?, ?, ?, ?, ?, ?)
UPD_HOME_SCHEME_MASTER=Update OFS_SCHEME_MASTER SET SCHEME_NAME=?, DISPLAY_ORDER=?, PRODUCT_ID=?, REMARKS=?, STATUS=?, RSACODE=?, BRANCH_CODE=? WHERE SCHEME_ID=?
DEL_HOME_SCHEME_MASTER=DELETE FROM OFS_SCHEME_MASTER WHERE SCHEME_ID\=?

marine.data.tax.update=UPDATE MARINE_DATA SET SERVICE_TAX=?,EDU_CESS=?,SH=?,CHEQUE_NO=?,CHEQUE_BANK=?,CHEQUE_AMOUNT=?,CHEQUE_DATE=CONVERT(DATE,?,103),PAYABLE=? WHERE APPLICATION_NO=?
UPDATE_MARINE_DEPOSIT_OR_CHEQUE=update marine_data set cheque_no=?,cheque_date=convert(date,?,103),payable=?,cheque_bank=?,ISSUING_BANK=? where application_no=?
UPDATE_WEBMARINE_DEPOSIT_OR_CHEQUE=update webservice_marine_quote set cheque_no=?,cheque_date=convert(date,?,103),payable=?,cheque_bank=?,ISSUING_BANK=? where application_no=?
CheckAmount=select ISSUING_BANK from MARINE_DATA where ISSUING_BANK >= ? and application_no=?
referral.update=CALL UPDATE_DEPOSIT(?,?,?,?,?,?,?)
broker.oacode=select OA_CODE from LOGIN_MASTER where login_id=?

##Home BusinessType added by Aswin
GET_BUSINESSTYPE_LIST = SELECT * FROM HOME_BUSINESS_TYPE_DETAIL WHERE BUSINESS_ID=(SELECT BUSINESS_ID FROM HOME_BUSINESS_TYPE_MASTER WHERE CORE_APP_CODE=?) AND STATUS='Y' ORDER BY DISPLAY_ORDER ASC
GET_BUSINESS_TYPE_RATE = SELECT RATE FROM HOME_BUSINESS_TYPE_LOADING BTL WHERE BTL.BUSINESS_TYPE_ID=? AND BTL.COVERAGE_ID=? AND BTL.SUB_COVERAGE_ID=? AND BTL.STATUS='Y' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM HOME_BUSINESS_TYPE_LOADING BTL1 WHERE BTL1.BUSINESS_TYPE_ID=BTL.BUSINESS_TYPE_ID AND BTL1.COVERAGE_ID=BTL.COVERAGE_ID AND BTL1.SUB_COVERAGE_ID=BTL.SUB_COVERAGE_ID AND BTL1.STATUS=BTL.STATUS)

#RatingEngine
Check_mode_of_transport=select distinct(RSACODE) from mode_of_transport where RSACODE=? and BRANCH_CODE=?
GET_TRANSPORT_MODE=select transport_description,RSACODE,DISPLAY_ORDER,MODE_TRANSPORT_ID,STATUS from mode_of_transport where branch_code=? and MODE_TRANSPORT_ID=?
UPDATE_MODE_OF_TRANSPORT=update MODE_OF_TRANSPORT set transport_description=?,DISPLAY_ORDER=?,RSACODE=?,STATUS=? where MODE_TRANSPORT_ID=? and BRANCH_CODE=?
#####(10-06-2016)#####INS_MODE_OF_TRANSPORT=insert into MODE_OF_TRANSPORT values((select MAX(SNO__)+1 from MODE_OF_TRANSPORT),(SELECT MAX(MODE_TRANSPORT_ID)+1 from MODE_OF_TRANSPORT where BRANCH_CODE=?),?,?,'',?,?,?)
INS_MODE_OF_TRANSPORT = insert into MODE_OF_TRANSPORT(SNO__,MODE_TRANSPORT_ID,TRANSPORT_DESCRIPTION,RSACODE,REMARKS,STATUS,DISPLAY_ORDER,BRANCH_CODE) values((select MAX(SNO__)+1 from MODE_OF_TRANSPORT),(SELECT MAX(MODE_TRANSPORT_ID)+1 from MODE_OF_TRANSPORT where BRANCH_CODE=?),?,?,'',?,?,?)
INS_ERROR_MASTER=insert into ERROR_MASTER (ERROR_ID,ERROR_DESC,STAGE_ID,PRODUCT_ID,REMARKS,STATUS)values((select MAX(ERROR_ID)+1 from ERROR_MASTER),?,?,?,?,?)
GET_STATE_LIST=select STAGE_ID,STAGE_DESC from STAGE_MASTER where PRODUCT=?
INS_CONVEYAN_MASTER=INSERT INTO CONVEYAN_MASTER (SNO,CONV_MEAN,CONVCD,CONVDESC,CONV_RATE, MODE_TRANSPORT_ID,EFFECTIVE_DATE,AMEND_ID,BRANCH_CODE,CORE_APP_ID,REMARKS,STATUS) VALUES ((select MAX(SNO)+1 from CONVEYAN_MASTER),(select MAX(CONV_MEAN)+1 from CONVEYAN_MASTER where BRANCH_CODE=?),(select SUBSTRING((select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT where MODE_TRANSPORT_ID=? and BRANCH_CODE=?),1,1) from dual),?,?,?,convert(date,?,103),?,?,?,?,?)
GET_CONVEYAN_MASTER=select  CONV_MEAN,CONVDESC from CONVEYAN_MASTER where AMEND_ID+ ' ' +CONV_MEAN  in (select max(AMEND_ID)+ ' ' +CONV_MEAN from CONVEYAN_MASTER where branch_code = ?  group by CONV_MEAN ) AND branch_code = ? order by CONVDESC
EDIT_CONVEYAN_MASTER=select SNO,CONVDESC,MODE_TRANSPORT_ID,CONV_RATE,REMARKS,CORE_APP_ID,convert(varchar(10),EFFECTIVE_DATE,103)EFFECTIVE_DATE,STATUS from CONVEYAN_MASTER where BRANCH_CODE=? and CONV_MEAN=? and MODE_TRANSPORT_ID=?
UPDATE_CONVEYAN_MASTER=INSERT INTO CONVEYAN_MASTER VALUES ((select MAX(SNO)+1 from CONVEYAN_MASTER),?,(select SUBSTRING((select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT where MODE_TRANSPORT_ID=? and BRANCH_CODE=?),1,1) from dual),?,?,?,convert(date,?,103),(select MAX(AMEND_ID)+1 from CONVEYAN_MASTER where BRANCH_CODE=? and SNO=?),?,?,?,?)
#####(10-06-2016)#####INS_COUNTRY_MASTER=insert into country_master values((select MAX(SNO__)+1 from country_master),(select MAX(COUNTRY_ID)+1 from country_master),?,?,?,?,?,?,convert(date,?,103),?,?)
INS_COUNTRY_MASTER = INSERT INTO country_master (SNO__,COUNTRY_ID,COUNTRY_NAME,COUNTRY_SHORT_NAME,STATUS,RSACODE,NATIONALITY_NAME,AMEND_ID,EFFECTIVE_DATE,GEO_RATE,REMARKS) VALUES((SELECT MAX(SNO__)+1 FROM country_master),(SELECT MAX(COUNTRY_ID)+1 FROM country_master),?,?,?,?,?,?,CONVERT(DATE,?,103),?,?)
EDIT_COUNTRY_MASTER=select COUNTRY_NAME,COUNTRY_SHORT_NAME,NATIONALITY_NAME,GEO_RATE,REMARKS,RSACODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS from COUNTRY_MASTER where COUNTRY_ID=?
#####(10-06-2016)#####UPDATE_COUNTRY_MASTER=insert into country_master values((select MAX(SNO__)+1 from country_master),?,?,?,?,?,?,(select MAX(AMEND_ID)+1 from COUNTRY_MASTER where COUNTRY_NAME=?),convert(date,?,103),?,?)
UPDATE_COUNTRY_MASTER = insert into country_master (SNO__, COUNTRY_ID , COUNTRY_NAME , COUNTRY_SHORT_NAME,STATUS, RSACODE, NATIONALITY_NAME, AMEND_ID , EFFECTIVE_DATE, GEO_RATE, REMARKS, INT_PORT_CODE) values((select MAX(SNO__)+1 from country_master),?,?,?,?,?,?,(select MAX(AMEND_ID)+1 from COUNTRY_MASTER where COUNTRY_ID=?),convert(date,?,103),?,?,(select distinct(INT_PORT_CODE) from COUNTRY_MASTER cm where COUNTRY_ID=? and cm.amend_id=((select MAX(AMEND_ID) from COUNTRY_MASTER c where cm.COUNTRY_ID=c.country_id))))
INS_BANK_MASTER=insert into OPEN_COVER_BANK_MASTER values((select MAX(BANK_ID)+1 from OPEN_COVER_BANK_MASTER),?,'','',convert(datetime,?,101),?,?,?,?,?)
GET_BANK=SELECT BANK_ID,BANK_NAME FROM OPEN_COVER_BANK_MASTER 
Check_name_Bank=select count(BANK_NAME) from OPEN_COVER_BANK_MASTER where upper(BANK_NAME)=upper(?) and BELONGING_COUNTRY_ID=?
EDIT_BANK_MASTER=select BANK_NAME,BELONGING_COUNTRY_ID,REMARKS,RSACODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS from OPEN_COVER_BANK_MASTER where BANK_ID=?
UPDATE_BANK_MASTER=insert into OPEN_COVER_BANK_MASTER values(?,?,'','',convert(date,?,103),(select MAX(AMEND_ID)+1 from OPEN_COVER_BANK_MASTER where BANK_ID=?),?,?,?,?)
GET_BRANCH=select branch_code,BRANCH_NAME from branch_master where status='Y' order by BRANCH_NAME
GET_MATERIAL=SELECT MM.MATERIAL_ID,MM.MM.MATERIAL_DESC FROM MATERIAL_TYPE_MASTER MM WHERE BRANCH_CODE = ? AND MM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_DESC=MM.MATERIAL_DESC)
INS_MATERIAL_TYPE_MASTER=insert into MATERIAL_TYPE_MASTER values((select MAX(SNO)+1 from MATERIAL_TYPE_MASTER),(select MAX(MATERIAL_ID)+1 from MATERIAL_TYPE_MASTER where BRANCH_CODE=?),?,?,convert(date,?,103),?,?,?,?,?)
#####(14-06-2016)#####EDIT_MATERIAL_TYPE_MASTER=SELECT   MM.MATERIAL_DESC,MM.MATERIAL_RATE,MM.MATERIAL_ID,MM.REMARKS,MM.CORE_APP_ID,convert(varchar(10),mm.EFFECTIVE_DATE,103) EFFECTIVE_DATE, MM.STATUS FROM   MATERIAL_TYPE_MASTER MM WHERE   MM.BRANCH_CODE \= ? AND MATERIAL_ID \= ? AND MM.AMEND_ID \=(SELECT   MAX (AMEND_ID) FROM   MATERIAL_TYPE_MASTER WHERE   BRANCH_CODE \= MM.BRANCH_CODE AND MATERIAL_ID \= MM.MATERIAL_ID) 
EDIT_MATERIAL_TYPE_MASTER = SELECT   MM.MATERIAL_DESC,MM.MATERIAL_RATE,MM.MATERIAL_ID,MM.REMARKS,MM.CORE_APP_ID,CONVERT(VARCHAR(10),mm.EFFECTIVE_DATE,103) EFFECTIVE_DATE, MM.STATUS FROM   MATERIAL_TYPE_MASTER MM WHERE   MM.BRANCH_CODE \= ? AND MATERIAL_ID \= ? AND mm.cover_id\=? AND MM.AMEND_ID \=(SELECT   MAX (AMEND_ID) FROM   MATERIAL_TYPE_MASTER WHERE   BRANCH_CODE \= MM.BRANCH_CODE AND MATERIAL_ID \= MM.MATERIAL_ID AND COVER_ID\=MM.COVER_ID)
#####(14-06-2016)#####UPDATE_MATERIAL_TYPE_MASTER=insert into MATERIAL_TYPE_MASTER values((select MAX(SNO)+1 from MATERIAL_TYPE_MASTER),?,?,?,convert(date,?,103),(select MAX(AMEND_ID)+1 from MATERIAL_TYPE_MASTER where MATERIAL_DESC=?),?,?,?,?)
UPDATE_MATERIAL_TYPE_MASTER = INSERT INTO MATERIAL_TYPE_MASTER (  SNO,MATERIAL_ID ,COVER_ID, MATERIAL_DESC,MATERIAL_RATE,EFFECTIVE_DATE,AMEND_ID,BRANCH_CODE,CORE_APP_ID,STATUS, REMARKS ) VALUES( ( SELECT MAX(SNO)+1 FROM  MATERIAL_TYPE_MASTER WHERE BRANCH_CODE=? ),?,?,?,?,CONVERT(DATE,?,103),(SELECT MAX(AMEND_ID)+1 FROM MATERIAL_TYPE_MASTER WHERE BRANCH_CODE=? AND MATERIAL_ID=? ),?,?,?,?)
#####(13-06-2016)#####INS_WAR_RATE_MASTER=insert into WAR_RATE_MASTER values((select MAX(SNO)+1 from WAR_RATE_MASTER),(select MAX(WAR_ID)+1 from WAR_RATE_MASTER where BRANCH_CODE=?),?,?,?,convert(date,?,103),?,?,?,?,?)
INS_WAR_RATE_MASTER = INSERT INTO WAR_RATE_MASTER (SNO, WAR_ID, WAR_DESC, WAR_RATE, MODE_TRANSPORT_ID, EFFECTIVE_DATE, AMEND_ID, BRANCH_CODE, CORE_APP_ID,STATUS, REMARKS) VALUES((SELECT NULLIF(MAX(SNO),0)+1 FROM WAR_RATE_MASTER),( SELECT NULLIF(MAX(WAR_ID),0)+1  FROM WAR_RATE_MASTER  WHERE BRANCH_CODE=?),?,?,?,CONVERT(DATE,?,103),?,?,?,?,?)
GET_WAR_RATE=select WAR_ID,WAR_DESC from WAR_RATE_MASTER MM WHERE BRANCH_CODE = ? AND AMEND_ID =  (SELECT MAX(AMEND_ID) FROM WAR_RATE_MASTER MTM WHERE BRANCH_CODE = ? AND MTM.WAR_ID = MM.WAR_ID)
EDIT_WAR_RATE_MASTER=select MODE_TRANSPORT_ID,WAR_DESC,WAR_RATE,REMARKS,CORE_APP_ID,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS from WAR_RATE_MASTER where BRANCH_CODE=? and WAR_ID=?
#####(13-06-2016)#####UPDATE_WAR_RATE_MASTER=update WAR_RATE_MASTER w set WAR_RATE=?,REMARKS=?,EFFECTIVE_DATE=convert(date,?,103),STATUS=? where branch_code=? and WAR_ID=? and amend_id=(select max(amend_id) from war_rate_master where war_id=w.war_id)
UPDATE_WAR_RATE_MASTER = UPDATE WAR_RATE_MASTER  SET WAR_DESC=?,MODE_TRANSPORT_ID=?,WAR_RATE=?,REMARKS=?,EFFECTIVE_DATE=CONVERT(DATE,?,103),CORE_APP_ID=?,STATUS=? WHERE branch_code=? AND WAR_ID=? AND amend_id=(SELECT MAX(amend_id) FROM war_rate_master WHERE war_id=WAR_RATE_MASTER.war_id)
UPDATE_MATERIAL_TYPE_MASTER_UPDATE = UPDATE MATERIAL_TYPE_MASTER  SET MATERIAL_DESC=?,EFFECTIVE_DATE=CONVERT(DATE,?,103),MATERIAL_RATE=?,STATUS=?,REMARKS=?,CORE_APP_ID=? WHERE MATERIAL_ID=? AND COVER_ID=? AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_ID=MATERIAL_TYPE_MASTER.MATERIAL_ID AND COVER_ID=MATERIAL_TYPE_MASTER.COVER_ID AND BRANCH_CODE=MATERIAL_TYPE_MASTER.BRANCH_CODE)

GET_SALE_TERM=select stm.sale_term_id,stm.sale_term_name from sale_term_master stm where stm.branch_code=?
GET_TRANSPORT_LIST=select MODE_TRANSPORT_ID,TRANSPORT_DESCRIPTION,RSACODE,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from MODE_OF_TRANSPORT where BRANCH_CODE=?
GET_TRANSPORT_LIST_BY_NAME=select MODE_TRANSPORT_ID,TRANSPORT_DESCRIPTION,RSACODE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from MODE_OF_TRANSPORT where BRANCH_CODE\=? and lower(TRANSPORT_DESCRIPTION) like lower(('%'+ ' ' +?+ ' ' +'%')) order by lower(TRANSPORT_DESCRIPTION)
GET_CONVEYAN_MASTER_LIST=select E.MODE_TRANSPORT_ID,MT.TRANSPORT_DESCRIPTION,E.CONV_MEAN,E.CONVDESC,E.CONV_RATE,convert(varchar(10),E.EFFECTIVE_DATE,103) EFFECTIVE_DATE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from CONVEYAN_MASTER E,mode_of_transport MT where E.BRANCH_CODE\=? and MT.BRANCH_CODE\= E.BRANCH_CODE and E.MODE_TRANSPORT_ID\=MT.MODE_TRANSPORT_ID AND E.branch_code\=MT.branch_code AND E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONV_MEAN\=E.CONV_MEAN and BRANCH_CODE\=E.BRANCH_CODE) 
GET_CONVEYAN_LIST_BY_NAME=select E.MODE_TRANSPORT_ID,E.CONV_MEAN,E.CONVDESC,E.CONV_RATE,convert(varchar(10),E.EFFECTIVEDATE,103)EFFECTIVE_DATE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)STATUS from CONVEYAN_MASTER E where BRANCH_CODE\=? AND E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONVDESC\=E.CONVDESC )and lower(E.CONVDESC) like lower(('%'+ ' ' +?+ ' ' +'%')) 
GET_CONVEYAN_MODE_LIST=select E.MODE_TRANSPORT_ID,E.CONV_MEAN,E.CONVDESC,E.CONV_RATE,convert(varchar(10),E.EFFECTIVEDATE,103) EFFECTIVE_DATE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)STATUS,AMEND_ID from CONVEYAN_MASTER E where BRANCH_CODE=? AND E.MODE_TRANSPORT_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CONVDESC=E.CONVDESC)
Check_convey=select count(CORE_APP_ID) from CONVEYAN_MASTER where CORE_APP_ID=? and BRANCH_CODE=? and MODE_TRANSPORT_ID=?
GET_Country_List=select E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,convert(varchar(10),E.EFFECTIVE_DATE,103)EFFECTIVE_DATE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'  when 'R' then 'Refferal'  end) STATUS  from COUNTRY_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME) order by COUNTRY_NAME
GET_COUNTRY_LIST = SELECT E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,CONVERT(VARCHAR(10),E.EFFECTIVE_DATE,103)EFFECTIVE_DATE,(CASE E.STATUS WHEN  'Y' THEN  'Active' WHEN 'N' THEN 'DeActive'  WHEN 'R' THEN 'Refferal'  END) STATUS  FROM COUNTRY_MASTER E WHERE  E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME\=E.COUNTRY_NAME) 
GET_COUNTRYLIST=select E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,convert(varchar(10),E.EFFECTIVEDATE,103)EFFECTIVE_DATE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'  when 'R' then 'Refferal'  end) STATUS  from COUNTRY_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME)
GET_COUNTRY_LIST_BY_NAME=select E.COUNTRY_ID,E.COUNTRY_NAME,E.NATIONALITY_NAME,convert(varchar(10),E.EFFECTIVEDATE,103) EFFECTIVE_DATE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'  when 'R' then 'Refferal'  end)STATUS  from COUNTRY_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME) and lower(E.COUNTRY_NAME) like lower(('%'+ ' ' +?+ ' ' +'%')) order by E.COUNTRY_NAME
Check_name_Country=select count(COUNTRY_NAME) from COUNTRY_MASTER where upper(COUNTRY_NAME)=upper(?)
Check_Country= select distinct(RSACODE) from COUNTRY_MASTER where RSACODE\=? 
GET_BANK_LIST=select E.BANK_ID,E.BANK_NAME,convert(varchar(10),E.EFFECTIVE_DATE,103)EFFECTIVE_DATE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)STATUS from OPEN_COVER_BANK_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME=E.BANK_NAME) order by BANK_NAME
GET_BANKLIST=select E.BANK_ID,E.BANK_NAME,convert(varchar(10),E.EFFECTIVE_DATE,103)EFFECTIVE_DATE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from OPEN_COVER_BANK_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE BANK_ID=E.BANK_ID)
GET_BANK_LIST_BY_NAME=select E.BANK_ID,E.BANK_NAME,convert(varchar(10),E.EFFECTIVE_DATE,103) EFFECTIVE_DATE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from OPEN_COVER_BANK_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME=E.BANK_NAME) and lower(E.BANK_NAME) like lower(('%'+ ' ' +?+ ' ' +'%')) order by E.BANK_NAME
Check_Bank= select distinct(RSACODE) from OPEN_COVER_BANK_MASTER where RSACODE=?
GET_MATERIAL_LIST_BY_NAME=SELECT E.MATERIAL_ID,E.MATERIAL_DESC,E.MATERIAL_RATE,convert(varchar(10),E.EFFECTIVEDATE,103) EFFECTIVE_DATE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS FROM material_type_master E WHERE E.BRANCH_CODE=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM material_type_master WHERE MATERIAL_DESC=E.MATERIAL_DESC )and  lower(E.material_desc) like lower('%'+ ' ' +?+ ' ' +'%') order by E.material_desc
#####(14-06-2016)#####GET_MATERIAL_MASTER_LIST=SELECT E.MATERIAL_ID,E.MATERIAL_DESC,E.MATERIAL_RATE,convert(varchar(10),E.EFFECTIVEDATE,103) EFFECTIVE_DATE,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS FROM material_type_master E WHERE E.BRANCH_CODE=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM material_type_master WHERE MATERIAL_ID=E.MATERIAL_ID AND BRANCH_CODE=E.BRANCH_CODE)
GET_MATERIAL_MASTER_LIST = SELECT E.MATERIAL_ID,E.MATERIAL_DESC,E.MATERIAL_RATE,E.COVER_ID, (SELECT CM.COVER_NAME FROM COVER_MASTER CM WHERE CM.COVER_ID=E.COVER_ID AND CM.BRANCH_CODE=E.BRANCH_CODE AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER CM1 WHERE CM1.COVER_ID=CM.COVER_ID AND CM1.BRANCH_CODE=CM.BRANCH_CODE ) )COVER_NAME,CONVERT(VARCHAR(10),E.EFFECTIVE_DATE,103) EFFECTIVE_DATE,(CASE E.STATUS WHEN  'Y' THEN  'Active' WHEN 'N' THEN 'DeActive' END) STATUS FROM material_type_master E WHERE E.BRANCH_CODE=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM material_type_master WHERE MATERIAL_ID=E.MATERIAL_ID AND BRANCH_CODE=E.BRANCH_CODE AND COVER_ID=E.COVER_ID)
Check_name_material=select count(MATERIAL_DESC) from MATERIAL_TYPE_MASTER where upper(MATERIAL_DESC)\=upper(?) and BRANCH_CODE\=?
Check_material=select count(CORE_APP_ID) from MATERIAL_TYPE_MASTER where CORE_APP_ID=? and BRANCH_CODE=?
GET_WARRATE_LIST=select w.branch_code,w.amend_id,w.war_id,w.war_desc,w.war_rate, convert(varchar(10),EFFECTIVE_DATE,103) effective_date,(case w.status when 'Y' then 'Active' when 'N' then 'DeActive' end) status, m.transport_description from WAR_RATE_MASTER w,MODE_OF_TRANSPORT m where m.mode_transport_id=w.mode_transport_id and m.branch_code=? and W.BRANCH_CODE=? and W.BRANCH_CODE=m.branch_code and amend_id=( select max(amend_id) from war_rate_master wr where  wr.mode_transport_id=w.mode_transport_id  and wr.branch_code=w.branch_code)
GET_WAR_LIST_BY_NAME=SELECT   E.WAR_ID,E.WAR_DESC,E.WAR_RATE,convert(varchar(10),E.EFFECTIVEDATE,103) EFFECTIVE_DATE,(case E.status when 'Y' then 'Active' when 'N' then 'DeActive' end)STATUS,M.TRANSPORT_DESCRIPTION FROM WAR_RATE_MASTER E, MODE_OF_TRANSPORT M  WHERE E.mode_transport_id=M.mode_transport_id and E.BRANCH_CODE = ? AND M.BRANCH_CODE=? AND E.AMEND_ID = (SELECT MAX (AMEND_ID) FROM WAR_RATE_MASTER WHERE WAR_DESC = E.WAR_DESC AND BRANCH_CODE=?) AND LOWER (E.WAR_DESC) LIKE LOWER ('%' + ' ' + ? + ' ' + '%') ORDER BY E.WAR_ID
GET_WAR_LIST_BY_DESC=SELECT   E.WAR_ID,E.WAR_DESC,E.WAR_RATE,convert(varchar(10),E.EFFECTIVEDATE,103) EFFECTIVE_DATE,(case E.status when 'Y' then 'Active' when 'N' then 'DeActive' end) STATUS,M.TRANSPORT_DESCRIPTION FROM WAR_RATE_MASTER E, MODE_OF_TRANSPORT M  WHERE E.mode_transport_id=M.mode_transport_id and E.BRANCH_CODE = ? AND M.BRANCH_CODE=? AND E.AMEND_ID = (SELECT MAX (AMEND_ID) FROM WAR_RATE_MASTER WHERE WAR_DESC = E.WAR_DESC AND BRANCH_CODE=?) AND LOWER (M.TRANSPORT_DESCRIPTION) LIKE LOWER ('%' + ' ' + ? + ' ' + '%') ORDER BY M.TRANSPORT_DESCRIPTION
Check_War= select distinct(CORE_APP_ID) from WAR_RATE_MASTER where CORE_APP_ID=? and branch_code=?
GET_PACKAGE_LIST = SELECT PM.PACKAGE_ID, PM.PACKAGE_DESC, PM.PERCENTRATE, PM.MODE_TRANSPORT_ID, MT.TRANSPORT_DESCRIPTION MODE_TRANSPORT, (case PM.status when 'Y' then 'Active' when 'N' then 'DeActive' end) STATUS FROM PACKAGE_MASTER PM,MODE_OF_TRANSPORT MT  WHERE PM.BRANCH_CODE=? AND MT.MODE_TRANSPORT_ID=PM.MODE_TRANSPORT_ID
EDIT_PACKAGE_MASTER = SELECT PACKAGE_ID, PACKAGE_DESC, MODE_TRANSPORT_ID, PERCENTRATE, STATUS, REMARKS FROM PACKAGE_MASTER WHERE PACKAGE_ID= ? AND MODE_TRANSPORT_ID=? AND BRANCH_CODE=?
INS_PACKAGE_MASTER = INSERT INTO PACKAGE_MASTER(SNO,    PACKAGE_ID,    PACKAGE_DESC,    PERCENTRATE,    MODE_TRANSPORT_ID,    RSACODE,    BRANCH_CODE,    STATUS,    REMARKS) VALUES((SELECT ISNULL(MAX(SNO),0)+1 FROM PACKAGE_MASTER), (SELECT ISNULL(MAX(PACKAGE_ID),0)+1 FROM PACKAGE_MASTER WHERE MODE_TRANSPORT_ID=?), ?,?,?,'',?,?,?)
UPDATE_PACKAGE_MASTER = UPDATE PACKAGE_MASTER SET PACKAGE_DESC = ?, PERCENTRATE = ?, STATUS= ?, REMARKS = ? WHERE PACKAGE_ID=? AND MODE_TRANSPORT_ID = ? AND BRANCH_CODE=?
Check_Sale=select distinct(RSACODE) from SALE_TERM_MASTER where RSACODE=?
GET_SALETERM_LIST=select SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from SALE_TERM_MASTER where BRANCH_CODE=?
GET_SALETERM_LIST_BY_NAME=select SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from SALE_TERM_MASTER where BRANCH_CODE=? and lower(SALE_TERM_NAME) like lower(('%'+ ' ' +?+ ' ' +'%')) order by lower(SALE_TERM_NAME)
INS_SALETERM=insert into SALE_TERM_MASTER (SNO__,SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,RSACODE,REMARKS,STATUS,DISPLAY_ORDER,BRANCH_CODE,INT_CODE)values((select ISNULL( MAX(SNO__),0)+1 from SALE_TERM_MASTER),(select ISNULL(MAX(SALE_TERM_ID),0)+1 from SALE_TERM_MASTER where BRANCH_CODE=?),?,?,?,?,?,(select MAX(DISPLAY_ORDER)+1 from SALE_TERM_MASTER where BRANCH_CODE=?),?,(select ISNULL(MAX(SALE_TERM_ID),0)+1 from SALE_TERM_MASTER where BRANCH_CODE=?))
EDIT_SALETERM_MASTER=select SALE_TERM_ID,SALE_TERM_NAME,SALE_TERM_VALUE,RSACODE,REMARKS,STATUS from SALE_TERM_MASTER where BRANCH_CODE=? and SALE_TERM_ID=?
UPDATE_SALETERM_MASTER=update SALE_TERM_MASTER set SALE_TERM_NAME=?,SALE_TERM_VALUE=?,RSACODE=?,STATUS=?,REMARKS=?,INT_CODE=? where BRANCH_CODE=? and SALE_TERM_ID=?
INS_TOLERANCE_MASTER=insert into TOLERANCE_MASTER values((select MAX(SNO__)+1 from TOLERANCE_MASTER),(select MAX(TOLERANCE_ID)+1 from TOLERANCE_MASTER where BRANCH_CODE=?),?,?,?,?,?,?,(select MAX(DISPLAY_ORDER)+1 from TOLERANCE_MASTER where BRANCH_CODE=?))
EDIT_TOLERANCE_MASTER=select TOLERANCE_ID,TOLERANCE_NAME,TOLERANCE_VALUE,RSACODE,STATUS,REMARKS from TOLERANCE_MASTER where BRANCH_CODE=? and TOLERANCE_ID=?
Check_tole=select distinct(RSACODE) from TOLERANCE_MASTER where BRANCH_CODE=? and RSACODE=?
GET_TOLERANCE_LIST_BY_NAME=select TOLERANCE_ID,TOLERANCE_NAME,TOLERANCE_VALUE,RSACODE,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from TOLERANCE_MASTER where BRANCH_CODE=? and lower(TOLERANCE_NAME) like lower(('%'+ ' ' +?+ ' ' +'%'))order by lower(TOLERANCE_NAME)
GET_TOLERANCE_MASTER_LIST=select TOLERANCE_ID,TOLERANCE_NAME,TOLERANCE_VALUE,RSACODE,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from TOLERANCE_MASTER where BRANCH_CODE\=? 
Check_name_tole=select count(TOLERANCE_NAME) from TOLERANCE_MASTER where branch_code=? and upper(TOLERANCE_NAME)=upper(?)
UPDATE_TOLERANCE_MASTER=update TOLERANCE_MASTER set TOLERANCE_NAME=?,TOLERANCE_VALUE=?,RSACODE=?,REMARKS=?,STATUS=? where BRANCH_CODE=? and TOLERANCE_ID=?
GET_COMEX_LIST=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from COMMODITY_EXCESS_PREMIUM where AMEND_ID+ ' ' +SNO  in (select max(AMEND_ID)+ ' ' +(SNO) from COMMODITY_EXCESS_PREMIUM where branch_code \= ?  group by SNO ) AND branch_code \= ? order by SNO
GET_COMEXLIST=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS from COMMODITY_EXCESS_PREMIUM where AMEND_ID+ ' ' +SNO  in (select max(AMEND_ID)+ ' ' +(SNO) from COMMODITY_EXCESS_PREMIUM where branch_code \= ?  group by SNO ) AND branch_code \= ? 
GET_COMEX_LIST_BY_NAME=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,convert(varchar(10),EFFECTIVEDATE,103) EFFECTIVE_DATE,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS from COMMODITY_EXCESS_PREMIUM where BRANCH_CODE=? and lower(START_SUM_INSURED) like lower(('%'+ ' ' +?+ ' ' +'%'))order by lower(START_SUM_INSURED)
GET_COMEX_LIST_BY_VALUE=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,convert(varchar(10),EFFECTIVEDATE,103) EFFECTIVE_DATE,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS from COMMODITY_EXCESS_PREMIUM where BRANCH_CODE\=? and lower(END_SUM_INSURED) like lower(('%'+ ' ' +?+ ' ' +'%'))order by lower(END_SUM_INSURED) 
Check_comEx=select distinct(RSACODE) from COMMODITY_EXCESS_PREMIUM where branch_code=? and RSACODE=?
INS_COMEX=insert into COMMODITY_EXCESS_PREMIUM (SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,AMEND_ID,EFFECTIVE_DATE,BRANCH_CODE,STATUS) values((select MAX(SNO)+1 from COMMODITY_EXCESS_PREMIUM),?,?,?,?,0,convert(date,?,103),?,?)
UPDATE_COMEX=update COMMODITY_EXCESS_PREMIUM set DEDUCTIBLE\=?,RATE\=?,STATUS\=?,EFFECTIVE_DATE\=convert(date,?,103),RSACODE\=? where SNO\=?  and AMEND_ID \=(select max(AMEND_ID) from COMMODITY_EXCESS_PREMIUM where SNO\=? and BRANCH_CODE\=?) 
EDIT_COMEX=select SNO,START_SUM_INSURED,END_SUM_INSURED,DEDUCTIBLE,RATE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS,RSACODE from COMMODITY_EXCESS_PREMIUM where BRANCH_CODE\=? and SNO\=? 
Check_name_mode_of_transport=select count(TRANSPORT_DESCRIPTION) from MODE_OF_TRANSPORT where upper(TRANSPORT_DESCRIPTION)=upper(?) and branch_code=?
Check_name_convey=select count(CONVDESC) from CONVEYAN_MASTER where upper(CONVDESC)=upper(?) and BRANCH_CODE=?
Check_name_War=select count(MODE_TRANSPORT_ID) from WAR_RATE_MASTER where mode_transport_id=? and branch_code=?
GET_EXTRA_COVER_LIST=select E.EXTRA_COVER_NAME,E.EXTRA_COVER_ID,E.REMARKS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,E.RSACODE,(case E.status when 'Y' then 'Active' when 'D' then 'DeActive' end) STATUS ,m.transport_description from EXTRA_COVER_MASTER E,MODE_OF_TRANSPORT m where m.mode_transport_id=E.mode_transport_id and m.branch_code=? and E.BRANCH_CODE=?
GET_EXTRACOVER_LIST_BY_NAME=select E.EXTRA_COVER_NAME,EXTRA_COVER_ID,E.REMARKS,E.RSACODE,convert(varchar(10),E.EFFECTIVEDATE,103) EFFECTIVE_DATE,(case E.status when 'Y' then 'Active' when 'D' then 'DeActive' end) STATUS ,m.transport_description from EXTRA_COVER_MASTER E,MODE_OF_TRANSPORT m where m.mode_transport_id=E.mode_transport_id and m.branch_code=? and E.BRANCH_CODE=? and lower(E.extra_cover_name) like lower(('%'+ ' ' +?+ ' ' +'%'))
Check_extraCover=select distinct(RSACODE) from Extra_cover_master where branch_code=? and RSACODE=?
INS_EXTRA_MASTER=insert into extra_cover_master(SNO__,BRANCH_CODE,MODE_TRANSPORT_ID,EXTRA_COVER_NAME,RSACODE,EXTRA_COVER_ID,REMARKS,STATUS) values((select max(SNO__)+1 from extra_cover_master),?,?,?,?,(select max(extra_cover_id)+1 from extra_cover_master where branch_code=?),?,?)
EDIT_EXTRA_COVER_MASTER=select EXTRA_COVER_NAME,EXTRA_COVER_ID,MODE_TRANSPORT_ID,REMARKS,RSACODE,STATUS from EXTRA_COVER_MASTER where BRANCH_CODE=? and EXTRA_COVER_ID=?
UPDATE_EXTRA_COVER_MASTER=update extra_cover_master set EXTRA_COVER_NAME=?,MODE_TRANSPORT_ID=?, REMARKS=?, RSACODE=? ,STATUS=? where BRANCH_CODE=? and EXTRA_COVER_ID=?
GET_CITY_LIST=SELECT CI.CITY_NAME,CI.CITY_ID,CI.COUNTRY_ID,CI.RSACODE,CI.REMARKS,(case CI.status when 'Y' then 'Active' when 'N' then 'DeActive' end) STATUS,CO.COUNTRY_NAME FROM CITY_MASTER CI,COUNTRY_MASTER CO WHERE CI.COUNTRY_ID=CO.COUNTRY_ID
GET_CITY_LIST_BY_NAME=SELECT CI.CITY_NAME,CI.CITY_ID,CI.COUNTRY_ID,CI.RSACODE,CI.REMARKS,(case CI.status when 'Y' then 'Active' when 'N' then 'DeActive' end) STATUS,CO.COUNTRY_NAME FROM CITY_MASTER CI,COUNTRY_MASTER CO WHERE CI.COUNTRY_ID\=CO.COUNTRY_ID AND lower(CITY_NAME) like lower(('%'+ ' ' +?+ ' ' +'%'))  
Check_city=select distinct(rsacode) from city_master where rsacode=? and country_id=?
Check_city_name=select count(city_name) from city_master where country_id=? and upper(city_name)=upper(?)
INS_CITI_MASTER=insert into city_master(SNO__,CITY_ID,CITY_NAME,COUNTRY_ID,RSACODE,REMARKS,STATUS) values((select max(sno__)+1 from city_master),(select max(city_id)+1 from city_master),?,?,?,?,?)
EDIT_CITY_MASTER=select city_name,country_id,remarks,status,rsacode,city_id from city_master where city_id=?
GET_VESSEL_LIST=select VESSEL_ID,VESSEL_NAME,VESSEL_CLASS,MANUFACTURE_YEAR,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS,VESSEL_RATE from VESSEL_MASTER  
GET_VESSEL_LIST_BY_NAME=select VESSEL_ID,VESSEL_NAME,VESSEL_CLASS,MANUFACTURE_YEAR,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS from VESSEL_MASTER where lower(VESSEL_NAME) like lower('%'+ ' ' +?+ ' ' +'%') ORDER BY VESSEL_NAME
Check_name_Sale=select count(SALE_TERM_NAME) from SALE_TERM_MASTER where upper(SALE_TERM_NAME)=upper(?) and BRANCH_CODE=?
EDIT_VESSEL=select VESSEL_ID,VESSEL_NAME,VESSEL_CLASS,MANUFACTURE_YEAR,RSACODE,STATUS,VESSEL_TYPE,REMARKS,cast(VESSEL_RATE as decimal(10,2)) VESSEL_RATE from vessel_master where VESSEL_ID=?
INS_VESSEL=insert into vessel_master (SNO__,vessel_id,VESSEL_NAME,VESSEL_TYPE,FLAG,OWNER,ACQUIRED_DATE,PRICE,SCRAP_LOST,SCRAP_LOST_DT,REG_OWNER,LRNUMBER,MANUFACTURE_YEAR,VESSEL_CLASS,RSACODE,REFERRAL,DISPLAY_ORDER,BELONGING_COUNTRY_ID,STATUS,REMARKS,VESSEL_RATE) values((select MAX(SNO__)+1 from vessel_master),(select MAX(vessel_id)+1 from vessel_master),?,?,'','',NULL,'','',NULL,'','',?,?,?,'Y',(select MAX(DISPLAY_ORDER)+1 from vessel_master),1,?,?,?)
Check_name_vessel=select count(VESSEL_NAME) from vessel_master where lower(VESSEL_NAME)=lower(?)
Check_vessel=select distinct(RSACODE) from vessel_master where RSACODE=?
UPDATE_VESSEL=update VESSEL_MASTER set vessel_name=?,vessel_type=?,MANUFACTURE_YEAR=?,vessel_class=?,RSACODE=?,STATUS=?,remarks=?,VESSEL_RATE=nullif(CONVERT(decimal(20,2), CAST(? AS FLOAT)),0) where VESSEL_ID=?
GET_WARRANTY_LIST=select WARRANTY_ID,WARRANTY_DESCRIPTION,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS from WARRANTY_MASTER where BRANCH_CODE\=? 
GET_WARRANTY_LIST_NAME=select WARRANTY_ID,WARRANTY_DESCRIPTION,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS from WARRANTY_MASTER where BRANCH_CODE=? and lower(WARRANTY_DESCRIPTION) like lower('%'+ ' ' +?+ ' ' +'%')
Check_Warranty=select count(RSACODE) from WARRANTY_MASTER where RSACODE=? and BRANCH_CODE=?
Check_name_warranty=select count(WARRANTY_DESCRIPTION) from WARRANTY_MASTER where upper(WARRANTY_DESCRIPTION)=upper(?) and BRANCH_CODE=?
#####(13-06-2016)#####INS_WARRANTY=insert into WARRANTY_MASTER values((select MAX(SNO__)+1 from WARRANTY_MASTER),(select MAX(WARRANTY_ID)+1 from WARRANTY_MASTER where BRANCH_CODE=?),?,?,?,?,?,(select MAX(DISPLAY_ORDER)+1 from WARRANTY_MASTER where branch_code=?))
INS_WARRANTY = INSERT INTO WARRANTY_MASTER (SNO__,WARRANTY_ID,WARRANTY_DESCRIPTION,RSACODE,REMARKS,STATUS,BRANCH_CODE,DISPLAY_ORDER,INT_CODE) VALUES((SELECT NULLIF(MAX(SNO__),0)+1 FROM WARRANTY_MASTER),(SELECT NULLIF(MAX(WARRANTY_ID),0)+1 FROM WARRANTY_MASTER WHERE BRANCH_CODE=?),?,?,?,?,?,(SELECT MAX(DISPLAY_ORDER)+1 FROM WARRANTY_MASTER WHERE BRANCH_CODE=?),'W'+?)
#####(13-06-2016)#####UPDATE_WARRANTY=update WARRANTY_MASTER set WARRANTY_DESCRIPTION=?,RSACODE=?,REMARKS=?,STATUS=? where WARRANTY_ID=? and BRANCH_CODE=?
UPDATE_WARRANTY = update WARRANTY_MASTER set WARRANTY_DESCRIPTION=?,RSACODE=?,REMARKS=?,STATUS=?,INT_CODE='W'+? where WARRANTY_ID=? and BRANCH_CODE=?
EDIT_WARRANTY=select WARRANTY_ID,WARRANTY_DESCRIPTION,RSACODE,REMARKS,STATUS from WARRANTY_MASTER where BRANCH_CODE=? and WARRANTY_ID=?
#####(13-06-2016)#####GET_CONSTANT_LIST=select CATEGORY_ID,CATEGORY_DETAIL_ID,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS,DETAIL_NAME from CONSTANT_DETAIL where BRANCH_CODE=?
GET_CONSTANT_LIST = SELECT CATEGORY_ID,CATEGORY_DETAIL_ID,(CASE STATUS WHEN  'Y' THEN  'Active' WHEN 'N' THEN 'DeActive' END)  STATUS,DETAIL_NAME FROM CONSTANT_DETAIL WHERE BRANCH_CODE=? AND CATEGORY_ID=?
GET_CONTANTMASTER_LIST = SELECT CATEGORY_ID,CATEGORY_NAME,(CASE STATUS WHEN  'Y' THEN  'Active' WHEN 'N' THEN 'DeActive'   END) STATUS,RSACODE FROM CONSTANT_MASTER WHERE BRANCH_CODE\=?
GET_CONSTANT_LIST_NAME=select CATEGORY_ID,CATEGORY_DETAIL_ID,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS,DETAIL_NAME from CONSTANT_DETAIL where BRANCH_CODE=? and CATEGORY_ID=?
GET_CATEGORY=select CATEGORY_ID,CATEGORY_NAME from CONSTANT_MASTER where status='Y' and branch_code in(?) order by CATEGORY_NAME
#####(13-06-2016)#####INS_CONSTANT=Insert into ADNICLOCAL.CONSTANT_DETAIL(CATEGORY_ID, CATEGORY_DETAIL_ID, DETAIL_NAME, REMARKS, STATUS,RSACODE, PERCENT, BRANCH_CODE, PARENT_MENU) Values((select MAX(CATEGORY_ID)+1 from CONSTANT_DETAIL where branch_code=?), ?, ?, ?, ?, ?, ?, ?, '')
INS_CONSTANT = Insert into CONSTANT_DETAIL(CATEGORY_ID, CATEGORY_DETAIL_ID, DETAIL_NAME, REMARKS, STATUS,RSACODE, PERCENTRATE, BRANCH_CODE, PARENT_MENU) Values(?, (SELECT   MAX (CATEGORY_DETAIL_ID) + 1  FROM   CONSTANT_DETAIL WHERE  CATEGORY_ID=? and branch_code = ?), ?, ?, ?, ?, ?, ?, '')
Check_constant=select count(RSACODE) from CONSTANT_DETAIL where branch_code=? and RSACODE=?
Check_constant_name=select count(DETAIL_NAME) from CONSTANT_DETAIL where branch_code=? and upper(DETAIL_NAME)=upper(?)
EDIT_CONSTANT=select DETAIL_NAME,PERCENTRATE,REMARKS,RSACODE,STATUS,CATEGORY_ID,CATEGORY_DETAIL_ID from CONSTANT_DETAIL where CATEGORY_ID=? and CATEGORY_DETAIL_ID=? and BRANCH_CODE=?
#####(13-06-2016)#####UPDATE_CONSTANT=update CONSTANT_DETAIL set DETAIL_NAME=?,PERCENT=?,REMARKS=?,RSACODE=?,STATUS=? where CATEGORY_DETAIL_ID=? and CATEGORY_ID=?
UPDATE_CONSTANT = UPDATE CONSTANT_DETAIL SET DETAIL_NAME=?,PERCENTRATE=?,REMARKS=?,RSACODE=?,STATUS=? WHERE CATEGORY_DETAIL_ID=? AND CATEGORY_ID=? AND branch_code=?
Check_extra_name=select count(extra_cover_name) from EXTRA_COVER_MASTER where mode_transport_id=? and branch_code=? and lower(extra_cover_name)=lower(?)
UPDATE_CITY_MASTER=update city_master set city_name=?,country_id=?,rsacode=?,remarks=?,status=? where city_id=?
#####(10-06-2016)#####GET_COUNTRY_DETAIL=SELECT   C.COUNTRY_ID,C.SNO__,C.COUNTRY_NAME,C.WAR_RATE,C.STARTING_PLACE,C.ENDING_PLACE,(case c.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'  when 'R' then 'Refferal'  end) STATUS FROM COUNTRY_MASTER_DETAIL C WHERE C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_NAME\=C.COUNTRY_NAME and BELONGING_COUNTRY_ID\=C.BELONGING_COUNTRY_ID) AND C.BELONGING_COUNTRY_ID\=? AND lower(C.COUNTRY_NAME) like lower(('%'+ ' ' +?+ ' ' +'%'))
GET_COUNTRY_DETAIL = SELECT   C.COUNTRY_ID,C.SNO__,C.COUNTRY_NAME,C.WAR_RATE,C.STARTING_PLACE,C.ENDING_PLACE,(case c.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'  when 'R' then 'Refferal'  end) STATUS,CONVERT(VARCHAR(10),C.EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM COUNTRY_MASTER_DETAIL C WHERE C.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_NAME\=C.COUNTRY_NAME and BELONGING_COUNTRY_ID\=C.BELONGING_COUNTRY_ID) AND C.BELONGING_COUNTRY_ID\=? 
GET_COUNTRY_DETAIL_NAME=SELECT   C.COUNTRY_ID,C.SNO__,C.COUNTRY_NAME,C.WAR_RATE,C.STARTING_PLACE,C.ENDING_PLACE,  
GET_Countries=select upper(E.COUNTRY_ID)COUNTRY_ID,upper(E.COUNTRY_NAME)COUNTRY_NAME from COUNTRY_MASTER E WHERE  E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME=E.COUNTRY_NAME) and country_id=(select origination_country_id from branch_master where branch_code=?)
Check_countryDet_name=select count(COUNTRY_NAME) from COUNTRY_MASTER_DETAIL where upper(COUNTRY_NAME)=upper(?)
Check_countryDet=select count(RSACODE) from COUNTRY_MASTER_DETAIL where RSACODE=?
#####(11-06-2016)#####INS_COUNTRYDET=insert into COUNTRY_MASTER_DETAIL(SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,STARTING_PLACE, SP_WARRANTIES_CONDITIONS, ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS,RSACODE, NATIONALITY_NAME, AMEND_ID, EFFECTIVE_DATE, REMARKS,BELONGING_COUNTRY_ID) Values((select MAX(SNO__)+1 from COUNTRY_MASTER_DETAIL),?,(select COUNTRY_NAME from COUNTRY_MASTER where COUNTRY_ID=?), ?, ?,?, ?, ?, ?, ?,?, ?, ?, convert(date,?,103), ?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?))
INS_COUNTRYDET = insert into COUNTRY_MASTER_DETAIL(SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,STARTING_PLACE, SP_WARRANTIES_CONDITIONS, ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS,RSACODE, NATIONALITY_NAME, AMEND_ID, EFFECTIVE_DATE, REMARKS,BELONGING_COUNTRY_ID) Values((select MAX(SNO__)+1 from COUNTRY_MASTER_DETAIL),?,(select COUNTRY_NAME from COUNTRY_MASTER cm where cm.COUNTRY_ID=? AND cm.AMEND_ID = (select max(amend_id)   from country_master com where cm.COUNTRY_ID = com.COUNTRY_ID)), ?, ?,?, ?, ?, ?, ?,?, ?, ?, convert(date,?,103), ?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER bm where bm.BRANCH_CODE=? and amend_id = (select max(amend_id) from branch_master bom where bm.BRANCH_CODE = bom.BRANCH_CODE)))
#####(11-06-2016)#####EDIT_COUNTRY_DET=select SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,(case STARTING_PLACE when  'Any Port' then '1'  when  'Warehouse' then '2'  when  'Disabled' then '3' end) STARTING_PLACE, SP_WARRANTIES_CONDITIONS,(case ENDING_PLACE when  'Any Port' then '1'  when  'Warehouse' then '2'  when  'Disabled' then '3' end) ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS, RSACODE, NATIONALITY_NAME,convert(varchar(10),EFFECTIVEDATE,103) EFFECTIVE_DATE, REMARKS from COUNTRY_MASTER_DETAIL where COUNTRY_ID\=? and SNO__\=?
EDIT_COUNTRY_DET = select SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,(case STARTING_PLACE when  'Any Port' then '1'  when  'Warehouse' then '2'  when  'Disabled' then '3' end) STARTING_PLACE, SP_WARRANTIES_CONDITIONS,(case ENDING_PLACE when  'Any Port' then '1'  when  'Warehouse' then '2'  when  'Disabled' then '3' end) ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS, RSACODE, NATIONALITY_NAME,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, REMARKS from COUNTRY_MASTER_DETAIL where COUNTRY_ID\=? and SNO__\=?
#####(11-06-2016)#####UPDATE_COUNTRYDET=insert into COUNTRY_MASTER_DETAIL(SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,STARTING_PLACE, SP_WARRANTIES_CONDITIONS, ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS,RSACODE, NATIONALITY_NAME, AMEND_ID, EFFECTIVE_DATE, REMARKS,BELONGING_COUNTRY_ID) Values((select MAX(SNO__)+1 from COUNTRY_MASTER_DETAIL),?, ?, ?, ?,?, ?, ?, ?, ?,?, ?, (select MAX(amend_id)+1 from COUNTRY_MASTER_DETAIL where SNO__\=?), convert(date,?,103), ?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE\=?))
UPDATE_COUNTRYDET = insert into COUNTRY_MASTER_DETAIL(SNO__, COUNTRY_ID, COUNTRY_NAME, COUNTRY_SHORT_NAME, WAR_RATE,STARTING_PLACE, SP_WARRANTIES_CONDITIONS, ENDING_PLACE, EP_WARRANTIES_CONDITIONS, STATUS,RSACODE, NATIONALITY_NAME, AMEND_ID, EFFECTIVE_DATE, REMARKS,BELONGING_COUNTRY_ID) Values((select MAX(SNO__)+1 from COUNTRY_MASTER_DETAIL),?, ?, ?, ?,?, ?, ?, ?, ?,?, ?, (select MAX(amend_id)+1 from COUNTRY_MASTER_DETAIL where SNO__\=?), convert(date,?,103), ?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER bm where bm.BRANCH_CODE\=? and amend_id \= (select max(amend_id) from branch_master bom where bm.BRANCH_CODE \= bom.BRANCH_CODE)))
GET_BASERATE_COVERAGE=SELECT CM.COVER_ID,CM.COVER_NAME FROM COVER_MASTER CM WHERE mode_transport_id = ? and CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE mode_transport_id = ? and COVER_ID=CM.COVER_ID AND BRANCH_CODE= ?) AND CM.BRANCH_CODE= ? order by CM.COVER_NAME
GET_BASERATE_CONVEY=SELECT CONV_MEAN,CONVDESC FROM CONVEYAN_MASTER CM WHERE MODE_TRANSPORT_ID=? AND BRANCH_CODE= ? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER WHERE CM.CONV_MEAN=CONV_MEAN AND BRANCH_CODE= ? AND MODE_TRANSPORT_ID= ?) ORDER BY CONVDESC
GET_BASERATE_COUNTRY=SELECT CM.COUNTRY_ID,CM.COUNTRY_NAME FROM COUNTRY_MASTER CM WHERE CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID=CM.COUNTRY_ID)ORDER BY COUNTRY_NAME
GET_BASERATE_COMMODITY=SELECT CM.COMMODITY_ID,CM.COMMODITY_NAME FROM COMMODITYMASTER CM WHERE CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID=CM.COMMODITY_ID AND BRANCH_CODE=?)AND CM.BRANCH_CODE=? ORDER BY CM.COMMODITY_NAME
GET_AGENT_LIST= SELECT DISTINCT(SM.SETTLING_AGENT_NAME),SM.SETTLING_AGENT_ID,SM.RSACODE,CM.COUNTRY_NAME,(case sm.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS FROM SETTLING_AGENT_MASTER SM,CITY_MASTER CI,COUNTRY_MASTER CM WHERE CM.COUNTRY_ID=SM.COUNTRY_ID AND BRANCH_CODE=?
GET_AGENT_BY_NAME=SELECT SM.SETTLING_AGENT_NAME,SM.SETTLING_AGENT_ID,SM.RSACODE,CM.COUNTRY_NAME,CI.CITY_NAME,(case sm.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS FROM SETTLING_AGENT_MASTER SM,CITY_MASTER CI,COUNTRY_MASTER CM WHERE CI.CITY_ID\=SM.CITY_ID AND CM.COUNTRY_ID\=SM.COUNTRY_ID AND BRANCH_CODE\=? AND lower(SM.SETTLING_AGENT_NAME) like lower('%'+ ' ' +?+ ' ' +'%') order by COUNTRY_NAME
GET_CITY_BY_COUNTRY=SELECT CITY_NAME,CITY_ID FROM CITY_MASTER WHERE COUNTRY_ID=?
Check_Agent=select distinct(RSACODE) from SETTLING_AGENT_MASTER where  (branch_code=? or branch_code='01') and RSACODE=?
INS_AGENT_MASTER=insert into SETTLING_AGENT_MASTER values((select max(SNO__)+1 from SETTLING_AGENT_MASTER WHERE branch_code = ? ),(select max(SETTLING_AGENT_ID)+1 from SETTLING_AGENT_MASTER where branch_code=?),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where branch_code=?),?)
EDIT_SETTLING_AGENT_MASTER=select SETTLING_AGENT_ID,SETTLING_AGENT_NAME,COUNTRY_ID,CITY_ID,SHORT_NAME,ADDRESS1,ADDRESS2,ADDRESS3,CITY_NAME,ZIP_CODE,TELEPHONE_NO,FAX_NO,MOBILE_NO,EMAIL,RSACODE,REMARKS,STATUS from SETTLING_AGENT_MASTER where (branch_code=?  or branch_code='01') and SETTLING_AGENT_ID=?
UPDATE_SETTLING_AGENT_MASTER=update SETTLING_AGENT_MASTER set SETTLING_AGENT_NAME=?,COUNTRY_ID=?,CITY_ID=?,SHORT_NAME=?,ADDRESS1=?,ADDRESS2=?,ADDRESS3=?,CITY_NAME=?,ZIP_CODE=?,TELEPHONE_NO=?,FAX_NO=?,MOBILE_NO=?,EMAIL=?,RSACODE=?,REMARKS=?,STATUS=? where branch_code=? and SETTLING_AGENT_ID=?
#####(09-06-2016)##### GET_COMMODITY_DETAIL=SELECT CM.COMMODITY_ID,CM.COMMODITY_NAME,CM.AMEND_ID,convert(varchar(10),cm.EFFECTIVEDATE,103)EFFECTIVE_DATE,(case cm.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'  when 'R' then 'Refferal'  end)STATUS FROM COMMODITYMASTER CM WHERE CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID AND BRANCH_CODE\=?)AND CM.BRANCH_CODE\=?  
GET_COMMODITY_DETAIL = SELECT CM.COMMODITY_ID,CM.COMMODITY_NAME,CM.AMEND_ID,CONVERT(VARCHAR(10),cm.EFFECTIVE_DATE,103)EFFECTIVE_DATE,(CASE cm.STATUS WHEN  'Y' THEN  'Active' WHEN 'N' THEN 'DeActive'  WHEN 'R' THEN 'Refferal'  END)STATUS FROM COMMODITYMASTER CM WHERE CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID=CM.COMMODITY_ID AND BRANCH_CODE=?)AND CM.BRANCH_CODE=?
GET_COMMODITY_DETAIL_NAME=SELECT CM.COMMODITY_ID,CM.COMMODITY_NAME,CM.AMEND_ID,convert(varchar(10),cm.EFFECTIVEDATE,103) EFFECTIVE_DATE,(case cm.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'  when 'R' then 'Refferal'  end)STATUS FROM COMMODITYMASTER CM WHERE CM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID=CM.COMMODITY_ID AND BRANCH_CODE=?)AND CM.BRANCH_CODE=? AND LOWER(CM.COMMODITY_NAME) LIKE LOWER(('%'+ ' ' +?+ ' ' +'%')) ORDER BY CM.COMMODITY_NAME
GET_COMMODITY_TYPE=select CATEGORY_DETAIL_ID,DETAIL_NAME from CONSTANT_DETAIL where CATEGORY_ID=42 and STATUS='Y' and branch_code=?
#####(09-06-2016)##### INS_COMMODITY_MASTER=insert into COMMODITYMASTER values((select MAX(SNO__)+1 from COMMODITYMASTER),(select MAX(COMMODITY_ID)+1 from COMMODITYMASTER),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,convert(date,?,103),?,?,?,?)
INS_COMMODITY_MASTER = INSERT INTO COMMODITYMASTER (SNO__, COMMODITY_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL,ICC_A_SEA, ICC_B_SEA, ICC_C_SEA, ICC_C_NONDELIVERY, ICC_A_FROZEN_MEAT_SEA,ICC_A_FROZEN_FOOD_SEA, ICC_C_FROZEN_MEAT_SEA, ICC_C_FROZEN_FOOD_SEA, ICC_AIR_CARGO_AIR, ICC_AIR_CARGO_ALL_RISKS,ALL_RISKS_LAND_TRANSIT_LAND, LAND_TRANSIT_LAND, ALL_RISKS_PARCEL_POST_AIR, ALL_RISKS_SEA_AND_AIR, FRAGILE, COMMODITY_TYPE_ID, EXCLUSION_ID,  WARRANTY_ID, REMARKS, STATUS, RSACODE, EFFECTIVE_DATE,AMEND_ID, RAG, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM) VALUES((SELECT MAX(SNO__)+1 FROM COMMODITYMASTER),(SELECT MAX(COMMODITY_ID)+1 FROM COMMODITYMASTER),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,CONVERT(DATE,?,103),?,?,?,?)
Check_commodity_name=select count(COMMODITY_NAME) from COMMODITYMASTER where UPPER(COMMODITY_NAME)=UPPER(?) and BRANCH_CODE=?
Check_commodity=select count(RSACODE) from COMMODITYMASTER where RSACODE\=? and BRANCH_CODE\=? 
#####(09-06-2016)##### EDIT_COMMODITY_MASTER=select SNO__, COMMODITY_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL,ICC_A_SEA,ICC_B_SEA,ICC_C_SEA,ICC_C_NONDELIVERY,ICC_A_FROZEN_MEAT_SEA,ICC_A_FROZEN_FOOD_SEA,ICC_C_FROZEN_MEAT_SEA,ICC_C_FROZEN_FOOD_SEA,ICC_AIR_CARGO_AIR,ICC_AIR_CARGO_ALL_RISKS,ALL_RISKS_LAND_TRANSIT_LAND,LAND_TRANSIT_LAND,ALL_RISKS_PARCEL_POST_AIR,ALL_RISKS_SEA_AND_AIR,FRAGILE, RAG, EXCLUSION_ID,WARRANTY_ID, REMARKS, STATUS, RSACODE, TO_CHAR(EFFECTIVE_DATE,'MM/DD/YYYY')EFFECTIVE_DATE,AMEND_ID, COMMODITY_TYPE_ID, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM from COMMODITYMASTER where COMMODITY_ID=? and BRANCH_CODE=? and amend_id=(select max(amend_id) from COMMODITYMASTER where COMMODITY_ID=? and BRANCH_CODE=?)
EDIT_COMMODITY_MASTER = SELECT SNO__, COMMODITY_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL,ICC_A_SEA,ICC_B_SEA,ICC_C_SEA,ICC_C_NONDELIVERY,ICC_A_FROZEN_MEAT_SEA,ICC_A_FROZEN_FOOD_SEA,ICC_C_FROZEN_MEAT_SEA,ICC_C_FROZEN_FOOD_SEA,ICC_AIR_CARGO_AIR,ICC_AIR_CARGO_ALL_RISKS,ALL_RISKS_LAND_TRANSIT_LAND,LAND_TRANSIT_LAND,ALL_RISKS_PARCEL_POST_AIR,ALL_RISKS_SEA_AND_AIR,FRAGILE, RAG, EXCLUSION_ID,WARRANTY_ID, REMARKS, STATUS, RSACODE, CONVERT(VARCHAR(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,AMEND_ID, COMMODITY_TYPE_ID, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM FROM COMMODITYMASTER WHERE COMMODITY_ID=? AND BRANCH_CODE=? AND amend_id=(SELECT MAX(amend_id) FROM COMMODITYMASTER WHERE COMMODITY_ID=? AND BRANCH_CODE=?)
#####(09-06-2016)##### UPDATE_COMMODITY_MASTER=insert into COMMODITYMASTER values((select MAX(SNO__)+1 from COMMODITYMASTER),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,convert(date,?,103),?,?,?,?)
UPDATE_COMMODITY_MASTER = INSERT INTO COMMODITYMASTER (SNO__, COMMODITY_ID, COMMODITY_NAME, COMMODITY_RATE, COVERAGE_REFERAL,ICC_A_SEA, ICC_B_SEA, ICC_C_SEA, ICC_C_NONDELIVERY, ICC_A_FROZEN_MEAT_SEA,ICC_A_FROZEN_FOOD_SEA, ICC_C_FROZEN_MEAT_SEA, ICC_C_FROZEN_FOOD_SEA, ICC_AIR_CARGO_AIR, ICC_AIR_CARGO_ALL_RISKS,ALL_RISKS_LAND_TRANSIT_LAND, LAND_TRANSIT_LAND, ALL_RISKS_PARCEL_POST_AIR, ALL_RISKS_SEA_AND_AIR,FRAGILE, COMMODITY_TYPE_ID, EXCLUSION_ID,  WARRANTY_ID, REMARKS, STATUS, RSACODE, EFFECTIVE_DATE,AMEND_ID, RAG, BRANCH_CODE, COMMODITY_EXCESS_PREMIUM) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,CONVERT(DATE,?,103),?,?,?,?)
Check_Date=select count(CM.EFFECTIVE_DATE) from COMMODITYMASTER CM where CM.EFFECTIVE_DATE<convert(date,?,103) and CM.commodity_name\=? and CM.branch_code\=? and CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID AND BRANCH_CODE\=?)
GET_CURRENCY_NAME=SELECT   CM.CURRENCY_ID, CM.CURRENCY_NAME,(CASE STATUS WHEN 'Y' THEN 'Active' ELSE 'DeActive' END) STATUS, CM.SHORT_NAME, CM.SUB_CURRENCY FROM   CURRENCY_MASTER CM WHERE  Cm.COUNTRY_ID =(SELECT DESTINATION_COUNTRY_ID FROM BRANCH_MASTER BM WHERE BM.BRANCH_CODE=?) AND CM.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   CURRENCY_MASTER C WHERE   C.CURRENCY_ID = CM.CURRENCY_ID and CM.COUNTRY_ID=C.COUNTRY_ID)
GET_CURRENCY_NAME_LIST=select CM.CURRENCY_ID,CM.CURRENCY_NAME,(case cm.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end) STATUS,CM.SHORT_NAME,CM.SUB_CURRENCY from CURRENCY_MASTER CM where CM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=CM.CURRENCY_ID) and lower(CURRENCY_NAME) like lower(('%'+ ' ' +?+ ' ' +'%')) 
INS_CURRENCY_MASTER=insert into CURRENCY_MASTER (CURRENCY_ID, CURRENCY_NAME, AMEND_ID, INCEPTION_DATE, EXPIRY_DATE, EFFECTIVE_DATE, ENTRY_DATE, REMARKS, STATUS, RSACODE, SNO__, COUNTRY_ID, DISPLAY_ORDER, SHORT_NAME, RFACTOR, SUB_CURRENCY) values((select MAX(CURRENCY_ID)+1 from CURRENCY_MASTER),?,?,'','',CONVERT(DATE,?,103),'',?,?,?,(select MAX(SNO__)+1 from CURRENCY_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from CURRENCY_MASTER where country_id = (select country_id from branch_master where branch_code=?)),?,?,?)
UPDATE_CURRENCY_MASTER=insert into CURRENCY_MASTER (CURRENCY_ID, CURRENCY_NAME, AMEND_ID, INCEPTION_DATE, EXPIRY_DATE, EFFECTIVE_DATE, ENTRY_DATE, REMARKS, STATUS, RSACODE, SNO__, COUNTRY_ID, DISPLAY_ORDER, SHORT_NAME, RFACTOR, SUB_CURRENCY) values(?,?,?,'','',CONVERT(DATE,?,103),'',?,?,?,(select MAX(SNO__)+1 from CURRENCY_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from CURRENCY_MASTER where country_id = (select country_id from branch_master where branch_code=?)),?,?,?)
Check_currency_name=select count(CURRENCY_NAME) from CURRENCY_MASTER where upper(CURRENCY_NAME)=upper(?)
Check_currency=select count(RSACODE) from CURRENCY_MASTER where RSACODE=?
EDIT_CURRENCY_MASTER= SELECT   CURRENCY_NAME, AMEND_ID, convert(varchar(10),EFFECTIVE_DATE,103)  EFFECTIVE_DATE, SHORT_NAME, RFACTOR, SUB_CURRENCY, REMARKS, RSACODE, STATUS, CURRENCY_ID FROM   CURRENCY_MASTER WHERE   CURRENCY_ID \=? AND country_id \= (SELECT   country_id FROM   branch_master WHERE   branch_code \=?)
GET_EXCHANGE_MASTER=select distinct(E.EXCHANGE_ID),E.EXCHANGE_RATE,CM.CURRENCY_NAME,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end)STATUS from EXCHANGE_MASTER E, CURRENCY_MASTER CM where E.AMEND_ID\=(select MAX(AMEND_ID) from EXCHANGE_MASTER where EXCHANGE_ID\=E.EXCHANGE_ID ) and CM.CURRENCY_ID\=E.CURRENCY_ID  
GET_EXCHANGE_MASTER_NAME=select distinct(E.EXCHANGE_ID),E.EXCHANGE_RATE,CM.CURRENCY_NAME,(case E.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end) STATUS from EXCHANGE_MASTER E, CURRENCY_MASTER CM where E.AMEND_ID=(select MAX(AMEND_ID) from EXCHANGE_MASTER where EXCHANGE_ID=E.EXCHANGE_ID group by E.EXCHANGE_ID) and CM.CURRENCY_ID=E.CURRENCY_ID and lower(CM.CURRENCY_NAME) like lower(('%'+ ' ' +?+ ' ' +'%'))  order by E.exchange_id
GET_EXCHANGES=select CM.CURRENCY_ID, CM.CURRENCY_NAME FROM CURRENCY_MASTER CM where CM.AMEND_ID\=(select MAX(AMEND_ID) from CURRENCY_MASTER where CURRENCY_ID\=CM.CURRENCY_ID and COUNTRY_ID\=CM.COUNTRY_ID) and COUNTRY_ID\=(select country_id from branch_master where branch_code\=?) order by currency_name 
INS_EXCHANGE_MASTER=insert into EXCHANGE_MASTER values((select MAX(EXCHANGE_ID)+1 from EXCHANGE_MASTER),?,?,?,'','',convert(date,?,103),'',?,?,?,(select MAX(SNO__)+1 from EXCHANGE_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from EXCHANGE_MASTER))
Check_exchange_name=select count(CURRENCY_ID) from EXCHANGE_MASTER where CURRENCY_ID=?
UPDATE_EXCHANGE_MASTER=insert into EXCHANGE_MASTER values(?,?,?,?,'','',convert(date,?,103),'',?,?,?,(select MAX(SNO__)+1 from EXCHANGE_MASTER),(select ORIGINATION_COUNTRY_ID from BRANCH_MASTER where BRANCH_CODE=?),(select MAX(DISPLAY_ORDER)+1 from EXCHANGE_MASTER))
EDIT_EXCHANGE_MASTER=select E.CURRENCY_ID,E.AMEND_ID,convert(varchar(10),E.EFFECTIVE_DATE,103)EFFECTIVE_DATE,E.EXCHANGE_RATE,E.REMARKS,E.RSACODE,E.STATUS,E.EXCHANGE_ID from EXCHANGE_MASTER E where E.EXCHANGE_ID\=? AND E.COUNTRY_ID\=(SELECT COUNTRY_ID FROM BRANCH_MASTER WHERE BRANCH_CODE\=?) AND E.AMEND_ID\=(select MAX(AMEND_ID) from EXCHANGE_MASTER where EXCHANGE_ID\=E.EXCHANGE_ID AND COUNTRY_ID\=E.COUNTRY_ID )
Check_exchange=select count(RSACODE) from EXCHANGE_MASTER where RSACODE=?
#####(09-06-2016)#####GET_COVER_NAME=select C.COVER_NAME,M.TRANSPORT_DESCRIPTION,C.COVER_RATE,(case C.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end)STATUS,C.COVER_ID from COVER_MASTER C, MODE_OF_TRANSPORT M where C.branch_code=? and C.AMEND_ID=(select MAX(AMEND_ID) from COVER_MASTER where COVER_ID=C.COVER_ID) and M.MODE_TRANSPORT_ID=C.MODE_TRANSPORT_ID  AND C.MODE_TRANSPORT_ID = M.MODE_TRANSPORT_ID AND M.BRANCH_CODE=C.BRANCH_CODE AND  C.BRANCH_CODE=?
GET_COVER_NAME = SELECT  C.COVER_NAME,M.TRANSPORT_DESCRIPTION,C.COVER_RATE,(case C.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end)STATUS, C.COVER_ID  FROM   COVER_MASTER C, MODE_OF_TRANSPORT M WHERE  C.branch_code = ? AND C.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   COVER_MASTER CM  WHERE   CM.COVER_ID = C.COVER_ID  AND CM.BRANCH_CODE =C.BRANCH_CODE)  AND M.MODE_TRANSPORT_ID = C.MODE_TRANSPORT_ID   AND C.MODE_TRANSPORT_ID = M.MODE_TRANSPORT_ID AND M.BRANCH_CODE = C.BRANCH_CODE order by C.DISPLAY_ORDER
UPDATE_COVER_MASTER_INSERT = insert into COVER_MASTER (SNO__, COVER_ID, COVER_NAME,MODE_TRANSPORT_ID, DESCRIPTION, RSACODE,AMEND_ID, EFFECTIVE_DATE, DISPLAY_ORDER,BRANCH_CODE, COVER_RATE, REFERAL_STATUS,REFERAL_VALUE, REMARKS, STATUS,COVER_ARABIC) values ((select MAX(SNO__)+1 from COVER_MASTER),?,?,?,?,?,?,convert(date,?,103),?,?,?,?,convert(decimal(10,2), CAST(? AS FLOAT)),?,?,?)
GET_COVER_NAME_LIST=select C.COVER_NAME,C.COVER_ID from COVER_MASTER C where C.branch_code=? and c.MODE_TRANSPORT_ID=? and C.AMEND_ID=(select MAX(AMEND_ID) from COVER_MASTER where COVER_ID=C.COVER_ID)  AND  C.BRANCH_CODE=?
#####(11-06-2016)#####INS_COVER_MASTER=insert into COVER_MASTER values((select MAX(SNO__)+1 from COVER_MASTER),(select MAX(COVER_ID)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,?,?,?,convert(date,?,103),(select MAX(DISPLAY_ORDER)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,'N','',?,?,'')
INS_COVER_MASTER = insert into COVER_MASTER (SNO__, COVER_ID, COVER_NAME,MODE_TRANSPORT_ID, DESCRIPTION, RSACODE,AMEND_ID, EFFECTIVE_DATE, DISPLAY_ORDER,BRANCH_CODE, COVER_RATE, REFERAL_STATUS,REFERAL_VALUE, REMARKS, STATUS) values(( select MAX(SNO__)+1 from COVER_MASTER),( select MAX(COVER_ID)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,?,?,?,convert(date,?,103),( select MAX(DISPLAY_ORDER)+1 from COVER_MASTER where BRANCH_CODE=?),?,?,?,convert(decimal(10,2), CAST('' AS FLOAT)),?,?)
#####(11-06-2016)#####UPDATE_COVER_MASTER=insert into COVER_MASTER values((select MAX(SNO__)+1 from COVER_MASTER),?,?,?,?,?,?,convert(date,?,103),?,?,?,'N','',?,?,'')
UPDATE_COVER_MASTER = UPDATE COVER_MASTER  SET  COVER_NAME\=?,MODE_TRANSPORT_ID\=?, DESCRIPTION\=?, RSACODE\=?, EFFECTIVE_DATE\=convert(date,?,103), DISPLAY_ORDER\=?, COVER_RATE\=?, REFERAL_STATUS\=? ,REMARKS\=?, STATUS\=? WHERE COVER_ID\=? and COVER_MASTER.branch_code\=? and COVER_MASTER.amend_id\=(select max(amend_id) from COVER_MASTER CC where cc.cover_id\=COVER_MASTER.cover_id and cc.branch_code\=COVER_MASTER.branch_code)
#####(11-06-2016)#####EDIT_COVER_MASTER=select COVER_ID,COVER_NAME,DESCRIPTION,MODE_TRANSPORT_ID,COVER_RATE,STATUS,convert(varchar(10),EFFECTIVE_DATE,103)EFFECTIVE_DATE,RSACODE,REMARKS,AMEND_ID from COVER_MASTER where COVER_ID=? and BRANCH_CODE=?
EDIT_COVER_MASTER = select COVER_ID,COVER_NAME,DESCRIPTION,MODE_TRANSPORT_ID,COVER_RATE,STATUS,convert(varchar(10),EFFECTIVE_DATE,103)EFFECTIVE_DATE,RSACODE,REMARKS,AMEND_ID,REFERAL_STATUS from COVER_MASTER where COVER_ID=? and BRANCH_CODE=?
Check_cover_name=select count(COVER_NAME) from COVER_MASTER where upper(COVER_NAME)=upper(?) and BRANCH_CODE=?
Check_cover=select count(RSACODE) from COVER_MASTER where RSACODE=? and BRANCH_CODE=?
GET_EXCLUSION_LIST=SELECT EXCLUSION_DESCRIPTION,RSACODE,EXCLUSION_ID,REMARKS,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end)STATUS FROM EXCLUSION_MASTER WHERE BRANCH_CODE=?
GET_EXCLUSION_BY_NAME=SELECT EXCLUSION_DESCRIPTION,RSACODE,EXCLUSION_ID,REMARKS, (case STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end) STATUS FROM EXCLUSION_MASTER WHERE BRANCH_CODE=? and lower(EXCLUSION_DESCRIPTION) like lower('%'+ ' ' +?+ ' ' +'%')
Check_exclusion_name= select count(EXCLUSION_DESCRIPTION) from exclusion_master where lower(EXCLUSION_DESCRIPTION)=lower(?) and BRANCH_CODE=?
Check_Exclusion=select distinct(rsacode) from exclusion_master where rsacode=? and branch_code=?
#####(13-06-2016)#####INS_EXCLUSION_MASTER=insert into exclusion_master(SNO__,EXCLUSION_ID,EXCLUSION_DESCRIPTION,RSACODE,REMARKS,STATUS,BRANCH_CODE,DISPLAY_ORDER) values((select max(SNO__)+1 from exclusion_master),(select max(EXCLUSION_ID)+1 from exclusion_master where branch_code=?), ?,?,?,?,?,(select max(EXCLUSION_ID)+1 from exclusion_master where branch_code=?))
INS_EXCLUSION_MASTER = INSERT INTO exclusion_master(SNO__,EXCLUSION_ID,EXCLUSION_DESCRIPTION,RSACODE,REMARKS,STATUS,BRANCH_CODE,DISPLAY_ORDER,INT_CODE) VALUES((SELECT MAX(SNO__)+1 FROM exclusion_master),(SELECT MAX(EXCLUSION_ID)+1 FROM exclusion_master WHERE branch_code=?), ?,?,?,?,?,(SELECT MAX(EXCLUSION_ID)+1 FROM exclusion_master WHERE branch_code=?), 'E'+?)
EDIT_EXCLUSION_MASTER=SELECT EXCLUSION_DESCRIPTION,RSACODE,EXCLUSION_ID,REMARKS,STATUS FROM EXCLUSION_MASTER WHERE BRANCH_CODE=? and exclusion_id=?
#####(13-06-2016)#####UPDATE_EXCLUSION_MASTER=UPDATE EXCLUSION_MASTER SET EXCLUSION_DESCRIPTION=?,REMARKS=?,RSACODE=?,STATUS=? WHERE EXCLUSION_ID=? AND BRANCH_CODE=?
UPDATE_EXCLUSION_MASTER = UPDATE EXCLUSION_MASTER SET EXCLUSION_DESCRIPTION=?,REMARKS=?,RSACODE=?,STATUS=?,INT_CODE='E'+? WHERE EXCLUSION_ID=? AND BRANCH_CODE=?
GET_ERROR_MASTER=select EM.ERROR_ID,EM.ERROR_DESC,SM.STAGE_DESC,PM.PRODUCT_NAME,(case em.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end) STATUS FROM  ERROR_MASTER EM,STAGE_MASTER SM,PRODUCT_MASTER PM WHERE EM.STAGE_ID=SM.STAGE_ID AND EM.PRODUCT_ID=PM.PRODUCT_ID and SM.PRODUCT_ID=PM.PRODUCT_ID  AND PM.BRANCH_CODE=?
GET_ERROR_LIST_NAME=select EM.ERROR_ID,EM.ERROR_DESC,SM.STAGE_DESC,PM.PRODUCT_NAME,(case em.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end) STATUS FROM  ERROR_MASTER EM,STAGE_MASTER SM,PRODUCT_MASTER PM WHERE EM.STAGE_ID=SM.STAGE_ID AND EM.PRODUCT_ID=PM.PRODUCT_ID and SM.PRODUCT_ID=PM.PRODUCT_ID AND PM.BRANCH_CODE=? AND LOWER(ERROR_DESC) LIKE LOWER(('%'+ ' ' +?+ ' ' +'%'))
EDIT_ERROR_MASTER=SELECT PRODUCT_ID,STAGE_ID,ERROR_DESC,REMARKS,STATUS,ERROR_ID from ERROR_MASTER WHERE ERROR_ID=?
UPDATE_ERROR_MASTER=UPDATE ERROR_MASTER SET ERROR_DESC=?,PRODUCT_ID=?,STAGE_ID=?,REMARKS=?,STATUS=? WHERE ERROR_ID=?
GET_ERROR_MASTER_LIST=SELECT ERROR_DESC,PRODUCT_NAME,STAGE_DESC,REMARKS,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end)STATUS from ERROR_MASTER where ERROR_ID=?
Check_name_error=select count(ERROR_DESC) from ERROR_MASTER where PRODUCT_ID=? and STAGE_ID=? and upper(ERROR_DESC)=upper(?)
#GET_PRODUCT_NAME_LIST=select PRODUCT_ID,PRODUCT_NAME from PRODUCT_MASTER where BRANCH_CODE=? and and p.AMEND_ID=(select max(amend_id) from PRODUCT_MASTER pm where PM.BRANCH_CODE=p.BRANCH_CODE and pm.PRODUCT_ID=p.PRODUCT_ID)
GET_PRODUCT_NAME_LIST=select PRODUCT_ID,PRODUCT_NAME from PRODUCT_MASTER p where BRANCH_CODE=? and  p.AMEND_ID=(select max(amend_id) from PRODUCT_MASTER PM where PM.BRANCH_CODE=p.BRANCH_CODE and PM.PRODUCT_ID=p.PRODUCT_ID)
GET_VESSEL_TYPE_LIST=SELECT DISTINCT (VESSEL_TYPE) FROM VESSEL_MASTER 
GET_STAGE_NAME_LIST=select STAGE_ID,STAGE_DESC from STAGE_MASTER where PRODUCT_ID=?
GET_CLAUSE_ID_LIST_NAME=SELECT C.CLAUSES_ID, C.CLAUSES_DESCRIPTION, C.DISPLAY_ORDER,(case c.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end)STATUS,COV.COVER_NAME FROM   CLAUSES_MASTER C, COVER_MASTER COV WHERE C.BRANCH_CODE \= ? AND C.COVER_ID\=COV.COVER_ID AND COV.BRANCH_CODE\=? AND LOWER (C.CLAUSES_DESCRIPTION) LIKE LOWER ( ('%' + ' ' + ? + ' ' + '%')) AND COV.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID\=COV.COVER_ID) 
GET_CLAUSE_ID_MASTER=SELECT C.CLAUSES_ID,COV.MODE_TRANSPORT_ID,(select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT mt where COV.MODE_TRANSPORT_ID=mt.MODE_TRANSPORT_ID and branch_code=?)TRANSPORT_DESCRIPTION,C.COVER_ID,COV.COVER_NAME,C.CLAUSES_DESCRIPTION,C.RSACODE,C.DISPLAY_ORDER,C.REMARKS,(case c.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end) STATUS,COV.COVER_NAME FROM CLAUSES_MASTER C, COVER_MASTER COV WHERE   C.BRANCH_CODE = ? AND C.COVER_ID = COV.COVER_ID AND COV.BRANCH_CODE=? AND C.EXTRA_COVER_ID = 0 AND COV.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID=COV.COVER_ID)
GET_WSRCC_LIST=SELECT C.CLAUSES_ID,COV.MODE_TRANSPORT_ID,(select TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT mt where COV.MODE_TRANSPORT_ID=mt.MODE_TRANSPORT_ID and branch_code=?)TRANSPORT_DESCRIPTION,C.COVER_ID,COV.COVER_NAME,C.CLAUSES_DESCRIPTION,C.RSACODE,C.DISPLAY_ORDER,C.REMARKS, (case c.STATUS when  'Y' then  'Active' when 'N' then 'DeActive'   end) STATUS,COV.COVER_NAME FROM CLAUSES_MASTER C, COVER_MASTER COV WHERE   C.BRANCH_CODE = ? AND C.COVER_ID = COV.COVER_ID AND COV.BRANCH_CODE=? AND C.EXTRA_COVER_ID = 1 AND COV.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID=COV.COVER_ID)
INS_CLAUSE_ID_MASTER=INSERT INTO CLAUSES_MASTER (SNO__,COVER_ID,CLAUSES_ID,CLAUSES_DESCRIPTION,EXTRA_COVER_ID,RSACODE,DISPLAY_ORDER,REMARKS,STATUS,BRANCH_CODE,PDF_LOCATION,INT_CODE) VALUES ((SELECT MAX(SNO__)+1 FROM CLAUSES_MASTER WHERE BRANCH_CODE=?),?,(SELECT MAX(CLAUSES_ID)+1 FROM CLAUSES_MASTER WHERE BRANCH_CODE=?),?,?,?,?,?,?,?,?,'C'+?)
Check_display_order=select count(DISPLAY_ORDER) from CLAUSES_MASTER where BRANCH_CODE=? and DISPLAY_ORDER=?
UPDATE_CLAUSE_ID_MASTER=UPDATE CLAUSES_MASTER SET CLAUSES_DESCRIPTION=?,STATUS=?,RSACODE=?,DISPLAY_ORDER=?,REMARKS=?,PDF_LOCATION=?,INT_CODE='C'+? WHERE CLAUSES_ID=? AND BRANCH_CODE=? AND EXTRA_COVER_ID=? and COVER_ID=?
EDIT_CLAUSE_ID_MASTER=SELECT CM.CLAUSES_ID,CMT.COVER_ID,CM.CLAUSES_DESCRIPTION,CM.EXTRA_COVER_ID,CM.RSACODE,CM.DISPLAY_ORDER,CM.STATUS,CM.REMARKS,(SELECT CMT.MODE_TRANSPORT_ID FROM MODE_OF_TRANSPORT MT WHERE MT.MODE_TRANSPORT_ID\=CMT.MODE_TRANSPORT_ID AND BRANCH_CODE\=?) MODE_TRANSPORT_ID FROM CLAUSES_MASTER CM,COVER_MASTER CMT WHERE CM.COVER_ID\=CMT.COVER_ID AND CM.CLAUSES_ID\=? and CM.BRANCH_CODE\=?
Check_vessel_name=SELECT COUNT(VESSEL_NAME) FROM VESSEL_MASTER WHERE upper(VESSEL_NAME)=upper(?)
Check_ClauseID=SELECT DISTINCT(RSACODE) FROM CLAUSES_MASTER where RSACODE=? and BRANCH_CODE=?
#####(09-06-2016)##### UPDATE_COMMODITY_MASTER_UPDATE=UPDATE COMMODITYMASTER CM SET COMMODITY_NAME \= ?,COMMODITY_RATE \= ?,COVERAGE_REFERAL \=?,ICC_A_SEA \= ?,ICC_B_SEA \= ?,ICC_C_SEA \= ?,ICC_AIR_CARGO_AIR \=?,ALL_RISKS_LAND_TRANSIT_LAND \=?,LAND_TRANSIT_LAND \=?,ALL_RISKS_PARCEL_POST_AIR \=?,ALL_RISKS_SEA_AND_AIR \= ?,REMARKS \= ?,STATUS \= ?,RSACODE \= ?,EFFECTIVE_DATE \= convert(date,?,103),COMMODITY_TYPE_ID \= ? WHERE COMMODITY_ID \= ? AND BRANCH_CODE \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID)FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=CM.COMMODITY_ID)      
UPDATE_COMMODITY_MASTER_UPDATE = UPDATE COMMODITYMASTER  SET COMMODITY_NAME \= ?,COMMODITY_RATE \= ?,COVERAGE_REFERAL \=?,ICC_A_SEA \= ?,ICC_B_SEA \= ?,ICC_C_SEA \= ?,ICC_C_NONDELIVERY\=?, ICC_A_FROZEN_MEAT_SEA\=?,ICC_A_FROZEN_FOOD_SEA\=?,  ICC_C_FROZEN_MEAT_SEA\=?,ICC_C_FROZEN_FOOD_SEA\=?,ICC_AIR_CARGO_AIR \=?,ICC_AIR_CARGO_ALL_RISKS\=? ,ALL_RISKS_LAND_TRANSIT_LAND \=?,LAND_TRANSIT_LAND\=?,ALL_RISKS_PARCEL_POST_AIR \=?,ALL_RISKS_SEA_AND_AIR \= ?,REMARKS \= ?,STATUS \= ?,RSACODE \= ?,EFFECTIVE_DATE \= CONVERT(DATE,?,103),RAG \= ? WHERE COMMODITY_ID \= ? AND BRANCH_CODE \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID)FROM COMMODITYMASTER WHERE COMMODITY_ID\=COMMODITYMASTER.COMMODITY_ID) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITYMASTER WHERE COMMODITY_ID\=COMMODITYMASTER.COMMODITY_ID)

##### SALE EXECUTION MASTER ##### 
GET_EXECUTIVE_MASTER = SELECT AC_EXECUTIVE_ID,Ac_Executive_Name,Lef.Oa_Code,Lef.Product_Id, Pm.Product_Name,CONVERT(VARCHAR(10),Lef.EFFECTIVE_DATE,103) EFFECTIVE_DATE, (CASE Lef.STATUS WHEN  'Y' THEN  'Active' WHEN 'N' THEN 'DeActive'   END) STATUS FROM Login_Executive_Details Lef,Product_Master Pm WHERE Lef.Product_Id\=Pm.Product_Id 
EDIT_EXECUTIVE_MASTER = SELECT AC_EXECUTIVE_NAME, OA_CODE, PRODUCT_ID, CONVERT(VARCHAR(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, ENTRY_DATE,STATUS, REMARKS,COMMISSION,OPENCOVER_COMMISSION FROM LOGIN_EXECUTIVE_DETAILS LED WHERE AC_EXECUTIVE_ID=?
UPDATE_INTO_EXECUTIVE_MASTER = UPDATE LOGIN_EXECUTIVE_DETAILS SET AC_EXECUTIVE_NAME\=?,OA_CODE\=?,EFFECTIVE_DATE\=CONVERT(DATE,?,103),STATUS\=?,REMARKS\=?,COMMISSION\=?,OPENCOVER_COMMISSION\=? WHERE AC_EXECUTIVE_ID\=?
INSERT_INTO_EXECUTIVE_MASTER=INSERT INTO LOGIN_EXECUTIVE_DETAILS(AC_EXECUTIVE_ID, AC_EXECUTIVE_NAME,OA_CODE, PRODUCT_ID, AMEND_ID,EFFECTIVE_DATE, ENTRY_DATE,STATUS, REMARKS, COMPANY_ID,COMMISSION,OPENCOVER_COMMISSION) VALUES((SELECT MAX(AC_EXECUTIVE_ID)+1 FROM LOGIN_EXECUTIVE_DETAILS), ?, ?,3,0,CONVERT(DATE,?,103),SYSDATETIME(),?,?,'213',?,?)
COUNT_OTHERPARTYMASTER=select count(*)  from login_executive_details where OA_CODE\=?
EDIT_CONSTANT_MASTER =SELECT * FROM CONSTANT_MASTER WHERE CATEGORY_ID\=? AND BRANCH_CODE\=?
INS_CONSTANT_MASTER = INSERT INTO CONSTANT_MASTER (CATEGORY_ID,CATEGORY_NAME,RSACODE,STATUS,BRANCH_CODE) VALUES ((SELECT NULLIF(MAX(CATEGORY_ID),0)+1 FROM CONSTANT_MASTER WHERE BRANCH_CODE=?),?,?,?,?)
UPD_CONSTANT_MASTER = UPDATE CONSTANT_MASTER SET CATEGORY_NAME=?,STATUS=?,RSACODE=? WHERE CATEGORY_ID=? AND BRANCH_CODE=?
      
#Portfolio
GET_PRODUCTS=select PRODUCT_ID,PRODUCT_NAME from PRODUCT_MASTER where BRANCH_CODE=(select BELONGING_BRANCH from branch_master where BRANCH_CODE = ?)
GET_PRODUCTS_DET=SELECT  pm.PRODUCT_ID PRODUCT_ID, pm.PRODUCT_NAME PRODUCT_NAME FROM PRODUCT_MASTER pm WHERE pm.BRANCH_CODE = ? AND convert(varchar,pm.PRODUCT_ID) in (Select * from table(Split_text_fn((select lm.PRODUCT_ID  from login_master lm Where  lm.login_id = ?))))
GET_PORTFOLIO_BY_DATE=select pm.application_no,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,md.premium,ISNULL(md.EXCESS_PREMIUM,'0'),pi.COMPANY_NAME,pi.LAST_NAME,pm.quote_no,md.remarks,pm.PDF_MODIFY_CLAUSE,pm.PDF_MODIFY_WARRANTY,pm.PDF_MODIFY_EXCLUSION,pm.PDF_MODIFY_EXTRACLAUSES,pm.PRODUCT_ID,Policy_Cancel_Status,ISNULL(pm.open_cover_no,'0'),pm.application_id,ISNULL(md.ADMIN_REFERRAL_STATUS,'N'),convert(varchar(10),pm.entry_date,103) from position_master pm,marine_data md,personal_info pi where convert(varchar(10),pm.entry_date,103)=? and pm.application_no=md.application_no and pi.customer_id=pm.customer_id and pm.remarks in ('Normal')  and  pm.product_id in (11,3) and lower(pm.status) in('y') and ISNULL(pm.open_cover_int_status,'0') not in ('LINKED') and (md.ADMIN_REFERRAL_STATUS in('N') or md.ADMIN_REFERRAL_STATUS is null) and pm.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)))   order by pm.quote_no desc
GET_BRANCH_REPORT_LIST=select ENTRY_DATE,BRANCH_NAME,LOGIN_ID,APPLICATIONID,QUOTE_NO,APPLICATION_NO,POLICY_NO,INCEPTION_DATE,EFFECTIVE_DATE,PRODUCT_ID,CUSTOMER_NAME,TRANSPORT_DESCRIPTION,COVER_NAME,SALE_TERM_NAME,TOTAL_SLAE_TERM_CHARGES,TOTAL_TOLERANCE_CHARGES,EXTRA_COVER_NAME,SUM_INSURED_LOCAL,CURRENCY_NAME,EXCHANGE_RATE,SUM_INSURED_FOREIGN,BASIC_PREMIUM,TOTAL_WAR_CHARGES,EXCESS_PREMIUM,POLICY_FEE,TOTAL_PREMIUM_LOCAL,FOREIGN_CURRENCY,TOTAL_PREMIUM_FOREIGN,COMMISSION,TRANSIT_FROM_CITY,TRANSIT_FROM_COUNTRY,FINAL_DEST_CITY,FINAL_DESTINATION_COUNTRY,DEBIT_NOTE_NO,REFERRAL,REFERAL_STATUS,STATUS,INTEGRATION_STATUS,INTEGRATION_ERROR from AdminReports(?,?,?) where Product_id=?
##GET_BRANCH_NAME_LIST=SELECT BRANCH_NAME,BRANCH_CODE FROM BRANCH_MASTER WHERE BRANCH_CODE=?
GET_BRANCH_NAME_LIST=SELECT  BRANCH_CODE,BRANCH_NAME from (SELECT BRANCH_CODE,BRANCH_NAME FROM BRANCH_MASTER WHERE BRANCH_CODE in( select item BRANCH_NAME FROM FN_Split_SV((SELECT ATTACHED_BRANCH FROM LOGIN_MASTER WHERE LOGIN_ID=?),','))) A ORDER BY (BRANCH_CODE)
GET_EXCHANGE_REPORT_LIST=SELECT A.EXCHANGE_RATE,B.CURRENCY_NAME,A.AMEND_ID,convert(varchar(10),A.EFFECTIVE_DATE,103) EFFECTIVE_DATE,A.CURRENCY_ID FROM EXCHANGE_MASTER A, CURRENCY_MASTER B WHERE A.CURRENCY_ID\=B.CURRENCY_ID AND A.COUNTRY_ID\=B.COUNTRY_ID AND A.COUNTRY_ID\=? AND A.AMEND_ID+ ' ' +A.EXCHANGE_ID+ ' ' +A.CURRENCY_ID IN(SELECT MAX(AMEND_ID)+ ' ' +EXCHANGE_ID+ ' ' +CURRENCY_ID FROM EXCHANGE_MASTER WHERE ISNULL(convert(date,?,103),SYSDATETIME())+ 10 / 24 BETWEEN EFFECTIVE_DATE AND EXPIRY_DATE AND STATUS\='Y' AND COUNTRY_ID\=? GROUP BY EXCHANGE_ID,CURRENCY_ID) AND ISNULL(convert(date,?,103),SYSDATETIME())+ 10 / 24 BETWEEN A.EFFECTIVE_DATE AND A.EXPIRY_DATE AND A.STATUS\='Y' AND B.STATUS\='Y' AND B.STATUS\='Y' AND A.STATUS\='Y' AND  B.AMEND_ID+ ' ' +B.CURRENCY_ID IN(SELECT MAX(AMEND_ID)+ ' ' +CURRENCY_ID FROM CURRENCY_MASTER WHERE EFFECTIVE_DATE <\=SYSDATETIME()+10/24 AND STATUS\='Y' AND COUNTRY_ID\=? GROUP BY CURRENCY_ID) ORDER BY A.DISPLAY_ORDER
branch.wise.country=SELECT ORIGINATION_COUNTRY_ID FROM BRANCH_MASTER WHERE BRANCH_CODE=?
UPD_MD_DEPOSIT=update POSITION_MASTER set DEPOSIT_REFERRAL=?,DEPOSIT_REFERRAL_REMARKS=? where application_no=?
check.deposit.status=select DEPOSIT_REFERRAL from POSITION_MASTER where application_no=?
get.tax.info=SELECT DETAIL_NAME,PERCENT FROM CONSTANT_DETAIL WHERE CATEGORY_ID\='149' AND BRANCH_CODE\=?
update_pm_deposit=update POSITION_MASTER set DEPOSIT_REFERRAL\=? where application_no\=?
GET_PORTFOLIO_BY_DATE1=select ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar(10), ENTRY_DATE, 103)) SNO,PRODUCT_ID,A.ENTRY_DATE,COU from(select SUBSTRING (CONVERT (VARCHAR, A.ENTRY_DATE, 103), 1, 10) ENTRY_DATE ,A.PRODUCT_ID,count(a.entry_date) COU from position_master a,marine_data b,personal_info c where  a.entry_date between CONVERT(DATE,?,103) and dateadd(day,1,CONVERT (DATE,?,103)) and a.remarks in ('Normal') and (b.ADMIN_REFERRAL_STATUS in('N') or b.ADMIN_REFERRAL_STATUS is null) and a.customer_id\=c.customer_id and a.application_no\=b.application_no  and lower(a.status) in (?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)
GET_PORTFOLIO_BY_DATE_APPEND1=) group by SUBSTRING(CONVERT(VARCHAR,A.ENTRY_DATE,103),1,10),A.PRODUCT_ID) A order by SUBSTRING(CONVERT(VARCHAR,A.ENTRY_DATE,103),1,10) desc
GET_PORTFOLIO_BY_DATE2=select ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar(10), ENTRY_DATE, 103)) SNO,A.ENTRY_DATE,PRODUCT_ID,COU from(select SUBSTRING (CONVERT (VARCHAR, A.INCEPTION_DATE, 103), 1, 10) ENTRY_DATE,A.PRODUCT_ID,count(a.inception_date) COU from position_master a,marine_data b,personal_info c where  a.inception_date between CONVERT(DATE,?,103) and dateadd(day,1,CONVERT (DATE,?,103))  and   a.customer_id=c.customer_id  and c.AMEND_ID=(select max(AMEND_ID) from personal_info per where  per.CUSTOMER_ID=c.CUSTOMER_ID) and a.application_no=b.application_no  and   lower(a.status) in(?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)
GET_PORTFOLIO_BY_DATE_APPEND2=)  group by   SUBSTRING (CONVERT (VARCHAR, A.INCEPTION_DATE, 103), 1, 10),A.PRODUCT_ID) A order by  convert(varchar(10),a.entry_date,103) desc
GET_HOMEPORTFOLIO_BY_DATE1=select ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar(10), ENTRY_DATE, 103)) SNO,A.ENTRY_DATE,COU from(select SUBSTRING (CONVERT (VARCHAR, A.ENTRY_DATE, 103), 1, 10) ENTRY_DATE, count(a.entry_date) COU from home_position_master a where (a.entry_date) between CONVERT(DATE,?,103) and CONVERT(DATE,?,103)+1 and lower(a.status) in(?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)
GET_HOMEPORTFOLIO_BY_DATE2=select ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar(10), ENTRY_DATE, 103)) SNO,A.ENTRY_DATE,COU from(select SUBSTRING (CONVERT (VARCHAR, A.INCEPTION_DATE, 103), 1, 10) ENTRY_DATE, count(a.inception_date) COU from home_position_master a where (a.inception_date) between CONVERT(DATE,?,103) and CONVERT(DATE,?,103)+1 and lower(a.status) in(?) and a.login_id in(select login_id from login_master where oa_code in(select agency_code from broker_company_master where branch_code in(?)
GET_PORTFOLIO_BY_LAND=select ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar(10), ENTRY_DATE, 103))SNO,A.ENTRY_DATE,PRODUCT_ID,COU  from( select SUBSTRING (CONVERT (VARCHAR, A.entry_date, 103), 1, 10) ENTRY_DATE,A.PRODUCT_ID,count(a.entry_date) COU from marine_vehicle_transaction_details a where  CONVERT(DATE,a.entry_date,103) between CONVERT(DATE,?,103) and dateadd(day,1,CONVERT (DATE,?,103)) and   lower(a.status) in(?) and a.broker_id in( select login_id from login_master where oa_code in( select agency_code from broker_company_master  where branch_code in(?)) AND a.product_id IN (13) ) group by   SUBSTRING (CONVERT (VARCHAR, A.entry_date, 103), 1, 10),A.PRODUCT_ID) A  order by  convert(varchar(10),a.entry_date,103) desc
GET_PORFOLIO_LAND_REPORT= SELECT row_number() over(order by pm.tran_id) SNO,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.broker_id)))   broker_organization, pm.LOGIN_ID,POLICY_NO,pi.first_name,pm.premium,pm.CREDIT_NOTE_NO,DEBIT_NOTE_NO, pi.COMPANY_NAME, pi.LAST_NAME from marine_vehicle_transaction_details pm,personal_info pi where  CONVERT(DATE,pm.entry_date,103) = CONVERT(DATE,?,103) and   lower(pm.status) in(?) AND pi.customer_id = pm.customer_id and pm.broker_id in(select login_id from login_master where oa_code in( select agency_code from broker_company_master  where branch_code in(?) ))
### FOR MOTORS & OTHERS
GET_MOTORPORTFOLIO_BY_DATE1=SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), a.entry_date, 103) desc) as rownum,CONVERT (varchar (10), a.entry_date, 103) ENTRY_DATE,COUNT (a.entry_date) COU FROM home_position_master a WHERE convert(date,a.entry_date,103) BETWEEN CONVERT (DATE, ?, 103) AND  dateadd(day,1,CONVERT (DATE, ?, 103)) AND LOWER (a.status) IN (?) AND a.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?)) 
GET_MOTORPORTFOLIO_BY_DATE_APPEND1=GROUP BY CONVERT (varchar (10), a.entry_date, 103)  ORDER BY  CONVERT (varchar (10), A.ENTRY_DATE, 103) DESC 
GET_MOTORPORTFOLIO_BY_DATE2=SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), a.entry_date, 103) desc) as rownum,CONVERT (varchar (10), a.entry_date, 103) ENTRY_DATE,COUNT (a.entry_date) COU FROM home_position_master a WHERE convert(date,a.entry_date,103) BETWEEN CONVERT (DATE, ?, 103) AND  dateadd(day,1,CONVERT (DATE, ?, 103)) AND LOWER (a.status) IN (''{0}'',?) AND a.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?))
GET_MOTORPORTFOLIO_BY_DATE_APPEND2=GROUP BY CONVERT (varchar (10), a.entry_date, 103)  ORDER BY  CONVERT (varchar (10), a.entry_date, 103) DESC
GET_HOMEPORTFOLIO_PLIST = SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), pm.application_no, 126) desc) SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,OVERALL_PREMIUM premium,nullif (pm.EXCESS_PREMIUM, ''0'') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,convert (varchar(10),pm.entry_date, 103),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name FROM home_position_master pm, personal_info pi WHERE convert (date,pm.ENTRY_DATE, 103) = CONVERT (DATE, ?, 103) AND pi.customer_id = pm.customer_id  AND (case ? when ''ALL'' THEN ''A'' else  pm.product_id end)=(case convert(varchar,?) when ''ALL'' then ''A'' else convert(varchar,?) end) AND LOWER (pm.status) IN (''{0}'',?) and pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN  (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?)))
GET_HOMEPORTFOLIO_QLIST = SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), pm.application_no, 126) desc) SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,OVERALL_PREMIUM premium,nullif (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,convert (varchar(10),pm.entry_date, 103),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name FROM home_position_master pm, personal_info pi WHERE convert (date,pm.entry_date, 103) = CONVERT (DATE, ?, 103)  AND pi.customer_id = pm.customer_id  AND (case ? when 'ALL' THEN 'A' else  pm.product_id end) =(case convert(varchar,?) when 'ALL' then 'A' else convert(varchar,?) end) AND LOWER (pm.status) IN (?) and pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN  (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?)))


### FOR Travels
##GET_ADMIN_PORTFOLIO_CANCEL_POLICIES = select convert(varchar,a.EFFECTIVE_DATE,103) ENTRY_DATE,count(a.EFFECTIVE_DATE)COU from home_position_master a, personal_info c where a.EFFECTIVE_DATE between convert(date,?,103) and DATEADD(day, +1, convert(date,?,103)) and a.customer_id = c.customer_id and a.product_id in(?) and (lower(a.status) in('i','c','d')) and  (a.policy_no is not null ) AND a.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?)))   group by convert(varchar,a.EFFECTIVE_DATE,103) order by convert(varchar,a.EFFECTIVE_DATE,103) desc
##GET_ADMIN_PORTFOLIO_POLICIES = select convert(varchar,a.EFFECTIVE_DATE,103) ENTRY_DATE,count(a.EFFECTIVE_DATE)COU from home_position_master a, personal_info c where a.EFFECTIVE_DATE between convert(date,?,103) and DATEADD(day, +1, convert(date,?,103)) and a.customer_id = c.customer_id and a.product_id in(?) AND lower(a.status) IN (lower('p')) and (a.policy_no is not null ) AND a.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?)))   group by convert(varchar,a.EFFECTIVE_DATE,103) order by convert(varchar,a.EFFECTIVE_DATE,103) desc
##GET_ADMIN_PORTFOLIO_QUOTES = select convert(varchar,a.ENTRY_DATE,103) ENTRY_DATE,count(a.ENTRY_DATE)COU from home_position_master a, personal_info c where  a.ENTRY_DATE between convert(date,?,103) and DATEADD(day, +1, convert(date,?,103)) and  a.customer_id = c.customer_id  and a.product_id in(?) and lower(a.status) in('y') AND a.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?))) and premium is not null   group by convert(varchar,a.ENTRY_DATE,103) order by convert(varchar,a.ENTRY_DATE,103) desc
##GET_TRAVELPORTFOLIO_PLIST = SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), pm.application_no, 103) desc) SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,OVERALL_PREMIUM premium,nullif (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,convert (varchar(10),pm.entry_date, 105),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name FROM home_position_master pm, personal_info pi WHERE convert (date,PM.EFFECTIVE_DATE, 103) = convert(date,?,103) AND pi.customer_id = pm.customer_id  AND (case ? when 'ALL' THEN 'A' else  pm.product_id end)=(case convert(varchar,?) when 'ALL' then 'A' else convert(varchar,?) end) AND LOWER (pm.status) IN (?) and pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN  (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?)))
##GET_TRAVELPORTFOLIO_QLIST = SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), pm.application_no, 103) desc) SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,OVERALL_PREMIUM premium,nullif (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,convert (varchar(10),pm.entry_date, 105),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name FROM home_position_master pm, personal_info pi WHERE convert (date,PM.ENTRY_DATE, 103) = convert(date,?,103) AND pi.customer_id = pm.customer_id  AND (case ? when 'ALL' THEN 'A' else  pm.product_id end) =(case convert(varchar,?) when 'ALL' then 'A' else convert(varchar,?) end) AND LOWER (pm.status) IN (?) and pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN  (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?))) and premium is not null

GET_TRAVELPORTFOLIO_PLIST = SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), pm.application_no, 103) desc) SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,OVERALL_PREMIUM premium,nullif (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,convert (varchar(10),pm.entry_date, 105),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name FROM home_position_master pm, personal_info pi WHERE convert (date,PM.ENTRY_DATE, 103) = convert(date,?,103) AND pi.customer_id = pm.customer_id  AND (case ? when 'ALL' THEN 'A' else  pm.product_id end)=(case convert(varchar,?) when 'ALL' then 'A' else convert(varchar,?) end) AND LOWER (pm.status) IN (?) and pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN  (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?)))
GET_TRAVELPORTFOLIO_QLIST = SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), pm.application_no, 103) desc) SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,OVERALL_PREMIUM premium,nullif (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,convert (varchar(10),pm.entry_date, 105),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name FROM home_position_master pm, personal_info pi WHERE convert (date,PM.ENTRY_DATE, 103) = convert(date,?,103) AND pi.customer_id = pm.customer_id  AND (case ? when 'ALL' THEN 'A' else  pm.product_id end) =(case convert(varchar,?) when 'ALL' then 'A' else convert(varchar,?) end) AND LOWER (pm.status) IN (?) and pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN  (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?))) and premium is not null
GET_ADMIN_PORTFOLIO_CANCEL_POLICIES = select convert(varchar,a.ENTRY_DATE,103) ENTRY_DATE,count(a.ENTRY_DATE)COU from home_position_master a, personal_info c where a.ENTRY_DATE between convert(date,?,103) and DATEADD(day, +1, convert(date,?,103)) and a.customer_id = c.customer_id and a.product_id in(?) and (lower(a.status) in('i','c','d')) and  (a.policy_no is not null ) AND a.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?)))   group by convert(varchar,a.ENTRY_DATE,103) order by convert(varchar,a.ENTRY_DATE,103) desc
GET_ADMIN_PORTFOLIO_POLICIES = select convert(varchar,a.ENTRY_DATE,103) ENTRY_DATE,count(a.ENTRY_DATE)COU from home_position_master a, personal_info c where a.ENTRY_DATE between convert(date,?,103) and DATEADD(day, +1, convert(date,?,103)) and a.customer_id \= c.customer_id and a.product_id in(?) AND lower(a.status) IN (lower('p')) and (a.policy_no is not null ) AND a.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?)))   group by convert(varchar,a.ENTRY_DATE,103) order by convert(varchar,a.ENTRY_DATE,103) desc
GET_ADMIN_PORTFOLIO_QUOTES = select convert(varchar,a.ENTRY_DATE,103) ENTRY_DATE,count(a.ENTRY_DATE)COU from home_position_master a, personal_info c where  a.ENTRY_DATE between convert(date,?,103) and DATEADD(day, +1, convert(date,?,103)) and  a.customer_id = c.customer_id  and a.product_id in(?) and lower(a.status) in('y') AND a.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN (?))) and premium is not null   group by convert(varchar,a.ENTRY_DATE,103) order by convert(varchar,a.ENTRY_DATE,103) desc


#Date
CHECK_DATE_CONVEYAN=SELECT  COUNT (EFFECTIVE_DATE)FROM CONVEYAN_MASTER WHERE BRANCH_CODE\=? AND CONVDESC \= ? AND AMEND_ID \= (SELECT MAX (AMEND_ID)FROM CONVEYAN_MASTER WHERE CONVDESC \= ? AND BRANCH_CODE\=?)AND EFFECTIVE_DATE <\= convert(date,?,103) AND convert(date,?,103)>\=SELECT convert(date,(convert(varchar(10),SYSDATETIME(),103)), 103) 
CHECK_DATE_COUNTRY=SELECT COUNT (EFFECTIVE_DATE)FROM COUNTRY_MASTER WHERE COUNTRY_ID \= ? and amend_id \= (SELECT MAX (amend_id) FROM COUNTRY_MASTER WHERE COUNTRY_ID \= ?) AND EFFECTIVE_DATE <\= convert(date,?,103) AND  convert(date,?,103>\=SELECT convert(date,(convert(varchar(10),SYSDATETIME(),103)), 103)
CHECK_DATE_COUNTRY_DETAIL=SELECT COUNT (EFFECTIVE_DATE)FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID \= ? and amend_id \= (SELECT MAX (amend_id) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID \= ?) AND EFFECTIVE_DATE <\= TO_DATE (?, 'MM/DD/YYYY') AND TO_DATE (?, 'MM/DD/YYYY')>\=SELECT convert(date,(convert(varchar(10),SYSDATETIME(),103)), 103)
CHECK_DATE_BANK=SELECT COUNT (EFFECTIVE_DATE) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME \= ? and   amend_id \= (SELECT MAX (amend_id) FROM OPEN_COVER_BANK_MASTER WHERE BANK_NAME \= ?) AND EFFECTIVE_DATE <\= convert(date,?,103) AND convert(date,?,103)>\=SELECT convert(date,(convert(varchar(10),SYSDATETIME(),103)), 103)
CHECK_DATE_MATERIAL=SELECT COUNT(EFFECTIVE_DATE) FROM MATERIAL_TYPE_MASTER WHERE MATERIAL_DESC \= ? and BRANCH_CODE\=? and amend_id \= (SELECT   MAX (amend_id) FROM MATERIAL_TYPE_MASTER WHERE BRANCH_CODE\=? and MATERIAL_DESC \= ?) AND EFFECTIVE_DATE <\=  convert(date,?,103 AND convert(date,?,103)>\=SELECT convert(date,(convert(varchar(10),SYSDATETIME(),103)), 103)
CHECK_DATE_WAR=SELECT COUNT(EFFECTIVE_DATE) FROM WAR_RATE_MASTER WHERE WAR_DESC \= ? and MODE_TRANSPORT_ID\=? and BRANCH_CODE\=? and amend_id \= (SELECT MAX (amend_id) FROM WAR_RATE_MASTER WHERE WAR_DESC \= ? and MODE_TRANSPORT_ID\=? and BRANCH_CODE\=?) AND EFFECTIVE_DATE <\= convert(date,?,103) AND TO_DATE (?, 'MM/DD/YYYY')>\=SELECT convert(date,(convert(varchar(10),SYSDATETIME(),103)), 103)
CHECK_DATE_COMMODITY_EXCESS=SELECT COUNT(EFFECTIVE_DATE)  FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED \= ? and END_SUM_INSURED\=? and BRANCH_CODE\=? and amend_id \= (SELECT MAX(amend_id) FROM COMMODITY_EXCESS_PREMIUM WHERE START_SUM_INSURED \= ? and END_SUM_INSURED\=? and BRANCH_CODE\=?)  AND EFFECTIVE_DATE <\= convert(date,?,103) AND convert(date,?,103)>\=SELECT convert(date,(convert(varchar(10),SYSDATETIME(),103)), 103)
CHECK_DATE_EXCHANGE=SELECT COUNT (EFFECTIVE_DATE) FROM EXCHANGE_MASTER WHERE CURRENCY_ID\=?  and amend_id \= (SELECT   MAX (amend_id) FROM  EXCHANGE_MASTER WHERE CURRENCY_ID\=? ) AND EFFECTIVE_DATE <\= convert(date,?,103) AND  convert(date,?,103)>\=SELECT convert(date,(convert(varchar(10),SYSDATETIME(),103)), 103)
CHECK_DATE_COVER=SELECT COUNT(EFFECTIVE_DATE) FROM COVER_MASTER WHERE COVER_ID\=? and BRANCH_CODE\=?  and   amend_id \= (SELECT MAX (amend_id) FROM COVER_MASTER WHERE COVER_ID\=? and BRANCH_CODE\=?)  AND EFFECTIVE_DATE <\=  convert(date,?,103) AND  convert(date,?,103) >\= convert(date,sysdatetime(), 103)
#Rating Engine

UPDATE_CONVEYAN_MASTER_UPDATE=UPDATE CONVEYAN_MASTER  SET CONVEYAN_MASTER.CONVDESC=?,CONVEYAN_MASTER.CONV_RATE=?,CONVEYAN_MASTER.EFFECTIVE_DATE=convert(date,?,103),CONVEYAN_MASTER.STATUS=?,CONVEYAN_MASTER.REMARKS=? CONVEYAN_MASTER.CORE_APP_ID=? WHERE CONVEYAN_MASTER.BRANCH_CODE=? AND CONVEYAN_MASTER.CONV_MEAN=? AND CONVEYAN_MASTER.MODE_TRANSPORT_ID=? ,CONVEYAN_MASTER.AMEND_ID=(SELECT MAX(AMEND_ID) FROM CONVEYAN_MASTER cm WHERE cm.CONV_MEAN=CONVEYAN_MASTER.CONV_MEAN)
#####(10-06-2016)#####UPDATE_COUNTRY_MASTER_UPDATE=UPDATE COUNTRY_MASTER E SET E.COUNTRY_NAME\=?,E.GEO_RATE\=?,E.EFFECTIVE_DATE\= convert(date,?,103),E.STATUS\=?,COUNTRY_SHORT_NAME\=? WHERE E.COUNTRY_ID\=? AND E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_ID\=E.COUNTRY_ID) 
UPDATE_COUNTRY_MASTER_UPDATE = UPDATE COUNTRY_MASTER  SET COUNTRY_MASTER.COUNTRY_NAME\=?,COUNTRY_MASTER.GEO_RATE\=?,COUNTRY_MASTER.EFFECTIVE_DATE\= CONVERT(DATE,?,103),COUNTRY_MASTER.STATUS\=?,COUNTRY_SHORT_NAME\=?,NATIONALITY_NAME\=?,RSACODE\=?,REMARKS\=? WHERE COUNTRY_MASTER.COUNTRY_ID\=? AND COUNTRY_MASTER.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER c WHERE COUNTRY_MASTER.COUNTRY_ID\=c.COUNTRY_ID)

#####(10-06-2016)#####UPDATE_COUNTRYDET_UPDATE=UPDATE COUNTRY_MASTER_DETAIL E SET E.COUNTRY_NAME=?,E.COUNTRY_SHORT_NAME=?,E.EFFECTIVE_DATE=convert(date,?,103),E.STATUS=?,E.WAR_RATE=?,E.ENDING_PLACE=?,E.EP_WARRANTIES_CONDITIONS=?,E.NATIONALITY_NAME=?,E.REMARKS=?,E.SP_WARRANTIES_CONDITIONS=?,E.STARTING_PLACE=? WHERE E.COUNTRY_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID=E.COUNTRY_ID)
UPDATE_COUNTRYDET_UPDATE = UPDATE COUNTRY_MASTER_DETAIL  SET COUNTRY_NAME=?,COUNTRY_SHORT_NAME=?,EFFECTIVE_DATE=convert(date,?,103),STATUS=?,WAR_RATE=?,ENDING_PLACE=?,EP_WARRANTIES_CONDITIONS=?,NATIONALITY_NAME=?,REMARKS=?,SP_WARRANTIES_CONDITIONS=?,STARTING_PLACE=? ,RSACODE=? WHERE COUNTRY_ID=? AND BELONGING_COUNTRY_ID=(select BELONGING_BRANCH from branch_master bm where bm.branch_code=? and bm.amend_id = (select max(amend_id) from branch_master bom where bm.branch_code = bom.branch_code)) AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID=COUNTRY_MASTER_DETAIL.COUNTRY_ID AND BELONGING_COUNTRY_ID=COUNTRY_MASTER_DETAIL.BELONGING_COUNTRY_ID)
UPDATE_BANK_MASTER_UPDATE=UPDATE OPEN_COVER_BANK_MASTER   SET OPEN_COVER_BANK_MASTER.BANK_NAME=?, OPEN_COVER_BANK_MASTER.EFFECTIVE_DATE=convert(date,?,103), OPEN_COVER_BANK_MASTER.STATUS=?,OPEN_COVER_BANK_MASTER.RSACODE=? ,  OPEN_COVER_BANK_MASTER.REMARKS=?  WHERE OPEN_COVER_BANK_MASTER.bank_id=? and OPEN_COVER_BANK_MASTER.AMEND_ID=(SELECT MAX(AMEND_ID)  FROM OPEN_COVER_BANK_MASTER ocbm WHERE OPEN_COVER_BANK_MASTER.bank_id=ocbm.bank_id)
#####(13-06-2016)#####UPDATE_WAR_RATE_MASTER_INSERT=INSERT INTO WAR_RATE_MASTER VALUES((SELECT MAX(SNO)+1 FROM WAR_RATE_MASTER),?,?,?,?,convert(date,?,103),(SELECT MAX(AMEND_ID)+1 FROM WAR_RATE_MASTER WHERE BRANCH_CODE=? AND WAR_ID=?),?,?,?,?)
UPDATE_WAR_RATE_MASTER_INSERT = INSERT INTO WAR_RATE_MASTER (SNO, WAR_ID, WAR_DESC, WAR_RATE, MODE_TRANSPORT_ID, EFFECTIVE_DATE, AMEND_ID, BRANCH_CODE, CORE_APP_ID, STATUS,REMARKS)VALUES((SELECT MAX(SNO)+1 FROM WAR_RATE_MASTER),?,?,?,?,CONVERT(DATE,?,103),(SELECT MAX(AMEND_ID)+1 FROM WAR_RATE_MASTER WHERE BRANCH_CODE=? AND WAR_ID=? AND MODE_TRANSPORT_ID=?),?,?,?,?)
UPDATE_COMEX_INSERT=INSERT INTO COMMODITY_EXCESS_PREMIUM VALUES((SELECT MAX(SNO)+1 FROM COMMODITY_EXCESS_PREMIUM),?,?,?,?,(SELECT MAX(AMEND_ID)+1 FROM COMMODITY_EXCESS_PREMIUM WHERE BRANCH_CODE=? AND START_SUM_INSURED=? AND END_SUM_INSURED=? ),convert(date,?,103),?,?,?)
UPDATE_EXCHANGE_MASTER_UPDATE=UPDATE EXCHANGE_MASTER  SET EXCHANGE_MASTER.EXCHANGE_RATE=?,EXCHANGE_MASTER.EFFECTIVE_DATE=convert(date,?,103),EXCHANGE_MASTER.STATUS=?,EXCHANGE_MASTER.REMARKS=?,EXCHANGE_MASTER.RSACODE=? WHERE EXCHANGE_MASTER.EXCHANGE_ID=? AND EXCHANGE_MASTER.AMEND_ID=(SELECT MAX(AMEND_ID) FROM EXCHANGE_MASTER EM WHERE EM.EXCHANGE_ID=EXCHANGE_MASTER.EXCHANGE_ID)
UPDATE_COVER_MASTER_UPDATE=UPDATE COVER_MASTER E SET E.DESCRIPTION=?,E.EFFECTIVE_DATE=convert(date,?,103),E.STATUS=?,E.REMARKS=?,E.COVER_RATE=? WHERE E.EXCHANGE_ID=? AND E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COVER_MASTER WHERE COVER_ID=E.COVER_ID)
UPDATE_CURRENCY_MASTER_UPDATE=UPDATE CURRENCY_MASTER C SET CURRENCY_MASTER.CURRENCY_NAME\=?,CURRENCY_MASTER.EFFECTIVE_DATE\=convert(date,?,103),CURRENCY_MASTER.REMARKS\=?,CURRENCY_MASTER.RFACTOR\=?,CURRENCY_MASTER.RSACODE\=?,CURRENCY_MASTER.SHORT_NAME\=?,CURRENCY_MASTER.STATUS\=?,CURRENCY_MASTER.SUB_CURRENCY\=? WHERE CURRENCY_MASTER.CURRENCY_ID\=? AND CURRENCY_MASTER.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM CURRENCY_MASTER WHERE CURRENCY_ID\=CURRENCY_MASTER.CURRENCY_ID and country_id \= (select country_id from branch_master where branch_code\=?))

##
GET_COUNTRY_NAME_DET=select E.COUNTRY_NAME from COUNTRY_MASTER E WHERE  E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE COUNTRY_NAME\=E.COUNTRY_NAME)order by E.COUNTRY_NAME
GET_COUNTRY_NAME=select E.COUNTRY_NAME,E.COUNTRY_ID from COUNTRY_MASTER_DETAIL E WHERE  E.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER_DETAIL WHERE COUNTRY_ID\=E.COUNTRY_ID)order by E.COUNTRY_NAME
GET_COUNTRY_NEW_NAME=select distinct(e.country_name),e.country_id from country_master E where not exists (select country_name from country_master_detail cm where e.country_id=cm.country_id) and E.AMEND_ID=(SELECT MAX(AMEND_ID) FROM COUNTRY_MASTER WHERE country_id=E.country_id) order by country_name
CHECK_COM_EX_COUNT_START=select count(*) from commodity_excess_premium where branch_code=? and START_SUM_INSURED between ? and (select MAX(START_SUM_INSURED) from commodity_excess_premium)

CHECK_COM_EX_COUNT_END=select count(*) from commodity_excess_premium where branch_code\=? and END_SUM_INSURED between ? and (select MAX(END_SUM_INSURED) from commodity_excess_premium)
CHECK_COVER_NAME=select count(C.COVER_NAME) from COVER_MASTER C, MODE_OF_TRANSPORT M where C.branch_code\=? and c.mode_transport_id\=? and C.AMEND_ID\=(select MAX(AMEND_ID) from COVER_MASTER where COVER_ID\=C.COVER_ID) and M.MODE_TRANSPORT_ID\=C.MODE_TRANSPORT_ID  AND C.MODE_TRANSPORT_ID \= M.MODE_TRANSPORT_ID AND M.BRANCH_CODE\=C.BRANCH_CODE AND  C.BRANCH_CODE\=? and cover_name\=(select cover_name from cover_master where cover_id\=? and branch_code\=?)
GET_COVER=select C.COVER_NAME,C.COVER_ID from COVER_MASTER C where C.branch_code=? and c.MODE_TRANSPORT_ID=? and C.AMEND_ID=(select MAX(AMEND_ID) from COVER_MASTER where COVER_ID=C.COVER_ID)  AND  C.BRANCH_CODE=?

report.chart.portfolio= SELECT  COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b WHERE {0}  A.effective_Date >= SYSDATETIME() and a.status= ''P'' AND b.customer_id= a.customer_id AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND a.product_id=? and a.APPLICATION_ID=ISNULL(?,''1'') AND ISNULL(OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'') AND B.STATUS = ''Y'' AND ORIGINAL_POLICY_NO IS NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
report.chart.portfolio.amount= SELECT sum( ISNULL(a.PREMIUM,0)+ISNULL(a.EXCESS_PREMIUM,0)) PREMIUM FROM POSITION_MASTER a, personal_info b  WHERE {0}  A.effective_Date >= SYSDATETIME() and a.status= ''P'' AND b.customer_id= a.customer_id AND ISNULL (A.OPEN_COVER_INT_STATUS, 0) NOT IN (''LINKED'') AND a.product_id=? and a.APPLICATION_ID=ISNULL(?,''1'') AND ISNULL(OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'') AND B.STATUS = ''Y'' AND ORIGINAL_POLICY_NO IS NULL AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
report.chart.quoteregister.lapsed.amount=SELECT sum( ISNULL(a.PREMIUM,0)+ISNULL(a.EXCESS_PREMIUM,0)) PREMIUM  FROM POSITION_MASTER a, personal_info PI WHERE {0} A.effective_Date < SYSDATETIME() and A.effective_Date+30 >=SYSDATETIME() AND PI.customer_id = a.customer_id AND a.product_id =? AND a.status=''Y'' and a.APPLICATION_ID=ISNULL(?,''1'') AND ISNULL(OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'')   AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
report.chart.existing.amount=SELECT sum( ISNULL(a.PREMIUM,0)+ISNULL(a.EXCESS_PREMIUM,0)) PREMIUM FROM POSITION_MASTER a,MARINE_DATA m, personal_info b  WHERE {0}  A.effective_Date + 30 >\= SYSDATETIME()  AND a.status \= ''Y''  AND (A.REMARKS NOT IN (''Admin'', ''Referal'', ''NORMAL_EXCESS_PRICE''))  AND b.customer_id \= a.customer_id  AND a.product_id \=? AND a.APPLICATION_ID \= ISNULL(?,''1'') AND ISNULL(a.OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'')  AND  M.APPLICATION_NO  \= A.APPLICATION_NO AND  ISNULL (M.ADMIN_REFERRAL_STATUS, ''N'') NOT IN (''Y'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)
report.referral.chart.unapproved.amount=SELECT sum( ISNULL(a.PREMIUM,0)+ISNULL(a.EXCESS_PREMIUM,0)) PREMIUM FROM POSITION_MASTER a, personal_info b, MARINE_DATA MD WHERE {0} A.effective_Date  >\= SYSDATETIME() AND (A.FREIGHT_STATUS NOT IN (''F'', ''B'') OR A.FREIGHT_STATUS IS NULL) AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND ( (A.REMARKS IN (''Referal'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'') OR (A.REMARKS IN (''Admin'', ''Normal'', ''Referal'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  \= ''Y'')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND a.product_id \=? AND a.APPLICATION_ID \= ISNULL(?,''1'') AND ISNULL(a.OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)  
report.referral.chart.approved.amount=SELECT sum( ISNULL(a.PREMIUM,0)+ISNULL(a.EXCESS_PREMIUM,0)) PREMIUM FROM POSITION_MASTER a, personal_info b , MARINE_DATA MD  WHERE {0} A.effective_Date >\= SYSDATETIME() AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND ( (A.REMARKS IN (''Admin'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'') OR (A.REMARKS IN (''Admin'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND a.product_id \=?  and a.APPLICATION_ID\=ISNULL(?,''1'') AND ISNULL(A.OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID) 
report.referral.chart.reject.amount=SELECT sum( ISNULL(a.PREMIUM,0)+ISNULL(a.EXCESS_PREMIUM,0)) PREMIUM FROM POSITION_MASTER a, personal_info b, MARINE_DATA MD  WHERE {0} A.effective_date + 30 >= SYSDATETIME() AND (A.FREIGHT_STATUS NOT IN (''F'', ''B'') OR A.FREIGHT_STATUS IS NULL) AND a.status = ''R'' AND b.customer_id = a.customer_id  AND MD.APPLICATION_NO  = A.APPLICATION_NO  AND a.product_id =?  and a.APPLICATION_ID=? AND ISNULL(A.OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'')  AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
report.quoteregister.chart.lapsed=SELECT COUNT(a.quote_no)  FROM POSITION_MASTER a, personal_info PI WHERE {0} A.effective_Date < SYSDATETIME() and A.effective_Date+30 >=SYSDATETIME() AND PI.customer_id = a.customer_id AND a.product_id =? AND a.status=''Y'' and a.APPLICATION_ID=ISNULL(?,''1'') AND ISNULL(OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'')    AND PI.STATUS = ''Y'' AND PI.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=PI.CUSTOMER_ID)
report.quoteregister.chart.existing=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a,MARINE_DATA m, personal_info b  WHERE {0}  A.effective_Date + 30 >\= SYSDATETIME()  AND a.status \= ''Y''  AND (A.REMARKS NOT IN (''Admin'', ''Referal'', ''NORMAL_EXCESS_PRICE''))  AND b.customer_id \= a.customer_id  AND a.product_id \= ? AND a.APPLICATION_ID \= ISNULL(?,''1'') AND ISNULL(a.OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'')  AND M.APPLICATION_NO  \= A.APPLICATION_NO AND ISNULL (M.ADMIN_REFERRAL_STATUS, ''N'') NOT IN (''Y'') AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)
report.referral.chart.unapproved=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b , MARINE_DATA MD WHERE {0} A.effective_Date  >\= SYSDATETIME() AND (A.FREIGHT_STATUS NOT IN (''F'', ''B'') OR A.FREIGHT_STATUS IS NULL) AND a.status \= ''Y'' AND b.customer_id \= a.customer_id  AND ( (A.REMARKS IN (''Referal'') AND MD.ADMIN_REFERRAL_STATUS  \= ''N'') OR (A.REMARKS IN (''Admin'', ''Normal'', ''Referal'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  \= ''Y'')) AND MD.APPLICATION_NO  \= A.APPLICATION_NO AND a.product_id \=? AND a.APPLICATION_ID \= ISNULL(?,''1'') AND ISNULL(a.OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'')  AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)
report.referral.chart.approved=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b, MARINE_DATA MD  WHERE {0} A.effective_Date >= SYSDATETIME() AND a.status = ''Y'' AND b.customer_id = a.customer_id  AND ( (A.REMARKS IN (''Admin'') AND MD.ADMIN_REFERRAL_STATUS  = ''N'') OR (A.REMARKS IN (''Admin'', ''NORMAL_EXCESS_PRICE'') AND MD.ADMIN_REFERRAL_STATUS  = ''N'')) AND MD.APPLICATION_NO  = A.APPLICATION_NO AND a.product_id =?  and a.APPLICATION_ID=ISNULL(?,''1'') AND ISNULL(A.OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'')  AND B.STATUS = ''Y'' AND B.AMEND_ID=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID=B.CUSTOMER_ID)
report.referral.chart.reject=SELECT COUNT( a.quote_no) FROM POSITION_MASTER a, personal_info b  WHERE {0} A.effective_date + 30 >\= SYSDATETIME() AND a.status \= ''R'' AND b.customer_id \= a.customer_id  AND a.product_id \=?  and a.APPLICATION_ID\=? AND ISNULL(OPEN_COVER_NO,''0'') like ISNULL(? + ' ' +''%'',''0'')  AND A.QUOTE_NO IS NOT NULL AND B.STATUS \= ''Y'' AND B.AMEND_ID\=( SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID\=B.CUSTOMER_ID)

#DEPOSIT MASTER
GET_EXISTING_DEPOSIT_CBC_LIST= SELECT dcm.CBC_NO, dcm.BROKER_ID, dcm.CUSTOMER_OPTION, dcm.CUSTOMER_ID, dcm.DEPOSIT_TYPE, dcm.PRODUCT_ID, dcm.OPENCOVER_NO, (SELECT DISTINCT (COMPANY_NAME) FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE = dcm.BROKER_ID) COMPANY_NAME, (SELECT CAST (wm_concat(PRODUCT_NAME) AS VARCHAR2(4000)) FROM product_master WHERE ((select CAST(wm_concat(to_char(PRODUCT_ID)) AS VARCHAR2(4000)) from product_master where branch_code=?) = (dcm.PRODUCT_ID) or (to_char(PRODUCT_ID)=dcm.PRODUCT_ID)) AND BRANCH_CODE IN (?) AND status = 'Y' AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM product_master WHERE BRANCH_CODE IN (?) AND status = 'Y')) productName  FROM DEPOSIT_CBC_MASTER dcm
GET_EXISTING_DEPOSIT_CHEQUE_LIST=SELECT dm.CBC_NO, dm.DEPOSIT_NO, dm.DEPOSIT_AMOUNT, ISNULL(dm.DEPOSIT_UTILISED,'0') DEPOSIT_UTILISED, dm.CHEQUE_NO, dm.CHEQUE_AMOUNT, dm.CHEQUE_BANK, convert(varchar(10),dm.CHEQUE_DATE,103)  CHEQUE_DATE, convert(varchar(10),dm.CHEQUE_DATE,103)  CHEQUE_DATE1, dm.RECEIPT_NO, dm.STATUS FROM DEPOSIT_MASTER dm where amend_id=(select max(amend_id) from DEPOSIT_MASTER where deposit_no=dm.deposit_no)
GET_DEPOSIT_CUSTOMER_LIST=SELECT CUSTOMER_ID, (FIRST_NAME + ' ' + LAST_NAME) cust_name, MOBILE FROM PERSONAL_INFO WHERE LOGIN_ID IN (SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE =?) AND APPLICATION_ID = '1' ORDER BY FIRST_NAME
#select CUSTOMER_ID, (FIRST_NAME + ' ' + LAST_NAME) cust_name, MOBILE from PERSONAL_INFO where OA_CODE=?
GET_DEPOSIT_BROKER_LIST=select AGENCY_CODE, COMPANY_NAME from BROKER_COMPANY_MASTER where BRANCH_CODE in (?)
GET_DEPOSIT_OC_LIST=select distinct(ocm.MISSIPPI_OPENCOVER_NO),ocm.CUSTOMER_ID, (select distinct(FIRST_NAME + ' ' + LAST_NAME) from PERSONAL_INFO where CUSTOMER_ID\=ocm.CUSTOMER_ID) cust_name from OPEN_COVER_MASTER ocm where 
GET_CHEQUE_TRANSACTION_DETAIL=select dd.DEPOSIT_NO, dd.PRODUCT_ID, (SELECT PRODUCT_NAME FROM product_master WHERE PRODUCT_ID=dd.PRODUCT_ID and BRANCH_CODE=? and amend_id=(select max(amend_id) from product_master WHERE PRODUCT_ID=dd.PRODUCT_ID and BRANCH_CODE=?)) PRODUCT_NAME, dd.QUOTE_NO, pm.POLICY_NO, pm.CUSTOMER_ID, (select FIRST_NAME+ ' ' +LAST_NAME from personal_info where CUSTOMER_ID=pm.CUSTOMER_ID) cust_name, dd.PREMIUM_AMOUNT,convert(varchar(10),dd.ENTRY_DATE,103)   ENTRY_DATE from DEPOSIT_DETAIL dd, position_master pm where deposit_no=? and pm.QUOTE_NO=dd.QUOTE_NO
UPD_CBC_DETAIL=UPDATE DEPOSIT_CBC_MASTER SET BROKER_ID=?, CUSTOMER_OPTION=?, CUSTOMER_ID=?, DEPOSIT_TYPE=?, PRODUCT_ID=?, OPENCOVER_NO=? WHERE CBC_NO=?
INS_CBC_DETAIL=INSERT INTO DEPOSIT_CBC_MASTER(CBC_NO, BROKER_ID, CUSTOMER_OPTION, CUSTOMER_ID, DEPOSIT_TYPE, PRODUCT_ID, OPENCOVER_NO, STATUS) VALUES (?,?,?,?,?,?,?,'Y')
UPD_CHEQUE_DETAIL=UPDATE DEPOSIT_MASTER SET DEPOSIT_AMOUNT=?, CHEQUE_NO=?, CHEQUE_AMOUNT=?, CHEQUE_BANK=?, CHEQUE_DATE=CONVERT(DATE,?,103), RECEIPT_NO=?, ENTRY_DATE=SYSDATETIME() WHERE DEPOSIT_NO=?
CHK_CBC_DETAIL_EXIST=select ISNULL(CBC_NO,'') CBC_NO from DEPOSIT_CBC_MASTER where BROKER_ID\=? and CUSTOMER_OPTION\=? and CUSTOMER_ID\=? and DEPOSIT_TYPE\=? and PRODUCT_ID\=? and ISNULL(OPENCOVER_NO,0) \= ISNULL(?,0)
INS_AMEND_CHEQUE_DETAIL=INSERT INTO DEPOSIT_MASTER(CBC_NO, DEPOSIT_NO, DEPOSIT_AMOUNT, CHEQUE_NO, CHEQUE_AMOUNT, CHEQUE_BANK, CHEQUE_DATE, RECEIPT_NO, DEPOSIT_UTILISED, AMEND_ID,ENTRY_DATE) VALUES (?,?,?,?,?,?,CONVERT(DATE,?,103),?,?,(select max(amend_id)+1 from DEPOSIT_MASTER where DEPOSIT_NO=?),SYSDATETIME())
INS_NEW_CHEQUE_DETAIL=INSERT INTO DEPOSIT_MASTER(CBC_NO, DEPOSIT_NO, DEPOSIT_AMOUNT, CHEQUE_NO, CHEQUE_AMOUNT, CHEQUE_BANK, CHEQUE_DATE, RECEIPT_NO, AMEND_ID,ENTRY_DATE) VALUES (?,DEPOSIT_NO.nextval,?,?,?,?,CONVERT(DATE,?,103),?,?,SYSDATETIME())

##Login
GET_VALID_USER=select login_id,PWD_COUNT from login_master where login_id=? AND APP_ID=? AND STATUS in ('T','Y')
GET_VALID_PWD_DAY=SELECT DATEDIFF(DAY,PASSDATE-45,GETDATE()) DAYS FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND APP_ID = ?
GET_VALID_PWD_TIME=SELECT DATEDIFF(DAY,GETDATE(),PASSDATE)/24 AS HOURS FROM LOGIN_MASTER WHERE LOGIN_ID=? AND APP_ID = ?
GET_USER_BASIC_INFO=SELECT   lm.LOGIN_ID, lm.USERTYPE, lm.BRANCH_CODE, lm.USER_MAIL, lm.STATUS, PWD_COUNT, USERNAME, bm.BRANCH_NAME, bm.BELONGING_BRANCH, lm.COUNTRY_ID, lm.MENU_ID,lm.ATTACHED_BRANCH,lm.ACCESSTYPE,lm.OA_CODE OA_CODE,lm.SUBUSERTYPE SUBUSERTYPE FROM   LOGIN_MASTER lm, branch_master bm WHERE   lm.LOGIN_ID = ? AND APP_ID = ? AND bm.branch_code = lm.branch_code and bm.STATUS = 'Y'
GET_MAIL_FORGOT_VALID=SELECT LOGIN_ID FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND USER_MAIL = ? AND APP_ID = ?
GET_COUNT_PWD=SELECT COUNT(*) FROM ( SELECT Item userpwd FROM FN_Split_SV ( (SELECT     PASSWORD + ' '+ ',' + ' '+ LPASS1 + ' '+ ','+ ' '+  LPASS2 + ' ' + ',' + ' ' + LPASS3 + ' '+ ','+ ' '+ LPASS4+ ' '+ ','+ ' '+ LPASS5 PWD FROM   login_master WHERE       LOGIN_ID = ? AND STATUS IN ('Y', 'T') AND APP_ID = ?),',') A ) A  where userpwd=?
UPD_USER_PWD=UPDATE LOGIN_MASTER SET LPASS5=LPASS4,LPASS4=LPASS3,LPASS3=LPASS2,LPASS2=LPASS1,LPASS1=PASSWORD,PASSWORD=?,PASSDATE=DATEADD(day,45,SYSDATETIME ()),STATUS='Y',PWD_COUNT='0' WHERE LOGIN_ID=? AND APP_ID = ? AND STATUS IN ('Y','T')
UPD_USER_PWD_TEMP=UPDATE LOGIN_MASTER SET LPASS5\=LPASS4,LPASS4\=LPASS3,LPASS3\=LPASS2,LPASS2\=LPASS1,LPASS1\=PASSWORD,PASSWORD\=?,PASSDATE\=SYSDATETIME(),STATUS\='T',PWD_COUNT\=0 WHERE LOGIN_ID\=? AND APP_ID \= ? 
GET_MAIL_DETAILS=SELECT MAIL_CC, SMTP_HOST, SMTP_USER, SMTP_PWD, EXP_DATE, EXP_TIME, PWD_CNT, PWD_LEN, HOME_APP,CONVERT(VARCHAR, SMTP_PORT)SMTP_PORT  from MAIL_MASTER where APP_ID=?
##GET_TEMP_PWD_EXP=SELECT convert(char,CONVERT(datetime,GETDATE()+?/24,103),126) expireTime FROM DUAL
GET_TEMP_PWD_EXP=SELECT convert(char,CONVERT(datetime,GETDATE()+?/24,103),126) expireTime
UPD_PWD_CNT_RESET=UPDATE LOGIN_MASTER SET PWD_COUNT\=0 WHERE LOGIN_ID\=? AND APP_ID \= ? 
UPD_PWD_CNT=UPDATE LOGIN_MASTER SET PWD_COUNT = ISNULL(PWD_COUNT,0)+1 WHERE LOGIN_ID= ? AND APP_ID = ?
GET_PWD_CNT_INVALID=SELECT PWD_COUNT FROM LOGIN_MASTER WHERE LOGIN_ID = ? AND APP_ID = ?
UPD_PWD_STATUS=UPDATE LOGIN_MASTER SET STATUS = ? WHERE LOGIN_ID=? AND APP_ID = ?
GET_APP_LIST=select app_id, app_name from app_master
GET_APP_INFO=select app_name from app_master where app_id=?
INS_NEW_USER_WS=INSERT into LOGIN_MASTER(USERNAME, LOGIN_ID, PASSWORD, app_id, STATUS, USER_MAIL, USERTYPE, PASSDATE,STARTDATE,PWD_COUNT) values (?,?,?,?,?,?,?,SYSDATETIME(),SYSDATETIME(),'0')
INS_NEW_USER=INSERT into LOGIN_MASTER(USERNAME, LOGIN_ID, PASSWORD, app_id, STATUS, USER_MAIL, USERTYPE, PASSDATE,STARTDATE,PWD_COUNT) values (?,?,?,?,?,?,?,SYSDATETIME(),CONVERT(DATE,?,103),'0')
UPD_USER_INFO=UPDATE LOGIN_MASTER SET APP_ID=?, STATUS=?, USER_MAIL=?, USERTYPE=?,STARTDATE=CONVERT(DATE,?,103) WHERE LOGIN_ID=? AND APP_ID=?
UPD_MAIL_MASTER=UPDATE MAIL_MASTER SET MAIL_CC=?, SMTP_HOST=?, SMTP_USER=?, SMTP_PWD=?, EXP_TIME=? where app_id=?
UPD_MAIL_CHANGE_WS=UPDATE LOGIN_MASTER SET USER_MAIL=? WHERE LOGIN_ID=? AND APP_ID = ?
UPD_STATUS_CHANGE_WS=UPDATE LOGIN_MASTER SET STATUS=? WHERE LOGIN_ID=? AND APP_ID = ?
GET_USER_INFO_CHANGE=SELECT LOGIN_ID, USERTYPE, USERNAME, STATUS, USER_MAIL, APP_ID,convert(varchar(10),STARTDATE,103) STARTDATE FROM LOGIN_MASTER WHERE LOGIN_ID=? AND APP_ID=?
GET_ITEM_VALUES = SELECT ITEM_CODE, ITEM_VALUE FROM LIST_ITEM_VALUES WHERE ITEM_TYPE\=?
INS_SESSION_INFO = INSERT INTO SESSION_MASTER(LOGIN_ID, SESSION_ID, START_TIME, STATUS, SYS_IP_ADDRESS) VALUES(?, ?, SYSDATETIME(), 'Y', ?)
UPD_SESSION_INFO = UPDATE SESSION_MASTER SET END_TIME=SYSDATETIME() WHERE LOGIN_ID=? AND STATUS='Y' AND SESSION_ID=?
GET_LOGINID_COUNT=select count(1) from login_master where login_id=? and APP_ID=?
GET_USER_TYPE = SELECT USERTYPE FROM LOGIN_MASTER WHERE LOGIN_ID=? AND APP_ID=?

##MOTOR ADMIN
GET_AREA_LIST=select AREACOVER_ID,AREACOVER_CODE,AREACOVER_DESC_ENGLISH,AREACOVER_DESC_ARABIC,(case ac.STATUS when 'Y' then 'Active' when 'N' then 'DeActive' end)STATUS from MOTOR_AREACOVERAGE_MASTER ac where branch_code\=? and amend_id in (select max(amend_id) from MOTOR_AREACOVERAGE_MASTER where branch_code\=? and AREACOVER_ID\=ac.AREACOVER_ID ) 
INSERT_AREACOVERAGE_UPDATE=INSERT INTO MOTOR_AREACOVERAGE_MASTER(AREACOVER_ID,AREACOVER_DESC_ENGLISH,AREACOVER_DESC_ARABIC,AREACOVER_CODE,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS) VALUES (?,?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_ID=? AND BRANCH_CODE=?),convert(date,?,103),?,?,?)
INSERT_AREACOVERAGE=INSERT INTO MOTOR_AREACOVERAGE_MASTER(AREACOVER_ID,AREACOVER_DESC_ENGLISH,AREACOVER_DESC_ARABIC,AREACOVER_CODE,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS) VALUES ((SELECT MAX(AREACOVER_ID)+1 FROM MOTOR_AREACOVERAGE_MASTER WHERE BRANCH_CODE=?),?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_ID=? AND BRANCH_CODE=?),convert(date,?,103),?,?,?)
GET_AREA_LIST_EDIT=select AREACOVER_ID,AREACOVER_CODE,AREACOVER_DESC_ENGLISH,AREACOVER_DESC_ARABIC,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS,REMARKS from MOTOR_AREACOVERAGE_MASTER ac where ac.branch_code=? and ac.amend_id in (select max(amend_id) from MOTOR_AREACOVERAGE_MASTER where branch_code=? and AREACOVER_ID=ac.AREACOVER_ID )and ac.AREACOVER_ID=?
UPDATE_AREACOVERAGE=UPDATE MOTOR_AREACOVERAGE_MASTER  set AREACOVER_DESC_ENGLISH=?,AREACOVER_DESC_ARABIC=?,AREACOVER_CODE=?,EFFECTIVE_DATE=convert(date,?,103),STATUS=?,REMARKS=? where AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_ID=? and BRANCH_CODE=?) and AREACOVER_ID=?
GET_AREA_COVER_CODE_COUNT = SELECT COUNT(*) FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_CODE=? AND STATUS ='Y' AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_CODE = ? AND BRANCH_CODE=?)
GET_AREA_COVER_COUNT_EDIT = SELECT COUNT(*) FROM   MOTOR_AREACOVERAGE_MASTER WHERE  AREACOVER_CODE= ? AND branch_code = ? AND AREACOVER_ID != ? AND STATUS ='Y'

##OPENCOVER REPORT ADMIN
GET_OPENCOVER_REPORT_LIST=select (select USERNAME from login_master where LOGIN_ID\=broker_id) broker_name,(select FIRST_NAME from personal_info pi where pi.customer_id\=b.customer_id and amend_id\=(select max(amend_id) from personal_info p where p.customer_id\=pi.customer_id)) customer_name,customer_id,open_cover_no,status,premium,commission,PRO_COMMISSION from ( select (select distinct(broker_id) from open_cover_master ocm where ocm.proposal_no in (select proposal_no from open_cover_position_master ocpm where ocpm.open_cover_no\=A.open_cover_no)) broker_id,(select distinct(customer_id) from open_cover_master ocm where ocm.proposal_no in (select proposal_no from open_cover_position_master ocpm where ocpm.open_cover_no\=A.open_cover_no)) customer_id,open_cover_no,status,premium,commission,PRO_COMMISSION from (select open_cover_no,count(status) status,ISNULL(sum(premium+excess_premium),0) premium,ISNULL(sum( COMMISSION),0) commission ,ISNULL(sum(PRO_COMMISSION),0) PRO_COMMISSION  from position_master  where status\='P' and product_id\='11' and open_cover_no is not null and INCEPTION_DATE between CONVERT(DATE,?,103) and CONVERT(DATE,?,103)+1 and login_id in( select login_id from login_master  where oa_code in (select distinct oa_code from login_master where
GET_MULTI_OPENCOVER_LIST=select ,VESSEL_NAME, TRANSACTION_ID,sum(PREMIUM) PREMIUM, sum(TOTAL_SUM_INSURED) TOTAL_SUM_INSURED from ( SELECT WMQ.VESSEL_NAME, WMQ.TRANSACTION_ID, PM.QUOTE_NO, MD.TOTAL_SUM_INSURED,(ISNULL (MD.PREMIUM, 0) + ISNULL (MD.EXCESS_PREMIUM, 0)) PREMIUM,( SELECT  CASE WHEN UPPER (SETTLING_AGENT_NAME) \= 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END  FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID\=MPD.SETTLING_AGENT_ID) SETTLING_AGENT_NAME, (SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID \= ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO \= MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_RESULT_DETAILS MRD,WEBSERVICE_MARINE_QUOTE WMQ, MARINE_POLICY_DETAILS MPD, login_master lm WHERE  MRD.APPLICATION_NO\=PM.APPLICATION_NO  AND WMQ.APPLICATION_NO\=PM.APPLICATION_NO AND PM.OPEN_COVER_INT_STATUS\='LINKED' and lm.login_id\=PM.LOGIN_ID AND PM.ENTRY_DATE between CONVERT(DATE,?,103) and  CONVERT(DATE,?,103)+1  and WMQ.branch_code\=?  AND PM.REMARKS IN ('Normal', 'Admin')  AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > (SELECT SYSDATETIME() FROM DUAL) AND PM.APPLICATION_ID \= ISNULL('','1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO\=PM.APPLICATION_NO AND MPD.QUOTE_NO\=PM.QUOTE_NO) group by TRANSACTION_ID, VESSEL_NAME order by TRANSACTION_ID desc

##ADMIN DASHBOARD
GET_DASHBOARD_ADMIN=select * from chart_report(?,?,'Admin',?)
GET_DASHBOARD_ADMIN_MOTOR=select * from MOT_DASHBOARD(?,?,'Admin',?)
GET_DUBAITRADE_STATUS=SELECT (case REMARKS when NULL then 'N' else 'Y' end) DUBAI_TRADE_STATUS FROM CONSTANT_DETAIL WHERE REMARKS = ? AND CATEGORY_ID = 149 AND BRANCH_CODE = ? AND STATUS = 'Y'
GET_ENDT_QUOTENO=select distinct quote_no from marine_data_endt mde where ORIGINAL_POLICY_NO= (select distinct ORIGINAL_POLICY_NO from marine_data_endt where quote_no=?) and ENDT_NO=(select max(ENDT_NO) from marine_data_endt where ORIGINAL_POLICY_NO=mde.ORIGINAL_POLICY_NO)

#issuer broker
update.travel.broker = update personal_info set agency_code=?,ac_executive_id=? where customer_id=?
BROKER_DELETE_PRODUCT=delete from login_user_details where agency_code\=? and product_id\=?
INS_LC_NEW_VALUE_QUOTE=insert into open_cover_lc_master (lc_number,lc_amount,bank_id,AMEND_ID,LC_DATE, EFFECTIVE_DATE,ENTRY_DATE,Expiry_DATE,REMARKS,STATUS, open_cover_no,LC_ID, lc_currency_id,LC_BALANCE_AMOUNT,LC_ACTUAL_AMOUNT,LC_SALE_TERM_ID) values(?,?,?,?,CONVERT(DATE,?,103), SYSDATETIME(),SYSDATETIME(),SYSDATETIME()+365,?,?, ?,?,?,?,?,(select SALE_TERM_ID from sale_term_master where SALE_TERM_NAME='Declared Value' and BRANCH_CODE=?))
UPD_LC_VALUE_QUOTE=update open_cover_lc_master set lc_amount=?,bank_id=?,AMEND_ID=?,LC_DATE =convert(date,?,103),EXPIRY_DATE=SYSDATETIME()+365, lc_currency_id=?,LC_ACTUAL_AMOUNT=?, LC_SALE_TERM_ID=( select SALE_TERM_ID from sale_term_master where SALE_TERM_NAME='Declared Value' and BRANCH_CODE=?), effective_date=SYSDATETIME() where open_cover_NO=? and lc_number=? and lc_id=?
CHECK_VALID_PROMOTIONAL_CODE=select count(*) from promotional_rate_master prm where prm.PROMOTIONAL_CODE\=? and prm.BRANCH_CODE\=? and status\='Y' and prm.start_date<\=SYSDATETIME() and prm.end_date>\=SYSDATETIME() and amend_id\=(select max(amend_id) from promotional_rate_master prmm where prmm.PROMOTIONAL_CODE\=prm.PROMOTIONAL_CODE and prmm.BRANCH_CODE\=prm.BRANCH_CODE and prmm.status\='Y' and prmm.start_date<\=SYSDATETIME() and prmm.end_date>\=SYSDATETIME())
GET_BRANCHS_LIST=select branch_code, branch_name from branch_master where status='Y' order by branch_code
UPD_WS_MARINE_QUOTE={call Webservice_Data(?,?,?)}
#Rating Engine Queries
GET_COMM_CATEG_LIST=select COMMODITY_TYPEID,DETAIL_NAME from COMMODITY_CATEGORY_MASTER CCM  where BRANCH_CODE\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM COMMODITY_CATEGORY_MASTER CM WHERE CM.BRANCH_CODE\=CCM.BRANCH_CODE and cm.COMMODITY_TYPEID\=ccm.COMMODITY_TYPEID)
#EXCESS DESC
#UPD_EXCESS_DESC = update webservice_marine_commodity wmc set EXCESS_DESCRIPTION=(select EXCESS_DESCRIPTION from open_cover_commodity_detail occd where PROPOSAL_NO=(select proposal_no from open_cover_position_master ocpm where ocpm.OPEN_COVER_NO=? and amend_id=(select max(amend_id) from open_cover_position_master ocpm1 where ocpm1.proposal_no=ocpm.proposal_no )) and occd.COMMODITY_ID=wmc.COMMODITY_CODE and occd.amend_id=(select max(amend_id) from open_cover_commodity_detail occd1 where occd1.proposal_no=occd.proposal_no)) where application_no=?
UPD_EXCESS_DESC =UPDATE   WEBSERVICE_MARINE_COMMODITY  SET   EXCESS_DESCRIPTION =(SELECT   EXCESS_DESCRIPTION FROM   open_cover_commodity_detail occd WHERE COVER_ID=? AND PROPOSAL_NO =(SELECT   proposal_no FROM   open_cover_position_master ocpm WHERE   ocpm.OPEN_COVER_NO = ? AND ocpm.amend_id =(SELECT   MAX (ocpm1.amend_id) FROM   open_cover_position_master ocpm1 WHERE   ocpm1.proposal_no = ocpm.proposal_no)) AND occd.COMMODITY_ID = WEBSERVICE_MARINE_COMMODITY.COMMODITY_CODE AND occd.amend_id =(SELECT   MAX (occd1.amend_id) FROM   open_cover_commodity_detail occd1 WHERE   occd1.proposal_no = occd.proposal_no and occd.cover_id=occd1.cover_id  and occd.COMMODITY_ID=occd1.COMMODITY_ID )) WHERE   application_no = ?
UPD_EXCESS_DESC_CHD_WEB=UPDATE WEBSERVICE_MARINE_COMMODITY  SET  EXCESS_DESCRIPTION \=? where application_no \= ? 
UPD_EXCESS_DESC_CHD_MRD=update marine_result_details set EXCESS_DESCRIPTION \=? ,POLICY_EXCESS_PERCENT\=? where application_no \= ? 

## Updaate Effective Date
UPD_ENDT_EFF_DATE=update position_master set EFFECTIVE_DATE=CONVERT(DATE,?,103) where QUOTE_NO=?
UPD_POLICY_EFF_DATE=update position_master set POLICY_EFFECTIVE_DATE=CONVERT(DATE,?,103) where QUOTE_NO=?
UPD_POLICY_EFF_DATE2=update position_master set POLICY_EFFECTIVE_DATE=convert(Datetime,?,120) where QUOTE_NO=?

POLICY_EFF_DATE_CT =  select (case when count(*) = 0 then  (SELECT DATENAME(month,convert(date,?,103) ) ) else 'success' end) MSG  from T_TRN_CLOSING where  PRODUCT_CORE_CODE=1 and   BRANCH_CODE = ?  and (convert(date,?,103) between CLO_DATE_OPENED and  CLO_DATE_CLOSED or  convert(date,?,103) >= CLO_MONTHEND_DT)

##Commodity Selection##
SER_COMM_SHOW = SELECT COMMODITY_CODE,SUPPLIER_NAME, (SELECT   DISTINCT (COMMODITY_NAME) FROM   COMMODITYMASTER CM WHERE   Wmc.COMMODITY_CODE = CM.COMMODITY_ID AND branch_code = ? and amend_id=(select max(amend_id) from COMMODITYMASTER C where c.COMMODITY_ID=CM.COMMODITY_ID)) COMMODITY_NAME, COMMODITY_DESCRIPTION, SUMINSURED, INVOICE_NUMBER, convert (varchar(10),INVOICE_DATE, 103) INVOICE_DATE, convert (varchar(10),INVOICE_DATE, 103) INVOICE_DATE1, PACKAGE_DESCRIPTION, FRAGILE,  (case FRAGILE when 'on' then 'Yes' when 'off' then  'No' end) FRAGILE_SELECT,PO_NUMBER FROM WEBSERVICE_MARINE_COMMODITY Wmc WHERE APPLICATION_NO =?
COMMODITY_EXIST=select count(commodity_description) from webservice_marine_commodity where COMMODITY_CODE\=? and application_no\=?
GET_HOME_POSITION_MASTER_POLICYFEES=select ISNULL(policy_fee,0) from home_position_master where quote_no\=? 
CHK_EFF_DATE=select count(*) from dual where convert(date,GETDATE(),103) <= convert(date,?,103)
## MOTOR BODY FORM
GET_MOTORFORM_LIST= Select (case MTBM.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS, MTBM.*,(Select count(*) from MOTOR_CYCLINDER_MASTER mcm where mcm.branch_code=MTBM.branch_code and MTBM.type_of_body_id=mcm.TYPE_OF_BODY and amend_id=(Select max(amend_id) from MOTOR_CYCLINDER_MASTER mc where mc.branch_code=mcm.branch_code and mcm.TYPE_OF_BODY=mc.TYPE_OF_BODY)) Total_type_id from MOTOR_BODYTYPE_MASTER MTBM where MTBM.BRANCH_CODE=? and MTBM.PRODUCT_ID=?   and MTBM.amend_id=(Select max(amend_id) from MOTOR_BODYTYPE_MASTER MTM Where MTBM.type_of_body_id=MTM.type_of_body_id and MTBM.branch_code=MTM.branch_code and MTBM.PRODUCT_ID=MTM.PRODUCT_ID)
INSERT_MOTOR_BODY= INSERT INTO MOTOR_BODYTYPE_MASTER(TYPE_OF_BODY_ID,COREAPP_CODE,TYPE_OF_BODY_NAME,TYPE_OF_BODY_NAME_ARABIC,NO_OF_YEARS_ALLOWED,THIRD_PARTY_LIABILITY,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,PRODUCT_ID) VALUES ((SELECT MAX(TYPE_OF_BODY_ID)+1 FROM MOTOR_BODYTYPE_MASTER WHERE BRANCH_CODE=?),?,?,?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_BODYTYPE_MASTER WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,?)
UPDATE_MOTOR_BODY= UPDATE MOTOR_BODYTYPE_MASTER  set COREAPP_CODE=?,TYPE_OF_BODY_NAME=?,TYPE_OF_BODY_NAME_ARABIC=?,NO_OF_YEARS_ALLOWED=?,THIRD_PARTY_LIABILITY=?,EFFECTIVE_DATE=CONVERT(DATE,?,103),STATUS=? where AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_MASTER WHERE TYPE_OF_BODY_ID=? and BRANCH_CODE=?) and TYPE_OF_BODY_ID=?
INSERT_MOTOR_BODY_UPDATE= INSERT INTO MOTOR_BODYTYPE_MASTER(TYPE_OF_BODY_ID,COREAPP_CODE,TYPE_OF_BODY_NAME,TYPE_OF_BODY_NAME_ARABIC,NO_OF_YEARS_ALLOWED,THIRD_PARTY_LIABILITY,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,PRODUCT_ID) VALUES (?,?,?,?,?,?,(SELECT MAX(AMEND_ID)+1 FROM MOTOR_BODYTYPE_MASTER WHERE TYPE_OF_BODY_ID=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,?)
GET_MOTOR_BODY_EDIT= select COREAPP_CODE,TYPE_OF_BODY_NAME,TYPE_OF_BODY_NAME_ARABIC,NO_OF_YEARS_ALLOWED,THIRD_PARTY_LIABILITY,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS from MOTOR_BODYTYPE_MASTER ac where ac.branch_code=? and ac.amend_id in (select max(amend_id) from MOTOR_BODYTYPE_MASTER where branch_code=? and TYPE_OF_BODY_ID=ac.TYPE_OF_BODY_ID )and ac.TYPE_OF_BODY_ID=?
COUNT_MOTOR_BODY_EDIT = select count(*) from MOTOR_BODYTYPE_MASTER where TYPE_OF_BODY_ID !=? and STATUS='Y' and BRANCH_CODE=?  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_BODYTYPE_MASTER WHERE COREAPP_CODE = ? AND BRANCH_CODE=? AND TYPE_OF_BODY_ID !=?) AND COREAPP_CODE = ?

##MOTOR OPCOVER
GET_MOTOR_OPCOVER_LIST=select OPCOVER_ID,COREAPP_CODE,OPCOVER_DESC_ENGLISH,OPCOVER_DESC_ARABIC,(case ac.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS from MOTOR_OPCOVER_MASTER ac where branch_code\=? and amend_id in (select max(amend_id) from MOTOR_OPCOVER_MASTER where branch_code\=? and OPCOVER_ID\=ac.OPCOVER_ID ) 
GET_MOTOR_OPCOVER_EDIT= select COREAPP_CODE,OPCOVER_DESC_ENGLISH,OPCOVER_DESC_ARABIC,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS,REMARKS from MOTOR_OPCOVER_MASTER ac where ac.branch_code=? and ac.amend_id in (select max(amend_id) from MOTOR_OPCOVER_MASTER where branch_code=? and OPCOVER_ID=ac.OPCOVER_ID )and ac.OPCOVER_ID=?
INSERT_OPCOVER= INSERT INTO MOTOR_OPCOVER_MASTER(OPCOVER_ID,COREAPP_CODE,OPCOVER_DESC_ENGLISH,OPCOVER_DESC_ARABIC,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS) VALUES ((SELECT MAX(OPCOVER_ID)+1 FROM MOTOR_OPCOVER_MASTER WHERE BRANCH_CODE=?),?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_OPCOVER_MASTER WHERE COREAPP_CODE=? AND BRANCH_CODE=?),convert(date,?,103),?,?,?)
UPDATE_MOTOR_OPCOVER=UPDATE MOTOR_OPCOVER_MASTER  set COREAPP_CODE=?,OPCOVER_DESC_ENGLISH=?,OPCOVER_DESC_ARABIC=?,EFFECTIVE_DATE=convert(date,?,103),STATUS=?,REMARKS=? where AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_OPCOVER_MASTER WHERE OPCOVER_ID=? and BRANCH_CODE=?) and OPCOVER_ID=?
INSERT_MOTOR_OPCOVER_UPDATE=INSERT INTO MOTOR_OPCOVER_MASTER(OPCOVER_ID,COREAPP_CODE,OPCOVER_DESC_ENGLISH,OPCOVER_DESC_ARABIC,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS) VALUES (?,?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_OPCOVER_MASTER WHERE OPCOVER_ID=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,?)
CHECK_CORE_APP_CODE_OPCOVER = select COUNT(*) FROM MOTOR_OPCOVER_MASTER WHERE COREAPP_CODE\=? and BRANCH_CODE\=?

##MODEL CONFIGURATION
GET_MODEL_CONFIG_LIST=SELECT MDM.MODEL_ID, MDM.MAKE_ID, MDM.MODEL_NAME, MDM.MODEL_NAME_ARABIC, MDM.CORE_CODE, MDM.MODEL_NAME_ARABIC, MDM.REFERRAL_STATUS, MMM.MAKE_ID, MMM.MAKE_NAME,(case MDM.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) )STATUS FROM MOTOR_MODEL_MASTER MDM, MOTOR_MAKE_MASTER MMM WHERE MDM.BRANCH_CODE\=? AND MDM.AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_MAKE_MASTER WHERE BRANCH_CODE\=? AND MAKE_ID\=MDM.MAKE_ID)

##MOTOR COLOR
GET_MOTOR_COLOR_LIST=select COLOR_ID,COLOR_CODE,COLOR_DESC_ENGLISH,COLOR_DESC_ARABIC,(case ac.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS from MOTOR_COLOR_MASTER ac where branch_code\=? and amend_id in (select max(amend_id) from MOTOR_COLOR_MASTER where branch_code\=? and COLOR_ID\=ac.COLOR_ID )
GET_MOTOR_COLOR_EDIT= select COLOR_CODE,COLOR_DESC_ENGLISH,COLOR_DESC_ARABIC,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS,REMARKS from MOTOR_COLOR_MASTER ac where ac.branch_code=? and ac.amend_id in (select max(amend_id) from MOTOR_COLOR_MASTER where branch_code=? and COLOR_ID=ac.COLOR_ID )and ac.COLOR_ID=?
INSERT_MOTOR_COLOR= INSERT INTO MOTOR_COLOR_MASTER(COLOR_ID,COLOR_CODE,COLOR_DESC_ENGLISH,COLOR_DESC_ARABIC,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS) VALUES ((SELECT MAX(COLOR_ID)+1 FROM MOTOR_COLOR_MASTER WHERE BRANCH_CODE=?),?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_COLOR_MASTER WHERE COLOR_CODE=? AND BRANCH_CODE=?),convert(date,?,103),?,?,?)
UPDATE_MOTOR_COLOR=UPDATE MOTOR_COLOR_MASTER  set COLOR_CODE=?,COLOR_DESC_ENGLISH=?,COLOR_DESC_ARABIC=?,EFFECTIVE_DATE=convert(date,?,103),STATUS=?,REMARKS=? where AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_COLOR_MASTER WHERE COLOR_ID=? and BRANCH_CODE=?) and COLOR_ID=?
INSERT_MOTOR_COLOR_UPDATE=INSERT INTO MOTOR_COLOR_MASTER(COLOR_ID,COLOR_CODE,COLOR_DESC_ENGLISH,COLOR_DESC_ARABIC,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS) VALUES (?,?,?,?,(SELECT MAX(AMEND_ID)+1 FROM MOTOR_COLOR_MASTER WHERE COLOR_ID=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,?)

##MOTOR CYLINDER
GET_MOTOR_CYLINDER_LIST= SELECT distinct ac.CYL_ID, ac.CYL_CODE, ac.CYLINDER_DESC_ENGLISH, ac.CYLINDER_DESC_ARABIC,(case ac.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS, ac.EFFECTIVE_DATE, ac.EXPIRY_DATE, ac.REMARKS, ac.AMEND_ID, ac.BRANCH_CODE, TYPE_OF_BODY,(case ac.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS FROM MOTOR_CYCLINDER_MASTER ac, MOTOR_BODYTYPE_MASTER mb WHERE ac.type_of_body=mb.type_of_body_id AND ac.branch_code =mb.branch_code and ac.branch_code = ? and ac.type_of_body=? AND ac.amend_id IN (SELECT   MAX (amend_id) FROM MOTOR_CYCLINDER_MASTER WHERE ac.branch_code = ? AND CYL_ID = ac.CYL_ID) AND mb.amend_id=(select max(amend_id) from MOTOR_BODYTYPE_MASTER mtb where mb.type_of_body_id=mtb.type_of_body_id and mtb.branch_code = ? and ac.type_of_body=ac.type_of_body)
GET_MOTOR_CYLINDER_EDIT= select CYL_CODE,CYLINDER_DESC_ENGLISH,CYLINDER_DESC_ARABIC,TYPE_OF_BODY,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS,REMARKS from MOTOR_CYCLINDER_MASTER ac where ac.branch_code=? and ac.amend_id in (select max(amend_id) from MOTOR_CYCLINDER_MASTER where branch_code=? and CYL_ID=ac.CYL_ID )and ac.CYL_ID=?
INSERT_MOTOR_CYLINDER= INSERT INTO MOTOR_CYCLINDER_MASTER(CYL_ID,CYL_CODE,CYLINDER_DESC_ENGLISH,CYLINDER_DESC_ARABIC,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS,TYPE_OF_BODY) VALUES ((SELECT MAX(CYL_ID)+1 FROM MOTOR_CYCLINDER_MASTER WHERE BRANCH_CODE=?),?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_CYCLINDER_MASTER WHERE CYL_CODE=? AND BRANCH_CODE=?),convert(date,?,103),?,?,?,?)
UPDATE_MOTOR_CYLINDER=UPDATE MOTOR_CYCLINDER_MASTER  set CYL_CODE=?,CYLINDER_DESC_ENGLISH=?,CYLINDER_DESC_ARABIC=?,EFFECTIVE_DATE=convert(date,?,103),STATUS=?,REMARKS=? where AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_CYCLINDER_MASTER WHERE CYL_ID=? and BRANCH_CODE=?) and CYL_ID=?
INSERT_MOTOR_CYLINDER_UPDATE=INSERT INTO MOTOR_CYCLINDER_MASTER(CYL_ID,CYL_CODE,CYLINDER_DESC_ENGLISH,CYLINDER_DESC_ARABIC,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS,TYPE_OF_BODY) VALUES (?,?,?,?,(SELECT MAX(AMEND_ID)+1 FROM MOTOR_CYCLINDER_MASTER WHERE CYL_ID=? AND BRANCH_CODE=?),convert(date,?,103),?,?,?,?)

##MOTOR UPLOAD FILE
INSERT_UPLOADFILE= INSERT INTO MOTOR_UPLOADED_FILEMASTER(FILE_ID,FILE_TYPE,PRODUCT_ID,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS) VALUES ((SELECT MAX(FILE_ID)+1 FROM MOTOR_UPLOADED_FILEMASTER WHERE BRANCH_CODE=?),?,?,?,CONVERT(DATE,?,103),?,?,?)
GET_MOTOR_UPLOAD_EDIT= select FILE_TYPE,PRODUCT_ID,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS,REMARKS from MOTOR_UPLOADED_FILEMASTER ac where ac.branch_code=? and ac.amend_id in (select max(amend_id) from MOTOR_UPLOADED_FILEMASTER where branch_code=? and FILE_ID=ac.FILE_ID )and ac.FILE_ID=?
UPDATE_MOTOR_UPLOAD=UPDATE MOTOR_UPLOADED_FILEMASTER  set FILE_TYPE=?,PRODUCT_ID=?,EFFECTIVE_DATE=convert(date,?,103),STATUS=?,REMARKS=? where AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_UPLOADED_FILEMASTER WHERE FILE_ID=? and BRANCH_CODE=?) and FILE_ID=?
INSERT_MOTOR_UPLOAD_UPDATE=INSERT INTO MOTOR_UPLOADED_FILEMASTER(FILE_ID,FILE_TYPE,PRODUCT_ID,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS) VALUES (?,?,?,(SELECT MAX(AMEND_ID)+1 FROM MOTOR_UPLOADED_FILEMASTER WHERE FILE_ID=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,?)
GET_MOTOR_UPLOADFILE_LIST= SELECT DISTINCT MF.FILE_ID, MF.FILE_TYPE, PM.PRODUCT_NAME, MF.AMEND_ID, MF.PRODUCT_ID, MF.BRANCH_CODE, MF.REMARKS, MF.EXPIRY_DATE, MF.EFFECTIVE_DATE,(case MF.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS FROM MOTOR_UPLOADED_FILEMASTER MF, PRODUCT_MASTER PM WHERE MF.PRODUCT_ID=PM.PRODUCT_ID AND MF.BRANCH_CODE=? and mf.branch_code=pm.branch_code AND MF.AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_UPLOADED_FILEMASTER MUF WHERE BRANCH_CODE=MF.BRANCH_CODE AND MF.FILE_ID=MUF.FILE_ID) AND PM.AMEND_ID IN (SELECT MAX(AMEND_ID)FROM PRODUCT_MASTER PCM WHERE mf.BRANCH_CODE=MF.BRANCH_CODE)

##MOTOR VOLUNTORY
GET_MOTOR_VOLUNTARY_EDIT= select VOLUNTARY_NAME,VOLUNTARY_VALUE,PRODUCT_ID,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS,REMARKS from MOTOR_VOLUNTARY_EXCESS ac where ac.branch_code\=? and ac.amend_id in (select max(amend_id) from MOTOR_VOLUNTARY_EXCESS where branch_code\=? and VOLUNTARY_ID\=ac.VOLUNTARY_ID )and ac.VOLUNTARY_ID\=?
INSERT_MOTOR_VOLUNTARY= INSERT INTO MOTOR_VOLUNTARY_EXCESS(VOLUNTARY_ID,VOLUNTARY_NAME,VOLUNTARY_VALUE,PRODUCT_ID,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS) VALUES ((SELECT MAX(VOLUNTARY_ID)+1 FROM MOTOR_VOLUNTARY_EXCESS WHERE BRANCH_CODE=?),?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_VOLUNTARY_EXCESS WHERE VOLUNTARY_VALUE=? AND BRANCH_CODE=?),convert(date,?,103),?,?,?)
UPDATE_MOTOR_VOLUNTARY=UPDATE MOTOR_VOLUNTARY_EXCESS  set VOLUNTARY_NAME=?,VOLUNTARY_VALUE=?,PRODUCT_ID=?,EFFECTIVE_DATE=convert(date,?,103),STATUS=?,REMARKS=? where AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_VOLUNTARY_EXCESS WHERE VOLUNTARY_ID=? and BRANCH_CODE=?) and VOLUNTARY_ID=?
INSERT_MOTOR_VOLUNTARY_UPDATE=INSERT INTO MOTOR_VOLUNTARY_EXCESS(VOLUNTARY_ID,VOLUNTARY_NAME,VOLUNTARY_VALUE,PRODUCT_ID,AMEND_ID,EFFECTIVE_DATE,STATUS,BRANCH_CODE,REMARKS) VALUES (?,?,?,?,(SELECT MAX(AMEND_ID)+1 FROM MOTOR_VOLUNTARY_EXCESS WHERE VOLUNTARY_ID=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,?)
GET_MOTOR_VOLUNTARY_LIST= SELECT DISTINCT mv.VOLUNTARY_ID, mv.VOLUNTARY_NAME, mv.REMARKS, mv.PRODUCT_ID, mv.VOLUNTARY_VALUE, mv.AMEND_ID, (case MV.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS, mv.CORE_CODE, mv.BRANCH_CODE, mv.EXPIRY_DATE, mv.EFFECTIVE_DATE, PM.product_name, mv.branch_code FROM MOTOR_VOLUNTARY_EXCESS mv, PRODUCT_MASTER PM WHERE mv.PRODUCT_ID=PM.PRODUCT_ID and mv.branch_code = ? and mv.branch_code=pm.branch_code AND mv.amend_id in (SELECT   MAX (amend_id) FROM MOTOR_VOLUNTARY_EXCESS WHERE  mv.branch_code =  mv.branch_code AND VOLUNTARY_ID = mv.VOLUNTARY_ID) AND PM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PRODUCT_MASTER WHERE mv.branch_code= mv.branch_code)
GET_VOLUNTARY_COUNT = SELECT COUNT(*) FROM MOTOR_VOLUNTARY_EXCESS WHERE VOLUNTARY_VALUE=? AND STATUS = 'Y' AND BRANCH_CODE = ? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_VOLUNTARY_EXCESS WHERE VOLUNTARY_VALUE = ? AND BRANCH_CODE=?)
GET_VOLUNTARY_COUNT_EDIT = SELECT COUNT(*) FROM MOTOR_VOLUNTARY_EXCESS WHERE VOLUNTARY_VALUE=? AND STATUS = 'Y' AND BRANCH_CODE = ? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_VOLUNTARY_EXCESS WHERE VOLUNTARY_VALUE = ? AND BRANCH_CODE=? AND VOLUNTARY_ID != ?) AND VOLUNTARY_ID !=?

#MOTOR SELECT LISTS
GET_MAKE_LIST= select MAKE_ID,MAKE_NAME from MOTOR_MAKE_master where branch_code=?
GET_BODYTYPE_LIST= select TYPE_OF_BODY_ID,TYPE_OF_BODY_NAME from MOTOR_BODYTYPE_MASTER ac where branch_code=? and amend_id in (select max(amend_id) from MOTOR_BODYTYPE_MASTER where branch_code=? and TYPE_OF_BODY_ID=ac.TYPE_OF_BODY_ID )

##MOTOR VALIDATION
GET_INSERT_COUNT=SELECT COUNT(*) FROM MOTOR_OPCOVER_MASTER WHERE COREAPP_CODE=? AND STATUS = 'Y' AND BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_OPCOVER_MASTER WHERE   COREAPP_CODE = ? AND BRANCH_CODE = ? )
GET_INSERT_COUNT_EDIT=SELECT COUNT(*) FROM MOTOR_OPCOVER_MASTER WHERE COREAPP_CODE=? AND STATUS = 'Y' AND BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_OPCOVER_MASTER WHERE   COREAPP_CODE = ? AND BRANCH_CODE = ? AND OPCOVER_ID != ? ) AND OPCOVER_ID != ?
GET_COLOR_COUNT=SELECT COUNT(*) FROM MOTOR_COLOR_MASTER WHERE COLOR_CODE=? AND STATUS = 'Y' AND BRANCH_CODE = ? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_COLOR_MASTER WHERE COLOR_CODE = ? AND BRANCH_CODE=?)
GET_COLOR_COUNT_EDIT = SELECT COUNT(*) FROM MOTOR_COLOR_MASTER WHERE COLOR_CODE=? AND STATUS = 'Y' AND BRANCH_CODE = ? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_COLOR_MASTER WHERE COLOR_CODE = ? AND BRANCH_CODE=? AND COLOR_ID != ?) AND COLOR_ID !=?
GET_INSERT_BODY_COUNT=SELECT COUNT(*) FROM MOTOR_BODYTYPE_MASTER WHERE COREAPP_CODE=? AND STATUS = 'Y' AND BRANCH_CODE = ? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_BODYTYPE_MASTER WHERE COREAPP_CODE = ? AND BRANCH_CODE=?)
GET_INSERT_CYL_COUNT=SELECT COUNT(*) FROM MOTOR_CYCLINDER_MASTER WHERE CYL_CODE\=? AND STATUS \= 'Y' AND BRANCH_CODE \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM  MOTOR_CYCLINDER_MASTER WHERE CYL_CODE \= ? AND BRANCH_CODE\=?)
GET_MOTOR_CYLINDER_COUNT_EDIT = SELECT COUNT(*) FROM MOTOR_CYCLINDER_MASTER WHERE CYL_CODE\=? AND STATUS \= 'Y' AND BRANCH_CODE \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM  MOTOR_CYCLINDER_MASTER WHERE CYL_CODE \= ? AND BRANCH_CODE\=? AND CYL_ID \!\= ? )  AND CYL_ID \!\= ?


##MOTOR POLICY NEW
GET_MOTORPOLICY_LIST=select POLICYTYPE_ID,COREAPP_CODE,POLICYTYPE_NAME,POLICYTYPE_DESC_ENGLISH,POLICYTYPE_DESC_ARABIC,(case MBM.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS,POLICY_TERM from MOTOR_POLICYTYPE_MASTER mbm where branch_code=? and amend_id = (select max(amend_id) from  motor_policytype_master where  branch_code=mbm.branch_code and policytype_id= mbm.policytype_id)
INSERT_MOTORPOLICY=INSERT INTO MOTOR_POLICYTYPE_MASTER(BRANCH_CODE,POLICYTYPE_NAME,POLICYTYPE_DESC_ENGLISH,POLICYTYPE_DESC_ARABIC,COREAPP_CODE,POLICY_TERM,AMEND_ID,EFFECTIVE_DATE,STATUS,REMARKS,POLICYTYPE_ID) VALUES (?,?,?,?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_POLICYTYPE_MASTER WHERE COREAPP_CODE=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,(SELECT MAX(POLICYTYPE_ID)+1 FROM MOTOR_POLICYTYPE_MASTER WHERE BRANCH_CODE=?))
GET_MOTORPOLICY_LIST_EDIT=select POLICYTYPE_NAME,POLICYTYPE_DESC_ENGLISH,POLICYTYPE_DESC_ARABIC,COREAPP_CODE,POLICY_TERM,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS,REMARKS from  MOTOR_POLICYTYPE_MASTER mp where mp.branch_code=? and mp.amend_id in (select max(amend_id) from MOTOR_POLICYTYPE_MASTER where branch_code=? and POLICYTYPE_ID=mp.POLICYTYPE_ID ) and mp.POLICYTYPE_ID=?
UPDATE_MOTORPOLICY=UPDATE MOTOR_POLICYTYPE_MASTER SET POLICYTYPE_NAME=?,POLICYTYPE_DESC_ENGLISH=?,POLICYTYPE_DESC_ARABIC=?,COREAPP_CODE=?,POLICY_TERM=?,EFFECTIVE_DATE=CONVERT(DATE,?,103),STATUS=?,REMARKS=? WHERE POLICYTYPE_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICYTYPE_ID=? and BRANCH_CODE=?)
INSERT_MOTORPOLICY_UPDATE=INSERT INTO MOTOR_POLICYTYPE_MASTER(BRANCH_CODE,POLICYTYPE_NAME,POLICYTYPE_DESC_ENGLISH,POLICYTYPE_DESC_ARABIC,COREAPP_CODE,POLICY_TERM,AMEND_ID,EFFECTIVE_DATE,STATUS,REMARKS,POLICYTYPE_ID) VALUES (?,?,?,?,?,?,(SELECT MAX(AMEND_ID)+1 FROM MOTOR_POLICYTYPE_MASTER WHERE POLICYTYPE_ID=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,?)
GET_BODY_LIST=select TYPE_OF_BODY_ID,TYPE_OF_BODY_NAME from MOTOR_BODYTYPE_MASTER ac where branch_code=? and amend_id in (select max(amend_id) from MOTOR_BODYTYPE_MASTER where branch_code=? and TYPE_OF_BODY_ID=ac.TYPE_OF_BODY_ID )
 


##MOTOR FINANCE BANK NEW
GET_MOTORBANK_FINANCE_LIST=select BANK_ID,BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,(case MBM.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from MOTOR_FINANCE_BANK_MASTER mbm where branch_code\=? and amend_id \= (select max(amend_id) from motor_finance_bank_master where  branch_code\=mbm.branch_code and bank_id \= mbm.bank_id) 
INSERT_MOTORFINANCEBANK_UPDATE=INSERT INTO MOTOR_FINANCE_BANK_MASTER(BRANCH_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,BANK_CODE,AMEND_ID,EFFECTIVE_DATE,STATUS,REMARKS,BANK_ID) VALUES (?,?,?,?,(SELECT MAX(AMEND_ID)+1 FROM MOTOR_FINANCE_BANK_MASTER WHERE BANK_ID=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,?)
UPDATE_MOTORFINANCEBANK=UPDATE MOTOR_FINANCE_BANK_MASTER set BANK_NAME_ENGLISH\=?,BANK_NAME_ARABIC\=?,BANK_CODE\=?,AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_FINANCE_BANK_MASTER WHERE BANK_ID\=? and BRANCH_CODE\=?),EFFECTIVE_DATE\=CONVERT(DATE,?,103),STATUS\=?,REMARKS\=? WHERE BANK_ID\=?     
INSERT_MOTORFINANCEBANK = INSERT INTO MOTOR_FINANCE_BANK_MASTER(BRANCH_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,BANK_CODE,AMEND_ID,EFFECTIVE_DATE,STATUS,REMARKS,BANK_ID,EXPIRY_DATE) VALUES (?,?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_FINANCE_BANK_MASTER WHERE BANK_CODE=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,(SELECT ISNULL(MAX(BANK_ID),0)+1 FROM MOTOR_FINANCE_BANK_MASTER WHERE BRANCH_CODE=?),( select add_months(SYSDATETIME(),12) from dual))
GET_MOTORFINANCEBANK_LIST_EDIT=select BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS from  MOTOR_FINANCE_BANK_MASTER mb where mb.branch_code=? and mb.amend_id in (select max(amend_id) from MOTOR_FINANCE_BANK_MASTER where branch_code=? and BANK_ID=mb.BANK_ID ) and mb.BANK_ID=?
GET_BANKFINANCE_SEARCH_LIST=select BANK_ID,BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,STATUS from MOTOR_FINANCE_BANK_MASTER mbm where branch_code=? and (amend_id = (select max(amend_id) from MOTOR_FINANCE_BANK_MASTER where  branch_code=mbm.branch_code and bank_id = mbm.bank_id)) and   bank_id=?

##MOTOR BANK NEW
GET_MOTORBANK_LIST=select BANK_ID,BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,(case MBM.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from MOTOR_BANK_MASTER mbm where branch_code\=? and amend_id \= (select max(amend_id) from motor_bank_master where  branch_code\=mbm.branch_code and bank_id \= mbm.bank_id) 
GET_MOTORBANK_LIST_EDIT=select BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS from  MOTOR_BANK_MASTER mb where mb.branch_code=? and mb.amend_id in (select max(amend_id) from MOTOR_BANK_MASTER where branch_code=? and BANK_ID=mb.BANK_ID ) and mb.BANK_ID=?
INSERT_MOTORBANK=INSERT INTO MOTOR_BANK_MASTER(BRANCH_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,BANK_CODE,AMEND_ID,EFFECTIVE_DATE,STATUS,REMARKS,BANK_ID,EXPIRY_DATE) VALUES (?,?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_BANK_MASTER WHERE BANK_CODE=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,(SELECT ISNULL(MAX(BANK_ID),0)+1 FROM MOTOR_BANK_MASTER WHERE BRANCH_CODE=?),( select add_months(SYSDATETIME(),12) from dual))
INSERT_MOTORBANK_UPDATE=INSERT INTO MOTOR_BANK_MASTER(BRANCH_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,BANK_CODE,AMEND_ID,EFFECTIVE_DATE,STATUS,REMARKS,BANK_ID) VALUES (?,?,?,?,(SELECT MAX(AMEND_ID)+1 FROM MOTOR_BANK_MASTER WHERE BANK_ID=? AND BRANCH_CODE=?),CONVERT(DATE,?,103),?,?,?)
UPDATE_MOTORBANK=UPDATE MOTOR_BANK_MASTER set BANK_NAME_ENGLISH\=?,BANK_NAME_ARABIC\=?,BANK_CODE\=?,AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_BANK_MASTER WHERE BANK_ID\=? and BRANCH_CODE\=?),EFFECTIVE_DATE\=CONVERT(DATE,?,103),STATUS\=?,REMARKS\=? WHERE BANK_ID\=? 
GET_MOTORBANK_SEARCH_LIST=select BANK_ID,BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,STATUS from MOTOR_BANK_MASTER mbm where branch_code=? and (amend_id = (select max(amend_id) from motor_bank_master where  branch_code=mbm.branch_code and bank_id = mbm.bank_id)) and   bank_id=?

##MOTOR MAKE CONFIGURATION NEW
GET_MOTORCONFIGURATION_LIST=select MAKE_ID,MAKE_NAME,MAKE_NAME_ARABIC,CORE_CODE,(case MM.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end) STATUS from MOTOR_MAKE_MASTER mm where branch_code\=? and amend_id \= (select max(amend_id) from MOTOR_MAKE_MASTER where branch_code\=mm.branch_code and make_id\=mm.make_id ) 
INSERT_CONFIGURATION=INSERT INTO MOTOR_MAKE_MASTER(BRANCH_CODE,MAKE_NAME,MAKE_NAME_ARABIC,AMEND_ID,CORE_CODE,EFFECTIVE_DATE,STATUS,REFERRAL_STATUS,REMARKS,MAKE_ID) VALUES (?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_MAKE_MASTER WHERE BRANCH_CODE=? AND CORE_CODE=?),?,CONVERT(DATE,?,103),?,?,?,(SELECT ISNULL(MAX(MAKE_ID),0)+1 FROM MOTOR_MAKE_MASTER WHERE BRANCH_CODE=?))
GET_CONFIGURATION_LIST_EDIT=SELECT MAKE_NAME,MAKE_NAME_ARABIC,CORE_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS,REFERRAL_STATUS,REMARKS,MAKE_ID,MAKE_NAME_ARABIC FROM MOTOR_MAKE_MASTER mm WHERE mm.branch_code=? and mm.MAKE_ID=? and mm.amend_id in (select max(amend_id) from MOTOR_MAKE_MASTER where branch_code=? and MAKE_ID=mm.MAKE_ID )
INSERT_MOTORCONFIG_UPDATE=INSERT INTO MOTOR_MAKE_MASTER(BRANCH_CODE,MAKE_NAME,MAKE_NAME_ARABIC,AMEND_ID,CORE_CODE,EFFECTIVE_DATE,STATUS,REFERRAL_STATUS,REMARKS,MAKE_ID) VALUES (?,?,?,(SELECT MAX(AMEND_ID)+1 FROM MOTOR_MAKE_MASTER WHERE MAKE_ID=? AND BRANCH_CODE=?),?,CONVERT(DATE,?,103),?,?,?,?)
UPDATE_MOTORCONFIG_UPDATE=UPDATE MOTOR_MAKE_MASTER SET MAKE_NAME\=?,MAKE_NAME_ARABIC\=?,CORE_CODE\=?,EFFECTIVE_DATE\=CONVERT(DATE,?,103),STATUS\=?,REFERRAL_STATUS\=?,REMARKS\=? WHERE MAKE_ID\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_MAKE_MASTER WHERE MAKE_ID\=? and BRANCH_CODE\=?)
CONFIGURATION_APPCODE_COUNT = SELECT COUNT(*) FROM MOTOR_MAKE_MASTER WHERE CORE_CODE = ? AND STATUS = 'Y' AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_MAKE_MASTER WHERE CORE_CODE =? AND BRANCH_CODE=?)
INSERT_MOTORFORM=INSERT INTO MOTOR_BODYTYPE_MASTER(BRANCH_CODE,PRODUCT_ID,TYPE_OF_BODY_NAME,TYPE_OF_BODY_NAME_ARABIC,NO_OF_YEARS_ALLOWED,AMEND_ID,THIRD_PARTY_LIABILITY,COREAPP_CODE,EFFECTIVE_DATE,STATUS,TYPE_OF_BODY_ID) VALUES (?,?,?,?,?,?,?,?,CONVERT(DATE,?,103),?,(SELECT MAX(TYPE_OF_BODY_ID)+1 FROM MOTOR_BODYTYPE_MASTER WHERE BRANCH_CODE=?))
GET_MOTORFORM_LIST_EDIT=SELECT TYPE_OF_BODY_NAME,TYPE_OF_BODY_NAME_ARABIC,NO_OF_YEARS_ALLOWED,THIRD_PARTY_LIABILITY,COREAPP_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,STATUS FROM MOTOR_BODYTYPE_MASTER mtb WHERE mtb.branch_code\=? and mtb.amend_id in (select max(amend_id) from MOTOR_BODYTYPE_MASTER where branch_code\=? and TYPE_OF_BODY_ID\=mtb.TYPE_OF_BODY_ID ) and mtb.TYPE_OF_BODY_ID\=?  
UPDATE_MOTORFORM=UPDATE MOTOR_BODYTYPE_MASTER SET TYPE_OF_BODY_NAME\=?,TYPE_OF_BODY_NAME_ARABIC\=?,NO_OF_YEARS_ALLOWED\=?,THIRD_PARTY_LIABILITY\=?,COREAPP_CODE\=?,EFFECTIVE_DATE\=CONVERT(DATE,?,103),STATUS\=?
GET_MOTOR_MAKE_COUNT_EDIT = SELECT COUNT(*) FROM MOTOR_MAKE_MASTER WHERE CORE_CODE = ? AND STATUS = 'Y' AND BRANCH_CODE=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM  MOTOR_MAKE_MASTER WHERE CORE_CODE =? AND BRANCH_CODE=? AND MAKE_ID !=?) AND MAKE_ID !=?
#Motor Claim
MOTOR_CLAIM_STATUS = SELECT COUNT(*) FROM CLAIM_INTIMATION WHERE POLICY_NO=? AND STATUS ='Pending'
GET_MOTOR_CLAIM_DETAILS = select * from table(fn_motor_data_details(?,?,?))
INS_MOTOR_CLAIM_INTIMATION = insert into claim_intimation (SNO,CLAIM_NO,PRODUCT_ID,POLICY_NO,LOSS_DATE,LOSS_DESCRIPTION,INTIMATION_DATE,CLAIM_REPORTED_DATE,STATUS,CLAIM_INTIMATED_BY) values((select ISNULL(max(sno),0) from claim_intimation)+1,?,?,?,CONVERT(DATE,?,103),?,CONVERT(DATE,?,103),SYSDATETIME(),?,?)  
MOTOR_CLAIM_SEQ = SELECT  MOTOR_CLAIM_SEQ.NEXTVAL CLAIM_SEQ FROM DUAL
GET_MOTOR_ADMIN_CLAIM = select CLAIM_NO,POLICY_NO,convert(varchar(10),LOSS_DATE,103)LOSS_DATE,LOSS_DESCRIPTION,TO_CHAR(INTIMATION_DATE,'DD/MM/YYYY')INTIMATION_DATE,PRODUCT_ID from claim_intimation where STATUS\='Pending' order by CLAIM_NO DESC
GET_APPLICATION_NO = SELECT APPLICATION_NO FROM HOME_POSITION_MASTER WHERE POLICY_NO=?
GET_MOTOR_CLAIM_CLOSE_DETAILS = SELECT   TO_CHAR (LOSS_DATE, 'dd/mm/yyyy') LOSS_DATE, LOSS_DESCRIPTION, TO_CHAR (INTIMATION_DATE, 'dd/mm/yyyy') INTIMATION_DATE FROM   claim_intimation WHERE   CLAIM_NO = ?
UPD_MOTOR_CLAIM_CLOSE_DETAIL = UPDATE CLAIM_INTIMATION SET REMARKS \= ?,REMARKS_DATE \= SYSDATETIME(),CLAIM_CLOSED_BY \= ?,STATUS\='Closed' WHERE CLAIM_NO \= ?  
########################################################

#COVERAGES ENTRY
INSERT_COVERAGES_ENTRY = INSERT INTO OFS_MASTER(COVERAGES_ID,COVERAGES_NAME,COVERAGES_DISPLAY_NAME,REMARKS,STATUS,RSACODE,SECTION_DETAILS) VALUES ((SELECT MAX(COVERAGES_ID)+1 FROM OFS_MASTER),?,?,?,?,?,?)
GET_COVERAGE_LIST = SELECT COVERAGES_ID,COVERAGES_NAME,COVERAGES_DISPLAY_NAME,(case STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS FROM OFS_MASTER 
GET_COVERAGES_EDIT_LIST = SELECT COVERAGES_NAME,COVERAGES_DISPLAY_NAME,REMARKS,STATUS,RSACODE,SECTION_DETAILS FROM OFS_MASTER WHERE COVERAGES_ID=?
UPDATE_COVERAGES_ENTRY = UPDATE OFS_MASTER SET COVERAGES_NAME=?,COVERAGES_DISPLAY_NAME=?,REMARKS=?,STATUS=?,RSACODE=?,SECTION_DETAILS=? WHERE COVERAGES_ID=?

###########OFS_SCHEME_MASTER#############
INSERT_OFS_SCHEME_MASTER=insert into OFS_SCHEME_MASTER(SCHEME_ID,SCHEME_NAME,REMARKS,STATUS,RSACODE,product_id,display_order,branch_code) values ((select ISNULL(max(scheme_id),0)+1 from OFS_SCHEME_MASTER),?,?,?,?,?,(select ISNULL(max(scheme_id),0)+1 from OFS_SCHEME_MASTER),?)
SELECT_OFS_SCHEME_MASTER=select SCHEME_ID, scheme_name,product_id,remarks,status,rsacode from ofs_scheme_master where branch_code\=?
UPDATE_OFS_SCHEME_MASTER=update OFS_SCHEME_MASTER set SCHEME_NAME=?,REMARKS=?,RSACODE=?,STATUS=? where branch_code=? and scheme_id=?
EDIT_OFS_SCHEME_MASTER=select scheme_name,remarks,rsacode,status,display_order,product_id from ofs_scheme_master where branch_code=? and scheme_id=? and product_id=?

##SUBCOVERAGES MASTER
GET_SUBCOVERAGES_LIST = SELECT A.SCHEME_NAME,B.CONTENT_DESCRIPTION,B.CONTENT_TYPE_ID,A.SCHEME_ID FROM OFS_SCHEME_MASTER A,OFS_CONTENT_MASTER B WHERE A.SCHEME_ID\=B.SCHEME_ID AND A.STATUS\=B.STATUS AND BRANCH_CODE\=? ORDER BY 1
  
##BUSINESS MASTER
GET_BUSINESS_LIST = SELECT A.BUSINESS_ID,A.BUSINESS_NAME,(case A.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS,B.TYPE_ID,B.DESCRIPTION FROM HOME_BUSINESS_TYPE_MASTER A,HOME_BUSINESS_TYPE_DETAIL B WHERE A.BUSINESS_ID=B.BUSINESS_ID ORDER BY 1
GET_BUSINESS_NAME_LIST = SELECT DISTINCT BUSINESS_ID,BUSINESS_NAME FROM HOME_BUSINESS_TYPE_MASTER ORDER BY 1
GET_DESCRIPTION_LIST = SELECT TYPE_ID,DESCRIPTION FROM HOME_BUSINESS_TYPE_DETAIL WHERE BUSINESS_ID\=? 
GET_CORE_APP_CODE = SELECT CORE_APP_CODE FROM HOME_BUSINESS_TYPE_MASTER WHERE BUSINESS_ID=?
GET_CONTENT_DESCRIP_LIST =SELECT CONTENT_TYPE_ID,CONTENT_DESCRIPTION FROM OFS_CONTENT_MASTER WHERE RSACODE\=?
GET_COVERAGES_LIST = SELECT DISTINCT COVERAGES_ID,(SELECT COVERAGES_NAME FROM OFS_MASTER om WHERE om.COVERAGES_ID=ocm.COVERAGES_ID) COVERAGES_NAME FROM OFS_COVERAGES_MASTER ocm WHERE CONTENT_TYPE_ID=? AND SCHEME_ID=?
GET_SUB_COVERAGES_LIST = SELECT DISTINCT COVERAGES_SUB_ID,(SELECT SCHEME_NAME FROM OFS_SCHEME_MASTER osm WHERE osm.SCHEME_ID=ocsm.SCHEME_ID) SUB_COVERAGES FROM OFS_COVERAGES_SUB_MASTER ocsm WHERE CONTENT_TYPE_ID=? AND COVERAGES_ID=?
INSERT_BUSINESS_MASTER = INSERT INTO HOME_BUSINESS_TYPE_LOADING(BUSINESS_TYPE_ID,COVERAGE_ID,SUB_COVERAGE_ID,RATE,AMEND_ID,STATUS,REMARKS,BUSINESS_ID) VALUES(?,?,?,?,?,?,?,?)
##BANK CODE MASTER
GET_COUNT_BANK_CODE = select count(*) from MOTOR_BANK_MASTER where BANK_CODE=? AND STATUS='Y' AND BRANCH_CODE=? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_BANK_MASTER WHERE   BANK_CODE = ? AND BRANCH_CODE = ? )
GET_COUNT_BANK_CODE_EDIT = select count(*) from MOTOR_BANK_MASTER where BANK_CODE\=? AND STATUS\='Y' AND BRANCH_CODE\=? AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_BANK_MASTER WHERE   BANK_CODE \= ? AND BRANCH_CODE \= ? AND BANK_ID \!\=? ) AND BANK_ID \!\=? 
##BANK CODE FINANACE MASTER
BANKFINANCECODE_COUNT = select count(*) from MOTOR_FINANCE_BANK_MASTER where BANK_CODE=? AND STATUS='Y'  AND BRANCH_CODE=? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_FINANCE_BANK_MASTER WHERE   BANK_CODE = ? AND BRANCH_CODE = ? )
BANKFINANCECODE_COUNT_EDIT = select count(*) from MOTOR_FINANCE_BANK_MASTER where BANK_CODE=? AND STATUS='Y' AND BRANCH_CODE=? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_FINANCE_BANK_MASTER WHERE   BANK_CODE = ? AND BRANCH_CODE = ? AND BANK_ID !=? ) AND BANK_ID !=?
#BODY RATE MASTER
GET_BODY_RATE_SETUP=SELECT TYPEID,DRIVER_START_AGE,DRIVER_END_AGE,MODEL_ID,TYPE_OF_BODY_ID,VEHICLETYPE_DESC_ENGLISH,ISNULL((SELECT USERNAME FROM LOGIN_MASTER WHERE AGENCY_CODE=MAS.AGENCY_CODE ),'None') BROKER,ISNULL(AGENCY_CODE,'None') FROM MOTOR_TYPE_BODY_LIMIT MAS,MOTOR_VEHICLETYPE_MASTER MVM WHERE TYPE_OF_BODY_ID=? AND MAS.BRANCH_CODE=MVM.BRANCH_CODE AND MAS.VEHICLE_TYPE=VTYPE_ID AND MAS.BRANCH_CODE=? AND PRODUCT_ID=? AND MAS.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_BODY_LIMIT  WHERE BRANCH_CODE=MAS.BRANCH_CODE  AND PRODUCT_ID=MAS.PRODUCT_ID AND TYPE_OF_BODY_ID=MAS.TYPE_OF_BODY_ID   AND TYPEID=MAS.TYPEID) AND MVM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_VEHICLETYPE_MASTER WHERE BRANCH_CODE=MVM.BRANCH_CODE AND VTYPE_ID=MVM.VTYPE_ID)
GET_BODY_BROKER_LIST=select agency_code,username from login_master where upper(usertype)='BROKER' and status='Y' and agency_code in (select agency_code from broker_company_master where branch_code=? and status='Y')
GETVEHICLE_USAGE_LIST=select VTYPE_ID,VEHICLETYPE_DESC_ENGLISH from MOTOR_VEHICLETYPE_MASTER where status='Y' and branch_code=?
GET_BODY_MAKE_LIST=select MAKE_ID,MAKE_NAME from MOTOR_MAKE_MASTER mm where branch_code\=? and  amend_id\=(select max(amend_id) from MOTOR_MAKE_MASTER where branch_code\=mm.branch_code and make_id\=mm.make_id) and status\='Y' 
INSERT_MOTOR_BODY_LIMIT=insert into MOTOR_TYPE_BODY_LIMIT (TYPEID,TYPE_OF_BODY_ID,DRIVER_START_AGE,DRIVER_END_AGE,UAE_LICENCE_START,MODEL_ID,AMEND_ID,BRANCH_CODE,PRODUCT_ID,EFFECTIVEDATE,STATUS,COMBO_NAME,UAE_LICENCE_END,UAE_LICENCE_PERIOD,AGENCY_CODE,VEHICLE_TYPE,MAKE_ID) values ((select ISNULL(max(typeid)+1,1) from MOTOR_TYPE_BODY_LIMIT  where  product_id=? and branch_code=?),?,?,?,?,?,?,?,?,CONVERT(DATE,?,103),?,?,?,?,?,?,?)
EDIT_MOTOR_BODY_LIMIT=select TYPEID,TYPE_OF_BODY_ID,DRIVER_START_AGE,DRIVER_END_AGE,UAE_LICENCE_START,MODEL_ID,AMEND_ID,BRANCH_CODE,PRODUCT_ID,convert(varchar(10),EFFECTIVEDATE,103) EFFECTIVEDATE,STATUS,COMBO_NAME,UAE_LICENCE_END,VEHICLE_TYPE,AGENCY_CODE,MAKE_ID  from motor_type_body_LIMIT where typeid=? and type_OF_BODY_id=? and branch_code=? and product_id=? and amend_id=(select max(amend_id) from motor_type_body_LIMIT where   branch_code=? and product_id=? and typeid=?)
INSERT_MOTOR_BODY_LIMIT_UPDATE=insert into MOTOR_TYPE_BODY_LIMIT (TYPEID,TYPE_OF_BODY_ID,DRIVER_START_AGE,DRIVER_END_AGE,UAE_LICENCE_START,MODEL_ID,AMEND_ID,BRANCH_CODE,PRODUCT_ID,EFFECTIVEDATE,STATUS,COMBO_NAME,UAE_LICENCE_END,UAE_LICENCE_PERIOD,AGENCY_CODE,VEHICLE_TYPE,MAKE_ID) values (?,?,?,?,?,?,(select max(amend_id)+1 from MOTOR_TYPE_BODY_LIMIT where typeid=? and branch_code=? and product_id=?),?,?,CONVERT(DATE,?,103),?,?,?,?,?,?,?)
UPDATE_MOTOR_BODY_LIMIT=update MOTOR_TYPE_BODY_LIMIT set DRIVER_START_AGE=?,DRIVER_END_AGE=?,UAE_LICENCE_START=?,MODEL_ID=?,EFFECTIVEDATE=CONVERT(DATE,?,103),STATUS=?,UAE_LICENCE_END=?,UAE_LICENCE_PERIOD=?,AGENCY_CODE=?,VEHICLE_TYPE=?,MAKE_ID=? where TYPEID=? and TYPE_OF_BODY_ID=? and amend_id=(select max(amend_id) from MOTOR_TYPE_BODY_LIMIT where typeid=? and branch_code=? and product_id=?)
#
GET_RATE_BODY_LIST=select TYPEID,TYPE_RATE_ID,AGENCY_REPAIR_YEAR,RATE,MINIMUM_PREMIUM,SEATING_TON_START,SEATING_TON_END,START_SUMINSURED,END_SUMINSURED,(select POLICYTYPE_NAME from MOTOR_POLICYTYPE_MASTER mp where POLICYTYPE_ID=mr.POLICYTYPE_ID and branch_code=mr.branch_code and amend_id=(select max(amend_id) from MOTOR_POLICYTYPE_MASTER where POLICYTYPE_ID=mp.POLICYTYPE_ID and branch_code=mp.branch_code)) POLICY_TYPE from motor_type_body_rate mr where typeid=? and branch_code=? and product_id=? and amend_id+ ' ' +'-'+ ' ' +type_rate_id in(select max(amend_id)+ ' ' +'-'+ ' ' +type_rate_id from motor_type_body_rate where BRANCH_CODE=? AND PRODUCT_ID=? and typeid=? group by type_rate_id)
GET_POLICY_TYPE_LIST=SELECT POLICYTYPE_ID,POLICYTYPE_NAME FROM MOTOR_POLICYTYPE_MASTER MR WHERE STATUS='Y' AND AMEND_ID= (SELECT MAX(AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICYTYPE_ID=MR.POLICYTYPE_ID AND BRANCH_CODE=MR.BRANCH_CODE) AND POLICYTYPE_ID NOT IN(2) AND BRANCH_CODE=?
INSERT_MOTOR_BODY_RATE=insert into MOTOR_TYPE_BODY_RATE (BRANCH_CODE,PRODUCT_ID,TYPE_RATE_ID,TYPEID,AGENCY_REPAIR_YEAR,RATE,MINIMUM_PREMIUM,SEATING_TON_START,SEATING_TON_END,START_SUMINSURED,END_SUMINSURED,AMEND_ID,EFFECTIVE_DATE,STATUS,POLICYTYPE_ID) values (?,?,(select ISNULL(max(TYPE_RATE_ID)+1,1) from MOTOR_TYPE_BODY_RATE where product_id=? and branch_code=?),?,?,?,?,?,?,?,?,?,CONVERT(DATE,?,103),?,?)
EDIT_MOTOR_BODY_RATE=select TYPEID,AGENCY_REPAIR_YEAR,RATE,MINIMUM_PREMIUM,SEATING_TON_START,SEATING_TON_END,START_SUMINSURED,END_SUMINSURED,convert(varchar(10),EFFECTIVEDATE,103) EFFECTIVE_DATE,STATUS,POLICYTYPE_ID  from motor_type_body_rate where typeid=? and type_rate_id=? and branch_code=? and product_id=? and amend_id=(select max(amend_id) from motor_type_body_RATE where typeid=? and branch_code=? and product_id=? and type_rate_id=?)
INSERT_MOTOR_BODY_RATE_UPDATE=insert into MOTOR_TYPE_BODY_RATE (BRANCH_CODE,PRODUCT_ID,TYPE_RATE_ID,TYPEID,AGENCY_REPAIR_YEAR,RATE,MINIMUM_PREMIUM,SEATING_TON_START,SEATING_TON_END,START_SUMINSURED,END_SUMINSURED,AMEND_ID,EFFECTIVE_DATE,STATUS,POLICYTYPE_ID) values (?,?,?,?,?,?,?,?,?,?,?,(select max(amend_id)+1 from MOTOR_TYPE_BODY_RATE where TYPE_RATE_ID=? and branch_code=? and product_id=?),CONVERT(DATE,?,103),?,?)
UPDATE_MOTOR_BODY_RATE=Update MOTOR_TYPE_BODY_RATE set AGENCY_REPAIR_YEAR=?,RATE=?,MINIMUM_PREMIUM=?,SEATING_TON_START=?,SEATING_TON_END=?,START_SUMINSURED=?,END_SUMINSURED=?,EFFECTIVE_DATE=CONVERT(DATE,?,103), STATUS=?,POLICYTYPE_ID=? where BRANCH_CODE=? and PRODUCT_ID=? and TYPE_RATE_ID=? and TYPEID=? and amend_id=(select max(amend_id) from MOTOR_TYPE_BODY_RATE where TYPE_RATE_ID=? and branch_code=? and product_id=?)
GET_BODY_NAME=Select TYPE_OF_BODY_NAME from MOTOR_BODYTYPE_MASTER MTBM where TYPE_OF_BODY_ID=? and BRANCH_CODE = ? AND MTBM.PRODUCT_ID = ? AND MTBM.amend_id =(SELECT   MAX (amend_id) FROM   MOTOR_BODYTYPE_MASTER MTM WHERE  MTBM.type_of_body_id = MTM.type_of_body_id AND MTBM.branch_code = MTM.branch_code AND MTBM.PRODUCT_ID = MTM.PRODUCT_ID)
##POLICY MASTER
POLICY_APPCODE_COUNT = select count(*) from MOTOR_POLICYTYPE_MASTER where COREAPP_CODE=? AND STATUS='Y'  AND BRANCH_CODE=? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_POLICYTYPE_MASTER WHERE   COREAPP_CODE = ? AND BRANCH_CODE = ? )
POLICY_APPCODE_COUNT_EDIT = select count(*) from MOTOR_POLICYTYPE_MASTER where COREAPP_CODE=? AND STATUS='Y'  AND BRANCH_CODE=? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_POLICYTYPE_MASTER WHERE   COREAPP_CODE = ? AND BRANCH_CODE = ?  AND POLICYTYPE_ID !=?) AND POLICYTYPE_ID !=?

##Model master
GET_MOTOR_MAKE_LIST = select MAKE_ID,MAKE_NAME,MAKE_NAME_ARABIC,CORE_CODE,(CASE WHEN STATUS='Y' THEN 'Active' ELSE 'InActive' END) from MOTOR_MAKE_MASTER mm where branch_code=?  and amend_id = (select max(amend_id) from MOTOR_MAKE_MASTER where branch_code=mm.branch_code and make_id=mm.make_id ) order by MAKE_NAME asc
GET_MOTOR_MODEL_LIST = SELECT   MDM.MODEL_ID, MDM.MAKE_ID, MDM.MODEL_NAME, MDM.MODEL_NAME_ARABIC, MDM.CORE_CODE, MDM.MODEL_NAME_ARABIC, MDM.REFERRAL_STATUS, MMM.MAKE_ID, MMM.MAKE_NAME, (case MDM.STATUS when  'Y' then  'Active' when 'N' then 'DeActive' end)  STATUS FROM   MOTOR_MODEL_MASTER MDM, MOTOR_MAKE_MASTER MMM WHERE       MDM.MAKE_ID = MMM.MAKE_ID AND MDM.BRANCH_CODE = ? AND MDM.MAKE_ID = ? AND MDM.BRANCH_CODE = MMM.BRANCH_CODE AND MMM.AMEND_ID IN (SELECT   MAX (AMEND_ID) FROM   MOTOR_MAKE_MASTER M WHERE   BRANCH_CODE = ? AND M.MAKE_ID = MDM.MAKE_ID) AND MDM.amend_id = (SELECT   MAX (AMEND_ID) FROM   MOTOR_MODEL_MASTER M WHERE   MDM.BRANCH_CODE = M.BRANCH_CODE AND MODEL_ID = MDM.MODEL_ID) ORDER BY   MODEL_ID ASC
GET_MOTOR_MODEL_CONFIG_EDIT = SELECT   MODEL_ID, MAKE_ID, MODEL_NAME, MODEL_NAME_ARABIC, CORE_CODE, convert(varchar(10),EFFECTIVEDATE,103) EFFECTIVE_DATE, STATUS, BODY_ID, REFERRAL_STATUS, CATEGORY_ID, REMARKS FROM   MOTOR_MODEL_MASTER mm WHERE   BRANCH_CODE \= ? AND MAKE_ID \= ? AND MODEL_ID \= ? AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_MODEL_MASTER WHERE       BRANCH_CODE \= mm.branch_code AND MAKE_ID \= mm.make_id AND MODEL_ID \= mm.model_id) 
INSERT_MODEL_CONFIG=INSERT INTO MOTOR_MODEL_MASTER(BRANCH_CODE,MODEL_NAME,MODEL_NAME_ARABIC,BODY_ID,CORE_CODE,CATEGORY_ID,EFFECTIVE_DATE,STATUS,REFERRAL_STATUS,REMARKS,AMEND_ID,MODEL_ID,MAKE_ID) VALUES(?,?,?,?,?,?,CONVERT(DATE,?,103),?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_MODEL_MASTER WHERE CORE_CODE=? AND BRANCH_CODE=?),(SELECT ISNULL(MAX(MODEL_ID),0)+1 FROM MOTOR_MODEL_MASTER WHERE BRANCH_CODE=?),?)
INSERT_MODEL_CONFIG_EDIT = INSERT INTO MOTOR_MODEL_MASTER(BRANCH_CODE,MODEL_NAME,MODEL_NAME_ARABIC,BODY_ID,CORE_CODE,CATEGORY_ID,EFFECTIVE_DATE,STATUS,REFERRAL_STATUS,REMARKS,AMEND_ID,MODEL_ID,MAKE_ID) VALUES(?,?,?,?,?,?,CONVERT(DATE,?,103),?,?,?,(SELECT ISNULL(MAX(AMEND_ID),0)+1 FROM MOTOR_MODEL_MASTER WHERE CORE_CODE=? AND BRANCH_CODE=?),?,?)
UPDATE_MODEL_CONFIG=UPDATE MOTOR_MODEL_MASTER SET MODEL_NAME\=?,MODEL_NAME_ARABIC\=?,BODY_ID\=?,CORE_CODE\=?,CATEGORY_ID\=?,EFFECTIVE_DATE\=CONVERT(DATE,?,103),STATUS\=?,REFERRAL_STATUS\=?,REMARKS\=? WHERE MODEL_ID\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_MODEL_MASTER WHERE MODEL_ID\=? and BRANCH_CODE\=?)
CHK_MODEL_DUBLICATION = SELECT COUNT(*) FROM MOTOR_MODEL_MASTER WHERE CORE_CODE=? AND STATUS ='Y'  AND BRANCH_CODE=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_MODEL_MASTER WHERE CORE_CODE=? AND BRANCH_CODE=?)
CHK_MODEL_DUBLICATION_EDIT = SELECT COUNT(*) FROM MOTOR_MODEL_MASTER WHERE CORE_CODE=? AND STATUS ='Y'  AND BRANCH_CODE=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_MODEL_MASTER WHERE CORE_CODE=? AND BRANCH_CODE=? AND MODEL_ID !=?) AND MODEL_ID!=?
GET_MODEL_LIST = select MAKE_ID,MAKE_NAME,MAKE_NAME_ARABIC,CORE_CODE,(CASE WHEN STATUS='Y' THEN 'Active' ELSE 'InActive' END) from MOTOR_MAKE_MASTER mm where branch_code=?  and amend_id = (select max(amend_id) from MOTOR_MAKE_MASTER where branch_code=mm.branch_code and make_id=mm.make_id ) order by MAKE_NAME asc
#Admin Report
GET_ADMIN_REPORTS=SELECT COUNT(LOGIN_ID) LOGINID,COUNT(POLICY_NO) POLICYNO,SUM(ISNULL(OVERALL_PREMIUM,0)) PREMIUM,SUM(ISNULL(COMMISSION,0)) COMMISSION FROM HOME_POSITION_MASTER A WHERE (case  WHEN 'ALL' THEN 'ALL' ELSE LOGIN_ID END) IN (case WHEN 'ALL' THEN 'ALL' ELSE ? END) AND (INCEPTION_DATE) BETWEEN CONVERT(DATE,?,103) AND CONVERT(DATE,?,103)+1 AND PRODUCT_ID IN (?) AND STATUS\='P' AND LOGIN_ID IN(SELECT LOGIN_ID FROM LOGIN_MASTER WHERE OA_CODE IN(SELECT AGENCY_CODE FROM BROKER_COMPANY_MASTER WHERE BRANCH_CODE IN(?)))
GET_ADMIN_POLICY_REPORT=SELECT A.CUSTOMER_ID,A.POLICY_NO,TO_CHAR((CASE WHEN A.PRODUCT_ID\=? THEN A.EFFECTIVE_DATE ELSE A.INCEPTION_DATE END),'dd/MM/yyyy') INCEPTION_DATE,A.OVERALL_PREMIUM ,A.REMARKS,A.LOGIN_ID,A.QUOTE_NO,A.DEBIT_NOTE_NO,ISNULL(B.COMPANY_NAME,B.FIRST_NAME) FIRST_NAME, A.LOGIN_ID,A.COMMISSION,ISNULL(A.PAYMENT_MODE,'Nil') PAYMENT_MODE,A.INCEPTION_DATE EFFECTIVE_DATE ,CONVERT(VARCHAR,A.EXPIRY_DATE,103)                      EXPIRYDATE,FN_GET_MOT_PROD_NAME(A.PRODUCT_ID, A.SCHEME_ID, A.QUOTE_NO,POM.PRODUCT_NAME ) PRODUCT_NAME ,ISNULL(PM.BROKER_ID,'Home') BROKER_ID FROM HOME_POSITION_MASTER A,PERSONAL_INFO B,HOME_PRODUCT_MASTER PM,PRODUCT_MASTER POM  WHERE (A.INCEPTION_DATE)  BETWEEN CONVERT(DATE,?,103) AND CONVERT(DATE,?,103)+1 AND A.PRODUCT_ID IN (?) AND (case  WHEN 'ALL' THEN 'ALL' ELSE LOGIN_ID END) IN (case WHEN 'ALL' THEN 'ALL' ELSE ? END) AND  A.STATUS\='P' AND A.PRODUCT_ID IN (?) AND A.CUSTOMER_ID\=B.CUSTOMER_ID AND PM.PRODUCT_ID \= A.PRODUCT_ID AND PM.PRODUCT_ID\=POM.PRODUCT_ID AND A.BRANCH_CODE\=POM.BRANCH_CODE   ORDER BY  A.INCEPTION_DATE DESC

##<!--Motor Admin Master Start -->
#Motor New Admin
##Sub Policy Type /Comprehensive Rate Master
GET_POLICY_TYPE_LIST_ADMIN = SELECT POLICYTYPE_DESC_ENGLISH, POLICY_SUBTYPE_ID FROM MOTOR_POLICYTYPE_MASTER MPM WHERE STATUS = 'Y' AND AMEND_ID = (SELECT MAX (AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID = MPM.POLICY_SUBTYPE_ID) AND BRANCH_CODE =? ORDER BY POLICYTYPE_DESC_ENGLISH
##GET_SUB_POLICY_TYPE_LIST = SELECT   MSM.SUB_RATE_ID,MSM.AGE_OF_VEHICLE_START,MSM.AGE_OF_VEHICLE_END,(Select to_char(wm_concat(COUNTRY_NAME)) from Motor_MFG_Country_master where Decode(COUNTRY_APPLICABLE,'999','A',COUNTRY_CODE) in (SELECT Decode(COUNTRY_APPLICABLE,'999','A',(REGEXP_SUBSTR(COUNTRY_APPLICABLE,'[^,]+',1,LEVEL))) FROM dual B CONNECT BY LEVEL <= LENGTH(COUNTRY_APPLICABLE) - LENGTH(REPLACE(COUNTRY_APPLICABLE,',',''))+1)) COUNTRY_APPLICABLE, MSM.CITY_APPLICABLE, MSM.CLAIMS_START, MSM.CLAIMS_END, MSM.STATUS, TO_CHAR (MSM.ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE, TO_CHAR (MSM.EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, MSM.REMARKS, MSM.DESCRIPTION FROM   MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE   MSM.POLICY_SUBTYPE_ID = ? AND MSM.BODY_TYPE_ID = ? and amend_id=(Select max(Amend_id) from MOTOR_SUBPOLICYTYPE_MASTER MS  Where MSM.POLICY_SUBTYPE_ID=MS.POLICY_SUBTYPE_ID and MSM.BODY_TYPE_ID=MS.BODY_TYPE_ID and MSM.AGE_OF_VEHICLE_START=MS.AGE_OF_VEHICLE_START and MSM.AGE_OF_VEHICLE_END=MS.AGE_OF_VEHICLE_END and MSM.COUNTRY_APPLICABLE=MS.COUNTRY_APPLICABLE and MSM.CITY_APPLICABLE=MS.CITY_APPLICABLE and MSM.CLAIMS_START=MS.CLAIMS_START and MSM.CLAIMS_END=MS.CLAIMS_END)
#####(12-01-2017)#####GET_SUB_POLICY_TYPE_LIST = SELECT   MSM.SUB_RATE_ID,MSM.AGE_OF_VEHICLE_START,MSM.AGE_OF_VEHICLE_END, MSM.CITY_APPLICABLE, MSM.CLAIMS_START, MSM.CLAIMS_END, MSM.STATUS, convert (varchar(10),MSM.ENTRY_DATE, 103) ENTRY_DATE, convert (varchar(10),MSM.EFFECTIVE_DATE, 103) EFFECTIVE_DATE, MSM.REMARKS, MSM.DESCRIPTION FROM   MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE   MSM.POLICY_SUBTYPE_ID = ? AND MSM.BODY_TYPE_ID = ? and amend_id=(Select max(Amend_id) from MOTOR_SUBPOLICYTYPE_MASTER MS  Where MSM.POLICY_SUBTYPE_ID=MS.POLICY_SUBTYPE_ID and MSM.BODY_TYPE_ID=MS.BODY_TYPE_ID and MSM.AGE_OF_VEHICLE_START=MS.AGE_OF_VEHICLE_START and MSM.AGE_OF_VEHICLE_END=MS.AGE_OF_VEHICLE_END and MSM.COUNTRY_APPLICABLE=MS.COUNTRY_APPLICABLE and MSM.CITY_APPLICABLE=MS.CITY_APPLICABLE and MSM.CLAIMS_START=MS.CLAIMS_START and MSM.CLAIMS_END=MS.CLAIMS_END)
###GET_SUB_POLICY_TYPE_LIST = SELECT   MSM.SUB_RATE_ID,MSM.AGE_OF_VEHICLE_START,MSM.AGE_OF_VEHICLE_END, MSM.CITY_APPLICABLE,MSM.COUNTRY_APPLICABLE, MSM.CLAIMS_START, MSM.CLAIMS_END, (CASE MSM.STATUS WHEN 'Y' THEN 'Active' ELSE 'De Active' END) STATUS , convert (varchar(10),MSM.ENTRY_DATE, 103) ENTRY_DATE, convert (varchar(10),MSM.EFFECTIVE_DATE, 103) EFFECTIVE_DATE, MSM.REMARKS, MSM.DESCRIPTION, MSM.VEHICLE_COUNT  FROM   MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE   MSM.POLICY_SUBTYPE_ID = ? AND MSM.BODY_TYPE_ID = ? and amend_id=(Select max(Amend_id) from MOTOR_SUBPOLICYTYPE_MASTER MS  Where MSM.POLICY_SUBTYPE_ID=MS.POLICY_SUBTYPE_ID and MSM.BODY_TYPE_ID=MS.BODY_TYPE_ID and MSM.AGE_OF_VEHICLE_START=MS.AGE_OF_VEHICLE_START and MSM.AGE_OF_VEHICLE_END=MS.AGE_OF_VEHICLE_END and MSM.COUNTRY_APPLICABLE=MS.COUNTRY_APPLICABLE and MSM.CLAIMS_START=MS.CLAIMS_START and MSM.CLAIMS_END=MS.CLAIMS_END)
GET_SUB_POLICY_TYPE_LIST = SELECT   MSM.SUB_RATE_ID,MSM.AGE_OF_VEHICLE_START,MSM.AGE_OF_VEHICLE_END, MSM.CITY_APPLICABLE,substring((Select ','+mfg.country_name  AS [text()]  From MOTOR_MFG_COUNTRY_MASTER mfg, (select * from FN_Split_SV(MSM.COUNTRY_APPLICABLE,',')) s2 Where mfg.COUNTRY_CODE = s2.item and mfg.amend_id=(select max(amend_id) from   MOTOR_MFG_COUNTRY_MASTER  where  mfg.country_code=country_code) ORDER BY mfg.country_name  For XML PATH ('') ), 2, 1000) country_applicable , MSM.CLAIMS_START, MSM.CLAIMS_END, (CASE MSM.STATUS WHEN 'Y' THEN 'Active' ELSE 'De Active' END) STATUS , convert (varchar(10),MSM.ENTRY_DATE, 103) ENTRY_DATE, convert (varchar(10),MSM.EFFECTIVE_DATE, 103) EFFECTIVE_DATE, MSM.REMARKS, MSM.DESCRIPTION, MSM.VEHICLE_COUNT FROM MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE   MSM.POLICY_SUBTYPE_ID = ? AND MSM.BODY_TYPE_ID = ? and amend_id=(Select max(Amend_id) from MOTOR_SUBPOLICYTYPE_MASTER MS  Where MSM.POLICY_SUBTYPE_ID=MS.POLICY_SUBTYPE_ID and MSM.BODY_TYPE_ID=MS.BODY_TYPE_ID and MSM.AGE_OF_VEHICLE_START=MS.AGE_OF_VEHICLE_START and MSM.AGE_OF_VEHICLE_END=MS.AGE_OF_VEHICLE_END and MSM.COUNTRY_APPLICABLE=MS.COUNTRY_APPLICABLE and MSM.CLAIMS_START=MS.CLAIMS_START and MSM.CLAIMS_END=MS.CLAIMS_END)
GET_VEHICLE_APPLICABLE_COUNTRY_LIST = SELECT COUNTRY_CODE,COUNTRY_NAME FROM MOTOR_MFG_COUNTRY_MASTER WHERE BRANCH_CODE\=? AND STATUS\='Y'
GET_VEHICLE_APPLICABLE_CITY_LIST = SELECT COUNTRY_CODE,COUNTRY_NAME FROM MOTOR_MFG_COUNTRY_MASTER WHERE BRANCH_CODE\=? AND STATUS \='Y'
#####(16-04-2016)##### GET_COMPREHENSIVE_RATE_LIST = SELECT  MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,Convert(varchar(10),CONVERT(date,MTRM.POLICY_START_DATE,106),103) POLICY_START_DATE,Convert(varchar(10),CONVERT(date,MTRM.EFFECTIVE_DATE,106),103) POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,(CASE  MTRM.STATUS WHEN  '' THEN  'Active' ELSE  'De Active' END) STATUS,Convert(varchar(10),MTRM.ENTRY_DATE,103) ENTRY_DATE,Convert(varchar(10),MTRM.EFFECTIVE_DATE,103) EFFECTIVE_DATE,MTRM.REMARKS  FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT   MAX (AMEND_ID)FROM   MOTOR_TYPE_RATE_MASTER MT WHERE   SUB_RATE_ID \= MTRM.SUB_RATE_ID and MTRM.AGENCY_CODE \=MT.AGENCY_CODE  and MTRM.SEATING_TON_START \=MT.SEATING_TON_START and MTRM.SEATING_TON_END \=MT.SEATING_TON_END and MTRM.CC_GVW_START_RANGE \=MT.CC_GVW_START_RANGE and MTRM.CC_GVW_END_RANGE \=MT.CC_GVW_END_RANGE and MTRM.UAE_LISCENCE_START \=MT.UAE_LISCENCE_START and MTRM.UAE_LISCENCE_END \=MT.UAE_LISCENCE_END and MTRM.DRIVER_AGE_FROM \=MT.DRIVER_AGE_FROM and MTRM.DRIVER_AGE_TO \=MT.DRIVER_AGE_TO and MTRM.SUMINSURED_START \=MT.SUMINSURED_START and MTRM.SUMINSURED_END \=MT.SUMINSURED_END )
GET_COMPREHENSIVE_RATE_LIST = SELECT  MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,Convert(varchar(10),CONVERT(date,MTRM.POLICY_START_DATE,106),103) POLICY_START_DATE,Convert(varchar(10),CONVERT(date,MTRM.EFFECTIVE_DATE,106),103) POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,(CASE  MTRM.STATUS WHEN  'Y' THEN  'Active' ELSE  'De Active' END) STATUS,Convert(varchar(10),MTRM.ENTRY_DATE,103) ENTRY_DATE,Convert(varchar(10),MTRM.EFFECTIVE_DATE,103) EFFECTIVE_DATE,MTRM.REMARKS,CASE MTRM.AGENCY_CODE WHEN '99999' THEN 'All Brokers' ELSE (select LG.USERNAME from login_master LG where MTRM.AGENCY_CODE = LG.AGENCY_CODE ) END AS USERNAME  FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID =? AND MTRM.AMEND_ID = (SELECT   MAX (AMEND_ID)FROM   MOTOR_TYPE_RATE_MASTER MT WHERE   SUB_RATE_ID = MTRM.SUB_RATE_ID and MTRM.AGENCY_CODE =MT.AGENCY_CODE  and MTRM.SEATING_TON_START =MT.SEATING_TON_START and MTRM.SEATING_TON_END =MT.SEATING_TON_END and MTRM.CC_GVW_START_RANGE =MT.CC_GVW_START_RANGE and MTRM.CC_GVW_END_RANGE =MT.CC_GVW_END_RANGE and MTRM.UAE_LISCENCE_START =MT.UAE_LISCENCE_START and MTRM.UAE_LISCENCE_END =MT.UAE_LISCENCE_END and MTRM.DRIVER_AGE_FROM =MT.DRIVER_AGE_FROM and MTRM.DRIVER_AGE_TO =MT.DRIVER_AGE_TO and MTRM.SUMINSURED_START =MT.SUMINSURED_START and MTRM.SUMINSURED_END =MT.SUMINSURED_END )
GET_USERNAME_LOGIN_DRPDWN  = select agency_code,username from login_master Where usertype='Broker' and agency_code not in (select distinct agency_code from MOTOR_TYPE_RATE_MASTER) union all select '99999','All Brokers' From dual order by agency_code desc
GET_USERNAME_LOGIN_DRPDWNN = select agency_code,username from login_master Where usertype\='Broker' and agency_code not in (select distinct agency_code from MOTOR_TYPE_THIRD_PARTY) union all select '99999','All Brokers' From dual order by agency_code desc   
GET_USERNAME_LOGIN_DRPDWNN_EDIT = select agency_code,username from login_master Where usertype='Broker' union all select '99999','All Brokers' From dual order by agency_code desc


GET_COMP_COUNTRY_MASTER = select COUNTRY_CODE,COUNTRY_NAME from motor_mfg_country_master where branch_code=?

CHECK_POLICY_DATE = SELECT   COUNT(*) FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= ( SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID \= MTRM.SUB_RATE_ID) and  (Convert(DATE,?,103) BETWEEN convert(date,MTRM.POLICY_START_DATE,103) AND convert(date,MTRM.POLICY_END_DATE,103)) OR (Convert(DATE,?,103) BETWEEN CONVERT(DATE,MTRM.POLICY_START_DATE,103) AND convert(date,MTRM.POLICY_END_DATE,103)) AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \=MTRM.RATE_ID) AND STATUS\='Y' 
CHECK_VEHICLE_AGE = SELECT COUNT(*) FROM MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE  MSM.POLICY_SUBTYPE_ID\=? AND MSM.BODY_TYPE_ID\=? AND  ((? BETWEEN MSM.AGE_OF_VEHICLE_START AND MSM.AGE_OF_VEHICLE_END) OR (? BETWEEN MSM.AGE_OF_VEHICLE_START AND MSM.AGE_OF_VEHICLE_END)) AND AMEND_ID \=(SELECT MAX(AMEND_ID) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID \=MSM.SUB_RATE_ID)
GET_MOTOR_BODY_TYPE_ADMIN = SELECT TYPE_OF_BODY_ID,TYPE_OF_BODY_NAME,AMEND_ID FROM MOTOR_BODYTYPE_DETAIL MB WHERE VTYPE_ID=? AND STATUS='Y' AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL mbd WHERE mbd.TYPE_OF_BODY_ID=MB.TYPE_OF_BODY_ID and mbd.VTYPE_ID=mb.VTYPE_ID ) ORDER BY TYPE_OF_BODY_NAME
GET_MOTOR_BODY_TYPE_WTVT = SELECT BODY_ID TYPE_OF_BODY_ID, BODY_NAME TYPE_OF_BODY_NAME FROM MOTOR_BODYTYPE_MASTER MB WHERE STATUS='Y' AND AMEND_ID IN (SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_MASTER WHERE BODY_ID=MB.BODY_ID) ORDER BY BODY_NAME
## pending CHECK_VEHICLE_CLAIM_MODAL = SELECT   (Select POLICYTYPE_DESC_ENGLISH From MOTOR_POLICYTYPE_MASTER MPM WHERE MPM.POLICY_SUBTYPE_ID\=MSM.POLICY_SUBTYPE_ID) POLICY_SUBTYPE_ID,( select TYPE_OF_BODY_NAME From MOTOR_BODYTYPE_DETAIL  MTBM Where MTBM.TYPE_OF_BODY_ID\=MSM.BODY_TYPE_ID) BODY_TYPE_ID , SUB_RATE_ID, AGE_OF_VEHICLE_START, AGE_OF_VEHICLE_END, ( Select to_char(Replace(wm_concat(COUNTRY_NAME),',',', ')) from Motor_MFG_Country_master where Decode(COUNTRY_APPLICABLE,'999','A',COUNTRY_CODE) in ( SELECT Decode(COUNTRY_APPLICABLE,'999','A',(REGEXP_SUBSTR( COUNTRY_APPLICABLE,'[^,]+',1,LEVEL))) FROM dual B CONNECT BY LEVEL <\= LENGTH(COUNTRY_APPLICABLE) - LENGTH(REPLACE( COUNTRY_APPLICABLE,',',''))+1)) COUNTRY_APPLICABLE, CITY_APPLICABLE, CLAIMS_START, CLAIMS_END, STATUS, TO_CHAR (ENTRY_DATE, 'DD/MM/YYYY') ENTRY_DATE, TO_CHAR (EFFECTIVE_DATE, 'DD/MM/YYYY') EFFECTIVE_DATE, REMARKS, DESCRIPTION FROM   MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE   POLICY_SUBTYPE_ID\=? AND BODY_TYPE_ID\=? AND  ((? BETWEEN MSM.CLAIMS_START AND MSM.CLAIMS_END) OR (? BETWEEN MSM.CLAIMS_START AND MSM.CLAIMS_END)) AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID \=MSM.SUB_RATE_ID)
GET_SUBPOLICY_HEADER_DETAILS = SELECT MPM.POLICYTYPE_DESC_ENGLISH,MVM.VEHICLETYPE_DESC,MBM.TYPE_OF_BODY_NAME FROM MOTOR_POLICYTYPE_MASTER MPM, MOTOR_VEHICLETYPE_MASTER MVM, MOTOR_BODYTYPE_DETAIL MBM WHERE MPM.POLICY_SUBTYPE_ID \=? AND MPM.STATUS\='Y' and MPM.AMEND_ID \= (select max(amend_id) from MOTOR_POLICYTYPE_MASTER PM where PM.POLICYTYPE_ID \= MPM.POLICYTYPE_ID )  AND MVM.VTYPE_ID\=? AND MVM.STATUS\='Y' AND MVM.AMEND_ID \= (select max(amend_id) from MOTOR_VEHICLETYPE_MASTER VM where VM.VTYPE_ID \= MVM.VTYPE_ID ) AND MBM.TYPE_OF_BODY_ID\=? AND MBM.STATUS\='Y' AND MBM.AMEND_ID \= (select max(amend_id) from MOTOR_BODYTYPE_DETAIL BM where BM.TYPE_OF_BODY_ID \= MBM.TYPE_OF_BODY_ID ) 
##GET_SUBPOLICY_HEADER_DETAILS \= SELECT MPM.POLICYTYPE_DESC_ENGLISH,MVM.VEHICLETYPE_DESC,MBM.TYPE_OF_BODY_NAME FROM MOTOR_POLICYTYPE_MASTER MPM, MOTOR_VEHICLETYPE_MASTER MVM, MOTOR_BODYTYPE_DETAIL MBM WHERE MPM.POLICY_SUBTYPE_ID \=? AND MPM.STATUS\='Y' AND MVM.VTYPE_ID\=? AND MVM.STATUS\='Y' AND MBM.TYPE_OF_BODY_ID\=? AND MBM.STATUS\='Y'
GET_MAX_SUBPOLICY_ID = SELECT ISNULL(MAX(SUB_RATE_ID)+1,0) FROM MOTOR_SUBPOLICYTYPE_MASTER
GET_EDIT_SUBPOLICY_AMEND = SELECT AMEND_ID FROM MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_SUBPOLICYTYPE_MASTER WHERE   SUB_RATE_ID = MSM.SUB_RATE_ID) AND SUB_RATE_ID = ? AND CONVERT(date,MSM.EFFECTIVE_DATE,103)  > convert(DATE, getdate(),103)
INS_MOTOR_SUBPOLICY = INSERT INTO MOTOR_SUBPOLICYTYPE_MASTER(POLICY_SUBTYPE_ID,BODY_TYPE_ID,SUB_RATE_ID,AMEND_ID,AGE_OF_VEHICLE_START,AGE_OF_VEHICLE_END,COUNTRY_APPLICABLE,CITY_APPLICABLE,CLAIMS_START,CLAIMS_END,STATUS,ENTRY_DATE,EFFECTIVE_DATE,REMARKS,DESCRIPTION,VEHICLE_COUNT) VALUES(?,?,?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID=?),?,?,?,?,?,?,?,convert(DATE, getdate(),103),convert(DATE,?,103),?,?,?)
GET_MOTOR_SUBPOLICY =SELECT AGE_OF_VEHICLE_START,AGE_OF_VEHICLE_END,COUNTRY_APPLICABLE,CITY_APPLICABLE,VEHICLE_COUNT,CLAIMS_START,CLAIMS_END,STATUS,Convert(varchar(10),ENTRY_DATE,103) ENTRY_DATE,Convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS,DESCRIPTION FROM  MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE  SUB_RATE_ID \= ? AND AMEND_ID\= (SELECT MAX(AMEND_ID) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID\=MSM.SUB_RATE_ID)
GET_AMEND_ID_MOTOR_SUBPOLICY = SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID=?
UPD_MOTOR_SUBPOLICY = UPDATE MOTOR_SUBPOLICYTYPE_MASTER  SET POLICY_SUBTYPE_ID = ?,BODY_TYPE_ID =?,AGE_OF_VEHICLE_START=?,AGE_OF_VEHICLE_END=?,COUNTRY_APPLICABLE=?,CITY_APPLICABLE=?,CLAIMS_START=?,CLAIMS_END=?,STATUS=?,EFFECTIVE_DATE=CONVERT(date,?,103),REMARKS=?,DESCRIPTION=?,VEHICLE_COUNT=? WHERE SUB_RATE_ID=? AND AMEND_ID = ?
CHECK_SUB_POLICY_COMBINATION = SELECT COUNT(*) FROM MOTOR_SUBPOLICYTYPE_MASTER MSM WHERE POLICY_SUBTYPE_ID \= ? AND BODY_TYPE_ID \= ? AND ((? BETWEEN MSM.AGE_OF_VEHICLE_START AND MSM.AGE_OF_VEHICLE_END) OR (? BETWEEN MSM.AGE_OF_VEHICLE_START AND MSM.AGE_OF_VEHICLE_END)) AND VEHICLE_COUNT \= ? AND STATUS\='Y' AND AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_SUBPOLICYTYPE_MASTER WHERE SUB_RATE_ID \= MSM.SUB_RATE_ID)

CHECK_SEATING_TON = SELECT   MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,Convert(varchar(10),MTRM.POLICY_START_DATE,103) POLICY_START_DATE,Convert(varchar(10),MTRM.POLICY_END_DATE,103) POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,MTRM.STATUS,Convert(varchar(10),MTRM.ENTRY_DATE,103) ENTRY_DATE,Convert(varchar(10),MTRM.EFFECTIVE_DATE,103) EFFECTIVE_DATE,MTRM.REMARKS FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID \= MTRM.SUB_RATE_ID AND MTRM.AGENCY_CODE \= MT.AGENCY_CODE AND MTRM.SEATING_TON_START \= MT.SEATING_TON_START AND MTRM.SEATING_TON_END \= MT.SEATING_TON_END AND MTRM.CC_GVW_START_RANGE \= MT.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE \= MT.CC_GVW_END_RANGE AND MTRM.UAE_LISCENCE_START \= MT.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END \= MT.UAE_LISCENCE_END AND MTRM.DRIVER_AGE_FROM \= MT.DRIVER_AGE_FROM AND MTRM.DRIVER_AGE_TO \= MT.DRIVER_AGE_TO AND MTRM.SUMINSURED_START \= MT.SUMINSURED_START AND MTRM.SUMINSURED_END \= MT.SUMINSURED_END) and  ((? BETWEEN MTRM.SEATING_TON_START AND MTRM.SEATING_TON_END) OR (? BETWEEN MTRM.SEATING_TON_START AND MTRM.SEATING_TON_END)) AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \=MTRM.RATE_ID)
CHECK_CCGVWRANGE= SELECT   MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,Convert(varchar(10),MTRM.POLICY_START_DATE,103)  POLICY_START_DATE,Convert(varchar(10),MTRM.POLICY_END_DATE,103) POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,MTRM.STATUS, Convert(varchar(10),MTRM.ENTRY_DATE,103) ENTRY_DATE,Convert(varchar(10),MTRM.EFFECTIVE_DATE,103)  EFFECTIVE_DATE,MTRM.REMARKS FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID \= MTRM.SUB_RATE_ID AND MTRM.AGENCY_CODE \= MT.AGENCY_CODE AND MTRM.SEATING_TON_START \= MT.SEATING_TON_START AND MTRM.SEATING_TON_END \= MT.SEATING_TON_END AND MTRM.CC_GVW_START_RANGE \= MT.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE \= MT.CC_GVW_END_RANGE AND MTRM.UAE_LISCENCE_START \= MT.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END \= MT.UAE_LISCENCE_END AND MTRM.DRIVER_AGE_FROM \= MT.DRIVER_AGE_FROM AND MTRM.DRIVER_AGE_TO \= MT.DRIVER_AGE_TO AND MTRM.SUMINSURED_START \= MT.SUMINSURED_START AND MTRM.SUMINSURED_END \= MT.SUMINSURED_END) and  ((? BETWEEN MTRM.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE) OR (? BETWEEN MTRM.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE)) AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \=MTRM.RATE_ID)
CHECK_UAE_LISCENCE = SELECT   MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,Convert(varchar(10),MTRM.POLICY_START_DATE,103) POLICY_START_DATE,Convert(varchar(10),MTRM.POLICY_END_DATE,103) POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,MTRM.STATUS,  Convert(varchar(10),MTRM.ENTRY_DATE,103) ENTRY_DATE,Convert(varchar(10),MTRM.EFFECTIVE_DATE,103) EFFECTIVE_DATE,MTRM.REMARKS FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID \= MTRM.SUB_RATE_ID AND MTRM.AGENCY_CODE \= MT.AGENCY_CODE AND MTRM.SEATING_TON_START \= MT.SEATING_TON_START AND MTRM.SEATING_TON_END \= MT.SEATING_TON_END AND MTRM.CC_GVW_START_RANGE \= MT.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE \= MT.CC_GVW_END_RANGE AND MTRM.UAE_LISCENCE_START \= MT.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END \= MT.UAE_LISCENCE_END AND MTRM.DRIVER_AGE_FROM \= MT.DRIVER_AGE_FROM AND MTRM.DRIVER_AGE_TO \= MT.DRIVER_AGE_TO AND MTRM.SUMINSURED_START \= MT.SUMINSURED_START AND MTRM.SUMINSURED_END \= MT.SUMINSURED_END) AND ((? BETWEEN MTRM.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END) OR (? BETWEEN MTRM.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END))  AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \=MTRM.RATE_ID)
CHECK_SUM_INSURED = SELECT   MTRM.RATE_ID,MTRM.SEATING_TON_START,MTRM.SEATING_TON_END,MTRM.CC_GVW_START_RANGE,MTRM.CC_GVW_END_RANGE,MTRM.UAE_LISCENCE_START,MTRM.UAE_LISCENCE_END,MTRM.DRIVER_AGE_FROM,MTRM.DRIVER_AGE_TO,MTRM.SUMINSURED_START,MTRM.SUMINSURED_END,Convert(varchar(10),MTRM.POLICY_START_DATE,103) POLICY_START_DATE,Convert(varchar(10),MTRM.POLICY_END_DATE,103) POLICY_END_DATE,MTRM.MOTOR_RATE,MTRM.MINIMUM_PREMIUM,MTRM.ONLINE_PERCENT,MTRM.DEDUCTION_PERCENT,MTRM.DEDUCTION_AMOUNT,MTRM.DEDUCTION_DESC,MTRM.STATUS,Convert(varchar(10),MTRM.ENTRY_DATE,103) ENTRY_DATE,Convert(varchar(10),MTRM.EFFECTIVE_DATE,103) EFFECTIVE_DATE,MTRM.REMARKS FROM   MOTOR_TYPE_RATE_MASTER MTRM WHERE   MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_RATE_MASTER MT WHERE       SUB_RATE_ID \= MTRM.SUB_RATE_ID AND MTRM.AGENCY_CODE \= MT.AGENCY_CODE AND MTRM.SEATING_TON_START \= MT.SEATING_TON_START AND MTRM.SEATING_TON_END \= MT.SEATING_TON_END AND MTRM.CC_GVW_START_RANGE \= MT.CC_GVW_START_RANGE AND MTRM.CC_GVW_END_RANGE \= MT.CC_GVW_END_RANGE AND MTRM.UAE_LISCENCE_START \= MT.UAE_LISCENCE_START AND MTRM.UAE_LISCENCE_END \= MT.UAE_LISCENCE_END AND MTRM.DRIVER_AGE_FROM \= MT.DRIVER_AGE_FROM AND MTRM.DRIVER_AGE_TO \= MT.DRIVER_AGE_TO AND MTRM.SUMINSURED_START \= MT.SUMINSURED_START AND MTRM.SUMINSURED_END \= MT.SUMINSURED_END) AND ((? BETWEEN MTRM.SUMINSURED_START AND MTRM.SUMINSURED_END) OR (? BETWEEN MTRM.SUMINSURED_START AND MTRM.SUMINSURED_END)) AND AMEND_ID \=( SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \=MTRM.RATE_ID)
GET_MAX_MOTOR_COMPRE_RATE_ID = SELECT ISNULL(MAX(SUB_RATE_ID)+1,0) FROM MOTOR_TYPE_RATE_MASTER
GET_EDIT_COMPRERATE_AMEND = SELECT AMEND_ID FROM MOTOR_TYPE_RATE_MASTER MTRM WHERE MTRM.RATE_ID \= ? AND MTRM.SUB_RATE_ID \= ? AND MTRM.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \= MTRM.RATE_ID) AND  CONVERT(date,MTRM.EFFECTIVE_DATE,106)  > convert(DATE, getdate(),106)
#####(16-04-2016)##### INS_COMPRE_RATE = INSERT INTO  MOTOR_TYPE_RATE_MASTER (SUB_RATE_ID,RATE_ID,AMEND_ID,AGENCY_CODE,SEATING_TON_START,SEATING_TON_END,CC_GVW_START_RANGE,CC_GVW_END_RANGE,UAE_LISCENCE_START,UAE_LISCENCE_END,DRIVER_AGE_FROM,DRIVER_AGE_TO, SUMINSURED_START,SUMINSURED_END,POLICY_START_DATE,POLICY_END_DATE, MOTOR_RATE,MINIMUM_PREMIUM,ONLINE_PERCENT,DEDUCTION_PERCENT, DEDUCTION_AMOUNT,DEDUCTION_DESC,STATUS,ENTRY_DATE,EFFECTIVE_DATE,REMARKS ) VALUES(?,?,(SELECT isnull(MAX(AMEND_ID)+1,0) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID=?),( SELECT LM.AGENCY_CODE FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID =?),?,?,?,?,?,?,?,?,?,?,CONVERT(DATE,?,103),CONVERT(DATE,?,103),?,?,?,?,?,?,?,convert(DATE, getdate(),103),CONVERT(DATE,?,103),?)
INS_COMPRE_RATE = INSERT INTO  MOTOR_TYPE_RATE_MASTER (SUB_RATE_ID,RATE_ID,AMEND_ID,SEATING_TON_START,SEATING_TON_END,CC_GVW_START_RANGE,CC_GVW_END_RANGE,UAE_LISCENCE_START,UAE_LISCENCE_END,DRIVER_AGE_FROM,DRIVER_AGE_TO, SUMINSURED_START,SUMINSURED_END,POLICY_START_DATE,POLICY_END_DATE, MOTOR_RATE,MINIMUM_PREMIUM,ONLINE_PERCENT,DEDUCTION_PERCENT, DEDUCTION_AMOUNT,DEDUCTION_DESC,STATUS,ENTRY_DATE,EFFECTIVE_DATE,REMARKS,AGENCY_CODE ) VALUES(?,?,(SELECT isnull(MAX(AMEND_ID)+1,0) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID=?),?,?,?,?,?,?,?,?,?,?,CONVERT(DATE,?,103), CONVERT(DATE,?,103),?,?,?,?,?,?,?,convert(DATE, getdate(),103),CONVERT(DATE,?,103),?,?)
GET_AMEND_ID_MOTOR_COMPRE_RATE = SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_TYPE_RATE_MASTER WHERE SUB_RATE_ID\=?
#####(16-04-2016)##### EDIT_COMPRE_RATE = SELECT SUB_RATE_ID,RATE_ID,AMEND_ID,AGENCY_CODE,SEATING_TON_START,SEATING_TON_END,CC_GVW_START_RANGE,CC_GVW_END_RANGE,UAE_LISCENCE_START,UAE_LISCENCE_END,DRIVER_AGE_FROM,DRIVER_AGE_TO,SUMINSURED_START,SUMINSURED_END,Convert(varchar(10),MTRM.POLICY_START_DATE,103) POLICY_START_DATE,Convert(varchar(10),MTRM.POLICY_END_DATE,103) POLICY_END_DATE,MOTOR_RATE,MINIMUM_PREMIUM,ONLINE_PERCENT,DEDUCTION_PERCENT,DEDUCTION_AMOUNT,DEDUCTION_DESC,STATUS,Convert(varchar(10),MTRM.ENTRY_DATE,103) ENTRY_DATE,Convert(varchar(10),MTRM.EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS FROM MOTOR_TYPE_RATE_MASTER MTRM WHERE MTRM.RATE_ID \= ? AND MTRM.SUB_RATE_ID \=? AND MTRM.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \= MTRM.RATE_ID)
EDIT_COMPRE_RATE = SELECT SUB_RATE_ID,RATE_ID,AMEND_ID,AGENCY_CODE,SEATING_TON_START,SEATING_TON_END,CC_GVW_START_RANGE,CC_GVW_END_RANGE,UAE_LISCENCE_START,UAE_LISCENCE_END,DRIVER_AGE_FROM,DRIVER_AGE_TO,SUMINSURED_START,SUMINSURED_END,Convert(varchar(10),MTRM.POLICY_START_DATE,103) POLICY_START_DATE,Convert(varchar(10),MTRM.POLICY_END_DATE,103) POLICY_END_DATE,MOTOR_RATE,MINIMUM_PREMIUM,ONLINE_PERCENT,DEDUCTION_PERCENT,DEDUCTION_AMOUNT,DEDUCTION_DESC,STATUS,Convert(varchar(10),MTRM.ENTRY_DATE,103) ENTRY_DATE,Convert(varchar(10),MTRM.EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS FROM MOTOR_TYPE_RATE_MASTER MTRM WHERE MTRM.RATE_ID \= ? AND MTRM.SUB_RATE_ID \=? AND MTRM.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_RATE_MASTER WHERE RATE_ID \= MTRM.RATE_ID)
#####(16-04-2016)##### UPD_COMPRE_RATE = UPDATE MOTOR_TYPE_RATE_MASTER  SET AGENCY_CODE\=(SELECT LM.AGENCY_CODE FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID \=?),SEATING_TON_START\=?,SEATING_TON_END\=?,CC_GVW_START_RANGE\=?,CC_GVW_END_RANGE\=?,UAE_LISCENCE_START\=?, UAE_LISCENCE_END\=?,DRIVER_AGE_FROM\=?,DRIVER_AGE_TO\=?,SUMINSURED_START\=?,SUMINSURED_END\=?,POLICY_START_DATE\=CONVERT(DATE,?,103),POLICY_END_DATE\=CONVERT(DATE,?,103),MOTOR_RATE\=?, MINIMUM_PREMIUM\=?,ONLINE_PERCENT\=?,DEDUCTION_PERCENT\=?,DEDUCTION_AMOUNT\=?,DEDUCTION_DESC\=?,STATUS\=?,EFFECTIVE_DATE\=CONVERT(DATE,?,103),REMARKS\=? WHERE SUB_RATE_ID \= ? AND RATE_ID\=? AND AMEND_ID \= ?
UPD_COMPRE_RATE = UPDATE MOTOR_TYPE_RATE_MASTER  SET SEATING_TON_START\=?,SEATING_TON_END\=?,CC_GVW_START_RANGE\=?,CC_GVW_END_RANGE\=?,UAE_LISCENCE_START\=?, UAE_LISCENCE_END\=?,DRIVER_AGE_FROM\=?,DRIVER_AGE_TO\=?,SUMINSURED_START\=?,SUMINSURED_END\=?,POLICY_START_DATE\=CONVERT(DATE,?,103),POLICY_END_DATE\=CONVERT(DATE,?,103),MOTOR_RATE\=?, MINIMUM_PREMIUM\=?,ONLINE_PERCENT\=?,DEDUCTION_PERCENT\=?,DEDUCTION_AMOUNT\=?,DEDUCTION_DESC\=?,STATUS\=?,EFFECTIVE_DATE\=CONVERT(DATE,?,103),REMARKS\=?,AGENCY_CODE\=? WHERE SUB_RATE_ID \= ? AND RATE_ID\=? AND AMEND_ID \= ?
GET_VEHICLE_TYPE_DROP_DOWN = SELECT VTYPE_ID CODE,UPPER(VEHICLETYPE_DESC) CODEDESC FROM MOTOR_VEHICLETYPE_MASTER MVM  WHERE STATUS='Y' and BRANCH_CODE= ?  AND AMEND_ID  = (SELECT MAX(AMEND_ID) FROM MOTOR_VEHICLETYPE_MASTER MV WHERE  MVM.VTYPE_ID=MV.VTYPE_ID) ORDER BY VEHICLETYPE_DESC
##Make Master
##GET_MAKE_MASTER_LIST = SELECT MMM.MAKE_ID,MMM.MAKE_NAME,DECODE(MMM.STATUS,'Y','Active','N','De Active')STATUS,TO_CHAR(MMM.EFFECTIVE_DATE,'DD/MM/YYYY')EFFECTIVE_DATE ,TO_CHAR(MMM.EXPIRY_DATE,'DD/MM/YYYY')EXPIRY_DATE,MMM.REMARKS,MMM.BRANCH_CODE,MMM.MAKE_NAME_ARABIC,DECODE(MMM.REFERRAL_STATUS,'Y','Active','N','De Active')REFERRAL_STATUS,MFCM.COUNTRY_NAME FROM  MOTOR_MAKE_MASTER MMM,MOTOR_MFG_COUNTRY_MASTER MFCM WHERE MFCM.COUNTRY_ID = MMM.COUNTRY_ID AND MMM.BRANCH_CODE=? AND MMM.VTYPE_ID=? AND MMM.BODY_ID=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM  MOTOR_MAKE_MASTER WHERE MAKE_ID=MMM.MAKE_ID ) ORDER BY MMM.MAKE_ID DESC
GET_MAKE_MASTER_LIST = SELECT MMM.MAKE_ID,MMM.MAKE_NAME,(CASE MMM.STATUS WHEN 'Y' THEN 'Active' ELSE 'De Active' END) STATUS,convert(varchar(10),MMM.EFFECTIVE_DATE,103)EFFECTIVE_DATE ,convert(varchar(10),MMM.EXPIRY_DATE,103) EXPIRY_DATE,MMM.REMARKS,MMM.BRANCH_CODE,MMM.MAKE_NAME_ARABIC,(CASE REFERRAL_STATUS WHEN 'Y' THEN ' Referral' ELSE 'Non-Referral' END) REFERRAL_STATUS,MFCM.COUNTRY_NAME FROM  MOTOR_MAKE_MASTER MMM,MOTOR_MFG_COUNTRY_MASTER MFCM WHERE MFCM.COUNTRY_ID = MMM.COUNTRY_ID AND MMM.BRANCH_CODE= ? AND mmm.AMEND_ID = (SELECT MAX(AMEND_ID) FROM  MOTOR_MAKE_MASTER WHERE MAKE_ID=MMM.MAKE_ID ) ORDER BY MMM.MAKE_ID DESC
##GET_MAKE_HEADER_LIST = SELECT MVM.VEHICLETYPE_DESC,MBM.TYPE_OF_BODY_NAME FROM MOTOR_VEHICLETYPE_MASTER MVM, MOTOR_BODYTYPE_DETAIL MBM WHERE MVM.VTYPE_ID\=? AND MVM.STATUS\='Y' AND MVM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_VEHICLETYPE_MASTER WHERE VTYPE_ID\=MVM.VTYPE_ID) AND MBM.TYPE_OF_BODY_ID\=?       AND MBM.STATUS\='Y' AND MBM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL WHERE TYPE_OF_BODY_ID\=MBM.TYPE_OF_BODY_ID)
CHECK_MAKE_CORE_CODE = SELECT COUNT(*) FROM MOTOR_MAKE_MASTER WHERE CORE_CODE \= ? AND BRANCH_CODE \= ?
GET_MAX_MAKE_ID = SELECT isnull(MAX(MAKE_ID),0)+1 FROM MOTOR_MAKE_MASTER
GET_EDIT_MAKE_AMEND = SELECT  AMEND_ID FROM   MOTOR_MAKE_MASTER MMM WHERE   MAKE_ID \= ? AND AMEND_ID \= ( SELECT   MAX (AMEND_ID) FROM   MOTOR_MAKE_MASTER WHERE   MAKE_ID \= MMM.MAKE_ID) AND BRANCH_CODE \= ? AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
INS_MAKE_MASTER = INSERT INTO MOTOR_MAKE_MASTER(MAKE_ID,MAKE_NAME,STATUS,EFFECTIVE_DATE,EXPIRY_DATE,REMARKS,AMEND_ID,BRANCH_CODE,MAKE_NAME_ARABIC,REFERRAL_STATUS,COUNTRY_ID,CORE_CODE) VALUES (?,?,?,CONVERT(DATE,?,103),CONVERT(DATE,?,103),?,(SELECT isnull(MAX(AMEND_ID)+1,0) FROM MOTOR_MAKE_MASTER WHERE MAKE_ID=?),?,?,?,?,?)
EDIT_MAKE_MASTER = SELECT  MAKE_ID,MAKE_NAME,STATUS,convert(varchar(10),EFFECTIVE_DATE, 103) EFFECTIVE_DATE,convert(varchar(10),EXPIRY_DATE, 103) EXPIRY_DATE,REMARKS,MAKE_NAME_ARABIC,REFERRAL_STATUS,COUNTRY_ID,CORE_CODE FROM   MOTOR_MAKE_MASTER MMM WHERE   MAKE_ID \= ? AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_MAKE_MASTER WHERE   MAKE_ID \= MMM.MAKE_ID) AND MMM.BRANCH_CODE \= ?
UPD_MAKE_MASTER = UPDATE MOTOR_MAKE_MASTER  SET MAKE_NAME\=?,STATUS\=?,EFFECTIVE_DATE\=convert(date,?,103),EXPIRY_DATE\=convert(date,?,103),REMARKS\=?,BRANCH_CODE\=?,MAKE_NAME_ARABIC\=?,REFERRAL_STATUS\=?,COUNTRY_ID\=?,CORE_CODE\=? WHERE MAKE_ID \= ? AND AMEND_ID \= ?


##Model Master

GET_MODEL_MASTER_LIST =SELECT   MODEL_ID,MODEL_NAME,BODY_ID, (CASE STATUS WHEN 'Y' THEN 'Active' ELSE 'De Active' END) STATUS ,convert(varchar(10),MMM.EFFECTIVE_DATE,103)EFFECTIVE_DATE,convert(varchar(10),EXPIRY_DATE,103) EXPIRY_DATE,REMARKS,MODEL_NAME_ARABIC,(CASE REFERRAL_STATUS WHEN 'Y' THEN ' Referral' ELSE 'Non-Referral' END) REFERRAL_STATUS FROM   MOTOR_MODEL_MASTER MMM WHERE BRANCH_CODE = ? AND MAKE_ID = ? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM  MOTOR_MODEL_MASTER WHERE MODEL_ID=MMM.MODEL_ID ) ORDER BY MODEL_ID DESC
GET_MODEL_HEADER_LIST = SELECT MAKE_NAME FROM  MOTOR_MAKE_MASTER MMM  WHERE MMM.MAKE_ID\=? AND MMM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_MAKE_MASTER WHERE MAKE_ID\=MMM.MAKE_ID)
GET_MAX_MODEL_ID = SELECT ISNULL(MAX(MODEL_ID)+1,0) FROM MOTOR_MODEL_MASTER
GET_EDIT_MODEL_AMEND_ID = SELECT AMEND_ID FROM MOTOR_MODEL_MASTER MMM WHERE MODEL_ID \= ? AND AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM MOTOR_MODEL_MASTER WHERE MODEL_ID \= MMM.MODEL_ID) AND BRANCH_CODE \=? AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
CHECK_MODEL_CORE_CODE = SELECT COUNT(*) FROM MOTOR_MODEL_MASTER WHERE CORE_CODE = ? AND BRANCH_CODE = ?
INS_MODEL_MASTER = INSERT INTO MOTOR_MODEL_MASTER (MODEL_ID,MAKE_ID,MODEL_NAME,BODY_ID,STATUS,EFFECTIVE_DATE,EXPIRY_DATE,REMARKS,AMEND_ID,BRANCH_CODE,MODEL_NAME_ARABIC,REFERRAL_STATUS,CORE_CODE) VALUES(?,?,?,?,?,CONVERT(DATE,?,103),CONVERT(DATE,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_MODEL_MASTER WHERE MODEL_ID\=?),?,?,?,?)
UPD_MODEL_MASTER = UPDATE MOTOR_MODEL_MASTER  SET MAKE_ID\=?,MODEL_NAME\=?,BODY_ID\=?,STATUS\=?,EFFECTIVE_DATE\=CONVERT(DATE,?,103),EXPIRY_DATE\=CONVERT(DATE,?,103),REMARKS\=?,BRANCH_CODE\=?,MODEL_NAME_ARABIC\=?,REFERRAL_STATUS\=?,CORE_CODE\=? WHERE MODEL_ID \= ? AND AMEND_ID \= ?
EDIT_MODEL_MASTER = SELECT MODEL_NAME,STATUS,convert(varchar(10),EFFECTIVE_DATE, 103) EFFECTIVE_DATE,convert(varchar(10),EXPIRY_DATE, 103) EXPIRY_DATE,BODY_ID,REMARKS,BRANCH_CODE,MODEL_NAME_ARABIC,REFERRAL_STATUS,CORE_CODE FROM MOTOR_MODEL_MASTER MMM WHERE MODEL_ID \= ? AND AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_MODEL_MASTER WHERE MODEL_ID \= MMM.MODEL_ID) AND BRANCH_CODE \=?


##Document Master
##GET_DOCUMENT_MASTER = SELECT   DOCUMENT_ID,(SELECT wm_concat(POLICYTYPE_DESC_ENGLISH)  FROM MOTOR_POLICYTYPE_MASTER MPM  where POLICYTYPE_ID in(select column_value from table  (split_text_fn(mdm.POLICY_TYPE,',')))) POLICY_TYPE,DOCUMENT_DESC,DECODE (MANDATORY_STATUS,'Y','Active','N','Deactive') MANDATORY_STATUS,DECODE (STATUS,'Y','Active','N','Deactive')STATUS,REMARKS FROM   motor_document_master mdm ORDER BY   DOCUMENT_ID
##GET_DOCUMENT_FOR_EDIT = SELECT DOCUMENT_ID,DOCUMENT_DESC,POLICY_TYPE,MANDATORY_STATUS,STATUS,REMARKS FROM motor_document_master WHERE DOCUMENT_ID=?
##GET_MAX_DOCUMENT_ID = SELECT max(DOCUMENT_ID)+1 DOCUMENT_ID from motor_document_master 
##DOCUMENT_UPDATE = UPDATE motor_document_master SET   DOCUMENT_DESC=?,POLICY_TYPE=?,MANDATORY_STATUS=?,STATUS=?,REMARKS=? WHERE DOCUMENT_ID=?
##DOCUMENT_INSERT = INSERT INTO motor_document_master (DOCUMENT_ID,DOCUMENT_DESC,POLICY_TYPE,MANDATORY_STATUS,STATUS,REMARKS) VALUES(?,?,?,?,?,?)

##GET_DOCUMENT_MASTER =  select DOCUMENT_ID,(SELECT  STUFF((SELECT ', '+CONVERT(varchar(10),POLICYTYPE_DESC_ENGLISH) AS[text()]  FROM (Select POLICYTYPE_DESC_ENGLISH from MOTOR_POLICYTYPE_MASTER Where STATUS='Y' and convert(varchar(10),POLICYTYPE_ID)  in (Select * from FN_Split_SV(mdm.POLICY_TYPE,','))) A FOR XML PATH('')), 1, 2, '') AS list) POLICY_TYPE, DOCUMENT_DESC,Case MANDATORY_STATUS  when  'Y' then 'Active' when 'N' then 'Deactive' end MANDATORY_STATUS, Case STATUS when 'Y' then 'Active' when 'N' then 'Deactive' end STATUS,REMARKS,DISPLAY_ORDER  from motor_document_master mdm  ORDER BY   DOCUMENT_ID
GET_DOCUMENT_MASTER = select DOCUMENT_ID,CASE  WHEN MDM.DOC_APPLICABLE IN('POLICY','PROMO') THEN (SELECT  STUFF((SELECT ', '+CONVERT(varchar(100),POLICYTYPE_DESC_ENGLISH) AS[text()] FROM (  Select POLICYTYPE_DESC_ENGLISH from MOTOR_POLICYTYPE_MASTER mpm Where STATUS\='Y' and  amend_id\=(select max(amend_id) from   motor_policytype_master  where policy_subtype_id\=mpm.policy_subtype_id) and  convert(varchar(10),POLICY_subTYPE_ID)  in   (Select * from FN_Split_SV(mdm.POLICY_TYPE,',')    )) A FOR XML PATH('')), 1, 2, '')    AS list   ) WHEN MDM.DOC_APPLICABLE IN('CANCEL') THEN 'Cancel Policy' else '' END POLICY_TYPE, DOCUMENT_DESC,Case MANDATORY_STATUS  when  'Y' then 'Yes' when 'N' then 'No' when 'P' then 'Partial' end   MANDATORY_STATUS, Case STATUS when 'Y' then 'Active' when 'N' then 'Deactive' end STATUS,REMARKS,  DISPLAY_ORDER,DOC_APPLICABLE  from document_master mdm  ORDER BY   DOCUMENT_ID   
GET_DOCUMENT_FOR_EDIT = SELECT DOCUMENT_ID,DOCUMENT_DESC,POLICY_TYPE,DOC_APPLICABLE,MANDATORY_STATUS,STATUS,REMARKS,DISPLAY_ORDER,DOCUMENT_DESC_AR FROM DOCUMENT_MASTER where DOCUMENT_ID\=?
GET_MAX_DOCUMENT_ID = SELECT ISNULL(max(DOCUMENT_ID)+1,0) DOCUMENT_ID from motor_document_master
DOCUMENT_UPDATE = UPDATE DOCUMENT_MASTER SET  DOC_APPLICABLE\=?,DOCUMENT_DESC\=?,DOCUMENT_DESC_AR\=?,POLICY_TYPE\=?,DISPLAY_ORDER\=?,MANDATORY_STATUS\=?,STATUS\=?,REMARKS\=? WHERE DOCUMENT_ID\=? 
##DOCUMENT_INSERT = INSERT INTO motor_document_master (DOCUMENT_ID,DOCUMENT_DESC,POLICY_TYPE,MANDATORY_STATUS,STATUS,REMARKS,DISPLAY_ORDER) VALUES(?,?,?,?,?,?,?)

DOCUMENT_INSERT = INSERT INTO document_master (DOC_APPLICABLE,DOCUMENT_DESC,DOCUMENT_DESC_AR,POLICY_TYPE,DISPLAY_ORDER,REMARKS,MANDATORY_STATUS,STATUS,DOCUMENT_ID,PRODUCT_ID) VALUES(?,?,?,?,?,?,?,?,(select max(DOCUMENT_ID)+1 from Document_Master),'65')
CHECK_DOCUMENTDISPLAY_ORDER = SELECT COUNT(*) FROM MOTOR_DOCUMENT_MASTER WHERE DISPLAY_ORDER\=?

##Third Party Master

#####(16-04-2016)##### GET_THIRD_PARTY_LIST = SELECT   THIRD_PARTY_ID,SEATING_CYLINDER_START,SEATING_CYLINDER_END,THIRD_PARTY_RATE,convert(varchar(10),mtr.EFFECTIVE_DATE,103) EFFECTIVE_DATE,COREAPP_CODE,(CASE mtr.STATUS WHEN 'Y' THEN 'Active' ELSE 'De Active' END) STATUS,MFG.COUNTRY_NAME FROM   MOTOR_TYPE_THIRD_PARTY MTR,MOTOR_MFG_COUNTRY_MASTER MFG WHERE       mtr.BRANCH_CODE \= ? AND mtr.PRODUCT_ID \= ? AND mtr.TYPE_OF_BODY_ID \= ? AND MFG.COUNTRY_ID \= MTR.LOCATIONID AND mtr.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_THIRD_PARTY WHERE   THIRD_PARTY_ID \= MTR.THIRD_PARTY_ID)
#####(13-01-2017)##### GET_THIRD_PARTY_LIST = SELECT   THIRD_PARTY_ID,SEATING_CYLINDER_START,SEATING_CYLINDER_END,THIRD_PARTY_RATE,convert(varchar(10),mtr.EFFECTIVE_DATE,103) EFFECTIVE_DATE,COREAPP_CODE,(CASE mtr.STATUS WHEN 'Y' THEN 'Active' ELSE 'De Active' END) STATUS,MFG.COUNTRY_NAME,CASE MTR.AGENCY_CODE WHEN '99999' THEN 'All Brokers' ELSE (select LG.USERNAME from login_master LG where MTR.AGENCY_CODE \= LG.AGENCY_CODE ) END AS USERNAME FROM   MOTOR_TYPE_THIRD_PARTY MTR,MOTOR_MFG_COUNTRY_MASTER MFG WHERE       mtr.BRANCH_CODE \= ? AND mtr.PRODUCT_ID \= ? AND mtr.TYPE_OF_BODY_ID \= ? AND MFG.COUNTRY_ID \= MTR.LOCATIONID AND mtr.AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_THIRD_PARTY WHERE   THIRD_PARTY_ID \= MTR.THIRD_PARTY_ID)
GET_THIRD_PARTY_LIST = SELECT   THIRD_PARTY_ID,SEATING_CYLINDER_START,SEATING_CYLINDER_END,THIRD_PARTY_RATE, convert(varchar(10),mtr.EFFECTIVE_DATE,103) EFFECTIVE_DATE,COREAPP_CODE, (CASE mtr.STATUS WHEN 'Y' THEN 'Active' ELSE 'De Active' END) STATUS, CASE MTR.AGENCY_CODE WHEN '99999' THEN 'All Brokers' ELSE (select LG.USERNAME from login_master LG where MTR.AGENCY_CODE = LG.AGENCY_CODE ) END AS USERNAME FROM   MOTOR_TYPE_THIRD_PARTY MTR WHERE       mtr.BRANCH_CODE = ? AND mtr.PRODUCT_ID = ? AND mtr.TYPE_OF_BODY_ID = ? AND mtr.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM  MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID = MTR.THIRD_PARTY_ID)
##GET_THIRD_PARTY_LIST = SELECT   THIRD_PARTY_ID,SEATING_CYLINDER_START,SEATING_CYLINDER_END,THIRD_PARTY_RATE, convert(varchar(10),mtr.EFFECTIVE_DATE,103) EFFECTIVE_DATE,COREAPP_CODE, (CASE mtr.STATUS WHEN 'Y' THEN 'Active' ELSE 'De Active' END) STATUS, CASE MTR.AGENCY_CODE WHEN '99999' THEN 'All Brokers' ELSE (select LG.USERNAME from login_master LG where MTR.AGENCY_CODE = LG.AGENCY_CODE ) END AS USERNAME FROM   MOTOR_TYPE_THIRD_PARTY MTR WHERE       mtr.BRANCH_CODE = ? AND mtr.PRODUCT_ID = ? AND mtr.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM  MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID = MTR.THIRD_PARTY_ID)
#####(21-04-2016)#####GET_THIRD_PARTY_LIST = SELECT MTR.SEATING_CYLINDER_START,MTR.SEATING_CYLINDER_END,MTR.THIRD_PARTY_ID,MTR.THIRD_PARTY_RATE,convert(varchar(10),mtr.EFFECTIVE_DATE,103) EFFECTIVE_DATE,MTR.COREAPP_CODE,(CASE mtr.STATUS WHEN 'Y' THEN 'Active' ELSE 'De Active' END) STATUS,CASE MTR.AGENCY_CODE WHEN '99999' THEN 'All Brokers' ELSE (select LG.USERNAME from login_master LG where MTR.AGENCY_CODE \= LG.AGENCY_CODE ) END AS USERNAME FROM   MOTOR_TYPE_THIRD_PARTY MTR WHERE  MTR.BRANCH_CODE \= ? AND MTR.PRODUCT_ID \= ? AND MTR.TYPE_OF_BODY_ID \= ? AND MTR.AMEND_ID \= ( SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_THIRD_PARTY MTP WHERE   THIRD_PARTY_ID \= MTR.THIRD_PARTY_ID)
#####(16-04-2016)##### GET_EDIT_THIRD_PARTY = SELECT THIRD_PARTY_ID,TYPE_OF_BODY_ID,SEATING_CYLINDER_START,SEATING_CYLINDER_END,THIRD_PARTY_RATE,convert(varchar(10),mtr.EFFECTIVE_DATE,103) EFFECTIVE_DATE,COREAPP_CODE,STATUS,LOCATIONID FROM MOTOR_TYPE_THIRD_PARTY MTR WHERE THIRD_PARTY_ID = ? AND PRODUCT_ID =? AND BRANCH_CODE =? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID = MTR.THIRD_PARTY_ID)
GET_EDIT_THIRD_PARTY = SELECT THIRD_PARTY_ID,TYPE_OF_BODY_ID,SEATING_CYLINDER_START,SEATING_CYLINDER_END,THIRD_PARTY_RATE,convert(varchar(10),mtr.EFFECTIVE_DATE,103) EFFECTIVE_DATE,COREAPP_CODE,STATUS,AGENCY_CODE FROM MOTOR_TYPE_THIRD_PARTY MTR WHERE THIRD_PARTY_ID = ? AND PRODUCT_ID =? AND BRANCH_CODE =? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID = MTR.THIRD_PARTY_ID)
GET_THIRD_PARTY_HEADER_LIST = SELECT MVM.VEHICLETYPE_DESC,MBM.TYPE_OF_BODY_NAME FROM MOTOR_VEHICLETYPE_MASTER MVM, MOTOR_BODYTYPE_DETAIL MBM WHERE MVM.VTYPE_ID\=? AND MVM.STATUS\='Y' AND MVM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_VEHICLETYPE_MASTER WHERE VTYPE_ID\=MVM.VTYPE_ID) AND MBM.TYPE_OF_BODY_ID\=?       AND MBM.STATUS\='Y' AND MBM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL WHERE TYPE_OF_BODY_ID\=MBM.TYPE_OF_BODY_ID)
CHECK_THIRD_PARTY_CORE_CODE = SELECT COUNT(*) FROM MOTOR_TYPE_THIRD_PARTY MTTP WHERE COREAPP_CODE \= ? AND BRANCH_CODE \=? AND STATUS\='Y' AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_TYPE_THIRD_PARTY WHERE   THIRD_PARTY_ID\=MTTP.THIRD_PARTY_ID)
#####(16-04-2016)##### CHECK_THIRD_PARTY_SEATING_CYL = SELECT COUNT(*) FROM MOTOR_TYPE_THIRD_PARTY MSM WHERE MSM.TYPE_OF_BODY_ID\=? AND  ((? BETWEEN MSM.SEATING_CYLINDER_START AND MSM.SEATING_CYLINDER_END) OR (? BETWEEN MSM.SEATING_CYLINDER_START AND MSM.SEATING_CYLINDER_END)) AND LOCATIONID \= ? AND BRANCH_CODE \= ? AND MSM.AMEND_ID \=(SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID\=MSM.THIRD_PARTY_ID )
CHECK_THIRD_PARTY_SEATING_CYL = SELECT COUNT(*) FROM MOTOR_TYPE_THIRD_PARTY MSM WHERE MSM.TYPE_OF_BODY_ID\=? AND STATUS\='Y' AND  ((? BETWEEN MSM.SEATING_CYLINDER_START AND MSM.SEATING_CYLINDER_END) OR (? BETWEEN MSM.SEATING_CYLINDER_START AND MSM.SEATING_CYLINDER_END)) AND BRANCH_CODE \= ? AND MSM.AMEND_ID \=(SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID\=MSM.THIRD_PARTY_ID )
#####(16-04-2016)##### GET_THIRD_PARTY_SEATING_CYL_MODEL = SELECT BRANCH_CODE, PRODUCT_ID, (SELECT TYPE_OF_BODY_NAME FROM MOTOR_BODYTYPE_DETAIL  MTBM WHERE MTBM.TYPE_OF_BODY_ID=MTTP.TYPE_OF_BODY_ID AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL MT WHERE MTBM.TYPE_OF_BODY_ID=MT.TYPE_OF_BODY_ID )) TYPE_OF_BODY_ID, TYPE_OF_BODY_ID, AMEND_ID, SEATING_CYLINDER_START, SEATING_CYLINDER_END, THIRD_PARTY_RATE, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, COREAPP_CODE, STATUS,(SELECT COUNTRY_NAME FROM  MOTOR_MFG_COUNTRY_MASTER MMCM WHERE MMCM.COUNTRY_ID=MTTP.LOCATIONID AND BRANCH_CODE=MTTP.BRANCH_CODE) COUNTRY_NAME FROM MOTOR_TYPE_THIRD_PARTY MTTP WHERE MTTP.TYPE_OF_BODY_ID=? AND  ((? BETWEEN MTTP.SEATING_CYLINDER_START AND MTTP.SEATING_CYLINDER_END) OR (? BETWEEN MTTP.SEATING_CYLINDER_START AND MTTP.SEATING_CYLINDER_END)) AND MTTP.AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID=MTTP.THIRD_PARTY_ID )
GET_THIRD_PARTY_SEATING_CYL_MODEL = SELECT SEATING_CYLINDER_START,SEATING_CYLINDER_END,BRANCH_CODE, PRODUCT_ID, (SELECT TYPE_OF_BODY_NAME FROM MOTOR_BODYTYPE_DETAIL  MTBM WHERE MTBM.TYPE_OF_BODY_ID=MTTP.TYPE_OF_BODY_ID AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL MT WHERE MTBM.TYPE_OF_BODY_ID=MT.TYPE_OF_BODY_ID )) TYPE_OF_BODY_ID, TYPE_OF_BODY_ID, AMEND_ID, SEATING_CYLINDER_START, SEATING_CYLINDER_END, THIRD_PARTY_RATE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, COREAPP_CODE, STATUS,(SELECT COUNTRY_NAME FROM  MOTOR_MFG_COUNTRY_MASTER MMCM WHERE MMCM.COUNTRY_ID=MTTP.LOCATIONID AND BRANCH_CODE=MTTP.BRANCH_CODE) COUNTRY_NAME FROM MOTOR_TYPE_THIRD_PARTY MTTP WHERE MTTP.TYPE_OF_BODY_ID=? AND  ((? BETWEEN MTTP.SEATING_CYLINDER_START AND MTTP.SEATING_CYLINDER_END) OR (? BETWEEN MTTP.SEATING_CYLINDER_START AND MTTP.SEATING_CYLINDER_END)) AND MTTP.AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID=MTTP.THIRD_PARTY_ID )
GET_MAX_THIRD_PARTY_ID = SELECT ISNULL(MAX(THIRD_PARTY_ID)+1,0) FROM MOTOR_TYPE_THIRD_PARTY
GET_EDIT_THIRD_PARTY_AMEND_ID = SELECT AMEND_ID FROM MOTOR_TYPE_THIRD_PARTY MTP WHERE THIRD_PARTY_ID \= ? AND AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID \= MTP.THIRD_PARTY_ID)  AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
#####(16-04-2016)##### INS_THIRD_PARTY_MASTER = INSERT INTO MOTOR_TYPE_THIRD_PARTY(BRANCH_CODE,PRODUCT_ID,THIRD_PARTY_ID,AMEND_ID,TYPE_OF_BODY_ID,SEATING_CYLINDER_START,THIRD_PARTY_RATE,EFFECTIVE_DATE,COREAPP_CODE,STATUS,LOCATIONID,SEATING_CYLINDER_END) VALUES(?,?,?,( SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID \=?),?,?,?,convert(date,?,103),?,?,?,?)
INS_THIRD_PARTY_MASTER = INSERT INTO MOTOR_TYPE_THIRD_PARTY(BRANCH_CODE,PRODUCT_ID,THIRD_PARTY_ID,AMEND_ID,TYPE_OF_BODY_ID,SEATING_CYLINDER_START,THIRD_PARTY_RATE,EFFECTIVE_DATE,COREAPP_CODE,STATUS,SEATING_CYLINDER_END,LOCATIONID,AGENCY_CODE) VALUES(?,?,?,( SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_TYPE_THIRD_PARTY WHERE THIRD_PARTY_ID \=?),?,?,?,convert(date,?,103),?,?,?,?,?)
#####(16-04-2016)##### UPD_THIRD_PARTY_MASTER = UPDATE MOTOR_TYPE_THIRD_PARTY  SET BRANCH_CODE=?,PRODUCT_ID=?,TYPE_OF_BODY_ID=?,SEATING_CYLINDER_START=?,THIRD_PARTY_RATE=?,EFFECTIVE_DATE=convert(date,?,103),COREAPP_CODE=?,STATUS=?,LOCATIONID =?,SEATING_CYLINDER_END=? WHERE THIRD_PARTY_ID=? AND AMEND_ID= ?
UPD_THIRD_PARTY_MASTER = UPDATE MOTOR_TYPE_THIRD_PARTY  SET BRANCH_CODE=?,PRODUCT_ID=?,TYPE_OF_BODY_ID=?,SEATING_CYLINDER_START=?,THIRD_PARTY_RATE=?,EFFECTIVE_DATE=convert(date,?,103),COREAPP_CODE=?,STATUS=?,SEATING_CYLINDER_END=?,AGENCY_CODE=?,LOCATIONID=? WHERE THIRD_PARTY_ID=? AND AMEND_ID= ?


#Deductible Master
#####(16-04-2016)##### GET_DEDUCTIBLE_MASTER = SELECT DEDUCT_ID, DEDUCT_START, DEDUCT_END, RATE, DISC_AMT, AMEND_ID,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS, convert(varchar(10),ENTRY_DATE,103) ENTRY_DATE, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, REMARKS, BRANCH_CODE FROM MOTOR_DEDUCTIBLE_MASTER mdms where BRANCH_CODE\=? and amend_id\=(select max(amend_id) from MOTOR_DEDUCTIBLE_MASTER mdm where mdm.BRANCH_CODE\=mdms.BRANCH_CODE and mdm.DEDUCT_ID\=mdms.DEDUCT_ID) ORDER BY DEDUCT_ID
#####(21-04-2016)##### GET_DEDUCTIBLE_MASTER = SELECT DEDUCT_ID, DEDUCT_START, DEDUCT_END, RATE, DISC_AMT, AMEND_ID,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS, convert(varchar(10),ENTRY_DATE,103) ENTRY_DATE, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, REMARKS, BRANCH_CODE, SEATING_START,SEATING_END, (Select VEHICLETYPE_DESC From  Motor_vehicletype_master where VTYPE_ID=(Select VTYPE_ID from Motor_bodytype_detail mbd Where mbd.TYPE_OF_BODY_ID=mdms.TYPE_OF_BODY_ID)) Vehicle_name , (Select TYPE_OF_BODY_NAME From  Motor_bodytype_detail where BODY_ID=(Select BODY_ID from Motor_bodytype_detail mbd Where mbd.TYPE_OF_BODY_ID=mdms.TYPE_OF_BODY_ID)) BODY_name FROM MOTOR_DEDUCTIBLE_MASTER mdms where BRANCH_CODE=? and amend_id=( select max(amend_id) from MOTOR_DEDUCTIBLE_MASTER mdm where mdm.BRANCH_CODE=mdms.BRANCH_CODE and mdm.DEDUCT_ID=mdms.DEDUCT_ID) ORDER BY DEDUCT_ID
#####(13-01-2017)##### GET_DEDUCTIBLE_MASTER =  SELECT DEDUCT_ID, DEDUCT_START, DEDUCT_END, RATE, DISC_AMT, mdms.AMEND_ID, (CASE  mdms.STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS,  convert(varchar(10),mdms.ENTRY_DATE,103) ENTRY_DATE,   convert(varchar(10),mdms.EFFECTIVE_DATE,103) EFFECTIVE_DATE,   mdms.REMARKS, BRANCH_CODE, SEATING_START,SEATING_END,  (Select VEHICLETYPE_DESC From  Motor_vehicletype_master mvm where   VTYPE_ID=mbd.VTYPE_ID and mvm.AMEND_ID=(select MAX(amend_id) from    Motor_vehicletype_master mvms where  mvms.VTYPE_ID=mvm.VTYPE_ID )) Vehicle_name,    TYPE_OF_BODY_NAME BODY_name   FROM MOTOR_DEDUCTIBLE_MASTER mdms ,Motor_bodytype_detail mbd  where BRANCH_CODE=?  and mbd.TYPE_OF_BODY_ID=mdms.TYPE_OF_BODY_ID  and mdms.AMEND_ID=( select max(amend_id) from MOTOR_DEDUCTIBLE_MASTER mdm   where mdm.BRANCH_CODE=mdms.BRANCH_CODE and mdm.DEDUCT_ID=mdms.DEDUCT_ID)   and  mbd.AMEND_ID=( select max(amend_id) from Motor_bodytype_detail mdm   where  mbd.TYPE_OF_BODY_ID=mdm.TYPE_OF_BODY_ID)  ORDER BY DEDUCT_ID
GET_DEDUCTIBLE_MASTER =  SELECT DEDUCT_ID, DEDUCT_START, DEDUCT_END, RATE, DISC_AMT, AMEND_ID, (CASE STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS,  convert(varchar(10),ENTRY_DATE,103) ENTRY_DATE,   convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, REMARKS, BRANCH_CODE, SEATING_START,SEATING_END FROM MOTOR_DEDUCTIBLE_MASTER mdm  where BRANCH_CODE=? and AMEND_ID=( select max(amend_id) from MOTOR_DEDUCTIBLE_MASTER where mdm.DEDUCT_ID=DEDUCT_ID) ORDER BY DEDUCT_ID
#####(16-04-2016)##### GET_DEDUCTIBLE_FOR_EDIT = SELECT DEDUCT_ID,DEDUCT_START,DEDUCT_END,RATE,DISC_AMT,STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS FROM MOTOR_DEDUCTIBLE_MASTER WHERE DEDUCT_ID\=? and BRANCH_CODE\=?
#####(13-01-2017)##### GET_DEDUCTIBLE_FOR_EDIT = SELECT mdms.DEDUCT_ID,mdms.DEDUCT_START,mdms.DEDUCT_END,mdms.RATE,mdms.DISC_AMT, mdms.SEATING_START ,mdms.SEATING_END,mdms.STATUS,convert(varchar(10),mdms.EFFECTIVE_DATE,103) EFFECTIVE_DATE, mdms.REMARKS,MBD.TYPE_OF_BODY_ID,MBD.VTYPE_ID,mdms.DEFAULT_YN  FROM MOTOR_DEDUCTIBLE_MASTER mdms,Motor_bodytype_detail mbd WHERE DEDUCT_ID=? and BRANCH_CODE=? and MBD.TYPE_OF_BODY_ID = MDMS.TYPE_OF_BODY_ID and mdms.amend_id=(select max(amend_id) from MOTOR_DEDUCTIBLE_MASTER mdm where mdm.DEDUCT_ID=mdms.DEDUCT_ID)
GET_DEDUCTIBLE_FOR_EDIT = SELECT DEDUCT_ID,DEDUCT_START,DEDUCT_END,RATE,DISC_AMT, SEATING_START ,SEATING_END,STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, REMARKS,DEFAULT_YN  FROM MOTOR_DEDUCTIBLE_MASTER mdm WHERE DEDUCT_ID\=? and BRANCH_CODE\=?  and amend_id\=(select max(amend_id) from MOTOR_DEDUCTIBLE_MASTER  where mdm.DEDUCT_ID\=DEDUCT_ID) 
#####(16-04-2016)##### GET_DEDUCTIBLE_FOR_INSERT = INSERT INTO MOTOR_DEDUCTIBLE_MASTER (DEDUCT_ID,DEDUCT_START,DEDUCT_END,RATE,DISC_AMT,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE) VALUES (?,?,?,?,?,?,convert(date,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_DEDUCTIBLE_MASTER WHERE DEDUCT_ID=? ),?)
#####(13-01-2017)##### GET_DEDUCTIBLE_FOR_INSERT = INSERT INTO MOTOR_DEDUCTIBLE_MASTER (DEDUCT_ID,DEDUCT_START,DEDUCT_END,RATE,DISC_AMT,TYPE_OF_BODY_ID,SEATING_START,SEATING_END,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE,DEFAULT_YN) VALUES (?,?,?,?,?,?,?,?,?,convert(date,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_DEDUCTIBLE_MASTER WHERE DEDUCT_ID=? ),?,?)
GET_DEDUCTIBLE_FOR_INSERT = INSERT INTO MOTOR_DEDUCTIBLE_MASTER (DEDUCT_ID,DEDUCT_START,DEDUCT_END,RATE,DISC_AMT,SEATING_START,SEATING_END,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE,DEFAULT_YN) VALUES (?,?,?,?,?,?,?,?,convert(date,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_DEDUCTIBLE_MASTER WHERE DEDUCT_ID=? ),?,?)
GET_MAX_DEDUCTIBLE_ID = SELECT MAX(DEDUCT_ID)+1 FROM MOTOR_DEDUCTIBLE_MASTER 
GET_EDIT_DEDUCTIBLE_AMEND_ID = SELECT AMEND_ID FROM MOTOR_DEDUCTIBLE_MASTER MDMS WHERE DEDUCT_ID \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_DEDUCTIBLE_MASTER MDM WHERE MDM.DEDUCT_ID\=MDMS.DEDUCT_ID)  AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
#####(16-04-2016)##### GET_DEDUCTIBLE_FOR_UPDATE = UPDATE MOTOR_DEDUCTIBLE_MASTER  SET DEDUCT_START\=?,DEDUCT_END\=?,RATE\=?,DISC_AMT\=?,STATUS\=?,EFFECTIVE_DATE\=convert(date,?,103),REMARKS\=?,BRANCH_CODE\=? WHERE DEDUCT_ID \= ? AND AMEND_ID \=?
#####(13-01-2017)##### GET_DEDUCTIBLE_FOR_UPDATE = UPDATE MOTOR_DEDUCTIBLE_MASTER  SET DEDUCT_START\=?,DEDUCT_END\=?,RATE\=?,DISC_AMT\=?,TYPE_OF_BODY_ID\=?,SEATING_START\=?,SEATING_END\=?,STATUS\=?,EFFECTIVE_DATE\=convert(date,?,103),REMARKS\=?,BRANCH_CODE\=?,DEFAULT_YN\=? WHERE DEDUCT_ID \= ? AND AMEND_ID \=?
GET_DEDUCTIBLE_FOR_UPDATE = UPDATE MOTOR_DEDUCTIBLE_MASTER  SET DEDUCT_START\=?,DEDUCT_END\=?,RATE\=?,DISC_AMT\=?,SEATING_START\=?,SEATING_END\=?,STATUS\=?,EFFECTIVE_DATE\=convert(date,?,103),REMARKS\=?,BRANCH_CODE\=?,DEFAULT_YN\=? WHERE DEDUCT_ID \= ? AND AMEND_ID \=?

##Area Coverage

###GET_AREACOVERAGE_MASTER = SELECT AREACOVER_ID, AREACOVER_CODE, AREACOVER_DESC_ENGLISH, AREACOVER_DESC_ARABIC,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,convert(varchar(10),EXPIRY_DATE,103) EXPIRY_DATE, REMARKS, AMEND_ID, BRANCH_CODE FROM MOTOR_AREACOVERAGE_MASTER mdms where BRANCH_CODE=? and amend_id=(select max(amend_id) from MOTOR_AREACOVERAGE_MASTER mdm where mdm.BRANCH_CODE=mdms.BRANCH_CODE and mdm.AREACOVER_ID=mdms.AREACOVER_ID) ORDER BY AREACOVER_ID
##GET_AREACOVERAGE_FOR_EDIT = SELECT AREACOVER_ID,AREACOVER_CODE,AREACOVER_DESC_ENGLISH,AREACOVER_DESC_ARABIC,STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS FROM MOTOR_AREACOVERAGE_MASTER MAM WHERE AREACOVER_ID=? and BRANCH_CODE=?  AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_ID = MAM.AREACOVER_ID)
##GET_AREACOVERAGE_FOR_INSERT = INSERT INTO MOTOR_AREACOVERAGE_MASTER (AREACOVER_ID,AREACOVER_CODE,AREACOVER_DESC_ENGLISH,AREACOVER_DESC_ARABIC,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE) VALUES (?,?,?,?,?,convert(date,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_ID\=? ),?)
##GET_EDIT_AREA_AMEND_ID = SELECT   AMEND_ID FROM   MOTOR_AREACOVERAGE_MASTER MDMS WHERE   AREACOVER_ID = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_AREACOVERAGE_MASTER MDM WHERE   MDM.AREACOVER_ID = MDMS.AREACOVER_ID)  AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
##GET_MAX_AREACOVERAGE_ID = SELECT isnull(MAX(AREACOVER_ID),0)+1 FROM MOTOR_AREACOVERAGE_MASTER
##GET_AREACOVERAGE_FOR_UPDATE = UPDATE MOTOR_AREACOVERAGE_MASTER  SET AREACOVER_CODE\=?,AREACOVER_DESC_ENGLISH\=?,AREACOVER_DESC_ARABIC\=?,STATUS\=?,EFFECTIVE_DATE\=convert(date,?,103),REMARKS\=?,BRANCH_CODE\=? WHERE AREACOVER_ID \= ? AND AMEND_ID \=?
##CHECK_AREACOVERAGE_CODE = select COUNT(*) FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_CODE\=? AND BRANCH_CODE\=? 
##GET_VEHICLE_TYPE_LIST_ADMIN = SELECT   MVM.VTYPE_ID, MVM.VTYPE_CODE FROM   MOTOR_VEHICLETYPE_MASTER MVM WHERE   STATUS = 'Y' AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_VEHICLETYPE_MASTER WHERE   VTYPE_ID = MVM.VTYPE_ID)
##CHECK_AREACOVERAGE_CODE = select COUNT(*) FROM MOTOR_AREACOVERAGE_MASTER MAM WHERE AREACOVER_CODE\=? AND BRANCH_CODE\=? AND STATUS\='Y' AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_AREACOVERAGE_MASTER WHERE   AREACOVER_ID\=MAM.AREACOVER_ID)



GET_AREACOVERAGE_MASTER = SELECT AREACOVER_CODE, AREACOVER_DESC_ENGLISH, AREACOVER_DESC_ARABIC,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,convert(varchar(10),EXPIRY_DATE,103) EXPIRY_DATE, REMARKS, AMEND_ID, BRANCH_CODE FROM MOTOR_AREACOVERAGE_MASTER mdms where BRANCH_CODE=? and amend_id=(select max(amend_id) from MOTOR_AREACOVERAGE_MASTER mdm where mdm.BRANCH_CODE=mdms.BRANCH_CODE and mdm.AREACOVER_CODE=mdms.AREACOVER_CODE) ORDER BY AREACOVER_CODE
GET_AREACOVERAGE_FOR_EDIT = SELECT AREACOVER_CODE,AREACOVER_DESC_ENGLISH,AREACOVER_DESC_ARABIC,STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS,coreappcode FROM MOTOR_AREACOVERAGE_MASTER MAM WHERE AREACOVER_CODE=? and BRANCH_CODE=?  AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_CODE = MAM.AREACOVER_CODE)
GET_AREACOVERAGE_FOR_INSERT = INSERT INTO MOTOR_AREACOVERAGE_MASTER (AREACOVER_CODE,AREACOVER_DESC_ENGLISH,AREACOVER_DESC_ARABIC,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE,coreappcode) VALUES (?,?,?,?,convert(date,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_AREACOVERAGE_MASTER WHERE AREACOVER_CODE\=? ),?,?)
GET_EDIT_AREA_AMEND_ID = SELECT   AMEND_ID FROM   MOTOR_AREACOVERAGE_MASTER MDMS WHERE   AREACOVER_CODE = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_AREACOVERAGE_MASTER MDM WHERE   MDM.AREACOVER_CODE = MDMS.AREACOVER_CODE)  AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
GET_MAX_AREACOVERAGE_ID = SELECT isnull(MAX(AREACOVER_CODE),0)+1 FROM MOTOR_AREACOVERAGE_MASTER
GET_AREACOVERAGE_FOR_UPDATE = UPDATE MOTOR_AREACOVERAGE_MASTER  SET AREACOVER_CODE\=?,AREACOVER_DESC_ENGLISH\=?,AREACOVER_DESC_ARABIC\=?,STATUS\=?,EFFECTIVE_DATE\=convert(date,?,103),REMARKS\=?,BRANCH_CODE\=? WHERE AREACOVER_CODE \= ? AND AMEND_ID \=?
CHECK_AREACOVERAGE_CODE = select COUNT(*) FROM MOTOR_AREACOVERAGE_MASTER MAM WHERE AREACOVER_CODE\=? AND BRANCH_CODE\=? AND STATUS\='Y' AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_AREACOVERAGE_MASTER WHERE   AREACOVER_CODE\=AREACOVER_CODE)

##OPCOVER MASTER

GET_MAX_OPCOVERSUBID = SELECT NULLIF(MAX(OPCOVERSUB_ID),0)+1 FROM motor_opcover_details
GET_OPCOVER_MASTER_LIST = SELECT OPC.OPCOVER_ID, OPC.OPCOVER_DESC, OPC.COREAPP_CODE, (CASE opc.STATUS WHEN  'Y' THEN  'Activate' ELSE  'Deactivate' END) STATUS, convert(varchar(10),OPC.EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM MOTOR_OPCOVER_MASTER OPC WHERE OPC.BRANCH_CODE = ? AND OPC.AMEND_ID = (SELECT   MAX (MOM.AMEND_ID) FROM   MOTOR_OPCOVER_MASTER MOM WHERE   MOM.OPCOVER_ID = OPC.OPCOVER_ID) ORDER BY   OPC.OPCOVER_ID
EDIT_OPCOVER_MASTER = SELECT  OPCOVER_DESC, COREAPP_CODE, STATUS, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, POLICY_SUBTYPE_ID, REMARKS FROM MOTOR_OPCOVER_MASTER OPC WHERE BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (MOM.AMEND_ID) FROM   MOTOR_OPCOVER_MASTER MOM WHERE   MOM.OPCOVER_ID = OPC.OPCOVER_ID) and OPCOVER_ID=? ORDER BY   OPCOVER_ID DESC
GET_EDIT_AMENDID_OPCOVER =  SELECT AMEND_ID  FROM MOTOR_OPCOVER_MASTER MOP WHERE OPCOVER_ID = ? AND BRANCH_CODE=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_OPCOVER_MASTER  WHERE OPCOVER_ID  = MOP.OPCOVER_ID ) AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
INSERT_OPCOVER_MASTER = Insert into MOTOR_OPCOVER_MASTER(OPCOVER_ID, AMEND_ID, OPCOVER_DESC, COREAPP_CODE, STATUS, EFFECTIVE_DATE, ENTRY_DATE, REMARKS, PRODUCT, BRANCH_CODE, POLICY_SUBTYPE_ID) Values (?, (SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_OPCOVER_MASTER WHERE OPCOVER_ID= ?), ?, ?, ?, convert(date,?,103), getdate(),?, ?, ?, ?)
UPDATE_OPCOVER_MASTER = UPDATE MOTOR_OPCOVER_MASTER  SET OPCOVER_DESC = ?, COREAPP_CODE = ?, EFFECTIVE_DATE = convert(date,?,103), REMARKS=?, STATUS= ?, POLICY_SUBTYPE_ID = ? WHERE OPCOVER_ID = ? AND AMEND_ID = ?
GET_MAX_OPCOVERID = SELECT ISNULL(MAX(OPCOVER_ID),0)+1 FROM MOTOR_OPCOVER_MASTER
CHECK_CORE_APP_CODE_COUNTRY = select COUNT(*) FROM MOTOR_MFG_COUNTRY_MASTER WHERE COREAPPCODE\=? and BRANCH_CODE\=?
#####(16-04-2016)##### INSERT_OPCOVER_DETAIL = Insert into MOTOR_OPCOVER_DETAILS(OPCOVER_ID, OPCOVERSUB_ID, AMEND_ID, STATUS, ENTRY_DATE, RATE, GROUP_ID, IS_SELECTED, IS_ADDON, DELETABLE, CALC_TYPE,DESCRIPTION,POLICY_SUBTYPE_ID, COREAPP_CODE) Values (?, ?, ?, ?, sysdatetime(),  ?, 1, ?, ?, ?, ?, ?, ?, ?)
INSERT_OPCOVER_DETAIL = Insert into MOTOR_OPCOVER_DETAILS(OPCOVER_ID, OPCOVERSUB_ID, AMEND_ID, STATUS, ENTRY_DATE, RATE, GROUP_ID, IS_SELECTED, IS_ADDON, DELETABLE, CALC_TYPE,DESCRIPTION,POLICY_SUBTYPE_ID, COREAPP_CODE,AMOUNT) Values (?, ?, ?, ?, sysdatetime(),  ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
#####(16-04-2016)##### GET_OPCOVER_DETAIL_LIST = SELECT MOD.OPCOVER_ID,OPM.OPCOVER_DESC, MOD.POLICY_SUBTYPE_ID, MOD.RATE, (case MOD.STATUS when 'Y' then 'Active' when 'N' then 'De Active' end) STATUS, MPM.POLICYTYPE_DESC_ENGLISH FROM Motor_opcover_details MOD, MOTOR_POLICYTYPE_MASTER MPM, Motor_opcover_MASTER OPM WHERE MOD.GROUP_ID = 1 AND MOD.OPCOVER_ID=? AND MPM.POLICYTYPE_ID=MOD.POLICY_SUBTYPE_ID AND OPM.OPCOVER_ID = MOD.OPCOVER_ID AND MOD.AMEND_ID = (SELECT   MAX (MOM.AMEND_ID) FROM Motor_opcover_details MOM WHERE   MOM.OPCOVER_ID = MOD.OPCOVER_ID) ORDER BY   MOD.POLICY_SUBTYPE_ID
#####(13-01-2017)##### GET_OPCOVER_DETAIL_LIST = SELECT MOD.OPCOVER_ID,OPM.OPCOVER_DESC, MOD.POLICY_SUBTYPE_ID, MOD.RATE,MOD.AMOUNT,  (case MOD.STATUS when 'Y' then 'Active' when 'N' then 'De Active' end) STATUS,  MPM.POLICYTYPE_DESC_ENGLISH FROM Motor_opcover_details MOD, MOTOR_POLICYTYPE_MASTER MPM, Motor_opcover_MASTER OPM  WHERE MOD.GROUP_ID = ? AND MOD.OPCOVER_ID= ? AND  MPM.POLICY_SUBTYPE_ID=MOD.POLICY_SUBTYPE_ID AND OPM.OPCOVER_ID = MOD.OPCOVER_ID  AND MOD.AMEND_ID = (SELECT   MAX (MOM.AMEND_ID) FROM Motor_opcover_details MOM  WHERE   MOM.OPCOVER_ID = MOD.OPCOVER_ID and MOM.POLICY_SUBTYPE_ID=mod.POLICY_SUBTYPE_ID and MOD.GROUP_ID=MOM.GROUP_ID) ORDER BY   MOD.POLICY_SUBTYPE_ID
GET_OPCOVER_DETAIL_LIST = SELECT MOD.OPCOVER_ID,OPM.OPCOVER_DESC, MOD.POLICY_SUBTYPE_ID, MOD.RATE,MOD.AMOUNT,  (case MOD.STATUS when 'Y' then 'Active' when 'N' then 'De Active' end) STATUS,  MPM.POLICYTYPE_DESC_ENGLISH FROM Motor_opcover_details MOD, MOTOR_POLICYTYPE_MASTER MPM, Motor_opcover_MASTER OPM  WHERE MOD.GROUP_ID = ? AND MOD.OPCOVER_ID= ? AND  MPM.POLICY_SUBTYPE_ID=MOD.POLICY_SUBTYPE_ID AND OPM.OPCOVER_ID = MOD.OPCOVER_ID  AND MOD.AMEND_ID = (SELECT   MAX (MOM.AMEND_ID) FROM Motor_opcover_details MOM  WHERE   MOM.OPCOVER_ID = MOD.OPCOVER_ID and MOM.POLICY_SUBTYPE_ID=mod.POLICY_SUBTYPE_ID and MOD.GROUP_ID=MOM.GROUP_ID) and OPM.AMEND_ID = (select max(opn.amend_id) from Motor_opcover_MASTER opn where opn.OPCOVER_ID = opm.OPCOVER_ID and opn.POLICY_SUBTYPE_ID = opm.POLICY_SUBTYPE_ID and opn.BRANCH_CODE = opm.BRANCH_CODE) and mpm.amend_id = (select max(mpn.amend_id) from MOTOR_POLICYTYPE_MASTER mpn where mpm.BRANCH_CODE = mpn.BRANCH_CODE and  mpn.POLICYTYPE_ID = mpm.POLICYTYPE_ID and mpn.POLICY_SUBTYPE_ID = mpm.POLICY_SUBTYPE_ID) ORDER BY   MOD.POLICY_SUBTYPE_ID
#####(16-04-2016)##### EDIT_OPCOVER_DETAIL = SELECT STATUS, RATE, IS_SELECTED, IS_ADDON, COREAPP_CODE,DELETABLE,CALC_TYPE,DESCRIPTION  FROM motor_opcover_details MOD WHERE MOD.OPCOVER_ID =? AND POLICY_SUBTYPE_ID=? AND GROUP_ID='1' AND MOD.AMEND_ID = (SELECT   MAX (MO.AMEND_ID) FROM motor_opcover_details MO WHERE   MO.OPCOVER_ID = MOD.OPCOVER_ID and  MO.POLICY_SUBTYPE_ID=MOD.POLICY_SUBTYPE_ID)
EDIT_OPCOVER_DETAIL = SELECT AMOUNT,STATUS, RATE, IS_SELECTED, IS_ADDON, COREAPP_CODE,DELETABLE,CALC_TYPE,DESCRIPTION  FROM motor_opcover_details MOD WHERE MOD.OPCOVER_ID =? AND POLICY_SUBTYPE_ID=? AND GROUP_ID= ?  AND MOD.AMEND_ID = (SELECT   MAX (MO.AMEND_ID) FROM motor_opcover_details MO WHERE   MO.OPCOVER_ID = MOD.OPCOVER_ID and  MO.POLICY_SUBTYPE_ID=MOD.POLICY_SUBTYPE_ID)
#####(16-04-2016)##### UPDATE_OPCOVER_DETAIL_INSERT = Insert into MOTOR_OPCOVER_DETAILS (OPCOVER_ID, OPCOVERSUB_ID, AMEND_ID, STATUS, ENTRY_DATE, RATE, GROUP_ID, IS_SELECTED, IS_ADDON, DELETABLE, CALC_TYPE,DESCRIPTION,POLICY_SUBTYPE_ID, COREAPP_CODE) Values (?, ?, ?, ?, getdate(),  ?, 1, ?, ?, ?, ?,?, ?, ?)
UPDATE_OPCOVER_DETAIL_INSERT = Insert into MOTOR_OPCOVER_DETAILS(OPCOVER_ID, OPCOVERSUB_ID, AMEND_ID, STATUS, ENTRY_DATE, RATE, GROUP_ID, IS_SELECTED, IS_ADDON, DELETABLE, CALC_TYPE,DESCRIPTION,POLICY_SUBTYPE_ID, COREAPP_CODE,AMOUNT) Values (?, ?, ?, ?, getdate(),  ?, ?, ?, ?, ?, ?,?, ?, ?, ?)
#####(16-04-2016)##### GET_DETAILS_OPCOVERSUBID = SELECT OPCOVERSUB_ID  ,AMEND_ID+1 AMEND_ID FROM MOTOR_OPCOVER_DETAILS MOD WHERE OPCOVER_ID= ? AND POLICY_SUBTYPE_ID=? AND GROUP_ID='1'  AND AMEND_ID = (SELECT   MAX (MO.AMEND_ID) FROM motor_opcover_details MO WHERE   MO.OPCOVER_ID = MOD.OPCOVER_ID and  MO.POLICY_SUBTYPE_ID=MOD.POLICY_SUBTYPE_ID )
GET_DETAILS_OPCOVERSUBID = SELECT OPCOVERSUB_ID  ,AMEND_ID+1 AMEND_ID FROM MOTOR_OPCOVER_DETAILS MOD WHERE OPCOVER_ID= ? AND POLICY_SUBTYPE_ID=? AND GROUP_ID=?  AND AMEND_ID = (SELECT   MAX (MO.AMEND_ID) FROM motor_opcover_details MO WHERE   MO.OPCOVER_ID = MOD.OPCOVER_ID and  MO.POLICY_SUBTYPE_ID=MOD.POLICY_SUBTYPE_ID )
#####(16-04-2016)##### CHECK_CORE_APP_CODE_OPCOVER_DETAIL = select COUNT(*) FROM MOTOR_OPCOVER_DETAILS WHERE COREAPP_CODE\=? and GROUP_ID\=1
CHECK_CORE_APP_CODE_OPCOVER_DETAIL = select COUNT(*) FROM MOTOR_OPCOVER_DETAILS WHERE COREAPP_CODE\=? and GROUP_ID\=?
#####(16-04-2016)##### CHECK_OP_POLICY_EXISTS = select count(*) from motor_opcover_details where OPCOVER_ID=? and POLICY_SUBTYPE_ID=? and GROUP_ID=1
CHECK_OP_POLICY_EXISTS = select count(*) from motor_opcover_details where OPCOVER_ID=? and POLICY_SUBTYPE_ID=? and GROUP_ID=?

##Body Type Master

#####(13-01-2017)#####GET_BODYTYPE_MASTER_LIST=select BODY_ID,BODY_NAME,COREAPP_CODE,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS,(CASE REFERRAL_STATUS WHEN 'Y' THEN ' Referral' ELSE 'Non-Referral' END) REFERRAL_STATUS  From motor_bodytype_master mbm WHERE BRANCH_CODE\=?  AND AMEND_ID \= (SELECT max(AMEND_ID) FROM  motor_bodytype_master WHERE BODY_ID\=mbm.BODY_ID ) ORDER BY BODY_ID
GET_BODYTYPE_MASTER_LIST=select BODY_ID,BODY_NAME,COREAPP_CODE,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS,(CASE REFERRAL_STATUS WHEN 'Y' THEN ' Referral' ELSE 'Non-Referral' END) REFERRAL_STATUS  From motor_bodytype_master mbm WHERE BRANCH_CODE=?  AND AMEND_ID = (SELECT max(AMEND_ID) FROM  motor_bodytype_master WHERE BODY_ID=mbm.BODY_ID and BRANCH_CODE=mbm.BRANCH_CODE ) ORDER BY BODY_ID
#####(13-01-2017)#####EDIT_BODYTYPE_MASTER=select BODY_ID,BODY_NAME,COREAPP_CODE,STATUS,REFERRAL_STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE ,convert(varchar(10),ENTRY_DATE,103) ENTRY_DATE,REMARKS  From motor_bodytype_master  WHERE BODY_ID\=? AND AMEND_ID \= (SELECT max(AMEND_ID) FROM  motor_bodytype_master WHERE BODY_ID\=? ) ORDER BY BODY_ID DESC
EDIT_BODYTYPE_MASTER=select BODY_ID,BODY_NAME,COREAPP_CODE,STATUS,REFERRAL_STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE ,convert(varchar(10),ENTRY_DATE,103) ENTRY_DATE,REMARKS  From motor_bodytype_master  WHERE BODY_ID=? AND BRANCH_CODE=? AND AMEND_ID = (SELECT max(AMEND_ID) FROM  motor_bodytype_master WHERE BODY_ID=? AND BRANCH_CODE=? ) ORDER BY BODY_ID DESC
GET_MAX_AMEND_ID_BODY_TYPE=SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM motor_bodytype_master where BODY_ID=?
GET_EDIT_BODYTYPE_AMEND_ID = SELECT AMEND_ID FROM MOTOR_BODYTYPE_MASTER MBM WHERE BODY_ID = ? AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_MASTER WHERE BODY_ID = MBM.BODY_ID)  AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
BODY_TYPE_INSERT=INSERT INTO motor_bodytype_master(BODY_ID,AMEND_ID,BODY_NAME,COREAPP_CODE,STATUS,ENTRY_DATE,EFFECTIVE_DATE,REMARKS,BRANCH_CODE,REFERRAL_STATUS)values((SELECT ISNULL(MAX(BODY_ID),0)+1 FROM motor_bodytype_master),?,?,?,?,getdate(),convert(date,?,103),?,?,?)
BODY_TYPE_UPDATE=UPDATE motor_bodytype_master SET BODY_NAME\=?,COREAPP_CODE\=?,STATUS\=?,ENTRY_DATE\=getdate(),EFFECTIVE_DATE\=convert(date,?,103),REMARKS\=?,BRANCH_CODE \= ?,REFERRAL_STATUS\=? WHERE BODY_ID\=? AND AMEND_ID \=?
BODY_TYPE_UPDATE_INSERT=INSERT INTO MOTOR_BODYTYPE_MASTER(AMEND_ID,BODY_NAME,COREAPP_CODE,STATUS,ENTRY_DATE,EFFECTIVE_DATE,REMARKS,BRANCH_CODE,BODY_ID,REFERRAL_STATUS)VALUES((SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_BODYTYPE_MASTER WHERE BODY_ID=?),?,?,?,getdate(),convert(date,?,103),?,?,?,?)
VEHICLE_LINK_LIST_BODY_TYPE_MASTER=select VTYPE_ID,TYPE_OF_BODY_ID,(SELECT VEHICLETYPE_DESC FROM motor_vehicletype_master MVM WHERE MVM.VTYPE_ID=MTBM.VTYPE_ID AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM motor_vehicletype_master MM WHERE MM.VTYPE_ID=MVM.VTYPE_ID)) VEHICLETYPE_DESC, TYPE_OF_BODY_NAME,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS from MOTOR_BODYTYPE_DETAIL MTBM where BODY_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL MTM WHERE MTM.TYPE_OF_BODY_ID=MTBM.TYPE_OF_BODY_ID)
VEHICLE_LIST=select VTYPE_ID,VEHICLETYPE_DESC from  motor_vehicletype_master MV where AMEND_ID\=(SELECT MAX(AMEND_ID) FROM motor_vehicletype_master MVM WHERE MVM.VTYPE_ID\=MV.VTYPE_ID)
VEHICLE_LINK_EDIT=select VTYPE_ID,TYPE_OF_BODY_ID,TYPE_OF_BODY_NAME,STATUS from MOTOR_BODYTYPE_DETAIL MTBM where  AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL MTM WHERE MTM.TYPE_OF_BODY_ID=MTBM.TYPE_OF_BODY_ID) AND TYPE_OF_BODY_ID=?
VEHICLE_COUNT=select count(*) from MOTOR_BODYTYPE_DETAIL WHERE  BODY_ID=?
VEHICLE_COUNT1=select count(*) from MOTOR_BODYTYPE_DETAIL WHERE  TYPE_OF_BODY_ID=?
BODY_ADDED_VEHYCLE=select BODY_NAME,STATUS FROM motor_bodytype_master MBM WHERE BODY_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM motor_bodytype_master MTM WHERE MTM.BODY_ID=MBM.BODY_ID)
VEHICLE_INSERT=insert into MOTOR_BODYTYPE_DETAIL(VTYPE_ID,BODY_ID,AMEND_ID,TYPE_OF_BODY_ID,STATUS,TYPE_OF_BODY_NAME)values(?,?,?,(SELECT ISNULL(MAX(TYPE_OF_BODY_ID),0)+1 FROM MOTOR_BODYTYPE_DETAIL),?,?)
VEHICLE_BODY_TYPE_ID_INSERT=insert into MOTOR_BODYTYPE_DETAIL(VTYPE_ID,AMEND_ID,TYPE_OF_BODY_ID,STATUS,TYPE_OF_BODY_NAME,BODY_ID)values(?,(select max(AMEND_ID)+1 from MOTOR_BODYTYPE_DETAIL where TYPE_OF_BODY_ID=?),?,?,?,(select BODY_ID from MOTOR_BODYTYPE_DETAIL MK where TYPE_OF_BODY_ID=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_DETAIL MTM WHERE MTM.TYPE_OF_BODY_ID=MK.TYPE_OF_BODY_ID)))
CORE_APP_CODE_COUNT=select count(*) from motor_bodytype_master where BRANCH_CODE=? and COREAPP_CODE=? and BODY_ID!=?
CORE_APP_CODE_COUNT1=select count(*) from motor_bodytype_master where BRANCH_CODE\=? and COREAPP_CODE\=?


##VEHICLE TYPE MASTER

GET_VEHICLE_TYPE_MASTER =SELECT VTYPE_ID, VEHICLETYPE_DESC, CORE_APP_CODE,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,(CASE REFERRAL_STATUS WHEN 'Y' THEN 'Referral' ELSE 'Non-Referral' END)  REFERRAL_STATUS FROM MOTOR_VEHICLETYPE_MASTER  mvms where BRANCH_CODE\=? and amend_id\=(select max(amend_id) from MOTOR_VEHICLETYPE_MASTER mvm where mvm.BRANCH_CODE\=mvms.BRANCH_CODE and mvm.VTYPE_ID\=mvms.VTYPE_ID) order by VTYPE_ID
GET_EDIT_VEHICLE_TYPE = SELECT  VTYPE_ID,VEHICLETYPE_DESC,CORE_APP_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS,REFERRAL_STATUS,STATUS FROM   MOTOR_VEHICLETYPE_MASTER MVM WHERE   VTYPE_ID = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_VEHICLETYPE_MASTER WHERE   VTYPE_ID = MVM.VTYPE_ID) AND MVM.BRANCH_CODE = ?
GET_MAX_VTYPE_ID = SELECT ISNULL(MAX(VTYPE_ID),0)+1 FROM MOTOR_VEHICLETYPE_MASTER
GET_EDIT_VTYPE_AMEND_ID = SELECT AMEND_ID FROM   MOTOR_VEHICLETYPE_MASTER MVM WHERE   VTYPE_ID \= ? AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_VEHICLETYPE_MASTER WHERE   VTYPE_ID \= MVM.VTYPE_ID) AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
GET_VEHICLETYPE_INSERT = INSERT INTO MOTOR_VEHICLETYPE_MASTER(VTYPE_ID,VEHICLETYPE_DESC,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE,CORE_APP_CODE,REFERRAL_STATUS,PRODUCT_ID) VALUES (?,?,?,CONVERT(DATE,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_VEHICLETYPE_MASTER WHERE VTYPE_ID\=? ),?,?,?,?)
UPDATE_VEHICLETYPE_MASTER =UPDATE MOTOR_VEHICLETYPE_MASTER  SET VEHICLETYPE_DESC\=?,STATUS\=?,EFFECTIVE_DATE\=CONVERT(DATE,?,103),REMARKS\=?,BRANCH_CODE\=?,CORE_APP_CODE\=?,REFERRAL_STATUS\=?,PRODUCT_ID\=? WHERE VTYPE_ID \= ? AND AMEND_ID \=?
CHECK_CORE_APP_CODE = select COUNT(*) FROM MOTOR_VEHICLETYPE_MASTER MVM WHERE   CORE_APP_CODE\=? AND BRANCH_CODE\=? AND STATUS\='Y' AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_VEHICLETYPE_MASTER WHERE   VTYPE_ID\=MVM.VTYPE_ID)

##Policy Type Master
GET_POLICY_TYPE_MASTER_LIST =SELECT POLICYTYPE_ID,COREAPP_CODE,POLICYTYPE_DESC_ENGLISH,POLICYTYPE_DESC_ARABIC,(CASE PAYMENT_YN WHEN 'Y' THEN 'Yes' ELSE 'No' END) PAYMENT_YN,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE ,REMARKS,POLICY_SUBTYPE_ID FROM  MOTOR_POLICYTYPE_MASTER MPM  WHERE BRANCH_CODE \= ? AND AMEND_ID \= (SELECT MAX(AMEND_ID) FROM  MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID \= MPM.POLICY_SUBTYPE_ID) ORDER BY POLICY_SUBTYPE_ID DESC
GET_EDIT_POLICY_TYPE_MASTER = SELECT POLICYTYPE_ID,PAYMENT_YN,COREAPP_CODE,POLICYTYPE_DESC_ENGLISH,POLICYTYPE_DESC_ARABIC,STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS FROM MOTOR_POLICYTYPE_MASTER MPM WHERE POLICY_SUBTYPE_ID =? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID= MPM.POLICY_SUBTYPE_ID)
GET_MAIN_POLICY_TYPE_LIST = SELECT ITEM_CODE,ITEM_VALUE FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE='POLICYTYPE' ORDER BY ITEM_CODE ASC
GET_MAX_POLICY_SUB_ID = SELECT   ISNULL(MAX (POLICY_SUBTYPE_ID)+1,0) FROM   MOTOR_POLICYTYPE_MASTER
GET_EDIT_POLICY_TYPE_AMEND_ID = SELECT AMEND_ID FROM  MOTOR_POLICYTYPE_MASTER MPM WHERE POLICY_SUBTYPE_ID \= ? AND AMEND_ID \= ( SELECT MAX(AMEND_ID) FROM  MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID \= MPM.POLICY_SUBTYPE_ID)  AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
INS_POLICY_TYPE_MASTER = INSERT INTO MOTOR_POLICYTYPE_MASTER (POLICYTYPE_ID,COREAPP_CODE,POLICYTYPE_DESC_ENGLISH,POLICYTYPE_DESC_ARABIC,STATUS,EFFECTIVE_DATE,REMARKS,BRANCH_CODE,AMEND_ID,POLICY_SUBTYPE_ID,PAYMENT_YN) VALUES (?,?,?,?,?,CONVERT(DATE,?,103),?,?,(SELECT   ISNULL(MAX (AMEND_ID)+1,0) FROM   MOTOR_POLICYTYPE_MASTER WHERE   POLICY_SUBTYPE_ID = ?),?,?)
UPD_POLICY_TYPE_MASTER = UPDATE MOTOR_POLICYTYPE_MASTER  SET POLICYTYPE_ID=?,COREAPP_CODE=?,POLICYTYPE_DESC_ENGLISH=?,POLICYTYPE_DESC_ARABIC=?,STATUS=?,EFFECTIVE_DATE=CONVERT(DATE,?,103),REMARKS=?,PAYMENT_YN=? WHERE POLICY_SUBTYPE_ID =? AND AMEND_ID = ?
CHECK_POLICYTYPE_CORE_CODE = SELECT COUNT(*) FROM MOTOR_POLICYTYPE_MASTER MPM WHERE COREAPP_CODE \=? AND BRANCH_CODE \= ? AND STATUS\='Y' AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_POLICYTYPE_MASTER WHERE   POLICYTYPE_ID\=MPM.POLICYTYPE_ID)

##NCB Master
#####(16-04-2016)##### GET_NCB_MASTER_DATA_LIST = SELECT S_NO,POLICYTYPE,NCBYEAR,INSUREDVALUE_START,INSUREDVALUE_END,RATE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,convert(varchar(10),EXPIRY_DATE,103) EXPIRY_DATE,AMEND_ID,BRANCH_CODE,RATE_TYPE,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS,CORE_CODE FROM MOTOR_NCB_MASTER MNM WHERE  BRANCH_CODE \= ? AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE   S_NO \= MNM.S_NO)
##########GET_NCB_MASTER_DATA_LIST = SELECT   MNM.S_NO,MP.POLICYTYPE_DESC_ENGLISH POLICYTYPE,MNM.NCBYEAR,MNM.INSUREDVALUE_START,MNM.INSUREDVALUE_END,MNM.RATE,convert(varchar(10),MNM.EFFECTIVE_DATE,103) EFFECTIVE_DATE,convert(varchar(10),MNM.EXPIRY_DATE,103) EXPIRY_DATE,MNM.AMEND_ID,MNM.BRANCH_CODE,MNM.RATE_TYPE,LIV.ITEM_VALUE VEHICLE_USAGE,(CASE  MNM.STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS,MNM.CORE_CODE FROM   MOTOR_NCB_MASTER MNM, LIST_ITEM_VALUE LIV,MOTOR_POLICYTYPE_MASTER MP  WHERE   MNM.BRANCH_CODE = ? AND LIV.ITEM_TYPE='NCBVEHICLE' AND LIV.ITEM_CODE =MNM.VTYPE_ID AND MP.POLICY_SUBTYPE_ID=MNM.POLICYTYPE AND MNM.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE   S_NO = MNM.S_NO)
#GET_EDIT_NCB_MASTER = SELECT   S_NO,NCBYEAR,INSUREDVALUE_START, INSUREDVALUE_END, RATE, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, convert(varchar(10),EFFECTIVE_DATE,103) EXPIRY_DATE, AMEND_ID, BRANCH_CODE, RATE_TYPE, STATUS, CORE_CODE FROM   MOTOR_NCB_MASTER MNM WHERE   S_NO = ? AND BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE  NCBYEAR = MNM.NCBYEAR)
#####(16-04-2016)##### GET_EDIT_NCB_MASTER = SELECT   S_NO,NCBYEAR,INSUREDVALUE_START, INSUREDVALUE_END,RATE, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, convert(varchar(10),EFFECTIVE_DATE,103) EXPIRY_DAT, AMEND_ID, BRANCH_CODE, RATE_TYPE, STATUS, CORE_CODE FROM   MOTOR_NCB_MASTER MNM WHERE   S_NO = ? AND BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE  S_NO = MNM.S_NO)
GET_EDIT_NCB_MASTER = SELECT   S_NO,POLICYTYPE,NCD_FROM,NCD_TO,RATING_TYPE,RATE, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, convert(varchar(10),EFFECTIVE_DATE,103) EXPIRY_DATE, AMEND_ID,BRANCH_CODE, RATING_TYPE, STATUS,REMARKS FROM   MOTOR_NCB_MASTER MNM where S_NO=? AND BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE  S_NO = MNM.S_NO)
GET_EDIT_LOYALITY_MASTER= SELECT   S_NO,POLICYTYPE,Renewal_Status_Id,Renewal_Status_DESC,RATING_TYPE,RATE, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,AMEND_ID,BRANCH_CODE, RATING_TYPE, STATUS,REMARKS FROM  MOTOR_LOYALITY_DIS_MASTER MNM where S_NO=? AND BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM MOTOR_LOYALITY_DIS_MASTER WHERE  S_NO = MNM.S_NO)
GET_EDIT_CLAIM_LOAD_MASTER= SELECT   S_NO,POLICYTYPE,NO_OF_CLAIM_START,NO_OF_CLAIM_END,RATING_TYPE,RATE, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,AMEND_ID,BRANCH_CODE, RATING_TYPE, STATUS,REMARKS FROM MOTOR_CLAIMLOAD_MASTER MNM where S_NO=? AND BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM MOTOR_CLAIMLOAD_MASTER WHERE  S_NO = MNM.S_NO)
GET_EDIT_DRIVERAGE_MASTER = SELECT   S_NO,POLICYTYPE,DRIVER_AGE_START,DRIVER_AGE_END,RATING_TYPE,RATE, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,AMEND_ID,BRANCH_CODE, RATING_TYPE, STATUS,REMARKS FROM MOTOR_DRIVERAGE_MASTER MNM where S_NO=? AND BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM MOTOR_DRIVERAGE_MASTER WHERE  S_NO = MNM.S_NO)
GET_COUNT_NCB = SELECT COUNT(*) FROM MOTOR_NCB_MASTER MNM WHERE NCBYEAR \=? AND BRANCH_CODE \=? AND STATUS\='Y' AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE   S_NO \= MNM.S_NO)
CHECK_NCB_CORE_CODE = SELECT COUNT(*) FROM MOTOR_NCB_MASTER MNM WHERE CORE_CODE \=? AND BRANCH_CODE \=? AND STATUS\='Y' AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE   S_NO \= MNM.S_NO)
GET_MAX_NCB_ID = SELECT ISNULL(MAX(S_NO)+1,0) FROM MOTOR_NCB_MASTER
GET_EDIT_NCB_AMEND_ID = SELECT   AMEND_ID FROM   MOTOR_NCB_MASTER NCB WHERE       AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_NCB_MASTER WHERE   S_NO = NCB.S_NO) AND S_NO = ? AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
GET_EDIT_LOYALITY_AMEND_ID=SELECT   AMEND_ID FROM MOTOR_LOYALITY_DIS_MASTER MM WHERE       AMEND_ID = (SELECT   MAX (AMEND_ID) FROM MOTOR_LOYALITY_DIS_MASTER WHERE   S_NO = MM.S_NO) AND S_NO = ? AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
GET_EDIT_Claim_Load_AMEND_ID= SELECT   AMEND_ID FROM MOTOR_CLAIMLOAD_MASTER MM WHERE       AMEND_ID = (SELECT   MAX (AMEND_ID) FROM MOTOR_CLAIMLOAD_MASTER WHERE   S_NO = MM.S_NO) AND S_NO = ? AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
GET_EDIT_DRIVERAGE_AMEND_ID= SELECT   AMEND_ID FROM MOTOR_DRIVERAGE_MASTER MM WHERE       AMEND_ID = (SELECT   MAX (AMEND_ID) FROM MOTOR_DRIVERAGE_MASTER WHERE   S_NO = MM.S_NO) AND S_NO = ? AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
#####(16-04-2016)##### INS_NCB_MASTER = INSERT INTO MOTOR_NCB_MASTER (PRODUCT_ID,POLICYTYPE,NCBYEAR,INSUREDVALUE_START,INSUREDVALUE_END,RATE,EFFECTIVE_DATE,S_NO,AMEND_ID,BRANCH_CODE,STATUS,CORE_CODE,VTYPE_ID) VALUES (?,?,?,?,?,?,CONVERT(DATE,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_NCB_MASTER WHERE S_NO =?),?,?,?,?)
###INS_NCB_MASTER = INSERT INTO MOTOR_NCB_MASTER (PRODUCT_ID,POLICYTYPE,NCBYEAR,INSUREDVALUE_START,INSUREDVALUE_END,RATE,EFFECTIVE_DATE,S_NO,AMEND_ID,BRANCH_CODE,STATUS,CORE_CODE,VTYPE_ID) VALUES (?,?,?,?,?,?,CONVERT(DATE,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_NCB_MASTER WHERE S_NO =?),?,?,?,?)
INS_NCB_MASTER = INSERT INTO MOTOR_NCB_MASTER  (S_NO,POLICYTYPE,NCD_FROM,NCD_TO,RATE,RATING_TYPE,EFFECTIVE_DATE,AMEND_ID,STATUS,REMARKS,BRANCH_CODE,PRODUCT_ID)VALUES ((SELECT MAX(ISNULL(S_NO,0))+1 FROM MOTOR_NCB_MASTER),?,?,?,?,?,CONVERT (DATE, ?, 103),(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_NCB_MASTER WHERE S_NO =?),?,?,'01','65')
INS_LOYALITY_MASTER=INSERT INTO MOTOR_LOYALITY_DIS_MASTER  (S_NO,POLICYTYPE,Renewal_Status_Id,Renewal_Status_DESC,RATE,RATING_TYPE,EFFECTIVE_DATE,AMEND_ID,STATUS,REMARKS,BRANCH_CODE,PRODUCT_ID)VALUES ((SELECT MAX(ISNULL(S_NO,0))+1 FROM MOTOR_LOYALITY_DIS_MASTER),?,?,?,?,?,CONVERT (DATE, ?, 103),(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_LOYALITY_DIS_MASTER WHERE S_NO =?),?,?,'01','65')
INS_AM_LOYALITY_MASTER=INSERT INTO MOTOR_LOYALITY_DIS_MASTER  (S_NO,POLICYTYPE,Renewal_Status_Id,Renewal_Status_DESC,RATE,RATING_TYPE,EFFECTIVE_DATE,AMEND_ID,STATUS,REMARKS,BRANCH_CODE,PRODUCT_ID)VALUES ((SELECT MAX(ISNULL(S_NO,0))+1 FROM MOTOR_LOYALITY_DIS_MASTER),?,?,?,?,?,CONVERT (DATE, ?, 103),(select  max(amend_id)   from MOTOR_LOYALITY_DIS_MASTER  where policytype=? and renewal_status_id=?)+1 ,?,?,'01','65')
INS_CLAIM_LOAD_MASTER= INSERT INTO MOTOR_CLAIMLOAD_MASTER  (S_NO,POLICYTYPE,NO_OF_CLAIM_START,NO_OF_CLAIM_END,RATE,RATING_TYPE,EFFECTIVE_DATE,AMEND_ID,STATUS,REMARKS,BRANCH_CODE,PRODUCT_ID)VALUES ((SELECT MAX(ISNULL(S_NO,0))+1 FROM MOTOR_CLAIMLOAD_MASTER),?,?,?,?,?,CONVERT (DATE, ?, 103),(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_CLAIMLOAD_MASTER WHERE S_NO =?),?,?,'01','65')
INS_DRIVERAGE_MASTER= INSERT INTO MOTOR_DRIVERAGE_MASTER (S_NO,POLICYTYPE,DRIVER_AGE_START,DRIVER_AGE_END,RATE,RATING_TYPE,EFFECTIVE_DATE,AMEND_ID,STATUS,REMARKS,BRANCH_CODE,PRODUCT_ID)VALUES ((SELECT MAX(ISNULL(S_NO,0))+1 FROM MOTOR_DRIVERAGE_MASTER),?,?,?,?,?,CONVERT (DATE, ?, 103),(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_DRIVERAGE_MASTER WHERE S_NO =?),?,?,'01','65')
##UPD_NCB_MASTER = UPDATE MOTOR_NCB_MASTER MNM SET PRODUCT_ID\=?,NCBYEAR\=?,INSUREDVALUE_START\=?,INSUREDVALUE_END\=?,RATE\=?,EFFECTIVE_DATE\=TO_DATE(?,'DD/MM/YYYY'),BRANCH_CODE\=?,STATUS\=?,CORE_CODE \=? WHERE S_NO \=? AND  AMEND_ID \= (SELECT MAX(AMEND_ID) FROM MOTOR_NCB_MASTER WHERE  S_NO \= MNM.S_NO)
#####(16-04-2016)##### UPD_NCB_MASTER = UPDATE MOTOR_NCB_MASTER  SET PRODUCT_ID\=?,NCBYEAR\=?,INSUREDVALUE_START\=? ,INSUREDVALUE_END\=?,RATE\=?,EFFECTIVE_DATE\=CONVERT(DATE,?,103), BRANCH_CODE\=?,STATUS\=?,CORE_CODE \=? WHERE S_NO \=? AND  AMEND_ID \= ?
UPD_NCB_MASTER = update MOTOR_NCB_MASTER  set EFFECTIVE_DATE\=CONVERT (DATE, ?, 103),RATE\=?,status\=?,remarks\=?,RATING_TYPE\=?,NCD_FROM\=?,NCD_TO\=? where  S_NO\=?  and amend_id\=?
##UPD_LOYALITY_MASTER = update MOTOR_LOYALITY_DIS_MASTER  set EFFECTIVE_DATE\=CONVERT (DATE, ?, 103),RATE\=?,status\=?,remarks\=? where  S_NO\=?  and amend_id\=? and Renewal_Status_Id\=? 
UPD_LOYALITY_MASTER =update MOTOR_LOYALITY_DIS_MASTER  set EFFECTIVE_DATE\=CONVERT (DATE, ?, 103),RATE\=?,status\=?,remarks\=?,renewal_status_desc\=?,RATING_TYPE\=? where  S_NO\=?  and amend_id\=? and Renewal_Status_Id\=?
###UPD_CLAIM_LOAD_MASTER=update MOTOR_CLAIMLOAD_MASTER  set EFFECTIVE_DATE=CONVERT (DATE, ?, 103),RATE=?,status=?,remarks=? where  S_NO=?  and amend_id=? and NO_OF_CLAIM_START=? AND NO_OF_CLAIM_END=?
UPD_CLAIM_LOAD_MASTER=update MOTOR_CLAIMLOAD_MASTER  set EFFECTIVE_DATE\=CONVERT (DATE, ?, 103),RATE\=?,status\=?,remarks\=?,RATING_TYPE\=?,NO_OF_CLAIM_START\=?,NO_OF_CLAIM_END\=? where  S_NO\=?  and amend_id\=? 
###UPD_DRIVERAGE_MASTER= update MOTOR_DRIVERAGE_MASTER_PRA  set EFFECTIVE_DATE=CONVERT (DATE, ?, 103),RATE=?,status=?,remarks=? where  S_NO=?  and amend_id=? and DRIVER_AGE_START=? AND DRIVER_AGE_END=?
UPD_DRIVERAGE_MASTER=update MOTOR_DRIVERAGE_MASTER  set EFFECTIVE_DATE\=CONVERT (DATE, ?, 103),RATE\=?,status\=?,remarks\=?,RATING_TYPE\=?,driver_age_start\=?,driver_age_end\=? where  S_NO\=?  and amend_id\=? 
GET_NCB_VEHICLE_USAGE = SELECT ITEM_CODE,ITEM_VALUE FROM LIST_ITEM_VALUE WHERE ITEM_TYPE='NCBVEHICLE' ORDER BY ITEM_CODE ASC
Get_Count_Amend_Id=select count(*) from MOTOR_LOYALITY_DIS_MASTER   where policytype=?  and Renewal_Status_Id=? and branch_code=?

###############NCB NEW ############
GET_NCB_MASTER_DATA_LIST=SELECT (select distinct(POLICYTYPE_NAME) from motor_policytype_master mp where mp.POLICY_SUBTYPE_ID\=mn.POLICYTYPE) POLICYTYPE_NAME, NCD_FROM, NCD_TO, RATE, RATING_TYPE,  FORMAT(EFFECTIVE_DATE,'dd/MM/yyyy') EFFECTIVE_DATE,S_NO,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) status FROM MOTOR_NCB_MASTER mn WHERE BRANCH_CODE \=? 
###GET_LOYALITY_DIS_LIST=SELECT POLICYTYPE ,(select distinct(POLICYTYPE_NAME) from motor_policytype_master mp where mp.POLICY_SUBTYPE_ID=mn.POLICYTYPE and amend_id=(select max(amend_id) from motor_policytype_master where POLICY_SUBTYPE_ID=mn.POLICYTYPE ) ) POLICYTYPE_NAME,mn.POLICYTYPE,Renewal_Status_Id,Renewal_Status_DESC,RATE, RATING_TYPE, EFFECTIVE_DATE,S_NO ,amend_id,status FROM MOTOR_LOYALITY_DIS_MASTER mn WHERE BRANCH_CODE =? and amend_id= (select max(amend_id) from MOTOR_LOYALITY_DIS_MASTER where policytype=mn.policytype and Renewal_Status_Id=mn.Renewal_Status_Id) and status='Y' order by mn.POLICYTYPE,mn.Renewal_Status_Id
GET_LOYALITY_DIS_LIST=SELECT POLICYTYPE ,(select distinct(POLICYTYPE_NAME) from motor_policytype_master mp where mp.POLICY_SUBTYPE_ID=mn.POLICYTYPE and amend_id=(select max(amend_id) from motor_policytype_master where POLICY_SUBTYPE_ID=mn.POLICYTYPE and cast(effective_date as date) <=cast(getdate() as date)) ) POLICYTYPE_NAME,Renewal_Status_Id,Renewal_Status_DESC,RATE, RATING_TYPE, FORMAT(EFFECTIVE_DATE,'dd/MM/yyyy') EFFECTIVE_DATE,S_NO ,amend_id,(case when status = 'Y' then 'Active' else 'De-Active' end)status FROM MOTOR_LOYALITY_DIS_MASTER mn WHERE BRANCH_CODE =? and amend_id= (select max(amend_id) from MOTOR_LOYALITY_DIS_MASTER where policytype=mn.policytype and Renewal_Status_Id=mn.Renewal_Status_Id)
GET_CLAIM_LOAD_LIST=SELECT (select distinct(POLICYTYPE_NAME) from motor_policytype_master mp where mp.POLICY_SUBTYPE_ID=mn.POLICYTYPE) POLICYTYPE_NAME,NO_OF_CLAIM_START,NO_OF_CLAIM_END,RATE, RATING_TYPE, FORMAT(EFFECTIVE_DATE,'dd/MM/yyyy') EFFECTIVE_DATE,S_NO, (CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) status FROM MOTOR_CLAIMLOAD_MASTER mn WHERE BRANCH_CODE =?
GET_DRIVERAGE_LIST= SELECT (select distinct(POLICYTYPE_NAME) from motor_policytype_master mp where mp.POLICY_SUBTYPE_ID=mn.POLICYTYPE) POLICYTYPE_NAME,DRIVER_AGE_START, DRIVER_AGE_END,RATE, RATING_TYPE, FORMAT(EFFECTIVE_DATE,'dd/MM/yyyy') EFFECTIVE_DATE,S_NO, (case status when 'Y' then 'Active' else 'De-Active' end) status FROM  MOTOR_DRIVERAGE_MASTER mn WHERE BRANCH_CODE =?

##Constant Details
GET_CONSTANT_MASTER_LIST = SELECT DISTINCT ITEM_TYPE FROM LIST_ITEM_VALUE

##BANK FINANCE MASTER

GET_BANK_FINANCE_MASTER = SELECT BANK_ID, BANK_CODE, BANK_NAME_ENGLISH, BANK_NAME_ARABIC,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM MOTOR_FINANCE_BANK_MASTER  mfbm where BRANCH_CODE\=? and amend_id\=(select max(amend_id) from MOTOR_FINANCE_BANK_MASTER mfm where mfm.BRANCH_CODE\=mfbm.BRANCH_CODE and mfm.BANK_ID\=mfbm.BANK_ID) order by BANK_ID
#####(16-04-2016)##### GET_EDIT_BANK_FINANCE = SELECT  BANK_ID,BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS,STATUS FROM   MOTOR_FINANCE_BANK_MASTER MFBM WHERE   BANK_ID = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_FINANCE_BANK_MASTER WHERE   BANK_ID = MFBM.BANK_ID) AND MFBM.BRANCH_CODE = ?
GET_EDIT_BANK_FINANCE = SELECT  BANK_ID,BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS,STATUS,ADDRESS1,ADDRESS2,TELEPHONE FROM   MOTOR_FINANCE_BANK_MASTER MFBM WHERE   BANK_ID = ? AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_FINANCE_BANK_MASTER WHERE   BANK_ID = MFBM.BANK_ID) AND MFBM.BRANCH_CODE = ?
GET_MAX_BANK_ID = SELECT ISNULL(MAX(BANK_ID),0)+1 FROM MOTOR_FINANCE_BANK_MASTER
GET_EDIT_FBANK_AMEND_ID = SELECT AMEND_ID FROM MOTOR_FINANCE_BANK_MASTER  MFBM WHERE BANK_ID\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_FINANCE_BANK_MASTER MFM WHERE  MFM.BANK_ID\=MFBM.BANK_ID) AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
#####(16-04-2016)##### GET_BANK_FINANCE_INSERT = INSERT INTO MOTOR_FINANCE_BANK_MASTER(BANK_ID,BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE) VALUES (?,?,?,?,?,CONVERT(DATE,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_FINANCE_BANK_MASTER WHERE BANK_ID=?),?)
GET_BANK_FINANCE_INSERT = INSERT INTO MOTOR_FINANCE_BANK_MASTER(BANK_ID,BANK_CODE,BANK_NAME_ENGLISH,BANK_NAME_ARABIC,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE,ADDRESS1,ADDRESS2,TELEPHONE) VALUES (?,?,?,?,?,CONVERT(DATE,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_FINANCE_BANK_MASTER WHERE BANK_ID=?),?,?,?,?)
#####(16-04-2016)##### UPDATE_BANK_FINANCE_MASTER =UPDATE MOTOR_FINANCE_BANK_MASTER  SET BANK_CODE\=?,BANK_NAME_ENGLISH\=?,BANK_NAME_ARABIC\=?,STATUS\=?,EFFECTIVE_DATE\=CONVERT(DATE,?,103),REMARKS\=?,BRANCH_CODE\=? WHERE BANK_ID \= ? AND AMEND_ID \=?
UPDATE_BANK_FINANCE_MASTER = UPDATE MOTOR_FINANCE_BANK_MASTER  SET BANK_CODE\=?,BANK_NAME_ENGLISH\=?,BANK_NAME_ARABIC\=?,STATUS\=?,EFFECTIVE_DATE\=CONVERT(DATE,?,103),REMARKS\=?,ADDRESS1\=?,ADDRESS2\=?,TELEPHONE\=?,BRANCH_CODE\=? WHERE BANK_ID \= ? AND AMEND_ID \=?
CHECK_BANK_CODE =select COUNT(*) FROM MOTOR_FINANCE_BANK_MASTER MFBM WHERE BANK_CODE\=? AND BRANCH_CODE\=? AND STATUS\='Y' AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_FINANCE_BANK_MASTER WHERE   BANK_ID\=MFBM.BANK_ID)

##Group Master
GET_GROUP_MASTER = SELECT GROUP_ID, GROUP_DESC_ENGLISH,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,DISPLAY_ORDER FROM MOTOR_GROUP_MASTER  mgmm where BRANCH_CODE\=? and amend_id\=(select max(amend_id) from MOTOR_GROUP_MASTER mgm where mgm.BRANCH_CODE\=mgmm.BRANCH_CODE and mgm.GROUP_ID\=mgmm.GROUP_ID) order by GROUP_ID
GET_EDIT_GROUP_MASTER = SELECT GROUP_ID,GROUP_DESC_ENGLISH,DISPLAY_ORDER,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,REMARKS,STATUS FROM   MOTOR_GROUP_MASTER MGM WHERE   GROUP_ID \= ? AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_GROUP_MASTER WHERE   GROUP_ID \= MGM.GROUP_ID) AND MGM.BRANCH_CODE \= ?
GET_MAX_GROUP_ID = SELECT ISNULL(MAX(GROUP_ID),0)+1 FROM MOTOR_GROUP_MASTER
GET_EDIT_GROUP_AMEND_ID = SELECT AMEND_ID FROM MOTOR_GROUP_MASTER  MGMM WHERE GROUP_ID \= ? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_GROUP_MASTER MGM WHERE  MGM.GROUP_ID\=MGMM.GROUP_ID)  AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
GET_GROUP_INSERT = INSERT INTO MOTOR_GROUP_MASTER(GROUP_ID, GROUP_DESC_ENGLISH,STATUS,EFFECTIVE_DATE,REMARKS,AMEND_ID,BRANCH_CODE,DISPLAY_ORDER) VALUES (?,?,?,convert(date,?,103),?,(SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_GROUP_MASTER WHERE GROUP_ID\=?),?,?)
GET_GROUP_UPDATE = UPDATE MOTOR_GROUP_MASTER  SET GROUP_DESC_ENGLISH\=?,STATUS\=?,EFFECTIVE_DATE\=convert(date,?,103),REMARKS\=?,BRANCH_CODE\=?,DISPLAY_ORDER\=? WHERE GROUP_ID\= ? AND AMEND_ID \=?
CHECK_DISPLAY_ORDER = SELECT COUNT(*) FROM MOTOR_GROUP_MASTER WHERE DISPLAY_ORDER\=? AND BRANCH_CODE\=? 

##BANK MASTER
GET_BANK_MASTER_LIST = SELECT BANK_ID, BANK_CODE, BANK_NAME_ENGLISH, BANK_NAME_ARABIC,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END)  STATUS, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM MOTOR_BANK_MASTER MB WHERE   BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (MBM.AMEND_ID) FROM   MOTOR_BANK_MASTER MBM WHERE   MBM.BANK_ID = MB.BANK_ID) ORDER BY   BANK_ID
#####(16-04-2016)##### EDIT_BANK_MASTER_ADMIN = SELECT BANK_ID, BANK_CODE, BANK_NAME_ENGLISH, BANK_NAME_ARABIC, STATUS, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, REMARKS FROM MOTOR_BANK_MASTER MB WHERE   BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (MBM.AMEND_ID) FROM   MOTOR_BANK_MASTER MBM WHERE   MBM.BANK_ID = MB.BANK_ID) AND BANK_ID= ? ORDER BY   BANK_ID DESC
EDIT_BANK_MASTER_ADMIN = SELECT BANK_ID, BANK_CODE, BANK_NAME_ENGLISH, BANK_NAME_ARABIC, STATUS, convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, REMARKS,ADDRESS1,ADDRESS2,TELEPHONE FROM MOTOR_BANK_MASTER MB WHERE   BRANCH_CODE = ? AND AMEND_ID = (SELECT   MAX (MBM.AMEND_ID) FROM   MOTOR_BANK_MASTER MBM WHERE   MBM.BANK_ID = MB.BANK_ID) AND BANK_ID= ? ORDER BY   BANK_ID DESC
GET_EDIT_BANK_AMEND_ID = SELECT AMEND_ID FROM MOTOR_BANK_MASTER MB WHERE   BANK_ID = ? AND AMEND_ID = (SELECT   MAX (MBM.AMEND_ID) FROM   MOTOR_BANK_MASTER MBM WHERE   MBM.BANK_ID = MB.BANK_ID)  AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
GET_MAX_BANKID = SELECT ISNULL(MAX(BANK_ID),0)+1 FROM MOTOR_BANK_MASTER
#####(16-04-2016)##### INSERT_BANK_MASTER = Insert into MOTOR_BANK_MASTER(BANK_ID, AMEND_ID, BANK_CODE, BANK_NAME_ENGLISH, BANK_NAME_ARABIC, STATUS,EFFECTIVE_DATE, REMARKS, BRANCH_CODE) Values(?, (SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_BANK_MASTER WHERE BANK_ID= ?), ?, ?, ?, ?, convert(date,?,103),?, ?)
INSERT_BANK_MASTER = Insert into MOTOR_BANK_MASTER(BANK_ID, AMEND_ID, BANK_CODE, BANK_NAME_ENGLISH, BANK_NAME_ARABIC, STATUS,EFFECTIVE_DATE, REMARKS, BRANCH_CODE,ADDRESS1,ADDRESS2,TELEPHONE) Values(?, (SELECT ISNULL(MAX(AMEND_ID)+1,0) FROM MOTOR_BANK_MASTER WHERE BANK_ID= ?), ?, ?, ?, ?, convert(date,?,103),?, ?,?,?,?)
#####(16-04-2016)##### UPDATE_BANK_MASTER_ADMIN = UPDATE MOTOR_BANK_MASTER  SET BANK_CODE=?, BANK_NAME_ENGLISH=?, BANK_NAME_ARABIC=?, STATUS=?,EFFECTIVE_DATE=convert(date,?,103), REMARKS=? WHERE BANK_ID = ? AND AMEND_ID = ?
UPDATE_BANK_MASTER_ADMIN = UPDATE MOTOR_BANK_MASTER  SET BANK_CODE=?, BANK_NAME_ENGLISH=?, BANK_NAME_ARABIC=?, STATUS=?,EFFECTIVE_DATE=convert(date,?,103), REMARKS=?,ADDRESS1=?,ADDRESS2=?,TELEPHONE=? WHERE BANK_ID = ? AND AMEND_ID = ?
CHECK_BANKK_CODE = select COUNT(*) FROM MOTOR_BANK_MASTER MBM WHERE BANK_CODE\=? AND BRANCH_CODE\=? AND STATUS\='Y' AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   MOTOR_BANK_MASTER WHERE   BANK_ID\=MBM.BANK_ID)


## PAYMENT MASTER
GET_PAYMENT_MAS_LIST = SELECT PAYMENT_ID,SOURCE_ENVIRONMENT, ACCESS_CODE, MERCHANT_IDENTIFIER,CURRENCY_TYPE,LANGUAGE, ORDER_DESCRIPTION,ECI,RETURN_URL,COMMAND,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS,REMARKS FROM PAYMENT_MASTER
Get_EDIT_PAYMENT_PROCESS = SELECT PAYMENT_ID,SOURCE_ENVIRONMENT, ACCESS_CODE, MERCHANT_IDENTIFIER,CURRENCY_TYPE,LANGUAGE, ORDER_DESCRIPTION,ECI,RETURN_URL,COMMAND,STATUS,REMARKS FROM PAYMENT_MASTER WHERE PAYMENT_ID=?
UPDATE_PAY_MAS = UPDATE PAYMENT_MASTER SET ACCESS_CODE=?,MERCHANT_IDENTIFIER=?,SOURCE_ENVIRONMENT=?,CURRENCY_TYPE=?,COMMAND=?,LANGUAGE=?,ORDER_DESCRIPTION=?,ECI=?,RETURN_URL=?, STATUS=?,REMARKS=? ,ENTRY_DATE=getdate()+8/24 WHERE PAYMENT_ID=?
INSERT_PAY_MAS = INSERT INTO PAYMENT_MASTER (ACCESS_CODE, MERCHANT_IDENTIFIER,SOURCE_ENVIRONMENT,CURRENCY_TYPE, COMMAND, LANGUAGE,ORDER_DESCRIPTION, ECI, RETURN_URL,STATUS,REMARKS,ENTRY_DATE,PAYMENT_ID) VALUES (?,?,?,?,?,?,?,?,?,?,?,getdate()+8/24,(SELECT ISNULL(MAX(PAYMENT_ID),0)+1 FROM PAYMENT_MASTER))
CHECK_SOURCE = SELECT COUNT(*) FROM PAYMENT_MASTER WHERE SOURCE_ENVIRONMENT = ? AND STATUS = 'Y'


##MFG COUNTRY MASTER

GET_MFGCOUNTRY_MASTER_LIST = SELECT COUNTRY_ID, COUNTRY_CODE, COUNTRY_NAME,(CASE  STATUS WHEN  'Y' THEN  'Active' ELSE  'Deactive' END) STATUS,  convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, COREAPPCODE, NATIONALITY_NAME FROM motor_mfg_country_master MB WHERE   BRANCH_CODE = ?  ORDER BY   COUNTRY_ID
EDIT_MFGCOUNTRY_MASTER = SELECT COUNTRY_ID, COUNTRY_CODE, COUNTRY_NAME, STATUS,  convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE, COREAPPCODE, NATIONALITY_NAME, REMARKS FROM motor_mfg_country_master MB WHERE   BRANCH_CODE = ? AND COUNTRY_ID = ? ORDER BY   COUNTRY_ID
INSERT_MFGCOUNTRY_MASTER = Insert into MOTOR_MFG_COUNTRY_MASTER(COUNTRY_ID, COUNTRY_CODE, COUNTRY_NAME, STATUS, ENTRY_DATE, COREAPPCODE, REMARKS, BRANCH_CODE, NATIONALITY_NAME, EFFECTIVE_DATE) Values(?, ?, ?, ?, getdate(), ?, ?, ?, ?, convert(date,?,103))
UPDATE_MFGCOUNTRY_MASTER = UPDATE MOTOR_MFG_COUNTRY_MASTER SET COUNTRY_CODE = ?, COUNTRY_NAME = ?, STATUS =?, COREAPPCODE =?, REMARKS =?, NATIONALITY_NAME =?, EFFECTIVE_DATE =convert(date,?,103) WHERE COUNTRY_ID= ?
GET_MAX_MFGCOUNTRYID = SELECT ISNULL(MAX(COUNTRY_ID),0)+1 FROM MOTOR_MFG_COUNTRY_MASTER


GET_COUNTRY_DROP_DOWN_LIST = SELECT COUNTRY_ID CODE,COUNTRY_NAME CODEDESC FROM MOTOR_MFG_COUNTRY_MASTER WHERE BRANCH_CODE = ?
GET_MAKE_DROP_DOWN = SELECT MAKE_ID CODE, MAKE_NAME CODEDESC  FROM  MOTOR_MAKE_MASTER MMM WHERE  BRANCH_CODE=?  AND AMEND_ID  = (SELECT MAX(AMEND_ID) FROM MOTOR_VEHICLETYPE_MASTER WHERE  MAKE_ID=MMM.MAKE_ID) ORDER BY MAKE_NAME
#!--Motor Admin Master End -->

##### MOTOR QUOTATION STATUS START #####
#

GET_PAYMENT_TYPE = SELECT ITEM_CODE,ITEM_VALUE,ITEM_DESC FROM LIST_ITEM_VALUE WHERE ITEM_TYPE='PAYMENTTYPE' AND STATUS='Y' ORDER BY ITEM_CODE
###GET_MOTOR_PAYMENT_DETAIL = select QUOTE_NO,(select distinct policy_no from home_position_master hpm  where hpm.quote_no=mpd.quote_no ) policy_no,CUSTOMER_NAME,itm.item_value payment_type,MERCHANT_REFERENCE,RESPONSE_MESSAGE from MOTOR_PAYMENT_DETAIL mpd,list_item_value itm where CONVERT(DATE,REQUEST_TIME,103) BETWEEN CONVERT(DATE,?,103) AND CONVERT(DATE,?,103) and itm.ITEM_DESC=mpd.payment_type and itm.ITEM_TYPE = 'PAYMENTTYPE' and itm.status='Y'and mpd.product_id = ? and mpd.Response_message='Success'
GET_MOTOR_PAYMENT_DETAIL = select mpd.QUOTE_NO,hpm.policy_no ,CUSTOMER_NAME,itm.item_value payment_type,MERCHANT_REFERENCE,RESPONSE_MESSAGE from MOTOR_PAYMENT_DETAIL mpd,list_item_value itm, home_position_master hpm where CONVERT(DATE,REQUEST_TIME,103) BETWEEN CONVERT(DATE,?,103) AND CONVERT(DATE,?,103) and itm.ITEM_DESC=mpd.payment_type and itm.ITEM_TYPE = 'PAYMENTTYPE' and itm.status='Y'and mpd.product_id = ? and mpd.Response_message='Success' and hpm.quote_no=mpd.quote_no and hpm.policy_no IS NOT NULL
GET_MOTOR_PAYMENT_SUCCESS = select mpd.QUOTE_NO,hpm.policy_no ,CUSTOMER_NAME,itm.item_value payment_type,MERCHANT_REFERENCE,RESPONSE_MESSAGE from MOTOR_PAYMENT_DETAIL mpd,list_item_value itm, home_position_master hpm where CONVERT(DATE,REQUEST_TIME,103) BETWEEN CONVERT(DATE,?,103) AND CONVERT(DATE,?,103) and itm.ITEM_DESC=mpd.payment_type and itm.ITEM_TYPE = 'PAYMENTTYPE' and itm.status='Y'and mpd.product_id = ? and mpd.Response_message='Success' and hpm.quote_no=mpd.quote_no and hpm.policy_no IS NULL and hpm.status not in ('D')
GET_MOTOR_PAYMENT_CC_DETAIL = select DISTINCT QUOTE_NO,(select policy_no from home_position_master hpm  where hpm.quote_no=mpd.quote_no) policy_no,CUSTOMER_NAME,itm.item_value payment_type,mpd.MERCHANT_REFERENCE,mpd.RESPONSE_MESSAGE from MOTOR_PAYMENT_DETAIL mpd,list_item_value itm where CONVERT(DATE,REQUEST_TIME,103) BETWEEN CONVERT(DATE,?,103) AND CONVERT(DATE,?,103) and itm.ITEM_DESC=mpd.payment_type and itm.ITEM_TYPE = 'PAYMENTTYPE'  and (MPD.RESPONSE_MESSAGE not in ('Success') or MPD.RESPONSE_MESSAGE is null ) and itm.status='Y' and mpd.product_id = ?  and MERCHANT_REFERENCE=(select max(MERCHANT_REFERENCE) from MOTOR_PAYMENT_DETAIL pd where pd. quote_no=mpd.quote_no) AND mpd.PAYMENT_TYPE NOT IN ('CHEQUE','CASH')
GET_PAYMENT_VIEW = SELECT   pi.FIRST_NAME, pi.LAST_NAME, pi.building_no+','+PI.STREET+','+PI.NEIGHBORHOOD  ADDRESS1, pi.EMIRATE+'  '+PI.ZIPCODE +'-'+PI.ADDITIONAL_NO    ADDRESS2, pi.POBOX , pi.MOBILE, pi.EMAIL, (SELECT  ISNULL(COUNTRY_NAME,'' ) FROM COUNTRY_MASTER CM WHERE COUNTRY_ID\=(SELECT COUNTRY_ID FROM CITY_MASTER WHERE UPPER(CITY_NAME)\=UPPER(PI.EMIRATE)) AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM  COUNTRY_MASTER WHERE CM.COUNTRY_ID\=COUNTRY_ID) ) COUNTRY_NAME, hpm.QUOTE_NO, hpm.CUSTOMER_ID, hpm.POLICY_NO, hpm.PREMIUM, hpm.POLICY_FEE,(hpm.POLICY_FEE+hpm.najm_fee) as admin_fee,hpm.VAT_PREMIUM VAT_PREMIUM, hpm.OVERALL_PREMIUM, hpm.INCEPTION_DATE, hpm.EXPIRY_DATE, mpm.CHEQUE_NO,mpm.PREMIUM as PAYEE_AMOUNT, (SELECT   BANK_NAME_ENGLISH FROM   motor_bank_master mbm WHERE   mpm.bank_name \= mbm.bank_id AND AMEND_ID \= (SELECT   MAX (AMEND_ID) FROM   motor_bank_master mb WHERE   mbm.bank_id \= mb.bank_id)) BANK_NAME, mpm.MICR_CODE, mpm.CHEQUE_AMOUNT, mpm.CHEQUE_DATE, CONVERT (varchar (10), mpm.REQUEST_TIME, 120) + ' ' + CONVERT (VARCHAR (8), mpm.REQUEST_TIME, 14) REQUEST_TIME, CONVERT (varchar (10), mpm.RESPONSE_TIME, 120) + ' ' + CONVERT (VARCHAR (8), mpm.RESPONSE_TIME, 14) RESPONSE_TIME, mpm.RESPONSE_TRAN_NO, mpm.RESPONSE_STATUS, mpm.RESPONSE_MESSAGE, mpm.CARD_NUMBER_MASKED, mpm.RESPONSE_CODE, (SELECT   item_value FROM   list_item_value liv WHERE       liv.ITEM_TYPE \= 'PAYMENTTYPE' AND liv.status \= 'Y' AND ITEM_DESC \= mpm.PAYMENT_TYPE) PAYMENT_TYPE, mpm.MERCHANT_REFERENCE FROM   MOTOR_PAYMENT_DETAIL mpm, home_position_master hpm, personal_info pi WHERE       mpm.QUOTE_NO \= hpm.QUOTE_NO AND pi.customer_id \= hpm.customer_id AND mpm.quote_no \=?  AND mpm.MERCHANT_REFERENCE \= ? AND hpm.branch_code \= ?  
GET_CP_PAYMENT_LIST = Select CONVERT(varchar(10),mpm.REQUEST_TIME,120)  + ' '  + convert(VARCHAR(8), mpm.REQUEST_TIME, 14) REQUEST_TIME, CONVERT(varchar(10),mpm.RESPONSE_TIME,120)  + ' '  + convert(VARCHAR(8), mpm.RESPONSE_TIME, 14) RESPONSE_TIME,RESPONSE_TRAN_NO,RESPONSE_STATUS,RESPONSE_MESSAGE,CARD_NUMBER_MASKED,RESPONSE_CODE, MERCHANT_REFERENCE,RESPONSE_TRAN_NO from motor_payment_detail mpm where quote_no = ?
GET_MERCHENT_REF_BY_QUOTE = select MP.MERCHANT_REFERENCE from MOTOR_PAYMENT_DETAIL MP WHERE MP.QUOTE_NO=? AND MP.MERCHANT_REFERENCE=(SELECT MAX(MPD.MERCHANT_REFERENCE) FROM MOTOR_PAYMENT_DETAIL MPD WHERE MP.QUOTE_NO=MPD.QUOTE_NO)
GET_PAYMENT_COUNT = SELECT COUNT(*) FROM MOTOR_PAYMENT_DETAIL WHERE QUOTE_NO=? AND MERCHANT_REFERENCE IS NOT NULL
GET_MERCHANT_REFERENCE_LIST=select MERCHANT_REFERENCE from motor_payment_detail where quote_no\=? AND (RESPONSE_STATUS NOT IN ('14') OR RESPONSE_STATUS IS NULL) order by MERCHANT_REFERENCE DESC
CHECK_PREMIUM_EQUAL = SELECT COUNT(*) FROM HOME_POSITION_MASTER HPM,MOTOR_PAYMENT_DETAIL MDD WHERE HPM.QUOTE_NO=MDD.QUOTE_NO AND HPM.QUOTE_NO=? AND MDD.MERCHANT_REFERENCE=  ? AND HPM.OVERALL_PREMIUM=MDD.PREMIUM
GET_MERCHENT_EXITS_LIST = SELECT MERCHANT_REFERENCE FROM MOTOR_PAYMENT_DETAIL WHERE QUOTE_NO\=? AND RESPONSE_STATUS IS NULL ORDER BY MERCHANT_REFERENCE DESC
#
##### MOTOR QUOTATION STATUS END #####

##--- Travel Admin----- 

## Scheme Master
#####(28-04-2016)##### GET_SCHEME_VALUE=SELECT SCHEME_ID,SCHEME_NAME FROM TRAVEL_SCHEME_COVERS TSC WHERE STATUS='Y' AND BRANCH_CODE = ?  and AMEND_ID = (select MAX(AMEND_ID) from TRAVEL_SCHEME_COVERS where SCHEME_ID=tsc.SCHEME_ID)
GET_SCHEME_VALUE = SELECT SCHEME_ID,SCHEME_NAME FROM TRAVEL_SCHEME_COVERS ts WHERE STATUS='Y' AND SCHEME_ID IN ( SELECT SCHEME_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE PRODUCT_CODE=?  AND STATUS='Y') and amend_id=(select max(amend_id) from  TRAVEL_SCHEME_COVERS   where scheme_id=ts.scheme_id) ORDER BY SCHEME_NAME
#####(01-05-2016)##### GET_OPTION_VALUE=SELECT TRIM(OPTION_ID) OPTION_ID,OPTION_NAME FROM TRAVEL_OPTION_COVERS WHERE STATUS='Y' AND BRANCH_CODE=?
GET_OPTION_VALUE=SELECT OPTION_ID,OPTION_NAME  FROM TRAVEL_OPTION_COVERS WHERE  STATUS='Y' AND OPTION_ID IN ( SELECT OPTION_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE  STATUS='Y' AND SCHEME_ID=? AND PRODUCT_CODE=?)
GET_COVER_VALUE=SELECT TRIM(OPTION_ID) COVER_ID,OPTION_NAME COVER_NAME FROM TRAVEL_OPTION_COVERS WHERE STATUS='Y' AND BRANCH_CODE=? AND OPTION_ID IN (SELECT OPTION_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_ID=? AND STATUS='Y' AND PRODUCT_CODE=? AND BRANCH_CODE=?)
GET_RELATION_TYPE_VALUE=select RSACODE,DETAIL_NAME from constant_detail where BRANCH_CODE=? and CATEGORY_ID='198'
GET_TYPE_VALUE=select RSACODE,DETAIL_NAME from constant_detail where BRANCH_CODE=? and CATEGORY_ID='53'

GET_SCHEME=SELECT SCHEME_ID,SCHEME_NAME,CASE WHEN(STATUS='Y') THEN 'Active' ELSE 'InActive' END STATUS ,COREAPP_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM TRAVEL_SCHEME_COVERS TSC WHERE BRANCH_CODE=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_SCHEME_COVERS TC WHERE TC.BRANCH_CODE=TSC.BRANCH_CODE  AND TC.SCHEME_ID=TSC.SCHEME_ID)   ORDER BY SCHEME_ID ASC
GET_SCHEME_DATA=SELECT SCHEME_ID,SCHEME_NAME,STATUS,COREAPP_CODE,PRODUCT_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM TRAVEL_SCHEME_COVERS TSC WHERE SCHEME_ID=? AND BRANCH_CODE=?  AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM TRAVEL_SCHEME_COVERS WHERE SCHEME_ID = TSC.SCHEME_ID )
GET_SCHEME_MAX_AMEND_ID=SELECT MAX(AMEND_ID)+1 FROM TRAVEL_SCHEME_COVERS WHERE SCHEME_ID\=? 
GET_SCHEME_AMEND_ID=SELECT AMEND_ID FROM TRAVEL_SCHEME_COVERS MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_SCHEME_COVERS WHERE   SCHEME_ID = MSM.SCHEME_ID) AND SCHEME_ID = ? AND BRANCH_CODE=? AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
INS_SCHEME_DTLS=INSERT INTO TRAVEL_SCHEME_COVERS (SCHEME_ID,SCHEME_NAME,BRANCH_CODE,STATUS,COREAPP_CODE,PRODUCT_CODE,EFFECTIVE_DATE,AMEND_ID)VALUES(?,?,?,?,?,?,convert(date,?,103),?)
#####(28-04-2016)##### GET_SCHEME_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_SCHEME_COVERS WHERE COREAPP_CODE=?
GET_SCHEME_CORE_CODE = SELECT COUNT(*) FROM TRAVEL_SCHEME_COVERS TSCS WHERE COREAPP_CODE =? and STATUS = 'Y' and AMEND_ID = (select MAX(AMEND_ID) from TRAVEL_SCHEME_COVERS TSC where TSC.SCHEME_ID = TSCS.SCHEME_ID)
GET_SCHEME_HISTORY=SELECT SCHEME_ID,SCHEME_NAME,STATUS,COREAPP_CODE,PRODUCT_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE  FROM TRAVEL_SCHEME_COVERS WHERE SCHEME_ID=? AND BRANCH_CODE=?
GET_SCHEME_ID=SELECT isnull(MAX(SCHEME_ID)+1,0) FROM TRAVEL_SCHEME_COVERS WHERE BRANCH_CODE=?
UPDATE_SCHEME_DATA=update TRAVEL_SCHEME_COVERS set SCHEME_NAME\=?,BRANCH_CODE\=?,STATUS\=?,COREAPP_CODE\=?,PRODUCT_CODE\=?,EFFECTIVE_DATE\=convert(date,?,103) where AMEND_ID\=? and SCHEME_ID\=?  
#####(28-04-2016)##### GET_SCHEME_CORE_CODE1=SELECT COUNT(*) FROM TRAVEL_SCHEME_COVERS WHERE COREAPP_CODE\=? and SCHEME_ID\!\=?
GET_SCHEME_CORE_CODE1 = SELECT COUNT(*) FROM TRAVEL_SCHEME_COVERS WHERE COREAPP_CODE\=? and SCHEME_ID\!\=?


GET_OPTION=SELECT OPTION_ID,OPTION_NAME,CASE WHEN(STATUS='Y') THEN 'Active' ELSE 'InActive' END STATUS ,COREAPP_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM TRAVEL_OPTION_COVERS TOC WHERE BRANCH_CODE=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_OPTION_COVERS TC WHERE TC.BRANCH_CODE=TOC.BRANCH_CODE  AND TC.OPTION_ID=TOC.OPTION_ID)   ORDER BY OPTION_ID ASC
#####(28-04-2016)##### GET_OPTION_DATA=SELECT OPTION_ID,OPTION_NAME,STATUS,COREAPP_CODE,PRODUCT_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM TRAVEL_OPTION_COVERS WHERE OPTION_ID=? AND BRANCH_CODE=?
GET_OPTION_DATA = SELECT OPTION_ID,OPTION_NAME,STATUS,COREAPP_CODE,PRODUCT_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM TRAVEL_OPTION_COVERS TOPC WHERE OPTION_ID=? AND BRANCH_CODE=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_OPTION_COVERS TOPI WHERE TOPI.OPTION_ID = TOPC.OPTION_ID AND TOPI.BRANCH_CODE = TOPC.BRANCH_CODE)
GET_OPTION_AMEND_ID=SELECT isnull(MAX(AMEND_ID)+1,0) FROM TRAVEL_OPTION_COVERS WHERE OPTION_ID=? AND BRANCH_CODE=?
INS_OPTION_DTLS=INSERT INTO TRAVEL_OPTION_COVERS(OPTION_ID,OPTION_NAME,BRANCH_CODE,STATUS,COREAPP_CODE,PRODUCT_CODE,EFFECTIVE_DATE,AMEND_ID)VALUES(?,?,?,?,?,?,convert(date,?,103),?)
#####(28-04-2016)##### GET_OPTION_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_OPTION_COVERS WHERE COREAPP_CODE=?
GET_OPTION_CORE_CODE = SELECT COUNT(*) FROM TRAVEL_OPTION_COVERS TOPC WHERE COREAPP_CODE=? and STATUS = 'Y' and AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_OPTION_COVERS TOPI WHERE TOPI.OPTION_ID = TOPC.OPTION_ID)
#####(28-04-2016)##### GET_OPTION_CORE_CODE1=SELECT COUNT(*) FROM TRAVEL_OPTION_COVERS WHERE COREAPP_CODE=? and OPTION_ID!=?
GET_OPTION_CORE_CODE1 = SELECT COUNT(*) FROM TRAVEL_OPTION_COVERS TOPC WHERE COREAPP_CODE=? and STATUS = 'Y' and AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_OPTION_COVERS TOPI WHERE TOPI.OPTION_ID = TOPC.OPTION_ID) and OPTION_ID!=?
GET_OPTION_AMEND_ID1=SELECT AMEND_ID FROM TRAVEL_OPTION_COVERS MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_OPTION_COVERS WHERE   OPTION_ID = MSM.OPTION_ID) AND OPTION_ID = ? AND BRANCH_CODE=? AND convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
GET_OPTION_HISTORY=SELECT OPTION_ID,OPTION_NAME,STATUS,COREAPP_CODE,PRODUCT_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM TRAVEL_OPTION_COVERS WHERE OPTION_ID=? AND BRANCH_CODE=?
GET_OPTION_ID=SELECT isnull(MAX(OPTION_ID)+1,0) FROM TRAVEL_OPTION_COVERS WHERE BRANCH_CODE=?
#####(28-04-2016)##### UPDATE_OPTION_DTLS=update TRAVEL_OPTION_COVERS set OPTION_NAME=?,BRANCH_CODE=?,STATUS=?,COREAPP_CODE=?,PRODUCT_CODE=?,EFFECTIVE_DATE=,convert(date,?,103),AMEND_ID=? where OPTION_ID=? and AMEND_ID=(select MAX(AMEND_ID) FROM TRAVEL_OPTION_COVERS TOC WHERE TOC.OPTION_ID=OPTION_ID)
UPDATE_OPTION_DTLS = update TRAVEL_OPTION_COVERS set OPTION_NAME\=?,BRANCH_CODE\=?,STATUS\=?,COREAPP_CODE\=?,PRODUCT_CODE\=?,EFFECTIVE_DATE\=convert(date,?,103) where AMEND_ID\=? and  OPTION_ID\=?  

GET_MASTER_COVERAGE=SELECT COVERAGES_ID,COVERAGES_NAME,COVERAGES_VALUE,CASE WHEN(STATUS='Y') THEN 'Active' ELSE 'InActive' END STATUS ,COREAPP_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM TRAVEL_MAS_COVERAGES TMC WHERE BRANCH_CODE=? and AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_MAS_COVERAGES TC WHERE TC.BRANCH_CODE=TMC.BRANCH_CODE  AND TC.COVERAGES_ID=TMC.COVERAGES_ID)   ORDER BY COVERAGES_ID ASC
#####(28-04-2016)##### GET_COVERAGE_DATA=SELECT COVERAGES_ID,COVERAGES_NAME,COVERAGES_VALUE,STATUS,COREAPP_CODE,PRODUCT_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM TRAVEL_MAS_COVERAGES WHERE COVERAGES_ID=? AND BRANCH_CODE=?
GET_COVERAGE_DATA = SELECT COVERAGES_ID,COVERAGES_NAME,COVERAGES_VALUE,STATUS,COREAPP_CODE,PRODUCT_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM TRAVEL_MAS_COVERAGES TMC WHERE COVERAGES_ID=? AND BRANCH_CODE=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_MAS_COVERAGES TMCS WHERE TMCS.COVERAGES_ID = TMC.COVERAGES_ID AND TMCS.BRANCH_CODE = TMC.BRANCH_CODE)
GET_COVERAGE_AMEND_ID=SELECT isnull(MAX(AMEND_ID)+1,0) FROM TRAVEL_MAS_COVERAGES WHERE COVERAGES_ID=? AND BRANCH_CODE=?
GET_COVERAGE_AMEND_ID1=SELECT AMEND_ID FROM TRAVEL_MAS_COVERAGES MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_MAS_COVERAGES WHERE   COVERAGES_ID = MSM.COVERAGES_ID) AND COVERAGES_ID = ? AND BRANCH_CODE=? AND  convert(date,EFFECTIVE_DATE,103) > convert(DATE, getdate(),103)
INS_COVERAGE_DTLS=INSERT INTO TRAVEL_MAS_COVERAGES(COVERAGES_ID,COVERAGES_NAME,COVERAGES_VALUE,BRANCH_CODE,STATUS,COREAPP_CODE,PRODUCT_CODE,EFFECTIVE_DATE,AMEND_ID)VALUES(?,?,?,?,?,?,?,convert(date,?,103),?)
#####(28-04-2016)##### GET_COVERAGE_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_MAS_COVERAGES WHERE COREAPP_CODE=?
GET_COVERAGE_CORE_CODE = SELECT COUNT(*) FROM TRAVEL_MAS_COVERAGES TMCS WHERE COREAPP_CODE=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_MAS_COVERAGES TMC WHERE TMC.COVERAGES_ID = TMCS.COVERAGES_ID) and STATUS = 'Y'
#####(28-04-2016)##### GET_COVERAGE_CORE_CODE1=SELECT COUNT(*) FROM TRAVEL_MAS_COVERAGES WHERE COREAPP_CODE=? AND COVERAGES_ID=?
GET_COVERAGE_CORE_CODE1 = SELECT COUNT(*) FROM TRAVEL_MAS_COVERAGES TMCS WHERE COREAPP_CODE=? AND COVERAGES_ID!=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_MAS_COVERAGES TMC WHERE TMC.COVERAGES_ID = TMCS.COVERAGES_ID) and STATUS = 'Y'
GET_COVERAGE_HISTORY=SELECT COVERAGES_ID,COVERAGES_NAME,COVERAGES_VALUE,STATUS,COREAPP_CODE,PRODUCT_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE FROM TRAVEL_MAS_COVERAGES WHERE COVERAGES_ID=? AND BRANCH_CODE=?
GET_COVERAGE_ID=SELECT MAX(COVERAGES_ID)+1 FROM TRAVEL_MAS_COVERAGES WHERE BRANCH_CODE=?
#####(28-04-2016)##### UPDATE_COVERAGE_DTLS=UPDATE  TRAVEL_MAS_COVERAGES TMC SET COVERAGES_NAME\=?,COVERAGES_VALUE\=?,BRANCH_CODE\=?,STATUS\=?,COREAPP_CODE\=?,PRODUCT_CODE\=?,EFFECTIVE_DATE\=convert(date,?,103),AMEND_ID\=? WHERE COVERAGES_ID\=? and AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TRAVEL_MAS_COVERAGES TC WHERE TC.BRANCH_CODE\=TMC.BRANCH_CODE  AND TC.COVERAGES_ID\=TMC.COVERAGES_ID)
UPDATE_COVERAGE_DTLS = UPDATE  TRAVEL_MAS_COVERAGES SET COVERAGES_NAME\=?,COVERAGES_VALUE\=?,BRANCH_CODE\=?,STATUS\=?,COREAPP_CODE\=?,PRODUCT_CODE\=?,EFFECTIVE_DATE\=convert(date,?,103) WHERE AMEND_ID\=? AND COVERAGES_ID\=?  


#####(28-04-2016)##### GET_DISCOUNT_RATE=SELECT RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,convert(varchar(10),EFF_DATE,103)  EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_DISCOUNT_RATE TDR WHERE TDR.PRODUCT_CODE=? AND  TDR.BRANCH_CODE= ?  AND TDR.AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_DISCOUNT_RATE WHERE PRODUCT_CODE=? AND AGE_START=TDR.AGE_START AND AGE_END=TDR.AGE_END AND TYPE=TDR.TYPE AND BRANCH_CODE= ? ) ORDER BY 3,4
GET_DISCOUNT_RATE = SELECT RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,convert(varchar(10),EFF_DATE,103)  EFFECTIVE_DATE,COREAPP_CODE,CASE WHEN(STATUS='Y') THEN 'Active' ELSE 'InActive' END STATUS,PRODUCT_CODE FROM TRAVEL_DISCOUNT_RATE TDR WHERE TDR.PRODUCT_CODE=? AND  TDR.BRANCH_CODE= ?  AND TDR.AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_DISCOUNT_RATE WHERE RATE_ID = TDR.RATE_ID AND BRANCH_CODE = TDR.BRANCH_CODE) ORDER BY RATE_ID ASC
#####(28-04-2016)##### GET_DISCOUNT_RATE_DATA=SELECT RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,convert(varchar(10),EFF_DATE,103) EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_DISCOUNT_RATE WHERE PRODUCT_CODE=? AND RATE_ID=? AND BRANCH_CODE=?
GET_DISCOUNT_RATE_DATA = SELECT RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,convert(varchar(10),EFF_DATE,103) EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_DISCOUNT_RATE TDDR WHERE PRODUCT_CODE=? AND RATE_ID=? AND BRANCH_CODE=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_DISCOUNT_RATE TDR WHERE TDDR.RATE_ID = TDR.RATE_ID AND TDDR.BRANCH_CODE = TDR.BRANCH_CODE)
GET_DISCOUNT_RATE_MAX_AMEND_ID=SELECT MAX(AMEND_ID)+1 FROM TRAVEL_DISCOUNT_RATE WHERE RATE_ID=? AND BRANCH_CODE=?
GET_DISCOUNT_RATE_AMEND_ID=SELECT AMEND_ID FROM TRAVEL_DISCOUNT_RATE MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_DISCOUNT_RATE WHERE   RATE_ID = MSM.RATE_ID) AND RATE_ID = ? AND BRANCH_CODE=? AND convert(date,EFF_DATE,103)< convert(DATE, getdate(),103)
INS_DISCOUNT_RATE_DTLS=INSERT INTO TRAVEL_DISCOUNT_RATE(RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,BRANCH_CODE,EFF_DATE,AMEND_ID,STATUS,COREAPP_CODE,PRODUCT_CODE)VALUES(?,?,?,?,?,?,convert(date,?,103),?,?,?,?)
#####(28-04-2016)##### GET_DISCOUNT_RATE_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_DISCOUNT_RATE WHERE COREAPP_CODE=?
GET_DISCOUNT_RATE_CORE_CODE = SELECT COUNT(*) FROM TRAVEL_DISCOUNT_RATE TDDR WHERE COREAPP_CODE=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_DISCOUNT_RATE TDR WHERE TDDR.RATE_ID = TDR.RATE_ID) and STATUS = 'Y'
#####(28-04-2016)##### GET_DISCOUNT_RATE_CORE_CODE1=select count(*) from TRAVEL_DISCOUNT_RATE where COREAPP_CODE\=? and RATE_ID\!\=?
GET_DISCOUNT_RATE_CORE_CODE1 = select count(*) from TRAVEL_DISCOUNT_RATE TDDR where COREAPP_CODE\=? and RATE_ID\!\=? AND AMEND_ID \= (SELECT MAX(AMEND_ID) FROM TRAVEL_DISCOUNT_RATE TDR WHERE TDDR.RATE_ID \= TDR.RATE_ID) and STATUS \= 'Y'
GET_DISCOUNT_RATE_HISTORY=SELECT RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,convert(varchar(10),EFF_DATE,103) EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_DISCOUNT_RATE WHERE PRODUCT_CODE=? AND RATE_ID=? AND BRANCH_CODE=?
GET_DISCOUNT_RATE_ID=SELECT MAX(RATE_ID)+1 FROM TRAVEL_DISCOUNT_RATE WHERE BRANCH_CODE=?
#####(28-04-2016)##### UPDATE_DISCOUNT_RATE=update TRAVEL_DISCOUNT_RATE set TYPE\=?,AGE_START\=?,AGE_END\=?,RATE_VALUE\=?,BRANCH_CODE\=?,EFF_DATE\=convert(date,?,103),AMEND_ID\=?,STATUS\=?,COREAPP_CODE\=?,PRODUCT_CODE\=? where RATE_ID\=? 
UPDATE_NEW_DISCOUNT_RATE = update TRAVEL_DISCOUNT_RATE set TYPE\=?,AGE_START\=?,AGE_END\=?,RATE_VALUE\=?,BRANCH_CODE\=?,EFF_DATE\=convert(date,?,103),STATUS\=?,COREAPP_CODE\=?,PRODUCT_CODE\=? where AMEND_ID\=? AND  RATE_ID\=?
#####(28-04-2016)##### GET_RELATION_DISCOUNT=SELECT DISCOUNT_ID,DISCOUNT_START,DISCOUNT_END,RATE_VALUE,RELATION_TYPE,convert(varchar(10),EFF_DATE,103)  EFFECTIVE_DATE,STATUS,COREAPP_CODE FROM TRAVEL_RELATION_DISCOUNT TRD WHERE TRD.PRODUCT_CODE=? AND TRD.BRANCH_CODE=?  AND TRD.AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_RELATION_DISCOUNT WHERE PRODUCT_CODE=? AND DISCOUNT_START=TRD.DISCOUNT_START AND DISCOUNT_END=TRD.DISCOUNT_END AND RELATION_TYPE=TRD.RELATION_TYPE AND BRANCH_CODE= ? ) ORDER BY 2,3
GET_RELATION_DISCOUNT = SELECT DISCOUNT_ID,DISCOUNT_START,DISCOUNT_END,RATE_VALUE,RELATION_TYPE,convert(varchar(10),EFF_DATE,103)  EFFECTIVE_DATE,STATUS,COREAPP_CODE FROM TRAVEL_RELATION_DISCOUNT TRD WHERE TRD.PRODUCT_CODE\=? AND TRD.BRANCH_CODE\=?  AND TRD.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM TRAVEL_RELATION_DISCOUNT WHERE DISCOUNT_ID \= TRD.DISCOUNT_ID AND BRANCH_CODE \= TRD.BRANCH_CODE) ORDER BY DISCOUNT_ID ASC 
GET_RELATION_DISCOUNT_DATA=SELECT DISCOUNT_ID,DISCOUNT_START,DISCOUNT_END,RATE_VALUE,RELATION_TYPE, COREAPP_CODE, STATUS, convert(varchar(10),EFF_DATE,103) EFFECTIVE_DATE FROM TRAVEL_RELATION_DISCOUNT TRD WHERE TRD.PRODUCT_CODE =? AND TRD.DISCOUNT_ID=? AND TRD.BRANCH_CODE =? AND TRD.AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_RELATION_DISCOUNT TRRD WHERE TRD.DISCOUNT_ID=TRRD.DISCOUNT_ID AND TRD.BRANCH_CODE=TRRD.BRANCH_CODE AND  TRD.PRODUCT_CODE= TRRD.PRODUCT_CODE)
GET_RELATION_DISCOUNT_MAX_AMEND_ID=SELECT MAX(AMEND_ID)+1 FROM TRAVEL_RELATION_DISCOUNT WHERE DISCOUNT_ID=? AND BRANCH_CODE=?
GET_RELATION_DISCOUNT_AMEND_ID=SELECT AMEND_ID FROM TRAVEL_RELATION_DISCOUNT MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_RELATION_DISCOUNT WHERE   DISCOUNT_ID = MSM.DISCOUNT_ID) AND DISCOUNT_ID = ? AND BRANCH_CODE=? AND convert(date,EFF_DATE,103)< convert(DATE, getdate(),103)
INS_RELATION_DISCOUNT_DTLS=INSERT INTO TRAVEL_RELATION_DISCOUNT(DISCOUNT_ID, DISCOUNT_START, DISCOUNT_END, RATE_VALUE, RELATION_TYPE,EFF_DATE, COREAPP_CODE, AMEND_ID, STATUS,BRANCH_CODE,PRODUCT_CODE,AGENCY_CODE)VALUES(?,?,?,?,?,convert(date,?,103),?,?,?,?,?,?)
#####(28-04-2016)##### GET_RELATION_DISCOUNT_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_RELATION_DISCOUNT WHERE COREAPP_CODE=?
GET_RELATION_DISCOUNT_CORE_CODE = SELECT COUNT(*) FROM TRAVEL_RELATION_DISCOUNT TRD WHERE COREAPP_CODE=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_RELATION_DISCOUNT TRDD WHERE TRDD.DISCOUNT_ID = TRD.DISCOUNT_ID) and STATUS = 'Y'
#####(28-04-2016)##### GET_RELATION_DISCOUNT_CORE_CODE1=SELECT COUNT(*) FROM TRAVEL_RELATION_DISCOUNT WHERE COREAPP_CODE=? and DISCOUNT_ID!=?
GET_RELATION_DISCOUNT_CORE_CODE1 = SELECT COUNT(*) FROM TRAVEL_RELATION_DISCOUNT TRD WHERE COREAPP_CODE=? and DISCOUNT_ID!=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_RELATION_DISCOUNT TRDD WHERE TRDD.DISCOUNT_ID = TRD.DISCOUNT_ID) and STATUS = 'Y'
GET_RELATION_DISCOUNT_HISTORY=SELECT DISCOUNT_ID, DISCOUNT_START, DISCOUNT_END, RATE_VALUE, RELATION_TYPE,EFF_DATE, COREAPP_CODE, AMEND_ID, STATUS,BRANCH_CODE,PRODUCT_CODE  FROM TRAVEL_RELATION_DISCOUNT WHERE  AND DISCOUNT_ID=? AND BRANCH_CODE=?
GET_RELATION_DISCOUNT_ID=SELECT MAX(DISCOUNT_ID)+1 FROM TRAVEL_RELATION_DISCOUNT WHERE BRANCH_CODE=?
#####(28-04-2016)##### UPDATE_DISCOUNT_RELATION=UPDATE TRAVEL_RELATION_DISCOUNT trd SET  DISCOUNT_START=?, DISCOUNT_END=?, RATE_VALUE=?, RELATION_TYPE=?,EFF_DATE=convert(date,?,103), COREAPP_CODE=?, AMEND_ID=?, STATUS=?,BRANCH_CODE=?,PRODUCT_CODE=? WHERE DISCOUNT_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM TRAVEL_RELATION_DISCOUNT TR WHERE TR.DISCOUNT_ID=trd.DISCOUNT_ID AND TR.BRANCH_CODE=BRANCH_CODE)
UPDATE_DISCOUNT_RELATION = UPDATE TRAVEL_RELATION_DISCOUNT  SET  DISCOUNT_START\=?, DISCOUNT_END\=?, RATE_VALUE\=?, RELATION_TYPE\=?,EFF_DATE\=convert(date,?,103), COREAPP_CODE\=?, STATUS\=?,BRANCH_CODE\=?,PRODUCT_CODE\=? WHERE AMEND_ID\=? AND DISCOUNT_ID\=? 

#####(28-04-2016)##### GET_PREMIUM_RATE=SELECT TPR.TRAVEL_PREMIUM_ID, TPR.NO_OF_DAYS, TSC.SCHEME_NAME, TOC.OPTION_NAME, TPR.PREMIUM, convert(varchar(10),tpr.EFF_DATE,103) EFFECTIVE_DATE   FROM TRAVEL_PREMIUM_RATE TPR, TRAVEL_OPTION_COVERS TOC, TRAVEL_SCHEME_COVERS TSC WHERE TPR.OPTION_ID = TOC.OPTION_ID AND TPR.SCHEME_ID = TSC.SCHEME_ID AND TSC.STATUS = 'Y'  AND TOC.STATUS = 'Y'  AND TPR.PRODUCT_CODE =? AND TPR.BRANCH_CODE =? AND TSC.BRANCH_CODE = TPR.BRANCH_CODE AND TOC.BRANCH_CODE = TPR.BRANCH_CODE AND (convert(date,TPR.EFF_DATE,103) >= convert(date,getdate(),103)) OR (convert(date,TPR.EFF_DATE,103) <= convert(date,getdate(),103)) ORDER BY TPR.TRAVEL_PREMIUM_ID
#####(1-05-2016)##### GET_PREMIUM_RATE = SELECT TPR.TRAVEL_PREMIUM_ID, TPR.NO_OF_DAYS, TSC.SCHEME_NAME, TOC.OPTION_NAME, TPR.PREMIUM, convert(varchar(10),tpr.EFF_DATE,103) EFFECTIVE_DATE   FROM TRAVEL_PREMIUM_RATE TPR, TRAVEL_OPTION_COVERS TOC, TRAVEL_SCHEME_COVERS TSC WHERE TPR.OPTION_ID \= TOC.OPTION_ID AND TPR.SCHEME_ID \= TSC.SCHEME_ID AND TSC.STATUS \= 'Y'  AND TOC.STATUS \= 'Y'  AND TPR.PRODUCT_CODE \=? AND TPR.BRANCH_CODE \=? AND TSC.BRANCH_CODE \= TPR.BRANCH_CODE AND TOC.BRANCH_CODE \= TPR.BRANCH_CODE AND (convert(date,TPR.EFF_DATE,103) >\= convert(date,getdate(),103)) OR (convert(date,TPR.EFF_DATE,103) <\= convert(date,getdate(),103)) AND TPR.AMEND_ID \= (SELECT MAX(AMEND_ID) FROM TRAVEL_PREMIUM_RATE TPRR WHERE TPR.TRAVEL_PREMIUM_ID \= TPRR.TRAVEL_PREMIUM_ID AND TPR.BRANCH_CODE \= TPRR.BRANCH_CODE) ORDER BY TPR.TRAVEL_PREMIUM_ID
GET_PREMIUM_RATE=SELECT  distinct TPR.TRAVEL_PREMIUM_ID, TPR.NO_OF_DAYS, TSC.SCHEME_NAME, TOC.OPTION_NAME, TPR.PREMIUM, convert(varchar(10),tpr.EFF_DATE,103) EFFECTIVE_DATE,TPR.COREAPPCODE,TPR.STATUS FROM TRAVEL_PREMIUM_RATE TPR, TRAVEL_OPTION_COVERS TOC, TRAVEL_SCHEME_COVERS TSC WHERE TPR.OPTION_ID \= TOC.OPTION_ID AND TPR.SCHEME_ID \= TSC.SCHEME_ID AND TSC.STATUS \= 'Y'  AND TOC.STATUS \= 'Y'  AND TPR.PRODUCT_CODE \=? AND TPR.BRANCH_CODE \=? AND TSC.BRANCH_CODE \= TPR.BRANCH_CODE AND TOC.BRANCH_CODE \= TPR.BRANCH_CODE AND TPR.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM TRAVEL_PREMIUM_RATE TR WHERE TR.TRAVEL_PREMIUM_ID\= TPR.TRAVEL_PREMIUM_ID ) ORDER BY TPR.TRAVEL_PREMIUM_ID 
#####(28-04-2016)##### GET_PREMIUM_RATE_DATA=SELECT TRAVEL_PREMIUM_ID, NO_OF_DAYS, SCHEME_ID, OPTION_ID, convert(varchar(10),EFF_DATE,103)  EFF_DATE,PREMIUM, BRANCH_CODE, PRODUCT_CODE FROM TRAVEL_PREMIUM_RATE WHERE PRODUCT_CODE=? AND RATE_ID=? AND BRANCH_CODE=?
GET_PREMIUM_RATE_DATA = SELECT TRAVEL_PREMIUM_ID, NO_OF_DAYS, SCHEME_ID, OPTION_ID, convert(varchar(10),EFF_DATE,103)  EFF_DATE,PREMIUM, BRANCH_CODE, PRODUCT_CODE ,COREAPPCODE ,STATUS  FROM TRAVEL_PREMIUM_RATE TPR WHERE PRODUCT_CODE=? AND TRAVEL_PREMIUM_ID=? AND BRANCH_CODE=? AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_PREMIUM_RATE TPRR WHERE TPRR.TRAVEL_PREMIUM_ID = TPR.TRAVEL_PREMIUM_ID AND TPRR.BRANCH_CODE = TPR.BRANCH_CODE)
#####(28-04-2016)##### GET_PREMIUM_RATE_AMEND_ID=SELECT MAX(AMEND_ID) FROM TRAVEL_PREMIUM_RATE WHERE RATE_ID=? AND BRANCH_CODE=?
GET_PREMIUM_RATE_AMEND_ID = SELECT MAX(AMEND_ID) FROM TRAVEL_PREMIUM_RATE WHERE TRAVEL_PREMIUM_ID=? AND BRANCH_CODE=?
#####(28-04-2016)##### INS_PREMIUM_RATE_DTLS=INSERT INTO TRAVEL_PREMIUM_RATE( TRAVEL_PREMIUM_ID, NO_OF_DAYS, SCHEME_ID, OPTION_ID, EFF_DATE, PREMIUM, BRANCH_CODE, PRODUCT_CODE)VALUES(?,?,?,?,convert(date,?,103),?,?,?)
INS_PREMIUM_RATE_DTLS = INSERT INTO TRAVEL_PREMIUM_RATE( TRAVEL_PREMIUM_ID, NO_OF_DAYS, SCHEME_ID, OPTION_ID, EFF_DATE, PREMIUM, BRANCH_CODE, PRODUCT_CODE,AMEND_ID,STATUS,COREAPPCODE)VALUES(?,?,?,?,convert(date,?,103),?,?,?,?,?,?)
#####(28-04-2016)##### GET_PREMIUM_RATE_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_PREMIUM_RATE WHERE COREAPP_CODE=?
GET_PREMIUM_RATE_CORE_CODE = SELECT COUNT(*) FROM TRAVEL_PREMIUM_RATE TPRR WHERE COREAPPCODE=? AND STATUS = 'Y' AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_PREMIUM_RATE TPR WHERE TPR.TRAVEL_PREMIUM_ID = TPRR.TRAVEL_PREMIUM_ID)
GET_PREMIUM_RATE_CORE_CODE1 = SELECT COUNT(*) FROM TRAVEL_PREMIUM_RATE TPRR WHERE COREAPPCODE=? AND TRAVEL_PREMIUM_ID!=? AND STATUS = 'Y' AND AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_PREMIUM_RATE TPR WHERE TPR.TRAVEL_PREMIUM_ID = TPRR.TRAVEL_PREMIUM_ID)
GET_PREMIUM_RATE_AMEND_ID1=SELECT AMEND_ID FROM TRAVEL_PREMIUM_RATE MSM WHERE  AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   TRAVEL_PREMIUM_RATE WHERE   TRAVEL_PREMIUM_ID = MSM.TRAVEL_PREMIUM_ID) AND TRAVEL_PREMIUM_ID = ? AND BRANCH_CODE=? AND convert(date,EFF_DATE,103)> convert(DATE, getdate(),103)
GET_PREMIUM_RATE_HISTORY=SELECT TRAVEL_PREMIUM_ID, NO_OF_DAYS, SCHEME_ID, OPTION_ID, convert(varchar(10),EFF_DATE,103) EFF_DATE, PREMIUM, BRANCH_CODE, PRODUCT_CODE FROM TRAVEL_PREMIUM_RATE WHERE PRODUCT_CODE=? AND RATE_ID=? AND BRANCH_CODE=?
GET_PREMIUM_RATE_ID=SELECT MAX(TRAVEL_PREMIUM_ID)+1 FROM TRAVEL_PREMIUM_RATE WHERE BRANCH_CODE=?
UPDATE_DISCOUNT_RATE = UPDATE  TRAVEL_PREMIUM_RATE  SET  NO_OF_DAYS\=?, SCHEME_ID\=?, OPTION_ID\=?, EFF_DATE\=convert(date,?,103), PREMIUM\=?,PRODUCT_CODE\=?,COREAPPCODE\=?,STATUS\=? WHERE AMEND_ID \= ? AND TRAVEL_PREMIUM_ID\=? 

GET_LINK_OPTION=SELECT OPTION_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE STATUS='Y' AND PRODUCT_CODE=? AND BRANCH_CODE=?
GET_LINK_OPTION_DATA=SELECT SCHEME_ID,OPTION_ID,BRANCH_CODE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_iD=? AND PRODUCT_CODE=? AND BRANCH_CODE=?
GET_LINK_OPTION_AMEND_ID=SELECT MAX(AMEND_ID) FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_ID=? AND BRANCH_CODE=?
INS_LINK_OPTION_DTLS=INSERT INTO TRAVEL_SCHEME_OPTION_COVERS(COVER_ID,SCHEME_ID,OPTION_ID,STATUS,BRANCH_CODE,COREAPP_CODE,PRODUCT_CODE,EFFECTIVE_DATE,AMEND_ID)VALUES((SELECT isnull(MAX(COVER_ID)+1,0) FROM TRAVEL_SCHEME_OPTION_COVERS),?,?,?,?,?,?,convert(date,?,103),?)
GET_LINK_OPTION_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_SCHEME_OPTION_COVERS WHERE COREAPP_CODE=?
GET_LINK_OPTION_HISTORY=SELECT SCHEME_ID,OPTION_ID,BRANCH_CODE,convert(varchar(10),EFFECTIVE_DATE,103)  EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_iD=? AND PRODUCT_CODE=? AND BRANCH_CODE=?
GET_LINK_OPTION_ID=SELECT MAX(RATE_ID)+1 FROM TRAVEL_SCHEME_OPTION_COVERS WHERE BRANCH_CODE=?

GET_LINK_COVERAGE=SELECT OPTION_ID,OPTION_NAME FROM TRAVEL_OPTION_COVERS WHERE STATUS\='Y' AND BRANCH_CODE\=? AND OPTION_ID IN (SELECT OPTION_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE STATUS\='Y' AND PRODUCT_CODE\=? AND BRANCH_CODE\=?) 
GET_LINK_COVERAGE_DATA=SELECT TMC.COVERAGES_ID,TLC.RATE,convert(varchar(103),TLC.EFF_DATE,103),TLC.CORE_APP_CODE,TLC.STATUS FROM TRAVEL_OPTION_COVERS TMC ,TRAVEL_LINK_COVERAGES TLC ,TRAVEL_SCHEME_OPTION_COVERS TSOC WHERE  TLC.COVER_ID = TSOC.COVER_ID AND TSOC.SCHEME_ID=?  AND TSOC.OPTION_ID=?  AND TSOC.PRODUCT_CODE=? AND TSOC.BRANCH_CODE=?  AND TSOC.STATUS='Y' AND TSOC.COVER_ID = TLC.COVER_ID  AND TMC.COVERAGES_ID = TLC.COVERAGES_ID AND TMC.STATUS = 'Y' AND TLC.STATUS = 'Y' AND TLC.BRANCH_CODE = ? AND TLC.PRODUCT_CODE = ? AND convert(date,TLC.EFF_DATE,103) < convert(date,getdate(),103) AND TLC.AMEND_ID = (SELECT MAX(AMEND_ID) FROM TRAVEL_LINK_COVERAGES WHERE PRODUCT_CODE=TLC.PRODUCT_CODE AND COVER_ID = TLC.COVER_ID AND BRANCH_CODE = TLC.BRANCH_CODE AND convert(date,EFF_DATE,103) <= convert(date,getdate(),103)
GET_LINK_COVERAGE_AMEND_ID=SELECT MAX(AMEND_ID) FROM TRAVEL_OPTION_COVERS WHERE RATE_ID=? AND BRANCH_CODE=?
INS_LINK_COVERAGE_DTLS=INSERT INTO TRAVEL_LINK_COVERAGES (SNO,COVERAGES_ID,COVER_ID,RATE,STATUS,PRODUCT_CODE,BRANCH_CODE,eff_date,amend_id) VALUES ((SELECT isnull(MAX(SNO)+1,0) FROM TRAVEL_LINK_COVERAGES),?,(SELECT COVER_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_ID=? AND OPTION_ID=? AND PRODUCT_CODE=? and BRANCH_CODE=?),?,'Y',?,?,convert(date,?,103),(select isnull(MAX(amend_id),'-1')+1 from TRAVEL_LINK_COVERAGES where COVERAGES_ID=? and COVER_ID=((SELECT COVER_ID FROM TRAVEL_SCHEME_OPTION_COVERS WHERE SCHEME_ID=? AND OPTION_ID=? AND PRODUCT_CODE=? and BRANCH_CODE=?)) and PRODUCT_CODE=? and BRANCH_CODE=?))
GET_LINK_COVERAGE_CORE_CODE=SELECT COUNT(*) FROM TRAVEL_OPTION_COVERS WHERE COREAPP_CODE=?
GET_LINK_COVERAGE_HISTORY=SELECT RATE_ID,TYPE,AGE_START,AGE_END,RATE_VALUE,convert(varchar(10),EFFECTIVE_DATE,103) EFFECTIVE_DATE,COREAPP_CODE,STATUS,PRODUCT_CODE FROM TRAVEL_OPTION_COVERS WHERE PRODUCT_CODE=? AND RATE_ID=? AND BRANCH_CODE=?
GET_LINK_COVERAGE_ID=SELECT MAX(RATE_ID)+1 FROM TRAVEL_OPTION_COVERS WHERE BRANCH_CODE=?

##- Travel Admin End Here



######## Branch Report Scheduler############
GET_BRANCHDETAILS_LIST = SELECT BRANCH_CODE,BRANCH_NAME,BELONGING_BRANCH FROM BRANCH_MASTER WHERE STATUS='Y'
GET_BRANCH_REPORT_CNT = SELECT COUNT(*) FROM (SELECT * FROM ADMINREPORTS(?,?,?,'3',?,?) UNION ALL SELECT * FROM ADMINREPORTS(?,?,?,'11',?,?))
GET_BRANCH_SCHEDULE_CNT = select COUNT(*) from schedule_reports('',?,?,?)
GET_BRANCH_DEBIT_CNT = select COUNT(*) from Debit_Schedule_new('',?,?,?,?)
GET_BRANCH_CREDIT_CNT = select COUNT(*) from Debit_Schedule_new('',?,?,?,?)
############################################

#### COMMON QUERIES ##################
LOG_BRANCH_FROM_BCM=SELECT ISNULL(BRANCH_CODE,'020') FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
LOG_BRANCH_FROM_LM=select NULLIF(BRANCH_CODE,'020') from LOGIN_master where login_id=?
GET_DEFAULT_BRANCH=SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID='116' AND CATEGORY_DETAIL_ID=1 AND STATUS='Y' and branch_code=?
GET_PROD_BROK=SELECT PRODUCT_ID, PRODUCT_NAME FROM PRODUCT_MASTER WHERE STATUS='Y' AND BRANCH_CODE=(SELECT   BELONGING_BRANCH FROM   BRANCH_MASTER BM WHERE   BRANCH_CODE = ? AND STATUS = 'Y'  AND AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   BRANCH_MASTER BM1 WHERE   BM1.BRANCH_CODE = BM.BRANCH_CODE  AND BM1.STATUS = BM.STATUS)) AND PRODUCT_ID IN (SELECT PRODUCT_ID FROM LOGIN_USER_DETAILS WHERE AGENCY_CODE=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE  LOGIN_ID=?) AND STATUS='Y') ORDER BY DISPLAY_ORDER ASC
GET_BROKUSER_DET=SELECT CURRENCY_ABBREVIATION,ORIGINATION_COUNTRY_ID,DESTINATION_COUNTRY_ID,CURRENCY_ABBREVIATION,DECIMAL_PLACES,ISNULL(TAX,'0') TAX,EMAIL,LANG_YN FROM BRANCH_MASTER WHERE BRANCH_CODE=?
GET_ADMIN_PROD=SELECT PRODUCT_ID FROM LOGIN_MASTER WHERE LOGIN_ID=?
GET_PROD_LIST=SELECT PRODUCT_ID, PRODUCT_NAME,RSACODE FROM PRODUCT_MASTER WHERE STATUS=''Y'' AND BRANCH_CODE=(SELECT   BELONGING_BRANCH FROM   BRANCH_MASTER BM WHERE   BRANCH_CODE = ? AND STATUS = ''Y''  AND AMEND_ID =(SELECT   MAX (AMEND_ID) FROM   BRANCH_MASTER BM1 WHERE   BM1.BRANCH_CODE = BM.BRANCH_CODE  AND BM1.STATUS = BM.STATUS)) AND PRODUCT_ID IN (''{0}'') ORDER BY DISPLAY_ORDER ASC
GET_OFSPROD_SCHEM=SELECT S.SCHEME_ID,(P.PRODUCT_NAME||' - '||S.SCHEME_NAME) SCHEME_NAME, P.PRODUCT_ID FROM PRODUCT_MASTER P,OFS_SCHEME_MASTER S WHERE P.STATUS=S.STATUS AND S.STATUS='Y' AND P.BRANCH_CODE=S.BRANCH_CODE AND S.BRANCH_CODE=? AND S.PRODUCT_ID=P.PRODUCT_ID AND S.SCHEME_ID IN (SELECT SCHEME_ID FROM LOGIN_USER_DETAILS WHERE SCHEME_ID IS NOT NULL AND AGENCY_CODE=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?) AND STATUS='Y') ORDER BY S.SCHEME_ID
GET_CUST_RIGHT=SELECT PRODUCT_ID,CUSTOMER_QUOTE,CUSTOMER_SCHEDULE,CUSTOMER_DEBIT,CUSTOMER_CUSTOMERDEBIT,CUSTOMER_POLICY,CUSTOMER_CERTIFICATE,FREIGHT_DEBIT_OPTION FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? ORDER BY PRODUCT_ID
GET_BROKDC=select count(*) from LOGIN_USER_DETAILS where oa_code=(select oa_code from login_master where login_id=?) and CUSTOMER_CERTIFICATE='Y' and product_id='11'
GET_LOGIN_BRANCH=select BRANCH_CODE , BRANCH_NAME from branch_master where STATUS='Y'
GET_STAMP_STATUS=select ISNULL(home.PDF_Stamp_Status,' ') from POSITION_MASTER home where 
GET_MXT_AMD=select ISNULL(max(amend_id),'0')+1 from draft_pdf_tracking where quote_no=?
GET_MAILBEAN=select application_no,login_id,product_id,ISNULL(open_cover_no,''0''),quote_no from position_master where {0}
GET_BROKER_DETAIL_LIST = SELECT BCM.COMPANY_NAME,LM.LOGIN_ID FROM BROKER_COMPANY_MASTER BCM, LOGIN_MASTER LM, LOGIN_USER_DETAILS lud  WHERE BCM.BRANCH_CODE=? AND LM.AGENCY_CODE=BCM.AGENCY_CODE AND LM.BRANCH_CODE=BCM.BRANCH_CODE and lud.LOGIN_ID=lm.LOGIN_ID and lud.PRODUCT_ID= ? and AMEND_ID=(select max(AMEND_ID) from LOGIN_USER_DETAILS where LOGIN_ID =lud.LOGIN_ID and PRODUCT_ID=lud.PRODUCT_ID) ORDER BY COMPANY_NAME
GET_USER_DETAIL_LIST = SELECT LM.USERNAME,LM.LOGIN_ID FROM LOGIN_MASTER LM WHERE LM.OA_CODE=(SELECT LMS.AGENCY_CODE FROM LOGIN_MASTER LMS WHERE LMS.LOGIN_ID=? ) ORDER BY USERNAME
################################################################################################

##upload 
DEL_DOCUMENTS=delete  from DOCUMENT_UPLOAD_DETAILS Where FILE_PATH_NAME=?
GET_DOCUMENTS_COUNT_HOME=select count(*) from DOCUMENT_UPLOAD_DETAILS Where QUOTE_NO\=? 
GET_DOCUMENTS_COUNT_MOTOR=select count(*) from DOCUMENT_UPLOAD_DETAILS Where QUOTE_NO=?  AND VTYPE_ID=?
GET_DOCUMENTS_CNT_MOTOR=select count(*) from DOCUMENT_UPLOAD_DETAILS Where QUOTE_NO=?  AND VTYPE_ID=? AND STATUS='Y'
INS_DOCUMENTS =INSERT INTO DOCUMENT_UPLOAD_DETAILS(QUOTE_NO,DOC_TYPE_ID,FILE_PATH_NAME,DESCRIPTION,STATUS,FILE_NAME,PRODUCT_ID,VTYPE_ID)VALUES(?,?,?,?,?,?,?,?)
INS_DOCUMENTS1 =INSERT INTO DOCUMENT_UPLOAD_DETAILS(QUOTE_NO,DOC_TYPE_ID,FILE_PATH_NAME,DESCRIPTION,STATUS,FILE_NAME,PRODUCT_ID,VTYPE_ID,UPLOAD_TYPE,DOC_ID)VALUES(?,?,?,?,?,?,?,?,?,?)
GET_UPLOAD_DOCUMENTS_LIST_HOME= SELECT  DM.DOCUMENT_ID, DM.DOCUMENT_DESC, DM.DOCUMENT_DESC_AR,DUD.FILE_PATH_NAME, DUD.FILE_NAME, DUD.DESCRIPTION FROM DOCUMENT_UPLOAD_DETAILS DUD,DOCUMENT_MASTER DM where DUD.QUOTE_NO=? and DUD.PRODUCT_ID=? AND  DUD.DOC_TYPE_ID=DM.DOCUMENT_ID
GET_UPLOAD_DOCUMENTS_LIST_MOTOR= SELECT  DM.DOCUMENT_ID, DM.DOCUMENT_DESC, DM.DOCUMENT_DESC_AR,DUD.FILE_PATH_NAME, DUD.FILE_NAME, DUD.DESCRIPTION FROM DOCUMENT_UPLOAD_DETAILS DUD,DOCUMENT_MASTER DM where DUD.QUOTE_NO=? and DUD.PRODUCT_ID=? and VTYPE_ID=? AND  DUD.DOC_TYPE_ID=DM.DOCUMENT_ID

GET_MOTOR_DOCUMENTS_LIST = SELECT DOCUMENT_ID,DOCUMENT_DESC,DOCUMENT_DESC_AR,MANDATORY_STATUS FROM DOCUMENT_MASTER WHERE  STATUS\='Y'  and PRODUCT_ID \=? AND ISNULL(DOC_APPLICABLE,'') NOT IN ('PROMO') AND POLICY_TYPE  LIKE '%,'+(SELECT cast( ISSELECTCOVER as varchar) FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO\=?)+',%' AND DOCUMENT_ID NOT IN (select DOC_TYPE_ID from DOCUMENT_UPLOAD_DETAILS where quote_no\=?) ORDER BY DISPLAY_ORDER
GET_MOTOR_DOCUMENTS_LIST_PROMO = SELECT DOCUMENT_ID,DOCUMENT_DESC,DOCUMENT_DESC_AR,MANDATORY_STATUS FROM DOCUMENT_MASTER WHERE  STATUS\='Y'  and PRODUCT_ID \=? AND POLICY_TYPE  LIKE '%,'+(SELECT cast( ISSELECTCOVER as varchar) FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO\=?)+',%' AND DOCUMENT_ID NOT IN (select DOC_TYPE_ID from DOCUMENT_UPLOAD_DETAILS where quote_no\=?) ORDER BY DISPLAY_ORDER

GET_MOTOR_DOCUMENTS_LIST_OTHERS = SELECT DOCUMENT_ID,DOCUMENT_DESC,DOCUMENT_DESC_AR,MANDATORY_STATUS FROM DOCUMENT_MASTER WHERE  STATUS\='Y'  and PRODUCT_ID \=? AND ISNULL(DOC_APPLICABLE,'') NOT IN ('PROMO') AND UPPER(DOCUMENT_DESC) \= UPPER('OTHERS') AND POLICY_TYPE  LIKE '%,'+(SELECT cast( ISSELECTCOVER as varchar) FROM MOTOR_POLICY_DETAILS WHERE APPLICATIONNO\=?)+',%' ORDER BY DISPLAY_ORDER
GET_UPLOAD_DOCUMENTS_LIST_MOTOR_FLEET=SELECT  DM.DOCUMENT_ID, DM.DOCUMENT_DESC, DM.DOCUMENT_DESC_AR,DUD.FILE_PATH_NAME, DUD.FILE_NAME, DUD.DESCRIPTION FROM DOCUMENT_UPLOAD_DETAILS DUD,DOCUMENT_MASTER DM where DUD.QUOTE_NO\=? and DUD.PRODUCT_ID\=? AND  DUD.DOC_TYPE_ID\=DM.DOCUMENT_ID And DM.PRODUCT_ID\=DUD.PRODUCT_ID
GET_MOTOR_DOCUMENTS_LIST_PRO = SELECT DOCUMENT_ID,DOCUMENT_DESC,MANDATORY_STATUS FROM MOTOR_DOCUMENT_MASTER WHERE  STATUS='Y' AND DOC_APPLICABLE=? AND DOCUMENT_ID = ?
GET_MOTOR_DOCUMENTS_LIST1 = SELECT DOCUMENT_ID,DOCUMENT_DESC,MANDATORY_STATUS FROM MOTOR_DOCUMENT_MASTER WHERE  STATUS='Y' AND DOC_APPLICABLE=? AND POLICY_TYPE LIKE ('%,'+?+',%') ORDER BY DISPLAY_ORDER
DOCUMENT_MAND_VALIDATE=WITH E (COUNTS) AS ( SELECT COUNT(*) COUNTS FROM (SELECT DOCUMENT_ID FROM DOCUMENT_MASTER MDM WHERE STATUS \= ''Y''  AND POLICY_TYPE LIKE (''%,{0},%'') AND MANDATORY_STATUS\=''Y'' AND ISNULL(DOC_APPLICABLE,'''') NOT IN (''PROMO'')) AS AD) , E1 (SELECTED) AS  (SELECT COUNT( DISTINCT DOC_TYPE_ID) SELECTED FROM DOCUMENT_UPLOAD_DETAILS WHERE DOC_TYPE_ID IN(SELECT DOCUMENT_ID FROM DOCUMENT_MASTER MDM WHERE STATUS \= ''Y'' AND POLICY_TYPE LIKE (''%,{0},%'') AND MANDATORY_STATUS\=''Y'' AND ISNULL(DOC_APPLICABLE,'''') NOT IN (''PROMO'')) AND QUOTE_NO\=? ) SELECT ( CASE WHEN COUNTS\=SELECTED THEN 1 ELSE 0 END) FROM E,E1
DOCUMENT_MAND_VALIDATE_PROMO=WITH E (COUNTS) AS ( SELECT COUNT(*) COUNTS FROM (SELECT DOCUMENT_ID FROM DOCUMENT_MASTER MDM WHERE STATUS \= ''Y''  AND POLICY_TYPE LIKE (''%,{0},%'') AND MANDATORY_STATUS\=''Y'') AS AD) , E1 (SELECTED) AS  (SELECT COUNT( DISTINCT DOC_TYPE_ID) SELECTED FROM DOCUMENT_UPLOAD_DETAILS WHERE DOC_TYPE_ID IN(SELECT DOCUMENT_ID FROM DOCUMENT_MASTER MDM WHERE STATUS \= ''Y'' AND POLICY_TYPE LIKE (''%,{0},%'') AND MANDATORY_STATUS\=''Y'') AND QUOTE_NO\=?) SELECT ( CASE WHEN COUNTS\=SELECTED THEN 1 ELSE 0 END) FROM E,E1

GET_DOCUMENT_TYPE = SELECT DISTINCT DOC_TYPE_ID FROM DOCUMENT_UPLOAD_DETAILS WHERE QUOTE_NO\=? 
##AND UPLOAD_TYPE IN ('QUOTE','POLICY')
GET_DOCUMENT_GROUP = SELECT DISTINCT DOC_TYPE_ID,(SELECT UPPER(DOCUMENT_DESC) FROM DOCUMENT_MASTER MDM WHERE DOCUMENT_ID=DOC_TYPE_ID ) DOCUMENT_DESC FROM DOCUMENT_UPLOAD_DETAILS WHERE QUOTE_NO=? ORDER BY DOC_TYPE_ID
GET_DOCUMENT_DETAILS = SELECT (SELECT UPPER(DOCUMENT_DESC) FROM DOCUMENT_MASTER MDM  WHERE DOCUMENT_ID=DOC_TYPE_ID ) DOCUMENT_DESC,FILE_PATH_NAME,DESCRIPTION,PRODUCT_ID,STATUS DOC_STATUS,FILE_NAME,VTYPE_ID,UPLOAD_TYPE,DOC_ID FROM DOCUMENT_UPLOAD_DETAILS WHERE QUOTE_NO = ? AND DOC_TYPE_ID = ? ORDER BY UPLOADED_TIME
GET_UPLOAD_TYPE = SELECT DOC_APPLICABLE FROM DOCUMENT_MASTER MDM WHERE DOCUMENT_ID\= ?  
GET_VERIFIED_DOCUMENT =SELECT COUNT(*) FROM POLICYCANCELLATIONDOCUMENTS WHERE FPOLICY=? AND (FVERIFIED='0' OR FVERIFIED IS NULL)
GET_CANCEL_DOCUMENT_COUNT =SELECT COUNT(*) FROM POLICYCANCELLATIONDOCUMENTS WHERE FPOLICY=?
##Motor Report
##GET_MOTOR_REPORT =SELECT POLICYTYPE,(Select POLICYTYPE_DESC_ENGLISH FROM MOTOR_POLICYTYPE_MASTER MPM WHERE MPM.POLICY_SUBTYPE_ID=A.POLICYTYPE) POLICY_NAME,NO_OF_POLICY,Premium From (Select Policytype,Count(*) NO_OF_POLICY,Sum(Premium) Premium  from  Motor_data_detail   Where  CONVERT(DATE,INCEPTION_DATE,103) Between CONVERT(DATE,?,103) and  CONVERT(DATE,?,103) and quote_no in (Select quote_no from home_position_master Where status='P') group by Policytype) A  order by Policytype ASC
GET_MOTOR_REPORT = SELECT POLICYTYPE,(Select POLICYTYPE_DESC_ENGLISH FROM MOTOR_POLICYTYPE_MASTER MPM WHERE MPM.POLICY_SUBTYPE_ID=A.POLICYTYPE) POLICY_NAME,NO_OF_POLICY,Premium From (Select MDD.Policytype,Count(*) NO_OF_POLICY,Sum(HPM.Premium) Premium  from  Motor_data_detail MDD,HOME_POSITION_MASTER HPM  Where HPM.QUOTE_NO=MDD.QUOTE_NO AND  CONVERT(DATE,HPM.ENTRY_DATE,103) Between CONVERT(DATE,?,103) and  CONVERT(DATE,?,103)  and  HPM.status in ('P','N')  group by Policytype) A  order by Policytype ASC
GET_MOTOR_REPORT_DETAIL =Select POLICYTYPENAME,MAKE_NAME,MODEL_NAME,TYPE_OF_BODY_NAME,VEHICLETYPE_DESC,MANUFACTURE_YEAR,SEATING_CAPACITY,CUBIC_CAPACITY,AREA_COVERAGE,SUMINSURED_VALUE_LOCAL,BASE_RATE VEHICLERATE,PREMIUM,OPTIONAL_COVER,NO_CLAIM_BONUS,CLAIMYN,CLAIM_AMOUNT,DRIVER_ID,DRIVER_DOB,VEHICLE_COLOR,POLICY_NO from Motor_Policy_Reports(?,?,?,'',?)
GET_DAILY_REPORT_DETAIL = SELECT  * FROM (select 'BuyQuote' AS TYPE,* from motor_policy_reports_NEW(?,?,'5' ,'BuyQuote','01' )UNION ALL select 'PaymentFailed',* from motor_policy_reports_NEW(?,?,'5' ,'PaymentFailed','01' ) UNION ALL select 'Quote',* from motor_policy_reports_NEW(?,?,'5' ,'Quote','01' ) UNION ALL select 'FailedQuote',* from motor_policy_reports_NEW(?,?,'5' ,'FailedQuote','01' ) UNION ALL select 'Policy',* from motor_policy_reports_NEW(?,?,'5' ,'Policy','01' ))A
## Travel Report
GET_TRAVEL_REPORT =SELECT distinct * FROM TRAVEL_REPORT(?,?,?,?))

## Common Custoemr info
GET_CUSTOMER_INFORMATION=SELECT PI.OCCUPATION,PI.CUSTOMER_ID,PI.TITLE,PI.FIRST_NAME, PI.COMPANY_NAME,PI.MOBILE,PI.EMAIL,PI.ADDRESS1,PI.ADDRESS2,PI.POBOX,PI.EMIRATE,PI.MISSIPPI_CUSTOMER_CODE,PI.CLIENT_CUSTOMER_ID,PI.CUST_AR_NO,PI.LAST_NAME,PI.NRC,PI.PASSPORT_NUMBER,convert(varchar(10),PI.DOB,103) CUST_DOB,CONVERT(VARCHAR,CONVERT(DATE,PI.DOB_AR,120),103) DOB_AR,PI.ALTERNATE_MOBILE,PI.TELEPHONE,PI.CUSTOMER_TYPE,PI.COMPANY_REG_NO,PI.CUST_NAME_ARABIC,PI.GENDER,PI.OCCUPATION, pi.ADDITIONAL_NO,pi.building_no,pi.SALES_USERID,pi.Ins_City,pi.NATIONALITY ,pi.Ins_City,pi.ZIPCODE,pi.NEIGHBORHOOD,pi.UNITNO,pi.STREET,pi.ADDRESS_IDENTIFIER,pi.INS_POBOX,pi.WASEEL_BUILDINGNO,pi.WASEEL_ADDITIONAL_NO,pi.WASEEL_ZIPCODE,pi.WASEEL_CITY,pi.WASEEL_NEIGHBORHOOD,pi.INS_POCODE,PI.QUOTE_TYPE,PI.LOGIN_ID LOGIN_ID,PI.EDUCATION EDUCATION,PI.MARITAL_STATUS MARITAL_STATUS, PI.CHILD_BELOW16 CHILD_BELOW16,PI.WORK_COMP_NAME WORK_COMP_NAME

#Sequence NO
CHECK_MOTOR_SEQ_NO =SELECT COUNT(*) FROM MOTOR_DATA_DETAIL WHERE SEQUENCE_NO\=? and APPLICATION_NO \!\= ?

#Missing Query
#Validation for coverage
COVER_REFERAL_VALIDATE = SELECT   COUNT ( * ) from (Select Item Coverage_Referal from FN_Split_SV((Select Coverage_Referal From Commoditymaster CMC Where  Commodity_Id=? And Branch_Code=? And Amend_Id= (Select Max(Amend_Id) From Commoditymaster CM Where CM.Branch_Code =CMC.Branch_Code And cm.Commodity_Id=CMC.Commodity_Id)),',')) A WHERE   A.Coverage_Referal = ?
GET_INVOICE_EXIST_ONEOFF=select  pm.quote_no from MARINE_RESULT_DETAILS mrd,position_master pm where INVOICE_NUMBER=? and pm.login_id=(select LOGIN_ID from login_master   where agency_code=?) and mrd.application_no not in (?) and  mrd.application_no=pm.application_no
GET_INVOICE_EXIST_OC=select  pm.quote_no from MARINE_RESULT_DETAILS mrd,position_master pm where INVOICE_NUMBER=? and mrd.OPEN_COVER_NO=? and mrd.application_no not in (?) and  mrd.application_no=pm.application_no

## For Edit Claueses
QUOTE_FINALIZE_YN=select ISNULL(EDIT_CLAUSES_YN,'N') EDIT_CLAUSES_YN,ISNULL(finalize_yn,'N') finalize_yn,BASIS_VAL from position_master where application_no\=?
GET_PDF_MODIFY_CLAUSES=select PDF_MODIFY_CLAUSE,PDF_MODIFY_WARRANTY,PDF_MODIFY_EXCLUSION,PDF_MODIFY_EXTRACLAUSES,APPLICATION_NO from position_master where quote_no\=? and amend_id\=(select max(amend_id) from position_master where quote_no\=? )
GET_CONDITIONS_CLAUSES=select CODE,CODEDESC,CODESTATUS FROM SCHEDULE_CLAUSES(?,?,?,?) WHERE CODEDESC IS NOT NULL
UPDATE_PDF_MODIFY_CLAUSES=UPDATE POSITION_MASTER SET PDF_MODIFY_CLAUSE=? WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=?)
UPDATE_PDF_MODIFY_EXTRACLAUSES=UPDATE POSITION_MASTER SET PDF_MODIFY_EXTRACLAUSES=? WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=?)
UPDATE_PDF_MODIFY_WARRANTY=UPDATE POSITION_MASTER SET PDF_MODIFY_WARRANTY=? WHERE QUOTE_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO=?)
UPDATE_PDF_MODIFY_EXCLUSION=UPDATE POSITION_MASTER SET PDF_MODIFY_EXCLUSION\=? WHERE QUOTE_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE QUOTE_NO\=?)
GET_UPDATE_PREMIUMYN=UPDATE POSITION_MASTER SET PDF_PRE_SHOW_STATUS\=?,finalize_yn\=?,EDIT_CLAUSES_YN\=?,BASIS_VAL\=? WHERE APPLICATION_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO\=?)
GET_UPDATE_PREMIUMYN_FIN=UPDATE POSITION_MASTER SET PDF_PRE_SHOW_STATUS\=?,EDIT_CLAUSES_YN\=? WHERE APPLICATION_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER WHERE APPLICATION_NO\=?)
#GET DEDUCTABLES
GET_DEDUCT=SELECT NULLIF(DEDUCTIBLE,'0') DEDUCTIBLE,NULLIF(RATE,'0') RATE  FROM COMMODITY_EXCESS_PREMIUM CEP WHERE CONVERT(decimal(30,5), CAST(? AS FLOAT)) BETWEEN START_SUM_INSURED AND END_SUM_INSURED AND STATUS='Y' AND AMEND_ID =   (SELECT MAX (AMEND_ID) FROM COMMODITY_EXCESS_PREMIUM WHERE CONVERT(decimal(30,5), CAST(? AS FLOAT)) BETWEEN START_SUM_INSURED AND END_SUM_INSURED and STATUS = CEP.STATUS )
#For Commission
GET_COMMISSION_DETAILS=SELECT NULLIF (lud.COMMISSION, 0) COMMISSION FROM login_user_details lud WHERE lud.agency_code = (Select oa_code from login_master lm where  lm.login_id = (Select login_id from position_master where application_no=?)) AND lud.product_id = ? AND lud.amend_id =(SELECT   MAX (amend_id) FROM  login_user_details ludd WHERE   lud.login_id = ludd.login_id AND ludd.product_id = lud.product_id)
UPD_COMMISSION_DETAILS=UPDATE POSITION_MASTER  SET DISCOUNT_PREMIUM\=NULLIF(CONVERT(Decimal,CAST(? AS FLOAT)),0) WHERE APPLICATION_NO\=?
GET_UW_REFLIST=SELECT * FROM dbo.REFERAL_LIST(?,?)
GET_QUOTE_MAILIDS = SELECT (case APPLICATION_ID when '1' then '' else (SELECT USER_MAIL FROM LOGIN_MASTER WHERE LOGIN_ID\=PM.APPLICATION_ID) end) CC_ADDRESS, (SELECT USER_MAIL FROM LOGIN_MASTER WHERE AGENCY_CODE \= (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=PM.LOGIN_ID)) TO_ADDRESS FROM POSITION_MASTER PM WHERE APPLICATION_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER PM1 WHERE  PM1.APPLICATION_NO\=PM.APPLICATION_NO)
GET_QUOTE_USER_MAILIDS = SELECT (case APPLICATION_ID when '1' then '' else (SELECT USER_MAIL FROM LOGIN_MASTER WHERE LOGIN_ID\=PM.APPLICATION_ID) end) CC_ADDRESS, (SELECT USER_MAIL FROM LOGIN_MASTER WHERE AGENCY_CODE \= (SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=PM.LOGIN_ID)) TO_ADDRESS FROM POSITION_MASTER PM WHERE APPLICATION_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM POSITION_MASTER PM1 WHERE  PM1.APPLICATION_NO\=PM.APPLICATION_NO)
GET_REFERRAL_MAIL_DATAS = SELECT PM.QUOTE_NO,PM.APPLICATION_ID, nullif(md.remarks, 'Normal') REFERRAL_REMARKS, (case PM.APPLICATION_ID when  '1' then '' else (SELECT LM.USERNAME FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID \= PM.APPLICATION_ID) end) ISSUER_NAME, (PI.TITLE + ' ' + PI.first_name + ' ' + PI.Last_name) CUSTOMER_NAME, (SELECT nullif (BCM.company_name, ' ') FROM broker_company_master BCM WHERE BCM.agency_code \= (SELECT LM.oa_code FROM login_master LM WHERE LM.login_id \= PM.LOGIN_ID)) BROKER_COMPANY_NAME FROM POSITION_MASTER PM, MARINE_DATA MD, PERSONAL_INFO PI WHERE PM.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.APPLICATION_NO \= PM.APPLICATION_NO) AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PI.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PI1 WHERE PI1.CUSTOMER_ID \= PI.CUSTOMER_ID) AND MD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO \= MD.APPLICATION_NO)
GET_REFERRAL_USER_MAIL_DATAS =SELECT PM.QUOTE_NO,PM.APPLICATION_ID, nullif (md.remarks, 'Normal') REFERRAL_REMARKS, (case PM.APPLICATION_ID when   '1' then '' else  (SELECT LM.USERNAME FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID \= PM.APPLICATION_ID) end) ISSUER_NAME, (PI.TITLE + ' ' +PI.first_name + ' ' + PI.Last_name) CUSTOMER_NAME,(case PM.APPLICATION_ID when  '1' then (SELECT (PI.first_name + ' ' + PI.Last_name) CUSTOMER_NAME FROM PERSONAL_INFO UPI WHERE UPI.LOGIN_ID\=PM.LOGIN_ID AND UPI.APPLICATION_ID\='2') else (SELECT nullif (BCM.company_name, '') FROM broker_company_master BCM WHERE BCM.agency_code \= (SELECT LM.oa_code FROM login_master LM WHERE LM.login_id \= PM.LOGIN_ID)) end) BROKER_COMPANY_NAME FROM POSITION_MASTER PM, MARINE_DATA MD, PERSONAL_INFO PI WHERE PM.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.APPLICATION_NO \= PM.APPLICATION_NO) AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PI.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PI1 WHERE PI1.CUSTOMER_ID \= PI.CUSTOMER_ID) AND MD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO \= MD.APPLICATION_NO)
GET_CLAIM_INFO=SELECT email_to TO_ADDRESS,email_CC CC_ADDRESS from mail_details where email_type='CLAIM' and STATus='Y' and BRANCH_CODE=?
##Travel New Queries
GET_MONTH_COUNT_PASSPORTEXPDATE = SELECT  CATEGORY_DETAIL_ID FROM CONSTANT_DETAIL WHERE CATEGORY_ID=162

#Admin Opencover Changes
GET_COMMODITY_LIST_CLAUSES=SELECT COMMODITY_ID CODE,COMMODITY_NAME_DESC CODE_DESC FROM OPEN_COVER_COMMODITY_MASTER OCPM WHERE PROPOSAL_NO\=? AND OCPM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER OCP WHERE OCPM.PROPOSAL_NO\=OCP.PROPOSAL_NO) ORDER BY COMMODITY_NAME_DESC 
GET_COVER_LIST_CLAUSES=SELECT OCSD.COVER_ID CODE,COVER_NAME CODE_DESC FROM OPEN_COVER_SUB_DETAIL OCSD,COVER_MASTER CM WHERE OCSD.COVER_ID\=CM.COVER_ID AND PROPOSAL_NO\=? AND CM.Branch_code\=? AND OCSD.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_SUB_DETAIL OCP WHERE OCSD.PROPOSAL_NO\=OCP.PROPOSAL_NO) ORDER BY COVER_NAME
GET_DEFLT_ORCODE=select PERCENT,RSACODE from constant_detail where CATEGORY_ID \='154' AND BRANCH_CODE \= ?

##Payment Details
INS_PAY_DETAILS = INSERT INTO PAYMENT_DETAIL(APPLICATION_NO,QUOTE_NO,PRODUCT_ID,PAYMENT_TYPE,CHEQUE_NO,BANK_NAME,MICR_CODE,CHEQUE_AMOUNT,CHEQUE_DATE,REQUEST_TIME,MERCHANT_REFERENCE,CUSTOMER_EMAIL,CUSTOMER_NAME,BRANCH_CODE,CURRENCY_TYPE,PREMIUM,NO_OF_INSTALLMENT,INSTALLMENT_AMOUNT,INSTALLMENT_FREQUENCY,INSTALLMENT_START_DATE,INSTALLMENT_YN) VALUES (?,?,?,?,?,?,?,?, TO_DATE(?,'DD/MM/YYYY'),SYSDATETIME(),?,?,?,?,?,?,?,?,?,?,?)
##GET_REFERRAL_USER_MAIL_DATAS =SELECT PM.QUOTE_NO,PM.APPLICATION_ID, NVL (md.remarks, 'Normal') REFERRAL_REMARKS, DECODE (PM.APPLICATION_ID, '1', '', (SELECT LM.USERNAME FROM LOGIN_MASTER LM WHERE LM.LOGIN_ID \= PM.APPLICATION_ID)) ISSUER_NAME, (PI.TITLE || ' ' || PI.first_name || ' ' || PI.Last_name) CUSTOMER_NAME, DECODE (PM.APPLICATION_ID,'1',(SELECT (PI.first_name || ' ' || PI.Last_name) CUSTOMER_NAME FROM PERSONAL_INFO UPI WHERE UPI.LOGIN_ID\=PM.LOGIN_ID AND UPI.APPLICATION_ID\='2'),(SELECT NVL (BCM.company_name, ' ') FROM broker_company_master BCM WHERE BCM.agency_code \= (SELECT LM.oa_code FROM login_master LM WHERE LM.login_id \= PM.LOGIN_ID))) BROKER_COMPANY_NAME FROM POSITION_MASTER PM, MARINE_DATA MD, PERSONAL_INFO PI WHERE PM.APPLICATION_NO \= ? AND MD.APPLICATION_NO \= PM.APPLICATION_NO AND PM.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM POSITION_MASTER PM1 WHERE PM1.APPLICATION_NO \= PM.APPLICATION_NO) AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND PI.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM PERSONAL_INFO PI1 WHERE PI1.CUSTOMER_ID \= PI.CUSTOMER_ID) AND MD.AMEND_ID \= (SELECT MAX (AMEND_ID) FROM MARINE_DATA MD1 WHERE MD1.APPLICATION_NO \= MD.APPLICATION_NO)
GET_COMMON_CCADDRESS =SELECT MAIL_CC FROM MAIL_MASTER WHERE APP_ID\=?
GET_BRANCH_MAILIDS = SELECT EMAIL_TO TO_ADDRESS, EMAIL_CC CC_ADDRESS FROM MAIL_DETAILS WHERE BRANCH_CODE=?
##Endt list 
GET_HOME_ENDT_INFO = SELECT A.APPLICATION_NO, A.QUOTE_NO, (CASE WHEN A.STATUS = 'R' THEN 'RR' WHEN (a.REMARKS IN ('Referal')) THEN 'RU' WHEN (a.REMARKS IN ('Admin') AND A.STATUS = 'E') THEN 'RA' ELSE 'N' END) REF_STATUS, A.STATUS,A.ENDT_STATUS FROM HOME_POSITION_MASTER A WHERE A.PRODUCT_ID=? AND A.ORIGINAL_POLICY_NO=? AND A.QUOTE_NO = (SELECT MAX(QUOTE_NO) FROM HOME_POSITION_MASTER WHERE LOGIN_ID = a.LOGIN_ID AND PRODUCT_ID = A.PRODUCT_ID AND ORIGINAL_POLICY_NO = A.ORIGINAL_POLICY_NO)
##TRAVEL REPORT
GET_ADMIN_OVERALL_REPORT = SELECT distinct * FROM TRAVEL_REPORT(?,?,?,?,?)
CHECK_CREDIT_NOTE_STATUS = select FREIGHT_DEBIT_OPTION from login_user_details where login_id=? and PRODUCT_ID=?



#######################################################################################################################
################################################### OPEN COVER ########################################################
######################################################################################################################@
getBrokerDetail=select NULLIF(company_name,'0'), NULLIF(contact_person,'0') from broker_company_master where agency_code = (select oa_code from login_master where login_id = (select broker_id from open_cover_master where proposal_no = ? and amend_id = (select max(amend_id) from open_cover_master where proposal_no = ? )))
getDetails=select a.proposal_no,NULLIF(a.open_cover_no,'0'),NULLIF(CONVERT(b.policy_start_date,103),' '),NULLIF(CONVERT(b.policy_end_date,103),' '),NULLIF(first_name,NULLIF(company_name,' ')) from open_cover_position_master a, open_cover_master b,personal_info c where a.status='Y' and a.proposal_no = b.proposal_no and b.amend_id = (select max(amend_id) from open_cover_master b where b.proposal_no = a.proposal_no) and c.customer_id =b.customer_id order by a.proposal_no
getDetailsApproved=select a.proposal_no,NULLIF(a.open_cover_no,'0'),NULLIF(CONVERT(b.policy_start_date,103),' '),NULLIF(CONVERT(b.policy_end_date,103),' '),NULLIF(first_name,NULLIF(company_name,' ')) from open_cover_position_master a, open_cover_master b,personal_info c where a.status='P' and a.proposal_no = b.proposal_no and b.amend_id = (select max(amend_id) from open_cover_master b where b.proposal_no = a.proposal_no) and c.customer_id =b.customer_id order by a.proposal_no
balanceAmount = NULLIF(d.CROSS_VOYAGE_TURNOVER,0)-NULLIF(d.UTILIZED_AMOUNT,0)
getportfolioDetails=SELECT DISTINCT (A.PROPOSAL_NO), NULLIF (A.OPEN_COVER_NO, '0'), NULLIF (CONVERT(date,B.OPEN_COVER_START_DATE,103), ' '), NULLIF (CONVERT(date,B.OPEN_COVER_END_DATE,103), ' '), NULLIF (C.FIRST_NAME, C.COMPANY_NAME), D.CUSTOMER_ID, B.AMEND_ID, D.MISSIPPI_OPENCOVER_NO,A.STATUS, A.ENDT_STATUS, A.ORIGINAL_POLICY_NO, D.debit_note_no, D.credit_note_no, ISNULL(CONVERT(numeric(20,2), CAST(d.CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(d.UTILIZED_AMOUNT AS FLOAT)),0) ,D.TYPE FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_DETAIL B, PERSONAL_INFO C, OPEN_COVER_MASTER D WHERE (A.STATUS = 'P' OR (A.STATUS='Y' AND ORIGINAL_POLICY_NO IS NOT NULL)) AND A.PROPOSAL_NO = B.PROPOSAL_NO AND DATEADD(DAY,30,CONVERT(DATE,A.EXPIRY_DATE,103)) >= CONVERT(DATE,GETDATE(),103) AND B.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND A.PROPOSAL_NO IN (SELECT (PROPOSAL_NO) FROM OPEN_COVER_MASTER WHERE BROKER_ID = D.BROKER_ID) AND D.PROPOSAL_NO = A.PROPOSAL_NO AND C.CUSTOMER_ID = D.CUSTOMER_ID AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND (nullif(A.ADMIN_STATUS,'') IS NULL OR A.ADMIN_STATUS = 'Y') AND D.BROKER_ID=? ORDER BY A.PROPOSAL_NO DESC
getportfolioDetails_NOTEMPTY=SELECT DISTINCT (A.PROPOSAL_NO), NULLIF (A.OPEN_COVER_NO, '0'), NULLIF (CONVERT (date,B.OPEN_COVER_START_DATE, 103), ' '), NULLIF (CONVERT (date,B.OPEN_COVER_END_DATE, 103), ' '), NULLIF (C.FIRST_NAME, C.COMPANY_NAME), D.CUSTOMER_ID, B.AMEND_ID, D.MISSIPPI_OPENCOVER_NO,A.STATUS, A.ENDT_STATUS, A.ORIGINAL_POLICY_NO, D.debit_note_no, D.credit_note_no,ISNULL(CONVERT(numeric(20,2), CAST(d.CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(d.UTILIZED_AMOUNT AS FLOAT)),0) FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_DETAIL B, PERSONAL_INFO C, OPEN_COVER_MASTER D WHERE (A.STATUS = 'P' OR (A.STATUS='Y' AND ORIGINAL_POLICY_NO IS NOT NULL)) AND A.PROPOSAL_NO = B.PROPOSAL_NO AND A.EXPIRY_DATE >= GETDATE() AND B.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND A.PROPOSAL_NO IN (SELECT (PROPOSAL_NO) FROM OPEN_COVER_MASTER WHERE BROKER_ID = D.BROKER_ID) AND D.PROPOSAL_NO = A.PROPOSAL_NO AND C.CUSTOMER_ID = D.CUSTOMER_ID AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND (nullif(A.ADMIN_STATUS,'') IS NULL OR A.ADMIN_STATUS = 'Y') AND A.OPEN_COVER_NO LIKE ? ORDER BY A.PROPOSAL_NO DESC
getportfolioDetails_EMPTY=SELECT DISTINCT (A.PROPOSAL_NO), NULLIF (A.OPEN_COVER_NO, '0'), NULLIF (CONVERT (date,B.OPEN_COVER_START_DATE, 103), ' '), NULLIF (CONVERT(date,B.OPEN_COVER_END_DATE,103 ), ''), NULLIF (C.FIRST_NAME, C.COMPANY_NAME), D.CUSTOMER_ID, B.AMEND_ID, D.MISSIPPI_OPENCOVER_NO,A.STATUS, A.ENDT_STATUS, A.ORIGINAL_POLICY_NO, D.debit_note_no, D.credit_note_no,ISNULL(CONVERT(numeric(20,2), CAST(d.CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(d.UTILIZED_AMOUNT AS FLOAT)),0) FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_DETAIL B, PERSONAL_INFO C, OPEN_COVER_MASTER D WHERE (A.STATUS = 'P' OR (A.STATUS='Y' AND ORIGINAL_POLICY_NO IS NOT NULL)) AND A.PROPOSAL_NO = B.PROPOSAL_NO AND A.EXPIRY_DATE >= GETDATE() AND B.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND A.PROPOSAL_NO IN (SELECT (PROPOSAL_NO) FROM OPEN_COVER_MASTER WHERE BROKER_ID = D.BROKER_ID) AND D.PROPOSAL_NO = A.PROPOSAL_NO AND C.CUSTOMER_ID = D.CUSTOMER_ID AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND (nullif(A.ADMIN_STATUS,'') IS NULL OR A.ADMIN_STATUS = 'Y') AND D.BROKER_ID=? AND (A.OPEN_COVER_NO LIKE ? or A.ORIGINAL_POLICY_NO LIKE ? ) ORDER BY A.PROPOSAL_NO DESC
getQuoteDetails=select distinct(a.proposal_no),NULLIF(a.open_cover_no,''0''),NULLIF(b.policy_start_date,''''),NULLIF(b.policy_end_date,''''),NULLIF(first_name,company_name),RENEWAL_STATUS,b.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_master b,personal_info c where a.status=''Y'' {0} and a.original_policy_no is null and a.proposal_no = b.proposal_no and b.amend_id = (select max(amend_id) from open_cover_master b where b.proposal_no = a.proposal_no) and a.proposal_no in (select proposal_no from open_cover_master where broker_id=?) and c.customer_id =b.customer_id and c.amend_id=(select max(amend_id) from personal_info pi where c.customer_id=pi.customer_id)order by a.proposal_no desc
getQuoteDetails1=select a.proposal_no,NULLIF(b.open_cover_start_date,'' ''),NULLIF(b.open_cover_end_date,'''') from open_cover_position_master a,open_cover_detail b where a.status=''Y'' {0} and a.original_policy_no is null and b.proposal_no=a.proposal_no and b.amend_id=(select max(amend_id) from open_cover_detail where proposal_no=a.proposal_no)
getAdminLapsedPortfolioDetails=select distinct(a.proposal_no),NULLIF(a.open_cover_no,'0'),NULLIF(CONVERT(date,b.open_cover_start_date,103),' '),NULLIF(CONVERT(date,b.open_cover_end_date,103),' '),NULLIF(c.first_name,c.company_name),d.customer_id,b.amend_id,d.MISSIPPI_OPENCOVER_NO,a.admin_status from open_cover_position_master a, open_cover_detail b,personal_info c,open_cover_master d where a.status in('P') and a.proposal_no = b.proposal_no AND ((DATEDIFF (day,DATEADD(month, 1,getDATE ()), d.POLICY_END_DATE )< 15) or a.admin_status='N') and ISNULL(a.renewal_status,'')!='R' and  b.amend_id = (select max(amend_id) from open_cover_detail  where proposal_no = a.proposal_no) and a.proposal_no in (select (proposal_no) from open_cover_master where broker_id=?) and d.proposal_no=a.proposal_no and c.customer_id =d.customer_id and d.amend_id=(select max(amend_id) from open_cover_master where proposal_no=a.proposal_no) And A.amend_id=(Select max(Amend_id) from open_cover_position_master oc WHere ISNULL(A.original_policy_no,A.open_Cover_no)=ISNULL(oc.original_policy_no,oc.open_cover_no) and a.status=oc.status) order by a.proposal_no desc
openCoverActiveDeactive=update open_cover_position_master set expiry_date=(select add_months(sysdate,12)-1 from dual) where Proposal_no= ?
openCoverActiveDeactive1=update OPEN_COVER_DETAIL set OPEN_COVER_END_DATE=(select add_months(sysdate,12)-1 from dual) where Proposal_no= ?
openCoverActiveDeactive2=update open_cover_master set POLICY_END_DATE=(select add_months(sysdate,12)-1 from dual) where Proposal_no=? and AMEND_ID = (select max(amend_id) from OPEN_COVER_MASTER where Proposal_no = ?)
opencoverDeactive=update open_cover_position_master set status='D' where Proposal_no = ?
getExpiredOpenCover=SELECT DISTINCT (A.PROPOSAL_NO), NULLIF (A.OPEN_COVER_NO, '0'), NULLIF (CONVERT(date,B.OPEN_COVER_START_DATE,103), ' '), NULLIF (CONVERT(date,B.OPEN_COVER_END_DATE,103), ' '), NULLIF (C.FIRST_NAME, C.COMPANY_NAME), D.CUSTOMER_ID, B.AMEND_ID, D.MISSIPPI_OPENCOVER_NO,A.STATUS, A.ENDT_STATUS, A.ORIGINAL_POLICY_NO, D.debit_note_no, D.credit_note_no, ISNULL(CONVERT(numeric(20,2), CAST(d.CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(d.UTILIZED_AMOUNT AS FLOAT)),0) ,D.TYPE from open_cover_position_master a, open_cover_detail b,personal_info c,open_cover_master d where a.status in('P') and a.proposal_no = b.proposal_no and (  a.EXPIRY_DATE <= GETDATE()) and ISNULL(a.renewal_status,'')!='R' and  b.amend_id = (select max(amend_id) from open_cover_detail  where proposal_no = a.proposal_no) and a.proposal_no in (select (proposal_no) from open_cover_master where broker_id=?) and d.proposal_no=a.proposal_no and c.customer_id =d.customer_id and d.amend_id=(select max(amend_id) from open_cover_master where proposal_no=a.proposal_no) And A.amend_id=(Select max(Amend_id) from open_cover_position_master oc WHere ISNULL(A.original_policy_no,A.open_Cover_no)=ISNULL(oc.original_policy_no,oc.open_cover_no) and a.status=oc.status) order by a.proposal_no desc
getExpiredOpenCover_NOTEMPTY=SELECT DISTINCT (A.PROPOSAL_NO), NULLIF (A.OPEN_COVER_NO, '0'), NULLIF (CONVERT (date,B.OPEN_COVER_START_DATE, 103), ' '), NULLIF (CONVERT (date,B.OPEN_COVER_END_DATE, 103), ' '), NULLIF (C.FIRST_NAME, C.COMPANY_NAME), D.CUSTOMER_ID, B.AMEND_ID, D.MISSIPPI_OPENCOVER_NO,A.STATUS, A.ENDT_STATUS, A.ORIGINAL_POLICY_NO, D.debit_note_no, D.credit_note_no,ISNULL(CONVERT(numeric(20,2), CAST(d.CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(d.UTILIZED_AMOUNT AS FLOAT)),0) FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_DETAIL B, PERSONAL_INFO C, OPEN_COVER_MASTER D WHERE (A.STATUS = 'P' OR (A.STATUS='Y' AND ORIGINAL_POLICY_NO IS NOT NULL)) AND A.PROPOSAL_NO = B.PROPOSAL_NO AND A.EXPIRY_DATE <= GETDATE() AND B.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND A.PROPOSAL_NO IN (SELECT (PROPOSAL_NO) FROM OPEN_COVER_MASTER WHERE BROKER_ID = D.BROKER_ID) AND D.PROPOSAL_NO = A.PROPOSAL_NO AND C.CUSTOMER_ID = D.CUSTOMER_ID AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND (nullif(A.ADMIN_STATUS,'') IS NULL OR A.ADMIN_STATUS = 'Y') AND A.OPEN_COVER_NO LIKE ? ORDER BY A.PROPOSAL_NO DESC
getExpiredOpenCover_EMPTY=SELECT DISTINCT (A.PROPOSAL_NO), NULLIF (A.OPEN_COVER_NO, '0'), NULLIF (CONVERT (date,B.OPEN_COVER_START_DATE, 103), ' '), NULLIF (CONVERT(date,B.OPEN_COVER_END_DATE,103 ), ''), NULLIF (C.FIRST_NAME, C.COMPANY_NAME), D.CUSTOMER_ID, B.AMEND_ID, D.MISSIPPI_OPENCOVER_NO,A.STATUS, A.ENDT_STATUS, A.ORIGINAL_POLICY_NO, D.debit_note_no, D.credit_note_no,ISNULL(CONVERT(numeric(20,2), CAST(d.CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(d.UTILIZED_AMOUNT AS FLOAT)),0) FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_DETAIL B, PERSONAL_INFO C, OPEN_COVER_MASTER D WHERE (A.STATUS = 'P' OR (A.STATUS='Y' AND ORIGINAL_POLICY_NO IS NOT NULL)) AND A.PROPOSAL_NO = B.PROPOSAL_NO AND A.EXPIRY_DATE <= GETDATE() AND B.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND A.PROPOSAL_NO IN (SELECT (PROPOSAL_NO) FROM OPEN_COVER_MASTER WHERE BROKER_ID = D.BROKER_ID) AND D.PROPOSAL_NO = A.PROPOSAL_NO AND C.CUSTOMER_ID = D.CUSTOMER_ID AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND (nullif(A.ADMIN_STATUS,'') IS NULL OR A.ADMIN_STATUS = 'Y') AND D.BROKER_ID=? AND (A.OPEN_COVER_NO LIKE ? or A.ORIGINAL_POLICY_NO LIKE ? ) ORDER BY A.PROPOSAL_NO DESC

getDeActvatedPortfolioDetails=select distinct(a.proposal_no),NULLIF(a.open_cover_no,'0'),NULLIF(CONVERT(b.open_cover_start_date,103),' '),NULLIF(CONVERT(b.open_cover_end_date,103),' '),NULLIF(c.first_name,c.company_name),d.customer_id,b.amend_id,d.MISSIPPI_OPENCOVER_NO from open_cover_position_master a, open_cover_detail b,personal_info c,open_cover_master d where a.status='D' and a.proposal_no = b.proposal_no and b.amend_id = (select max(amend_id) from open_cover_detail  where proposal_no = a.proposal_no) and a.proposal_no in (select (proposal_no) from open_cover_master where broker_id=?) and d.proposal_no=a.proposal_no and c.customer_id =d.customer_id and d.amend_id=(select max(amend_id) from open_cover_master where proposal_no=a.proposal_no) order by a.proposal_no desc
openCoverDeactivate=update OPEN_COVER_POSITION_MASTER set admin_status='N' where PROPOSAL_NO=?
openCoverDeactivate1=select status from open_cover_position_master where PROPOSAL_NO=?
openCoverDeactivate2=Select original_policy_no,amend_id-1  from OPEN_COVER_POSITION_MASTER where proposal_no=?
openCoverDeactivate3=update OPEN_COVER_POSITION_MASTER set endt_status='' where  OPEN_COVER_NO=? and amend_id=?
openCoverDeactivate4=update OPEN_COVER_POSITION_MASTER set endt_status='' where  original_policy_no=? and amend_id=?
openCoverActivate=update OPEN_COVER_POSITION_MASTER set admin_status\='Y' where PROPOSAL_NO\=?
getBrokers=select a.company_name,b.login_id,a.agency_code from broker_company_master a,login_master b where b.agency_code=a.agency_code order by a.company_name
getBrokersQuoteRegister=select distinct a.company_name,b.login_id from broker_company_master a,login_master b,open_cover_master c where b.agency_code=a.agency_code and c.broker_id=b.login_id and c.proposal_no in (select proposal_no from open_cover_position_master where open_cover_no is  null and status='Y') order by a.company_name
getBrokersHasCover=select distinct a.company_name,b.login_id from broker_company_master a,login_master b,open_cover_master c where b.agency_code=a.agency_code and c.broker_id=b.login_id and c.proposal_no in (select proposal_no from open_cover_position_master where open_cover_no is not null and status='P') order by a.company_name
getCountrys=select cm.COUNTRY_ID,cm.COUNTRY_NAME,cm.sno__,cm.amend_id from COUNTRY_MASTER cm where cm.status in ('Y','R') and cm.amend_id+cm.COUNTRY_ID in (select  max(amend_id)+COUNTRY_ID from COUNTRY_MASTER where  effective_date<=getDATe() and status in('Y','R')  group by COUNTRY_ID) and cm.effective_date<=getDATe()  group by cm.COUNTRY_ID,cm.COUNTRY_NAME,cm.amend_id,cm.sno__ order by cm.COUNTRY_NAME
getContientList=select * from constant_detail where CATEGORY_ID=? AND BRANCH_CODE=? AND STATUS=?
getTransports=select distinct TRANSPORT_DESCRIPTION ,MODE_TRANSPORT_ID from MODE_OF_TRANSPORT
getOPCRAI=select NULLIF(COUNTRY_REMARKS,''),ADDITIONAL_INSURED,ADDITIONAL_INSURED_NAME,DEPOSIT_PREMIUM_YN,DEPOSIT_TYPE,INSTALLMENT_TYPE,DEBIT_NOTE_NO,CREDIT_NOTE_NO,Deposit_Amount,WAR_PREMIUM,CONVERT(VARCHAR(10),DEBIT_NOTE_DATE,103) ,CONVERT(date,getdate(),103),remarks from open_cover_master where proposal_no=? and amend_id=(select max(amend_id)  from open_cover_master where proposal_no=? )
getDELOC=delete from open_cover_master where proposal_no=? and product_id=?
GETMAXOCAMD=select ISNULL(max(amend_id)+1,'0') from open_cover_master where proposal_no=?
##=insert into open_cover_master(proposal_no,amend_id,product_id,broker_id,broker_user_id,customer_id,branch_code,cross_voyage,cross_voyage_turnover,cross_voyage_suminsured_limit,back_date_days,commission,free_text_allowed,no_of_insurance_company,status,cross_voyage_percentage,effective_date,rsa_shared_percentage,type,min_premium,missippi_opencover_no,business_type,MISSISSIPI_OPEN_POLICY_ID,IMPORT_MIN_PREMIUM_AMOUNT,EXPORT_MIN_PREMIUM_AMOUNT,WRSC_YN,CROSS_MIN_PREMIUM_AMOUNT,POLICY_START_DATE,POLICY_END_DATE,COUNTRY_REMARKS,CURRENCY_ID,EXCHANGE_RATE,ISSUANCE_FEE,MIN_PREMIUM_ISSUANCE_FEE,FOREIGN_TURNOVER,MIN_PRE_MUL_TYPE,MIN_PRE_MUL,ADDITIONAL_INSURED,ADDITIONAL_INSURED_NAME,LOSS_DETAIL,CLAIM_RATIO,ADDITIONAL_INFO,PROPOSAL_STATUS,CONFIRM_STATUS,login_id,CLAUSES_YN,EXECUTIVE_ID,DEBIT_NOTE,UTILIZED_AMOUNT,DECLARATIONTYPE,NO_OF_VEHICLES,HAULIER_PREMIUM,DEBIT_TO_ID,CREDIT_TO_ID)values(?,?,?,?,?,CONVERT(decimal(20,2), CAST(? AS FLOAT)),?,?,?,?,?,?,?,?,?,CONVERT(decimal(20,2), CAST(? AS FLOAT)),getdate(),?,?,?,?,?,?,?,?,?,?,CONVERT(date,?,103),CONVERT(date,?,103),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
INSTOCM=insert into open_cover_master(proposal_no,amend_id,product_id,broker_id,broker_user_id,customer_id,branch_code,cross_voyage,cross_voyage_turnover,cross_voyage_suminsured_limit,back_date_days,commission,free_text_allowed,no_of_insurance_company,status,cross_voyage_percentage,effective_date,rsa_shared_percentage,type,min_premium,missippi_opencover_no,business_type,MISSISSIPI_OPEN_POLICY_ID,IMPORT_MIN_PREMIUM_AMOUNT,EXPORT_MIN_PREMIUM_AMOUNT,WRSC_YN,CROSS_MIN_PREMIUM_AMOUNT,POLICY_START_DATE,POLICY_END_DATE,COUNTRY_REMARKS,CURRENCY_ID,EXCHANGE_RATE,ISSUANCE_FEE,MIN_PREMIUM_ISSUANCE_FEE,FOREIGN_TURNOVER,MIN_PRE_MUL_TYPE,MIN_PRE_MUL,ADDITIONAL_INSURED,ADDITIONAL_INSURED_NAME,LOSS_DETAIL,CLAIM_RATIO,ADDITIONAL_INFO,PROPOSAL_STATUS,CONFIRM_STATUS,login_id,CLAUSES_YN,EXECUTIVE_ID,DEBIT_NOTE,UTILIZED_AMOUNT,DECLARATIONTYPE,NO_OF_VEHICLES,HAULIER_PREMIUM,DEBIT_TO_ID,CREDIT_TO_ID,HAULIER_TYPE,DEPOSIT_PREMIUM_YN,DEPOSIT_TYPE,INSTALLMENT_TYPE,DEBIT_NOTE_NO,CREDIT_NOTE_NO,Deposit_Amount,WAR_PREMIUM,endorsementFee,Remarks,VAT_TAX_PERCENT,WAR_SHOW_YN)values(?,?,?,?,?,?,?,?,CONVERT(decimal(20,2), CAST(? AS FLOAT)),?,?,?,?,?,?,?,getdate(),?,?,?,?,?,?,?,?,?,?,CONVERT(date,?,103),CONVERT(date,?,103),?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,CONVERT(decimal(20,2), CAST(? AS FLOAT)),CONVERT(decimal(20,2), CAST(? AS FLOAT)),?,?,?,?)
UPDGUEST=UPDATE OPEN_COVER_MASTER SET GUEST_LOGIN_STATUS=? WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
UPDOCDETAIL=UPDATE OPEN_COVER_DETAIL SET OPEN_COVER_START_DATE=CONVERT(date,?,103), OPEN_COVER_END_DATE=CONVERT(date,?,103) WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO=?)
checkmisscodeProce=call VALIDATE_CIMS_POLICY(?,?)
getCOUNTOCP=select count(*) from open_cover_position_master where proposal_no=?
INSTOCP=insert into open_cover_position_master(proposal_no,amend_id,status,ckey,INCEPTION_DATE,EXPIRY_DATE,CERT_NO,approve_status)values(?,?,?,?,CONVERT(date,?,103),CONVERT(date,?,103),?,?)
UPDTOCP=UPDATE OPEN_COVER_POSITION_MASTER SET INCEPTION_DATE=CONVERT(date,?,103), EXPIRY_DATE=CONVERT(date,?,103),CKEY=?,CERT_NO=?,approve_status=? WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER WHERE PROPOSAL_NO=?)
UPDTOCPM=UPDATE OPEN_COVER_POSITION_MASTER SET INCEPTION_DATE=CONVERT(date,?,103), EXPIRY_DATE=CONVERT(date,?,103),CERT_NO=? WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER WHERE PROPOSAL_NO=?)
##SELCTOCPD=select a.broker_id,NULLIF(b.first_name,b.company_name),a.type,a.customer_id,a.back_date_days,a.FOREIGN_TURNOVER,a.RSA_SHARED_PERCENTAGE,a.NO_OF_INSURANCE_COMPANY,a.cross_voyage,a.cross_voyage_percentage,a.free_text_allowed,a.commission,NULLIF(min_premium,'0'),NULLIF(missippi_opencover_no,''),NULLIF(business_type,'0'),NULLIF(MISSISSIPI_OPEN_POLICY_ID,''),NULLIF(IMPORT_MIN_PREMIUM_AMOUNT,'0'),NULLIF(EXPORT_MIN_PREMIUM_AMOUNT,'0'),NULLIF(Pro_commission,'0'),(pro_start_date),(pro_expiry_date),NULLIF(WRSC_YN,'N'),a.BROKER_USER_ID,NULLIF(a.CROSS_MIN_PREMIUM_AMOUNT,0),DATEPART(day,POLICY_START_DATE) AS DAYS,DATEPART(month,POLICY_START_DATE) AS MONTHS,DATEPART(year,POLICY_START_DATE) AS YEARS,DATEPART(day,POLICY_END_DATE) AS DAYS,DATEPART(month,POLICY_END_DATE) AS DAYS,DATEPART(year,POLICY_END_DATE) AS YEARS,CURRENCY_ID,EXCHANGE_RATE,ISSUANCE_FEE,MIN_PREMIUM_ISSUANCE_FEE,MIN_PRE_MUL_TYPE,MIN_PRE_MUL,C.RENEWAL_STATUS,C.ENDT_STATUS,A.LOSS_DETAIL,A.CLAIM_RATIO,A.ADDITIONAL_INFO,A.GUEST_LOGIN_STATUS,A.EXECUTIVE_ID,A.DEBIT_NOTE,A.UTILIZED_AMOUNT,A.DECLARATIONTYPE,A.NO_OF_VEHICLES,A.HAULIER_PREMIUM,C.CERT_NO from open_cover_master a ,personal_info b,OPEN_COVER_POSITION_MASTER C where a.proposal_no=? and a.amend_id=(select max(a.amend_id) from open_cover_master a where a.proposal_no=?) and b.customer_id=a.customer_id AND C.PROPOSAL_NO=A.PROPOSAL_NO
SELCTOCPD = SELECT a.broker_id, NULLIF (b.first_name, b.company_name), a.TYPE, a.customer_id, a.back_date_days, convert(decimal(20,2),a.FOREIGN_TURNOVER)FOREIGN_TURNOVER, convert(decimal(10,2),a.RSA_SHARED_PERCENTAGE)RSA_SHARED_PERCENTAGE, a.NO_OF_INSURANCE_COMPANY, a.cross_voyage, a.cross_voyage_percentage, a.free_text_allowed, convert(decimal(10,2),a.commission)commission, NULLIF (convert(decimal(10,2),min_premium), '0')min_premium, NULLIF (missippi_opencover_no, '')missippi_opencover_no, NULLIF (convert(int,business_type), '0')business_type, NULLIF (MISSISSIPI_OPEN_POLICY_ID, '')MISSISSIPI_OPEN_POLICY_ID, NULLIF (IMPORT_MIN_PREMIUM_AMOUNT, '0')IMPORT_MIN_PREMIUM_AMOUNT, NULLIF (EXPORT_MIN_PREMIUM_AMOUNT, '0')EXPORT_MIN_PREMIUM_AMOUNT, NULLIF (Pro_commission, '0')Pro_commission, (pro_start_date), (pro_expiry_date), NULLIF (WRSC_YN, 'N')WRSC_YN, a.BROKER_USER_ID, NULLIF (a.CROSS_MIN_PREMIUM_AMOUNT, 0)CROSS_MIN_PREMIUM_AMOUNT, DATEPART (day, POLICY_START_DATE) AS DAYS, DATEPART (month, POLICY_START_DATE) AS MONTHS, DATEPART (year, POLICY_START_DATE) AS YEARS, DATEPART (day, POLICY_END_DATE) AS DAYS, DATEPART (month, POLICY_END_DATE) AS DAYS, DATEPART (year, POLICY_END_DATE) AS YEARS, CURRENCY_ID, convert(decimal(10,4),EXCHANGE_RATE)EXCHANGE_RATE, convert(decimal(10,2),ISSUANCE_FEE)ISSUANCE_FEE, convert(decimal(10,2),MIN_PREMIUM_ISSUANCE_FEE)MIN_PREMIUM_ISSUANCE_FEE, MIN_PRE_MUL_TYPE, convert(decimal(10,2),MIN_PRE_MUL)MIN_PRE_MUL, C.RENEWAL_STATUS, C.ENDT_STATUS, A.LOSS_DETAIL, A.CLAIM_RATIO, A.ADDITIONAL_INFO, A.GUEST_LOGIN_STATUS, A.EXECUTIVE_ID, A.DEBIT_NOTE, A.UTILIZED_AMOUNT, A.DECLARATIONTYPE, A.NO_OF_VEHICLES, A.HAULIER_PREMIUM, C.CERT_NO,a.ENDORSEMENTFEE,A.HAULIER_TYPE,A.VAT_TAX_PERCENT,A.WAR_SHOW_YN FROM open_cover_master a, personal_info b, OPEN_COVER_POSITION_MASTER C WHERE a.proposal_no \= ? AND a.amend_id \= (SELECT MAX (a.amend_id) FROM open_cover_master a WHERE a.proposal_no \= ?) AND b.customer_id \= a.customer_id AND C.PROPOSAL_NO \= A.PROPOSAL_NO 
CHCKMISPICODE=select count(*) from open_cover_master where missippi_opencover_no in (''{0}'') and proposal_no not in (''{1}'')
PROPSEQ=SELECT NEXT VALUE FOR PROPOSAL_NO
getLCs=select OPEN_COVER_NO,BANK_ID,LC_NUMBER,LC_DATE,LC_AMOUNT,ENTRY_DATE,EXPIRY_DATE,EFFECTIVE_DATE,AMEND_ID,REMARKS,STATUS,LC_ID,LC_CURRENCY_ID from OPEN_COVER_LC_MASTER  where  OPEN_COVER_NO=? and status='Y' and LC_NUMBER not in ('None','NONE')
getBname=select bank_name from open_cover_bank_master where bank_id=? and status='Y' and BELONGING_COUNTRY_ID=?
getLcDetails=select OPEN_COVER_NO,BANK_ID,LC_NUMBER,DATEPART(day,LC_DATE) DAY,DATEPART(month,LC_DATE) MONTH,DATEPART(year,LC_DATE) YEAR,LC_CURRENCY_ID,LC_AMOUNT,ENTRY_DATE,EXPIRY_DATE,EFFECTIVE_DATE,AMEND_ID,REMARKS,STATUS,LC_ID,DATEPART(day,EXPIRY_DATE) DAY,datePart(month,EXPIRY_DATE) MONTH,DATEPART(YEAR,EXPIRY_DATE) from OPEN_COVER_LC_MASTER  where  OPEN_COVER_NO=? and  LC_ID=?
getCName=select currency_name from currency_master where currency_id=? and status='Y' and amend_id=(select max(amend_id) from currency_master where currency_id=? and COUNTRY_ID=? and status='Y')
getsLCDetailsByOpenCover=select  OPEN_COVER_NO,BANK_ID,LC_NUMBER,LC_DATE,LC_AMOUNT,ENTRY_DATE,EXPIRY_DATE,EFFECTIVE_DATE,AMEND_ID,REMARKS,STATUS,LC_ID from open_cover_lc_master where lc_id=? and open_Cover_no=?
getCertificates=select a.open_cover_no,a.policy_no,b.total_sum_insured,b.exchange_rate,b.total_sum_insured*b.exchange_rate suminsured,b.open_lc_id,a.login_id,c.lc_number,c.LC_AMOUNT from position_master a,marine_Data b,open_Cover_lc_master c where a.application_no=b.application_no and b.open_lc_id=c.lc_id and a.open_cover_no=c.open_cover_no and a.open_cover_no=? and c.lc_number=? and  a.status='P'
GET_BROKER_CMPY=SELECT BCM.COMPANY_NAME,PI.LOGIN_ID FROM BROKER_COMPANY_MASTER BCM,PERSONAL_INFO PI,LOGIN_MASTER LM,LOGIN_USER_DETAILS LUD WHERE BCM.AGENCY_CODE=PI.AGENCY_CODE AND BCM.STATUS='Y' AND PI.STATUS=BCM.STATUS AND PI.APPLICATION_ID = '2' AND PI.LOGIN_ID=LM.LOGIN_ID AND LM.STATUS!='N' AND LM.OA_CODE=LUD.OA_CODE AND LUD.PRODUCT_ID='11' AND LUD.AGENCY_CODE=BCM.AGENCY_CODE AND BCM.BRANCH_CODE=?
GET_DIR_LOGIN=select remarks from constant_detail where category_id='129' and branch_code=?
GETEXECUTEVLIST=SELECT AC_EXECUTIVE_ID, AC_EXECUTIVE_NAME FROM LOGIN_EXECUTIVE_DETAILS WHERE STATUS='Y' ORDER BY AC_EXECUTIVE_NAME
getBrokersQuoteRegister_C=select bcm.company_name,pi.login_id from BROKER_COMPANY_MASTER bcm,personal_info pi where bcm.agency_code=pi.agency_code  and bcm.status=''Y'' and pi.status=bcm.status and pi.APPLICATION_ID=''2'' and pi.login_id in(select distinct ocm.broker_id from OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm where ocm.broker_id in(select login_id from login_master where status!='''N'' and oa_code in(select agency_code from broker_company_master where branch_code in('{0}'))) and ocpm.STATUS=''Y'' and ocm.PROPOSAL_NO=ocpm.PROPOSAL_NO) order by lower(bcm.COMPANY_NAME)
getBrokersHasCover_C=select  bcm.company_name as USERNAME,pi.login_id  as LOGIN_ID from BROKER_COMPANY_MASTER bcm,personal_info pi where bcm.agency_code=pi.agency_code  and bcm.status=''Y'' and pi.status=bcm.status and pi.APPLICATION_ID=''2'' and pi.login_id in(select distinct ocm.broker_id from OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm where ocm.broker_id in(select login_id from login_master where status!=''N'' and oa_code in(select agency_code from broker_company_master where branch_code in({0}))) and ocpm.STATUS in(''P'',''D'') and ocm.PROPOSAL_NO=ocpm.PROPOSAL_NO) order by lower(bcm.COMPANY_NAME)
getDeactivateOpencCoverBrokersHasCover=select  bcm.company_name,pi.login_id from BROKER_COMPANY_MASTER bcm,personal_info pi where bcm.agency_code=pi.agency_code  and bcm.status=''Y'' and pi.status=bcm.status and pi.APPLICATION_ID=''2'' and pi.login_id in(select distinct ocm.broker_id from OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm where ocm.broker_id in(select login_id from login_master where status!=''N'' and oa_code in(select agency_code from broker_company_master where branch_code in({0}))) and ocpm.STATUS in(''D'',''P'') and ocm.PROPOSAL_NO=ocpm.PROPOSAL_NO) order by lower(bcm.COMPANY_NAME)
GET_CURRECY=SELECT CURRENCY_ABBREVIATION,DECIMAL_PLACES from BRANCH_MASTER where BRANCH_CODE=?
GET_SALTERM=select sale_term_id,sale_term_name from sale_term_master where branch_code=? and status=? order by sale_term_name
GET_STM=select sale_term_id,sale_term_name from sale_term_master where branch_code=? and status=? and sale_term_id in ({0}) and sale_term_id not in (205) order by sale_term_name
GET_ANAUNAL=SELECT ISNULL(A.CROSS_VOYAGE_TURNOVER,0) FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
GETOCPMCOUNT=SELECT COUNT(*) FROM OPEN_COVER_POSITION_MASTER WHERE PROPOSAL_NO!=? AND CKEY=?
GETOCTYPELIST=Select Product_id,Product_name from open_cover_product_Details Where  status='Y' and  Branch_code=? order by product_id asc
GETOCTYPPLEIST=SELECT CATEGORY_DETAIL_ID, DETAIL_NAME FROM CONSTANT_DETAIL Where Branch_code=? and CATEGORY_ID = 163  Order by CONVERT(INT,(CATEGORY_DETAIL_ID)) Asc
GETMISISPICID=select MISSIPPI_CUSTOMER_CODE from personal_info where customer_id=?
GETBCMAGECY=SELECT RSA_BROKER_CODE FROM BROKER_COMPANY_MASTER WHERE AGENCY_CODE=(SELECT AGENCY_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?)
GETLEXDET=SELECT RSACODE FROM LOGIN_EXECUTIVE_DETAILS WHERE AC_EXECUTIVE_ID=?
GETCONTDETYT=Select  case Count(*) when 0 then 'N' else 'Y' end direct_status from constant_detail cd Where cd.branch_code \= ? and  Cd.remarks \=?
getLoginExecutiveDetails=select AC_EXECUTIVE_ID, AC_EXECUTIVE_NAME from login_executive_details where status='Y' and (oa_code=(select agency_code from login_master where login_id=?) or oa_code=(select oa_code from login_master where login_id=?))
getCurrencyCoverInfo=select em.exchange_id,em.currency_id,cm.currency_name from exchange_master em,currency_master cm where em.currency_id=cm.currency_id and em.status=cm.status and em.status='Y' and cm.status='Y' and em.currency_id=? and em.amend_id=(select max(amend_id) from exchange_master where currency_id=? and status='Y')
getCurrencyCoverInfo1=select cm.cover_id,cm.cover_name,cm.mode_transport_id from cover_master cm where cm.mode_transport_id=? and cm.cover_id=? and  cm.status='Y'
getCurrencyCoverInfo2=select * from login_executive_details where ac_executive_id=? and Status='Y'
getCountryCityInfo=select ct.country_id,ct.city_id,ct.city_name,cm.country_name from city_master ct,country_master cm where lower(ct.city_name)=? and ct.country_id=cm.country_id
getCountryCityInfo1=select ct.country_id,ct.city_id as cityId,ct.city_name,cm.country_name from city_master ct,country_master cm where lower(ct.city_name)=lower(''{0}'') and cm.country_id=''{1}'' and ct.country_id=cm.country_id
getLCNumbers=select bank_id,lc_id,lc_number from open_cover_lc_master where status='Y' and open_cover_no=? order by lc_id
getBankNames=select bank_id,bank_name,amend_id from open_cover_bank_master where amend_id||'-'||bank_id in (select max(amend_id)||'-'||bank_id from open_cover_bank_master where to_date(effective_date,'dd-mm-yyyy')<=to_date(SYSDATE,'dd-mm-yyyy') and status in('N','Y') and BELONGING_COUNTRY_ID=? and bank_id in(select bank_id from OPEN_COVER_LC_MASTER where open_cover_no =?) group by bank_id) and status='Y' and BELONGING_COUNTRY_ID=? order by bank_name
getSaleTermValue=select sale_term_value from sale_term_master where sale_term_id=? and branch_code=? and status='Y'
getToleranceValue=select TOLERANCE_VALUE from TOLERANCE_MASTER where TOLERANCE_ID=? and branch_code=? and status='Y'
getModeMaster=select mode_transport_ID, transport_description from mode_of_transport where status='Y' and BRANCH_CODE=? order by DISPLAY_ORDER
getCoverMaster=select mode_transport_ID,cover_id,cover_name from cover_master cm where status='Y' and BRANCH_CODE=? And Amend_id=(select max(amend_id) from cover_master C where C.cover_id=cm.cover_id and C.branch_code=cm.branch_code) order by DISPLAY_ORDER
getCommodity=select commodity_id,commodity_name from commoditymaster cm where cm.status in ('Y','R') and BRANCH_CODE=? and cm.amend_id+'-'+cm.commodity_id in(select max(amend_id)+'-'+commodity_id from commoditymaster where effective_date <=getDAte() and BRANCH_CODE=? group by commodity_id) order by cm.commodity_name
getExtraCover=select category_detail_id,detail_name from constant_detail where category_id=2 and status='Y' and branch_code=?
getExistingMode=select a.mode_transport_id,a.cover_id,a.sea_options,DATEPART(day,a.effective_date) as days,DATEPART(month,a.effective_date) as months,DATEPART(year,a.effective_date) as years,NULLIF(cast(b.SUM_INSURED_LIMIT as decimal(20,2))  ,'0') as SUM_INSURED_LIMIT,B.CURRENCY_ID,B.EXCHANGE_RATE,A.COVER_TYPE_ID,cast(location_limit as decimal(20,2)) as location_limit   from open_cover_sub_detail a,open_cover_detail b where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and b.proposal_no=a.proposal_no and  b.amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?) and b.mode_transport_id=a.mode_transport_id
getExistingCountry=select DATEPART(day,open_cover_start_date) as days,DATEPART(month,open_cover_start_date) as months,DATEPART(year,open_cover_start_date) as years,DATEPART(day,open_cover_end_date) as days,DATEPART(month,open_cover_end_date) as days,DATEPART(year,open_cover_end_date) as years,DATEPART(day,effective_date) as days,DATEPART(month,effective_date) as months,DATEPART(year,effective_date) as years from open_cover_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?)
getExistingCountry1=select NULLIF(open_cover_country_id_org,'0'),NULLIF(open_cover_country_id_dest,'0') from open_cover_country_master  where proposal_no=? and amend_id=(select max(amend_id) from open_cover_country_master where proposal_no=?)
getExistingCountry2=select cm.country_id,cm.country_name from country_master cm where cm.country_id in({0}) and  cm.amend_id+cm.COUNTRY_ID in (select  max(amend_id)+COUNTRY_ID from COUNTRY_MASTER where  effective_date<=getDate() and status in(''Y'','''R'')  group by COUNTRY_ID) order by country_id
getExistingCountry3=select SALE_TERM_ID,TOLERANCE_ID,TOLERANCE_NAME from open_cover_sale_term_master where proposal_no=? and PROPOSAL_NO+amend_id in(select PROPOSAL_NO+max(amend_id) from open_cover_sale_term_master where PROPOSAL_NO=? group by PROPOSAL_NO)
getExistingCountry4=select stm.sale_term_id,stm.sale_term_name from sale_term_master stm where stm.sale_term_id in({0}) and stm.status=? and stm.branch_code=?
getExistingCountry5=select NULLIF(COUNTRY_REMARKS,'') from open_cover_master where proposal_no=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=? )
getExistingCountry6=SELECT DATEPART(day,POLICY_START_DATE) AS DAYS,DATEPART(month,POLICY_START_DATE) AS MONTHS,DATEPART(year,POLICY_START_DATE) AS YEARS,DATEPART(day,POLICY_START_DATE) AS DAYS,DATEPART(month,POLICY_START_DATE) AS MONTHS,DATEPART(year,POLICY_START_DATE) AS YEARS FROM OPEN_COVER_MASTER A WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
getExistingCountry7=select a.commodity_id,NULLIF(a.commodity_name_desc,' '),a.fragile,b.commodity_name, a.commodity_type_id from open_cover_commodity_master a,commoditymaster b where a.proposal_no=? and b.BRANCH_CODE=? and a.amend_id=(select max(amend_id) from open_cover_commodity_master where proposal_no=?) and b.commodity_id=a.commodity_id and b.amend_id=(select max(amend_id) from commoditymaster where commodity_id=a.commodity_id and BRANCH_CODE=?) order by commodity_id
storeValue1=SELECT DATEPART(day,POLICY_START_DATE) AS DAYS,DATEPART(month,POLICY_START_DATE) AS MONTHS,DATEPART(year,POLICY_START_DATE) AS YEARS,DATEPART(day,POLICY_END_DATE) AS DAYS,DATEPART(month,POLICY_END_DATE) AS DAYS,DATEPART(year,POLICY_END_DATE) AS YEARS FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
storeValue2=update open_cover_master set policy_start_date=?,policy_end_date=?,wrsc_YN=?,COUNTRY_REMARKS=?,ADDITIONAL_INSURED=?,ADDITIONAL_INSURED_NAME=?,PROPOSAL_STATUS=? where proposal_no=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
storeValue3=delete from open_cover_detail where proposal_no=?
storeValue4=delete from open_cover_sub_detail where proposal_no=?
storeValue5=delete from open_cover_commodity_master where proposal_no=?
storeValue6=insert into open_cover_detail(open_cover_detail_id,proposal_no,amend_id,mode_transport_id,sum_insured_limit,exchange_id,currency_id,exchange_rate,currency_name,status,effective_date,open_cover_start_date,open_cover_end_date,CONVEYANCE,location_limit)values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
storeValue7=select ISNULL(max(open_cover_detail_id)+1,'1') from open_cover_detail
storeValue8=select ISNULL(max(open_cover_sub_detail_id)+1,'1') from open_cover_sub_detail
storeValue9=update open_cover_position_master set inception_date=(select distinct(open_cover_start_date) from open_cover_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?)),expiry_date=(select distinct(open_cover_end_date) from open_cover_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?)) where proposal_no=?
storeValue10=insert into open_cover_sub_detail(open_cover_sub_detail_id,proposal_no,amend_id,mode_transport_id,cover_id,sea_options,status,effective_date,COVER_TYPE_ID)values(?,?,{0},?,?,?,?,?,?)
storeValue11=select war_rate from open_cover_country_master where proposal_no={0} and amend_id=(select max(amend_id) from open_cover_country_master where proposal_no={1})
storeValue12=insert into open_cover_country_master (open_cover_country_id,proposal_no,amend_id,open_cover_country_id_org,open_cover_country_id_dest,effective_date,status,war_rate)values((select ISNULL(max(open_cover_country_id)+1,'1') from open_cover_country_master),?,0,?,?,?,?,?)
deleteStoreValue12=delete from open_cover_country_master where proposal_no=?
storeValue13=insert into OPEN_COVER_SALE_TERM_MASTER (PROPOSAL_NO,SALE_TERM_ID,AMEND_ID,STATUS,EFFECTIVE_DATE,TOLERANCE_ID,TOLERANCE_NAME) values(?,?,0,?,?,?,?)
delecteStoreValue13=delete from OPEN_COVER_SALE_TERM_MASTER where proposal_no=?
storeValue14=insert into open_cover_commodity_master(proposal_no,amend_id,commodity_id,commodity_name_desc,fragile,effective_date,status,commodity_type_id)values(?,{0},?,?,?,?,?,?)
deleteStoreValue14=delete from open_cover_commodity_master where proposal_no=?
getCommodityTypeId=select CATEGORY_DETAIL_ID,DETAIL_NAME from CONSTANT_DETAIL where CATEGORY_ID=42 and STATUS='Y' and branch_code=?
getWSRCOpt=select ISNULL(nullif(wrsc_YN,''),'N') from OPEN_COVER_MASTER where PROPOSAL_NO=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
getDefaultClauses=select ISNULL(CLAUSES_YN,'N') from OPEN_COVER_MASTER where PROPOSAL_NO=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
getFreeTextStatus=select ISNULL(FREE_TEXT_ALLOWED,'N') from OPEN_COVER_MASTER where PROPOSAL_NO=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
getValueBasis=SELECT CODEDESC FROM OPENCOVERSCHEDULE('basisofvaluation',?,?)
getOpenCoverDate=SELECT DATEPART(day,POLICY_START_DATE) AS DAYS,DATEPART(month,POLICY_START_DATE) AS MONTHS,DATEPART(year,POLICY_START_DATE) AS YEARS,DATEPART(day,POLICY_END_DATE) AS DAYS,DATEPART(month,POLICY_END_DATE) AS DAYS,DATEPART(year,POLICY_END_DATE) AS YEARS FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
getAdditionalInsuredInfo=SELECT BROKER_ID,ADDITIONAL_INSURED,ADDITIONAL_INSURED_NAME,CUSTOMER_ID FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
getConveyance=SELECT A.MODE_TRANSPORT_ID,A.CONVEYANCE FROM OPEN_COVER_DETAIL A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO=A.PROPOSAL_NO)
getEndtTypeInfo=SELECT ORIGINAL_POLICY_NO, ENDT_TYPE FROM OPEN_COVER_POSITION_MASTER WHERE PROPOSAL_NO=?
updateEndtType=UPDATE OPEN_COVER_POSITION_MASTER SET ENDT_TYPE=? WHERE PROPOSAL_NO=?
getProposalStatus=SELECT NULLIF(PROPOSAL_STATUS,'Normal'),NULLIF(CONFIRM_STATUS,'NO') FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
updateApprovedStatus=update open_cover_master set PROPOSAL_STATUS=? where proposal_no=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
updateConfirmStatus=update open_cover_master set CONFIRM_STATUS=? where proposal_no=? and amend_id=(select max(amend_id) from open_cover_master where proposal_no=?)
getSelCommodityTypeId=SELECT COMMODITY_ID,COMMODITY_NAME_DESC,FRAGILE,COMMODITY_TYPE_ID ,'OP' FROM OPEN_COVER_COMMODITY_MASTER OCCM WHERE  PROPOSAL_NO=? and OCCM.Amend_id=(select max(amend_id) from OPEN_COVER_COMMODITY_MASTER OC where  occm.proposal_no=oc.proposal_no) and   COMMODITY_ID IN (SELECT COMMODITY_ID FROM COMMODITYMASTER  cm where cm.amend_id=(Select max(amend_id) from commoditymaster c where c.commodity_id=cm.commodity_id and status='Y')) union all SELECT COMMODITY_ID,COMMODITY_NAME,FRAGILE,COMMODITY_TYPE_ID,'COM' FROM commoditymaster CM where status='Y'and COMMODITY_ID not in (SELECT COMMODITY_ID FROM OPEN_COVER_COMMODITY_MASTER OCCM where PROPOSAL_NO=? and OCCM.Amend_id=(select max(amend_id) from OPEN_COVER_COMMODITY_MASTER OC where occm.proposal_no=oc.proposal_no)) and cm.amend_id=(Select max(amend_id) from  commoditymaster c where c.commodity_id=cm.commodity_id and status='Y')
saveCommodity=insert into open_cover_commodity_master(proposal_no,amend_id,commodity_id,commodity_name_desc,fragile,effective_date,status,commodity_type_id)values(?,(select NULLIF(max(amend_id)+1,'0') from open_cover_commodity_master where proposal_no=''{0}''),?,?,?,?,?,?)
clauesINsert=CLAUSES_INSERT
getSharedLevel1=select a.no_of_insurance_company,a.rsa_shared_percentage,b.insurance_company_id,b.insurance_company_name from open_cover_master a,open_cover_insurance b where a.proposal_no=? and a.status='Y' and a.product_id=? and a.amend_id=(select max(amend_id) from open_cover_master where proposal_no=?) AND b.amend_id = (SELECT MAX(amend_id) FROM open_cover_insurance c WHERE c.INSURANCE_COMPANY_ID = b.INSURANCE_COMPANY_ID) AND b.status = 'Y' and b.INSURANCE_COMPANY_ID!='27' order by b.INSURANCE_COMPANY_ID
getSharedLevel2=select open_cover_country_id_org ,ISNULL(open_cover_wsrcc_org,'0'),ISNULL(open_cover_warehouse_org,'0'),open_cover_country_id_dest,ISNULL(open_cover_wsrcc_dest,'0'),ISNULL(open_cover_warehouse_dest,'0'),ISNULL(war_rate,'0') from open_cover_country_master where proposal_no=? and amend_id=(select max(amend_id) from open_cover_country_master where proposal_no=?)
getSharedLevel3=select a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name,A.COVER_TYPE_ID from open_cover_sub_detail a,mode_of_transport b,cover_master c where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and a.status='Y' and b.BRANCH_CODE = c.BRANCH_CODE and c.BRANCH_CODE=? and c.cover_id=a.cover_id and b.mode_transport_id=a.mode_transport_id group by a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name,A.COVER_TYPE_ID order by a.mode_transport_id ,a.cover_id
getSharedLevel4=select a.commodity_id,a.commodity_name_desc,b.commodity_name,b.COMMODITY_RATE from open_cover_commodity_master a,commoditymaster b where a.proposal_no=? and b.BRANCH_CODE=? and a.amend_id=(select max(amend_id) from open_cover_commodity_master where proposal_no=?) and a.status='Y' and b.commodity_id=a.commodity_id and  b.commodity_id=a.commodity_id and b.amend_id=(select max(amend_id) from commoditymaster where commodity_id=a.commodity_id and BRANCH_CODE=?)
getSharedLevel5=SELECT COMMODITY_ID FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO=?) AND STATUS ='Y'
getSharedLevel6=select commodity_id,cover_id,commodity_base_rate,DATEPART(day,effective_date)as days,DATEPART(month,effective_date)as months,DATEPART(year,effective_date) as years,COVER_TYPE_ID,ISNULL(DISCOUNT_PERCENT,'0'),ISNULL(DISCOUNT_VALUE,'0'),EXCESS_DESCRIPTION from open_cover_commodity_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_commodity_detail where proposal_no=?) order by commodity_id
getSharedLevel7=SELECT CROSS_VOYAGE_TURNOVER FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=?)
getSharedLevel8=SELECT PERCENTRATE FROM CONSTANT_DETAIL WHERE CATEGORY_ID='150' AND  CATEGORY_DETAIL_ID='1'
getSharedLevel9=SELECT PERCENTRATE FROM CONSTANT_DETAIL WHERE CATEGORY_ID='150' AND  CATEGORY_DETAIL_ID='2'
getSharedLevel10=SELECT PERCENT FROM CONSTANT_DETAIL WHERE CATEGORY_ID='150' AND  CATEGORY_DETAIL_ID='3'
getSharedLevel11=SELECT COMMODITY_ID,COVER_ID,COMMODITY_RATE-(COMMODITY_RATE*{0}/100) COMMODITY_RATE,DATEPART(day,EFFECTIVE_DATE)  AS DAYS,DATEPART(month,EFFECTIVE_DATE)  AS MONTHS,DATEPART(year,EFFECTIVE_DATE) AS YEARS,COVER_TYPE_ID,NULLIF(DISCOUNT_PERCENT,''0''),NULLIF(DISCOUNT_VALUE,''0'') FROM OPEN_COVER_COMMODITY_RATE OCCR WHERE  COMMODITY_ID IN (''{1}'') AND BRANCH_CODE=''{2}''  AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_COMMODITY_RATE OCC WHERE  OCC.COMMODITY_ID=OCCR.COMMODITY_ID AND  OCC.COVER_ID=OCCR.COVER_ID AND BRANCH_CODE=''{3}'') ORDER BY  COMMODITY_ID
getSharedLevel12=select NULLIF(insurance_company_id,'0'),NULLIF(share_percentage,'0'),LEADER_YN from open_cover_share_percentage where insurance_company_id!='27' and proposal_no=? and amend_id=(select max(amend_id) from open_cover_share_percentage where proposal_no=?)
getSharedLevel13=SELECT DISTINCT(COVER_ID) FROM OPEN_COVER_CLAUSES WHERE PROPOSAL_NO=? AND EXTRA_COVER_ID=0
getSharedLevel14=select count(warranty_id) from open_cover_warranties where proposal_no=?
getSharedLevel15=select count(exclusion_id) from open_cover_exclusions where proposal_no=?
getSharedLevel16=select extra_cover_id,clauses_id from open_cover_clauses where proposal_no=? and extra_cover_id not in('0') and amend_id in(select max(amend_id) from open_cover_clauses where proposal_no=? and extra_cover_id not in('0')group by cover_id)
getSharedLevel17=select ISNULL(percentRATE,0) from constant_detail where category_id=10 and category_detail_id=1 and status='Y'
getSharedLevel18=select ISNULL(percentRATE,0), (select distinct TRANSPORT_DESCRIPTION from MODE_OF_TRANSPORT m where m.mode_transport_id=category_detail_id),category_detail_id from constant_detail where category_id=130  and status=''Y'' and branch_code=''{0}'' order by category_detail_id asc
getSharedLevel19=select open_cover_country_id_org ,NULLIF(open_cover_wsrcc_org,'0'),NULLIF(open_cover_warehouse_org,'0'),open_cover_country_id_dest,NULLIF(open_cover_wsrcc_dest,'0'),NULLIF(open_cover_warehouse_dest,'0'),NULLIF(war_rate,'0') from open_cover_country_master where proposal_no=? and amend_id=(select max(amend_id) from open_cover_country_master where proposal_no=?)
getSharedLevel20=select NULLIF(insurance_company_id,'0'),NULLIF(share_percentage,'0'),LEADER_YN from open_cover_share_percentage where insurance_company_id='27' and proposal_no=? and amend_id=(select max(amend_id) from open_cover_share_percentage where proposal_no=?)
storedRates1=delete from open_cover_commodity_detail where proposal_no=?
storedRates2=delete from open_cover_deductible_master where open_cover_proposal_no=?
storedRates3=update open_cover_deductible_master set status='N' where open_cover_proposal_no=?
storedRates4=select ISNULL(max(amend_id)+1,'0') from open_cover_deductible_master where open_cover_proposal_no=?
storedRates5=insert into open_cover_deductible_master(sno,open_cover_proposal_no,start_range,end_range,excess_amount,amend_id,effective_date,currency_id,currency_name,status,EXCESS_PERCENT) values((select NULLIF(max(sno)+1,''1'') from open_cover_deductible_master where open_cover_proposal_no=''{0}''),?,?,?,?,?,''{1}'',?,?,''Y'',?)
storedRates6=select b.SHORT_name from currency_master b where b.COUNTRY_ID=1 AND b.CURRENCY_ID=''{0}'' and b.status=''Y'' and b.amend_id||b.currency_id  in(select max(amend_id)||currency_id from currency_master where effective_date <=SYSDATE+10/24  and status=''Y'' and COUNTRY_ID=1 group by currency_id)
storedRates7=insert into open_cover_commodity_detail(proposal_no,amend_id,commodity_id,cover_id,commodity_base_rate,effective_date,status,COVER_TYPE_ID)values(?,{0},?,?,?,''{1}'',?,?)
storedRates8=UPDATE OPEN_COVER_COMMODITY_DETAIL SET DISCOUNT_PERCENT=? WHERE PROPOSAL_NO=? AND COVER_ID=? AND COMMODITY_ID=? AND COVER_TYPE_ID=?
storedRates9=UPDATE OPEN_COVER_COMMODITY_DETAIL SET DISCOUNT_VALUE=? WHERE PROPOSAL_NO=? AND COVER_ID=? AND COMMODITY_ID=? AND COVER_TYPE_ID=?
storedRates10=UPDATE OPEN_COVER_COMMODITY_DETAIL SET EXCESS_DESCRIPTION=? WHERE PROPOSAL_NO=? AND COVER_ID=? AND COMMODITY_ID=?
storedRates11=delete from open_cover_share_percentage where proposal_no=?
storedRates12=insert into open_cover_share_percentage(proposal_no,amend_id,insurance_company_id,share_percentage,effective_date,status,LEADER_YN)values(?,{0},?,?,''{1}'',?,?)
storedRates13=update open_cover_country_master set war_rate=? where proposal_no=? and amend_id=(select max(amend_id) from open_cover_country_master where proposal_no=?)
getWARClause=select clauses_id,clauses_description,extra_cover_id from clauses_master where status in (''Y'', ''R'')  and extra_cover_id in ({0}) and BRANCH_CODE={1}
getDeductibles=select START_RANGE, END_RANGE, EXCESS_AMOUNT,CURRENCY_ID,EXCESS_PERCENT from open_cover_deductible_master where amend_id= (select max(amend_id) from open_cover_deductible_master   where open_cover_proposal_no=? and (effective_date) <= CONVERT(date,?,103)) and open_cover_proposal_no=? and status='Y' and (effective_date) <= CONVERT(date,?,103)
getRangeValidation=select 'yes' from dual where {0} between {1} and {2}
updateConfirmYN=update open_cover_master set CONFIRM_STATUS=? where Proposal_no=? and AMEND_ID = (select max(amend_id) from OPEN_COVER_MASTER where Proposal_no = ?)
getConfirmInfo=SELECT CASE  WHEN  ISNULL(CONFIRM_STATUS,0) IS null THEN 'NO' ELSE CONFIRM_STATUS END  FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? and AMEND_ID = (select max(amend_id) from OPEN_COVER_MASTER where Proposal_no = ?)
insertMOPDetails=SELECT TYPE,CROSS_VOYAGE_TURNOVER,NO_OF_VEHICLES,HAULIER_PREMIUM,COMMISSION,VAT_TAX_PERCENT FROM OPEN_COVER_MASTER OCM WHERE PROPOSAL_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=OCM.PROPOSAL_NO)
insertMOPDetails1=select max(COMMODITY_BASE_RATE) from open_cover_commodity_detail where PROPOSAL_NO=?
insertMOPDetails2=SELECT COUNT(*) FROM OPEN_COVER_MOP_DETAILS WHERE PROPOSAL_NO=?
insertMOPDetails3=UPDATE OPEN_COVER_MOP_DETAILS SET SUMINSURED=CONVERT(decimal(20,2), CAST(? AS FLOAT)),MARINE_RATE=CONVERT(decimal(20,6), CAST(? AS FLOAT)),MARINE_PREMIUM=?,WAR_RATE=CONVERT(decimal(20,6), CAST(? AS FLOAT)),WAR_PREMIUM=?,TOTAL_PREMIUM=?,COMMISSION_PERCENT=?,VAT_TAX_PERCENT=? WHERE PROPOSAL_NO=?
insertMOPDetails4=INSERT INTO OPEN_COVER_MOP_DETAILS(AMEND_ID,SUMINSURED,MARINE_RATE,MARINE_PREMIUM,WAR_RATE,WAR_PREMIUM,TOTAL_PREMIUM,COMMISSION_PERCENT,VAT_TAX_PERCENT,PROPOSAL_NO) VALUES('0',CONVERT(decimal(20,2), CAST(? AS FLOAT)),CONVERT(decimal(20,3), CAST(? AS FLOAT)),CONVERT(decimal(20,2), CAST(? AS FLOAT)),?,?,CONVERT(decimal(20,2), CAST(? AS FLOAT)),?,?,?)
#getMopPremiumDetails=SELECT SUMINSURED,MARINE_RATE,MARINE_PREMIUM,WAR_RATE,WAR_PREMIUM,TOTAL_PREMIUM,NULLIF(POLICY_FEE,0),NULLIF(INSPECTION_FEE,0),FINAL_PREMIUM,PAYABLE_YN,PERCENTAGE,PAYABLE_PREMIUM,NULLIF(COMMISSION_PERCENT,0) FROM OPEN_COVER_MOP_DETAILS WHERE PROPOSAL_NO=?
getHaulierTypeFromOCM=SELECT HAULIER_TYPE FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
getMopPremiumDetails=SELECT SUMINSURED,MARINE_RATE,MARINE_PREMIUM,WAR_RATE,WAR_PREMIUM,TOTAL_PREMIUM,isnull(POLICY_FEE,0),isnull(INSPECTION_FEE,0),isnull(FINAL_PREMIUM,0),PAYABLE_YN,isnull(PERCENTAGE,0),isnull(PAYABLE_PREMIUM,0),isnull(COMMISSION_PERCENT,0),C.ENDT_STATUS ENDT_STATUS FROM OPEN_COVER_MOP_DETAILS  ocmp,OPEN_COVER_POSITION_MASTER C WHERE ocmp.PROPOSAL_NO=?  AND C.PROPOSAL_NO = ocmp.PROPOSAL_NO
updateMopPremiumDetails=UPDATE OPEN_COVER_MOP_DETAILS SET INSPECTION_FEE=CONVERT(decimal(20,2), CAST(? AS FLOAT)),PAYABLE_YN=?,PERCENTAGE=CONVERT(decimal(20,2), CAST(? AS FLOAT)),POLICY_FEE=CONVERT(decimal(20,2), CAST(? AS FLOAT)) WHERE PROPOSAL_NO=?
mopPremiumCalc=UPDATE OPEN_COVER_MOP_DETAILS SET FINAL_PREMIUM=CONVERT(decimal(20,2), CAST(? AS FLOAT)),PAYABLE_PREMIUM=CONVERT(decimal(20,2), CAST(? AS FLOAT)),COMMISSION=CONVERT(decimal(20,2), CAST(? AS FLOAT)) WHERE PROPOSAL_NO=?
mopPremiumCalc1=UPDATE OPEN_COVER_MOP_DETAILS SET PAYABLE_MARINE_PREMIUM=NULLIF(MARINE_PREMIUM,0)*PERCENTAGE/100,PAYABLE_WAR_PREMIUM=NULLIF(isNULL(WAR_PREMIUM,0),0)*PERCENTAGE/100,PAYABLE_TOTAL_PREMIUM=NULLIF(TOTAL_PREMIUM,0)*PERCENTAGE/100,PAYABLE_INSPECTION_FEE=NULLIF(INSPECTION_FEE,0)*PERCENTAGE/100,PAYABLE_POLICY_FEE=NULLIF(POLICY_FEE,0)*PERCENTAGE/100 WHERE PROPOSAL_NO=?
calcPolicyFee=SELECT A.MIN_PREMIUM_ISSUANCE_FEE POLICY_FEE_DEFAULT,A.ISSUANCE_FEE POLICY_FEE_PERCENT,A.COMMISSION COMMISSION FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = A.PROPOSAL_NO)
getOpenCoverType=SELECT TYPE FROM OPEN_COVER_MASTER OCM WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=OCM.PROPOSAL_NO)
getWarrantiesFromMaster=select warranty_id,warranty_description from warranty_master wm  where   status in ('Y', 'R') and BRANCH_CODE \= ? order by DISPLAY_ORDER
getExclusionsFromMaster=select exclusion_id,exclusion_description from exclusion_master em where  status in ('Y', 'R') and BRANCH_CODE \= ? order by EXCLUSION_ID
getConditionsFromMaster=select distinct description from cover_master where branch_code = {0} and cover_id = {1}
getConditionsFromMaster1=SELECT CM.CLAUSES_ID CLAUSES_ID,CM.CLAUSES_DESCRIPTION CLAUSES_DESCRIPTION,CONVERT(SYSDATETIME(),103),CM.RSACODE  RSACODE FROM CLAUSES_MASTER CM WHERE CM.BRANCH_CODE=? AND CM.COVER_ID=?  AND extra_cover_id='0' order by CM.CLAUSES_ID
getConditionsFromMaster2=select CLAUSES_ID,CLAUSES_DESCRIPTION from  commodity_clauses(?,?,'Clauses',?)
getWarrantyFromOpenCoverMaster=select occmss.warranty_id,occmss.warranty_description,CONVERT(date,occmss.EFFECTIVE_DATE,103) as effectDate  from open_cover_warranties occmss,open_cover_position_master ocpmss where ocpmss.proposal_no = ? and ocpmss.proposal_no=occmss.proposal_no and occmss.amend_id in (select max(occms.amend_id) from open_cover_warranties occms, open_cover_position_master ocpms where ocpms.proposal_no = ?  and ocpms.proposal_no=occms.proposal_no)
getExclusionFromOpenCoverMaster=select occmss.exclusion_id,occmss.exclusion_description,CONVERT(date,occmss.EFFECTIVE_DATE,103) as effectDate,COMMODITY_IDS  from open_cover_exclusions occmss,open_cover_position_master ocpmss where ocpmss.proposal_no \= ? and ocpmss.proposal_no\=occmss.proposal_no and occmss.amend_id in (select max(occms.amend_id) from open_cover_exclusions occms,open_cover_position_master ocpms where ocpms.proposal_no \= ? and ocpms.proposal_no\=occms.proposal_no)
getWsrccFromOpenCoverMasterResult=select occmss.clauses_id,occmss.clauses_description,CONVERT(date,occmss.EFFECTIVE_DATE,103) as effectDate,occmss.COVER_ID from open_cover_clauses occmss,open_cover_position_master ocpmss where ocpmss.proposal_no = ? and ocpmss.proposal_no=occmss.proposal_no and occmss.amend_id in(select max(amend_id) from open_cover_clauses where proposal_no = ? and cover_id not in(0) and extra_cover_id in ({0})) and cover_id not in(0) and occmss.extra_cover_id in ({1})
getConditionsFromOpenCoverMaster=select occmss.clauses_id,occmss.clauses_description,CONVERT(date,occmss.EFFECTIVE_DATE,103) as effectDate  from open_cover_clauses occmss,open_cover_position_master ocpmss where ocpmss.proposal_no = ? and ocpmss.proposal_no=occmss.proposal_no  and occmss.cover_id = ? and occmss.amend_id in (select max(occms.amend_id) from open_cover_clauses occms,open_cover_position_master ocpms where ocpms.proposal_no = ? and occms.cover_id = ? and ocpms.proposal_no=occms.proposal_no and occms.extra_cover_id='0') and occmss.extra_cover_id='0'
insertUpdateConditions=delete from open_cover_clauses where proposal_no = ? and cover_id = ?
insertUpdateConditions1=insert into open_cover_clauses (proposal_no,mode_transport_id,cover_id,extra_cover_id,clauses_id,clauses_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,CONVERT(date,''{0}'',103),?,?)
insertUpdateWarranties=delete from open_cover_warranties where proposal_no = ?
insertUpdateWarranties1=insert into open_cover_warranties (proposal_no,mode_transport_id,cover_id,extra_cover_id,warranty_id,warranty_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,CONVERT(date,''{0}'',103),?,?)
getOpencoverFreeText=delete from open_cover_free_text where proposal_no = ?  and cover_id = ?
getOpencoverFreeText1=select free_text_id, free_text_description, CONVERT(effective_date,103),COMMODITY_IDS from open_cover_free_text where proposal_no = ? and cover_id = ? and amend_id =(select max(amend_id) from open_cover_free_text where proposal_no = ? and cover_id = ?)
insertUpdateWSRCCText=delete from open_cover_clauses where proposal_no = ? and extra_cover_id != 0  and cover_id = ? and amend_id = ?
insertUpdateWSRCCText1= insert into open_cover_clauses (proposal_no,mode_transport_id,cover_id,extra_cover_id,clauses_id,clauses_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,CONVERT(date,'{0}',103),?,?)
insertUpdateFreeText=delete from open_cover_free_text where proposal_no = ?  and cover_id = ?
insertUpdateFreeText1=delete from open_cover_free_text where proposal_no = ?  and cover_id = ?
insertUpdateFreeText2=insert into open_cover_free_text (proposal_no,AMEND_ID,mode_of_transport,cover_id,extra_cover_id,free_text_id,free_text_description,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,CONVERT(date,'{0}',103),?,?)
insertUpdateExclusions=delete from open_cover_exclusions where proposal_no = ?
insertUpdateExclusions1=insert into open_cover_exclusions (proposal_no,mode_transport_id,cover_id,extra_cover_id,exclusion_id,exclusion_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,CONVERT(date,'{0}',103),?,?)
getMaximumProposalNo=select max(proposal_no) from open_cover_clauses
getExtracoverID=select extra_cover_id from clauses_master where clauses_id = ? and BRANCH_CODE= ?
getMaximumWarrantiesAmendId=select max(amend_id) from open_cover_position_master where proposal_No = ?
getMaximumtextamendId=select max(amend_id) from open_cover_position_master where proposal_No = ?
getMaximumWSRCCID=select max(amend_id) from open_cover_position_master where proposal_No = ?
getMaximumExclusionsAmendId=select max(amend_id) from open_cover_position_master where proposal_No = ?
getProposalNoDetails=select a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name from open_cover_sub_detail a,mode_of_transport b,cover_master c where a.proposal_no = ? and c.BRANCH_CODE=b.BRANCH_CODE and c.BRANCH_CODE = ? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no = ?) and a.status='Y' and c.cover_id=a.cover_id and b.mode_transport_id=a.mode_transport_id group by a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name order by a.mode_transport_id ,a.cover_id
getExtraCoverIds=Select STUFF((SELECT ', '+CONVERT(varchar, A.MODE_TRANSPORT_ID)  AS[text()] FROM OPEN_COVER_DETAIL A WHERE A.PROPOSAL_NO = ? AND A.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   OPEN_COVER_DETAIL WHERE   PROPOSAL_NO = A.PROPOSAL_NO) order by A.MODE_TRANSPORT_ID Asc FOR XML PATH('')), 1, 2, '') as MODE_TRANSPORT_ID 
insertUpdateWarrantiesNew=delete from open_cover_warranties where proposal_no = ? and cover_id {0}
insertUpdateWarrantiesNew1=insert into open_cover_warranties (proposal_no,mode_transport_id,cover_id,extra_cover_id,warranty_id,warranty_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS,COMMODITY_IDS)values(?,?,?,?,?,?,?,CONVERT(date,''{0}'',103),?,?,?)
insertUpdateWarrantiesNew2=select commodity_id from open_cover_commodity_master where proposal_no=? order by COMMODITY_NAME_DESC
insertUpdateExclusionsNew=delete from open_cover_exclusions where proposal_no = ? and cover_id {0}
insertUpdateExclusionsNew1=insert into open_cover_exclusions (proposal_no,mode_transport_id,cover_id,extra_cover_id,exclusion_id,exclusion_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS,COMMODITY_IDS)values(?,?,?,?,?,?,?,CONVERT(date,''{0}'',103),?,?,?)
insertUpdateExclusionsNew2=select commodity_id from open_cover_commodity_master where proposal_no=? order by COMMODITY_NAME_DESC
getWarrantyFromOpenCoverMasterNew=select occmss.warranty_id,occmss.warranty_description,occmss.EFFECTIVE_DATE as effectDate,COMMODITY_IDS  from open_cover_warranties occmss,open_cover_position_master ocpmss where ocpmss.proposal_no = ? and ocpmss.proposal_no=occmss.proposal_no and occmss.amend_id in (select max(occms.amend_id) from open_cover_warranties occms, open_cover_position_master ocpms where ocpms.proposal_no = ?  and ocpms.proposal_no=occms.proposal_no) {0}
insertUpdateWSRCCTextNew=delete from open_cover_clauses where proposal_no = ? and extra_cover_id != 0  and cover_id = ? and amend_id = ?
insertUpdateWSRCCTextNew1=insert into open_cover_clauses (proposal_no,mode_transport_id,cover_id,extra_cover_id,clauses_id,clauses_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS)values(?,?,?,?,?,?,?,CONVERT(date,''{0}'',103),?,?)
insertUpdateFreeTextNew=delete from open_cover_free_text where proposal_no = ?  and cover_id = ? and type='F'
insertUpdateFreeTextNew1=insert into open_cover_free_text (proposal_no,AMEND_ID,mode_of_transport,cover_id,extra_cover_id,free_text_id,free_text_description,EFFECTIVE_DATE,REMARKS,STATUS,type,COMMODITY_IDS)values(?,?,?,?,?,?,?,CONVERT(date,''{0}'',103),?,?,?,?)
insertUpdateConditionsNew=delete from open_cover_clauses where proposal_no = ? and cover_id = ? and EXTRA_COVER_ID=0
insertUpdateConditionsNew1=insert into open_cover_clauses (proposal_no,mode_transport_id,cover_id,extra_cover_id,clauses_id,clauses_description,AMEND_ID,EFFECTIVE_DATE,REMARKS,STATUS,COMMODITY_IDS)values(?,?,?,?,?,?,?,CONVERT(date,''{0}'',103),?,?,?)
getConditionsFromMasterNew=select distinct description from cover_master where branch_code = ? and cover_id = ?
getConditionsFromMasterNew1=SELECT CM.CLAUSES_ID CLAUSES_ID,CM.CLAUSES_DESCRIPTION CLAUSES_DESCRIPTION,GETDATE(),CM.RSACODE  RSACODE  FROM CLAUSES_MASTER CM WHERE CM.BRANCH_CODE=(select BELONGING_BRANCH from branch_master where BRANCH_CODE=? ) AND CM.COVER_ID=?  AND extra_cover_id='0' order by CM.CLAUSES_ID
getConditionsFromMasterNew2=select CLAUSES_ID,CLAUSES_DESCRIPTION,'~'+COMMODITY_IDS+'~' from  commodity_clauses(?,?,'Clauses',?)
getConditionsFromOpenCoverMasterNew=select occmss.clauses_id,occmss.clauses_description,occmss.EFFECTIVE_DATE as effectDate,commodity_ids  from open_cover_clauses occmss,open_cover_position_master ocpmss where ocpmss.proposal_no = ? and ocpmss.proposal_no=occmss.proposal_no  and occmss.cover_id = ? and occmss.amend_id in (select max(occms.amend_id) from open_cover_clauses occms,open_cover_position_master ocpms where ocpms.proposal_no = ? and occms.cover_id = ? and ocpms.proposal_no=occms.proposal_no and occms.extra_cover_id='0') and occmss.extra_cover_id='0'
getExclusionsFromMaster1=select exclusion_id,exclusion_description from exclusion_master em where EM.EXCLUSION_ID not in (select EXCLUSION_ID from open_cover_exclusions oce where em.EXCLUSION_ID=oce.EXCLUSION_ID and proposal_no=? and cover_id='0' ) and  status in ('Y', 'R') and BRANCH_CODE = ? order by EXCLUSION_ID
getOpencoverFreeTextNew=delete from open_cover_free_text where proposal_no = ?  and cover_id = ?
getOpencoverFreeTextNew1=select free_text_id, free_text_description, effective_date,COMMODITY_IDS from open_cover_free_text where proposal_no = ? and cover_id = ? and  TYPE = 'F' and amend_id =(select max(amend_id) from open_cover_free_text where proposal_no = ? and cover_id = ? and type='F')
getWarrantiesFromMaster1=select warranty_id,warranty_description from warranty_master wm  where wm.WARRANTY_ID not in (select WARRANTY_ID from open_cover_warranties ocw where wm.WARRANTY_ID=ocw.WARRANTY_ID and proposal_no=? and cover_id='0' ) and   status in ('Y', 'R') and BRANCH_CODE = ? order by DISPLAY_ORDER
getWSRCCFromMaster=select clauses_id,clauses_description,extra_cover_id,cover_id,RSACODE from clauses_master where status in (''Y'',''R'') and BRANCH_CODE = ? and extra_cover_id in ({0}) group by extra_cover_id,clauses_id,clauses_description,cover_id,RSACODE order by clauses_id
getWSRCCFromMaster1=select CLAUSES_ID,CLAUSES_DESCRIPTION from commodity_clauses(?,?,'War',?)
getWsrccFromOpenCoverMaster=SELECT OCCMSS.CLAUSES_ID, OCCMSS.CLAUSES_DESCRIPTION, CONVERT (date,OCCMSS.EFFECTIVE_DATE, 103) AS EFFECTDATE FROM OPEN_COVER_CLAUSES OCCMSS, OPEN_COVER_POSITION_MASTER OCPMSS WHERE OCPMSS.PROPOSAL_NO \= ? AND OCPMSS.PROPOSAL_NO \= OCCMSS.PROPOSAL_NO AND OCCMSS.AMEND_ID IN ( SELECT MAX (AMEND_ID) FROM OPEN_COVER_CLAUSES WHERE PROPOSAL_NO \= OCPMSS.PROPOSAL_NO AND COVER_ID NOT IN (0) AND EXTRA_COVER_ID IN ({0})) AND COVER_ID NOT IN (0) AND OCCMSS.EXTRA_COVER_ID IN ({1})
getAdminBranch=select NULLIF(BRANCH_CODE,'020') from LOGIN_MASTER where login_id\=?  
getOpenCoversByExpiryDate=SELECT ROWNUM SNO,X.* FROM (SELECT NULLIF (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, A.PROPOSAL_NO PROPOSAL_NO, E.COMPANY_NAME BROKER, NULLIF (C.FIRST_NAME, C.COMPANY_NAME) CUSTOMER, NULLIF (CONVERT (A.INCEPTION_DATE, 103), ' ') INCEPTION_DATE, NULLIF (CONVERT (A.EXPIRY_DATE,103 ), ' ') EXPIRY_DATE FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO C, OPEN_COVER_MASTER D, BROKER_COMPANY_MASTER E WHERE A.STATUS = 'P' AND (CONVERT (A.EXPIRY_DATE,103) - CONVERT (SYSDATE,103)) BETWEEN 0 AND 60 AND MOD ( (CONVERT (date,A.EXPIRY_DATE,103) -CONVERT(date,getDATE(),103)), 10) = 0 AND A.PROPOSAL_NO = D.PROPOSAL_NO AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = D.PROPOSAL_NO) AND C.CUSTOMER_ID = D.CUSTOMER_ID AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND E.AGENCY_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = D.BROKER_ID) AND D.BRANCH_CODE=? ORDER BY EXPIRY_DATE) X
getOpenCoversByStartDate=SELECT ROWNUM SNO,X.* FROM (SELECT NULLIF (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, A.PROPOSAL_NO PROPOSAL_NO, E.COMPANY_NAME BROKER, NULLIF (C.FIRST_NAME, C.COMPANY_NAME) CUSTOMER, NULLIF (CONVERT (A.INCEPTION_DATE, 103), ' ') INCEPTION_DATE, NULLIF (CONVERT (A.EXPIRY_DATE, 103), ' ') EXPIRY_DATE FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO C, OPEN_COVER_MASTER D, BROKER_COMPANY_MASTER E WHERE A.STATUS = 'P' AND (CONVERT(date,A.INCEPTION_DATE+((EXTRACT (YEAR FROM SYSDATE)-EXTRACT (YEAR FROM A.INCEPTION_DATE))*365))-CONVERT(date,SYSDATE,103)) BETWEEN 0 AND 60 AND MOD ( (TRUNC(A.INCEPTION_DATE+((EXTRACT (YEAR FROM SYSDATE)-EXTRACT (YEAR FROM A.INCEPTION_DATE))*365))-TRUNC(SYSDATE)), 10) = 0 AND TRUNC (A.EXPIRY_DATE) >= TRUNC (SYSDATE) AND A.PROPOSAL_NO = D.PROPOSAL_NO AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = D.PROPOSAL_NO) AND C.CUSTOMER_ID = D.CUSTOMER_ID AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND E.AGENCY_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = D.BROKER_ID) AND D.BRANCH_CODE=? ORDER BY EXPIRY_DATE) X
getBranchInfoByOpenCoverExpiryDate=SELECT DISTINCT D.BRANCH_CODE, F.EMAIL_TO, F.EMAIL_CC,B.BRANCH_NAME FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_MASTER D, MAIL_DETAILS F, BRANCH_MASTER B WHERE A.STATUS = 'P' AND (TRUNC (A.EXPIRY_DATE) - TRUNC (SYSDATE)) BETWEEN 0 AND 60 AND MOD ( (TRUNC (A.EXPIRY_DATE) - TRUNC (SYSDATE)), 10) = 0 AND A.PROPOSAL_NO = D.PROPOSAL_NO AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = D.PROPOSAL_NO) AND F.BRANCH_CODE = D.BRANCH_CODE AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND B.BRANCH_CODE=D.BRANCH_CODE ORDER BY D.BRANCH_CODE
getBranchInfoByOpenCoverStartDate=SELECT DISTINCT D.BRANCH_CODE, F.EMAIL_TO, F.EMAIL_CC, B.BRANCH_NAME FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_MASTER D, MAIL_DETAILS F, BRANCH_MASTER B WHERE A.STATUS = 'P' AND ( trunc(A.INCEPTION_DATE + ((EXTRACT (YEAR FROM SYSDATE) - EXTRACT (YEAR FROM A.INCEPTION_DATE)) * 365)) - trunc(SYSDATE)) BETWEEN 0 AND 60 AND mod((trunc(A.INCEPTION_DATE+((EXTRACT (YEAR FROM SYSDATE)-EXTRACT (YEAR FROM A.INCEPTION_DATE))*365))-trunc(SYSDATE)),10) = 0 AND TRUNC (A.EXPIRY_DATE) >= TRUNC (SYSDATE) AND A.PROPOSAL_NO = D.PROPOSAL_NO AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = D.PROPOSAL_NO) AND F.BRANCH_CODE = D.BRANCH_CODE AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND B.BRANCH_CODE = D.BRANCH_CODE ORDER BY D.BRANCH_CODE
getBranchCode=SELECT BRANCH_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=?
getBranchPrefix=SELECT BRANCH_PREFIX FROM BRANCH_MASTER WHERE BRANCH_CODE\=?
getCurrencyRates=select a.exchange_rate,b.currency_name,a.amend_id,a.effective_date,a.currency_id from exchange_master a, currency_master b where a.currency_id=b.currency_id and a.COUNTRY_ID=b.COUNTRY_ID and a.COUNTRY_ID=? and a.amend_id+a.exchange_id+a.currency_id in(select max(amend_id)+exchange_id+currency_id from exchange_master where (effective_date) <=GETDATE()+10/24 and status='Y' and COUNTRY_ID=? group by exchange_id,currency_id)  and (a.effective_date) <=GETDATE()+10/24 and a.status='Y' and b.status='Y' and b.status='Y' and a.status='Y' and b.currency_id=? and  b.amend_id+b.currency_id in(select max(amend_id)+currency_id from currency_master where (effective_date) <=GETDATE()+10/24 and status='Y' and COUNTRY_ID=? group by currency_id)
getCurrencyDetails=SELECT em.exchange_rate,cm.currency_name, em.amend_id, em.effective_date, em.currency_id FROM currency_master cm,exchange_master em WHERE cm.country_id\=? and cm.status\='Y' AND cm.amend_id\=(SELECT MAX(amend_id) FROM currency_master WHERE status\='Y' and currency_id\=cm.currency_id AND (effective_date)<\=GETDATE()) AND cm.effective_date<\=(GETDATE()) AND cm.currency_id\=em.currency_id and cm.country_id\=em.country_id AND em.amend_id\=(SELECT MAX(amend_id) FROM exchange_master WHERE currency_id\=em.currency_id and country_id\=em.country_id AND effective_date<\=GETDATE()) AND em.effective_date<\=GETDATE() order by  cm.currency_name
getExistingCustomers=SELECT NULLIF (PI.FIRST_NAME, PI.COMPANY_NAME),NULLIF (PI.LAST_NAME, '0'),NULLIF (PI.EMAIL, '0'),NULLIF (MOBILE, ''),PI.CUSTOMER_ID,NULLIF (PI.MISSIPPI_CUSTOMER_CODE, '0'),NULLIF(PI.cust_ar_no,'') FROM PERSONAL_INFO PI,BROKER_COMPANY_MASTER BCM,LOGIN_MASTER LM WHERE PI.LOGIN_ID=LM.LOGIN_ID AND LM.OA_CODE=BCM.AGENCY_CODE AND LM.LOGIN_ID=? AND PI.APPLICATION_ID='1'
settingValues=select title,gender,NULLIF(first_name,company_name),last_name,nationality,DATEPART(day,dob) as dobday,DATEPART(month,dob) as dobmonth,DATEPART(year,dob) as dobyear,telephone,mobile,fax,email,address1,address2,occupation,emirate,country,pobox,company_name,NULLIF(missippi_customer_code,'0'),city,cust_ar_no,cust_name,VAT_REG_NO,CUST_NAME_ARABIC from personal_info where customer_id\=?
storedValues=insert into personal_info(customer_id,application_id,title,first_name,last_name,amend_id,nationality,dob,gender,telephone,mobile,fax,email,address1,address2,occupation,pobox,country,emirate,status,entry_date,login_id,company_name,missippi_customer_code,city,client_customer_id,cust_ar_no,cust_name,VAT_REG_NO,CUST_NAME_ARABIC) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,getDate(),?,?,?,?,?,?,?,?,?)
storedValues1=SELECT CUSTOMER_NUMBER_SEQ.NEXTVAL FROM DUAL
storedValues2=update personal_info set application_id=?,title=?,first_name=?,last_name=?,amend_id=?,nationality=?,dob=?,gender=?,telephone=?,mobile=?,fax=?,email=?,address1=?,address2=?,occupation=?,pobox=?,country=?,emirate=?,status=?,effective_date=getDate(),company_name = ?,missippi_customer_code=?,city=?,client_customer_id=?,cust_ar_no=?,cust_name=?,VAT_REG_NO=?,CUST_NAME_ARABIC=?  where customer_id=?
getExistingCustomerss=select customer_id,first_name,last_name,email,mobile,login_id from personal_info where login_id=? and (lower(LTRIM(RTRIM(first_name))) like ? or  lower(LTRIM(RTRIM(last_name))) like ?) and application_id=1 order by customer_id
getMissippiCustomerCode=select NULLIF(missippi_customer_code,0) from personal_info where customer_id\=? 
getCustomer=select customer_id from position_master where application_no=?
getErrors=select error_desc from error_master where error_id in ({0}) order by error_id
checkingSysDates=select datediff(day,GETDATE(),CONVERT(date,''{0}'',103))
checkingDates= SELECT DATEDIFF(day,CONVERT(Date,''{0}'',103),CONVERT(Date,''{1}'',103))
getReferralStatus=SELECT COUNT(*) FROM COMMODITYMASTER WHERE STATUS='Y' AND COMMODITY_ID=? AND BRANCH_CODE=?
sendMail=SELECT DISTINCT BRANCH_CODE, EMAIL_TO, EMAIL_CC FROM  MAIL_DETAILS WHERE BRANCH_CODE=?
getProposalInfo=SELECT ROWNUM SNO,X.* FROM (SELECT NULLIF (A.OPEN_COVER_NO, '0') OPEN_COVER_NO, A.PROPOSAL_NO PROPOSAL_NO, E.COMPANY_NAME BROKER, NULLIF (C.FIRST_NAME, C.COMPANY_NAME) CUSTOMER, NULLIF (CONVERT(date,A.INCEPTION_DATE,103), ' ') INCEPTION_DATE, NULLIF (CONVERT (A.EXPIRY_DATE,103), ' ') EXPIRY_DATE FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO C, OPEN_COVER_MASTER D, BROKER_COMPANY_MASTER E WHERE A.PROPOSAL_NO =? AND A.PROPOSAL_NO = D.PROPOSAL_NO AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = D.PROPOSAL_NO) AND C.CUSTOMER_ID = D.CUSTOMER_ID AND (A.ADMIN_STATUS IS NULL OR A.ADMIN_STATUS = 'Y') AND E.AGENCY_CODE = (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID = D.BROKER_ID) AND D.BRANCH_CODE=? ORDER BY EXPIRY_DATE) X
CONTROLLER1=SELECT COUNT(*) FROM OPEN_COVER_CLAUSES WHERE PROPOSAL_NO=? AND COVER_ID=?
CONTROLLER2=select distinct description from cover_master where branch_code = ? and cover_id = ?
CONTROLLER3=SELECT DISTINCT CM.CLAUSES_ID CLAUSES_ID,CM.CLAUSES_DESCRIPTION CLAUSES_DESCRIPTION,CONVERT(date,GETDATE(),103) FROM CLAUSES_MASTER CM,COMMODITYMASTER C WHERE CM.BRANCH_CODE=? AND CM.COVER_ID=? AND CM.RSACODE IN (SELECT REGEXP_SUBSTR ((SUBSTR({0},1,(INSTR({1},''~'',1,1)-1))), ''[^,]+'', 1, LEVEL) AS CLAUSESID FROM DUAL CONNECT BY LEVEL <=LENGTH ((SUBSTR({2},1,(INSTR({3},''~'',1,1)-1))))- LENGTH(REPLACE ((SUBSTR({4},1,(INSTR({5},''~'',1,1)-1))), '','', ''''))+ 1) AND CM.EXTRA_COVER_ID=''0'' AND CM.STATUS IN (''Y'',''R'') AND CM.BRANCH_CODE=C.BRANCH_CODE AND C.COMMODITY_ID IN (SELECT COMMODITY_ID FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO=?)) ORDER BY CM.CLAUSES_ID
CONTROLLER4=SELECT DISTINCT(COVER_ID) FROM OPEN_COVER_CLAUSES WHERE PROPOSAL_NO=?
CONTROLLER5=SELECT COUNT(*) FROM OPEN_COVER_CLAUSES WHERE PROPOSAL_NO=? AND EXTRA_COVER_ID IN (1) AND COVER_ID=?
CONTROLLER6=SELECT CLAUSES_ID,CLAUSES_DESCRIPTION,EXTRA_COVER_ID,COVER_ID FROM CLAUSES_MASTER WHERE STATUS IN (''Y'',''R'') AND BRANCH_CODE = ? AND EXTRA_COVER_ID IN (1) AND COVER_ID IN ({0}) GROUP BY EXTRA_COVER_ID,CLAUSES_ID,CLAUSES_DESCRIPTION,COVER_ID ORDER BY CLAUSES_ID
CONTROLLER7=Select policy_generate(''{0}'',''{1}'',''{2}'') from dual
CONTROLLER8=SELECT CASE WHEN NULLIF(GUEST_LOGIN_STATUS,0) is NULL then 'NO' else GUEST_LOGIN_STATUS end,PROPOSAL_STATUS FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=? and AMEND_ID = (select max(amend_id) from OPEN_COVER_MASTER where Proposal_no = ?)
CONTROLLER9=Select CASE when count(*)=0 then 'N' else 'Y' end  CKECK_YN from  open_cover_commodity_detail where proposal_no=?
CONTROLLER10=select DETAIL_NAME from constant_detail where CATEGORY_ID\=158 and CATEGORY_DETAIL_ID\=1
updateCrditDebit1=update open_cover_master set  DEBIT_NOTE\=? ,DEBIT_TO_ID\=? ,CREDIT_TO_ID \=? ,DEBIT_NOTE_NAME \=? where PROPOSAL_NO\=? 

##23-05
getBrokerDetail1=select ISNULL(company_name,'0'), ISNULL(contact_person,'0') from broker_company_master where agency_code = (select oa_code from login_master where login_id = (select broker_id from open_cover_master where proposal_no= ?  and amend_id = (select max(amend_id) from open_cover_master where proposal_no= ? )))
getDatas=select distinct(CONVERT(date,md.INCEPTION_DATE,103)), CONVERT(date,md.EXPIRY_DATE,103), mc.cross_voyage, pc.product_name,mc.min_premium, mc.IMPORT_MIN_PREMIUM_AMOUNT,mc.EXPORT_MIN_PREMIUM_AMOUNT,ISNULL(mc.CROSS_MIN_PREMIUM_AMOUNT,'0'), mc.TYPE, ISNULL(mc.COUNTRY_REMARKS,''), md.OPEN_COVER_NO,ISNULL (MD.RATE_PRINT_STATUS,'N'),ISNULL (MD.CANCELLATION_CLAUSE,''),ISNULL(MD.AMENDED_CLAUSE_PRINT_STATUS,'N'),RENEWAL_STATUS,ORIGINAL_POLICY_NO,ENDT_TYPE,(Select Product_name from open_cover_product_Details WHERE PRODUCT_ID=MC.TYPE AND BRANCH_CODE=?) OPEN_COVER_TYPE_NAME,md.PPWDAYS,md.POLICYFEE,mc.VAT_TAX_AMT from OPEN_COVER_POSITION_MASTER md, open_cover_master mc, product_master pc where md.proposal_no =? and mc.amend_id = (select max(amend_id) from open_cover_master where proposal_no = ?) and md.proposal_no = mc.proposal_no and pc.product_id =?
getConveyance1=SELECT OCD.MODE_TRANSPORT_ID,MOT.TRANSPORT_DESCRIPTION,REPLACE(REPLACE(OCD.CONVEYANCE,CHar(10),' '), CHar(13),' '),OCD.PPWDAYS, OCD.POLICYFEE  FROM OPEN_COVER_DETAIL OCD,MODE_OF_TRANSPORT MOT WHERE OCD.PROPOSAL_NO=? AND OCD.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO=OCD.PROPOSAL_NO AND STATUS='Y') AND OCD.MODE_TRANSPORT_ID=MOT.MODE_TRANSPORT_ID AND MOT.BRANCH_CODE=? AND OCD.STATUS='Y'
getModeMaster1=select mp.mode_transport_ID, md.transport_description,(mp.SUM_INSURED_LIMIT * mp.EXCHANGE_RATE) from mode_of_transport md, open_cover_detail mp where mp.status='Y' and mp.proposal_no = ? and md.BRANCH_CODE=? and mp.amend_id = (select max(amend_id) from open_cover_detail where proposal_no = ?) and md.mode_transport_ID=mp.mode_transport_ID order by mp.mode_transport_ID
getCoverMaster1=select a.mode_transport_id,a.cover_id,b.cover_name from open_cover_sub_detail a,cover_master b  where b.cover_id=a.cover_id and b.BRANCH_CODE=? and a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no =?)
getExtraCover1=select md.sea_options,md.mode_transport_id, md.cover_id from open_cover_sub_detail md  where  md.status='Y' and md.proposal_no = ? and md.sea_options != null
getcheckInsuranceId=select no_of_insurance_company from open_cover_master where amend_id = (select max(amend_id) from open_cover_master where proposal_no=?) and proposal_no = ?
getInsuranceCompanyId=select  a.insurance_company_id,a.proposal_no, a.share_percentage from open_cover_share_percentage a where amend_id = (select max(amend_id) from open_cover_share_percentage a where a.proposal_no = ? ) and a.proposal_no=?
getInsuranceCompanyName=select insurance_company_name from open_cover_insurance where insurance_company_id in ()
getModeofTransport=SELECT  MD.TRANSPORT_DESCRIPTION, CC.COVER_NAME,(OC.SUM_INSURED_LIMIT*OC.EXCHANGE_RATE) FROM OPEN_COVER_DETAIL OC, MODE_OF_TRANSPORT MD, COVER_MASTER CC,OPEN_COVER_SUB_DETAIL OCS WHERE OC.PROPOSAL_NO =?  AND OC.AMEND_ID = (SELECT MAX(AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO =?) AND MD.BRANCH_CODE=CC.BRANCH_CODE AND CC.BRANCH_CODE=? AND OC.MODE_TRANSPORT_ID = MD.MODE_TRANSPORT_ID AND CC.COVER_ID = OCS.COVER_ID AND OCS.PROPOSAL_NO=OC.PROPOSAL_NO AND OCS.MODE_TRANSPORT_ID=OC.MODE_TRANSPORT_ID AND OCS.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_SUB_DETAIL WHERE PROPOSAL_NO =OC.PROPOSAL_NO)  ORDER BY MD.MODE_TRANSPORT_ID,CC.COVER_ID
getOpenCoverInformation=select a.title, a.first_name, ISNULL(a.company_name,0), b.back_date_days,b.cross_voyage_turnover, b.rsa_shared_percentage,b.no_of_insurance_company,b.cross_voyage,b.cross_voyage_percentage, b.commission,b.MISSISSIPI_OPEN_POLICY_ID,b.BUSINESS_TYPE,b.MISSIPPI_OPENCOVER_NO from personal_info a, open_cover_master b where a.customer_id =  ( select b.customer_id from open_cover_master b where b.proposal_no = ? and b.amend_id = (select max(b.amend_id) from open_cover_master b where b.proposal_no =?))  and b.proposal_no = ? and b.amend_id = (select max(b.amend_id) from open_cover_master b where b.proposal_no =?) and a.customer_id = b.customer_id
getOpenCoverDepostDetails=SELECT CASE OCM.EXISTING_DEPOSIT_YN WHEN 'Y' THEN 'Old' ELSE 'Yes' END,(select detail_name from constant_detail cd where cd.category_id='139' and cd.branch_code=? and cd.CATEGORY_DETAIL_ID=ocm.DEPOSIT_TYPE),OCM.DEBIT_NOTE_NO, OCM.CREDIT_NOTE_NO, OCM.MARINE_PREMIUM, OCM.WAR_PREMIUM, OCM.REMARKS FROM OPEN_COVER_MASTER OCM WHERE OCM.PROPOSAL_NO=? AND OCM.DEPOSIT_PREMIUM_YN='Y' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER OCM1 WHERE OCM1.PROPOSAL_NO=OCM.PROPOSAL_NO)
getAdditionalCustomer=SELECT REPLACE((PI.TITLE+''. ''+PI.FIRST_NAME+'', ''+''PO BOX ''+PI.POBOX+'', ''+PI.EMIRATE+'', ''+PI.ADDRESS1+'', ''+PI.ADDRESS2),'', ,'','','') as NAME FROM PERSONAL_INFO PI WHERE PI.CUSTOMER_ID IN ({0}) ORDER BY PI.CUSTOMER_ID
getColumnWise=select b.transport_description,c.cover_name, a.mode_transport_id,a.cover_id from open_cover_sub_detail a,mode_of_transport b,cover_master c where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and a.status='Y' and c.cover_id=a.cover_id and b.BRANCH_CODE=? and b.BRANCH_CODE=c.BRANCH_CODE and b.mode_transport_id=a.mode_transport_id order by a.cover_id
getCountryList=select country_name from country_master where country_id in ({0})
getCommodityId=select  max(amend_id),commodity_id from open_cover_commodity_master where commodity_id in(select distinct(commodity_id) from open_cover_commodity_master  where proposal_no=? group by commodity_id) group by commodity_id
getCoverId=select distinct a.amend_id,a.cover_id from open_cover_commodity_detail a where a.proposal_no=? and  a.amend_id in(select max(amend_id) from open_cover_commodity_detail a where a.proposal_no=?)
getCommodityName=select a.commodity_id,b.commodity_name,a.commodity_name_desc from open_cover_commodity_master a,commoditymaster b where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_commodity_master where proposal_no=? )  and a.status='Y' and b.commodity_id=a.commodity_id and  b.commodity_id=a.commodity_id and b.BRANCH_CODE=? and b.amend_id=(select max(amend_id) from commoditymaster where commodity_id=a.commodity_id and BRANCH_CODE=?)
getCommodityList=select a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name,A.COVER_TYPE_ID from open_cover_sub_detail a,mode_of_transport b,cover_master c where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and a.status='Y' and c.cover_id=a.cover_id and b.BRANCH_CODE=c.BRANCH_CODE and c.BRANCH_CODE=? and b.mode_transport_id=a.mode_transport_id group by a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name,A.COVER_TYPE_ID order by a.mode_transport_id,a.cover_id
getCommodityList1=select a.commodity_id,a.commodity_name_desc,b.commodity_name from open_cover_commodity_master a,commoditymaster b where a.proposal_no=? and b.BRANCH_CODE=? and a.amend_id=(select max(amend_id) from open_cover_commodity_master where proposal_no=?) and a.status='Y' and b.commodity_id=a.commodity_id and  b.commodity_id=a.commodity_id and b.amend_id=(select max(amend_id) from commoditymaster where commodity_id=a.commodity_id and BRANCH_CODE=?)
getCommodityList2=select commodity_id,cover_id,commodity_base_rate,COVER_TYPE_ID from open_cover_commodity_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_commodity_detail where proposal_no=?) order by commodity_id
getCommodityList11=select commodity_base_rate,amend_id,cover_id from open_cover_commodity_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_commodity_detail where proposal_no=?) order by commodity_id
getCountryDetails=select open_cover_country_id_dest,  war_rate from open_cover_country_master where proposal_no =? and amend_id = (select max(amend_id) from open_cover_country_master where proposal_no = ?)
getClausesInformation=select clauses_id,clauses_description from open_cover_clauses where status='Y' and cover_id=? and proposal_no = ?  and amend_id = (select max(amend_id) from open_cover_clauses where status='Y' and cover_id=? and proposal_no = ?)
getCoverName=select a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name from open_cover_sub_detail a,mode_of_transport b,cover_master c where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and a.status='Y' and  c.cover_id=a.cover_id and b.BRANCH_CODE = c.BRANCH_CODE and c.BRANCH_CODE=? and b.mode_transport_id=a.mode_transport_id group by a.mode_transport_id,a.cover_id,b.transport_description,c.cover_name order by a.mode_transport_id,a.cover_id
getWSRCC=select clauses_id, clauses_description, extra_cover_id from clauses_master where extra_cover_id in ({0},{1}) and BRANCH_CODE={2} order by extra_cover_id desc
getWSRCC1=select warranty_id,warranty_description,extra_cover_id from open_cover_warranties where proposal_no=? and amend_id=(select max(amend_id) from open_cover_warranties where proposal_no=?)
getExclusions=select exclusion_id,exclusion_description,extra_cover_id from open_cover_exclusions where proposal_no=? and amend_id=(select max(amend_id) from open_cover_exclusions where proposal_no=?)
getFreeText=select free_text_id,ISNULL(free_text_description,'9999') from open_cover_free_text where proposal_no=? and cover_id=? and amend_id=(select max(amend_id) from open_cover_free_text where proposal_no=? and cover_id=?)
getFreeTextSummary=select free_text_id,free_text_description from open_cover_free_text where proposal_no=?  and amend_id=(select max(amend_id) from open_cover_free_text where proposal_no=?)
openCoverNumber=select open_cover_no from open_cover_position_master where proposal_no=?
openCoverNumber1=SELECT A.MISSIPPI_OPENCOVER_NO FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
openCoverNumber2=UPDATE OPEN_COVER_MASTER SET MISSIPPI_OPENCOVER_NO=? WHERE PROPOSAL_NO=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER ocm WHERE ocm.PROPOSAL_NO=OPEN_COVER_MASTER.PROPOSAL_NO)
openCoverNumber3=update open_cover_position_master set admin_status='',open_cover_no=?,inception_date=(select distinct(open_cover_start_date) from open_cover_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?)),expiry_date=(select distinct(open_cover_end_date) from open_cover_detail where proposal_no=? and amend_id=(select max(amend_id) from open_cover_detail where proposal_no=?)),status=?,RATE_PRINT_STATUS=?,CANCELLATION_CLAUSE=?,AMENDED_CLAUSE_PRINT_STATUS=?,CKEY=? where proposal_no=?
updateConveyance=UPDATE OPEN_COVER_DETAIL SET CONVEYANCE=?,ppwdays=?,policyFee=? WHERE PROPOSAL_NO=? AND MODE_TRANSPORT_ID=? AND STATUS='Y'  AND AMEND_ID=(SELECT MAX(ocd.AMEND_ID) FROM OPEN_COVER_DETAIL ocd WHERE ocd.PROPOSAL_NO=OPEN_COVER_DETAIL.PROPOSAL_NO AND MODE_TRANSPORT_ID= OPEN_COVER_DETAIL.MODE_TRANSPORT_ID AND STATUS='Y' )
updaterateYN=update open_cover_position_master set RATE_PRINT_STATUS=?,CANCELLATION_CLAUSE=?,AMENDED_CLAUSE_PRINT_STATUS=? where proposal_no=?
showCoverages=select a.amend_id,a.cover_id,a.sea_options,b.cover_name,a.mode_transport_id from open_cover_sub_detail a,cover_master b where a.proposal_no=? and b.amend_id=(select max(amend_id) from cover_master c where b.cover_id=c.cover_id and c.branch_code=b.branch_code) and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?) and b.cover_id=a.cover_id and b.BRANCH_CODE=? order by a.mode_transport_id
insertintoLcMaster=insert into open_cover_lc_master (lc_number,lc_amount,bank_id,AMEND_ID,LC_DATE,EFFECTIVE_DATE,Expiry_DATE,REMARKS,STATUS,open_cover_no,lc_id)values(?,?,?,?,GETDATE(),GETDATE(),GETDATE(),?,?,?,?)
getBranchFullDetail=select address1,address2,address3,city,country from branch_master where branch_code=?
#getMOCGoodsName=SELECT SUBSTR (SYS_CONNECT_BY_PATH (commodity_name_desc , ','), 2) csv FROM (SELECT a.commodity_name_desc , ROW_NUMBER () OVER (ORDER BY b.commodity_id ) rn,COUNT (*) OVER () cnt from open_cover_commodity_master a,commoditymaster b where a.proposal_no=? and b.BRANCH_CODE=? and a.amend_id=(select max(amend_id) from open_cover_commodity_master where proposal_no=?) and a.status='Y' and b.commodity_id=a.commodity_id and  b.commodity_id=a.commodity_id and b.amend_id= (select max(amend_id) from commoditymaster where commodity_id=a.commodity_id and BRANCH_CODE=?) ) WHERE rn = cnt START WITH rn = 1 CONNECT BY rn = PRIOR rn + 1
getMOCGoodsName=SELECT STUFF((SELECT ', '+CONVERT(varchar,commodity_name_desc)  AS[text()] FROM (SELECT a.commodity_name_desc from open_cover_commodity_master a,commoditymaster b where a.proposal_no=? and b.BRANCH_CODE=? and a.amend_id=(select max(amend_id) from open_cover_commodity_master where proposal_no=?) and a.status='Y'  and b.commodity_id=a.commodity_id and  b.commodity_id=a.commodity_id and b.amend_id= (select max(amend_id) from commoditymaster  where commodity_id=a.commodity_id and BRANCH_CODE=?) ) commodity_name_desc FOR XML PATH('')), 1, 2, '')
getDebitDetails=select category_detail_id,detail_name from constant_detail where category_id=? and branch_code=?
getInstallmentDetails=select category_detail_id,detail_name from constant_detail where category_id=? and branch_code=?
getCommission=SELECT ISNULL(A.COMMISSION,0) FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
getNoteNo=SELECT A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=A.PROPOSAL_NO)
getDepositInfo=SELECT A.AMEND_ID,(SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID=139 AND CATEGORY_DETAIL_ID=A.DEPOSIT_TYPE AND BRANCH_CODE=A.BRANCH_CODE) DEPOSIT_TYPE,(SELECT DETAIL_NAME FROM CONSTANT_DETAIL WHERE CATEGORY_ID=140 AND CATEGORY_DETAIL_ID=A.INSTALLMENT_TYPE AND BRANCH_CODE=A.BRANCH_CODE) INSTALLMENT_TYPE,A.DEPOSIT_AMOUNT,A.ISSUANCE_FEE_DEBIT,A.DEBIT_NOTE_NO, A.CREDIT_NOTE_NO,TO_CHAR(A.DEBIT_NOTE_DATE,'DD/MM/YYYY') DEBIT_NOTE_DATE,TO_CHAR(A.CREDIT_NOTE_DATE,'DD/MM/YYYY') CREDIT_NOTE_DATE,A.EXISTING_DEPOSIT_YN FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO=? AND A.DEPOSIT_PREMIUM_YN='Y' ORDER BY A.AMEND_ID
getOpenCoverPolicyInfo=SELECT BM.BRANCH_CODE,BM.BRANCH_NAME,ISNULL(BM.ORIGINATION_COUNTRY_ID,0) ORIGINATION_COUNTRY_ID,BM.CURRENCY_ABBREVIATION,ISNULL(BM.DECIMAL_PLACES,0) DECIMAL_PLACES,BM.HEADER_IMG,BM.FOOTER_IMG,BM.SIGN_IMG,BM.STAMP,BM.CURRENCY_NAME,BM.CURRENCY_ABBREVIATION,ISNULL(BM.CURRENCY_ACRONYM,' ') CURRENCY_ACRONYM,BM.CURRENCY_DECIMAL_NAME,BM.CURRENCY_DECIMAL_DIGIT,BM.ADDRESS1,BM.REMARKS,OCM.DEBIT_NOTE_NO,OCM.CREDIT_NOTE_NO,TO_CHAR(OCM.DEBIT_NOTE_DATE,'DD/MM/YYYY') DEBIT_NOTE_DATE,TO_CHAR(OCM.CREDIT_NOTE_DATE,'DD/MM/YYYY') CREDIT_NOTE_DATE, OCPM.OPEN_COVER_NO,PM.PRODUCT_NAME,UPPER(PI.TITLE+' '+PI.FIRST_NAME) CUST_FIRST_NAME,TO_CHAR(OCPM.INCEPTION_DATE,'DD/MM/YYYY') INCEPTION_DATE,TO_CHAR(OCPM.EXPIRY_DATE,'DD/MM/YYYY') EXPIRY_DATE,ISNULL(OCM.COMMISSION,0) COMMISSION, ROUND(ISNULL(OCM.DEPOSIT_AMOUNT,0),ISNULL(CM.RFACTOR,0)) DEPOSIT_AMOUNT,OCM.DEBIT_NOTE_NAME, ROUND((ISNULL(OCM.COMMISSION,0)*ISNULL(OCM.DEPOSIT_AMOUNT,0)/100),ISNULL(CM.RFACTOR,0)) COMMISSION_AMOUNT, ISNULL(LM.CORE_LOGIN_ID,LM.LOGIN_ID) CORE_LOGIN_ID,(SELECT UPPER(DETAIL_NAME) FROM CONSTANT_DETAIL WHERE CATEGORY_ID=139 AND CATEGORY_DETAIL_ID=OCM.DEPOSIT_TYPE AND BRANCH_CODE=OCM.BRANCH_CODE) DEPOSIT_TYPE,ROUND(ISNULL(OCM.ISSUANCE_FEE_DEBIT,0),ISNULL(CM.RFACTOR,0)) ISSUANCE_FEE_DEBIT,OCM.MIN_PREMIUM_ISSUANCE_FEE,PI.CUSTOMER_ID,PI.POBOX CUST_POBOX,UPPER(PI.COMPANY_NAME) CUST_COMPANY,UPPER(PI.LAST_NAME) CUST_LAST_NAME,CM.CURRENCY_ID,CM.SUB_CURRENCY, UPPER(PI.ADDRESS1) CUST_ADDR1,UPPER(PI.ADDRESS2) CUST_ADDR2,PI.TELEPHONE CUST_TEL,UPPER(PI.COUNTRY) CUST_COUNTRY,UPPER(ISNULL(PI.CITY,PI.EMIRATE)) CUST_CITY,PI.CUST_AR_NO,(SELECT CUST_AR_NO FROM PERSONAL_INFO WHERE CUSTOMER_ID=BCM.CUSTOMER_ID)BROKER_AR_NO,BCM.CONTACT_PERSON,UPPER(BCM.ADDRESS1) BROKER_ADDR1,UPPER(BCM.ADDRESS2) BROKER_ADDR2,UPPER(BCM.CITY) BROKER_CITY,UPPER(BCM.COUNTRY) BROKER_COUNTRY,BCM.PHONE BROKER_PHONE,BCM.POBOX BROKER_POBOX,UPPER(ISNULL(BCM.CITY,BCM.EMIRATE)) BROKER_CITY,UPPER(BCM.COMPANY_NAME) BROKER_COMPANY,ROUND((ISNULL(OCM.DEPOSIT_AMOUNT,0)+ISNULL(OCM.ISSUANCE_FEE_DEBIT,0)),ISNULL(CM.RFACTOR,0)) NET_AMOUNT,OCM.MIN_PREMIUM_ISSUANCE_FEE ISSUANCE_FEE,OCM.TYPE OPEN_COVER_TYPE,OCM.BROKER_ID FROM BRANCH_MASTER BM, OPEN_COVER_POSITION_MASTER OCPM, PRODUCT_MASTER PM, OPEN_COVER_MASTER OCM,LOGIN_MASTER LM,PERSONAL_INFO PI,CURRENCY_MASTER CM, BROKER_COMPANY_MASTER BCM WHERE BM.BRANCH_CODE=OCM.BRANCH_CODE AND OCPM.OPEN_COVER_NO=? AND PM.PRODUCT_ID=OCM.PRODUCT_ID AND OCM.PROPOSAL_NO=OCPM.PROPOSAL_NO AND LM.LOGIN_ID=? AND PI.CUSTOMER_ID=OCM.CUSTOMER_ID AND OCM.AMEND_ID=? AND PM.BRANCH_CODE=BM.BRANCH_CODE AND OCPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER WHERE OPEN_COVER_NO=OCPM.OPEN_COVER_NO) AND CM.CURRENCY_ID=1 AND BCM.AGENCY_CODE=(SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID=OCM.BROKER_ID) AND CM.COUNTRY_ID=BM.ORIGINATION_COUNTRY_ID
getOpenCoverCommodityInfo=SELECT OCCM.COMMODITY_ID,UPPER(OCCM.COMMODITY_NAME_DESC) COMMODITY_NAME_DESC FROM OPEN_COVER_COMMODITY_MASTER OCCM, OPEN_COVER_POSITION_MASTER OCPM WHERE OCCM.PROPOSAL_NO=OCPM.PROPOSAL_NO AND OCCM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_COMMODITY_MASTER WHERE PROPOSAL_NO=OCCM.PROPOSAL_NO) AND OCPM.OPEN_COVER_NO=? ORDER BY OCCM.COMMODITY_ID
updateDepositInfo=SELECT ISNULL(A.RFACTOR,0), B.ISSUANCE_FEE, B.MIN_PREMIUM_ISSUANCE_FEE,B.DEBIT_NOTE_NO,B.CREDIT_NOTE_NO,isnull(B.COMMISSION,0),B.Type,B.Deposit_Amount,isnull(B.VAT_TAX_PERCENT,0),  (select COMMISSION_VAT_YN from broker_company_master where agency_code =(select agency_code from login_master where login_id=B.BROKER_ID )) COMMISSION_VAT_YN FROM CURRENCY_MASTER A, OPEN_COVER_MASTER B, BRANCH_MASTER C WHERE A.CURRENCY_ID=1 AND A.COUNTRY_ID=C.ORIGINATION_COUNTRY_ID AND C.BRANCH_CODE=B.BRANCH_CODE AND B.PROPOSAL_NO=? AND B.AMEND_ID=(SELECT MAX(AMEND_ID)FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO=B.PROPOSAL_NO)
updateDepositInfo1=UPDATE OPEN_COVER_MASTER  SET DEPOSIT_PREMIUM_YN=?,DEPOSIT_TYPE=?,INSTALLMENT_TYPE=?,DEPOSIT_AMOUNT= ROUND(?,{0}),DEBIT_NOTE_NO=?{1},CREDIT_NOTE_NO=?{2},DEBIT_NOTE_NAME=?,ISSUANCE_FEE_DEBIT=(SELECT CASE WHEN ({3}*{4})/100<={5} THEN {6} ELSE ROUND(({7}*{8})/100,{9}) END FROM DUAL),REMARKS=?,EXISTING_DEPOSIT_YN=?,MARINE_PREMIUM=CONVERT(numeric(16,2), CAST(? AS FLOAT)), WAR_PREMIUM=CONVERT(numeric(16,2), CAST(? AS FLOAT)) ,COMMISSION_AMOUNT=CONVERT(numeric(16,2), CAST(? AS FLOAT)),VAT_TAX_AMT=CONVERT(numeric(16,2), CAST(? AS FLOAT)),VAT_COMMISSION=CONVERT(numeric(16,2), CAST(? AS FLOAT)),VAT_COMMISSION_PERCENT=? WHERE PROPOSAL_NO=?
getDeductible=SELECT OCCM.START_RANGE,OCCM.END_RANGE,OCCM.EXCESS_AMOUNT,OCCM.CURRENCY_NAME,OCCM.EXCESS_PERCENT FROM OPEN_COVER_DEDUCTIBLE_MASTER OCCM WHERE OCCM.STATUS='Y' AND OCCM.OPEN_COVER_PROPOSAL_NO=? AND OCCM.effective_date <= GETDATE() AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_DEDUCTIBLE_MASTER WHERE OPEN_COVER_PROPOSAL_NO=OCCM.OPEN_COVER_PROPOSAL_NO AND effective_date <= GETDATE() )
GET_FREETEXT1=select free_text_id,ISNULL(free_text_description,'9999') from open_cover_free_text where proposal_no=? and cover_id=? and amend_id=(select max(amend_id) from open_cover_free_text where proposal_no=? and cover_id=?)
GET_FREETEXT2=select free_text_id,ISNULL(free_text_description,'9999') from open_cover_free_text where proposal_no=? and cover_id=? and amend_id=(select max(amend_id) from open_cover_free_text where proposal_no=? and cover_id=? and type='F')
showCoveragesWithMode=select a.amend_id,a.cover_id,a.sea_options,b.cover_name,a.mode_transport_id, ( C.TRANSPORT_DESCRIPTION + ' - ' + b.cover_name ) DESCRIPTION from open_cover_sub_detail a,cover_master b, mode_of_transport C where a.proposal_no=? and a.amend_id=(select max(amend_id) from open_cover_sub_detail where proposal_no=?)and b.cover_id=a.cover_id and b.BRANCH_CODE=? AND C.MODE_TRANSPORT_ID=A.MODE_TRANSPORT_ID and c.BRANCH_CODE=B.BRANCH_CODE order by a.mode_transport_id
getOpenCoverAdditionalInsured=SELECT CASE WHEN NULLIF(A.ADDITIONAL_INSURED,'') IS NULL THEN convert(varchar,A.CUSTOMER_ID) ELSE convert(varchar,A.CUSTOMER_ID)+','+A.ADDITIONAL_INSURED END FROM OPEN_COVER_MASTER A WHERE A.PROPOSAL_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO\=A.PROPOSAL_NO)
COMMAMED=select ISNULL(max(amend_id)+1,'0') from open_cover_commodity_master where proposal_no=?
OCSUBDET=select ISNULL(max(amend_id)+1,'0') from open_cover_sub_detail where proposal_no\=? 
AMDOCD=select ISNULL(max(amend_id)+1,'0') from open_cover_detail where proposal_no=?
AMDOCCD=select ISNULL(max(amend_id)+1,'0') from open_cover_commodity_detail where proposal_no={0}
AMDOCSP=select NULLIF(max(amend_id)+1,'0') from open_cover_share_percentage where proposal_no=?
#27 05
getLapsedOpenCoversSearch=select ISNULL(open_cover_no,'0') from LOGIN_USER_DETAILS where login_id=? and  product_id='11'
#getLapsedOpenCoversSearch1=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE {0}  AND ocm.status = ''Y'' AND ocpm.status IN (''P'', ''R'') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = ''Y'' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER op WHERE ISNULL(op.ORIGINAL_POLICY_NO,op.OPEN_COVER_NO )=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) and op.status=''P'' ) AND (CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103) OR ocpm.admin_status = ''N'') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch1=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocpm.open_cover_no in(?)  AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER op WHERE ISNULL(op.ORIGINAL_POLICY_NO,op.OPEN_COVER_NO )=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) and op.status='P' ) AND (CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103) OR ocpm.admin_status = 'N') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch11=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.broker_id in (?)  AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER op WHERE ISNULL(op.ORIGINAL_POLICY_NO,op.OPEN_COVER_NO )=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) and op.status='P' ) AND (CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103) OR ocpm.admin_status = 'N') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
#getLapsedOpenCoversSearch2=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years, isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.status = ''Y'' And ocm.broker_id not in  (select login_id from login_master lm where ocm.broker_id=lm.login_id and agency_code in  (Select BROKER_CODE from login_rsauser_details lud where lud.LOGIN_ID=''{0}'' and product_id=11)) AND ocpm.status IN (''P'', ''R'') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = ''Y'' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like ''%{1}%'' or  (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like ''%{2}%'') and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER op WHERE ISNULL(op.ORIGINAL_POLICY_NO,op.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) and op.status=''P'' ) AND  (CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103) OR ocpm.admin_status = ''N'') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch2=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years, isnull (nullif(pi.COMPANY_NAME,''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.status = 'Y' And ocm.broker_id not in  (select login_id from login_master lm where ocm.broker_id=lm.login_id and agency_code in  (Select BROKER_CODE from login_rsauser_details lud where lud.LOGIN_ID=? and product_id=11)) AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%{1}%' or  (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%{2}%') and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER op WHERE ISNULL(op.ORIGINAL_POLICY_NO,op.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) and op.status='P' ) AND  (CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103) OR ocpm.admin_status = 'N') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
#getLapsedOpenCoversSearch3=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE {0} AND ocm.status = ''Y'' AND ocpm.status IN (''P'', ''R'') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = ''Y'' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like ''%{1}%'' or  (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like ''%{2}%'') and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  op WHERE ISNULL(op.ORIGINAL_POLICY_NO,op.OPEN_COVER_NO )=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) and op.status=''P'' ) AND ((CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103)) OR ocpm.admin_status = ''N'') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch3=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocpm.open_cover_no in(?) AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%?%' or  (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%?%') and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  op WHERE ISNULL(op.ORIGINAL_POLICY_NO,op.OPEN_COVER_NO )=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) and op.status='P' ) AND ((CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103)) OR ocpm.admin_status = 'N') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch31=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.broker_id in (?) AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%?%' or  (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%?%') and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  op WHERE ISNULL(op.ORIGINAL_POLICY_NO,op.OPEN_COVER_NO )=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) and op.status='P' ) AND ((CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103)) OR ocpm.admin_status = 'N') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
#getLapsedOpenCoversSearch4=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.status = ''Y'' And ocm.broker_id not in (select lm.login_id from login_master lm where ocm.broker_id=lm.login_id and agency_code in  (Select BROKER_CODE from login_rsauser_details lud where lud.LOGIN_ID='{0}' and product_id=11)) AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = ''Y'' and  (ocpm.open_cover_no like ''%{1}%'') and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO)) AND ((CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103)) OR ocpm.admin_status = ''N'') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch4=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.status = 'Y' And ocm.broker_id not in (select lm.login_id from login_master lm where ocm.broker_id=lm.login_id and agency_code in  (Select BROKER_CODE from login_rsauser_details lud where lud.LOGIN_ID=? and product_id=11)) AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and  (ocpm.open_cover_no like '%?%') and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO)) AND ((CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103)) OR ocpm.admin_status = 'N') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
#getLapsedOpenCoversSearch5=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE {0} AND ocm.status = ''Y'' AND ocpm.status IN (''P'', ''R'') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = ''Y'' and  (ocpm.open_cover_no like ''%{1}%'') and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO)) AND (CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103) OR ocpm.admin_status = ''N'') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch5=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocpm.open_cover_no in(?) AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and  (ocpm.open_cover_no like '%?%') and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO)) AND (CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103) OR ocpm.admin_status = 'N') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch51=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.broker_id in(?) AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and  (ocpm.open_cover_no like '%?%') and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO)) AND (CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103) OR ocpm.admin_status = 'N') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
#getLapsedOpenCoversSearch6=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.status = ''Y'' And ocm.broker_id (select lm.login_id from login_master lm where ocm.broker_id=lm.login_id and agency_code in  (Select BROKER_CODE from login_rsauser_details lud where lud.LOGIN_ID='{0}' and product_id=11)) AND ocpm.status IN (''P'', ''R'') AND CONVERT(VARCHAR,ocpm.inception_date,103) = ''{1}'' AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = ''Y'' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO)) AND ((CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103)) OR ocpm.admin_status = ''N'') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch6=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.status = 'Y' And ocm.broker_id (select lm.login_id from login_master lm where ocm.broker_id=lm.login_id and agency_code in  (Select BROKER_CODE from login_rsauser_details lud where lud.LOGIN_ID=? and product_id=11)) AND ocpm.status IN ('P', 'R') AND CONVERT(VARCHAR,ocpm.inception_date,103) = ? AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO)) AND ((CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103)) OR ocpm.admin_status = 'N') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
#getLapsedOpenCoversSearch7=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years, isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE {0}  AND ocm.status = ''Y'' AND ocpm.status IN (''P'', ''R'') AND CONVERT (VARCHAR,ocpm.inception_date, 103) = ''{1}'' AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = ''Y'' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO)) AND ((CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103)) OR ocpm.admin_status = ''N'') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch7=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years, isnull (nullif(pi.COMPANY_NAME,''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocpm.open_cover_no in(?)  AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND CONVERT (VARCHAR,ocpm.inception_date, 103) = ? AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO)) AND ((CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103)) OR ocpm.admin_status = 'N') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getLapsedOpenCoversSearch71=SELECT DISTINCT ISNULL(ocpm.original_policy_no,ocpm.open_cover_no), ocm.customer_id,DATEPART(DD,ocpm.inception_date) AS days, DATEPART(MM,ocpm.inception_date)   AS months, DATEPART(YYYY,ocpm.inception_date) AS years, DATEPART(DD,ocpm.EXPIRY_DATE) AS days, DATEPART(MM,ocpm.EXPIRY_DATE)   AS months, DATEPART(YYYY,ocpm.Expiry_date) AS years, isnull (nullif(pi.COMPANY_NAME,''), pi.first_name), ocm.broker_id, pi.company_name, ocpm.effective_date, ocpm.proposal_no, ocm.broker_user_id, ocm.MISSIPPI_OPENCOVER_NO, ocpm.admin_status, DATEDIFF(DAY,SYSDATETIME(),OCPM.EXPIRY_DATE) expiry_days,ocm.TYPE FROM open_cover_position_master ocpm, open_cover_master ocm, personal_info pi WHERE ocm.broker_id in (?)  AND ocm.status = 'Y' AND ocpm.status IN ('P', 'R') AND CONVERT (VARCHAR,ocpm.inception_date, 103) = ? AND ocm.proposal_no = ocpm.proposal_no AND pi.customer_id = ocm.customer_id AND pi.status = 'Y' and ocm.amend_id=(Select Max(Amend_id) from open_cover_master oc where oc.Proposal_no=ocm.Proposal_no) and OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO)) AND ((CONVERT(DATE,ocpm.expiry_date,103) <= CONVERT(DATE,SYSDATETIME(),103)) OR ocpm.admin_status = 'N') ORDER BY ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) DESC
getCreatedOpenCoversSearch=ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0)
getCreatedOpenCoversSearch1=select ISNULL(open_cover_no,'0') from LOGIN_USER_DETAILS where login_id=? and  product_id='11'
#getCreatedOpenCoversSearch2=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk, ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.customer_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),{0} , ISNULL(HAULIER_TYPE,''V'') HAULIER_TYPE ,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where {1} and nullif(MISSIPPI_OPENCOVER_NO,'''') is not null and ocm.status=''Y'' and ocpm.status=''P'' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status=''Y'' and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'''') is null or ocpm.admin_status=''Y'') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch2=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk, ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.customer_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0) , ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE ,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) in(?) AND OCM.TYPE=? AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS='P') and nullif(MISSIPPI_OPENCOVER_NO,'') is not null and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch21=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk, ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.customer_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0) , ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE ,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.broker_id in (?) AND OCM.TYPE=? AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS='P') and nullif(MISSIPPI_OPENCOVER_NO,'') is not null and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
#getCreatedOpenCoversSearch3=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),{0}, ISNULL(HAULIER_TYPE,''V'') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.status=''Y'' and ocpm.status=''P'' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status=''Y'' and (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like ''%{1}%'' or  (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like ''%{2}%'') and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'''') is null or ocpm.admin_status=''Y'') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch3=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%?%' or  (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%?%') and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
#getCreatedOpenCoversSearch3=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%?%' or  (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%?%') and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
#getCreatedOpenCoversSearch4=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),{0}, ISNULL(HAULIER_TYPE,''V'') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where {1} and ocm.status=''Y'' and ocpm.status=''P'' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status=''Y'' and (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like ''%{2}%'' or  (lower(LTRIM(RTRIM(PI.COMPANY_NAME)))  like ''%{3}%'') and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'''') is null or ocpm.admin_status=''Y'') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch4=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) in(?) AND OCM.TYPE=?  AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS='P') and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%?%' or  (lower(LTRIM(RTRIM(PI.COMPANY_NAME)))  like '%?%') and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch41=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.broker_id in (?) AND OCM.TYPE=?  AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS='P') and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and (lower(LTRIM(RTRIM(PI.COMPANY_NAME))) like '%?%' or  (lower(LTRIM(RTRIM(PI.COMPANY_NAME)))  like '%?%') and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
#getCreatedOpenCoversSearch5=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.customer_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),{0}, ISNULL(HAULIER_TYPE,''V'') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1  from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.status=''Y'' and ocpm.status=''P'' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status=''Y'' and (ocpm.open_cover_no like ''%{1}%'') AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER op WHERE ISNULL(op.ORIGINAL_POLICY_NO,op.OPEN_COVER_NO )=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS=''P'')  and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'''') is null or ocpm.admin_status=''Y'') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch5=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.customer_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1  from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and (ocpm.open_cover_no like '%?%') AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER op WHERE ISNULL(op.ORIGINAL_POLICY_NO,op.OPEN_COVER_NO )=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS='P')  and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
#getCreatedOpenCoversSearch6=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.customer_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),{0}, ISNULL(HAULIER_TYPE,''V'') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where {1} and ocm.status=''Y'' and ocpm.status=''P'' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status=''Y'' and (ocpm.open_cover_no like ''%{2}%'') and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'''') is null or ocpm.admin_status=''Y'') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch6=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.customer_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) in(?) AND OCM.TYPE=?  AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS='P') and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and (ocpm.open_cover_no like '%?%') and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch61=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.customer_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.broker_id in (?) AND OCM.TYPE=?  AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS='P') and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and (ocpm.open_cover_no like '%?%') and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
#getCreatedOpenCoversSearch7=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),{0}, ISNULL(HAULIER_TYPE,''V'') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.status=''Y'' and ocpm.status=''P'' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status=''Y'' and CONVERT (VARCHAR,ocpm.inception_date, 103)=''{1}'' and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'''') is null or ocpm.admin_status=''Y'') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch7=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and CONVERT (VARCHAR,ocpm.inception_date, 103)=? and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
#getCreatedOpenCoversSearch8=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),{0}, ISNULL(HAULIER_TYPE,''V'') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where {1} and ocm.status\=''Y'' and ocpm.status\=''P'' and ocm.proposal_no\=ocpm.proposal_no and pi.customer_id\=ocm.customer_id and pi.status\=''Y'' and CONVERT (VARCHAR,ocpm.inception_date, 103)\=''{2}'' and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no \= ocms.proposal_no and ocm.proposal_no\=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >\= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'''') is null or ocpm.admin_status\=''Y'') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch8=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) in(?) AND OCM.TYPE=?  AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS='P') and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and CONVERT (VARCHAR,ocpm.inception_date, 103)=? and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch81=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.broker_id in (?) AND OCM.TYPE=?  AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS='P') and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and CONVERT (VARCHAR,ocpm.inception_date, 103)=? and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc 
#getCreatedOpenCoversSearch9=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),{0}, ISNULL(HAULIER_TYPE,''V'') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where {1} and ocm.status=''Y'' and ocpm.status=''P'' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status=''Y'' and CONVERT (VARCHAR,ocpm.inception_date, 103)=''{2}'' and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'''') is null or ocpm.admin_status=''Y'') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch9=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO) in(?) AND OCM.TYPE=?  AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS='P') and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and CONVERT (VARCHAR,ocpm.inception_date, 103)=? and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
getCreatedOpenCoversSearch91=select  distinct ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no),ocm.customer_id,DATEPART(DD,ocpm.inception_date) as days,DATEPART(MM,ocpm.inception_date)  as months,DATEPART(YYYY,ocpm.inception_date)  as years,DATEPART(DD,ocpm.EXPIRY_DATE) as days,DATEPART(MM,ocpm.EXPIRY_DATE)  as months,DATEPART(YYYY,ocpm.EXPIRY_DATE)  as years,isnull (nullif(pi.COMPANY_NAME,''), pi.first_name),ocm.broker_id,pi.company_name,ocpm.effective_date,ocpm.proposal_no,ocm.broker_user_id,ocm.MISSIPPI_OPENCOVER_NO,ISNULL(OCPM.ORIGINAL_POLICY_NO, OCPM.OPEN_COVER_NO),ISNULL(CONVERT(numeric(20,2), CAST(CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(UTILIZED_AMOUNT AS FLOAT)), 0), ISNULL(HAULIER_TYPE,'V') HAULIER_TYPE,ROW_NUMBER() over( order by ocm.proposal_no,open_cover_no) rnk1 from open_cover_position_master ocpm,open_cover_master ocm,personal_info pi where ocm.broker_id in (?) AND OCM.TYPE=?  AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER  WHERE ISNULL(OPEN_COVER_POSITION_MASTER.ORIGINAL_POLICY_NO,OPEN_COVER_POSITION_MASTER.OPEN_COVER_NO)=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO) AND STATUS='P') and ocm.status='Y' and ocpm.status='P' and ocm.proposal_no=ocpm.proposal_no and pi.customer_id=ocm.customer_id and pi.status='Y' and CONVERT (VARCHAR,ocpm.inception_date, 103)=? and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no = ocms.proposal_no and ocm.proposal_no=ocms.proposal_no and (DATEADD(DAY,30,CONVERT(DATE,ocpm.expiry_date,103)) >= CONVERT(DATE,SYSDATETIME(),103)) and (NULLIF(ocpm.admin_status,'') is null or ocpm.admin_status='Y') group by ocms.proposal_no) order by rnk desc
getYetToStratMOC=select ocpms.open_cover_no from open_cover_master ocms,open_cover_position_master ocpms where ocpms.proposal_no=ocms.proposal_no and convert(date,ocpms.inception_date,103) > getDate() and ocpms.status=''P'' and (ocpms.admin_status is null or ocpms.admin_status=''Y'') and ocpms.open_cover_no in({0}) group by ocpms.open_cover_no
GET_OPENCUSTOMER_INFO = SELECT UPPER(NULLIF(isnull(b.FIRST_NAME,''),b.COMPANY_NAME)) FIRST_NAME, EMAIL, POBOX, MOBILE, EMIRATE CITY_NAME,EMIRATE, B.CUSTOMER_ID, MISSIPPI_CUSTOMER_CODE, TITLE, ADDRESS1, ADDRESS2,CUST_AR_NO, REPLACE ( 'P.O.BOX.' + ISNULL (POBOX, ' ') + ISNULL (ADDRESS1, ' ') + ISNULL (ADDRESS2, ' ') + ISNULL (EMIRATE , ' '), 'select', '') ADDRESS,cust_name,VAT_REG_NO ,CUST_NAME_ARABIC FROM OPEN_COVER_POSITION_MASTER A, PERSONAL_INFO B, OPEN_COVER_MASTER C WHERE A.OPEN_COVER_NO\=? AND B.CUSTOMER_ID \= C.CUSTOMER_ID AND C.PROPOSAL_NO \= A.PROPOSAL_NO AND C.AMEND_ID\=(SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO \= A.PROPOSAL_NO)

##Travel Insurance Endorsement
GET_TRAVEL_DETAILS_CREDIT_DEBIT = SELECT PREMIUM,COMMISSION,AC_EXECUTIVE_ID,LOGIN_ID,CUSTOMER_ID FROM HOME_POSITION_MASTER WHERE QUOTE_NO=?
UPD_TRAVEL_CREDIT_ID = UPDATE HOME_POSITION_MASTER SET CREDIT_TO=?,DEBIT_TO=?,CREDIT_TO_ID=?,DEBIT_TO_ID=? WHERE QUOTE_NO=?
##OTHERS OPTION IN OPENCOVER
GET_OPTIONAL_COVER_NOT_SELECTED=select CLAUSES_ID rsacode,clauses_description from clauses_master where OPTIONAL_TYPE\='O' and branch_code\=(select BELONGING_BRANCH from branch_master where BRANCH_CODE\=?) and cover_id\='99' and CLAUSES_ID not in (select FREE_TEXT_ID from OPEN_COVER_FREE_TEXT where PROPOSAL_NO\=? and amend_id\=(select max(amend_id) from OPEN_COVER_FREE_TEXT where PROPOSAL_NO\=? and cover_id  in('0') and type\='O')  and cover_id in('0') and type\='O') 
GET_OPTIONAL_COVER_SELECTED=select FREE_TEXT_ID rsacode,FREE_TEXT_DESCRIPTION clauses_description,CONVERT(VARCHAR(10), EFFECTIVE_DATE, 105) as EFFECTIVE_DATE from OPEN_COVER_FREE_TEXT where PROPOSAL_NO=? and type='O' and amend_id=(select max(amend_id) from OPEN_COVER_FREE_TEXT where PROPOSAL_NO=? and COVER_ID=? and type='O') and COVER_ID=?
OPTIONAL_COVER_INSERT=insert into OPEN_COVER_FREE_TEXT(PROPOSAL_NO,AMEND_ID,MODE_OF_TRANSPORT,COVER_ID,EXTRA_COVER_ID,FREE_TEXT_ID,FREE_TEXT_DESCRIPTION,EFFECTIVE_DATE,STATUS,BRANCH_CODE,type) values(?,?,(select distinct(MODE_TRANSPORT_ID) from cover_master where COVER_ID\=?),?,?,?,?,convert(date,?,103),?,?,?)
GET_OPTIONAL_COVER_NOT_SELECTED_0=select CLAUSES_ID rsacode,clauses_description from clauses_master where OPTIONAL_TYPE\='O' and branch_code\=(select BELONGING_BRANCH from branch_master where BRANCH_CODE\=?) and cover_id\='99' and CLAUSES_ID not in (select FREE_TEXT_ID from OPEN_COVER_FREE_TEXT where PROPOSAL_NO\=? and amend_id\=(select max(amend_id) from OPEN_COVER_FREE_TEXT where PROPOSAL_NO\=? and cover_id\=? and type\='O') and cover_id\=? and type\='O')
GET_OPTIONAL_COVER_SELECTED_0=select FREE_TEXT_ID rsacode,FREE_TEXT_DESCRIPTION clauses_description,CONVERT(VARCHAR(10), EFFECTIVE_DATE, 105) as EFFECTIVE_DATE from OPEN_COVER_FREE_TEXT where PROPOSAL_NO=? and type='O' and amend_id=(select max(amend_id) from OPEN_COVER_FREE_TEXT where PROPOSAL_NO=? and COVER_ID=?  AND cover_id not  IN ('0') and type='O') and COVER_ID=?  AND cover_id not IN ('0')
#LC FILE UPLOAD
#GET_LC_UPLOAD_DETAILS =select pi.First_name, pm.policy_no,ocbm.BANK_NAME,mpd.LC_NUMBER from position_master pm, personal_info pi, marine_policy_details mpd, open_cover_bank_master ocbm where pm.policy_no\=? and  pm.customer_id\=pi.customer_id and mpd.QUOTE_NO\=pm.quote_no and mpd.BANK_NAME\=ocbm.BANK_ID and ocbm.amend_id\=(select max(amend_id) from open_cover_bank_master ocbm1 where ocbm1.bank_id\=ocbm.bank_id)
GET_LC_UPLOAD_DETAILS = select pi.First_name, pm.policy_no from position_master pm, personal_info pi where pm.policy_no=? and  pm.customer_id=pi.customer_id
GET_LC_UPLOAD_POLICY_DTLS = select ocbm.bank_name,mpd.lc_number,convert(date,mpd.LC_DATE,103) LC_DATE,mpd.BL_AWB_NO,convert(date,mpd.BL_AWB_DATE,103) BL_AWB_DATE,convert(date,mpd.SAILING_DATE,103) SAILING_DATE  from marine_policy_details mpd, open_cover_bank_master ocbm,position_master pm where pm.policy_no=? and mpd.QUOTE_NO=pm.quote_no and mpd.BANK_NAME=ocbm.BANK_ID and ocbm.amend_id=(select max(amend_id) from open_cover_bank_master ocbm1 where ocbm1.bank_id=ocbm.bank_id)
GET_LC_UPLOAD_POL_DTLS =select mrd.invoice_number, convert(date,mrd.invoice_date,103) invoice_date,mrd.DESCRIPTION from marine_result_details mrd, position_master pm where pm.policy_no\=? and mrd.application_no\=pm.application_no
GET_DOCUMENTS_LIST = select file_name,original_file,remarks from lc_file_upload_dtls where POLICY_NO=? order by upload_id
LC_FILE_INSERT = insert into LC_FILE_UPLOAD_DTLS(POLICY_NO,FILE_NAME,LOGIN_ID,ORIGINAL_FILE,REMARKS,STATUS,UPLOAD_ID) values(?,?,?,?,?,?,?)
GET_LC_FILE_LIST = select UPLOAD_ID,ORIGINAL_FILE,FILE_NAME,remarks from LC_FILE_UPLOAD_DTLS where POLICY_NO=? order by upload_id
LC_FILE_DELETE = delete from LC_FILE_UPLOAD_DTLS where UPLOAD_ID=?
saveOptionalCovers=select ISNULL(max(amend_id)+1,0) from OPEN_COVER_FREE_TEXT where PROPOSAL_NO\=? and cover_id\=?
getBrokersList=SELECT l.login_id, b.company_name, b.agency_code, b.AC_EXECUTIVE_ID FROM login_master l, BROKER_COMPANY_MASTER b WHERE b.agency_code \= l.agency_code AND l.login_id NOT IN ('NON', 'NONE') AND l.status IN ('Y','T') AND l.login_id IS NOT NULL AND b.agency_code IS NOT NULL AND b.branch_code \= ? AND b.agency_code not IN (SELECT DISTINCT broker_code FROM LOGIN_RSAUSER_DETAILS WHERE login_id \= ?  AND (START_DATE) <\=GETDATE() AND (END_DATE) >\= GETDATE() AND (amend_id + broker_code) IN (SELECT MAX (amend_id) + broker_code FROM LOGIN_RSAUSER_DETAILS WHERE login_id \=? AND (START_DATE) <\= GETDATE() AND (END_DATE) >\=GETDATE() GROUP BY broker_code) AND status \= 'Y') ORDER BY b.company_name
OCPPWISMIDDLE=select count(*) from  open_cover_position_master where  convert(date,?,103) between convert(date,INCEPTION_DATE,103) and convert(date, EXPIRY_DATE ,103) and  proposal_no=?
#Policy Report
##GET_POLICY_REPORT=SELECT INCEPTION_DATE,OPEN_COVER_NO,CUSTOMER_NAME,TOTAL_POLICY FROM SCHEDULE_GENERATION('Count',?,?,?,?)
GET_POLICY_REPORT=SELECT INCEPTION_DATE,OPEN_COVER_NO,CUSTOMER_NAME,TOTAL_POLICY FROM SCHEDULE_GENERATION('Count',?,'','',?,?,?,'','')

getPortfolioByDate1=select * from policy_report('','','','','',?,?)
getPortfolioByDate2=select * from policy_report(?,?,?,?,?,'','')
getUpdateEndtStatus=UPDATE   POSITION_MASTER SET STATUS \= 'D', PDF_BROKER_STATUS \= '999' WHERE POLICY_NO LIKE  (SELECT   ISNULL(original_policy_no,policy_no) FROM   POSITION_MASTER WHERE QUOTE_NO \= ?) + '%'
## For the Link in Open Cover Report
report.policy1=select * from reports(?,?,?,?,?,?,?)

#Declaration 
declaration.getcustomerId=SELECT FIRST_NAME + ISNULL(LAST_NAME,'') FROM PERSONAL_INFO WHERE CUSTOMER_ID IN( SELECT CUSTOMER_ID FROM OPEN_COVER_MASTER WHERE  MISSIPPI_OPENCOVER_NO\=? AND AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER WHERE MISSIPPI_OPENCOVER_NO\=?))
declaration.getDeclarationList=SELECT PM.POLICY_NO, PM.QUOTE_NO, PI.FIRST_NAME, PM.LOGIN_ID,MD.TOTAL_SUM_INSURED,(ISNULL (MD. PREMIUM, 0) + ISNULL (MD.EXCESS_PREMIUM, 0)) PREMIUM,(SELECT CASE WHEN UPPER (SETTLING_AGENT_NAME) = 'OTHERS' THEN MPD.SETTLING_AGENT_NAME ELSE SETTLING_AGENT_NAME END FROM SETTLING_AGENT_MASTER WHERE SETTLING_AGENT_ID=MPD.SETTLING_AGENT_ID AND BRANCH_CODE=?) SETTLING_AGENT_NAME, ( SELECT COUNT ( * ) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO AND PACKAGE_DESCRIPTION IS NULL AND AMEND_ID = ( SELECT MAX (AMEND_ID) FROM MARINE_RESULT_DETAILS WHERE APPLICATION_NO = MD.APPLICATION_NO)) PACKAGE_DESCRIPTION FROM POSITION_MASTER PM, PERSONAL_INFO PI,MARINE_DATA MD, MARINE_POLICY_DETAILS MPD WHERE PM.OPEN_COVER_NO = ?  AND PM.STATUS = 'P' AND PM.REMARKS IN ('Normal', 'Admin') AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND PM.EFFECTIVE_DATE > ( SELECT GETdate() FROM DUAL) AND PM.LOGIN_ID = ? AND PM.APPLICATION_ID = ISNULL(?,'1') AND PM.DISCOUNT_PREMIUM IS NULL AND (PM.CERTIFICATE_NO IS NULL AND PM.CERTIFICATE_DATE IS NULL) AND MD.APPLICATION_NO=PM.APPLICATION_NO AND MPD.QUOTE_NO=PM.QUOTE_NO and PM.POLICY_NO = ? ORDER BY PM.QUOTE_NO
declaration.getDeclarationList1=SELECT DISTINCT TR.TRANSACTION_ID, TR.TRANSACTION_DATE TRN_DATE, TR.USER_NAME, TR.FILE_NAME, TR.TOTAL_NO_OF_RECORDS, TR.UPLOADED_COUNT, TR.PENDING_COUNT FROM XL_TRANSACTION_DETAILS TR  WHERE TR.OPENCOVER_POLICY_NUMBER = ? AND TR.transaction_id IS NOT NULL  ORDER BY TR.transaction_id DESC
declaration.getDeclarationList2=SELECT A.QUOTE_NO, ISNULL(M.VAT_TAX_AMT,0) VAT_TAX_AMT ,ISNULL(M.VAT_TAX_PERCENT,0) VAT_TAX_PERCENT,ISNULL(M.POLICY_FEE,0) POLICY_FEE,ISNULL(nullif(B.COMPANY_NAME,''), B.FIRST_NAME) as FIRST_NAME ,Cast(M.TOTAL_SUM_INSURED as decimal(18,2)) as TOTAL_SUM_INSURED,Cast((ISNULL (M.PREMIUM, 0) + ISNULL (M.EXCESS_PREMIUM, 0) + ISNULL (M.GOVT_TAX, 0) +ISNULL (M.EMERGENCY_FUND, 0 )) as decimal(18,2)) as PREMIUM,( select count(*) from WEBSERVICE_MARINE_QUOTE  WHERE APPLICATION_NO \= M.APPLICATION_NO and TRANSACTION_ID is not null ) PACKAGE_DESCRIPTION ,( select TRANSACTION_ID from WEBSERVICE_MARINE_QUOTE  WHERE APPLICATION_NO \= M.APPLICATION_NO  ) TRANSACTION_ID FROM POSITION_MASTER A, PERSONAL_INFO B, MARINE_DATA M   WHERE A.LOGIN_ID \=? AND (A.FREIGHT_STATUS NOT IN ('F', 'B') OR A.FREIGHT_STATUS IS NULL) AND A.EFFECTIVE_DATE > \= getdate() AND A.STATUS  \= 'Y' AND (A.REMARKS IN  ('Normal', 'Admin') ) AND M.APPLICATION_NO  \= A.APPLICATION_NO AND ISNULL (M.ADMIN_REFERRAL_STATUS, 'N') NOT IN ('Y')      AND B.CUSTOMER_ID \= A.CUSTOMER_ID AND A.PRODUCT_ID \= ?  AND A.APPLICATION_ID \= ISNULL(nullif(?,''),'1') AND ISNULL(A.OPEN_COVER_NO,'0') like ISNULL(? +'%','0') ORDER BY A.QUOTE_NO desc 
declaration.getDeclarationList3=select distinct tran_id, convert(varchar(10),INCEPTION_DATE,103) INCEPTION_DATE,(select ISNULL( PI.FIRST_NAME, '')+' '+ISNULL(PI.LAST_NAME, '') FROM PERSONAL_INFO PI WHERE PI.CUSTOMER_ID=pm.CUSTOMER_ID AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO P WHERE P.CUSTOMER_ID=PI.CUSTOMER_ID)) CUSTOMER_NAME,CERTIFICATE_NO,count(*) NO_OF_RECORDS,Cast(sum(PREMIUM)as decimal(18,2)) as PREMIUM from POSITION_MASTER pm  where OPEN_COVER_NO=? and LOGIN_ID=? and CERTIFICATE_NO is not null and tran_id is not null  group by CERTIFICATE_NO,CUSTOMER_ID, convert(varchar(10),INCEPTION_DATE,103),tran_id
TRANID_SEQ=SELECT NEXT VALUE FOR TRANSACTION_NO
declaration.insertTransactionDetails=INSERT INTO XL_TRANSACTION_DETAILS (TRANSACTION_ID,TRANSACTION_DATE,USER_NAME,FILE_NAME,PATH,ACTIVE,MOVEMENT_DETAIL_ID,OPENCOVER_POLICY_NUMBER,TRANSACTION_DESCRIPTION,ISSUER) VALUES(?,GETDATE(),?,?,?,'Y',?,?,?,?)
declaration.checkProposal=UPDATE {0} SET VALIDATION_ERROR=VALIDATION_ERROR+'',BROKER CODE INVALID'' WHERE BROKER_CODE NOT IN ( SELECT OA_CODE FROM LOGIN_MASTER WHERE STATUS=''Y'' AND LOGIN_ID=''{1}'') AND TRANSACTION_ID=?
declaration.checkProposal1=UPDATE {0} SET VALIDATION_ERROR=VALIDATION_ERROR+'',OPEN COVER NO INVALID'' WHERE MOC_NUMBER NOT IN ( SELECT MISSIPPI_OPENCOVER_NO FROM OPEN_COVER_MASTER WHERE STATUS=''Y'' and broker_id =''{1}'') AND TRANSACTION_ID=?
declaration.updateOpenCoverDetail=UPDATE WEBSERVICE_MARINE_QUOTE_RAW SET VALIDATION_ERROR=VALIDATION_ERROR+',BROKER CODE INVALID' WHERE BROKER_CODE NOT IN ( SELECT AGENCY_CODE FROM BROKER_COMPANY_MASTER WHERE STATUS='Y' ) AND TRANSACTION_ID=?
declaration.updateREsponse=update WEBSERVICE_MARINE_QUOTE_RAW set RESPONSE_TIME=GETDATE() where transaction_id = ?
declaration.updateComm=update webservice_marine_commodity_rw   set RESPONSE_TIME\=GETDATE() where transaction_id \= ?

## Open Cover Copy Quote
openCopyquote.quoteNo=SELECT OCPM.PROPOSAL_NO PROPOSAL_NO,OCPM.OPEN_COVER_NO OPEN_COVER_NO, ISNULL (PI.FIRST_NAME,PI.COMPANY_NAME) FIRST_NAME FROM  OPEN_COVER_POSITION_MASTER OCPM ,OPEN_COVER_MASTER OCM ,PERSONAL_INFO PI WHERE OCPM.PROPOSAL_NO=?  AND OCPM.PROPOSAL_NO=OCM.PROPOSAL_NO AND PI.CUSTOMER_ID=OCM.CUSTOMER_ID AND OCM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER OC WHERE OC.PROPOSAL_NO=OCM.PROPOSAL_NO) AND OCPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER OCP WHERE OCP.PROPOSAL_NO=OCPM.PROPOSAL_NO)
openCopyquote.policyNo=SELECT OCPM.PROPOSAL_NO PROPOSAL_NO,OCPM.OPEN_COVER_NO OPEN_COVER_NO, ISNULL (PI.FIRST_NAME,PI.COMPANY_NAME) FIRST_NAME FROM  OPEN_COVER_POSITION_MASTER OCPM ,OPEN_COVER_MASTER OCM ,PERSONAL_INFO PI WHERE OCPM.OPEN_COVER_NO\=? AND OCPM.PROPOSAL_NO\=OCM.PROPOSAL_NO AND PI.CUSTOMER_ID\=OCM.CUSTOMER_ID  AND OCM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_MASTER OC WHERE OC.PROPOSAL_NO\=OCM.PROPOSAL_NO) AND OCPM.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_POSITION_MASTER OCP WHERE OCP.PROPOSAL_NO\=OCPM.PROPOSAL_NO)


##SEQUENCE CREATION
SEQ_GET_CUSTOMER_ID =SELECT NEXT VALUE FOR  CUSTOMER_SEQ
SEQ_GET_RECEIPT_NO = SELECT NEXT VALUE FOR RECEIPT_SEQ
SEQ_GET_CREDIT_NO = SELECT NEXT VALUE FOR CREDIT_SEQ
SEQ_GET_DEBIT_NO =SELECT NEXT VALUE FOR DEBIT_SEQ
SEQ_GET_QUOTE_NO_MOTOR 	= SELECT NEXT VALUE FOR MOTOR_QUOTE_SEQ
SEQ_GET_QUOTE_NO_TRAVEL = SELECT NEXT VALUE FOR MOTOR_QUOTE_SEQ
SEQ_GET_APPLICATION_NO_MOTOR  = SELECT NEXT VALUE FOR MOTOR_APPLICATION_SEQ
SEQ_GET_APPLICATION_NO_TRAVEL = SELECT NEXT VALUE FOR MOTOR_APPLICATION_SEQ
BROKER_CODE_SEQ = SELECT NEXT VALUE FOR BROKER_CODE_SEQ
PAYMENT_CODE_SEQ = SELECT NEXT VALUE FOR PAYMENT_CODE_SEQ

CAL_DR_CR_TABLE_INSERT = {CALL cr_dr_insert(?,?,?)} 
MARINE_INTG_INSERT = {CALL INTEGRATION_STAGING_INSERT(?,?)}
CAL_NAJM_INTG_INSERT = {CALL najam_transaction_insert(?)}  

##Haulier Vehicle Details 
GET_CANCEL_REMARKS=select isnull(nullif(ENDT_REMARKS,''),CANCEL_REMARKS) as ENDT_REMARKS from position_master pm where pm.QUOTE_NO\=? and pm.AMEND_ID\=(select max(AMEND_ID) from position_master where  QUOTE_NO\=pm.QUOTE_NO )
marine.opencover.vehicle.detail=SELECT DISTINCT (A.PROPOSAL_NO), NULLIF (A.OPEN_COVER_NO, '0')OPEN_COVER_NO, NULLIF (CONVERT(date,B.OPEN_COVER_START_DATE,103), ' ')OPEN_COVER_START_DATE, NULLIF (CONVERT(date,B.OPEN_COVER_END_DATE,103), ' ')OPEN_COVER_END_DATE, NULLIF (C.FIRST_NAME, C.COMPANY_NAME)COMPANY_NAME, D.CUSTOMER_ID, B.AMEND_ID, D.MISSIPPI_OPENCOVER_NO,A.STATUS, A.ENDT_STATUS, A.ORIGINAL_POLICY_NO, D.debit_note_no, D.credit_note_no, ISNULL(CONVERT(numeric(20,2), CAST(d.CROSS_VOYAGE_TURNOVER AS FLOAT)), 0)- ISNULL (CONVERT(numeric(20,2), CAST(d.UTILIZED_AMOUNT AS FLOAT)),0) amount  FROM OPEN_COVER_POSITION_MASTER A, OPEN_COVER_DETAIL B, PERSONAL_INFO C, OPEN_COVER_MASTER D WHERE (A.STATUS = 'P' OR (A.STATUS='Y' AND ORIGINAL_POLICY_NO IS NOT NULL)) AND A.PROPOSAL_NO = B.PROPOSAL_NO and type='13' AND A.EXPIRY_DATE >= GETDATE() AND B.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_DETAIL WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND A.PROPOSAL_NO IN (SELECT (PROPOSAL_NO) FROM OPEN_COVER_MASTER WHERE BROKER_ID = D.BROKER_ID) AND D.PROPOSAL_NO = A.PROPOSAL_NO AND C.CUSTOMER_ID = D.CUSTOMER_ID AND D.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_MASTER WHERE PROPOSAL_NO = A.PROPOSAL_NO) AND (nullif(A.ADMIN_STATUS,'') IS NULL OR A.ADMIN_STATUS = 'Y') AND D.BROKER_ID=? ORDER BY A.PROPOSAL_NO DESC
get.marine.vehicle.details=select SNO,TRAN_ID,PROPOSAL_NO,ASSERT_NO,PLATE_NO,CHASSIS_NO,MAKE,DESCRIPTION,SEQUENCE_NO,MANUFACTURE_YEAR,LIMIT,CONVERT(date,ENTRY_DATE,103)ENTRY_DATE,INCEPTION_DATE,EXPIRY_DATE,STATUS,BASE_OPEN_COVER_NO,convert(decimal(10,2),ACTUAL_PREMIUM)ACTUAL_PREMIUM,convert(decimal(10,2),REFUND_PREMIUM)REFUND_PREMIUM,convert(decimal(10,2),VAT_TAX_REFUND) VAT_TAX_REFUND,convert(decimal(10,2),VAT_TAX_AMT) VAT_TAX_AMT from MARINE_VEHICLE_DETAILS where tran_id\=? or deleted_tran_id\= ? and status\=? order by SNO
marine.vehicle.details.assert=and ASSERT_NO in(?)
get.marine.vehicle.broker.list=select  bcm.company_name,pi.login_id from BROKER_COMPANY_MASTER bcm,personal_info pi where bcm.agency_code\=pi.agency_code  and bcm.status\='Y' and pi.status\=bcm.status and pi.APPLICATION_ID\='2' and pi.login_id in(select distinct ocm.broker_id from OPEN_COVER_MASTER ocm,OPEN_COVER_POSITION_MASTER ocpm where ocm.broker_id in(select login_id from login_master where status\!\='N' and oa_code in(select agency_code from broker_company_master where branch_code in(?))) and ocpm.STATUS in('P','D') and ocm.PROPOSAL_NO\=ocpm.PROPOSAL_NO) order by lower(bcm.COMPANY_NAME)
getbaseOpenCoverNo=select case when nullif(ENDT_TYPE,'') is null then OPEN_COVER_NO else ORIGINAL_POLICY_NO end base_open_cover_no from OPEN_COVER_POSITION_MASTER where proposal_no=?
getMarinevehicledeletedetails=select SNO,TRAN_ID,PROPOSAL_NO,ASSERT_NO,PLATE_NO,CHASSIS_NO,MAKE,DESCRIPTION,SEQUENCE_NO,MANUFACTURE_YEAR,LIMIT,CONVERT(date,ENTRY_DATE,103)ENTRY_DATE,INCEPTION_DATE,EXPIRY_DATE,STATUS,BASE_OPEN_COVER_NO,convert(decimal(10,2),ACTUAL_PREMIUM)ACTUAL_PREMIUM,convert(decimal(10,2),REFUND_PREMIUM)REFUND_PREMIUM from MARINE_VEHICLE_DETAILS where BASE_OPEN_COVER_NO\=? and status\=? 
get.vehicle.count=select sum(NO_OF_VEHICLES) from OPEN_COVER_HAULIER_DETAILS where proposal_no=?

##OPEN_COVER_PAYMENT_TERMS 
GETOCDETAILS=select ocpm.OPEN_COVER_NO,ocpm.PROPOSAL_NO,PI.FIRST_NAME+ ' ' +' '+ ' ' +ISNULL(PI.LAST_NAME,'') CUS_NAME,CONVERT(VARCHAR(10),ocm.POLICY_START_DATE,103) POLICY_START_DATE,CONVERT(VARCHAR(10),ocm.EFFECTIVE_DATE,103) POLICY_ISSUE_DATE ,CONVERT(VARCHAR(10),ocm.POLICY_END_DATE ,103) POLICY_END_DATE ,(   select max(CONVERT(VARCHAR(10),ENTRY_DATE ,103))   from OPEN_COVER_Payment_terms   where PROPOSAL_NO=ocpm.PROPOSAL_NO) LAST_UPDATED,ISNULL(ocpm.original_policy_no,ocpm.open_cover_no) BASE_OPEN_COVER_NO,ROUND (ISNULL (ocm.marine_premium, 0)+ ISNULL (ocm.WAR_PREMIUM, 0)+ ISNULL (ocm.VAT_TAX_AMT, 0),2)total_premium from open_cover_position_master ocpm ,open_cover_master ocm, personal_info pi  where ocm.BROKER_ID=?  and ocpm.PROPOSAL_NO=ocm.PROPOSAL_NO and pi.CUSTOMER_ID=ocm.CUSTOMER_ID AND OCPM.AMEND_ID=(SELECT ISNULL(MAX(AMEND_ID),0) FROM OPEN_COVER_POSITION_MASTER op WHERE ISNULL(op.ORIGINAL_POLICY_NO,op.OPEN_COVER_NO )=ISNULL(OCPM.ORIGINAL_POLICY_NO,OCPM.OPEN_COVER_NO)   and op.status='P') and nullif(MISSIPPI_OPENCOVER_NO,'') is not null and ocm.status='Y' and ocpm.status='P' and pi.AMEND_ID=( select max(AMEND_ID) from personal_info per  where  per.CUSTOMER_ID=pi.CUSTOMER_ID) and ocm.amend_id in (select max(ocms.amend_id) from open_cover_master ocms where ocm.proposal_no = ocms.proposal_no) and ocpm.STATUS='P'
GETPAYMENT_TERMS = select ocpt.PROPOSAL_NO,ocm.MISSIPPI_OPENCOVER_NO,CONVERT(varchar(10),ocm.POLICY_START_DATE,103) POLICY_START_DATE,CONVERT(varchar(10),ocpt.DUE_DATE,103) DUE_DATE,CONVERT(varchar(10),ocpt.EFFECTIVE_DATE,103) EFFECTIVE_DATE,ocpt.DUE_AMOUNT ,ocpt.DUE_Percentage ,ocpt.AMEND_ID,ocpt.SNO,ocpt.MISSIPPI_OPENCOVER_NO from OPEN_COVER_Payment_terms ocpt,open_cover_master ocm  where ocpt.OPEN_COVER_NO \= ?  and  ocm.PROPOSAL_NO\=?  and Ocm.Amend_Id\=(Select Max(Amend_Id) From Open_Cover_Master Oc Where Ocm.Proposal_No\=Oc.Proposal_No) and OCPT.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_Payment_terms OCT WHERE OCT.PROPOSAL_NO\=OCPT.PROPOSAL_NO AND OCPT.sno\=OCT.sno) AND OCPT.STATUS\='Y' and ocpt.policy_no\=? ORDER BY PROPOSAL_NO,SNO 
GETPAYMENT_TERMS_CNT = SELECT POLICY_NO as MISSIPPI_OPENCOVER_NO,PROPOSAL_NO, SUM(CAST(ISNULL (NULLIF (DUE_AMOUNT, ''), 0) AS DECIMAL (15, 5))) DUE_AMOUNT, SUM ( CAST (ISNULL (NULLIF (DUE_PERCENTAGE, ''), 0) AS DECIMAL (15, 2))) DUE_PERCENTAGE ,round(TOTAL_PREMIUM,2) TOTAL_PREMIUM from (select POLICY_NO,PROPOSAL_NO,DUE_AMOUNT,DUE_PERCENTAGE ,(SELECT   ROUND (ISNULL (MARINE_PREMIUM, 0)+ ISNULL (WAR_PREMIUM, 0)+ ISNULL (VAT_TAX_AMT, 0) + ISNULL (convert(decimal(15,2),cast(POLICYFEE as float)), 0) ,2) FROM   OPEN_COVER_MASTER PM,OPEN_COVER_POSITION_MASTER OCPM WHERE   PM.PROPOSAL_NO = OCPT.PROPOSAL_NO AND OCPM.PROPOSAL_NO=OCPT.PROPOSAL_NO AND PM.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   OPEN_COVER_MASTER OC WHERE   PM.PROPOSAL_NO = OC.PROPOSAL_NO) AND OCPM.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   OPEN_COVER_POSITION_MASTER X WHERE   OCPM.PROPOSAL_NO = X.PROPOSAL_NO)) TOTAL_PREMIUM FROM open_cover_payment_terms ocpt WHERE OPEN_COVER_NO = ? and OCPT.AMEND_ID=( SELECT MAX(AMEND_ID) FROM OPEN_COVER_Payment_terms OCT WHERE OCT.PROPOSAL_NO=OCPT.PROPOSAL_NO AND OCPT.sno=OCT.sno) AND OCPT.STATUS='Y') pt GROUP BY POLICY_NO,TOTAL_PREMIUM,PROPOSAL_NO
DEACTIVE_PAYMENT_TERMS = update OPEN_COVER_Payment_terms set STATUS='N', EFFECTIVE_DATE= convert(date,?,103)  where PROPOSAL_NO=? and sno=? and AMEND_ID=?
INS_PAYMENT_TERMS = INSERT INTO OPEN_COVER_Payment_terms (PROPOSAL_NO, POLICY_NO,DUE_DATE,DUE_AMOUNT,DUE_Percentage,sno,EFFECTIVE_DATE,AMEND_ID,STATUS,ENTRY_DATE,OPEN_COVER_NO,MISSIPPI_OPENCOVER_NO,PRODUCT_TYPE,FRZ_FLAG)  VALUES (?,?,convert(date,?,103),?,?,?,convert(date,?,103),?,?,GETDATE(),?,?,?,?)
GET_MAX_AMEND_ID_DUE=select isnull(max(amend_id),0) from OPEN_COVER_Payment_terms where OPEN_COVER_NO = ? and sno=?
GET_MAX_SNO_DUE=select isnull(max(sno),0) from OPEN_COVER_Payment_terms where OPEN_COVER_NO = ?
GET_MAX_SNO_DUE1=select isnull(max(sno),0) from OPEN_COVER_Payment_terms where POLICY_NO = ?
#GETOCNOLIST= select  OPEN_COVER_NO ,OPEN_COVER_NO  from open_cover_position_master where  ISNULL(original_policy_no,open_cover_no)=? and status='P' order by amend_id desc
GETOCNOLIST=SELECT  OCPM.OPEN_COVER_NO ,OCPM.OPEN_COVER_NO ,ocpm.proposal_no  FROM open_cover_position_master ocpm,open_cover_master ocm WHERE  ISNULL(OCPM.original_policy_no,OCPM.open_cover_no)=? AND OCPM.PROPOSAL_NO=ocm.proposal_no AND ocm.DEBIT_To='C' and (ISNULL (marine_premium, 0)+ISNULL (WAR_PREMIUM, 0) +ISNULL (VAT_TAX_AMT, 0))>0 AND OCPM.status='P' ORDER BY OCPM.amend_id DESC
GETPAYMENT_TERMS_CT = SELECT   PM.QUOTE_NO, pm.POLICY_NO ,PI.FIRST_NAME CUS_NAME,pm.INCEPTION_DATE FROM   POSITION_MASTER PM,PERSONAL_INFO PI WHERE   pi.AMEND_ID \= (SELECT   MAX (AMEND_ID)  FROM   personal_info per WHERE   per.CUSTOMER_ID \= pi.CUSTOMER_ID)  AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND POLICY_NO \= ? and product_id\=? 
GETPAYMENT_TERMS_OC = SELECT   PM.QUOTE_NO, pm.POLICY_NO ,PI.FIRST_NAME CUS_NAME,pm.INCEPTION_DATE FROM   POSITION_MASTER PM,PERSONAL_INFO PI WHERE   pi.AMEND_ID = (SELECT   MAX (AMEND_ID)  FROM   personal_info per WHERE   per.CUSTOMER_ID = pi.CUSTOMER_ID)  AND PI.CUSTOMER_ID = PM.CUSTOMER_ID AND POLICY_NO = ? and product_id=? and open_cover_no=?
GET_DUE_INFO = select CONVERT(varchar(10),ocpt.DUE_DATE,103) DUE_DATE,CONVERT(varchar(10),ocpt.EFFECTIVE_DATE,103) EFFECTIVE_DATE,ocpt.DUE_AMOUNT ,ocpt.DUE_Percentage ,ocpt.AMEND_ID,ocpt.SNO,ocpt.MISSIPPI_OPENCOVER_NO from OPEN_COVER_Payment_terms ocpt where ocpt.POLICY_NO = ?  and OCPT.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_Payment_terms OCT WHERE OCT.POLICY_NO=OCPT.POLICY_NO AND OCPT.sno=OCT.sno) AND OCPT.STATUS='Y' ORDER BY SNO
GETPAYMENT_TERMS_LT= SELECT   PM.TRAN_ID QUOTE_NO, pm.POLICY_NO ,PI.FIRST_NAME CUS_NAME,CONVERT(varchar(10),pm.ENTRY_DATE,103) INCEPTION_DATE FROM   marine_vehicle_transaction_details PM,PERSONAL_INFO PI WHERE   pi.AMEND_ID \= (SELECT   MAX (AMEND_ID)  FROM   personal_info per WHERE   per.CUSTOMER_ID \= pi.CUSTOMER_ID)  AND PI.CUSTOMER_ID \= PM.CUSTOMER_ID AND POLICY_NO \= ? 
DEL_PAYMENT_TERMS=delete from OPEN_COVER_Payment_terms where  PROPOSAL_NO=?
DEL_PAYMENT_TERMS_PL=delete from OPEN_COVER_Payment_terms where  POLICY_NO=?
UPD_PAYMENT_TERMS_OC = update OPEN_COVER_Payment_terms set MISSIPPI_OPENCOVER_NO=?,POLICY_NO=?   where  PROPOSAL_NO=?
GETPAYMENT_TERMS_PL = SELECT PROPOSAL_NO, SUM(CAST (ISNULL (NULLIF (DUE_AMOUNT, ''), 0) AS DECIMAL (15, 5))) DUE_AMOUNT, SUM ( CAST (ISNULL (NULLIF (DUE_PERCENTAGE, ''), 0) AS DECIMAL (15, 2))) DUE_PERCENTAGE FROM (SELECT PROPOSAL_NO, DUE_AMOUNT, DUE_PERCENTAGE FROM open_cover_payment_terms ocpt WHERE OCPT.PROPOSAL_NO=? AND OCPT.AMEND_ID = (SELECT MAX (AMEND_ID) FROM OPEN_COVER_Payment_terms OCT WHERE OCT.PROPOSAL_NO = OCPT.PROPOSAL_NO AND OCPT.sno = OCT.sno) AND OCPT.STATUS = 'Y') pt GROUP BY PROPOSAL_NO
 ## Common Reports Start
GET_COMMON_REPORT_LIST = SELECT ITEM_CODE,ITEM_VALUE FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE='COMMON REPORT TYPES'  AND PARAM1=?   AND STATUS='Y'
GET_COMMON_REPORT_BROKER_LIST = SELECT BCM.AGENCY_CODE,BCM.COMPANY_NAME FROM BROKER_COMPANY_MASTER BCM,LOGIN_MASTER LM,LOGIN_USER_DETAILS LUD WHERE LM.USERTYPE='Broker' AND LUD.AGENCY_CODE=BCM.AGENCY_CODE AND LM.BRANCH_CODE=? AND BCM.AGENCY_CODE=LM.AGENCY_CODE AND LUD.PRODUCT_ID=? ORDER BY COMPANY_NAME ASC
GET_COMMON_REPORT_USER_LIST = SELECT LUD.USER_NAME,LUD.LOGIN_ID FROM LOGIN_USER_DETAILS LUD,LOGIN_MASTER LM WHERE LM.OA_CODE=?   AND LM.OA_CODE=LUD.OA_CODE AND LM.AGENCY_CODE=LUD.AGENCY_CODE AND LUD.PRODUCT_ID=? AND LUD.STATUS='Y' AND LUD.AMEND_ID= (SELECT MAX(AMEND_ID)  FROM LOGIN_USER_DETAILS WHERE OA_CODE=LUD.OA_CODE AND PRODUCT_ID=LUD.PRODUCT_ID) AND LM.USERTYPE='USER'
GET_COMMON_REPORT_SUB_BRANCH_LIST = SELECT FS_BRANCH_CODE,FS_BRANCH_NAME FROM TRAVEL_LOCATION_LINK WHERE STATUS\='Y' AND BRANCH_CODE\=? ORDER BY FS_BRANCH_NAME 
GET_COMMON_REPORT_MOTOR_POLICY_LIST = SELECT POLICY_SUBTYPE_ID CODE,POLICYTYPE_DESC_ENGLISH CODEDESC FROM MOTOR_POLICYTYPE_MASTER WHERE STATUS='Y'
GET_COMMON_REPORT_TRAVEL_POLICY_LIST = SELECT SCHEME_ID CODE,SCHEME_NAME CODEDESC  FROM TRAVEL_SCHEME_COVERS WHERE STATUS='Y'
GET_COMMON_REPORT_MARINE_POLICY_LIST = SELECT PRODUCT_ID CODE,PRODUCT_NAME CODEDESC FROM PRODUCT_MASTER PM WHERE PM.PRODUCT_ID IN('11','3') AND PM.STATUS='Y'
GET_COMMON_POLICY_BOUDREAUX_REPORT = SELECT * FROM POLICY_BOUDREAUX(?,?,?,?,?,?,?,?,?)
GET_COMMON_POLICY_PRODUCTION_REPORT = SELECT * FROM PRODUCTION_REPORTS(?,?,?,?,?,?,?,?,?,?)
GET_COMMON_PRODUCTION_REPORT_MOTOR = SELECT   HPM.PRODUCT_ID, (SELECT   COMPANY_NAME FROM   BROKER_COMPANY_MASTER WHERE   AGENCY_CODE=LM.OA_CODE) LOGIN_NAME, SUM (HPM.PREMIUM) INITIAL_PREMIUM, 0 ADD_PREM, 0 DEL_PREM, SUM (POLICY_FEE) POLICY_FEE, SUM (OVERALL_PREMIUM) GROSS_PREMIUM, SUM (OVERALL_PREMIUM) NET_PREMIUM, COUNT (HPM.POLICY_NO) COUNT1, (SELECT   POLICYTYPE_DESC_ENGLISH FROM   MOTOR_POLICYTYPE_MASTER MPM WHERE   MPM.POLICY_SUBTYPE_ID = MDD.POLICYTYPE AND MPM.STATUS = ''Y'' AND AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   MOTOR_POLICYTYPE_MASTER MPM1 WHERE   MPM.POLICY_SUBTYPE_ID = MPM1.POLICY_SUBTYPE_ID)) POLICYTYPE FROM   HOME_POSITION_MASTER HPM, MOTOR_DATA_DETAIL MDD,LOGIN_MASTER LM WHERE       HPM.LOGIN_ID IS NOT NULL AND HPM.PRODUCT_ID = ? AND HPM.APPLICATION_NO = MDD.APPLICATION_NO AND HPM.STATUS = ''P'' AND HPM.LOGIN_ID=LM.LOGIN_ID AND CONVERT (DATE, {0}, 103) BETWEEN CONVERT (DATE,?,103) AND  CONVERT (DATE, ?, 103) {1} GROUP BY HPM.PRODUCT_ID,LM.OA_CODE, MDD.POLICYTYPE
GET_COMMON_POLICY_PRODUCTION_REPORT_MARINE = SELECT * FROM PRODUCTION_REPORTS_MARINE(?,?,?,?,?,?,?,?,?,?)
## Common Reports End

#Bulk Print Report
GET_OP_BP_COUNT = select  distinct (select username from login_master  where login_id collate Latin1_General_CI_AS=APPLICATION_ID collate Latin1_General_CI_AS) username,sum(convert(int,total_policy)) total_policy,APPLICATION_ID from Schedule_generation(?,?,?,?,'',?,?,'',?)  where APPLICATION_ID !='1' group by APPLICATION_ID
GET_OP_OPEN_BP_COUNT = SELECT  DISTINCT (SELECT username FROM login_master WHERE login_id collate Latin1_General_CI_AS= APPLICATION_ID collate Latin1_General_CI_AS) username,APPLICATION_ID,COUNT (Open_Cover_No) TOTAL_OPEN_COVER FROM   (  SELECT   APPLICATION_ID,Open_Cover_No,LOGIN_ID,company_name,total_policy FROM Schedule_generation (?,?,?,?,'',?,?,'',?) WHERE   APPLICATION_ID != '1' GROUP BY   APPLICATION_ID,Open_Cover_No,LOGIN_ID,company_name,total_policy) A GROUP BY   APPLICATION_ID
GET_BR_BP_LIST = select * from Schedule_generation(?,?,?,?,'',?,?,?,?)
GET_BR_OPEN_BP_LIST = select company_name,LOGIN_ID,count(Open_Cover_No) TOTAL_OPEN_COVER from ( SELECT   APPLICATION_ID,LOGIN_ID,company_name,Open_Cover_No FROM Schedule_generation (?,?,?,?,'',?,?,?,?) WHERE   APPLICATION_ID = '1'  GROUP BY   APPLICATION_ID,LOGIN_ID,company_name,Open_Cover_No) A group by  company_name,LOGIN_ID
GET_BR_OP_BP_LIST = select * from Schedule_generation(?,?,?,?,'',?,?,?,'')
ET_BR_OP_OPEN_BP_LIST = select Open_Cover_No,LOGIN_ID,company_name,total_policy,application_id from Schedule_generation( ?,?,?,?,'',?,?,?,?) group by Open_Cover_No,LOGIN_ID,company_name,total_policy,application_id
GET_OP_USERNAME = select USERNAME from login_master where login_id=?



############### NIJM ClAIM SERVICE ############################
NIJM_MAX_LIMT=select  DETAIL_NAME from constant_Detail where CATEGORY_ID=157 and CATEGORY_DETAIL_ID='1'
NIJM_LIAB_LIMT=select  DETAIL_NAME from constant_Detail where CATEGORY_ID=157 and CATEGORY_DETAIL_ID='2'
NIJM_REC_COUNT=select count(*) from  nijm_accidental_details where DriverID=? and convert(date,RECIVED_DATE,103) > DATEADD(day,-1*(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE IT WHERE ITEM_TYPE='CLAIM_DAYS'  AND STATUS='Y'  AND ITEM_CODE=(SELECT  MAX(ITEM_CODE) FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE=IT.ITEM_TYPE AND STATUS='Y')),convert(date,GETDATE(),103))
NIJM_LIB_SUM=SELECT  isNULL(sum(convert(decimal,Liability)),0) FROM nijm_accidental_details WHERE DriverID = ?  and convert(date,RECIVED_DATE,103) > DATEADD(day,-1*(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE IT WHERE ITEM_TYPE='CLAIM_DAYS'  AND STATUS='Y'  AND ITEM_CODE=(SELECT  MAX(ITEM_CODE) FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE=IT.ITEM_TYPE AND STATUS='Y')),convert(date,GETDATE(),103))
NJIM_LIB_INSERT=insert into nijm_accidental_details (CaseNumber,AccidentDate,Liability,CityName,DriverAge,CarModel,CarType,DriverID,SequenceNumber,OwnerID,EstimatedAmount,DamageParts,CauseOfAccident,recived_date,VALIDITY_DURATION,VALIDITY_DATE) values (?,?,?,?,?,?,?,?,?,?,?,?,?,GETDATE(),(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE IT WHERE ITEM_TYPE='CLAIM_DAYS'  AND STATUS='Y'  AND ITEM_CODE=(SELECT  MAX(ITEM_CODE) FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE=IT.ITEM_TYPE AND STATUS='Y')),GETDATE()+(1*(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE IT WHERE ITEM_TYPE='CLAIM_DAYS'  AND STATUS='Y'  AND ITEM_CODE=(SELECT  MAX(ITEM_CODE) FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE=IT.ITEM_TYPE AND STATUS='Y'))))
NIJM_ACCDINT_DET=select CaseNumber,AccidentDate,Liability,CityName,DriverAge,CarModel,CarType,DriverID,SequenceNumber,OwnerID,EstimatedAmount,DamageParts ,CauseOfAccident,CaseDetails_Id from  nijm_accidental_details where DriverID=?
NJIM_LIB_DEL=delete  from nijm_accidental_details Where DriverID \= ? 
GET_MOTOR_DTS_NIJAM =SELECT COUNT(*) FROM NIJM_ACCIDENTAL_DETAILS  WHERE DRIVERID=? AND CAST(LIABILITY  AS  INT)>0  AND CONVERT(DATE, CONVERT(VARCHAR, ACCIDENTDATE, 101))  BETWEEN DATEADD(YY, -1, CONVERT(DATE, CONVERT(VARCHAR, GETDATE()+1, 101))) AND CONVERT(DATE, CONVERT(VARCHAR, GETDATE(), 101))

DELETE_INSERT_NAJM ={CALL webRequest_arch_insert(?,?,?,?,?)} 

#######NAJM NCD YEAR SERVICE#######
NIJM_NCDYEAR_COUNT = SELECT COUNT(*) FROM  NIJM_NCDYEAR_DETAIL WHERE VEHICLE_IDNTIFY_ID = ? AND VEHICLE_ID = ? AND POLICY_HOLDER_ID = ? AND CONVERT(DATE,ENTRY_DATE,103) > DATEADD(day,-1*(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE IT WHERE ITEM_TYPE='NCD_DAYS'  AND STATUS='Y'  AND ITEM_CODE=(SELECT  MAX(ITEM_CODE) FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE=IT.ITEM_TYPE AND STATUS='Y')),convert(date,GETDATE(),103))
NIJM_MAX_NCDYEAR = SELECT NCD_FREE_YEARS FROM NIJM_NCDYEAR_DETAIL WHERE VEHICLE_IDNTIFY_ID = ? AND VEHICLE_ID = ? AND POLICY_HOLDER_ID = ? AND CONVERT(DATE,ENTRY_DATE,103) > DATEADD(day,-1*(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE IT WHERE ITEM_TYPE='NCD_DAYS'  AND STATUS='Y'  AND ITEM_CODE=(SELECT  MAX(ITEM_CODE) FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE=IT.ITEM_TYPE AND STATUS='Y')),convert(date,GETDATE(),103))
NJIM_NCD_YEARS_INSERT = INSERT INTO NIJM_NCDYEAR_DETAIL (S_NO, VEHICLE_IDNTIFY_ID, VEHICLE_ID, POLICY_HOLDER_ID, STATUS_CODE,NCD_REFERENCE, NCD_FREE_YEARS,VALIDITY_DURATION,VALIDITY_DATE) VALUES ((SELECT ISNULL(MAX(S_NO)+1,0) FROM NIJM_NCDYEAR_DETAIL),?,?,?,?,?,?,(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE IT WHERE ITEM_TYPE='NCD_DAYS'  AND STATUS='Y'  AND ITEM_CODE=(SELECT  MAX(ITEM_CODE) FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE=IT.ITEM_TYPE AND STATUS='Y')),GETDATE()+(1*(SELECT ITEM_VALUE FROM LIST_ITEM_VALUE IT WHERE ITEM_TYPE='NCD_DAYS'  AND STATUS='Y'  AND ITEM_CODE=(SELECT  MAX(ITEM_CODE) FROM LIST_ITEM_VALUE  WHERE ITEM_TYPE=IT.ITEM_TYPE AND STATUS='Y'))))
NJIM_NCD_DEL = DELETE FROM NIJM_NCDYEAR_DETAIL WHERE VEHICLE_IDNTIFY_ID = ? AND VEHICLE_ID = ? AND POLICY_HOLDER_ID = ?
############### NIJM ############################
##NIJM_MAX_LIMT=select  DETAIL_NAME from constant_Detail where CATEGORY_ID=157 and CATEGORY_DETAIL_ID='1'
##NIJM_LIAB_LIMT=select  DETAIL_NAME from constant_Detail where CATEGORY_ID=157 and CATEGORY_DETAIL_ID='2'
##NIJM_REC_COUNT=select count(*) from  nijm_accidental_details where DriverID=? and convert(date,GETDATE(),103) BETWEEN   convert(date,recived_date,103) AND   convert(date,VALIDITY_DATE,103)
##NIJM_LIB_SUM=SELECT  isNULL(sum(convert(decimal,Liability)),0) FROM nijm_accidental_details WHERE DriverID = ? and convert(date,AccidentDate,103) > DATEADD(year,-1,convert(date,GETDATE(),103)) AND convert(date,GETDATE(),103) BETWEEN   convert(date,recived_date,103) AND   convert(date,VALIDITY_DATE,103)
##NJIM_LIB_INSERT=insert into nijm_accidental_details (CaseNumber,AccidentDate,Liability,CityName,DriverAge,CarModel,CarType,DriverID,SequenceNumber,OwnerID,EstimatedAmount,DamageParts,CauseOfAccident,recived_date,VALIDITY_DURATION,VALIDITY_DATE) values (?,?,?,?,?,?,?,?,?,?,?,?,?,sysdatetime(),(select  DETAIL_NAME from constant_Detail where CATEGORY_ID=157 and CATEGORY_DETAIL_ID='5' AND BRANCH_CODE='01'),sysdatetime()+(select  DETAIL_NAME from constant_Detail where CATEGORY_ID=157 and CATEGORY_DETAIL_ID='5' AND BRANCH_CODE='01'))
##NIJM_ACCDINT_DET=select CaseNumber,AccidentDate,Liability,CityName,DriverAge,CarModel,CarType,DriverID,SequenceNumber,OwnerID,EstimatedAmount,DamageParts ,CauseOfAccident,CaseDetails_Id from  nijm_accidental_details where DriverID=?
##NJIM_LIB_DEL=delete  from nijm_accidental_details Where DriverID \= ?

##GET_MOTOR_DTS_NIJAM =SELECT COUNT(*) FROM NIJM_ACCIDENTAL_DETAILS  WHERE DRIVERID=? AND CAST(LIABILITY  AS  INT)>0  AND CONVERT(DATE, CONVERT(VARCHAR, ACCIDENTDATE, 101))  BETWEEN DATEADD(YY, -1, CONVERT(DATE, CONVERT(VARCHAR, GETDATE()+1, 101))) AND CONVERT(DATE, CONVERT(VARCHAR, GETDATE(), 101)) AND convert(date,GETDATE(),103) BETWEEN   convert(date,recived_date,103) AND   convert(date,VALIDITY_DATE,103)

##NAJM NCD YEAR SERVICE
##NIJM_NCDYEAR_COUNT = SELECT COUNT(*) FROM  NIJM_NCDYEAR_DETAIL WHERE VEHICLE_IDNTIFY_ID = ? AND VEHICLE_ID = ? AND POLICY_HOLDER_ID = ? AND convert(date,GETDATE(),103) BETWEEN   convert(date,ENTRY_DATE,103) AND   convert(date,VALIDITY_DATE,103) 
##NIJM_MAX_NCDYEAR = SELECT NCD_FREE_YEARS FROM NIJM_NCDYEAR_DETAIL WHERE VEHICLE_IDNTIFY_ID = ? AND VEHICLE_ID = ? AND POLICY_HOLDER_ID = ? AND convert(date,GETDATE(),103) BETWEEN   convert(date,ENTRY_DATE,103) AND   convert(date,VALIDITY_DATE,103)
##NJIM_NCD_YEARS_INSERT = INSERT INTO NIJM_NCDYEAR_DETAIL (S_NO, VEHICLE_IDNTIFY_ID, VEHICLE_ID, POLICY_HOLDER_ID, STATUS_CODE,NCD_REFERENCE, NCD_FREE_YEARS,VALIDITY_DURATION,VALIDITY_DATE) VALUES ((SELECT ISNULL(MAX(S_NO)+1,0) FROM NIJM_NCDYEAR_DETAIL),?,?,?,?,?,?,(select  DETAIL_NAME from constant_Detail where CATEGORY_ID=157 and CATEGORY_DETAIL_ID='5' AND BRANCH_CODE='01'),SYSDATETIME()+(select  DETAIL_NAME from constant_Detail where CATEGORY_ID=157 and CATEGORY_DETAIL_ID='5' AND BRANCH_CODE='01'))
##NJIM_NCD_DEL = DELETE FROM NIJM_NCDYEAR_DETAIL WHERE VEHICLE_IDNTIFY_ID = ? AND VEHICLE_ID = ? AND POLICY_HOLDER_ID = ?




## Yakeen Web Service
CHECK_YAKEEN_WEBSERVICE_CALL =select count(*) from MOTOR_DATA_DETAIL mdd where APPLICATION_NO\=? and VEHICLE_ID\=? and AMEND_ID \=(select max(amend_id) from MOTOR_DATA_DETAIL where APPLICATION_NO\=mdd.APPLICATION_NO and VEHICLE_ID\=mdd.VEHICLE_ID)
UPD_MOTOR_ADDVEHICLE_DTLS_YAKHEEM =UPDATE MOTOR_DATA_DETAIL SET CHASSIS_NO\=?,PLATE_COLOR\=?,AREA_COVERAGE\=(select areacover_code from motor_areacoverage_master ma where najm_code\=? and amend_id\=(select  max(amend_id) from motor_areacoverage_master where najm_code\= ma.najm_code)),REGION_CODE\=? WHERE APPLICATION_NO\=? AND VEHICLE_ID\=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO\=?)
UPD_MOTOR_ADDVEHICLE_DTLS_YAKHEEMFOR400=UPDATE MOTOR_DATA_DETAIL SET AREA_COVERAGE=?,REGION_CODE=? WHERE APPLICATION_NO=?  AND VEHICLE_ID=? AND AMEND_ID IN(SELECT MAX(AMEND_ID) FROM MOTOR_DATA_DETAIL WHERE APPLICATION_NO=?)
GET_MOTOR_MFG_YEAR_SEQ = SELECT MODELYEAR FROM YAKEEN_CARINFO_WEBDATA WHERE SEQUENCENUMBER=? AND OWNERID=?  and WEBSERVICE_STATUS='Y' and request_time between  DATEADD(day, -90, getdate()) and getdate()
GET_MOTOR_MFG_YEAR_CUST = SELECT MODELYEAR FROM YAKEEN_CARINFO_WEBDATA WHERE REFERENCE_NO=? AND OWNERID=?  and WEBSERVICE_STATUS='Y' and request_time between  DATEADD(day, -90, getdate()) and getdate()
### Persoanl _ Info
UPD_PERS_FOR_B2C=UPDATE PERSONAL_INFO SET  APPLICATION_ID\='2',TITLE\=?,FIRST_NAME\=?,LAST_NAME\=?,CUST_NAME_ARABIC\=?,ADDRESS1\=?,ADDRESS2\=?,CITY\=?,POBOX\=?,DOB\=?,DOB_AR\=?,MOBILE\=?,ALTERNATE_MOBILE\=?,OCCUPATION\=?,EMAIL\=?,LOGIN_ID\=? WHERE CUSTOMER_ID\=?
GET_COUNT_NCB_MASTER=SELECT COUNT(*) FROM MOTOR_NCB_MASTER A where ((? between ncd_from and ncd_to) or (? between ncd_from and ncd_to)) and status=? and policytype=? and amend_id=(select max(amend_id) from MOTOR_NCB_MASTER  B where A.s_no = B.s_no)
GET_COUNT_CLAIM_MASTER= SELECT COUNT(*) FROM MOTOR_CLAIMLOAD_MASTER A where ((? between NO_OF_CLAIM_START and NO_OF_CLAIM_END) or (? between NO_OF_CLAIM_START and NO_OF_CLAIM_END)) and status=? and policytype=? and amend_id=(select max(amend_id) from MOTOR_CLAIMLOAD_MASTER B where A.s_no = B.s_no)
GET_COUNT_DRIVERAGE_MASTER=SELECT COUNT(*) FROM MOTOR_DRIVERAGE_MASTER A where ((? between DRIVER_AGE_START and DRIVER_AGE_END) or (? between DRIVER_AGE_START and DRIVER_AGE_END)) and status=? and policytype=? and amend_id=(select max(amend_id) from MOTOR_DRIVERAGE_MASTER B where A.s_no = B.s_no)
UPD_LOYLITY_FLAG=update motor_data_detail set PREV_POLICY_NO=?,LOYAL_FLAG=? where APPLICATION_NO=? and SEQUENCE_NO=?
UPD_NO_OF_CLAIM=update MOTOR_DATA_DETAIL set NO_OF_CLAIMS\=? WHERE APPLICATION_NO\=? AND VEHICLE_ID\=?
 
 
####### NAJM POLICY POSTING ##########
NAJM_SINGLE_POLICY_POST=select POLICYNUMBER, QUOTE_NO, NAJAM_ID, INSUREDTYPE, INSUREDID,INSUREDIDVERSIONTYPE, INSUREDNAME, INSUREDPHONENUMBER, INSUREDMOBILENUMBER, POLICYMAXIMUMLIABILITY,DRIVERAGELIMIT, BUILDINGNO, ADDITIONALNUMBER, ZIPCODE, CITY, NEIGHBORHOOD, UNITNO, STREET, ADDRESSIDENTIFIER, INSUREDPOSTALCODE, INSUREDPOBOX, INSUREDCITY, WASEL_BUILDINGNO, WASEL_ADDITIONALNUMBER, WASEL_ZIPCODE, WASEL_CITY, WASEL_NEIGHBORHOOD, ISSUEGREDATE ISSUEGREDATE, EFFECTIVEGREDATE EFFECTIVEGREDATE, EXPIREGREDATE EXPIREGREDATE, OWNERDATEOFBIRTH OWNERDATEOFBIRTH, POLICYISSUECITY, NEWORRENEW, OWNERNATIONALITY, USERTYPE,SALESUSERID, RES_STATUS, RES_DESCRP, RES_NNPID,ENDT_NO from NAJAM_POLICY_DETAILS where  QUOTE_NO=? and STATUS in ('Y','C')
NAJM_SINGLE_POLICY_UPD=UPDATE NAJAM_POLICY_DETAILS SET RES_STATUS=?,RES_DESCRP=?,RES_NNPID=?,NAJAM_ID=?,RESPONSE_TIME=GETDATE(),STATUS='C' WHERE POLICYNUMBER=?
NAJM_SINGLE_POLICY_VEHI=SELECT NNPID, SUBPOLICYNUMBER, QUOTE_NO, VEHICLEDEFINEDBY, PLATENUMBER,PLATELETTER1, PLATELETTER2, PLATELETTER3, VEHICLEPLATETYPE, CUSTOMID,SEQUENCENUMBER, VEHICLECOVERAGETYPE,HIJRIISSUEDATE, HIJRIEFFECTIVEDATE, HIJRIEXPIRATIONDATE,GREGORIANISSUEDATE GREGORIANISSUEDATE,GREGORIANEFFECTIVEDATE, GREGORIANEXPIRATIONDATE, CATEGORY, MANUFACTURER,MANUFACTURINGYEAR, MODEL, COLOR, CHASSISNUMBER, UNDER21,SEATINGCAPACITY, TRIMID, HIJRIISTMARAEXPIREDATE, GREISTMARAEXPIREDATE, WEIGHTOFVEHICLE,PERSONALACCEDENTCOVERAGE, GEOGRAPHICCOVERAGEGCC, NATURALDISASTERCOVERAGE, PREMIUMPOLICYAMOUNT, FINANCIALTRANACTIONID,USERTYPE, SALESUSERID, RES_STATUS, RES_DESCRP, RES_NNVID,ENDT_NO,VEHICLE_ID FROM NAJAM_VEHICLE_DETAILS  where QUOTE_NO=? and NNPID is not null and RES_NNVID is null and STATUS='Y'
NAJM_SINGLE_VEHI_UPD=UPDATE NAJAM_VEHICLE_DETAILS SET RES_STATUS=?,RES_DESCRP=?,RES_NNVID=?,RESPONSE_TIME=GETDATE(),STATUS='C' where NNPID=? AND SUBPOLICYNUMBER=? and VEHICLE_ID=? and ENDT_NO=?
NAJM_VALID_POLICY_1=select  count(*) from NAJAM_POLICY_DETAILS where quote_no=? and   trunc(ISSUEGREDATE)>=trunc(EXPIREGREDATE)
NAJM_VALID_POLICY_2=select count(*) from NAJAM_POLICY_DETAILS where quote_no\=? and trunc(EXPIREGREDATE)-trunc(EFFECTIVEGREDATE)  between 363 and 366 
NAJM_VALID_POLICY_3=select count(*) from NAJAM_POLICY_DETAILS where quote_no\=? and trunc(EFFECTIVEGREDATE)>\=trunc(ISSUEGREDATE) and abs(trunc(EFFECTIVEGREDATE)-trunc(ISSUEGREDATE))<\=45
NAJM_SINGLE_POLICY_UPD_VEHI=UPDATE NAJAM_VEHICLE_DETAILS SET NNPID =? WHERE SUBPOLICYNUMBER=? AND ENDT_NO=?
NAJM_SINGLE_POLICY_UPD_DRIV=update NAJAM_DRIVER_DETAILS set NNPID=? where POLICY_NO=?
NAJM_SINLGE_DRIVER_UPD=update NAJAM_DRIVER_DETAILS set RESPONSE_TIME=GETDATE(),RES_STATUS=?,RES_DESCRP=?,RES_NNDID=?,STATUS='C' where DRIVER_ID=?

NAJM_POL_ADD_DEL = INSERT INTO NAJM_PREMIA_ADD_DEL (NS_TYPE, NS_PREMIA_POL_ID, NS_PREMIA_POL_NO, NS_PREMIA_END_IDX, NS_NAJM_POL_ID,NS_PREMIA_VEHICLE_ID, NS_NAJM_VEH_ID, NS_STATUS, NS_DESC, NS_CR_DT,NS_CR_UID) VALUES (?, ?, ?, ?, ?,?, ?, ?, ?,GETDATE(),?)

NAJM_FLEET_POLICY_POST = select POLICYNUMBER, QUOTE_NO, NAJAM_ID, INSUREDTYPE, INSUREDID,INSUREDIDVERSIONTYPE, INSUREDNAME, INSUREDPHONENUMBER, INSUREDMOBILENUMBER, POLICYMAXIMUMLIABILITY,DRIVERAGELIMIT, BUILDINGNO, ADDITIONALNUMBER, ZIPCODE, CITY, NEIGHBORHOOD, UNITNO, STREET, ADDRESSIDENTIFIER, INSUREDPOSTALCODE, INSUREDPOBOX, INSUREDCITY, WASEL_BUILDINGNO, WASEL_ADDITIONALNUMBER, WASEL_ZIPCODE, WASEL_CITY, WASEL_NEIGHBORHOOD, ISSUEGREDATE ISSUEGREDATE, EFFECTIVEGREDATE EFFECTIVEGREDATE,EXPIREGREDATE EXPIREGREDATE, OWNERDATEOFBIRTH OWNERDATEOFBIRTH, POLICYISSUECITY, NEWORRENEW, OWNERNATIONALITY, USERTYPE,SALESUSERID, RES_STATUS, RES_DESCRP, RES_NNPID,ENDT_NO from NAJAM_POLICY_DETAILS where STATUS in ('Y','P') or (RES_STATUS='rejected' and upper(RES_DESCRP) = upper('Rejected by Elm: Service is unavailable; please try again later'))
NAJM_FLEET_POLICY_VEHI=SELECT NNPID, SUBPOLICYNUMBER, QUOTE_NO, VEHICLEDEFINEDBY, PLATENUMBER,PLATELETTER1, PLATELETTER2, PLATELETTER3, VEHICLEPLATETYPE, CUSTOMID,SEQUENCENUMBER, VEHICLECOVERAGETYPE,HIJRIISSUEDATE, HIJRIEFFECTIVEDATE, HIJRIEXPIRATIONDATE,GREGORIANISSUEDATE GREGORIANISSUEDATE, GREGORIANEFFECTIVEDATE GREGORIANEFFECTIVEDATE, GREGORIANEXPIRATIONDATE GREGORIANEXPIRATIONDATE, CATEGORY, MANUFACTURER,MANUFACTURINGYEAR, MODEL, COLOR, CHASSISNUMBER, UNDER21,SEATINGCAPACITY, TRIMID, HIJRIISTMARAEXPIREDATE, GREISTMARAEXPIREDATE GREISTMARAEXPIREDATE, WEIGHTOFVEHICLE,PERSONALACCEDENTCOVERAGE, GEOGRAPHICCOVERAGEGCC, NATURALDISASTERCOVERAGE, PREMIUMPOLICYAMOUNT, FINANCIALTRANACTIONID,USERTYPE, SALESUSERID, RES_STATUS, RES_DESCRP, RES_NNVID,ENDT_NO,VEHICLE_ID FROM NAJAM_VEHICLE_DETAILS  where (STATUS in ('Y','P') or (RES_STATUS\='rejected' and upper(RES_DESCRP) \= upper('Rejected by Elm\: Service is unavailable; please try again later'))) and NNPID is not null 
NAJM_FLEET_POLICY_DRIV=select * from NAJAM_DRIVER_DETAILS where STATUS='Y'

NAJM_FLEET_POLICY_UPD= UPDATE NAJAM_POLICY_DETAILS set STATUS='P' where STATUS='Y'
NAJM_FLEET_VEHI_UPD = UPDATE NAJAM_VEHICLE_DETAILS set STATUS='P' where STATUS='Y' and NNPID is not null
NAJM_FLEET_DRIV_UPD = update NAJAM_DRIVER_DETAILS set STATUS\='P'  where STATUS\='Y' 
UPD_STATUS_HOME_POSITION_DETAILS =UPDATE HOME_POSITION_MASTER SET STATUS=? WHERE QUOTE_NO =?
GET_VEHICLE_COUNT_MDD=select count(*) from MOTOR_DATA_DETAIL where QUOTE_NO=?
GET_VEHICLE_COUNT_NVD=select count(*) from NAJAM_VEHICLE_DETAILS where QUOTE_NO=? and upper(RES_STATUS)=UPPER('submitted')

NAJM_FLEET_POLICY_UPD_QUOTE= UPDATE NAJAM_POLICY_DETAILS set STATUS='P' where STATUS='Y' and quote_no=?
NAJM_FLEET_VEHI_UPD_QUOTE= UPDATE NAJAM_VEHICLE_DETAILS set STATUS='P' where STATUS='Y' and quote_no=?
NAJM_FLEET_DRIV_UPD_QUOTE=update NAJAM_DRIVER_DETAILS set STATUS\='P'  where STATUS\='Y' and quote_no\=?
NAJM_FLEET_VEHI_UPD_QUOTE_REVERT=UPDATE NAJAM_VEHICLE_DETAILS set STATUS='Y' where STATUS='P' and quote_no=?

GET_NAJM_POLICY_SUBMIT = SELECT  COUNT(*) FROM NAJAM_POLICY_DETAILS WHERE QUOTE_NO = ? AND RES_NNPID IS NOT NULL AND UPPER(RES_STATUS) = UPPER('SUBMITTED')
GET_NAJM_VEHICLE_SUBMIT  = SELECT  COUNT(*) FROM NAJAM_VEHICLE_DETAILS WHERE QUOTE_NO = ? AND RES_NNVID IS NOT NULL AND UPPER(RES_STATUS) = UPPER('SUBMITTED')

################################
##@@@@ NAJM Policy Post Credential
NAJM_POLICY_USERNAME=118C
NAJM_POLICY_PASSWORD=anbic@118
NAJM_POLICY_FILENAME=http\://nnuat.najm.sa\:7001/AddressEncapsulator/NajmInterfacePort


##### CONSTANT DETAIL MASTER START #####
#
INSERT_ITEM_VALUE = INSERT INTO LIST_ITEM_VALUE (ITEM_ID,ITEM_TYPE,ITEM_CODE,ITEM_VALUE,ITEM_DESC,PARAM1,PARAM2,STATUS) VALUES ((SELECT   ISNULL (MAX (ITEM_ID + 1), 1) ITEM_ID FROM LIST_ITEM_VALUE),?,(SELECT   ISNULL (MAX (ITEM_CODE + 1), 1) ITEM_CODE FROM   LIST_ITEM_VALUE WHERE   ITEM_TYPE =?),?,?,?,?,?)
UPDATE_ITEM_VALUE = UPDATE LIST_ITEM_VALUE SET ITEM_VALUE=?,ITEM_DESC=?,PARAM1=?,PARAM2=?,STATUS=? WHERE ITEM_ID =?
GET_ITEM_LIST = SELECT ITEM_ID,ITEM_TYPE,ITEM_CODE,ITEM_VALUE,ITEM_DESC,PARAM1,PARAM2,(CASE WHEN STATUS = 'Y' THEN 'Active' ELSE 'De-Active' END ) STATUS FROM LIST_ITEM_VALUE WHERE ITEM_ID != 295 ORDER BY ITEM_TYPE ASC
GET_ITEM_TYPE = SELECT DISTINCT(ITEM_TYPE) FROM LIST_ITEM_VALUE ORDER BY ITEM_TYPE ASC
GET_ITEM_FOR_EDIT = SELECT ITEM_ID,ITEM_TYPE,ITEM_CODE,ITEM_VALUE,ITEM_DESC,PARAM1,PARAM2,STATUS FROM LIST_ITEM_VALUE WHERE ITEM_ID = ?
CHECK_ITEM_TYPE_PRESENT_MOTOR = SELECT COUNT(*) FROM LIST_ITEM_VALUE WHERE ITEM_TYPE = ?
#
###### CONSTANT DETAIL MASTER END #####

GET_YAKEEN_STRIP_DATA=SELECT  * FROM Motor_YAKEEN_STRIP(?,?,'01')
GET_VEHICLE_DATA=SELECT vehicleMaker,vehicleModel,vehicleBody_ar,modelYear,plateNumber,plateText1_ar,plateText2_ar,plateText3_ar,chassisNumber,VEHICLECAPACITY FROM yakeen_carinfo_webdata where sequenceNumber\='984746210'
GET_MANUFACTURE_LIST =select country_name from MOTOR_MFG_COUNTRY_MASTER mf where amend_id\=(select max(amend_id) from  MOTOR_MFG_COUNTRY_MASTER where  country_code\=mf.country_code)  and country_id in (select * from FN_Split_SV(?,',')) order by 1


##############OTP##############

INSERT_OTP_DETAILS = INSERT INTO OTP_DATA_DETAIL(S_NO,OTP_ID,OTP_TYPE,OTP,ENTRY_DATE,EXPIRY_DATE,MOBILE_NO,EMAIL_ID,SESSION_ID,STATUS) VALUES((SELECT ISNULL(MAX(S_NO+1),1) S_NO FROM OTP_DATA_DETAIL),?,?,?,GETDATE(),DATEADD(minute,2,GETDATE()),?,?,?,?)
GET_OTP_COUNT =select count(*) from OTP where OTPNUMBER=? and sessionid=?
DELETE_OPT_DETAILS = DELETE FROM OTP WHERE sessionid=?
GET_OTP_DETAILS = SELECT OTPNUMBER FROM OTP WHERE sessionid=?
GET_TIMEEXPIRY_DETAILS =select count(*) from otp  where SESSIONID\=? AND OTPNUMBER\=? AND TO_NUMBER(TO_CHAR(SYSTIMESTAMP,'YYYYMMDDhh24mmssmi')) < TO_NUMBER(TO_CHAR(MAX_TIME,'YYYYMMDDhh24mmssmi'))

#### COMMON OTP #####

GET_OTP_ID =SELECT NEXT VALUE FOR OTP_SEQ_NO
UPDATE_OTP_DETAILS = UPDATE OTP_DATA_DETAIL SET OTP=?,ENTRY_DATE=GETDATE(),EXPIRY_DATE=DATEADD(minute,4,GETDATE()) WHERE OTP_ID = ?
GET_OTP_EXPIRY = SELECT FORMAT(EXPIRY_DATE,'dd/MM/yyyy HH:mm:ss') EXPIRY_DATE FROM OTP_DATA_DETAIL WHERE OTP_ID=?
CHECK_OTP_COUNT = SELECT COUNT(*) FROM OTP_DATA_DETAIL WHERE OTP=? AND OTP_ID=?
CHECK_OTP_EXPIRY =SELECT COUNT(*) FROM OTP_DATA_DETAIL WHERE dbo.UNIX_TIMESTAMP(GETDATE()) < dbo.UNIX_TIMESTAMP(EXPIRY_DATE)  AND OTP_ID\=? AND OTP\=? 

## ARABIC QUERY

GET_MOTOR_POL_COVERAGE_ALL_DTLS_AR=SELECT Y_ID,DESCRIPTION_ARABIC DESCRIPTION, SUM(DATA_VALUE) DATA_VALUE,IS_SELECTED,IS_ADDON,DELETABLE FROM MOTOR_POLICY_COVERAGE MPC WHERE STATUS = 'Y' AND APPLICATION_NO = ? AND GROUP_ID = ? AND X_ID = ? GROUP BY Y_ID,DESCRIPTION_ARABIC,IS_SELECTED,IS_ADDON,DELETABLE ORDER BY Y_ID
GET_MOTOR_POL_TYPE_AR=SELECT DISTINCT X_ID,X_DATA_NAME_ARABIC X_DATA_NAME,SUM(RATE) RATE,SUM(BASE_RATE) BASE_RATE,SUM(DATA_VALUE) DATA_VALUE,SUM(MIN_PREMIUM) MIN_PREMIUM FROM MOTOR_POLICY_COVERAGE  WHERE APPLICATION_NO=? AND STATUS='Y' AND GROUP_ID=0 GROUP BY  X_ID,X_DATA_NAME_ARABIC ORDER BY X_ID asc
GET_MOTOR_POL_GROUP_AR=SELECT DISTINCT MP.GROUP_ID,GROUP_DESC_ARABIC GROUP_DESC_ENGLISH,MG.DISPLAY_ORDER FROM MOTOR_POLICY_COVERAGE MP,MOTOR_GROUP_MASTER MG WHERE APPLICATION_NO\=? AND MG.BRANCH_CODE\=? AND MP.STATUS\='Y'  AND MP.GROUP_ID\=MG.GROUP_ID AND MG.AMEND_ID\=(SELECT MAX(AMEND_ID) FROM MOTOR_GROUP_MASTER  WHERE GROUP_ID\=MG.GROUP_ID) Group by MP.GROUP_ID,MG.GROUP_DESC_ARABIC,DISPLAY_ORDER ORDER BY MG.DISPLAY_ORDER

GET_MOTOR_PREMIUM_BASED_ON_VEHILCE_AR =SELECT GROUP_ID,POLICYTYPE_COVERID,SUM_INSURED,ISNULL(RATE,0) RATE,PREMIUM,OPCOVER_DESC_ARABIC OPCOVER_DESC_ENGLISH,DESCRIPTION,GROUP_DESC_ARABIC GROUP_DESC_ENGLISH FROM  MOTOR_POLICY_COVER_DATA MPCD WHERE APPLICATION_NO\=? AND BRANCH_CODE\=? AND VEHICLE_ID\=?  ORDER BY DISPLAY_ORDER,GROUP_ID,POLICYTYPE_COVERID

#########SMS/EMAIL TRIGGER START###########

##SMS TRIGER
#GET_SMS_CUST_INFO = SELECT ISNULL(P.TITLE, '') + '.' + ISNULL(P.FIRST_NAME, '') INSURED_NAME,P.LAST_NAME,P.EMAIL,P.MOBILE,(SELECT PAYMENT_TYPE FROM MOTOR_PAYMENT_DETAIL PD WHERE QUOTE_NO\=H.QUOTE_NO AND PD.REQUEST_TIME\=(SELECT MAX(REQUEST_TIME) FROM MOTOR_PAYMENT_DETAIL WHERE QUOTE_NO\=PD.QUOTE_NO)) PAYMENT_MODE,H.OVERALL_PREMIUM,CASE  H.PRODUCT_ID WHEN '65' THEN 'MOTOR' WHEN '30' THEN 'HOME' WHEN '33' THEN 'TRAVEL' END PRODUCT,H.POLICY_NO,(SELECT CONVERT(VARCHAR, RTRIM(XMLAGG(XMLELEMENT(E,ENDT_TYPE_DESC,',')).EXTRACT('//text()'),',')) ENDT_TYPE_DESC FROM ENDT_TYPE_MASTER ETM WHERE ETM.PRODUCT_ID\=H.PRODUCT_ID AND ETM.ENDT_TYPE_ID IN (SELECT DISTINCT(REGEXP_SUBSTR(H.ENDT_TYPE_ID,'[^,]+',1,LEVEL)) ENDT_TYPE_ID FROM DUAL B CONNECT BY LEVEL <\= LEN(H.ENDT_TYPE_ID) - LEN(REPLACE(H.ENDT_TYPE_ID,',',''))+1)) ENDT_TYPE_NAME,brok.*  FROM PERSONAL_INFO P, HOME_POSITION_MASTER H,   (SELECT HPM.QUOTE_NO,LM.USER_MAIL BROKER_MAIL,PM.MOBILE BROKER_MOBILE,PM.FIRST_NAME BROKER_NAME FROM LOGIN_MASTER LM,HOME_POSITION_MASTER HPM, PERSONAL_INFO PM WHERE LM.LOGIN_ID \= HPM.LOGIN_ID AND PM.AGENCY_CODE \= LM.AGENCY_CODE AND PM.APPLICATION_ID\='2') BROK WHERE H.CUSTOMER_ID \= P.CUSTOMER_ID AND    H.QUOTE_NO\=BROK.QUOTE_NO AND H.QUOTE_NO\=? 
#GET_SMS_CUST_INFO = SELECT ISNULL(P.TITLE, '') + '.' + ISNULL(P.FIRST_NAME, '') INSURED_NAME,P.LAST_NAME,P.EMAIL,P.MOBILE,(SELECT PAYMENT_TYPE FROM MOTOR_PAYMENT_DETAIL PD WHERE QUOTE_NO=H.QUOTE_NO AND PD.REQUEST_TIME=(SELECT MAX(REQUEST_TIME) FROM MOTOR_PAYMENT_DETAIL WHERE QUOTE_NO=PD.QUOTE_NO)) PAYMENT_MODE,(SELECT RESPONSE_MESSAGE FROM MOTOR_PAYMENT_DETAIL PD WHERE QUOTE_NO=H.QUOTE_NO AND PD.REQUEST_TIME=(SELECT MAX(REQUEST_TIME) FROM MOTOR_PAYMENT_DETAIL WHERE QUOTE_NO=PD.QUOTE_NO)) RES_DECISION,H.LANG,H.OVERALL_PREMIUM,CASE  H.PRODUCT_ID WHEN '65' THEN 'MOTOR' WHEN '30' THEN 'HOME' WHEN '33' THEN 'TRAVEL' END PRODUCT,H.POLICY_NO,brok.*  FROM PERSONAL_INFO P, HOME_POSITION_MASTER H,   (SELECT HPM.QUOTE_NO,LM.USER_MAIL BROKER_MAIL,PM.MOBILE BROKER_MOBILE,PM.FIRST_NAME BROKER_NAME FROM LOGIN_MASTER LM,HOME_POSITION_MASTER HPM, PERSONAL_INFO PM WHERE LM.LOGIN_ID = HPM.LOGIN_ID AND PM.AGENCY_CODE = LM.AGENCY_CODE AND PM.APPLICATION_ID='2') BROK WHERE H.CUSTOMER_ID = P.CUSTOMER_ID AND    H.QUOTE_NO=BROK.QUOTE_NO AND H.QUOTE_NO=?
GET_SMS_CUST_INFO = SELECT ISNULL(P.TITLE, '') + '.' + ISNULL(P.FIRST_NAME, '') INSURED_NAME,P.LAST_NAME,P.EMAIL,P.MOBILE,P.TELEPHONE,(SELECT PAYMENT_TYPE FROM MOTOR_PAYMENT_DETAIL PD WHERE QUOTE_NO=H.QUOTE_NO AND PD.REQUEST_TIME=(SELECT MAX(REQUEST_TIME) FROM MOTOR_PAYMENT_DETAIL WHERE QUOTE_NO=PD.QUOTE_NO)) PAYMENT_MODE,(SELECT RESPONSE_MESSAGE FROM MOTOR_PAYMENT_DETAIL PD WHERE QUOTE_NO=H.QUOTE_NO AND PD.REQUEST_TIME=(SELECT MAX(REQUEST_TIME) FROM MOTOR_PAYMENT_DETAIL WHERE QUOTE_NO=PD.QUOTE_NO)) RES_DECISION,H.LANG,H.OVERALL_PREMIUM,CASE  H.PRODUCT_ID WHEN '65' THEN 'MOTOR' WHEN '30' THEN 'HOME' WHEN '33' THEN 'TRAVEL' END PRODUCT,H.POLICY_NO  FROM  PERSONAL_INFO P,HOME_POSITION_MASTER H WHERE H.CUSTOMER_ID = P.CUSTOMER_ID AND H.QUOTE_NO = ?
#GET_SMS_CLAIM_INFO = SELECT MCI.CLAIM_NO,ISNULL(Pcd.TITLE, '')+'.'+ISNULL(Pcd.FIRST_NAME, '')+' '+ISNULL(Pcd.LAST_NAME, '') Insured_name,HPM.POLICY_NO,PCD.EMAIL FROM HOME_POSITION_MASTER HPM,MOTOR_CLAIM_INTIMATION MCI,Policy_Customer_Details Pcd  WHERE HPM.quote_no=? and MCI.POLICY_NO=HPM.POLICY_NO  and pcd.Policy_no=hpm.policy_no AND HPM.AMEND_ID=(SELECT MAX(AMEND_ID)  FROM  HOME_POSITION_MASTER HPMS WHERE HPM.QUOTE_NO=HPMS.QUOTE_NO  AND HPM.APPLICATION_NO=HPMS.APPLICATION_NO ) union all SELECT MCIT.CLAIM_NO,ISNULL(Pcd.TITLE, '')+'.'+ISNULL(Pcd.FIRST_NAME, '')+' '+ISNULL(Pcd.LAST_NAME, '') Insured_name,HPM.POLICY_NO,PCD.EMAIL FROM HOME_POSITION_MASTER HPM,MOTOR_CLAIM_INTIMATION_TPA MCIT,Policy_Customer_Details Pcd   WHERE  HPM.quote_no=? and MCIT.POLICY_NO=HPM.POLICY_NO and pcd.Policy_no=hpm.policy_no AND HPM.AMEND_ID=(SELECT MAX(AMEND_ID) FROM  HOME_POSITION_MASTER HPMS WHERE HPM.QUOTE_NO=HPMS.QUOTE_NO  AND HPM.APPLICATION_NO=HPMS.APPLICATION_NO )
GET_SMS_CLAIM_INFO = SELECT   MCI.CLAIM_NO, ISNULL(PCD.TITLE, '') + '.' + ISNULL(PCD.FIRST_NAME, '') + ' ' + ISNULL(PCD.LAST_NAME, '') INSURED_NAME, HPM.POLICY_NO, PCD.EMAIL,PCD.MOBILE FROM   HOME_POSITION_MASTER HPM, MOTOR_CLAIM_INTIMATION MCI, PERSONAL_INFO PCD WHERE HPM.POLICY_NO=MCI.POLICY_NO AND PCD.CUSTOMER_ID=HPM.CUSTOMER_ID AND MCI.CLAIM_NO=? AND HPM.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   HOME_POSITION_MASTER HPMS WHERE   HPM.QUOTE_NO = HPMS.QUOTE_NO AND HPM.APPLICATION_NO = HPMS.APPLICATION_NO) UNION ALL SELECT   MCIT.CLAIM_NO, ISNULL(PCD.TITLE, '') + '.' + ISNULL(PCD.FIRST_NAME, '') + ' ' + ISNULL(PCD.LAST_NAME, '') INSURED_NAME, HPM.POLICY_NO, PCD.EMAIL,PCD.MOBILE FROM   HOME_POSITION_MASTER HPM, MOTOR_CLAIM_INTIMATION_TPA MCIT, PERSONAL_INFO PCD WHERE       HPM.POLICY_NO = MCIT.POLICY_NO AND PCD.CUSTOMER_ID=HPM.CUSTOMER_ID AND MCIT.CLAIM_NO=? AND HPM.AMEND_ID = (SELECT   MAX (AMEND_ID) FROM   HOME_POSITION_MASTER HPMS WHERE   HPM.QUOTE_NO = HPMS.QUOTE_NO AND HPM.APPLICATION_NO = HPMS.APPLICATION_NO)
GET_SMS_USER_INFO = SELECT LM.USER_MAIL,PM.MOBILE,PM.FIRST_NAME CUST_NAME FROM LOGIN_MASTER LM,PERSONAL_INFO PM WHERE LM.LOGIN_ID = ? AND PM.AGENCY_CODE = LM.AGENCY_CODE AND PM.APPLICATION_ID='2'
GET_SMS_BROKER_INFO = SELECT LM.USER_MAIL,PM.MOBILE,PM.FIRST_NAME CUST_NAME FROM LOGIN_MASTER LM,PERSONAL_INFO PM WHERE LM.LOGIN_ID \= (SELECT LOGIN_ID FROM HOME_POSITION_MASTER WHERE QUOTE_NO \= ?) AND PM.AGENCY_CODE \= LM.AGENCY_CODE AND PM.APPLICATION_ID\='2' 
GET_QUOTE_SMS_STATUS = SELECT SMS_YN FROM HOME_POSITION_MASTER WHERE QUOTE_NO=?
UPD_QUOTE_SMS_STATUS = UPDATE HOME_POSITION_MASTER SET SMS_YN\=? WHERE QUOTE_NO\=? 
GET_SMS_ADMIN_INFO = SELECT USERNAME,MOBILE_NO,USER_MAIL FROM LOGIN_MASTER LM WHERE UPPER(LM.USERTYPE)=UPPER(?) AND LM.STATUS='Y'
GET_SMS_POLICYAPPROVER_DETAILS = SELECT DISTINCT USERNAME,USER_MAIL,MOBILE_NO FROM LOGIN_MASTER WHERE LOGIN_ID=(SELECT LOGIN_ID FROM UW_PROCESS_DETAIL WHERE QUOTE_NO=? AND TYPE=? AND STATUS=?)
INS_SMS_DETAILS = INSERT INTO SMS_DATA_DETAILS (SMS_REF_NO,CUST_NAME,MOBILE_NO,POLICY_NO,SMS_TYPE,SMS_CONTENT,REQ_TIME,REMARKS) VALUES (?,?,?,?,?,?,GETDATE(),?)
GET_SMS_SEQ =SELECT  NEXT VALUE FOR SMS_REF_SEQ
UPD_SMS_DETAILS = UPDATE SMS_DATA_DETAILS SET RES_TIME=GETDATE(),RES_STATUS=?,RES_CODE=?,RES_MESSAGE=?,REMARKS=? WHERE SMS_REF_NO=? AND SMS_TYPE=?
GET_QUOTE_NO_LIST_REMINDER = SELECT QUOTE_NO FROM HOME_POSITION_MASTER WHERE STATUS='Y'  AND PRODUCT_ID ='65' AND NULLIF(PAYMENT_STATUS,'') IS NULL AND NULLIF(REMARKS,'') IS NULL AND QUOTE_NO IS NOT NULL  AND ENTRY_DATE BETWEEN GETDATE()-4 AND GETDATE()-1 AND LOGIN_ID NOT IN ('tameenibroker')
GET_QUOTE_NO_LIST_RENWAL = SELECT QUOTE_NO FROM HOME_POSITION_MASTER WHERE STATUS='P'  AND PRODUCT_ID ='65' AND POLICY_NO IS NOT NULL AND QUOTE_NO IS NOT NULL  AND EXPIRY_DATE BETWEEN GETDATE()-30 AND GETDATE()-29 AND LOGIN_ID NOT IN ('tameenibroker')

##MAIL MASTER
##GET_SMS_EMAIL_TEMPLATE_LIST = SELECT SNO,CASE MAIL_REQUIRED WHEN 'Y' THEN 'Yes' WHEN 'N' THEN 'No' END MAIL_REQUIRED,MAIL_SUBJECT,MAIL_BODY,MAIL_REGARDS,CASE SMS_REQUIRED WHEN 'Y' THEN 'Yes' WHEN 'N' THEN 'No' END SMS_REQUIRED,SMS_SUBJECT,SMS_BODY_EN,EMAIL_TO,EMAIL_CC,SMS_TO,USER_TYPE,SMS_REGARDS,CASE STATUS WHEN 'Y' THEN 'Active' WHEN 'N' THEN 'Deactive' END STATUS,ENTRY_DATE,REMARKS FROM MAIL_TEMPLATE_MASTER ORDER BY SNO ASC
GET_SMS_EMAIL_TEMPLATE_LIST = SELECT SNO,CASE MAIL_REQUIRED WHEN 'Y' THEN 'Yes' WHEN 'N' THEN 'No' END MAIL_REQUIRED,MAIL_SUBJECT,MAIL_BODY,MAIL_REGARDS,CASE SMS_REQUIRED WHEN 'Y' THEN 'Yes' WHEN 'N' THEN 'No' END SMS_REQUIRED,SMS_SUBJECT,SMS_BODY_EN,SMS_BODY_AR,SMS_REGARDS,EMAIL_TO,EMAIL_CC,SMS_TO,USER_TYPE,SMS_REGARDS_AR,CASE STATUS WHEN 'Y' THEN 'Active' WHEN 'N' THEN 'Deactive' END STATUS,ENTRY_DATE,REMARKS FROM MAIL_TEMPLATE_MASTER ORDER BY SNO ASC
##EDIT_SMS_EMAIL_TEMPLATE = SELECT MAIL_REQUIRED,MAIL_SUBJECT,MAIL_BODY,MAIL_REGARDS,SMS_REQUIRED,EMAIL_TO,EMAIL_CC,USER_TYPE,SMS_TO,SMS_SUBJECT,SMS_BODY,SMS_REGARDS,STATUS,ENTRY_DATE,REMARKS FROM MAIL_TEMPLATE_MASTER WHERE SNO=?
EDIT_SMS_EMAIL_TEMPLATE = SELECT MAIL_REQUIRED,MAIL_SUBJECT,MAIL_BODY,MAIL_REGARDS,SMS_REQUIRED,SMS_SUBJECT,SMS_BODY_EN,SMS_BODY_AR,SMS_REGARDS,STATUS,ENTRY_DATE,REMARKS,EMAIL_TO,EMAIL_CC,USER_TYPE,SMS_TO,SMS_REGARDS_AR FROM MAIL_TEMPLATE_MASTER WHERE SNO=?
INSERT_SMS_EMAIL_TEMPLATE = INSERT INTO MAIL_TEMPLATE_MASTER (SNO,MAIL_REQUIRED,MAIL_SUBJECT,MAIL_BODY,MAIL_REGARDS,SMS_REQUIRED,SMS_SUBJECT,SMS_BODY,SMS_REGARDS,STATUS,ENTRY_DATE,REMARKS,EMAIL_TO,EMAIL_CC,SMS_TO,USER_TYPE) VALUES ((SELECT ISNULL(MAX(SNO),0)+1 FROM MAIL_TEMPLATE_MASTER),?,?,?,?,?,?,?,?,?,GETDATE(),?)
##UPDATE_SMS_EMAIL_TEMPLATE = UPDATE MAIL_TEMPLATE_MASTER SET MAIL_REQUIRED=?,MAIL_SUBJECT=?,MAIL_BODY=?,MAIL_REGARDS=?,SMS_REQUIRED=?,SMS_SUBJECT=?,SMS_BODY=?,SMS_REGARDS=?,STATUS=?,ENTRY_DATE=GETDATE(),REMARKS=?,EMAIL_TO=?,EMAIL_CC=?,SMS_TO=?,USER_TYPE=? WHERE SNO=?
UPDATE_SMS_EMAIL_TEMPLATE = UPDATE MAIL_TEMPLATE_MASTER SET MAIL_REQUIRED=?,MAIL_SUBJECT=?,MAIL_BODY=?,MAIL_REGARDS=?,SMS_REQUIRED=?,SMS_SUBJECT=?,SMS_BODY_EN=?,SMS_REGARDS=?,STATUS=?,ENTRY_DATE=GETDATE(),REMARKS=?,EMAIL_TO=?,EMAIL_CC=?,SMS_TO=?,USER_TYPE=?,SMS_BODY_AR=?,SMS_REGARDS_AR=? WHERE SNO=?
GET_SMS_EMAIL_CONTENT  = SELECT SMS_TO,MAIL_REQUIRED,MAIL_SUBJECT,MAIL_BODY,MAIL_REGARDS,SMS_REQUIRED,EMAIL_TO,EMAIL_CC,USER_TYPE,SMS_SUBJECT,SMS_BODY_EN,SMS_BODY_AR,SMS_REGARDS,SMS_REGARDS_AR,STATUS,ENTRY_DATE,REMARKS FROM   MAIL_TEMPLATE_MASTER WHERE   SNO = ? AND STATUS='Y'

##EMAIL ATTACHMENT
INS_ATTACHMENT =Insert into EMAIL_ATTACHMENT_DETAILS (DOC_ID, CONTENT_ID, FILE_PATH_NAME, DESCRIPTION, PRODUCT_ID, STATUS, FILE_NAME,REMARKS,UPLOAD_TIME) Values ((SELECT ISNULL(MAX(doc_id),0)+1 from EMAIL_ATTACHMENT_DETAILS),?,?,?,?,?,?,?,getdate()+6/24) 
GET_EMAIL_ATTACHMENT_LIST = SELECT * FROM EMAIL_ATTACHMENT_DETAILS WHERE PRODUCT_ID\=? and CONTENT_ID\=? 
DEL_ATTACHMENT = delete  from EMAIL_ATTACHMENT_DETAILS Where FILE_PATH_NAME=? and DOC_ID=?

#########SMS/EMAIL TRIGGER END###########

##UWProcess
GET_PAYMENT_PROCESS_DETAILS = SELECT * FROM POLICY_APPROVER_DETAILS(?,?,?,?,?,?,?)
GET_PREMIUM_DETAILS_PAY_PROCESS = SELECT HPM.APPLICATION_NO,HPM.BRANCH_CODE,HPM.QUOTE_NO,HPM.CUSTOMER_ID,HPM.POLICY_NO,HPM.PREMIUM,HPM.POLICY_FEE,HPM.OVERALL_PREMIUM,CONVERT(VARCHAR(11),HPM.INCEPTION_DATE,103)INCEPTION_DATE,CONVERT(VARCHAR(11), HPM.EXPIRY_DATE,103)EXPIRY_DATE,MPM.QUOTE_NO, MPM.CHEQUE_NO, (SELECT MB.BANK_NAME_ENGLISH FROM MOTOR_BANK_MASTER MB WHERE MB.BANK_ID =MPM.BANK_NAME AND AMEND_ID =(SELECT MAX(AMEND_ID) FROM MOTOR_BANK_MASTER MBM WHERE MBM.BANK_ID =MB.BANK_ID)) BANK_NAME, MPM.MICR_CODE, MPM.CHEQUE_AMOUNT,CONVERT(VARCHAR(11),MPM.CHEQUE_DATE,103) CHEQUE_DATE, MPM.REQUEST_TIME,MPM.RESPONSE_TIME, MPM.RESPONSE_TRAN_NO, MPM.RESPONSE_STATUS, MPM.RESPONSE_MESSAGE, MPM.CARD_NUMBER_MASKED, MPM.RESPONSE_CODE,MPM.MERCHANT_REFERENCE, MPM.PAYMENT_TYPE,MPM.RESPONSE_AMT,PAYMENT_TYPE MODE_OF_PAYMENT FROM   MOTOR_PAYMENT_DETAIL MPM, HOME_POSITION_MASTER HPM, PERSONAL_INFO PI WHERE       MPM.QUOTE_NO  = ? AND HPM.QUOTE_NO  = MPM.QUOTE_NO AND MPM.PRODUCT_ID  = HPM.PRODUCT_ID AND HPM.BRANCH_CODE  = ? AND PI.CUSTOMER_ID  = HPM.CUSTOMER_ID AND MPM.MERCHANT_REFERENCE  = ( SELECT   MAX (MERCHANT_REFERENCE) FROM   MOTOR_PAYMENT_DETAIL PD WHERE   PD.QUOTE_NO  = MPM.QUOTE_NO)
INS_PAYMENT_PROCESS_DETAILS = INSERT INTO UW_PROCESS_DETAIL(SNO,POLICY_NO,QUOTE_NO,TYPE,STATUS,RESPONSE_TIME,REMARKS,LOGIN_ID,ALLOCATED_PERSON) VALUES ((SELECT NVL(MAX(SNO),0)+1 FROM UW_PROCESS_DETAIL),?,?,?,?,getdate(),?,?,?)
UPD_PAYMENT_PROCESS_DETAILS =UPDATE HOME_POSITION_MASTER SET STATUS  = ?, LAPSED_REMARKS =?,LAPSED_DATE =getdate(),LAPSED_UPDATED_BY =?,APPR_CAN_BY =?,APPR_CAN_DT =SYSTIMESTAMP,APPR_CAN_REMARKS =? WHERE QUOTE_NO =?
GET_HOME_APPROVERPENDING_LIST =SELECT * FROM (POLICY_APPROVER_DETAILS(?,?,?,?,?,?,?))
GET_NAJM_VALIDATE_DETAILS = SELECT CONVERT(VARCHAR(11),MDD.GRE_EFF_DATE,103) GRE_EFF_DATE,CONVERT(VARCHAR(11),MDD.GRE_EXPIRE_DATE,103) GRE_EXPIRE_DATE,CONVERT(VARCHAR(11), MDD.GRE_ISSUE_DATE,103) GRE_ISSUE_DATE,MDD.AREA_COVERAGE,MDD.NEWORRENEW, PI.SALES_USERID, PI.USERTYPE ,CONVERT(VARCHAR(11), PI.DOB,103) DOB,PI.NATIONALITY,MDD.MAKE_ID, MDD.MODEL_ID, MDD.VEHICLE_COLOR,PI.COMPANY_REG_NO,MDD.SEATING_CAPACITY,MDD.WEIGHT_OF_VEHICLE,MDD.PREMIUM,MDD.FINANCIAL_TRANID,MDD.sub_model,CONVERT(VARCHAR(11), MDD.VEHICLE_INCEPTION_DATE,103) VEHICLE_INCEPTION_DATE,CONVERT(VARCHAR(11), MDD.VEHICLE_ISSUE_DATE,103) VEHICLE_ISSUE_DATE,CONVERT(VARCHAR(11), MDD.VEHICLE_EXPIRY_DATE,103) VEHICLE_EXPIRY_DATE,CONVERT(VARCHAR(11), MDD.GRE_ISTMARAEXPIRE_DATE,103) ISTAMARA_GRE_EXP_DATE,CONVERT(VARCHAR(11), MDD.HIJRI_ISTMARA_EXPIREDATE,103) ISTAMARA_HIJRI_EXP_DATE,MDD.SEQUENCE_NO,PI.CUSTOMER_TYPE FROM MOTOR_DATA_DETAIL MDD, PERSONAL_INFO PI WHERE PI.CUSTOMER_ID=MDD.CUSTOMER_ID AND APPLICATION_NO = ? AND QUOTE_NO = ?
UPD_MOTOR_DATA_DETAILS =UPDATE MOTOR_DATA_DETAIL SET EFFECTIVE_DATE \=getdate(),STATUS \=?,GRE_ISSUE_DATE \=CONVERT(VARCHAR(11),?,103),VEHICLE_ISSUE_DATE \=CONVERT(VARCHAR(11),?,103),HIJRI_ISSUE_DATE \=convert(varchar,?,131) WHERE APPLICATION_NO  \= ? AND QUOTE_NO  \= ? 
UPD_DOCUMENT_STATUS = UPDATE DOCUMENT_UPLOAD_DETAILS SET OP_STATUS=?,OP_REMARKS=? WHERE DOC_TYPE_ID = ? AND QUOTE_NO = ? AND FILE_PATH_NAME=?

GET_CHECKER_STATUS_OP = GET_CHECKER_STATUS_OP = SELECT CHECKER_YN FROM LOGIN_USER_DETAILS LUD WHERE PRODUCT_ID=? AND LOGIN_ID=? AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM LOGIN_USER_DETAILS LD WHERE LUD.LOGIN_ID =LD.LOGIN_ID )
GET_CHECKER_STATUS = SELECT CHECKER_YN FROM BROKER_COMMISSION_DETAIL WHERE AGENCY_CODE=(SELECT DISTINCT OA_CODE FROM LOGIN_USER_DETAILS WHERE LOGIN_ID=? AND PRODUCT_ID=?) AND POLICYTYPE=?
GET_ENDT_CANCEL_DETAILS = SELECT INITCAP(ENDT_BY) ENDT_BY,TO_CHAR(ENDT_DATE,'DD/MM/YYYY') ENDT_DATE,TO_CHAR(ENTRY_DATE,'DD/MM/YYYY') ENTRY_DATE,DECODE(ENDT_STATUS,'Y','YES','YES') ENDT_STATUS,CANCELLED_REASON,CANCELLED_BY,TO_CHAR(CANCELLED_DATE,'DD/MM/YYYY') CANCELLED_DATE,INSURED_BY,DECODE(INSURED_BY,'1','AIG','2','OTHERS') INSURED_BY_NAME,OTHER_POLICYNO FROM HOME_POSITION_MASTER WHERE QUOTE_NO=? AND ENDT_TYPE_ID IS NOT NULL

NAJM_POSTING_POLICY_DETAILS =SELECT NAJAM_ID,RESPONSE_TIME,RES_DESCRP,RES_NNPID,RES_STATUS,REQUEST_TIME FROM  NAJAM_POLICY_DETAILS WHERE QUOTE_NO = ? UNION ALL SELECT NAJAM_ID,RESPONSE_TIME,RES_DESCRP,RES_NNPID,RES_STATUS,REQUEST_TIME FROM  NAJAM_POLICY_DETAILS_ARCH  WHERE QUOTE_NO = ? AND RES_STATUS IS NOT NULL
NAJM_POSTING_VEHICLE_DETAILS =SELECT NNPID,RESPONSE_TIME,RES_DESCRP,RES_NNVID,RES_STATUS,REQUEST_TIME FROM  NAJAM_VEHICLE_DETAILS WHERE QUOTE_NO = ? UNION ALL SELECT NNPID,RESPONSE_TIME,RES_DESCRP,RES_NNVID,RES_STATUS,REQUEST_TIME FROM  NAJAM_VEHICLE_DETAILS_ARCH WHERE QUOTE_NO = ? AND RES_STATUS IS NOT NULL
NAJM_ACCIDENTAL_DETAILS_VIEW =SELECT ROW_NUMBER() OVER(ORDER BY CASENUMBER) SNO,CASENUMBER,CONVERT(VARCHAR(10),ACCIDENTDATE,101) ACCIDENTDATE,LIABILITY,CITYNAME,DRIVERAGE,CARMODEL,CARTYPE,DRIVERID,SEQUENCENUMBER,OWNERID,ESTIMATEDAMOUNT, DAMAGEPARTS,CAUSEOFACCIDENT,CASEDETAILS_ID,CONVERT(VARCHAR(10),RECIVED_DATE,103) RECEIVED_DATE FROM NIJM_ACCIDENTAL_DETAILS WHERE DRIVERID = ?

GET_MOTOR_SEARCH_LIST=SELECT HPM.POLICY_NO, HPM.APPLICATION_NO, HPM.QUOTE_NO,HPM.LOGIN_ID USER_LOGIN_ID, PI.CUSTOMER_ID, ISNULL(PI.FIRST_NAME, '') + ' ' + ISNULL(PI.LAST_NAME, '') CUSTOMER_NAME, PI.MOBILE, (SELECT   POLICYTYPE_DESC_ENGLISH FROM   MOTOR_POLICYTYPE_MASTER MPM WHERE   MPD.ISSELECTCOVER = MPM.POLICY_SUBTYPE_ID ) POLICYTYPE, (SELECT   PRODUCT_NAME FROM   PRODUCT_MASTER PT WHERE   PT.PRODUCT_ID = HPM.PRODUCT_ID) PRODUCT_NAME, CONVERT(VARCHAR,HPM.INCEPTION_DATE,103)  START_DATE, CONVERT(VARCHAR,HPM.EXPIRY_DATE,103)        END_DATE, '' REMARKS, HPM.OVERALL_PREMIUM,HPM.ENDT_TYPE_ID,HPM.STATUS,  CASE  HPM.STATUS WHEN 'N' THEN 'NAJAM PENDING' WHEN 'Y' THEN 'QUOTE PROCESS' WHEN 'P' THEN 'POLICY GENERATE'  WHEN 'D' THEN 'CANCELLED POLICY' END STATUS_DESC FROM   HOME_POSITION_MASTER HPM, PERSONAL_INFO PI, MOTOR_POLICY_DETAILS MPD, MOTOR_DATA_DETAIL  MDD WHERE PI.CUSTOMER_ID = HPM.CUSTOMER_ID AND HPM.QUOTE_NO = MPD.QUOTENO  AND MDD.APPLICATION_NO=HPM.APPLICATION_NO  AND HPM.PRODUCT_ID IN ('65')
###### YAKEEN  ######

GET_YAKEEN_DET_LIST = SELECT * FROM yakeen_info( 'YAKEENHIT',?,NULL,NULL) 
##SELECT OWNERNAME AS  OWNER_NAME ,OWNERID IQAMA_ID, VEHICLEMAKER MAKE_CODE,VEHICLEMODEL MODEL_CODE,MODELYEAR MODEL_YEAR,CHASSISNUMBER CHASSIS_NO, PLATETEXT1_AR AS PLATE_CHAR_1 ,PLATETEXT2_AR AS PLATE_CHAR_2,PLATETEXT3_AR AS PLATE_CHAR_3,PLATENUMBER , VEHICLECAPACITY SEATING_CAPACITY, MAJORCOLOR_AR VEHICLE_COLOR,REGEXPIRYDATE ISTMARA_EXPIRY_DATE,REGPLACE VEHICLE_REGPLACE_CODE,* FROM YAKEEN_CARINFO_WEBDATA YK WHERE ISNULL(NULLIF(REFERENCE_NO,''),SEQUENCENUMBER)=? AND YK.REQUEST_ID=(SELECT MAX(REQUEST_ID) FROM YAKEEN_CARINFO_WEBDATA YCW WHERE YCW.SEQUENCENUMBER=YK.SEQUENCENUMBER)
##GET_INFO_DET_LIST = SELECT MM.MAKE_NAME,MMM.MODEL_NAME, (SELECT BODY_NAME FROM MOTOR_BODYTYPE_MASTER MBM WHERE BODY_ID=MMM.BODY_ID AND STATUS='Y' AND AMEND_ID= (SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_MASTER MBM WHERE BODY_ID=MBM.BODY_ID )) "BODY_NAME", (SELECT COUNTRY_NAME FROM MOTOR_MFG_COUNTRY_MASTER WHERE COUNTRY_ID=MM.COUNTRY_ID AND STATUS='Y') "COUNTRY_NAME", (SELECT VEHICLETYPE_DESC FROM MOTOR_VEHICLETYPE_MASTER MVM WHERE VTYPE_ID=MMM.VTYPE_ID AND STATUS='Y' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_VEHICLETYPE_MASTER  WHERE MVM.VTYPE_ID=VTYPE_ID))"VEHICLE_USE",MAM.AREACOVER_DESC_ENGLISH,(SELECT REGION_NAME  FROM MOTOR_REGION_MASTER WHERE REGION_ID=MAM.REGION_ID) "REGION_NAME" FROM MOTOR_MAKE_MASTER MM, MOTOR_MODEL_MASTER MMM, YAKEEN_CARINFO_WEBDATA YCW, MOTOR_AREACOVERAGE_MASTER MAM WHERE MM.YAKEEN_CODE=YCW.VEHICLEMAKER AND MMM.YAKEEN_MAKE_ID =YCW.VEHICLEMAKER AND YCW.VEHICLEMODEL =MMM.YAKEEN_CODE AND MAM.NAJM_CODE=YCW.REGPLACE AND YCW.SEQUENCENUMBER=?
##SELECT OWNERNAME AS  OWNER_NAME ,OWNERID IQAMA_ID, VEHICLEMAKER MAKE_CODE,VEHICLEMODEL MODEL_CODE,MODELYEAR MODEL_YEAR,CHASSISNUMBER CHASSIS_NO, PLATETEXT1_AR AS PLATE_CHAR_1 ,PLATETEXT2_AR AS PLATE_CHAR_2,PLATETEXT3_AR AS PLATE_CHAR_3,PLATENUMBER , VEHICLECAPACITY SEATING_CAPACITY, MAJORCOLOR_AR VEHICLE_COLOR,REGEXPIRYDATE ISTMARA_EXPIRY_DATE,REGPLACE VEHICLE_REGPLACE_CODE,* FROM YAKEEN_CARINFO_WEBDATA YK WHERE ISNULL(NULLIF(REFERENCE_NO,''),SEQUENCENUMBER)=? AND YK.REQUEST_ID=(SELECT MAX(REQUEST_ID) FROM YAKEEN_CARINFO_WEBDATA YCW WHERE YCW.SEQUENCENUMBER=YK.SEQUENCENUMBER)
##GET_INFO_DET_LIST = SELECT MM.MAKE_NAME,MMM.MODEL_NAME, (SELECT BODY_NAME FROM MOTOR_BODYTYPE_MASTER MBM WHERE BODY_ID=MMM.BODY_ID AND STATUS='Y' AND AMEND_ID= (SELECT MAX(AMEND_ID) FROM MOTOR_BODYTYPE_MASTER MBM WHERE BODY_ID=MBM.BODY_ID )) "BODY_NAME", (SELECT COUNTRY_NAME FROM MOTOR_MFG_COUNTRY_MASTER WHERE COUNTRY_ID=MM.COUNTRY_ID AND STATUS='Y') "COUNTRY_NAME", (SELECT VEHICLETYPE_DESC FROM MOTOR_VEHICLETYPE_MASTER MVM WHERE VTYPE_ID=MMM.VTYPE_ID AND STATUS='Y' AND AMEND_ID=(SELECT MAX(AMEND_ID) FROM MOTOR_VEHICLETYPE_MASTER  WHERE MVM.VTYPE_ID=VTYPE_ID))"VEHICLE_USE",MAM.AREACOVER_DESC_ENGLISH,(SELECT REGION_NAME  FROM MOTOR_REGION_MASTER WHERE REGION_ID=MAM.REGION_ID) "REGION_NAME" FROM MOTOR_MAKE_MASTER MM, MOTOR_MODEL_MASTER MMM, YAKEEN_CARINFO_WEBDATA YCW, MOTOR_AREACOVERAGE_MASTER MAM WHERE MM.YAKEEN_CODE=YCW.VEHICLEMAKER AND MMM.YAKEEN_MAKE_ID =YCW.VEHICLEMAKER AND YCW.VEHICLEMODEL =MMM.YAKEEN_CODE AND MAM.NAJM_CODE=YCW.REGPLACE AND YCW.SEQUENCENUMBER=?

#GET_POLICY_COUNT=select   Count(*)    from motor_data_detail mdd,home_position_master hpm,personal_info pi  where  pi.customer_id\=?  and  hpm.quote_no\=mdd.quote_no and mdd.owner_id\=pi.company_reg_no  and pi.customer_id\=hpm.customer_id and hpm.product_id\=?  and nullif(hpm.policy_no,'') is not null
GET_POLICY_COUNT=select   Count(*)    from motor_data_detail mdd,home_position_master hpm,personal_info pi  where  pi.customer_id\=?  and  hpm.quote_no\=mdd.quote_no and mdd.owner_id\=pi.company_reg_no  and pi.customer_id\=hpm.customer_id and hpm.product_id\=?  and nullif(hpm.policy_no,'') is not null and hpm.status in ('P','N')    

GET_NEW_MISSIPPI_CUSTOMER_CODE=SELECT NEXT VALUE FOR  MOT_MISSICUST_SEQ FROM DUAL
GET_OLD_MISSIPPI_CUSTOMER_CODE=select   distinct pi.MISSIPPI_CUSTOMER_CODE CUST_CODE  from motor_data_detail mdd,home_position_master hpm,personal_info pi where  pi.company_reg_no\=?  and  hpm.quote_no\=mdd.quote_no and mdd.owner_id\=pi.company_reg_no and pi.customer_id\=hpm.customer_id  and hpm.product_id\=?  and nullif(hpm.policy_no,'') is not null AND NULLIF(pi.MISSIPPI_CUSTOMER_CODE,'')  IS NOT NULL  
UPDATE_MISSIPPI_CUSTOMER_CODE=update personal_info set MISSIPPI_CUSTOMER_CODE\=? where CUSTOMER_ID\=?
GET_COUNT_CUST_INFO=SELECT  COUNT(*)   FROM PERSONAL_INFO PI WHERE APPLICATION_ID='2' AND CUSTOMER_ID=? AND AMEND_ID=(SELECT  MAX(AMEND_ID) FROM PERSONAL_INFO PK WHERE  PI.CUSTOMER_ID=PK.CUSTOMER_ID) AND EXISTS (SELECT 'Y'  FROM HOME_POSITION_MASTER HPM  WHERE NULLIF(POLICY_NO,'') IS NOT NULL AND PRODUCT_ID=?  AND HPM.CUSTOMER_ID=pi.CUSTOMER_ID)
INSERT_CUSTOMER_INFO=INSERT INTO PERSONAL_INFO(CUSTOMER_ID,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,NATIONALITY,DOB,GENDER,TELEPHONE,MOBILE,FAX,EMAIL,ADDRESS1,ADDRESS2,OCCUPATION,POBOX,COUNTRY,EMIRATE,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,ENTRY_DATE,REMARKS,STATUS,LOGIN_ID,AC_EXECUTIVE_ID,AGENCY_CODE,OA_CODE,COMPANY_NAME,MISSIPPI_CUSTOMER_CODE,CITY,FREIGHT_FORWARD_USER,CUSTOMER_LOGIN_ID,CUSTOMER_SOURCE,FD_CODE,CLIENT_CUSTOMER_ID,CUST_AR_NO,CUST_NAME,PASSPORT_NUMBER,NRC,CUSTOMER_TYPE,COMPANY_REG_NO,CUST_NAME_ARABIC,DOB_AR,ALTERNATE_MOBILE,INS_POCODE,BUILDING_NO,ADDITIONAL_NO,SALES_USERID,INS_CITY,ZIPCODE,NEIGHBORHOOD,UNITNO,STREET,ADDRESS_IDENTIFIER,INS_POBOX,WASEEL_BUILDINGNO,WASEEL_ADDITIONAL_NO,WASEEL_ZIPCODE,WASEEL_CITY,WASEEL_NEIGHBORHOOD,INSUREDID_VER_TYPE,POLICY_MAX_LIABILITY,DRIVER_AGE_LIMIT,EXPIRE_GREDATE,EFFECTIVE_GREDATE,NEWORRENEW,INSURED_ID,USERTYPE,ISSUE_GREDATE,QUOTE_TYPE)SELECT  NEXT VALUE FOR  CUSTOMER_SEQ,APPLICATION_ID,TITLE,FIRST_NAME,LAST_NAME,NATIONALITY,DOB,GENDER,TELEPHONE,MOBILE,FAX,EMAIL,ADDRESS1,ADDRESS2,OCCUPATION,POBOX,COUNTRY,EMIRATE,AMEND_ID,INCEPTION_DATE,EXPIRY_DATE,EFFECTIVE_DATE,GETDATE(),REMARKS,STATUS,LOGIN_ID,AC_EXECUTIVE_ID,AGENCY_CODE,OA_CODE,COMPANY_NAME,MISSIPPI_CUSTOMER_CODE,CITY,FREIGHT_FORWARD_USER,CUSTOMER_LOGIN_ID,CUSTOMER_SOURCE,FD_CODE,CLIENT_CUSTOMER_ID,CUST_AR_NO,CUST_NAME,PASSPORT_NUMBER,NRC,CUSTOMER_TYPE,COMPANY_REG_NO,CUST_NAME_ARABIC,DOB_AR,ALTERNATE_MOBILE,INS_POCODE,BUILDING_NO,ADDITIONAL_NO,SALES_USERID,INS_CITY,ZIPCODE,NEIGHBORHOOD,UNITNO,STREET,ADDRESS_IDENTIFIER,INS_POBOX,WASEEL_BUILDINGNO,WASEEL_ADDITIONAL_NO,WASEEL_ZIPCODE,WASEEL_CITY,WASEEL_NEIGHBORHOOD,INSUREDID_VER_TYPE,POLICY_MAX_LIABILITY,DRIVER_AGE_LIMIT,EXPIRE_GREDATE,EFFECTIVE_GREDATE,NEWORRENEW,INSURED_ID,USERTYPE,ISSUE_GREDATE,QUOTE_TYPE   FROM PERSONAL_INFO PI WHERE APPLICATION_ID='2' AND CUSTOMER_ID=? AND AMEND_ID=(SELECT  MAX(AMEND_ID) FROM PERSONAL_INFO PK WHERE  PI.CUSTOMER_ID=PK.CUSTOMER_ID) AND EXISTS (SELECT 'Y'  FROM HOME_POSITION_MASTER HPM  WHERE NULLIF(POLICY_NO,'') IS NOT NULL AND PRODUCT_ID=?  AND HPM.CUSTOMER_ID=pi.CUSTOMER_ID)
UPDATE_CUSTOMER_APPID=UPDATE PERSONAL_INFO SET APPLICATION_ID\='1' WHERE CUSTOMER_ID\=?

GETMAX_MERCHANT_ID=select max(MERCHANT_REFERENCE) MERCHANT_REFERENCE from motor_payment_detail where quote_no\=?

GETFEEDBACKGRID=SELECT MFD.*,PI.CUST_NAME CUST_NAME,PI.EMAIL EMAIL FROM MOTOR_FEEDBACK_DETAIL MFD,HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE HPM.QUOTE_NO\=MFD.QUOTE_NO AND PI.CUSTOMER_ID\=HPM.CUSTOMER_ID AND  MFD.QUOTE_NO IS NOT NULL and CONVERT(DATE,MFD.ENTRY_DATE,103) BETWEEN CONVERT(DATE,?,103) AND CONVERT(DATE,?,103) ORDER BY MFD.ENTRY_DATE DESC
GETFEEDBACKGRIDBYQUOTE=SELECT MFD.*,PI.CUST_NAME CUST_NAME,PI.EMAIL EMAIL FROM MOTOR_FEEDBACK_DETAIL MFD,HOME_POSITION_MASTER HPM,PERSONAL_INFO PI WHERE HPM.QUOTE_NO\=MFD.QUOTE_NO AND PI.CUSTOMER_ID\=HPM.CUSTOMER_ID AND MFD.QUOTE_NO IS NOT NULL AND MFD.QUOTE_NO \=? ORDER BY MFD.ENTRY_DATE DESC
UPDATEFEEDBACKBYQUOTE=update MOTOR_FEEDBACK_DETAIL set adminRemarks\=?,adminstatus\=? where quote_no\=?

TAMEENI_VEHICLEID_POST_BY_QUOTE =select ebroker_id,RequestReferenceNo REQUESTREFERENCENO,InsuranceCompanyCode ,Quotereferenceno QUOTEREFERENCENO,RES_NNVID NAJMVEHICLEID,E_Policyuploadeddatetime POLICYUPLOADEDDATETIME,E_Entrydate,E_Status,E_Res_status,E_Res_error,RES_STATUS,RES_NNVID ,QUOTE_NO from NAJAM_VEHICLE_DETAILS where STATUS\='C' and upper(RES_STATUS)\=upper('submitted') and RES_NNVID is not null and ebroker_id\='101' and E_NAJMVEHICLEID is not null and QUOTE_NO\=?
GET_DOC_APP_DRPDWN = SELECT ITEM_VALUE,ITEM_CODE FROM LIST_ITEM_VALUE WHERE STATUS='Y' and ITEM_TYPE='DOCPOLICYTYPE'
GET_PROMO_TYPE = SELECT POLICYTYPE_DESC_ENGLISH, POLICY_SUBTYPE_ID FROM MOTOR_POLICYTYPE_MASTER MPM WHERE STATUS = 'Y' AND AMEND_ID = (SELECT MAX (AMEND_ID) FROM MOTOR_POLICYTYPE_MASTER WHERE POLICY_SUBTYPE_ID = MPM.POLICY_SUBTYPE_ID) AND BRANCH_CODE =? ORDER BY POLICYTYPE_DESC_ENGLISH
UPLOAD_PROGRESS_STATUS = select (case when STATUS='U' then 'Processing' when STATUS='V' then 'Converted to CSV' when STATUS='R' then 'Moved to Raw' when STATUS='M' then 'Moving to Master' when STATUS='C' then 'Moved' when STATUS='E' then 'Moved' end) STATUS from BATCHUPLOAD_TRAN_DETAILS where BATCH_ID=?
GET_MAX_DISPLAYORDER = SELECT MAX(DISPLAY_ORDER)+1 MAXDISPLAY FROM DOCUMENT_MASTER

ISREFERRALQUOTE=select count(*) from home_position_master  where APPLICATION_NO=? and STATUS='Y' and  REMARKS='Admin'
UPD_REFERAL_QUOTE=update MOTOR_POLICY_COVERAGE set REFERAL_DESC\=?,REFERAL_STATUS\='Y' WHERE APPLICATION_NO\=? and X_ID\=? 

##GET_SEARCH_BY_QUOTE_LIST = SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), pm.application_no, 103) desc) SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,OVERALL_PREMIUM premium,nullif (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,convert (varchar(10),pm.entry_date, 105),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name FROM home_position_master pm, personal_info pi WHERE pi.customer_id = pm.customer_id AND (case ? when 'ALL' THEN 'A' else pm.product_id end)=(case convert(varchar,?) when 'ALL' then 'A' else convert(varchar,?) end) AND LOWER (pm.status) IN ('Y') and pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN ('01'))) AND pm.QUOTE_NO = ?
#GET_SEARCH_BY_QUOTE_LIST = SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), pm.application_no, 103) desc) SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,OVERALL_PREMIUM premium,nullif (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,convert (varchar(10),pm.entry_date, 105),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name,pm.STATUS FROM home_position_master pm, personal_info pi WHERE pi.customer_id = pm.customer_id AND (case ? when 'ALL' THEN 'A' else pm.product_id end)=(case convert(varchar,?) when 'ALL' then 'A' else convert(varchar,?) end) AND pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN ('01'))) AND pm.QUOTE_NO = ?
GET_SEARCH_BY_QUOTE_LIST = SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), pm.application_no, 103) desc) SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name, premium,nullif (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,convert (varchar(10),pm.entry_date, 105),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name,pm.STATUS FROM position_master pm, personal_info pi WHERE pi.customer_id = pm.customer_id AND (case ? when 'ALL' THEN 'A' else pm.product_id end)=(case convert(varchar,?) when 'ALL' then 'A' else convert(varchar,?) end) AND pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN ('01'))) AND pm.QUOTE_NO = ?
##GET_SEARCH_BY_POLICY_LIST = SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), pm.application_no, 103) desc) SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name,OVERALL_PREMIUM premium,nullif (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,convert (varchar(10),pm.entry_date, 105),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name FROM home_position_master pm, personal_info pi WHERE pi.customer_id = pm.customer_id AND (case ? when 'ALL' THEN 'A' else pm.product_id end)=(case convert(varchar,?) when 'ALL' then 'A' else convert(varchar,?) end) AND LOWER (pm.status) IN ('Y') and pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN ('01'))) AND pm.POLICY_NO = ?
GET_SEARCH_BY_POLICY_LIST = SELECT ROW_NUMBER() OVER ( ORDER BY CONVERT (varchar (10), pm.application_no, 103) desc) SNO,pm.application_no,(select COMPANY_NAME from broker_company_master where agency_code in (select agency_code from login_master lm1 where agency_code in (select distinct(oa_code) from login_master lm2 where lm2.login_id=pm.login_id))) broker_organization,pm.login_id,pm.quote_no,pm.remarks,pi.first_name, premium,nullif (pm.EXCESS_PREMIUM, '0') EXCESS_PREMIUM,pi.COMPANY_NAME,pi.LAST_NAME,pm.POLICY_NO,convert (varchar(10),pm.entry_date, 105),PRODUCT_ID,(Select product_name from product_master pmm where pmm.product_id=pm.product_id) product_name,pm.STATUS FROM position_master pm, personal_info pi WHERE pi.customer_id = pm.customer_id AND (case ? when 'ALL' THEN 'A' else pm.product_id end)=(case convert(varchar,?) when 'ALL' then 'A' else convert(varchar,?) end) AND pi.amend_id=(select max(amend_id) from personal_info p where pi.customer_id=p.customer_id) AND pm.login_id IN (SELECT login_id FROM login_master WHERE oa_code IN (SELECT agency_code FROM broker_company_master WHERE branch_code IN ('01'))) AND pm.POLICY_NO = ?

CAL_MOTOR_CALC_REF = {CALL MOTOR_REFERAL_PREMIUM_CALC(?,?)}
GET_WEB_CUSTOMER_INFORMATION=SELECT COMPANY_REG_NO,ADDITIONALNUMBER,BUILDINGNUMBER,CITY,POSTCODE,STREETNAME,DISTRICT,STATUS FROM YAKEEN_ADDRESSINFO WHERE COMPANY_REG_NO=? AND STATUS='Y'
GET_COMM_MOTOR=select bcd.COMMISSION_PERCENTAGE from broker_commission_detail bcd,login_master lm,home_position_master hpm,MOTOR_DATA_DETAIL mdd where mdd.quote_no=hpm.QUOTE_NO  and lm.login_id=hpm.rate_login_id and lm.oa_code=bcd.AGENCY_CODE and mdd.POLICYTYPE=bcd.POLICYTYPe and  hpm.PRODUCT_ID=bcd.product_id and bcd.AMEND_ID=(select  max(AMEND_ID) from BROKER_COMMISSION_DETAIL where AGENCY_CODE=bcd.AGENCY_CODE and bcd.POLICYTYPE=POLICYTYPE) and hpm.APPLICATION_NO=?


## For vat calculation

GET_VAT_INFO_HPM = SELECT   bcm.COMMISSION_VAT_YN,hpm.COMMISSION,CONVERT(VARCHAR(10),hpm.INCEPTION_DATE, 103) as POL_START_DATE,ISNULL(hpm.OVERALL_PREMIUM,'0') - ISNULL(hpm.VAT_PREMIUM, '0') NET_PREMIUM,ISNULL (hpm.Policy_fee, '0') POLICY_FEE, bcm.RSA_BROKER_CODE, bcm.VAT_REG_NO BROKER_VAT_REG_NO,pi.MISSIPPI_CUSTOMER_CODE, pi.VAT_REG_NO CUST_VAT_REG_NO, pi.CUST_VAT_YN,'' BDM_CODE, '' BDM_VAT_REG_NO, '5' AC_EXECUTIVE_ID FROM  personal_info pi, broker_company_master bcm,HOME_POSITION_MASTER hpm WHERE bcm.AGENCY_CODE IN (SELECT   OA_CODE FROM   LOGIN_MASTER WHERE   LOGIN_ID \= hpm.LOGIN_ID) AND hpm.CUSTOMER_ID \= pi.CUSTOMER_ID  AND hpm.quote_no \=?
GET_VAT_INFO = select bcm.COMMISSION_VAT_YN,CONVERT(VARCHAR(10),md.INCEPTION_DATE, 103) as POL_START_DATE,md.VAT_APPLICABLE,ISNULL(md.PREMIUM,0)+ISNULL(md.Policy_fee,'0')+ISNULL(md.EXCESS_PREMIUM,'0') NET_PREMIUM,ISNULL(md.Policy_fee,'0') POLICY_FEE, md.FINAL_DESTINATION_COUNTRY_ID,md.TRANSIT_FROM_COUNTRY_ID, pm.COMMISSION  COMMISSION,(select COUNTRY_NAME from country_master cm where COUNTRY_ID\= md.FINAL_DESTINATION_COUNTRY_ID and AMEND_ID \= (select max(AMEND_ID) from country_master cm1 where cm1.COUNTRY_ID\=cm.COUNTRY_ID ))ORG_COUNTRY,( select COUNTRY_NAME from country_master cm where COUNTRY_ID\= md.TRANSIT_FROM_COUNTRY_ID and AMEND_ID \= (select max(AMEND_ID) from country_master cm1 where cm1.COUNTRY_ID\=cm.COUNTRY_ID )) DEST_COUNTRY,md.AC_EXECUTIVE_ID,bcm.RSA_BROKER_CODE ,bcm.VAT_REG_NO BROKER_VAT_REG_NO,pi.MISSIPPI_CUSTOMER_CODE,pi.VAT_REG_NO CUST_VAT_REG_NO,pi.CUST_VAT_YN, led.RSACODE  BDM_CODE,led.VAT_REG_NO BDM_VAT_REG_NO from marine_data md,personal_info pi,broker_company_master bcm,position_master pm,login_executive_details led where bcm.AGENCY_CODE IN (SELECT OA_CODE FROM LOGIN_MASTER WHERE LOGIN_ID\=pm.LOGIN_ID) and pm.application_no\=md.application_no  and  pm.CUSTOMER_ID\=pi.CUSTOMER_ID and  md.AC_EXECUTIVE_ID\=led.AC_EXECUTIVE_ID and pm.quote_no\=?
GET_VAT_YN = SELECT COUNT(*) FROM CONSTANT_DETAIL WHERE CATEGORY_ID=205 AND BRANCH_CODE='01' AND REMARKS=? AND STATUS='Y'
GET_VAT_PERCENT = SELECT PERCENTRATE VAT_TAX FROM CONSTANT_DETAIL  WHERE CATEGORY_DETAIL_ID=1 and CATEGORY_ID=204 AND STATUS='Y' and  convert(date,RSACODE,103)<=convert(date,?,103)
DEL_VAT_INFO= delete from VAT_INFO where QUOTE_NO=?
INSERT_VAT_INFO=Insert into VAT_INFO(QUOTE_NO, PRODUCT_ID, VAT_CUSTOMER_CODE, VAT_REG_NO, VAT_PERCENTAGE,VAT_AMOUNT, POLICY_TYPE, ORG_COUNTRY, DEST_COUNTRY, VAT_FLAG,VAT_TO) Values  (?, ?, ?, ?,?, abs(?), ?, ?, ?, ?,?)
UPDATE_VAT_MD=update marine_data set VAT_TAX_PERCENT =?,VAT_TAX_AMT=convert(decimal(15,2),cast(? as float)) ,VAT_COMMISSION=convert(decimal(15,2),cast(? as float)) ,VAT_COMMISSION_PERCENT=?,VAT_REGION_CODE=? where application_no =(select  application_no from position_master where quote_no=?)
UPDATE_VAT_PM=update POSITION_MASTER  set PREMIUM =? -isnull(EXCESS_PREMIUM,0) where  quote_no=?
UPDATE_VAT_HPM=update HOME_POSITION_MASTER set OVERALL_PREMIUM = convert(decimal(15,2),cast(? as float)) ,VAT_PERCENT=? ,VAT_PREMIUM=convert(decimal(15,2),cast(? as float)) ,VAT_COMMISSION =convert(decimal(15,2),cast(? as float)) where quote_no =?

GET_VAT_STATUS_HAU = SELECT count(*) FROM CONSTANT_DETAIL  WHERE CATEGORY_DETAIL_ID\=1 and CATEGORY_ID\=204 AND STATUS\='Y' and  convert(date,RSACODE,103)<\=(select ENTRY_DATE from  marine_vehicle_transaction_details where policy_no \=?) 
GET_VAT_STATUS_PM  = SELECT count(*) FROM CONSTANT_DETAIL  WHERE CATEGORY_DETAIL_ID\=1 and CATEGORY_ID\=204 AND STATUS\='Y' and  convert(date,RSACODE,103)<\=(SELECT   max(INCEPTION_DATE) FROM   position_master WHERE   isnull(CERTIFICATE_NO,policy_no) \=? )
GET_VAT_STATUS_HPM = SELECT count(*) FROM CONSTANT_DETAIL  WHERE CATEGORY_DETAIL_ID=1 and CATEGORY_ID=204 AND STATUS='Y' and  convert(date,RSACODE,103)<=(select INCEPTION_DATE from  home_position_master where policy_no=?)
GET_VAT_STATUS_OC  =  SELECT count(*) FROM CONSTANT_DETAIL  WHERE CATEGORY_DETAIL_ID=1 and CATEGORY_ID=204 AND STATUS='Y' and  convert(date,RSACODE,103)<=(select POLICY_EFFECTIVE_DATE from  open_cover_position_master where OPEN_COVER_NO =?)

GET_INTG_COUNT   =  select count(*) from marine_integration_data  where POLICY_NO=?
GET_INTG_COUNT_DEC=select count(*) from marine_integration_data  where POLICY_NO in(select min(policy_no) from position_master where CERTIFICATE_NO=? and status in ('P','D'))
UPDATE_INTG_PM   = update POSITION_MASTER set CKEY\=?,INTEGRATION_STATUS\=?,INTEGRATION_ERROR\=? where POLICY_NO\=? 
UPDATE_INTG_DEC  = update POSITION_MASTER set CKEY\=?,INTEGRATION_STATUS\=?,INTEGRATION_ERROR\=? where CERTIFICATE_NO\=? 
UPDATE_INTG_OCPM =  update OPEN_COVER_POSITION_MASTER set CKEY=?,INTEGRATION_STATUS=?,INTEGRATION_ERROR=? where OPEN_COVER_NO=?
UPDATE_INTG_MVD  =   update marine_vehicle_transaction_details set CKEY=?,INTEGRATION_STATUS=?,INTEGRATION_ERROR=? where OPEN_COVER_NO=?

#Intg Status
ONEOFFCERTIFICATE = select quote_no,(select FIRST_NAME from PERSONAL_INFO where CUSTOMER_ID=pm.CUSTOMER_ID) CUST_NAME,policy_no,PREMIUM,LOGIN_ID,OPEN_COVER_NO,'ONEOFFCERTIFICATE' TYPE	,ISNULL(INTEGRATION_STATUS,'N') INTEGRATION_STATUS,INTEGRATION_ERROR from POSITION_MASTER pm  where PM.POLICY_EFFECTIVE_DATE Between CONVERT(DATE,?,103) and CONVERT(DATE,?,103) and CERTIFICATE_NO is null and pm.policy_no is not null and status in ('P','D') and pm.login_id in(select  login_id from LOGIN_MASTER where OA_CODE in  (select AGENCY_CODE from BROKER_COMPANY_MASTER  where branch_code=?))
OPENDEPOSITPREMIUM = select ocpm.PROPOSAL_NO QUOTE_NO,(select FIRST_NAME from PERSONAL_INFO where CUSTOMER_ID\=ocm.CUSTOMER_ID) CUST_NAME,ocpm.OPEN_COVER_NO POLICY_NO,ocm.BROKER_ID LOGIN_ID ,ocpm.INTEGRATION_STATUS ,ocpm.INTEGRATION_ERROR ,'OPENDEPOSITPREMIUM' TYPE,ocm.MARINE_PREMIUM PREMIUM from OPEN_COVER_POSITION_MASTER ocpm, open_cover_master ocm where ocm.PROPOSAL_NO \= ocpm.PROPOSAL_NO  and  ocpm.POLICY_EFFECTIVE_DATE Between CONVERT(DATE,?,103) and CONVERT(DATE,?,103) and ocpm.status\='P' AND  ocm.BROKER_ID in (select  login_id from LOGIN_MASTER where OA_CODE in  (select AGENCY_CODE from BROKER_COMPANY_MASTER  where branch_code\=?)) 
LANDTRANSIT = select tran_id ,(select FIRST_NAME from PERSONAL_INFO where CUSTOMER_ID=pm.CUSTOMER_ID) CUST_NAME,BASE_OPENCOVER_NO ,policy_no,premium,INTEGRATION_STATUS,INTEGRATION_ERROR from marine_vehicle_transaction_details pm where PM.POLICY_EFFECTIVE_DATE Between CONVERT(DATE,?,103) and CONVERT(DATE,?,103) and POLICY_NO is not null and pm.BROKER_id  in (select  login_id from LOGIN_MASTER where OA_CODE in  (select AGENCY_CODE from BROKER_COMPANY_MASTER  where branch_code=?))
DECLARATIONUPLOAD =select min(quote_no) quote_no,(select FIRST_NAME from PERSONAL_INFO where CUSTOMER_ID\=pm.CUSTOMER_ID) CUST_NAME,min(policy_no) ,CERTIFICATE_NO policy_no,sum(PREMIUM) PREMIUM,LOGIN_ID,OPEN_COVER_NO,'DECLARATIONUPLOAD' TYPE,INTEGRATION_STATUS,INTEGRATION_ERROR from POSITION_MASTER pm where PM.POLICY_EFFECTIVE_DATE Between CONVERT(DATE,?,103) and CONVERT(DATE,?,103) and CERTIFICATE_NO is not null and status in ('P','D') and pm.login_id in(select  login_id from LOGIN_MASTER where OA_CODE in  (select AGENCY_CODE from BROKER_COMPANY_MASTER  where branch_code\=?))  group by pm.CUSTOMER_ID,INTEGRATION_STATUS,INTEGRATION_ERROR,CERTIFICATE_NO,pm.LOGIN_ID,OPEN_COVER_NO


### PROMO CODE
GET_B2CPROMO_EXISTINGQUOTE_LIST = SELECT A.APPLICATION_NO, a.quote_no, A.CONTENT_TYPE_ID, a.customer_id,CONVERT(VARCHAR,A.INCEPTION_DATE,103) QUOTATION_DATE, CONVERT(VARCHAR,A.INCEPTION_DATE,103) VALIDITY_DATE, B.FIRST_NAME CUSTOMER_NAME, A.LOGIN_ID, B.COMPANY_NAME, B.EMAIL, A.INCEPTION_DATE, null OPEN_COVER_NO, ISNULL(a.OVERALL_PREMIUM,'0') PREMIUM,a.POLICY_NO POLICY_NO FROM HOME_POSITION_MASTER a, personal_info b  WHERE a.RATE_LOGIN_ID =? AND  NULLIF(a.remarks,'') IS NULL  AND NULLIF(a.ADMIN_REFERRAL_STATUS,'') IS NULL  AND b.customer_id = a.customer_id  AND a.product_id = ?   AND NULLIF(a.PAYMENT_STATUS,'') IS NULL AND A.quote_no IS NOT NULL AND B.AMEND_ID=(SELECT MAX(AMEND_ID) FROM PERSONAL_INFO WHERE CUSTOMER_ID = B.CUSTOMER_ID)
GET_MOTOR_SEARCH_LIST_PROMO=SELECT HPM.POLICY_NO, HPM.APPLICATION_NO, HPM.QUOTE_NO,HPM.LOGIN_ID USER_LOGIN_ID, PI.CUSTOMER_ID, ISNULL(PI.FIRST_NAME, '') + ' ' + ISNULL(PI.LAST_NAME, '') CUSTOMER_NAME, PI.MOBILE, (SELECT   POLICYTYPE_DESC_ENGLISH FROM   MOTOR_POLICYTYPE_MASTER MPM WHERE   MPD.ISSELECTCOVER \= MPM.POLICY_SUBTYPE_ID ) POLICYTYPE, (SELECT   PRODUCT_NAME FROM   PRODUCT_MASTER PT WHERE   PT.PRODUCT_ID \= HPM.PRODUCT_ID) PRODUCT_NAME, CONVERT(VARCHAR,HPM.INCEPTION_DATE,103)  START_DATE, CONVERT(VARCHAR,HPM.EXPIRY_DATE,103)        END_DATE, '' REMARKS, HPM.OVERALL_PREMIUM,HPM.ENDT_TYPE_ID,HPM.STATUS, CONVERT(VARCHAR,HPM.INCEPTION_DATE,103) QUOTATION_DATE, CONVERT(VARCHAR,HPM.INCEPTION_DATE,103) VALIDITY_DATE,ISNULL(HPM.OVERALL_PREMIUM,'0') PREMIUM, CASE  HPM.STATUS WHEN 'N' THEN 'NAJAM PENDING' WHEN 'Y' THEN 'QUOTE PROCESS' WHEN 'P' THEN 'POLICY GENERATE'  WHEN 'D' THEN 'CANCELLED POLICY' END STATUS_DESC,HPM.POLICY_NO POLICY_NO FROM   HOME_POSITION_MASTER HPM, PERSONAL_INFO PI, MOTOR_POLICY_DETAILS MPD, MOTOR_DATA_DETAIL  MDD WHERE PI.CUSTOMER_ID \= HPM.CUSTOMER_ID AND HPM.QUOTE_NO \= MPD.QUOTENO  AND MDD.APPLICATION_NO\=HPM.APPLICATION_NO  AND HPM.PRODUCT_ID IN ('65') and HPM.RATE_LOGIN_ID\=?

## FEEDBACK QUERY#
WALAA_FEEDBACKINSERT=INSERT INTO TBLSMSSENT (GROUPID, CUSTOMERID, CUSTOMERNAME, MOBILENO, [MESSAGE], SENTON_DATE, SENTON_TIME, [SENT], ENTRY_BY,ENTRY_DATE, ENTRY_TIME, REMARKS, MODULE, DOCNO, MSG_TYPE) VALUES(CONVERT(VARCHAR, GETDATE(), 21), ?, ?, ?, ?, CAST(CONVERT(VARCHAR, GETDATE(), 101) AS DATE), NULL, '0', ?, CAST(CONVERT(VARCHAR, GETDATE(), 101) AS DATE), CONVERT(VARCHAR, GETDATE(), 108), 'Online motor SMS', 'Online Policy', ?, 'PER')
WALAA_FEEADBACKINPUT=SELECT MISSIPPI_CUSTOMER_CODE CUSTOMERID,CUST_NAME CUSTOMERNAME_EN,CUST_NAME CUSTOMERNAME_AR,'966'+RIGHT(PI.MOBILE,9) MOBILENO,HPM.LOGIN_ID LOGIN_ID,HPM.POLICY_NO POLICY_NO FROM PERSONAL_INFO PI,HOME_POSITION_MASTER HPM WHERE HPM.QUOTE_NO=? AND HPM.CUSTOMER_ID=PI.CUSTOMER_ID
MOTOR_DROP_DOWN_LIST =SELECT ITEM_CODE CODE, ITEM_VALUE CODEDESC FROM LIST_ITEM_VALUE WHERE ITEM_TYPE \= ? AND STATUS \= 'Y' ORDER BY ITEM_CODE ASC

GET_MOTOR_POLYTYPERATE_LIST = SELECT APPLICATION_NO, POLICYTYPE, FINAL_BASE_RATE, ENTRY_DATE, PLATETYPE, REFERALL_REMARKS, REFERALL_STATUS, BASE_RATE, DEDUCTIBLE_RATE, DRIVERAGE_RATE, REGION_RATE, VEHICLEUSE_RATE, GENDER_RATE, BASE_PREMIUM, NCD_DISC_PERCENT, NCD_PREMIUM, DERIVED_BASE_PREMIUM, MIN_PREMIUM, GROSS_PREMIUM, PA_DRIVER, PA_PASSENGER, GCC_COVER_JORDAN, TOWING_BENEFIT, TOTAL_PREMIUM, LOYAL_LOAD_RATE, LOYAL_DISCOUNT_RATE, PADRIVER, PAPASSENGER, TPL_LOADING, TOWING_PREMIUM, NCDYEARS, DRIVERAGE_premium, DEDUCTIBLE_PREMIUM,SUMINSURED FROM  FACTOR_RATE_TRAN_DETAILS  WHERE APPLICATION_NO = ? AND POLICYTYPE = ?
GET_MOTOR_POLYTYPE_LIST = select policytype_desc_english, policy_subtype_id  from motor_policytype_master a where status = 'Y' and amend_id=(select max(amend_id) from motor_policytype_master b where b.policy_subtype_id = a.policy_subtype_id) and policy_subtype_id in (select POLICYTYPE from FACTOR_RATE_TRAN_DETAILS WHERE APPLICATION_NO = ?)
GET_UN_RELATIVE_LIST=SELECT  ITEM_CODE FROM LIST_ITEM_VALUE WHERE ITEM_TYPE='DRIVER_RELATIONSHIP' AND PARAM1='N' AND  STATUS='Y'
GET_COMP_NCD_PERCENT=SELECT COUNT(*) FROM MOTOR_DATA_DETAIL WHERE  NCD_COMP_APPL_PERC>60 AND APPLICATION_NO=?
GET_TPL_NCD_PERCENT=SELECT COUNT(*) FROM MOTOR_DATA_DETAIL WHERE  NCD_TPL_APPL_PERC>50 AND APPLICATION_NO=?
  
  
GET_MARINE_PAYMENT_REPORT  =  select  * from (select  X.policy_no,NO_OF_TERMS,X.BRANCH_CODE,X.BRANCH_NAME,X.BROKER_CODE,X.BROKER_NAME,X.CUSTOMER_NAME,X.BASE_POLICY_NO,X.OPEN_COVER_NO,X.TYPE, X.POLICY_EFFECTIVE_DATE,OCP.DUE_Percentage,OCP.DUE_AMOUNT,(X.PREMIUM-ISNULL(OCP.DUE_AMOUNT,'0')) as   DIFFERENCE ,CASE WHEN OCP.DUE_Percentage<>'100' THEN 'Sum Of Due Percentage Should be 100%' WHEN OCP.DUE_Percentage<>'100' THEN 'Sum Of Due Percentage Should be 100%' WHEN OCP.DUE_AMOUNT IS NULL THEN 'Please Submit Payment Terms' else 'Difference Premium'  end AS Remarks from (Select policy_no,ISNULL(OVERALL_PREMIUM,0)+ISNULL(VAT_PREMIUM,0) PREMIUM,BRANCH_CODE,BRANCH_NAME,CUSTOMER_NAME,BASE_POLICY_NO,OPEN_COVER_NO,TYPE,BROKER_CODE,BROKER_NAME,POLICY_EFFECTIVE_DATE from marine_integration_data where CONVERT(DATE,POLICY_EFFECTIVE_DATE,103) Between CONVERT(DATE,?,103) and CONVERT(DATE,?,103)AND OVERALL_PREMIUM>0) X LEFT JOIN ( SELECT   POLICY_NO,COUNT(*) AS NO_OF_TERMS,SUM(CAST(ISNULL(NULLIF(DUE_AMOUNT,''),0) AS   DECIMAL(15,5))) DUE_AMOUNT, SUM(CAST(ISNULL(NULLIF(DUE_PERCENTAGE,''),0) AS DECIMAL(15,2))) DUE_PERCENTAGE FROM OPEN_COVER_PAYMENT_TERMS OCPT WHERE OCPT.PRODUCT_TYPE  IN ('11C','3C','11D','13T','11P') AND OCPT.AMEND_ID=(SELECT MAX(AMEND_ID) FROM OPEN_COVER_PAYMENT_TERMS OCT WHERE OCT.POLICY_NO=OCPT.POLICY_NO AND OCPT.SNO=OCT.SNO) GROUP BY POLICY_NO ) OCP ON ( (CASE WHEN X.TYPE='DECLARATIONUPLOAD'  THEN X.OPEN_COVER_NO ELSE X.policy_no END)=OCP.policy_no) ) bb where (bb.DIFFERENCE<>0 OR DUE_Percentage<>'100')
GET_MARINE_PRODUCTION_REPORT =  Select * from marine_integration_data where CONVERT(DATE,POLICY_EFFECTIVE_DATE,103) Between CONVERT(DATE,?,103) and CONVERT(DATE,?,103) order by BRANCH_CODE ,Type,Policy_no



#####Claim Query
#GET_CLAIM_APP=Select Application_No,(select BRANCH_CODE from login_master lm where lm.login_id=pm.login_id) Branch_code,TO_CHAR(Trunc(pm.INCEPTION_DATE),'DD/MM/YYYY HH/MM/SS') INCEPTION_DATE  From Position_Master pm Where Regexp_substr(Policy_No,'[^-]+',1,1)=? and amend_id=(Select max(Amend_id) from position_master p Where  Regexp_substr(P.Policy_No,'[^-]+',1,1)=Regexp_substr(pm.Policy_No,'[^-]+',1,1))
GET_CLAIM_APP=select Application_No,product_id,(select BRANCH_CODE from login_master lm where lm.login_id=pm.login_id) Branch_code, INCEPTION_DATE, reverse(substring(reverse(substring(Policy_No,charindex('-',Policy_No),len(Policy_No))), charindex(',',reverse(substring(Policy_No,charindex('-',Policy_No),len(Policy_No)))), len(substring(Policy_No,charindex('-',Policy_No),len(Policy_No))))) from position_master PM where Policy_No = ? AND amend_id=(Select max(Amend_id) from position_master p Where reverse(substring(reverse(substring(P.Policy_No,charindex('-',P.Policy_No),len(P.Policy_No))), charindex(',',reverse(substring(P.Policy_No,charindex('-',P.Policy_No),len(P.Policy_No)))), len(substring(P.Policy_No,charindex('-',P.Policy_No),len(P.Policy_No)))))= reverse(substring(reverse(substring(PM.Policy_No,charindex('-',PM.Policy_No),len(PM.Policy_No))), charindex(',',reverse(substring(PM.Policy_No,charindex('-',PM.Policy_No),len(PM.Policy_No)))), len(substring(P.Policy_No,charindex('-',PM.Policy_No),len(PM.Policy_No))))))
#GET_CLAIM_SCHEDULE=select * from table(schedule_reports(?,?))
GET_CLAIM_SCHEDULE=SELECT * FROM SCHEDULE_REPORTS(?,?,?,?)
GET_COUNT_POLICYNO=SELECT COUNT(POLICY_NO) FROM POSITION_MASTER WHERE POLICY_NO=?
COUNT_CLAIM_POLICYNO=SELECT COUNT(POLICY_NO) FROM Claim_Intimation  WHERE POLICY_NO\=? and status\=? 
#GET_CLAIM_CONDITION=SELECT CODEDESC FROM TABLE(SELECT VIEWCLAUSES(?,?,?) FROM DUAL)
GET_CLAIM_CONDITION=SELECT CODEDESC from VIEWCLAUSES(?,?,?)
GET_BELONGING_BRANCH=select BELONGING_BRANCH from BRANCH_MASTER bm where bm.BRANCH_CODE=? and  AMEND_ID=(select max(AMEND_ID) from BRANCH_MASTER where BRANCH_CODE=bm.BRANCH_CODE)
SAVE_CLAIM=INSERT INTO CLAIM_INTIMATION (CLAIM_NO,PRODUCT_ID,POLICY_NO,LOSS_DATE,LOSS_DESCRIPTION,INTIMATION_DATE,CLAIM_REPORTED_DATE,STATUS,REMARKS,SNO,CLAIM_INTIMATED_BY)VALUES(?,?,?,CONVERT(date,?,103),?,GETDATE(),GETDATE(),?,?,?,?)
#GET_CLAIM_INTIMATION=Select Count(Policy_No) POLICY_COUNT,TO_CHAR(Trunc(Ci.Intimation_Date),'DD/MM/YYYY') INTIMATION_DATES From Claim_Intimation Ci WHERE STATUS\=? Group By Trunc(Ci.Intimation_Date) Order By Trunc(Ci.Intimation_Date) Asc
GET_CLAIM_INTIMATION=Select Count(Policy_No) POLICY_COUNT, CONVERT(VARCHAR(10),CONVERT(DATE,CI.INTIMATION_DATE,106),103) INTIMATION_DATES From Claim_Intimation Ci WHERE STATUS=? Group By CONVERT(VARCHAR(10),CONVERT(DATE,CI.INTIMATION_DATE,106),103)  Order By CONVERT(VARCHAR(10),CONVERT(DATE,CI.INTIMATION_DATE,106),103)  Asc  
#GET_CLAIM_PENDING=select policy_no,customer_name,TO_CHAR(Trunc(Ci.claim_reported_date),'DD/MM/YYYY') REPORTED_DATE,loss_description from claim_intimation ci where TO_CHAR(Trunc(Ci.Intimation_Date),'DD/MM/YYYY')=? AND STATUS=?
GET_CLAIM_PENDING=select policy_no,CLAIM_NO,CLAIM_INTIMATED_BY CUSTOMER_NAME, CONVERT(VARCHAR(10),CONVERT(DATE,CI.claim_reported_date,106),103) REPORTED_DATE,loss_description from claim_intimation ci where CONVERT(VARCHAR(10),CONVERT(DATE,CI.INTIMATION_DATE,106),103)=? AND STATUS=?
#GET_CLAIM_EXTRA_DETAIL=SELECT TO_CHAR(Trunc(Ci.LOSS_DATE),'DD/MM/YYYY') LOSS_DATE,LOSS_DESCRIPTION,TO_CHAR(Trunc(Ci.INTIMATION_DATE),'DD/MM/YYYY') INTIMATION_DATE FROM CLAIM_INTIMATION Ci WHERE POLICY_NO =? and STATUS=?
GET_CLAIM_EXTRA_DETAIL=SELECT CONVERT(VARCHAR(10),CONVERT(DATE,CI.LOSS_DATE,106),103) LOSS_DATE,LOSS_DESCRIPTION,  CONVERT(VARCHAR(10),CONVERT(DATE,CI.INTIMATION_DATE,106),103)  INTIMATION_DATE ,CLAIM_NO FROM CLAIM_INTIMATION CI WHERE POLICY_NO =? AND STATUS=?
UPDATE_CLAIM=UPDATE CLAIM_INTIMATION SET REMARKS=?,STATUS=?,REMARKS_DATE=GETDATE()  WHERE POLICY_NO=?


GET_TRANSACTION_LIST1=select policy_no, tran_id,CONVERT(date,entry_date,103)ENTRY_DATE,upload_file_name,total_no_of_records,Status, floor(premium) as premium  from marine_vehicle_transaction_details where BASE_OPENCOVER_NO=? and Status in ('N')
GET_TRANSACTION_LIST2=select policy_no, tran_id,CONVERT(date,entry_date,103)ENTRY_DATE,upload_file_name,total_no_of_records,Status, floor(premium) as premium  from marine_vehicle_transaction_details where BASE_OPENCOVER_NO=? and Status in ('Y','D') and policy_no is not null
GET_HAULIER_DETAILS=SELECT PROPOSAL_NO,HAULIER_CATEGORY,FLOOR(END_LIMIT)END_LIMIT, NO_OF_VEHICLES,FLOOR(HAULIER_PREMIUM)HAULIER_PREMIUM,FLOOR(TOTAL_PREMIUM),FLOOR(START_LIMIT)START_LIMIT FROM OPEN_COVER_HAULIER_DETAILS where PROPOSAL_NO=? order by SNO
GET_VEHICLE_TRANS_SEQ=select next value for  marine_vehicle_tran_seq
GET_DB_COLUMS=SELECT DB_COLUMN_NAME,EXCEL_HEADER_NAME,DATA_TYPE FROM TMAS_VALIDATION WHERE ACTIVE='Y'
GET_VAT_TAX_PERCENT=select isnull(VAT_TAX_PERCENT,5) from open_cover_master ocm where ocm.MISSIPPI_OPENCOVER_NO=? and ocm.AMEND_ID=(select max(AMEND_ID) from open_cover_master where MISSIPPI_OPENCOVER_NO=?)
UPDATE_RANGE_VALIDATION=update marine_vehicle_details_raw set  ERROR_MSG= isnull(nullif(ERROR_MSG,''),'') +'~Limit ' Cast(marine_vehicle_details_raw.LIMIT as varchar(50))+' is Not in a Range for Sno ' Cast(marine_vehicle_details_raw.SNO as varchar(50)) ,ERROR_STATUS='Y' where  sno not in( select A.SNO from (select mvd.SNO from marine_vehicle_details_raw mvd,OPEN_COVER_HAULIER_DETAILS ochs,constant_detail cd where mvd.LIMIT    between ochs.START_LIMIT and ochs.END_LIMIT and ochs.proposal_no=? and cd.DETAIL_NAME=mvd.HAULIER_CATEGORY_ID and RSACODE='HAULIERCATG' and tran_id=? and cd.CATEGORY_DETAIL_ID=ochs.HAULIER_CATEGORY_ID) A ) and tran_id=?
UPDATE_EFEECTIVE_DATE_VALIDATION=update mvd set ERROR_MSG= isnull(nullif(ERROR_MSG,''),'') +'~Effective Date '+convert(varchar(10),mvd.INCEPTION_DATE,121)+' Must be in a Range of policy Start Date and Policy End Date for Sno  '+convert(varchar,mvd.SNO ) , ERROR_STATUS='Y' from marine_vehicle_details_raw mvd,open_cover_master ocm where  CONVERT(date,mvd.INCEPTION_DATE,103) not between convert(date,ocm.POLICY_START_DATE,103)  and convert(date,ocm.POLICY_END_DATE,103) and  ocm.proposal_no=? and ocm.AMEND_ID=(select max(amend_id) from OPEN_COVER_MASTER where proposal_no=? ) and mvd.tran_id=?
GET_VEHICLE_RAW_COUNT=select count(*)  from  marine_vehicle_details_raw where ERROR_STATUS='Y' and tran_id=?
UPDATE_RAW_ACTUAL_PREMIUM=UPDATE marine_vehicle_details_raw SET ACTUAL_PREMIUM=convert(varchar, (SELECT   CONVERT(decimal(20,2), CAST(HAULIER_PREMIUM AS FLOAT)) FROM   OPEN_COVER_HAULIER_DETAILS OCHD WHERE  marine_vehicle_details_raw.LIMIT BETWEEN START_LIMIT AND END_LIMIT AND proposal_no =? AND HAULIER_CATEGORY_ID =(SELECT   CATEGORY_DETAIL_ID FROM   constant_detail  WHERE  DETAIL_NAME = marine_vehicle_details_raw.HAULIER_CATEGORY_ID AND RSACODE = 'HAULIERCATG' AND CATEGORY_ID = 167))/CONVERT(decimal(20,2), CAST(365 AS FLOAT)) * CONVERT(decimal(20,2), CAST(CHARGEBLE_DAYS AS FLOAT)))  where marine_vehicle_details_raw.tran_id=?
UPDATE_RAW_VAT_PREMIUM=UPDATE marine_vehicle_details_raw SET VAT_TAX_AMT = (CONVERT(decimal(20,2), CAST(isnull(ACTUAL_PREMIUM,0) AS FLOAT)) * isnull(VAT_TAX_PERCENT,0))/100 where marine_vehicle_details_raw.tran_id=?
INSERT_VEHICLE_TRANS=INSERT INTO marine_vehicle_transaction_details (tran_id,entry_date,upload_file_name,total_no_of_records,error_records,status,proposal_no,BASE_OPENCOVER_NO) VALUES(?,getdate(),?,?,?,?,?,?)
GET_ERROR_MSG=select ERROR_MSG  from  marine_vehicle_details_raw where ERROR_STATUS='Y' and  tran_id = ?
GET_RAW_DATA_COUNT=select count(*) from marine_vehicle_details_raw where tran_id=?
UPDATE_DUPLICATE_VEHICLE=update marine_vehicle_transaction_details set status='R' where tran_id=?
GET_REFUND_CHARGE_AMOUNT=select SUM((convert(decimal(10,2),cast(actual_premium as float)))) from marine_vehicle_details where tran_id=? and Status in ( 'Y','N')
GET_REFUND_VAT_AMOUNT=select SUM((convert(decimal(10,2),cast(isnull(VAT_TAX_AMT,0) as float)))) from marine_vehicle_details where tran_id=? and Status in ( 'Y','N')
GET_VEHICLE_TRAN_DET=SELECT c.open_cover_no, ocmp.SUMINSURED,  ocmp.MARINE_RATE,ocmp.MARINE_PREMIUM,   ocmp.WAR_RATE,ocmp.WAR_PREMIUM,Cast(ocmp.TOTAL_PREMIUM as decimal(18,2))TOTAL_PREMIUM,  ISNULL (ocmp.POLICY_FEE, 0)POLICY_FEE,ISNULL (ocmp.INSPECTION_FEE, 0)INSPECTION_FEE,  FINAL_PREMIUM,  PAYABLE_YN,  PERCENTAGE,  PAYABLE_PREMIUM,  ISNULL (COMMISSION_PERCENT, 0)COMMISSION_PERCENT,  C.ENDT_STATUS ENDT_STATUS,  c.PROPOSAL_NO, (  ISNULL (ocmp.TOTAL_MARINE_PREMIUM, 0)  - ISNULL (ocmp.Recevied_Til_Date, 0)  - ISNULL (ocmp.POLICY_FEE_RECEIVED, 0)  - ISNULL (ocmp.INSPECTION_FEE_RECEIVED, 0) )total_amount,  oc.MISSIPPI_OPENCOVER_NO,  oc.debit_note_no,  oc.credit_note_no,  (  ISNULL (ocmp.Recevied_Til_Date, 0)  + ISNULL (ocmp.POLICY_FEE_RECEIVED, 0)  + ISNULL (ocmp.INSPECTION_FEE_RECEIVED, 0) )total_amount1,  cast(ISNULL (ocmp.TOTAL_MARINE_PREMIUM, 0) as decimal(18,2))TOTAL_MARINE_PREMIUM,  ISNULL (POLICY_FEE_PAID, 0)POLICY_FEE_PAID,  ISNULL (INSPECTION_FEE_PAID, 0)INSPECTION_FEE_PAID FROM OPEN_COVER_MOP_DETAILS ocmp,  OPEN_COVER_POSITION_MASTER C,  open_cover_master oc  WHERE C.ORIGINAL_POLICY_NO IS NULL  AND c.open_cover_no = (SELECT original_policy_NO FROM OPEN_COVER_POSITION_MASTER  WHERE PROPOSAL_NO = ?)  AND ocmp.PROPOSAL_NO = c.PROPOSAL_NO  AND oc.PROPOSAL_NO = c.PROPOSAL_NO  AND oc.amend_id =  (SELECT MAX (amend_id) FROM open_cover_master  WHERE ocmp.PROPOSAL_NO = PROPOSAL_NO)   UNION ALL SELECT c.open_cover_no, ocmp.SUMINSURED,  ocmp.MARINE_RATE,ocmp.MARINE_PREMIUM, ocmp.WAR_RATE,ocmp.WAR_PREMIUM,Cast(ocmp.TOTAL_PREMIUM as decimal(18,2)),  ISNULL (ocmp.POLICY_FEE, 0),ISNULL (ocmp.INSPECTION_FEE, 0),  FINAL_PREMIUM,  PAYABLE_YN,  PERCENTAGE,  PAYABLE_PREMIUM,  ISNULL (COMMISSION_PERCENT, 0),  C.ENDT_STATUS ENDT_STATUS,  c.PROPOSAL_NO, (  ISNULL (ocmp.TOTAL_MARINE_PREMIUM, 0)  - ISNULL (ocmp.Recevied_Til_Date, 0)  - ISNULL (ocmp.POLICY_FEE_RECEIVED, 0)  - ISNULL (ocmp.INSPECTION_FEE_RECEIVED, 0) ),  oc.MISSIPPI_OPENCOVER_NO,  oc.debit_note_no,  oc.credit_note_no,  (  ISNULL (ocmp.Recevied_Til_Date, 0)  + ISNULL (ocmp.POLICY_FEE_RECEIVED, 0)  + ISNULL (ocmp.INSPECTION_FEE_RECEIVED, 0) ),  cast(ISNULL (ocmp.TOTAL_MARINE_PREMIUM, 0) as decimal(18,2)),  ISNULL (POLICY_FEE_PAID, 0),  ISNULL (INSPECTION_FEE_PAID, 0) FROM OPEN_COVER_MOP_DETAILS ocmp,  OPEN_COVER_POSITION_MASTER C,  open_cover_master oc  WHERE C.ORIGINAL_POLICY_NO = (SELECT DISTINCT ORIGINAL_POLICY_NO  FROM OPEN_COVER_POSITION_MASTER WHERE PROPOSAL_NO = ?)  AND c.open_cover_no IS NOT NULL  AND ocmp.PROPOSAL_NO = c.PROPOSAL_NO  AND oc.PROPOSAL_NO = c.PROPOSAL_NO  AND oc.amend_id =  (SELECT MAX (amend_id) FROM open_cover_master  WHERE ocmp.PROPOSAL_NO = PROPOSAL_NO)order by PROPOSAL_NO
GET_PREMIUM_DETAIL=SELECT SUMINSURED,MARINE_RATE,WAR_RATE,TOTAL_PREMIUM,ISNULL(POLICY_FEE,0)POLICY_FEE,ISNULL(INSPECTION_FEE,0)INSPECTION_FEE,isnull(FINAL_PREMIUM,0)FINAL_PREMIUM,isnull(Recevied_Til_Date,0)Recevied_Til_Date ,isnull(POLICY_FEE_RECEIVED,0)POLICY_FEE_RECEIVED,isnull(INSPECTION_FEE_RECEIVED,0)INSPECTION_FEE_RECEIVED,isnull(Recevied_Til_Date,0)+isnull(POLICY_FEE_RECEIVED,0)+isnull(INSPECTION_FEE_RECEIVED,0) PREMIUM_REC,PAYABLE_YN, FLOOR(abs(PAYABLE_MARINE_PREMIUM))PAYABLE_MARINE_PREMIUM,FLOOR(abs(POLICY_FEE_paid))POLICY_FEE_paid,FLOOR(abs(INSPECTION_FEE_paid))INSPECTION_FEE_paid,FLOOR ((ABS (PAYABLE_MARINE_PREMIUM))+FLOOR (ABS (POLICY_FEE_paid))+FLOOR (ABS (INSPECTION_FEE_paid)))TOTAL,(TOTAL_PREMIUM-isnull (Recevied_Til_Date, 0)) BALANCEAMT , (ISNULL (POLICY_FEE, 0)-ISNULL (POLICY_FEE_RECEIVED, 0))POLICYFEEBAL, (ISNULL (INSPECTION_FEE, 0)-isnull (INSPECTION_FEE_RECEIVED, 0))INCEPTIONFEEBAL, (ISNULL (FINAL_PREMIUM, 0)-(isnull (Recevied_Til_Date, 0) + isnull (POLICY_FEE_RECEIVED, 0) + isnull (INSPECTION_FEE_RECEIVED, 0)))  RECEVIEDTOT  FROM OPEN_COVER_MOP_DETAILS ocmp,OPEN_COVER_POSITION_MASTER C WHERE ocmp.PROPOSAL_NO=? AND C.PROPOSAL_NO = ocmp.PROPOSAL_NO
GET_PREMIUM_TRAN_DET=select * from marine_vehicle_transaction_details where tran_id=?
GET_CERT_NO=Select  Cert_no from open_cover_position_master Where Open_cover_no=?
UPD_CERT_NO=update open_cover_position_master set Cert_no=ISNULL(Cert_no,0)+1 where Open_cover_no=?
UPD_VEHICLE_STATUS=update marine_vehicle_details set status=? where  tran_id=?  or deleted_tran_id= ?
UPD_VEH_POLICY_DETAIL=update marine_vehicle_transaction_details set POLICY_NO=?, LOGIN_ID=?,CUSTOMER_ID=?,PRODUCT_ID='13',CREDIT_NOTE_DATE=convert(DATE, ?,103),DEBIT_NOTE_DATE=convert(DATE, ?,103),CREDIT_TO=?,DEBIT_TO=?,CREDIT_TO_ID=?,DEBIT_TO_ID=?,CREDIT_NOTE_NO=?,DEBIT_NOTE_NO=?, OPEN_COVER_NO=?,BASE_OPENCOVER_NO=?,PREMIUM=?,policy_fee=?,COMMISSION=?,COMISSION_PERCENTAGE=?,status=?,broker_id=? ,CONDITION_DESC=?,POLICY_EFFECTIVE_DATE=CONVERT(DATE,?,103),VAT_TAX_PERCENT=convert(decimal(15,2),cast(? as float)),VAT_TAX_AMT=? ,VAT_COMMISSION=?,VAT_COMMISSION_PERCENT=? where tran_id=?
GET_MAX_EFFECTIVE_DATE=select count(*)   where CONVERT(date,?,103) >= (select CONVERT(date,max(INCEPTION_DATE),103) from MARINE_VEHICLE_DETAILS where BASE_OPEN_COVER_NO=?)
GET_VEHICLE_REFUND_PREMIUM=select convert(decimal(10,2),(convert(decimal(10,2),cast(actual_premium as float)))) PREMIUM from marine_vehicle_details where BASE_OPEN_COVER_NO=? and sno=? and TRAN_ID=?
GET_CHARGABLE_DAYS=select CHARGEBLE_DAYS from marine_vehicle_details where BASE_OPEN_COVER_NO=? and sno=? and TRAN_ID=?
GET_DELETE_DIFF_DATE=select (datediff (DAY,   CONVERT (date, ?, 103),CONVERT (date, POLICY_END_DATE, 103)) + 1) from open_cover_master where PROPOSAL_NO=? and AMEND_ID=(select max(AMEND_ID) from open_cover_master where PROPOSAL_NO=?)
UPDATE_DELETE_STATUS=update marine_vehicle_details set status='y' ,delete_proposal_date=convert(date,?,103),REFUND_PREMIUM=?,delete_proposal_no=?,deleted_tran_id=? ,REFUND_DAYS=? where PROPOSAL_NO=? and sno=? and TRAN_ID=?
UPDATE_DELETE_TAX=UPDATE marine_vehicle_details SET VAT_TAX_REFUND = (CONVERT(decimal(20,2), CAST(isnull(REFUND_PREMIUM,0) AS FLOAT)) * isnull(VAT_TAX_PERCENT,0))/100 where deleted_tran_id=?
GET_REFUND_VAT_AMOUNT=select SUM((convert(decimal(10,2),cast(VAT_TAX_REFUND as float)))) from marine_vehicle_details where BASE_OPEN_COVER_NO=? and Status='Y' and deleted_tran_id=?
GET_REFUND_AMOUNT=select SUM((convert(decimal(10,2),cast(REFUND_PREMIUM as float)))) from marine_vehicle_details where BASE_OPEN_COVER_NO=? and Status='Y' and deleted_tran_id=?
GET_DUPLICATE_RECORD=select SNO,TRAN_ID,PROPOSAL_NO,ASSERT_NO,PLATE_NO,CHASSIS_NO,MAKE,DESCRIPTION,SEQUENCE_NO,MANUFACTURE_YEAR,LIMIT,CONVERT(date,ENTRY_DATE,103)ENTRY_DATE,INCEPTION_DATE,EXPIRY_DATE,BASE_OPEN_COVER_NO   from marine_vehicle_details_raw  where tran_id=?