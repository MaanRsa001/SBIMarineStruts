
GET_MAIN_MENU_LIST=SELECT MENU_ID,MENU_NAME,MENU_URL,PARENT_MENU FROM MENU_MASTER M WHERE STATUS=''Y'' AND  NOT EXISTS(SELECT ''Y'' FROM MENU_MASTER MI WHERE MI.MENU_ID=M.MENU_ID AND MENU_ID IN(''{0}'')) AND MENU_ID IS NOT NULL  AND PRODUCT_ID={1}  AND BRANCH_CODE={2} ORDER BY MENU_ID ASC

GET_POLICY_REPORT_LIST=select a.company_name,c.missippi_opencover_no,nvl(d.first_name,d.company_name) customer_name ,b.login_id,e.open_cover_no,count(e.status) policy,to_number(nvl(sum(e.premium+e.excess_premium),0)) premium, nvl(sum(e.COMMISSION),0) COMMISSION,nvl(sum(e.PRO_COMMISSION),0) PRO_COMMISSION from position_master e ,open_cover_master c ,login_master b,broker_company_master a,personal_info d where e.status\=''P'' and  b.agency_code\=d.agency_code and c.missippi_opencover_no\=e.open_cover_no AND b.login_id\=e.login_id AND b.agency_code\=a.agency_code and e.product_id\=? and e.open_cover_no is not null and e.INCEPTION_DATE between to_date(?,''DD/MM/YYYY'') and to_date(?,''DD/MM/YYYY'')+1 and e.login_id in( select login_id from login_master where oa_code in ( select oa_code from login_master where e.login_id in({0}))) group by e.open_cover_no,c.missippi_opencover_no,b.login_id,a.company_name,nvl(d.first_name,d.company_name) order by open_cover_no

GET_POLICY_REPORT_LIST_OTHERS=select pi.LOGIN_ID, (select USERNAME from login_master llm where llm.login_id=pi.LOGIN_ID) company_name,CUST_NAME customer_name,POLICY_NO,(select count(POLICY_NO) from home_position_master hp where hp.policy_no=hpm.policy_no) policy,premium,commission from home_position_master hpm,personal_info pi where hpm.CUSTOMER_ID=pi.CUSTOMER_ID AND (hpm.INCEPTION_DATE BETWEEN TO_DATE (?, ''DD/MM/YYYY'') AND TO_DATE (?, ''DD/MM/YYYY'') + 1) and hpm.product_id=? and hpm.status=''P'' and pi.login_id in ({0})

GET_SMART_REPORT_LIST=select bcm.company_name,count(bcm.company_name) no_policy,sum(pos.premium+nvl(pos.excess_premium,0)) total_premium,sum(nvl(pos.commission,0)) commission,sum(nvl(pos.PRO_COMMISSION,0)) pro_commission,sum(nvl(pos.tax,0)),bcm.agency_code from position_master pos,broker_company_master bcm,login_master log,personal_info per, marine_data md,cover_master cm,sale_term_master stm,extra_cover_master ecm, mode_of_transport mot,marine_policy_details mpd where pos.status=''P'' and md.cover_id=cm.cover_id and md.sale_term_id=stm.sale_term_id and md.EXTRA_COVER_ID=ecm.extra_cover_id and md.MODE_OF_TRANSPORT=mot.MODE_TRANSPORT_ID and stm.branch_code=ecm.branch_code and ecm.branch_code=mot.branch_code and mot.branch_code=cm.branch_code and cm.branch_code in({0}) and bcm.branch_code in({1}) and pos.login_id=log.login_id  {2} and log.oa_code=bcm.agency_code and pos.customer_id=per.customer_id and mpd.quote_no=pos.quote_no and md.application_no=pos.application_no and  pos.product_id={3}  {4}  {5} and pos.business_type={6} and md.transit_from_country_id in ({7}) and md.final_destination_country_id in ({8}) and pos.application_no in(select mrd.application_no from marine_result_details mrd where mrd.application_no=pos.application_no {9} {10}) and pos.FREIGHT_STATUS is null and pos.inception_date between to_date({11},''dd/mm/yyyy'') and to_date({12},''dd/mm/yyyy'')+1 group by bcm.company_name,bcm.agency_code order by count(bcm.company_name) desc

GET_LCSMART_REPORT_LIST=SELECT bcm.company_name, ocm.MISSIPPI_OPENCOVER_NO, pi.customer_id, NVL (pi.company_name, pi.FIRST_NAME) cust_name, bm.bank_name, oclm.LC_NUMBER, oclm.LC_BALANCE_AMOUNT, pi.login_id, ocpm.open_cover_no, TO_CHAR (oclm.LC_DATE, ''dd/mm/yyyy'') start_date, TO_CHAR (oclm.EXPIRY_DATE, ''dd/mm/yyyy'') end_date, oclm.LC_AMOUNT, oclm.LC_AMOUNT *  em.EXCHANGE_RATE LC_AMT_DH, oclm.bank_id, oclm.lc_id,  em.EXCHANGE_RATE, cm.SHORT_NAME, oclm.LC_CURRENCY_ID, SUM(  mrd.SUMINSUREDLOCAL + md.TOTAL_SALE_TERM_CHARGES + md.TOTAL_TOLERANCE_CHARGES), (oclm.LC_AMOUNT * em.EXCHANGE_RATE)-LC_BALANCE_AMOUNT used_amt FROM BROKER_COMPANY_MASTER bcm, personal_info pi, OPEN_COVER_MASTER ocm, OPEN_COVER_POSITION_MASTER ocpm, OPEN_COVER_LC_MASTER oclm, OPEN_COVER_BANK_MASTER bm, marine_data md, MARINE_RESULT_DETAILS mrd, currency_master cm, position_master pm, EXCHANGE_MASTER em WHERE em.AMEND_ID=(select max(AMEND_ID) from EXCHANGE_MASTER where CURRENCY_ID=em.CURRENCY_ID) AND md.application_no = pm.application_no AND cm.CURRENCY_ID= oclm.LC_CURRENCY_ID AND oclm.LC_CURRENCY_ID=em.CURRENCY_ID AND md.application_no = mrd.application_no AND md.open_cover_no = pm.open_cover_no AND pm.status = ''P'' AND md.status = ''Y'' AND bcm.agency_code = pi.agency_code AND pi.APPLICATION_ID = ''2'' AND ocm.broker_id = pi.login_id AND ocm.proposal_no = ocpm.proposal_no AND ocpm.STATUS NOT IN (''Y'') AND bcm.branch_code = ? {0} AND bcm.AGENCY_CODE=(select AGENCY_CODE from login_master where LOGIN_ID=?) AND oclm.open_cover_no = ocpm.open_cover_no AND oclm.LC_NUMBER NOT IN (''NONE'') AND ocm.MISSIPPI_OPENCOVER_NO IS NOT NULL AND ocm.amend_id || ''-'' || ocm.proposal_no IN (SELECT MAX (ocms.amend_id) || ''-'' || ocms.proposal_no FROM   open_cover_master ocms, open_cover_position_master ocpms WHERE ocpms.proposal_no = ocms.proposal_no GROUP BY ocms.proposal_no) AND bm.bank_id = oclm.bank_id AND bm.bank_id = md.OPEN_BANK_ID AND bm.BELONGING_COUNTRY_ID = 1 AND bm.amend_id || bm.bank_id IN (  SELECT   MAX (amend_id) || bank_id FROM OPEN_COVER_BANK_MASTER WHERE BELONGING_COUNTRY_ID = 1 GROUP BY bank_id) group by  bcm.company_name, ocm.MISSIPPI_OPENCOVER_NO, pi.customer_id, NVL (pi.company_name, pi.FIRST_NAME), bm.bank_name, oclm.LC_NUMBER, cm.SHORT_NAME, em.EXCHANGE_RATE, oclm.LC_BALANCE_AMOUNT, pi.login_id, ocpm.open_cover_no, TO_CHAR (oclm.LC_DATE, ''dd/mm/yyyy''), TO_CHAR (oclm.EXPIRY_DATE, ''dd/mm/yyyy''), oclm.LC_AMOUNT, oclm.bank_id, oclm.lc_id, oclm.LC_CURRENCY_ID, bcm.company_name, ocpm.open_cover_no
